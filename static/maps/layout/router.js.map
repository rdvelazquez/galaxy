{"version":3,"sources":["layout/router.js"],"names":["$","Router","Backbone","extend","initialize","page","options","push","url","data","__identifer","Math","random","toString","substr","indexOf","param","Galaxy","params","navigate","trigger","execute","callback","args","name","debug","queryObj","parse","pop","authenticate","apply","access_denied","display","Message","status","message","persistent"],"mappings":";;;;;;;;;;;;;;;;;;;AACA,QAAIA,oBAAJ;;;AAIA,QAAIC,SAASC,SAASD,MAAT,CAAgBE,MAAhB,CAAuB;AAChC;AACA;AACAC,oBAAY,oBAASC,IAAT,EAAeC,OAAf,EAAwB;AAChC,iBAAKD,IAAL,GAAYA,IAAZ;AACA,iBAAKC,OAAL,GAAeA,OAAf;AACH,SAN+B;;AAQhC;AACAC,cAAM,cAASC,GAAT,EAAcC,IAAd,EAAoB;AACtBA,mBAAOA,QAAQ,EAAf;AACAA,iBAAKC,WAAL,GAAmBC,KAAKC,MAAL,GACdC,QADc,CACL,EADK,EAEdC,MAFc,CAEP,CAFO,CAAnB;AAGAN,mBAAOA,IAAIO,OAAJ,CAAY,GAAZ,KAAoB,CAAC,CAArB,GAAyB,GAAzB,GAA+B,GAAtC;AACAP,mBAAOR,EAAEgB,KAAF,CAAQP,IAAR,EAAc,IAAd,CAAP;AACAQ,mBAAOC,MAAP,GAAgBT,IAAhB;AACA,iBAAKU,QAAL,CAAcX,GAAd,EAAmB,EAAEY,SAAS,IAAX,EAAnB;AACH,SAlB+B;;AAoBhC;AACAC,iBAAS,iBAASC,QAAT,EAAmBC,IAAnB,EAAyBC,IAAzB,EAA+B;AACpCP,mBAAOQ,KAAP,CAAa,iBAAb,EAAgCH,QAAhC,EAA0CC,IAA1C,EAAgDC,IAAhD;AACA,gBAAIE,WAAW,6BAAaC,KAAb,CAAmBJ,KAAKK,GAAL,EAAnB,CAAf;AACAL,iBAAKhB,IAAL,CAAUmB,QAAV;AACA,gBAAIJ,QAAJ,EAAc;AACV,oBAAI,KAAKO,YAAL,CAAkBN,IAAlB,EAAwBC,IAAxB,CAAJ,EAAmC;AAC/BF,6BAASQ,KAAT,CAAe,IAAf,EAAqBP,IAArB;AACH,iBAFD,MAEO;AACH,yBAAKQ,aAAL;AACH;AACJ;AACJ,SAhC+B;;AAkChCF,sBAAc,sBAASN,IAAT,EAAeC,IAAf,EAAqB;AAC/B,mBAAO,IAAP;AACH,SApC+B;;AAsChCO,uBAAe,yBAAW;AACtB,iBAAK1B,IAAL,CAAU2B,OAAV,CACI,IAAI,iBAAGC,OAAP,CAAe;AACXC,wBAAQ,QADG;AAEXC,yBAAS,qEAFE;AAGXC,4BAAY;AAHD,aAAf,CADJ;AAOH;AA9C+B,KAAvB,CAAb;;sBAiDenC,M","file":"../../scripts/layout/router.js","sourcesContent":["import jQuery from \"jquery\";\nvar $ = jQuery;\nimport QUERY_STRING from \"utils/query-string-parsing\";\nimport Ui from \"mvc/ui/ui-misc\";\n\nvar Router = Backbone.Router.extend({\n    // TODO: not many client routes at this point - fill and remove from server.\n    // since we're at root here, this may be the last to be routed entirely on the client.\n    initialize: function(page, options) {\n        this.page = page;\n        this.options = options;\n    },\n\n    /** helper to push a new navigation state */\n    push: function(url, data) {\n        data = data || {};\n        data.__identifer = Math.random()\n            .toString(36)\n            .substr(2);\n        url += url.indexOf(\"?\") == -1 ? \"?\" : \"&\";\n        url += $.param(data, true);\n        Galaxy.params = data;\n        this.navigate(url, { trigger: true });\n    },\n\n    /** override to parse query string into obj and send to each route */\n    execute: function(callback, args, name) {\n        Galaxy.debug(\"router execute:\", callback, args, name);\n        var queryObj = QUERY_STRING.parse(args.pop());\n        args.push(queryObj);\n        if (callback) {\n            if (this.authenticate(args, name)) {\n                callback.apply(this, args);\n            } else {\n                this.access_denied();\n            }\n        }\n    },\n\n    authenticate: function(args, name) {\n        return true;\n    },\n\n    access_denied: function() {\n        this.page.display(\n            new Ui.Message({\n                status: \"danger\",\n                message: \"You must be logged in with proper credentials to make this request.\",\n                persistent: true\n            })\n        );\n    }\n});\n\nexport default Router;\n"]}