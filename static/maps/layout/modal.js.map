{"version":3,"sources":["layout/modal.js"],"names":["$","Modal","options","$overlay","overlay","$dialog","dialog","$header","find","$body","$footer","$backdrop","backdrop","on","proxy","hide","extend","prototype","setContent","title","html","show","closeButton","$buttons","buttons","each","name","value","append","text","click","$extraButtons","extra_buttons","body","callback","is","addClass","removeClass","css","width","window","height","outerHeight","parseInt","modal","fadeOut","children","remove","undefined","hide_modal","show_modal","init_fn","show_message","show_in_overlay","scroll","bind","unbind","url"],"mappings":"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","file":"../../scripts/layout/modal.js","sourcesContent":["import jQuery from \"jquery\";\n\n// ============================================================================\n//TODO: (the older version) unify with ui-modal (the newer version)\nvar $ = jQuery;\n\n// Modal dialog boxes\nvar Modal = function(options) {\n    this.$overlay = options.overlay;\n    this.$dialog = options.dialog;\n    this.$header = this.$dialog.find(\".modal-header\");\n    this.$body = this.$dialog.find(\".modal-body\");\n    this.$footer = this.$dialog.find(\".modal-footer\");\n    this.$backdrop = options.backdrop;\n    // Close button\n    this.$header.find(\".close\").on(\"click\", $.proxy(this.hide, this));\n};\n\n$.extend(Modal.prototype, {\n    setContent: function(options) {\n        this.$header.hide();\n        // Title\n        if (options.title) {\n            this.$header.find(\".title\").html(options.title);\n            this.$header.show();\n        }\n        if (options.closeButton) {\n            this.$header.find(\".close\").show();\n            this.$header.show();\n        } else {\n            this.$header.find(\".close\").hide();\n        }\n        // Buttons\n        this.$footer.hide();\n        var $buttons = this.$footer.find(\".buttons\").html(\"\");\n        if (options.buttons) {\n            $.each(options.buttons, (name, value) => {\n                $buttons\n                    .append(\n                        $(\"<button></button> \")\n                            .text(name)\n                            .click(value)\n                    )\n                    .append(\" \");\n            });\n            this.$footer.show();\n        }\n        var $extraButtons = this.$footer.find(\".extra_buttons\").html(\"\");\n        if (options.extra_buttons) {\n            $.each(options.extra_buttons, (name, value) => {\n                $extraButtons\n                    .append(\n                        $(\"<button></button>\")\n                            .text(name)\n                            .click(value)\n                    )\n                    .append(\" \");\n            });\n            this.$footer.show();\n        }\n        // Body\n        var body = options.body;\n        if (body == \"progress\") {\n            body = $(\n                \"<div class='progress progress-striped active'><div class='progress-bar' style='width: 100%'></div></div>\"\n            );\n        }\n        this.$body.html(body);\n    },\n    show: function(options, callback) {\n        if (!this.$dialog.is(\":visible\")) {\n            if (options.backdrop) {\n                this.$backdrop.addClass(\"in\");\n            } else {\n                this.$backdrop.removeClass(\"in\");\n            }\n            this.$overlay.show();\n            this.$dialog.show();\n            this.$overlay.addClass(\"in\");\n            // Fix min-width so that modal cannot shrink considerably if new content is loaded.\n            this.$body.css(\"min-width\", this.$body.width());\n            // Set max-height so that modal does not exceed window size and is in middle of page.\n            // TODO: this could perhaps be handled better using CSS.\n            this.$body.css(\n                \"max-height\",\n                $(window).height() -\n                    this.$footer.outerHeight() -\n                    this.$header.outerHeight() -\n                    parseInt(this.$dialog.css(\"padding-top\"), 10) -\n                    parseInt(this.$dialog.css(\"padding-bottom\"), 10)\n            );\n        }\n        // Callback on init\n        if (callback) {\n            callback();\n        }\n    },\n    hide: function() {\n        var modal = this;\n        modal.$dialog.fadeOut(() => {\n            modal.$overlay.hide();\n            modal.$backdrop.removeClass(\"in\");\n            modal.$body.children().remove();\n            // Clear min-width to allow for modal to take size of new body.\n            modal.$body.css(\"min-width\", undefined);\n        });\n    }\n});\n\nvar modal;\n\n$(() => {\n    modal = new Modal({\n        overlay: $(\"#top-modal\"),\n        dialog: $(\"#top-modal-dialog\"),\n        backdrop: $(\"#top-modal-backdrop\")\n    });\n});\n\n// Backward compatibility\nfunction hide_modal() {\n    modal.hide();\n}\n\nfunction show_modal(title, body, buttons, extra_buttons, init_fn) {\n    modal.setContent({\n        title: title,\n        body: body,\n        buttons: buttons,\n        extra_buttons: extra_buttons\n    });\n    modal.show({ backdrop: true }, init_fn);\n}\n\nfunction show_message(title, body, buttons, extra_buttons, init_fn) {\n    modal.setContent({\n        title: title,\n        body: body,\n        buttons: buttons,\n        extra_buttons: extra_buttons\n    });\n    modal.show({ backdrop: false }, init_fn);\n}\n\nfunction show_in_overlay(options) {\n    var width = options.width || \"600\";\n    var height = options.height || \"400\";\n    var scroll = options.scroll || \"auto\";\n    $(\"#overlay-background\").bind(\"click.overlay\", () => {\n        hide_modal();\n        $(\"#overlay-background\").unbind(\"click.overlay\");\n    });\n    modal.setContent({\n        closeButton: true,\n        title: \"&nbsp;\",\n        body: $(\n            `<div style='margin: -5px;'><iframe style='margin: 0; padding: 0;' src='${\n                options.url\n            }' width='${width}' height='${height}' scrolling='${scroll}' frameborder='0'></iframe></div>`\n        )\n    });\n    modal.show({ backdrop: true });\n}\n\n// ============================================================================\nexport default {\n    Modal: Modal,\n    hide_modal: hide_modal,\n    show_modal: show_modal,\n    show_message: show_message,\n    show_in_overlay: show_in_overlay\n};\n"]}