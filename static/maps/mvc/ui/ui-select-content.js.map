{"version":3,"sources":["mvc/ui/ui-select-content.js"],"names":["Batch","DISABLED","ENABLED","LINKED","Configurations","data","src","icon","tooltip","multiple","batch","data_multiple","data_collection","workflow_data","workflow_data_multiple","workflow_data_collection","module_data","module_data_collection","View","Backbone","extend","initialize","options","self","model","Model","src_labels","hda","hdca","pagelimit","statustimer","set","setElement","$","addClass","button_product","RadioButton","value","$batch_div","append","html","$batch","linked","clone","enabled","$el","css","on","e","lastenter","target","preventDefault","removeClass","_handleDrop","history","listenTo","_changeData","_changeWait","_changeCurrent","_changeValue","_changeType","render","onchange","wait","unwait","update","new_value","undefined","current","get","config","id_list","fields","isArray","length","result","_batch","values","i","details","push","Galaxy","emit","debug","sort","a","b","hid","_","each","field","show","$batchfield","batchmode","button_type","hide","config_id","String","extensions","textify","button_data","c","optional","searchable","individual","error_text","trigger","empty","button_width","Math","max","select_options","items","item","keep","label","name","id","tags","add","list","indexOf","ev","drop_data","JSON","parse","originalEvent","dataTransfer","getData","new_id","new_src","history_content_type","findWhere","current_value","_handleDropStatus","status","setTimeout","map_over_type"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-select-content.js","sourcesContent":["import _l from \"utils/localization\";\nimport Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\nimport Select from \"mvc/ui/ui-select-default\";\n/** Batch mode variations */\nvar Batch = { DISABLED: \"disabled\", ENABLED: \"enabled\", LINKED: \"linked\" };\n\n/** List of available content selectors options */\nvar Configurations = {\n    data: [\n        {\n            src: \"hda\",\n            icon: \"fa-file-o\",\n            tooltip: _l(\"Single dataset\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        },\n        {\n            src: \"hda\",\n            icon: \"fa-files-o\",\n            tooltip: _l(\"Multiple datasets\"),\n            multiple: true,\n            batch: Batch.LINKED\n        },\n        {\n            src: \"hdca\",\n            icon: \"fa-folder-o\",\n            tooltip: _l(\"Dataset collection\"),\n            multiple: false,\n            batch: Batch.LINKED\n        }\n    ],\n    data_multiple: [\n        {\n            src: \"hda\",\n            icon: \"fa-files-o\",\n            tooltip: _l(\"Multiple datasets\"),\n            multiple: true,\n            batch: Batch.DISABLED\n        },\n        {\n            src: \"hdca\",\n            icon: \"fa-folder-o\",\n            tooltip: _l(\"Dataset collections\"),\n            multiple: true,\n            batch: Batch.DISABLED\n        }\n    ],\n    data_collection: [\n        {\n            src: \"hdca\",\n            icon: \"fa-folder-o\",\n            tooltip: _l(\"Dataset collection\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        }\n    ],\n    workflow_data: [\n        {\n            src: \"hda\",\n            icon: \"fa-file-o\",\n            tooltip: _l(\"Single dataset\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        }\n    ],\n    workflow_data_multiple: [\n        {\n            src: \"hda\",\n            icon: \"fa-files-o\",\n            tooltip: _l(\"Multiple datasets\"),\n            multiple: true,\n            batch: Batch.DISABLED\n        }\n    ],\n    workflow_data_collection: [\n        {\n            src: \"hdca\",\n            icon: \"fa-folder-o\",\n            tooltip: _l(\"Dataset collection\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        }\n    ],\n    module_data: [\n        {\n            src: \"hda\",\n            icon: \"fa-file-o\",\n            tooltip: _l(\"Single dataset\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        },\n        {\n            src: \"hda\",\n            icon: \"fa-files-o\",\n            tooltip: _l(\"Multiple datasets\"),\n            multiple: true,\n            batch: Batch.ENABLED\n        }\n    ],\n    module_data_collection: [\n        {\n            src: \"hdca\",\n            icon: \"fa-folder-o\",\n            tooltip: _l(\"Dataset collection\"),\n            multiple: false,\n            batch: Batch.DISABLED\n        },\n        {\n            src: \"hdca\",\n            icon: \"fa-folder\",\n            tooltip: _l(\"Multiple collections\"),\n            multiple: true,\n            batch: Batch.ENABLED\n        }\n    ]\n};\n\n/** View for hda and hdca content selector ui elements */\nvar View = Backbone.View.extend({\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                src_labels: { hda: \"dataset\", hdca: \"dataset collection\" },\n                pagelimit: 100,\n                statustimer: 1000\n            }).set(options);\n        this.setElement($(\"<div/>\").addClass(\"ui-select-content\"));\n        this.button_product = new Ui.RadioButton.View({\n            value: \"false\",\n            data: [\n                {\n                    icon: \"fa fa-chain\",\n                    value: \"false\",\n                    tooltip:\n                        \"Linked inputs will be run in matched order with other datasets e.g. use this for matching forward and reverse reads.\"\n                },\n                {\n                    icon: \"fa fa-chain-broken\",\n                    value: \"true\",\n                    tooltip: \"Unlinked dataset inputs will be run against *all* other inputs.\"\n                }\n            ]\n        });\n        var $batch_div = $(\"<div/>\")\n            .addClass(\"ui-form-info\")\n            .append($(\"<i/>\").addClass(\"fa fa-sitemap\"))\n            .append(\n                $(\"<span/>\").html(\n                    \"This is a batch mode input field. Separate jobs will be triggered for each dataset selection.\"\n                )\n            );\n        this.$batch = {\n            linked: $batch_div.clone(),\n            enabled: $batch_div\n                .clone()\n                .append(\n                    $(\"<div/>\")\n                        .append(\n                            $(\"<div/>\")\n                                .addClass(\"ui-form-title\")\n                                .html(\"Batch options:\")\n                        )\n                        .append(this.button_product.$el)\n                )\n                .append($(\"<div/>\").css(\"clear\", \"both\"))\n        };\n\n        // add drag-drop event handlers\n        this.$el\n            .on(\"dragenter\", function(e) {\n                this.lastenter = e.target;\n                self.$el.addClass(\"ui-dragover\");\n            })\n            .on(\"dragover\", e => {\n                e.preventDefault();\n            })\n            .on(\"dragleave\", function(e) {\n                this.lastenter === e.target && self.$el.removeClass(\"ui-dragover\");\n            })\n            .on(\"drop\", e => {\n                self._handleDrop(e);\n            });\n\n        // track current history elements\n        this.history = {};\n\n        // add listeners\n        this.listenTo(this.model, \"change:data\", this._changeData, this);\n        this.listenTo(this.model, \"change:wait\", this._changeWait, this);\n        this.listenTo(this.model, \"change:current\", this._changeCurrent, this);\n        this.listenTo(this.model, \"change:value\", this._changeValue, this);\n        this.listenTo(\n            this.model,\n            \"change:type change:optional change:multiple change:extensions\",\n            this._changeType,\n            this\n        );\n        this.render();\n\n        // add change event\n        this.on(\"change\", () => {\n            options.onchange && options.onchange(self.value());\n        });\n    },\n\n    render: function() {\n        this._changeType();\n        this._changeValue();\n        this._changeWait();\n    },\n\n    /** Indicate that select fields are being updated */\n    wait: function() {\n        this.model.set(\"wait\", true);\n    },\n\n    /** Indicate that the options update has been completed */\n    unwait: function() {\n        this.model.set(\"wait\", false);\n    },\n\n    /** Update data representing selectable options */\n    update: function(options) {\n        this.model.set(\"data\", options);\n    },\n\n    /** Return the currently selected dataset values */\n    value: function(new_value) {\n        new_value !== undefined && this.model.set(\"value\", new_value);\n        var current = this.model.get(\"current\");\n        if (this.config[current]) {\n            var id_list = this.fields[current].value();\n            if (id_list !== null) {\n                id_list = $.isArray(id_list) ? id_list : [id_list];\n                if (id_list.length > 0) {\n                    var result = this._batch({ values: [] });\n                    for (var i in id_list) {\n                        var details = this.history[`${id_list[i]}_${this.config[current].src}`];\n                        if (details) {\n                            result.values.push(details);\n                        } else {\n                            Galaxy.emit.debug(\n                                \"ui-select-content::value()\",\n                                `Requested details not found for '${id_list[i]}'.`\n                            );\n                            return null;\n                        }\n                    }\n                    result.values.sort((a, b) => a.hid - b.hid);\n                    return result;\n                }\n            }\n        } else {\n            Galaxy.emit.debug(\"ui-select-content::value()\", `Invalid value/source '${new_value}'.`);\n        }\n        return null;\n    },\n\n    /** Change of current select field */\n    _changeCurrent: function() {\n        var self = this;\n        _.each(this.fields, (field, i) => {\n            if (self.model.get(\"current\") == i) {\n                field.$el.show();\n                _.each(self.$batch, ($batchfield, batchmode) => {\n                    $batchfield[self.config[i].batch == batchmode ? \"show\" : \"hide\"]();\n                });\n                self.button_type.value(i);\n            } else {\n                field.$el.hide();\n            }\n        });\n    },\n\n    /** Change of type */\n    _changeType: function() {\n        var self = this;\n\n        // identify selector type identifier i.e. [ flavor ]_[ type ]_[ multiple ]\n        var config_id =\n            (this.model.get(\"flavor\") ? `${this.model.get(\"flavor\")}_` : \"\") +\n            String(this.model.get(\"type\")) +\n            (this.model.get(\"multiple\") ? \"_multiple\" : \"\");\n        if (Configurations[config_id]) {\n            this.config = Configurations[config_id];\n        } else {\n            this.config = Configurations[\"data\"];\n            Galaxy.emit.debug(\"ui-select-content::_changeType()\", `Invalid configuration/type id '${config_id}'.`);\n        }\n\n        // prepare extension component of error message\n        var data = self.model.get(\"data\");\n        var extensions = Utils.textify(this.model.get(\"extensions\"));\n        var src_labels = this.model.get(\"src_labels\");\n\n        // build views\n        this.fields = [];\n        this.button_data = [];\n        _.each(this.config, (c, i) => {\n            self.button_data.push({\n                value: i,\n                icon: c.icon,\n                tooltip: c.tooltip\n            });\n            self.fields.push(\n                new Select.View({\n                    optional: self.model.get(\"optional\"),\n                    multiple: c.multiple,\n                    searchable:\n                        !c.multiple || (data && data[c.src] && data[c.src].length > self.model.get(\"pagelimit\")),\n                    individual: true,\n                    error_text: `No ${extensions ? `${extensions} ` : \"\"}${src_labels[c.src] || \"content\"} available.`,\n                    onchange: function() {\n                        self.trigger(\"change\");\n                    }\n                })\n            );\n        });\n        this.button_type = new Ui.RadioButton.View({\n            value: this.model.get(\"current\"),\n            data: this.button_data,\n            onchange: function(value) {\n                self.model.set(\"current\", value);\n                self.trigger(\"change\");\n            }\n        });\n\n        // append views\n        this.$el.empty();\n        var button_width = 0;\n        if (this.fields.length > 1) {\n            this.$el.append(this.button_type.$el);\n            button_width = `${Math.max(0, this.fields.length * 36)}px`;\n        }\n        _.each(this.fields, field => {\n            self.$el.append(field.$el.css({ \"margin-left\": button_width }));\n        });\n        _.each(this.$batch, ($batchfield, batchmode) => {\n            self.$el.append($batchfield.css({ \"margin-left\": button_width }));\n        });\n        this.model.set(\"current\", 0);\n        this._changeCurrent();\n        this._changeData();\n    },\n\n    /** Change of wait flag */\n    _changeWait: function() {\n        var self = this;\n        _.each(this.fields, field => {\n            field[self.model.get(\"wait\") ? \"wait\" : \"unwait\"]();\n        });\n    },\n\n    /** Change of available options */\n    _changeData: function() {\n        var options = this.model.get(\"data\");\n        var self = this;\n        var select_options = {};\n        _.each(options, (items, src) => {\n            select_options[src] = [];\n            _.each(items, item => {\n                select_options[src].push({\n                    hid: item.hid,\n                    keep: item.keep,\n                    label: `${item.hid}: ${item.name}`,\n                    value: item.id,\n                    tags: item.tags\n                });\n                self.history[`${item.id}_${src}`] = item;\n            });\n        });\n        _.each(this.config, (c, i) => {\n            select_options[c.src] && self.fields[i].add(select_options[c.src], (a, b) => b.hid - a.hid);\n        });\n    },\n\n    /** Change of incoming value */\n    _changeValue: function() {\n        var new_value = this.model.get(\"value\");\n        if (new_value && new_value.values && new_value.values.length > 0) {\n            // create list with content ids\n            var list = [];\n            _.each(new_value.values, value => {\n                list.push(value.id);\n            });\n            // sniff first suitable field type from config list\n            var src = new_value.values[0].src;\n            var multiple = new_value.values.length > 1;\n            for (var i = 0; i < this.config.length; i++) {\n                var field = this.fields[i];\n                var c = this.config[i];\n                if (c.src == src && [multiple, true].indexOf(c.multiple) !== -1) {\n                    this.model.set(\"current\", i);\n                    field.value(list);\n                    break;\n                }\n            }\n        } else {\n            _.each(this.fields, field => {\n                field.value(null);\n            });\n        }\n    },\n\n    /** Handles drop events e.g. from history panel */\n    _handleDrop: function(ev) {\n        try {\n            var data = this.model.get(\"data\");\n            var current = this.model.get(\"current\");\n            var config = this.config[current];\n            var field = this.fields[current];\n            var drop_data = JSON.parse(ev.originalEvent.dataTransfer.getData(\"text\"))[0];\n            var new_id = drop_data.id;\n            var new_src = drop_data.history_content_type == \"dataset\" ? \"hda\" : \"hdca\";\n            var new_value = { id: new_id, src: new_src };\n            if (data && _.findWhere(data[new_src], new_value)) {\n                if (config.src == new_src) {\n                    var current_value = field.value();\n                    if (current_value && config.multiple) {\n                        if (current_value.indexOf(new_id) == -1) {\n                            current_value.push(new_id);\n                        }\n                    } else {\n                        current_value = new_id;\n                    }\n                    field.value(current_value);\n                } else {\n                    this.model.set(\"value\", { values: [new_value] });\n                    this.model.trigger(\"change:value\");\n                }\n                this.trigger(\"change\");\n                this._handleDropStatus(\"success\");\n            } else {\n                this._handleDropStatus(\"danger\");\n            }\n        } catch (e) {\n            this._handleDropStatus(\"danger\");\n        }\n        ev.preventDefault();\n    },\n\n    /** Highlight drag result */\n    _handleDropStatus: function(status) {\n        var self = this;\n        this.$el.removeClass(\"ui-dragover\").addClass(`ui-dragover-${status}`);\n        setTimeout(() => {\n            self.$el.removeClass(`ui-dragover-${status}`);\n        }, this.model.get(\"statustimer\"));\n    },\n\n    /** Assists in identifying the batch mode */\n    _batch: function(result) {\n        result[\"batch\"] = false;\n        var current = this.model.get(\"current\");\n        var config = this.config[current];\n        if (config.src == \"hdca\" && !config.multiple) {\n            var hdca = this.history[`${this.fields[current].value()}_hdca`];\n            if (hdca && hdca.map_over_type) {\n                result[\"batch\"] = true;\n            }\n        }\n        if (config.batch == Batch.LINKED || config.batch == Batch.ENABLED) {\n            result[\"batch\"] = true;\n            if (config.batch == Batch.ENABLED && this.button_product.value() === \"true\") {\n                result[\"product\"] = true;\n            }\n        }\n        return result;\n    }\n});\n\nexport default {\n    View: View\n};\n"]}