{"version":3,"sources":["mvc/ui/ui-color-picker.js"],"names":["Backbone","View","extend","colors","standard","base","theme","initialize","options","merge","setElement","_template","$panel","$","$view","$value","$header","_build","visible","value","$boxes","self","on","css","trigger","fadeIn","fadeOut","new_val","undefined","empty","_getValue","html","_templateCheck","onchange","rgb","match","hex","x","parseInt","toString","slice","_content","i","line_def","length","$content","_templateContent","$line","find","append","$box","_templateBox","top","bottom","color"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-color-picker.js","sourcesContent":["/** Renders the color picker used e.g. in the tool form **/\nimport Utils from \"utils/utils\";\nexport default Backbone.View.extend({\n    colors: {\n        standard: [\"c00000\", \"ff0000\", \"ffc000\", \"ffff00\", \"92d050\", \"00b050\", \"00b0f0\", \"0070c0\", \"002060\", \"7030a0\"],\n        base: [\"ffffff\", \"000000\", \"eeece1\", \"1f497d\", \"4f81bd\", \"c0504d\", \"9bbb59\", \"8064a2\", \"4bacc6\", \"f79646\"],\n        theme: [\n            [\"f2f2f2\", \"7f7f7f\", \"ddd9c3\", \"c6d9f0\", \"dbe5f1\", \"f2dcdb\", \"ebf1dd\", \"e5e0ec\", \"dbeef3\", \"fdeada\"],\n            [\"d8d8d8\", \"595959\", \"c4bd97\", \"8db3e2\", \"b8cce4\", \"e5b9b7\", \"d7e3bc\", \"ccc1d9\", \"b7dde8\", \"fbd5b5\"],\n            [\"bfbfbf\", \"3f3f3f\", \"938953\", \"548dd4\", \"95b3d7\", \"d99694\", \"c3d69b\", \"b2a2c7\", \"92cddc\", \"fac08f\"],\n            [\"a5a5a5\", \"262626\", \"494429\", \"17365d\", \"366092\", \"953734\", \"76923c\", \"5f497a\", \"31859b\", \"e36c09\"],\n            [\"7f7f7e\", \"0c0c0c\", \"1d1b10\", \"0f243e\", \"244061\", \"632423\", \"4f6128\", \"3f3151\", \"205867\", \"974806\"]\n        ]\n    },\n\n    initialize: function(options) {\n        this.options = Utils.merge(options, {});\n        this.setElement(this._template());\n        this.$panel = this.$(\".ui-color-picker-panel\");\n        this.$view = this.$(\".ui-color-picker-view\");\n        this.$value = this.$(\".ui-color-picker-value\");\n        this.$header = this.$(\".ui-color-picker-header\");\n        this._build();\n        this.visible = false;\n        this.value(this.options.value);\n        this.$boxes = this.$(\".ui-color-picker-box\");\n        var self = this;\n        this.$boxes.on(\"click\", function() {\n            self.value($(this).css(\"background-color\"));\n            self.$header.trigger(\"click\");\n        });\n        this.$header.on(\"click\", () => {\n            self.visible = !self.visible;\n            if (self.visible) {\n                self.$view.fadeIn(\"fast\");\n            } else {\n                self.$view.fadeOut(\"fast\");\n            }\n        });\n    },\n\n    /** Get/set value */\n    value: function(new_val) {\n        if (new_val !== undefined && new_val !== null) {\n            this.$value.css(\"background-color\", new_val);\n            this.$(\".ui-color-picker-box\").empty();\n            this.$(this._getValue()).html(this._templateCheck());\n            this.options.onchange && this.options.onchange(new_val);\n        }\n        return this._getValue();\n    },\n\n    /** Get value from dom */\n    _getValue: function() {\n        var rgb = this.$value.css(\"background-color\");\n        rgb = rgb.match(/^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)$/);\n        if (rgb) {\n            function hex(x) {\n                return `0${parseInt(x).toString(16)}`.slice(-2);\n            }\n            return `#${hex(rgb[1])}${hex(rgb[2])}${hex(rgb[3])}`;\n        } else {\n            return null;\n        }\n    },\n\n    /** Build color panel */\n    _build: function() {\n        this._content({ colors: this.colors.base });\n        for (var i in this.colors.theme) {\n            var line_def = {};\n            if (i == 0) {\n                line_def[\"bottom\"] = true;\n            } else if (i != this.colors.theme.length - 1) {\n                line_def[\"top\"] = true;\n                line_def[\"bottom\"] = true;\n            } else {\n                line_def[\"top\"] = true;\n            }\n            line_def[\"colors\"] = this.colors.theme[i];\n            this._content(line_def);\n        }\n        this._content({ colors: this.colors.standard });\n    },\n\n    /** Create content */\n    _content: function(options) {\n        var colors = options.colors;\n        var $content = $(this._templateContent());\n        var $line = $content.find(\".line\");\n        this.$panel.append($content);\n        for (var i in colors) {\n            var $box = $(this._templateBox(colors[i]));\n            if (options.top) {\n                $box.css(\"border-top\", \"none\");\n                $box.css(\"border-top-left-radius\", \"0px\");\n                $box.css(\"border-top-right-radius\", \"0px\");\n            }\n            if (options.bottom) {\n                $box.css(\"border-bottom\", \"none\");\n                $box.css(\"border-bottom-left-radius\", \"0px\");\n                $box.css(\"border-bottom-right-radius\", \"0px\");\n            }\n            $line.append($box);\n        }\n        return $content;\n    },\n\n    /** Check icon */\n    _templateCheck: function() {\n        return '<div class=\"ui-color-picker-check fa fa-check\"/>';\n    },\n\n    /** Content template */\n    _templateContent: function() {\n        return '<div class=\"ui-color-picker-content\">' + '<div class=\"line\"/>' + \"</div>\";\n    },\n\n    /** Box template */\n    _templateBox: function(color) {\n        return `<div id=\"${color}\" class=\"ui-color-picker-box\" style=\"background-color: #${color};\"/>`;\n    },\n\n    /** Main template */\n    _template: function() {\n        return (\n            '<div class=\"ui-color-picker\">' +\n            '<div class=\"ui-color-picker-header\">' +\n            '<div class=\"ui-color-picker-value\"/>' +\n            '<div class=\"ui-color-picker-label\">Select a color</div>' +\n            \"</div>\" +\n            '<div class=\"ui-color-picker-view ui-input\">' +\n            '<div class=\"ui-color-picker-panel\"/>' +\n            \"</div>\"\n        );\n        (\"</div>\");\n    }\n});\n"]}