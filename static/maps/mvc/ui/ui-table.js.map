{"version":3,"sources":["mvc/ui/ui-table.js"],"names":["View","Backbone","extend","initialize","options","merge","content","onchange","ondblclick","onconfirm","cls","selectable","cls_tr","setElement","_template","$thead","$","$tbody","$tmessage","row","_row","row_count","events","click","dblclick","addHeader","$el","append","appendHeader","add","width","align","wrapper","css","id","fade","_commit","prepend","get","del","item","find","length","remove","_refresh","delAll","empty","value","new_value","before","attr","undefined","removeClass","addClass","after","size","hide","fadeIn","_onclick","e","old_value","target","closest","_ondblclick","show"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-table.js","sourcesContent":["/** This class creates a ui table element. */\nimport Utils from \"utils/utils\";\nvar View = Backbone.View.extend({\n    initialize: function(options) {\n        this.options = Utils.merge(options, {\n            content: \"No content available.\",\n            onchange: null,\n            ondblclick: null,\n            onconfirm: null,\n            cls: \"ui-table\",\n            selectable: true,\n            cls_tr: \"\"\n        });\n        this.setElement(this._template());\n        this.$thead = this.$(\"thead\");\n        this.$tbody = this.$(\"tbody\");\n        this.$tmessage = this.$(\"tmessage\");\n        this.row = this._row();\n        this.row_count = 0;\n    },\n\n    events: {\n        click: \"_onclick\",\n        dblclick: \"_ondblclick\"\n    },\n\n    /** Add cell to header row */\n    addHeader: function($el) {\n        this.row.append($(\"<th/>\").append($el));\n    },\n\n    /** Append header row to table */\n    appendHeader: function() {\n        this.$thead.append(this.row);\n        this.row = $(\"<tr/>\");\n    },\n\n    /** Add cell to row */\n    add: function($el, width, align) {\n        var wrapper = $(\"<td/>\");\n        if (width) {\n            wrapper.css(\"width\", width);\n        }\n        if (align) {\n            wrapper.css(\"text-align\", align);\n        }\n        this.row.append(wrapper.append($el));\n    },\n\n    /** Append row to table */\n    append: function(id, fade) {\n        this._commit(id, fade, false);\n    },\n\n    /** Prepend row to table */\n    prepend: function(id, fade) {\n        this._commit(id, fade, true);\n    },\n\n    /** Helper to get row element */\n    get: function(id) {\n        return this.$(`#${id}`);\n    },\n\n    /** Delete row by id */\n    del: function(id) {\n        var item = this.$tbody.find(`#${id}`);\n        if (item.length > 0) {\n            item.remove();\n            this.row_count--;\n            this._refresh();\n        }\n    },\n\n    /** Delete all rows */\n    delAll: function() {\n        this.$tbody.empty();\n        this.row_count = 0;\n        this._refresh();\n    },\n\n    /** Set a value i.e. selects/highlights a particular row by id */\n    value: function(new_value) {\n        if (this.options.selectable) {\n            this.before = this.$tbody.find(\".current\").attr(\"id\");\n            if (new_value !== undefined) {\n                this.$tbody.find(\"tr\").removeClass(\"current\");\n                if (new_value) {\n                    this.$tbody.find(`#${new_value}`).addClass(\"current\");\n                }\n            }\n            var after = this.$tbody.find(\".current\").attr(\"id\");\n            if (after === undefined) {\n                return null;\n            } else {\n                if (after != this.before && this.options.onchange) {\n                    this.options.onchange(new_value);\n                }\n                return after;\n            }\n        }\n    },\n\n    /** Return the number of rows */\n    size: function() {\n        return this.$tbody.find(\"tr\").length;\n    },\n\n    /** Helper to append rows */\n    _commit: function(id, fade, prepend) {\n        this.del(id);\n        this.row.attr(\"id\", id);\n        if (prepend) {\n            this.$tbody.prepend(this.row);\n        } else {\n            this.$tbody.append(this.row);\n        }\n        if (fade) {\n            this.row.hide();\n            this.row.fadeIn();\n        }\n        this.row = this._row();\n        this.row_count++;\n        this._refresh();\n    },\n\n    /** Helper to create new row */\n    _row: function() {\n        return $(`<tr class=\"${this.options.cls_tr}\"></tr>`);\n    },\n\n    /** Handles onclick events */\n    _onclick: function(e) {\n        var old_value = this.value();\n        var new_value = $(e.target)\n            .closest(\"tr\")\n            .attr(\"id\");\n        if (new_value != \"\") {\n            if (new_value && old_value != new_value) {\n                if (this.options.onconfirm) {\n                    this.options.onconfirm(new_value);\n                } else {\n                    this.value(new_value);\n                }\n            }\n        }\n    },\n\n    /** Handles ondblclick events */\n    _ondblclick: function(e) {\n        var value = this.value();\n        if (value && this.options.ondblclick) {\n            this.options.ondblclick(value);\n        }\n    },\n\n    /** Refresh helper */\n    _refresh: function() {\n        if (this.row_count == 0) {\n            this.$tmessage.show();\n        } else {\n            this.$tmessage.hide();\n        }\n    },\n\n    /** Template */\n    _template: function() {\n        return `<div><table class=\"${this.options.cls}\"><thead/><tbody/></table><tmessage>${\n            this.options.content\n        }</tmessage><div>`;\n    }\n});\n\nexport default {\n    View: View\n};\n"]}