{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["View","Backbone","extend","visible","initialize","options","self","model","Model","id","uid","cls","title","icon","buttons","body","scrollable","nopadding","operations","collapsible","collapsible_button","collapsed","onchange_title","set","setElement","_template","$body","$","$title_text","$title_icon","$header","$content","$backdrop","$buttons","$operations","get","append","ButtonIcon","tooltip","onclick","render","attributes","$el","removeClass","addClass","attr","html","_","each","show","hide","off","on","collapse","expand","prop","make_text_editable","on_finish","new_title","empty","name","item","header","fadeIn","enableButton","find","disableButton","hideOperation","showOperation","setOperation","callback","height","setIcon","disable","enable"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["import Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\n\nexport var View = Backbone.View.extend({\n    visible: false,\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                id: Utils.uid(),\n                cls: \"ui-portlet\",\n                title: \"\",\n                icon: \"\",\n                buttons: null,\n                body: null,\n                scrollable: true,\n                nopadding: false,\n                operations: null,\n                collapsible: false,\n                collapsible_button: false,\n                collapsed: false,\n                onchange_title: null\n            }).set(options);\n        this.setElement(this._template());\n\n        // link all dom elements\n        this.$body = this.$(\".portlet-body\");\n        this.$title_text = this.$(\".portlet-title-text\");\n        this.$title_icon = this.$(\".portlet-title-icon\");\n        this.$header = this.$(\".portlet-header\");\n        this.$content = this.$(\".portlet-content\");\n        this.$backdrop = this.$(\".portlet-backdrop\");\n        this.$buttons = this.$(\".portlet-buttons\");\n        this.$operations = this.$(\".portlet-operations\");\n\n        // add body to component list\n        this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n        // add icon for collapsible option\n        this.collapsible_button = new Ui.ButtonIcon({\n            icon: \"fa-eye\",\n            tooltip: \"Collapse/Expand\",\n            cls: \"ui-button-icon-plain\",\n            onclick: function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            }\n        });\n        this.render();\n    },\n\n    render: function() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el\n            .removeClass()\n            .addClass(options.cls)\n            .attr(\"id\", options.id);\n        this.$header[options.title ? \"show\" : \"hide\"]();\n        this.$title_text.html(options.title);\n        _.each([this.$content, this.$body], $el => {\n            $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n        });\n\n        // render title icon\n        if (options.icon) {\n            this.$title_icon\n                .removeClass()\n                .addClass(\"portlet-title-icon fa\")\n                .addClass(options.icon)\n                .show();\n        } else {\n            this.$title_icon.hide();\n        }\n\n        // make portlet collapsible\n        this.$title_text[options.collapsible ? \"addClass\" : \"removeClass\"](\"no-highlight collapsible\").off();\n        if (options.collapsible) {\n            this.$title_text.on(\"click\", () => {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            });\n            options.collapsed ? this.collapse() : this.expand();\n        }\n\n        // allow title editing\n        this.$title_text.prop(\"disabled\", !options.onchange_title);\n        options.onchange_title &&\n            this.$title_text.make_text_editable({\n                on_finish: function(new_title) {\n                    options.onchange_title(new_title);\n                }\n            });\n\n        // render buttons\n        if (options.buttons) {\n            this.$buttons.empty().show();\n            $.each(this.model.get(\"buttons\"), (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$buttons.append(item.$el);\n            });\n        } else {\n            this.$buttons.hide();\n        }\n\n        // render operations\n        this.$operations.empty;\n        if (options.collapsible_button) {\n            this.$operations.append(this.collapsible_button.$el);\n        }\n        if (options.operations) {\n            $.each(options.operations, (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$operations.append(item.$el);\n            });\n        }\n        return this;\n    },\n\n    /** Append new doms to body */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /** Remove all content */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /** Return header element */\n    header: function() {\n        return this.$header;\n    },\n\n    /** Return body element */\n    body: function() {\n        return this.$body;\n    },\n\n    /** Show portlet */\n    show: function() {\n        this.visible = true;\n        this.$el.fadeIn(\"fast\");\n    },\n\n    /** Hide portlet */\n    hide: function() {\n        this.visible = false;\n        this.$el.hide();\n    },\n\n    /** Enable a particular button */\n    enableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", false);\n    },\n\n    /** Disable a particular button */\n    disableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", true);\n    },\n\n    /** Hide a particular operation */\n    hideOperation: function(id) {\n        this.$operations.find(`#${id}`).hide();\n    },\n\n    /** Show a particular operation */\n    showOperation: function(id) {\n        this.$operations.find(`#${id}`).show();\n    },\n\n    /** Replaces the event callback of an existing operation */\n    setOperation: function(id, callback) {\n        this.$operations\n            .find(`#${id}`)\n            .off(\"click\")\n            .on(\"click\", callback);\n    },\n\n    /** Change title */\n    title: function(new_title) {\n        new_title && this.$title_text.html(new_title);\n        return this.$title_text.html();\n    },\n\n    /** Collapse portlet */\n    collapse: function() {\n        this.collapsed = true;\n        this.$content.height(\"0%\");\n        this.$body.hide();\n        this.collapsible_button.setIcon(\"fa-eye-slash\");\n    },\n\n    /** Expand portlet */\n    expand: function() {\n        this.collapsed = false;\n        this.$content.height(\"100%\");\n        this.$body.fadeIn(\"fast\");\n        this.collapsible_button.setIcon(\"fa-eye\");\n    },\n\n    /** Disable content access */\n    disable: function() {\n        this.$backdrop.show();\n    },\n\n    /** Enable content access */\n    enable: function() {\n        this.$backdrop.hide();\n    },\n\n    _template: function() {\n        return $(\"<div/>\")\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-header\")\n                    .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                    .append(\n                        $(\"<div/>\")\n                            .addClass(\"portlet-title\")\n                            .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                            .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                    )\n            )\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-content\")\n                    .append($(\"<div/>\").addClass(\"portlet-body\"))\n                    .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n            )\n            .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n    }\n});\nexport default {\n    View: View\n};\n"]}