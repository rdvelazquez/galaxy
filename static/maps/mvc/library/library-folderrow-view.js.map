{"version":3,"sources":["mvc/library/library-folderrow-view.js"],"names":["FolderRowView","Backbone","View","extend","events","defaults","type","visibility_config","edit_folder_btn","save_folder_btn","cancel_folder_btn","permission_folder_btn","edit_mode","initialize","options","_","render","folder_item","model","template","get","prepareButtons","templateRowDeletedFolder","templateRowFolder","templateRowDeletedFile","templateRowFile","Galaxy","emit","error","setElement","content_item","button_config","$el","show","folder","vis_config","showDatasetDetails","libraries","datasetView","LibraryDatasetView","id","undeleteDataset","event","$","hide","that","dataset_id","target","closest","data","dataset","folderListView","collection","url","urlRoot","destroy","success","response","remove","updated_dataset","Item","add","sortFolder","onclick","folder_id","window","location","root","responseJSON","err_msg","undeleteFolder","updated_folder","FolderAsModel","startModifications","repaint","cancelModifications","saveModifications","is_changed","new_name","find","val","length","set","warning","new_description","row_view","save","patch","info","old_element","replaceWith","tooltip","join"],"mappings":"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","file":"../../../scripts/mvc/library/library-folderrow-view.js","sourcesContent":["import mod_toastr from \"libs/toastr\";\nimport mod_library_model from \"mvc/library/library-model\";\nimport mod_library_dataset_view from \"mvc/library/library-dataset-view\";\nvar FolderRowView = Backbone.View.extend({\n    events: {\n        \"click .undelete_dataset_btn\": \"undeleteDataset\",\n        \"click .undelete_folder_btn\": \"undeleteFolder\",\n        \"click .edit_folder_btn\": \"startModifications\",\n        \"click .cancel_folder_btn\": \"cancelModifications\",\n        \"click .save_folder_btn\": \"saveModifications\"\n    },\n\n    defaults: {\n        type: null,\n        visibility_config: {\n            edit_folder_btn: false,\n            save_folder_btn: false,\n            cancel_folder_btn: false,\n            permission_folder_btn: false\n        },\n        edit_mode: false\n    },\n\n    initialize: function(options) {\n        this.options = _.defaults(options || {}, this.defaults);\n        this.render(this.options);\n    },\n\n    render: function(options) {\n        this.options = _.extend(this.options, options);\n        var folder_item = this.options.model;\n        var template = null;\n\n        if (folder_item.get(\"type\") === \"folder\" || folder_item.get(\"model_class\") === \"LibraryFolder\") {\n            this.options.type = \"folder\";\n            this.prepareButtons(folder_item);\n            if (folder_item.get(\"deleted\")) {\n                template = this.templateRowDeletedFolder();\n            } else {\n                template = this.templateRowFolder();\n            }\n        } else if (\n            folder_item.get(\"type\") === \"file\" ||\n            folder_item.get(\"model_class\") === \"LibraryDatasetDatasetAssociation\" ||\n            folder_item.get(\"model_class\") === \"LibraryDataset\"\n        ) {\n            this.options.type = \"file\";\n            if (folder_item.get(\"deleted\")) {\n                template = this.templateRowDeletedFile();\n            } else {\n                template = this.templateRowFile();\n            }\n        } else {\n            Galaxy.emit.error(\"Unknown library item type found.\");\n            Galaxy.emit.error(folder_item.get(\"type\") || folder_item.get(\"model_class\"));\n        }\n        this.setElement(\n            template({\n                content_item: folder_item,\n                edit_mode: this.options.edit_mode,\n                button_config: this.options.visibility_config\n            })\n        );\n        this.$el.show();\n        return this;\n    },\n\n    /**\n     * Modify the visibility of buttons for\n     * the filling of the row template of a given folder.\n     */\n    prepareButtons: function(folder) {\n        var vis_config = this.options.visibility_config;\n        if (this.options.edit_mode === false) {\n            vis_config.save_folder_btn = false;\n            vis_config.cancel_folder_btn = false;\n            if (folder.get(\"deleted\") === true) {\n                vis_config.edit_folder_btn = false;\n                vis_config.permission_folder_btn = false;\n            } else if (folder.get(\"deleted\") === false) {\n                vis_config.save_folder_btn = false;\n                vis_config.cancel_folder_btn = false;\n                if (folder.get(\"can_modify\") === true) {\n                    vis_config.edit_folder_btn = true;\n                }\n                if (folder.get(\"can_manage\") === true) {\n                    vis_config.permission_folder_btn = true;\n                }\n            }\n        } else if (this.options.edit_mode === true) {\n            vis_config.edit_folder_btn = false;\n            vis_config.permission_folder_btn = false;\n            vis_config.save_folder_btn = true;\n            vis_config.cancel_folder_btn = true;\n        }\n        this.options.visibility_config = vis_config;\n    },\n\n    /* Show the page with dataset details. */\n    showDatasetDetails: function() {\n        Galaxy.libraries.datasetView = new mod_library_dataset_view.LibraryDatasetView({ id: this.id });\n    },\n\n    /* Undelete the dataset on server and render the row again. */\n    undeleteDataset: function(event) {\n        $(\".tooltip\").hide();\n        var that = this;\n        var dataset_id = $(event.target)\n            .closest(\"tr\")\n            .data(\"id\");\n        var dataset = Galaxy.libraries.folderListView.collection.get(dataset_id);\n        dataset.url = `${dataset.urlRoot + dataset.id}?undelete=true`;\n        dataset.destroy({\n            success: function(model, response) {\n                Galaxy.libraries.folderListView.collection.remove(dataset_id);\n                var updated_dataset = new mod_library_model.Item(response);\n                Galaxy.libraries.folderListView.collection.add(updated_dataset);\n                Galaxy.libraries.folderListView.collection.sortFolder(\"name\", \"asc\");\n                mod_toastr.success(\"Dataset undeleted. Click this to see it.\", \"\", {\n                    onclick: function() {\n                        var folder_id = that.model.get(\"folder_id\");\n                        window.location = `${Galaxy.root}library/list#folders/${folder_id}/datasets/${that.id}`;\n                    }\n                });\n            },\n            error: function(model, response) {\n                if (typeof response.responseJSON !== \"undefined\") {\n                    mod_toastr.error(`Dataset was not undeleted. ${response.responseJSON.err_msg}`);\n                } else {\n                    mod_toastr.error(\"An error occured! Dataset was not undeleted. Please try again.\");\n                }\n            }\n        });\n    },\n\n    /* Undelete the folder on server and render the row again. */\n    undeleteFolder: function(event) {\n        $(\".tooltip\").hide();\n        var that = this;\n        var folder_id = $(event.target)\n            .closest(\"tr\")\n            .data(\"id\");\n        var folder = Galaxy.libraries.folderListView.collection.get(folder_id);\n        folder.url = `${folder.urlRoot + folder.id}?undelete=true`;\n        folder.destroy({\n            success: function(model, response) {\n                Galaxy.libraries.folderListView.collection.remove(folder_id);\n                var updated_folder = new mod_library_model.FolderAsModel(response);\n                Galaxy.libraries.folderListView.collection.add(updated_folder);\n                Galaxy.libraries.folderListView.collection.sortFolder(\"name\", \"asc\");\n                mod_toastr.success(\"Folder undeleted.\");\n            },\n            error: function(model, response) {\n                if (typeof response.responseJSON !== \"undefined\") {\n                    mod_toastr.error(`Folder was not undeleted. ${response.responseJSON.err_msg}`);\n                } else {\n                    mod_toastr.error(\"An error occured! Folder was not undeleted. Please try again.\");\n                }\n            }\n        });\n    },\n\n    /* User clicked the 'edit' button on row so render the row as editable. */\n    startModifications: function() {\n        this.options.edit_mode = true;\n        this.repaint();\n    },\n\n    /* User clicked the 'cancel' button so render normal row */\n    cancelModifications: function() {\n        this.options.edit_mode = false;\n        this.repaint();\n    },\n\n    saveModifications: function() {\n        var folder = Galaxy.libraries.folderListView.collection.get(this.$el.data(\"id\"));\n        var is_changed = false;\n        var new_name = this.$el.find(\".input_folder_name\").val();\n        if (typeof new_name !== \"undefined\" && new_name !== folder.get(\"name\")) {\n            if (new_name.length > 2) {\n                folder.set(\"name\", new_name);\n                is_changed = true;\n            } else {\n                mod_toastr.warning(\"Folder name has to be at least 3 characters long.\");\n                return;\n            }\n        }\n        var new_description = this.$el.find(\".input_folder_description\").val();\n        if (typeof new_description !== \"undefined\" && new_description !== folder.get(\"description\")) {\n            folder.set(\"description\", new_description);\n            is_changed = true;\n        }\n        if (is_changed) {\n            var row_view = this;\n            folder.save(null, {\n                patch: true,\n                success: function(folder) {\n                    row_view.options.edit_mode = false;\n                    row_view.repaint(folder);\n                    mod_toastr.success(\"Changes to folder saved.\");\n                },\n                error: function(model, response) {\n                    if (typeof response.responseJSON !== \"undefined\") {\n                        mod_toastr.error(response.responseJSON.err_msg);\n                    } else {\n                        mod_toastr.error(\"An error occured while attempting to update the folder.\");\n                    }\n                }\n            });\n        } else {\n            this.options.edit_mode = false;\n            this.repaint(folder);\n            mod_toastr.info(\"Nothing has changed.\");\n        }\n    },\n\n    repaint: function() {\n        /* need to hide manually because of the element removal in setElement\n    invoked in render() */\n        $(\".tooltip\").hide();\n        /* we need to store the old element to be able to replace it with\n    new one */\n        var old_element = this.$el;\n        /* if user canceled the folder param is undefined,\n      if user saved and succeeded the updated folder is rendered */\n        this.render();\n        old_element.replaceWith(this.$el);\n        /* now we attach new tooltips to the newly created row element */\n        this.$el.find(\"[data-toggle]\").tooltip();\n    },\n\n    templateRowFolder: function() {\n        return _.template(\n            [\n                '<tr class=\"folder_row light library-row\" data-id=\"<%- content_item.id %>\">',\n                \"<td>\",\n                '<span title=\"Folder\" class=\"fa fa-folder-o\"/>',\n                \"</td>\",\n                '<td style=\"text-align: center; \"><input style=\"margin: 0;\" type=\"checkbox\"></td>',\n                \"<% if(!edit_mode) { %>\",\n                \"<td>\",\n                '<a href=\"#folders/<%- content_item.id %>\"><%- content_item.get(\"name\") %></a>',\n                \"</td>\",\n                \"<td>\",\n                '<%- content_item.get(\"description\") %>',\n                \"</td>\",\n                \"<% } else if(edit_mode){ %>\",\n                '<td><textarea rows=\"4\" class=\"form-control input_folder_name\" placeholder=\"name\" ><%- content_item.get(\"name\") %></textarea></td>',\n                '<td><textarea rows=\"4\" class=\"form-control input_folder_description\" placeholder=\"description\" ><%- content_item.get(\"description\") %></textarea></td>',\n                \"<% } %>\",\n                \"<td>folder</td>\",\n                \"<td></td>\",\n                \"<td>\",\n                '<%= _.escape(content_item.get(\"update_time\")) %>',\n                \"</td>\",\n                \"<td></td>\",\n                \"<td>\",\n                \"<% if(edit_mode) { %>\", // start edit mode\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Save changes\" class=\"primary-button btn-xs save_folder_btn\" type=\"button\" style=\"<% if(button_config.save_folder_btn === false) { print(\"display:none;\") } %>\">',\n                '<span class=\"fa fa-floppy-o\"/> Save',\n                \"</button>\",\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Discard changes\" class=\"primary-button btn-xs cancel_folder_btn\" type=\"button\" style=\"<% if(button_config.cancel_folder_btn === false) { print(\"display:none;\") } %>\">',\n                '<span class=\"fa fa-times\"/> Cancel',\n                \"</button>\",\n                \"<% } else if (!edit_mode){%>\", // start no edit mode\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Modify \\'<%- content_item.get(\"name\") %>\\'\" class=\"primary-button btn-xs edit_folder_btn\" type=\"button\" style=\"<% if(button_config.edit_folder_btn === false) { print(\"display:none;\") } %>\">',\n                '<span class=\"fa fa-pencil\"/> Edit',\n                \"</button>\",\n                '<a href=\"#/folders/<%- content_item.id %>/permissions\">',\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" class=\"primary-button btn-xs permission_folder_btn\" title=\"Permissions of \\'<%- content_item.get(\"name\") %>\\'\" style=\"<% if(button_config.permission_folder_btn === false) { print(\"display:none;\") } %>\">',\n                '<span class=\"fa fa-group\"/> Manage',\n                \"</button>\",\n                \"</a>\",\n                \"<% } %>\", //end no edit mode\n                \"</td>\",\n                \"</tr>\"\n            ].join(\"\")\n        );\n    },\n\n    templateRowFile: function() {\n        return _.template(\n            [\n                '<tr class=\"dataset_row light library-row\" data-id=\"<%- content_item.id %>\">',\n                \"<td>\",\n                '<span title=\"Dataset\" class=\"fa fa-file-o\"/>',\n                \"</td>\",\n                '<td style=\"text-align: center; \">',\n                '<input style=\"margin: 0;\" type=\"checkbox\">',\n                \"</td>\",\n                \"<td>\",\n                '<a href=\"#folders/<%- content_item.get(\"folder_id\") %>/datasets/<%- content_item.id %>\" class=\"library-dataset\">',\n                '<%- content_item.get(\"name\") %>',\n                \"<a>\",\n                \"</td>\",\n                '<td><%- content_item.get(\"message\") %></td>',\n                '<td><%= _.escape(content_item.get(\"file_ext\")) %></td>',\n                '<td><%= _.escape(content_item.get(\"file_size\")) %></td>',\n                '<td><%= _.escape(content_item.get(\"update_time\")) %></td>',\n                \"<td>\",\n                '<% if ( content_item.get(\"state\") !== \"ok\" ) { %>',\n                '<%= _.escape(content_item.get(\"state\")) %>',\n                \"<% } %>\",\n                \"</td>\",\n                \"<td>\",\n                '<% if (content_item.get(\"is_unrestricted\")) { %>',\n                '<span data-toggle=\"tooltip\" data-placement=\"top\" title=\"Unrestricted dataset\" style=\"color:grey;\" class=\"fa fa-globe fa-lg\"/>',\n                \"<% } %>\",\n                '<% if (content_item.get(\"is_private\")) { %>',\n                '<span data-toggle=\"tooltip\" data-placement=\"top\" title=\"Private dataset\" style=\"color:grey;\" class=\"fa fa-key fa-lg\"/>',\n                \"<% } %>\",\n                '<% if ((content_item.get(\"is_unrestricted\") === false) && (content_item.get(\"is_private\") === false)) { %>',\n                '<span data-toggle=\"tooltip\" data-placement=\"top\" title=\"Restricted dataset\" style=\"color:grey;\" class=\"fa fa-shield fa-lg\"/>',\n                \"<% } %>\",\n                '<% if (content_item.get(\"can_manage\")) { %>',\n                '<a href=\"#folders/<%- content_item.get(\"folder_id\") %>/datasets/<%- content_item.id %>/permissions\">',\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" class=\"primary-button btn-xs permissions-dataset-btn\" title=\"Permissions of \\'<%- content_item.get(\"name\") %>\\'\">',\n                '<span class=\"fa fa-group\"/> Manage',\n                \"</button>\",\n                \"</a>\",\n                \"<% } %>\",\n                \"</td>\",\n                \"</tr>\"\n            ].join(\"\")\n        );\n    },\n\n    templateRowDeletedFile: function() {\n        return _.template(\n            [\n                '<tr class=\"active deleted_dataset library-row\" data-id=\"<%- content_item.id %>\">',\n                \"<td>\",\n                '<span title=\"Dataset\" class=\"fa fa-file-o\"/>',\n                \"</td>\",\n                \"<td></td>\",\n                '<td style=\"color:grey;\">',\n                '<%- content_item.get(\"name\") %>',\n                \"</td>\",\n                \"<td>\",\n                '<%- content_item.get(\"message\") %>',\n                \"</td>\",\n                \"<td>\",\n                '<%= _.escape(content_item.get(\"file_ext\")) %>',\n                \"</td>\",\n                \"<td>\",\n                '<%= _.escape(content_item.get(\"file_size\")) %>',\n                \"</td>\",\n                \"<td>\",\n                '<%= _.escape(content_item.get(\"update_time\")) %>',\n                \"</td>\",\n                \"<td>\",\n                '<% if ( content_item.get(\"state\") !== \"ok\" ) { %>',\n                '<%= _.escape(content_item.get(\"state\")) %>',\n                \"<% } %>\",\n                \"</td>\",\n                \"<td>\",\n                '<span data-toggle=\"tooltip\" data-placement=\"top\" title=\"Marked deleted\" style=\"color:grey;\" class=\"fa fa-ban fa-lg\"/>',\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Undelete \\'<%- content_item.get(\"name\") %>\\'\" class=\"primary-button btn-xs undelete_dataset_btn\" type=\"button\" style=\"margin-left:1em;\">',\n                '<span class=\"fa fa-unlock\"/> Undelete',\n                \"</button>\",\n                \"</td>\",\n                \"</tr>\"\n            ].join(\"\")\n        );\n    },\n\n    templateRowDeletedFolder: function() {\n        return _.template(\n            [\n                '<tr class=\"active deleted_folder light library-row\" data-id=\"<%- content_item.id %>\">',\n                \"<td>\",\n                '<span title=\"Folder\" class=\"fa fa-folder-o\"/>',\n                \"</td>\",\n                \"<td></td>\",\n                '<td style=\"color:grey;\">',\n                '<%- content_item.get(\"name\") %>',\n                \"</td>\",\n                \"<td>\",\n                '<%- content_item.get(\"description\") %>',\n                \"</td>\",\n                \"<td>\",\n                \"folder\",\n                \"</td>\",\n                \"<td></td>\",\n                \"<td>\",\n                '<%= _.escape(content_item.get(\"update_time\")) %>',\n                \"</td>\",\n                \"<td></td>\",\n                \"<td>\",\n                '<span data-toggle=\"tooltip\" data-placement=\"top\" title=\"Marked deleted\" style=\"color:grey;\" class=\"fa fa-ban fa-lg\"/>',\n                '<button data-toggle=\"tooltip\" data-placement=\"top\" title=\"Undelete \\'<%- content_item.get(\"name\") %>\\'\" class=\"primary-button btn-xs undelete_folder_btn\" type=\"button\" style=\"margin-left:1em;\">',\n                '<span class=\"fa fa-unlock\"/> Undelete',\n                \"</button>\",\n                \"</td>\",\n                \"</tr>\"\n            ].join(\"\")\n        );\n    }\n});\n\nexport default {\n    FolderRowView: FolderRowView\n};\n"]}