{"version":3,"sources":["polyfills.js"],"names":["window","console","log","debug","info","warn","error","assert","Object","assign","_","extend","lastTime","vendors","x","length","requestAnimationFrame","cancelRequestAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","cancelAnimationFrame","clearTimeout","features","name","compatible","CanvasRenderingContext2D","sessionStorage","err","incompatibilities","filter","feature","map","root","document","querySelectorAll","item","location","href","join"],"mappings":";;;AAAA;;;;;AAKA,KAAC,YAAM;AACH;;;;;AAKA;AACA;;AAEA;AACA;;AACAA,eAAOC,OAAP,GAAiBD,OAAOC,OAAP,IAAkB;AAC/BC,iBAAK,eAAW,CAAE,CADa;AAE/BC,mBAAO,iBAAW,CAAE,CAFW;AAG/BC,kBAAM,gBAAW,CAAE,CAHY;AAI/BC,kBAAM,gBAAW,CAAE,CAJY;AAK/BC,mBAAO,iBAAW,CAAE,CALW;AAM/BC,oBAAQ,kBAAW,CAAE;AANU,SAAnC;;AASA;AACAC,eAAOC,MAAP,GAAgBD,OAAOC,MAAP,IAAiBC,EAAEC,MAAnC;;AAEA;AACA,YAAIC,WAAW,CAAf;AACA,YAAIC,UAAU,CAAC,IAAD,EAAO,KAAP,EAAc,QAAd,EAAwB,GAAxB,CAAd;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAID,QAAQE,MAAZ,IAAsB,CAACf,OAAOgB,qBAA9C,EAAqE,EAAEF,CAAvE,EAA0E;AACtEd,mBAAOgB,qBAAP,GAA+BhB,OAAUa,QAAQC,CAAR,CAAV,2BAA/B;AACAd,mBAAOiB,2BAAP,GAAqCjB,OAAUa,QAAQC,CAAR,CAAV,iCAArC;AACH;;AAED,YAAI,CAACd,OAAOgB,qBAAZ,EACIhB,OAAOgB,qBAAP,GAA+B,UAACE,QAAD,EAAWC,OAAX,EAAuB;AAClD,gBAAIC,WAAW,IAAIC,IAAJ,GAAWC,OAAX,EAAf;AACA,gBAAIC,aAAaC,KAAKC,GAAL,CAAS,CAAT,EAAY,MAAML,WAAWR,QAAjB,CAAZ,CAAjB;AACA,gBAAIc,KAAK1B,OAAO2B,UAAP,CAAkB,YAAM;AAC7BT,yBAASE,WAAWG,UAApB;AACH,aAFQ,EAENA,UAFM,CAAT;AAGAX,uBAAWQ,WAAWG,UAAtB;AACA,mBAAOG,EAAP;AACH,SARD;;AAUJ,YAAI,CAAC1B,OAAO4B,oBAAZ,EACI5B,OAAO4B,oBAAP,GAA8B,cAAM;AAChCC,yBAAaH,EAAb;AACH,SAFD;;AAIJ;AACA,YAAII,WAAW,CACX;AACIC,kBAAM,QADV;AAEIC,wBAAY,sBAAW;AACnB,uBAAOhC,OAAOiC,wBAAd;AACH;AAJL,SADW,EAOX;AACIF,kBAAM,gBADV;AAEIC,wBAAY,sBAAW;AACnB,oBAAI;AACA,2BAAOhC,OAAOkC,cAAP,CAAsBnB,MAAtB,IAAgC,CAAvC;AACH,iBAFD,CAEE,OAAOoB,GAAP,EAAY,CAAE;AAChB,uBAAO,KAAP;AACH;AAPL,SAPW,CAAf;AAiBA;AACA,YAAIC,oBAAoBN,SAASO,MAAT,CAAgB;AAAA,mBAAW,CAACC,QAAQN,UAAR,EAAZ;AAAA,SAAhB,EAAkDO,GAAlD,CAAsD;AAAA,mBAAWD,QAAQP,IAAnB;AAAA,SAAtD,CAAxB;;AAEA;AACA,YAAI,CAAC,CAACK,kBAAkBrB,MAAxB,EAAgC;AAC5B,gBAAIyB,OAAOC,SAASC,gBAAT,CAA0B,mBAA1B,EAA+CC,IAA/C,CAAoD,CAApD,CAAX;AACA,gBAAIH,IAAJ,EAAU;AACNxC,uBAAO4C,QAAP,GAAqBJ,KAAKK,IAA1B;AACH;AACD5C,oBAAQC,GAAR,6BAAsCkC,kBAAkBU,IAAlB,CAAuB,IAAvB,CAAtC;AACH;AACJ,KA5ED","file":"../scripts/polyfills.js","sourcesContent":["/**\n    Perform feature inference and redirect if below some minimum (must have canvas, etc.)\n    and polyfill for non-standard features.\n */\n\n(() => {\n    /* TODO: move to modernizr or something besides us doing this...\n     * These are across all of our apps (reports, tool shed), but:\n     *     these should be configurable via options because they all need different things.\n     * So, analysis-polyfills.js, reports-polyfills.js (or analysis/polyfills)\n     */\n    \"use strict\";\n    /*globals window, clearTimeout */\n\n    // ------------------------------------------------------------------ polyfills\n    // console protection needed in some versions of IE (at this point (IE>=9), shouldn't be needed)\n    window.console = window.console || {\n        log: function() {},\n        debug: function() {},\n        info: function() {},\n        warn: function() {},\n        error: function() {},\n        assert: function() {}\n    };\n\n    // phantomjs: does not have the native extend fn assign\n    Object.assign = Object.assign || _.extend;\n\n    // requestAnimationFrame polyfill\n    var lastTime = 0;\n    var vendors = [\"ms\", \"moz\", \"webkit\", \"o\"];\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[`${vendors[x]}RequestAnimationFrame`];\n        window.cancelRequestAnimationFrame = window[`${vendors[x]}CancelRequestAnimationFrame`];\n    }\n\n    if (!window.requestAnimationFrame)\n        window.requestAnimationFrame = (callback, element) => {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\n            var id = window.setTimeout(() => {\n                callback(currTime + timeToCall);\n            }, timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n\n    if (!window.cancelAnimationFrame)\n        window.cancelAnimationFrame = id => {\n            clearTimeout(id);\n        };\n\n    // ------------------------------------------------------------------ can't/won't polyfill\n    var features = [\n        {\n            name: \"canvas\",\n            compatible: function() {\n                return window.CanvasRenderingContext2D;\n            }\n        },\n        {\n            name: \"sessionStorage\",\n            compatible: function() {\n                try {\n                    return window.sessionStorage.length >= 0;\n                } catch (err) {}\n                return false;\n            }\n        }\n    ];\n    // build a list of feature names for features that were not found\n    var incompatibilities = features.filter(feature => !feature.compatible()).map(feature => feature.name);\n\n    // if there are needed features missing, follow the index link to the static incompat warning\n    if (!!incompatibilities.length) {\n        var root = document.querySelectorAll('link[rel=\"index\"]').item(0);\n        if (root) {\n            window.location = `${root.href}static/incompatible-browser.html`;\n        }\n        console.log(`incompatible browser:\\n${incompatibilities.join(\"\\n\")}`);\n    }\n})();\n"]}