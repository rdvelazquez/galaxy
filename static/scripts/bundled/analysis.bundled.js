webpackJsonp([1],[
/* 0 */,
/* 1 */,
/* 2 */,
/* 3 */,
/* 4 */,
/* 5 */,
/* 6 */,
/* 7 */,
/* 8 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/states.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n//==============================================================================\n/** Map of possible HDA/collection/job states to their string equivalents.\n *      A port of galaxy.model.Dataset.states.\n */\nvar STATES = {\n    // NOT ready states\n    /** is uploading and not ready */\n    UPLOAD: \"upload\",\n    /** the job that will produce the dataset queued in the runner */\n    QUEUED: \"queued\",\n    /** the job that will produce the dataset is running */\n    RUNNING: \"running\",\n    /** metadata for the dataset is being discovered/set */\n    SETTING_METADATA: \"setting_metadata\",\n\n    // ready states\n    /** was created without a tool */\n    NEW: \"new\",\n    /** has no data */\n    EMPTY: \"empty\",\n    /** has successfully completed running */\n    OK: \"ok\",\n\n    /** the job that will produce the dataset paused */\n    PAUSED: \"paused\",\n    /** metadata discovery/setting failed or errored (but otherwise ok) */\n    FAILED_METADATA: \"failed_metadata\",\n    //TODO: not in trans.app.model.Dataset.states - is in database\n    /** not accessible to the current user (i.e. due to permissions) */\n    NOT_VIEWABLE: \"noPermission\",\n    /** deleted while uploading */\n    DISCARDED: \"discarded\",\n    /** the tool producing this dataset failed */\n    ERROR: \"error\"\n};\n\nSTATES.READY_STATES = [STATES.OK, STATES.EMPTY, STATES.PAUSED, STATES.FAILED_METADATA, STATES.NOT_VIEWABLE, STATES.DISCARDED, STATES.ERROR];\n\nSTATES.NOT_READY_STATES = [STATES.UPLOAD, STATES.QUEUED, STATES.RUNNING, STATES.SETTING_METADATA, STATES.NEW];\n\n//==============================================================================\nexports.default = STATES;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9nYWxheHkvc2NyaXB0cy9tdmMvZGF0YXNldC9zdGF0ZXMuanM/YmQ4MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIE1hcCBvZiBwb3NzaWJsZSBIREEvY29sbGVjdGlvbi9qb2Igc3RhdGVzIHRvIHRoZWlyIHN0cmluZyBlcXVpdmFsZW50cy5cbiAqICAgICAgQSBwb3J0IG9mIGdhbGF4eS5tb2RlbC5EYXRhc2V0LnN0YXRlcy5cbiAqL1xudmFyIFNUQVRFUyA9IHtcbiAgICAvLyBOT1QgcmVhZHkgc3RhdGVzXG4gICAgLyoqIGlzIHVwbG9hZGluZyBhbmQgbm90IHJlYWR5ICovXG4gICAgVVBMT0FEOiBcInVwbG9hZFwiLFxuICAgIC8qKiB0aGUgam9iIHRoYXQgd2lsbCBwcm9kdWNlIHRoZSBkYXRhc2V0IHF1ZXVlZCBpbiB0aGUgcnVubmVyICovXG4gICAgUVVFVUVEOiBcInF1ZXVlZFwiLFxuICAgIC8qKiB0aGUgam9iIHRoYXQgd2lsbCBwcm9kdWNlIHRoZSBkYXRhc2V0IGlzIHJ1bm5pbmcgKi9cbiAgICBSVU5OSU5HOiBcInJ1bm5pbmdcIixcbiAgICAvKiogbWV0YWRhdGEgZm9yIHRoZSBkYXRhc2V0IGlzIGJlaW5nIGRpc2NvdmVyZWQvc2V0ICovXG4gICAgU0VUVElOR19NRVRBREFUQTogXCJzZXR0aW5nX21ldGFkYXRhXCIsXG5cbiAgICAvLyByZWFkeSBzdGF0ZXNcbiAgICAvKiogd2FzIGNyZWF0ZWQgd2l0aG91dCBhIHRvb2wgKi9cbiAgICBORVc6IFwibmV3XCIsXG4gICAgLyoqIGhhcyBubyBkYXRhICovXG4gICAgRU1QVFk6IFwiZW1wdHlcIixcbiAgICAvKiogaGFzIHN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQgcnVubmluZyAqL1xuICAgIE9LOiBcIm9rXCIsXG5cbiAgICAvKiogdGhlIGpvYiB0aGF0IHdpbGwgcHJvZHVjZSB0aGUgZGF0YXNldCBwYXVzZWQgKi9cbiAgICBQQVVTRUQ6IFwicGF1c2VkXCIsXG4gICAgLyoqIG1ldGFkYXRhIGRpc2NvdmVyeS9zZXR0aW5nIGZhaWxlZCBvciBlcnJvcmVkIChidXQgb3RoZXJ3aXNlIG9rKSAqL1xuICAgIEZBSUxFRF9NRVRBREFUQTogXCJmYWlsZWRfbWV0YWRhdGFcIixcbiAgICAvL1RPRE86IG5vdCBpbiB0cmFucy5hcHAubW9kZWwuRGF0YXNldC5zdGF0ZXMgLSBpcyBpbiBkYXRhYmFzZVxuICAgIC8qKiBub3QgYWNjZXNzaWJsZSB0byB0aGUgY3VycmVudCB1c2VyIChpLmUuIGR1ZSB0byBwZXJtaXNzaW9ucykgKi9cbiAgICBOT1RfVklFV0FCTEU6IFwibm9QZXJtaXNzaW9uXCIsXG4gICAgLyoqIGRlbGV0ZWQgd2hpbGUgdXBsb2FkaW5nICovXG4gICAgRElTQ0FSREVEOiBcImRpc2NhcmRlZFwiLFxuICAgIC8qKiB0aGUgdG9vbCBwcm9kdWNpbmcgdGhpcyBkYXRhc2V0IGZhaWxlZCAqL1xuICAgIEVSUk9SOiBcImVycm9yXCJcbn07XG5cblNUQVRFUy5SRUFEWV9TVEFURVMgPSBbXG4gICAgU1RBVEVTLk9LLFxuICAgIFNUQVRFUy5FTVBUWSxcbiAgICBTVEFURVMuUEFVU0VELFxuICAgIFNUQVRFUy5GQUlMRURfTUVUQURBVEEsXG4gICAgU1RBVEVTLk5PVF9WSUVXQUJMRSxcbiAgICBTVEFURVMuRElTQ0FSREVELFxuICAgIFNUQVRFUy5FUlJPUlxuXTtcblxuU1RBVEVTLk5PVF9SRUFEWV9TVEFURVMgPSBbU1RBVEVTLlVQTE9BRCwgU1RBVEVTLlFVRVVFRCwgU1RBVEVTLlJVTk5JTkcsIFNUQVRFUy5TRVRUSU5HX01FVEFEQVRBLCBTVEFURVMuTkVXXTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IFNUQVRFUztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvZGF0YXNldC9zdGF0ZXMuanMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBN0JBO0FBQ0E7QUErQkE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///8\n");

/***/ }),
/* 9 */,
/* 10 */
/*!*********************************************!*\
  !*** ./galaxy/scripts/ui/fa-icon-button.js ***!
  \*********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _jquery = __webpack_require__(/*! jquery */ 0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\"use_strict\";\n\nvar $ = _jquery2.default;\n//============================================================================\n/** Returns a jQuery object containing a clickable font-awesome button.\n *      options:\n *          tooltipConfig   : option map for bootstrap tool tip\n *          classes         : array of class names (will always be classed as icon-btn)\n *          disabled        : T/F - add the 'disabled' class?\n *          title           : tooltip/title string\n *          target          : optional href target\n *          href            : optional href\n *          faIcon          : which font awesome icon to use\n *          onclick         : function to call when the button is clicked\n */\nvar faIconButton = function faIconButton(options) {\n    options = options || {};\n    options.tooltipConfig = options.tooltipConfig || {\n        placement: \"bottom\"\n    };\n\n    options.classes = [\"icon-btn\"].concat(options.classes || []);\n    if (options.disabled) {\n        options.classes.push(\"disabled\");\n    }\n\n    var html = ['<a class=\"', options.classes.join(\" \"), '\"', options.title ? \" title=\\\"\" + options.title + \"\\\"\" : \"\", !options.disabled && options.target ? \" target=\\\"\" + options.target + \"\\\"\" : \"\", ' href=\"', !options.disabled && options.href ? options.href : \"javascript:void(0);\", '\">',\n    // could go with something less specific here - like 'html'\n    '<span class=\"fa ', options.faIcon, '\"></span>', \"</a>\"].join(\"\");\n    var $button = $(html).tooltip(options.tooltipConfig);\n    if (_.isFunction(options.onclick)) {\n        $button.click(options.onclick);\n    }\n    return $button;\n};\n\n//============================================================================\nexports.default = faIconButton;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdWkvZmEtaWNvbi1idXR0b24uanM/YzU2NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgalF1ZXJ5IGZyb20gXCJqcXVlcnlcIjtcbihcInVzZV9zdHJpY3RcIik7XG5cbnZhciAkID0galF1ZXJ5O1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogUmV0dXJucyBhIGpRdWVyeSBvYmplY3QgY29udGFpbmluZyBhIGNsaWNrYWJsZSBmb250LWF3ZXNvbWUgYnV0dG9uLlxuICogICAgICBvcHRpb25zOlxuICogICAgICAgICAgdG9vbHRpcENvbmZpZyAgIDogb3B0aW9uIG1hcCBmb3IgYm9vdHN0cmFwIHRvb2wgdGlwXG4gKiAgICAgICAgICBjbGFzc2VzICAgICAgICAgOiBhcnJheSBvZiBjbGFzcyBuYW1lcyAod2lsbCBhbHdheXMgYmUgY2xhc3NlZCBhcyBpY29uLWJ0bilcbiAqICAgICAgICAgIGRpc2FibGVkICAgICAgICA6IFQvRiAtIGFkZCB0aGUgJ2Rpc2FibGVkJyBjbGFzcz9cbiAqICAgICAgICAgIHRpdGxlICAgICAgICAgICA6IHRvb2x0aXAvdGl0bGUgc3RyaW5nXG4gKiAgICAgICAgICB0YXJnZXQgICAgICAgICAgOiBvcHRpb25hbCBocmVmIHRhcmdldFxuICogICAgICAgICAgaHJlZiAgICAgICAgICAgIDogb3B0aW9uYWwgaHJlZlxuICogICAgICAgICAgZmFJY29uICAgICAgICAgIDogd2hpY2ggZm9udCBhd2Vzb21lIGljb24gdG8gdXNlXG4gKiAgICAgICAgICBvbmNsaWNrICAgICAgICAgOiBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkXG4gKi9cbnZhciBmYUljb25CdXR0b24gPSBvcHRpb25zID0+IHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBvcHRpb25zLnRvb2x0aXBDb25maWcgPSBvcHRpb25zLnRvb2x0aXBDb25maWcgfHwge1xuICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCJcbiAgICB9O1xuXG4gICAgb3B0aW9ucy5jbGFzc2VzID0gW1wiaWNvbi1idG5cIl0uY29uY2F0KG9wdGlvbnMuY2xhc3NlcyB8fCBbXSk7XG4gICAgaWYgKG9wdGlvbnMuZGlzYWJsZWQpIHtcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzLnB1c2goXCJkaXNhYmxlZFwiKTtcbiAgICB9XG5cbiAgICB2YXIgaHRtbCA9IFtcbiAgICAgICAgJzxhIGNsYXNzPVwiJyxcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzLmpvaW4oXCIgXCIpLFxuICAgICAgICAnXCInLFxuICAgICAgICBvcHRpb25zLnRpdGxlID8gYCB0aXRsZT1cIiR7b3B0aW9ucy50aXRsZX1cImAgOiBcIlwiLFxuICAgICAgICAhb3B0aW9ucy5kaXNhYmxlZCAmJiBvcHRpb25zLnRhcmdldCA/IGAgdGFyZ2V0PVwiJHtvcHRpb25zLnRhcmdldH1cImAgOiBcIlwiLFxuICAgICAgICAnIGhyZWY9XCInLFxuICAgICAgICAhb3B0aW9ucy5kaXNhYmxlZCAmJiBvcHRpb25zLmhyZWYgPyBvcHRpb25zLmhyZWYgOiBcImphdmFzY3JpcHQ6dm9pZCgwKTtcIixcbiAgICAgICAgJ1wiPicsXG4gICAgICAgIC8vIGNvdWxkIGdvIHdpdGggc29tZXRoaW5nIGxlc3Mgc3BlY2lmaWMgaGVyZSAtIGxpa2UgJ2h0bWwnXG4gICAgICAgICc8c3BhbiBjbGFzcz1cImZhICcsXG4gICAgICAgIG9wdGlvbnMuZmFJY29uLFxuICAgICAgICAnXCI+PC9zcGFuPicsXG4gICAgICAgIFwiPC9hPlwiXG4gICAgXS5qb2luKFwiXCIpO1xuICAgIHZhciAkYnV0dG9uID0gJChodG1sKS50b29sdGlwKG9wdGlvbnMudG9vbHRpcENvbmZpZyk7XG4gICAgaWYgKF8uaXNGdW5jdGlvbihvcHRpb25zLm9uY2xpY2spKSB7XG4gICAgICAgICRidXR0b24uY2xpY2sob3B0aW9ucy5vbmNsaWNrKTtcbiAgICB9XG4gICAgcmV0dXJuICRidXR0b247XG59O1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IGZhSWNvbkJ1dHRvbjtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy91aS9mYS1pY29uLWJ1dHRvbi5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///10\n");

/***/ }),
/* 11 */,
/* 12 */
/*!********************************************!*\
  !*** ./galaxy/scripts/mvc/ui/ui-select.js ***!
  \********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * A plugin for initializing select2 input items.\n * Make sure the select2 library itself is loaded beforehand.\n * Also the element to which select2 will be appended has to\n * be created before select2 initialization (and passed as option).\n */\nvar View = Backbone.View.extend({\n    // options\n    optionsDefault: {\n        css: \"\",\n        placeholder: \"No data available\",\n        data: [],\n        value: null,\n        multiple: false,\n        minimumInputLength: 0,\n        // example format of initial data: \"id:name,55:anotherrole@role.com,27:role@role.com\"\n        initialData: \"\"\n    },\n\n    // initialize\n    initialize: function initialize(options) {\n        // configure options\n        this.options = _utils2.default.merge(options, this.optionsDefault);\n\n        // create new element\n        this.setElement(this._template(this.options));\n\n        // check if container exists\n        if (!this.options.container) {\n            console.log(\"ui-select::initialize() : container not specified.\");\n            return;\n        }\n\n        // add to dom\n        this.options.container.append(this.$el);\n\n        // link selection dictionary\n        this.select_data = this.options.data;\n\n        // refresh\n        this._refresh();\n\n        if (!this.options.multiple) {\n            // initial value\n            if (this.options.value) {\n                this._setValue(this.options.value);\n            }\n\n            // add change event\n            var self = this;\n            if (this.options.onchange) {\n                this.$el.on(\"change\", function () {\n                    self.options.onchange(self.value());\n                });\n            }\n        }\n    },\n\n    // value\n    value: function value(new_value) {\n        // get current id/value\n        var before = this._getValue();\n\n        // check if new_value is defined\n        if (new_value !== undefined) {\n            this._setValue(new_value);\n        }\n\n        // get current id/value\n        var after = this._getValue();\n\n        // fire onchange\n        if (after != before && this.options.onchange) {\n            this.options.onchange(after);\n        }\n\n        // return current value\n        return after;\n    },\n\n    // label\n    text: function text() {\n        return this.$el.select2(\"data\").text;\n    },\n\n    // disabled\n    disabled: function disabled() {\n        return !this.$el.select2(\"enable\");\n    },\n\n    // enable\n    enable: function enable() {\n        this.$el.select2(\"enable\", true);\n    },\n\n    // disable\n    disable: function disable() {\n        this.$el.select2(\"enable\", false);\n    },\n\n    // add\n    add: function add(options) {\n        // add options\n        this.select_data.push({\n            id: options.id,\n            text: options.text\n        });\n\n        // refresh\n        this._refresh();\n    },\n\n    // remove\n    del: function del(id) {\n        // search option\n        var index = this._getIndex(id);\n\n        // check if found\n        if (index != -1) {\n            // remove options\n            this.select_data.splice(index, 1);\n\n            // refresh\n            this._refresh();\n        }\n    },\n\n    // remove\n    remove: function remove() {\n        this.$el.select2(\"destroy\");\n    },\n\n    // update\n    update: function update(options) {\n        // copy options\n        this.select_data = [];\n        for (var key in options.data) {\n            this.select_data.push(options.data[key]);\n        }\n\n        // refresh\n        this._refresh();\n    },\n\n    // refresh\n    _refresh: function _refresh() {\n        // add select2 data based on type of input\n        if (!this.options.multiple) {\n            var selected = this._getValue();\n            var select_opt = {\n                data: this.select_data,\n                containerCssClass: this.options.css,\n                placeholder: this.options.placeholder,\n                dropdownAutoWidth: true\n            };\n            this.$el.select2(select_opt);\n            // select previous value (if exists)\n            this._setValue(selected);\n        } else {\n            var select_opt = {\n                multiple: this.options.multiple,\n                containerCssClass: this.options.css,\n                placeholder: this.options.placeholder,\n                minimumInputLength: this.options.minimumInputLength,\n                ajax: this.options.ajax,\n                dropdownCssClass: this.options.dropdownCssClass,\n                escapeMarkup: this.options.escapeMarkup,\n                formatResult: this.options.formatResult,\n                formatSelection: this.options.formatSelection,\n                initSelection: this.options.initSelection,\n                initialData: this.options.initialData\n            };\n            this.$el.select2(select_opt);\n        }\n    },\n\n    // get index\n    _getIndex: function _getIndex(value) {\n        // returns the index of the searched value\n        _.findIndex(this.select_data, { id: value });\n    },\n\n    // get value\n    _getValue: function _getValue() {\n        return this.$el.select2(\"val\");\n    },\n\n    // set value\n    _setValue: function _setValue(new_value) {\n        var index = this._getIndex(new_value);\n        if (index == -1) {\n            if (this.select_data.length > 0) {\n                new_value = this.select_data[0].id;\n            }\n        }\n        this.$el.select2(\"val\", new_value);\n    },\n\n    // element\n    _template: function _template(options) {\n        return \"<input type=\\\"hidden\\\" value=\\\"\" + this.options.initialData + \"\\\"/>\";\n    }\n}); // dependencies\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VpL3VpLXNlbGVjdC5qcz8xZmJkIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGRlcGVuZGVuY2llc1xuaW1wb3J0IFV0aWxzIGZyb20gXCJ1dGlscy91dGlsc1wiO1xuLyoqXG4gKiBBIHBsdWdpbiBmb3IgaW5pdGlhbGl6aW5nIHNlbGVjdDIgaW5wdXQgaXRlbXMuXG4gKiBNYWtlIHN1cmUgdGhlIHNlbGVjdDIgbGlicmFyeSBpdHNlbGYgaXMgbG9hZGVkIGJlZm9yZWhhbmQuXG4gKiBBbHNvIHRoZSBlbGVtZW50IHRvIHdoaWNoIHNlbGVjdDIgd2lsbCBiZSBhcHBlbmRlZCBoYXMgdG9cbiAqIGJlIGNyZWF0ZWQgYmVmb3JlIHNlbGVjdDIgaW5pdGlhbGl6YXRpb24gKGFuZCBwYXNzZWQgYXMgb3B0aW9uKS5cbiAqL1xudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgLy8gb3B0aW9uc1xuICAgIG9wdGlvbnNEZWZhdWx0OiB7XG4gICAgICAgIGNzczogXCJcIixcbiAgICAgICAgcGxhY2Vob2xkZXI6IFwiTm8gZGF0YSBhdmFpbGFibGVcIixcbiAgICAgICAgZGF0YTogW10sXG4gICAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgICBtdWx0aXBsZTogZmFsc2UsXG4gICAgICAgIG1pbmltdW1JbnB1dExlbmd0aDogMCxcbiAgICAgICAgLy8gZXhhbXBsZSBmb3JtYXQgb2YgaW5pdGlhbCBkYXRhOiBcImlkOm5hbWUsNTU6YW5vdGhlcnJvbGVAcm9sZS5jb20sMjc6cm9sZUByb2xlLmNvbVwiXG4gICAgICAgIGluaXRpYWxEYXRhOiBcIlwiXG4gICAgfSxcblxuICAgIC8vIGluaXRpYWxpemVcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIC8vIGNvbmZpZ3VyZSBvcHRpb25zXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IFV0aWxzLm1lcmdlKG9wdGlvbnMsIHRoaXMub3B0aW9uc0RlZmF1bHQpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBuZXcgZWxlbWVudFxuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUodGhpcy5vcHRpb25zKSk7XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgY29udGFpbmVyIGV4aXN0c1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5jb250YWluZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidWktc2VsZWN0Ojppbml0aWFsaXplKCkgOiBjb250YWluZXIgbm90IHNwZWNpZmllZC5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBhZGQgdG8gZG9tXG4gICAgICAgIHRoaXMub3B0aW9ucy5jb250YWluZXIuYXBwZW5kKHRoaXMuJGVsKTtcblxuICAgICAgICAvLyBsaW5rIHNlbGVjdGlvbiBkaWN0aW9uYXJ5XG4gICAgICAgIHRoaXMuc2VsZWN0X2RhdGEgPSB0aGlzLm9wdGlvbnMuZGF0YTtcblxuICAgICAgICAvLyByZWZyZXNoXG4gICAgICAgIHRoaXMuX3JlZnJlc2goKTtcblxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5tdWx0aXBsZSkge1xuICAgICAgICAgICAgLy8gaW5pdGlhbCB2YWx1ZVxuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldFZhbHVlKHRoaXMub3B0aW9ucy52YWx1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBjaGFuZ2UgZXZlbnRcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMub25jaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbC5vbihcImNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3B0aW9ucy5vbmNoYW5nZShzZWxmLnZhbHVlKCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIHZhbHVlXG4gICAgdmFsdWU6IGZ1bmN0aW9uKG5ld192YWx1ZSkge1xuICAgICAgICAvLyBnZXQgY3VycmVudCBpZC92YWx1ZVxuICAgICAgICB2YXIgYmVmb3JlID0gdGhpcy5fZ2V0VmFsdWUoKTtcblxuICAgICAgICAvLyBjaGVjayBpZiBuZXdfdmFsdWUgaXMgZGVmaW5lZFxuICAgICAgICBpZiAobmV3X3ZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFZhbHVlKG5ld192YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBnZXQgY3VycmVudCBpZC92YWx1ZVxuICAgICAgICB2YXIgYWZ0ZXIgPSB0aGlzLl9nZXRWYWx1ZSgpO1xuXG4gICAgICAgIC8vIGZpcmUgb25jaGFuZ2VcbiAgICAgICAgaWYgKGFmdGVyICE9IGJlZm9yZSAmJiB0aGlzLm9wdGlvbnMub25jaGFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbmNoYW5nZShhZnRlcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZXR1cm4gY3VycmVudCB2YWx1ZVxuICAgICAgICByZXR1cm4gYWZ0ZXI7XG4gICAgfSxcblxuICAgIC8vIGxhYmVsXG4gICAgdGV4dDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRlbC5zZWxlY3QyKFwiZGF0YVwiKS50ZXh0O1xuICAgIH0sXG5cbiAgICAvLyBkaXNhYmxlZFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLiRlbC5zZWxlY3QyKFwiZW5hYmxlXCIpO1xuICAgIH0sXG5cbiAgICAvLyBlbmFibGVcbiAgICBlbmFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRlbC5zZWxlY3QyKFwiZW5hYmxlXCIsIHRydWUpO1xuICAgIH0sXG5cbiAgICAvLyBkaXNhYmxlXG4gICAgZGlzYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLnNlbGVjdDIoXCJlbmFibGVcIiwgZmFsc2UpO1xuICAgIH0sXG5cbiAgICAvLyBhZGRcbiAgICBhZGQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gYWRkIG9wdGlvbnNcbiAgICAgICAgdGhpcy5zZWxlY3RfZGF0YS5wdXNoKHtcbiAgICAgICAgICAgIGlkOiBvcHRpb25zLmlkLFxuICAgICAgICAgICAgdGV4dDogb3B0aW9ucy50ZXh0XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHJlZnJlc2hcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICAvLyByZW1vdmVcbiAgICBkZWw6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIC8vIHNlYXJjaCBvcHRpb25cbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZ2V0SW5kZXgoaWQpO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIGZvdW5kXG4gICAgICAgIGlmIChpbmRleCAhPSAtMSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9wdGlvbnNcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2RhdGEuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgICAgICAgLy8gcmVmcmVzaFxuICAgICAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIHJlbW92ZVxuICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLnNlbGVjdDIoXCJkZXN0cm95XCIpO1xuICAgIH0sXG5cbiAgICAvLyB1cGRhdGVcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gY29weSBvcHRpb25zXG4gICAgICAgIHRoaXMuc2VsZWN0X2RhdGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbnMuZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RfZGF0YS5wdXNoKG9wdGlvbnMuZGF0YVtrZXldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlZnJlc2hcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICAvLyByZWZyZXNoXG4gICAgX3JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBhZGQgc2VsZWN0MiBkYXRhIGJhc2VkIG9uIHR5cGUgb2YgaW5wdXRcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuX2dldFZhbHVlKCk7XG4gICAgICAgICAgICB2YXIgc2VsZWN0X29wdCA9IHtcbiAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLnNlbGVjdF9kYXRhLFxuICAgICAgICAgICAgICAgIGNvbnRhaW5lckNzc0NsYXNzOiB0aGlzLm9wdGlvbnMuY3NzLFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgZHJvcGRvd25BdXRvV2lkdGg6IHRydWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLiRlbC5zZWxlY3QyKHNlbGVjdF9vcHQpO1xuICAgICAgICAgICAgLy8gc2VsZWN0IHByZXZpb3VzIHZhbHVlIChpZiBleGlzdHMpXG4gICAgICAgICAgICB0aGlzLl9zZXRWYWx1ZShzZWxlY3RlZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0X29wdCA9IHtcbiAgICAgICAgICAgICAgICBtdWx0aXBsZTogdGhpcy5vcHRpb25zLm11bHRpcGxlLFxuICAgICAgICAgICAgICAgIGNvbnRhaW5lckNzc0NsYXNzOiB0aGlzLm9wdGlvbnMuY3NzLFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0aGlzLm9wdGlvbnMucGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgbWluaW11bUlucHV0TGVuZ3RoOiB0aGlzLm9wdGlvbnMubWluaW11bUlucHV0TGVuZ3RoLFxuICAgICAgICAgICAgICAgIGFqYXg6IHRoaXMub3B0aW9ucy5hamF4LFxuICAgICAgICAgICAgICAgIGRyb3Bkb3duQ3NzQ2xhc3M6IHRoaXMub3B0aW9ucy5kcm9wZG93bkNzc0NsYXNzLFxuICAgICAgICAgICAgICAgIGVzY2FwZU1hcmt1cDogdGhpcy5vcHRpb25zLmVzY2FwZU1hcmt1cCxcbiAgICAgICAgICAgICAgICBmb3JtYXRSZXN1bHQ6IHRoaXMub3B0aW9ucy5mb3JtYXRSZXN1bHQsXG4gICAgICAgICAgICAgICAgZm9ybWF0U2VsZWN0aW9uOiB0aGlzLm9wdGlvbnMuZm9ybWF0U2VsZWN0aW9uLFxuICAgICAgICAgICAgICAgIGluaXRTZWxlY3Rpb246IHRoaXMub3B0aW9ucy5pbml0U2VsZWN0aW9uLFxuICAgICAgICAgICAgICAgIGluaXRpYWxEYXRhOiB0aGlzLm9wdGlvbnMuaW5pdGlhbERhdGFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLiRlbC5zZWxlY3QyKHNlbGVjdF9vcHQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIGdldCBpbmRleFxuICAgIF9nZXRJbmRleDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgLy8gcmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHNlYXJjaGVkIHZhbHVlXG4gICAgICAgIF8uZmluZEluZGV4KHRoaXMuc2VsZWN0X2RhdGEsIHsgaWQ6IHZhbHVlIH0pO1xuICAgIH0sXG5cbiAgICAvLyBnZXQgdmFsdWVcbiAgICBfZ2V0VmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kZWwuc2VsZWN0MihcInZhbFwiKTtcbiAgICB9LFxuXG4gICAgLy8gc2V0IHZhbHVlXG4gICAgX3NldFZhbHVlOiBmdW5jdGlvbihuZXdfdmFsdWUpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZ2V0SW5kZXgobmV3X3ZhbHVlKTtcbiAgICAgICAgaWYgKGluZGV4ID09IC0xKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RfZGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbmV3X3ZhbHVlID0gdGhpcy5zZWxlY3RfZGF0YVswXS5pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRlbC5zZWxlY3QyKFwidmFsXCIsIG5ld192YWx1ZSk7XG4gICAgfSxcblxuICAgIC8vIGVsZW1lbnRcbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGA8aW5wdXQgdHlwZT1cImhpZGRlblwiIHZhbHVlPVwiJHt0aGlzLm9wdGlvbnMuaW5pdGlhbERhdGF9XCIvPmA7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91aS91aS1zZWxlY3QuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBO0FBQ0E7Ozs7O0FBQUE7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbk1BO0FBc01BO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///12\n");

/***/ }),
/* 13 */,
/* 14 */,
/* 15 */,
/* 16 */
/*!********************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-contents.js ***!
  \********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, jQuery, Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _controlledFetchCollection = __webpack_require__(/*! mvc/base/controlled-fetch-collection */ 56);\n\nvar _controlledFetchCollection2 = _interopRequireDefault(_controlledFetchCollection);\n\nvar _hdaModel = __webpack_require__(/*! mvc/history/hda-model */ 38);\n\nvar _hdaModel2 = _interopRequireDefault(_hdaModel);\n\nvar _hdcaModel = __webpack_require__(/*! mvc/history/hdca-model */ 20);\n\nvar _hdcaModel2 = _interopRequireDefault(_hdcaModel);\n\nvar _historyPreferences = __webpack_require__(/*! mvc/history/history-preferences */ 57);\n\nvar _historyPreferences2 = _interopRequireDefault(_historyPreferences);\n\nvar _jobStatesModel = __webpack_require__(/*! mvc/history/job-states-model */ 71);\n\nvar _jobStatesModel2 = _interopRequireDefault(_jobStatesModel);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _ajaxQueue = __webpack_require__(/*! utils/ajax-queue */ 21);\n\nvar _ajaxQueue2 = _interopRequireDefault(_ajaxQueue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar limitPerPageDefault = 500;\ntry {\n    limitPerPageDefault = localStorage.getItem(\"historyContentsLimitPerPageDefault\") || limitPerPageDefault;\n} catch (err) {}\n\n//==============================================================================\nvar _super = _controlledFetchCollection2.default.PaginatedCollection;\n/** @class Backbone collection for history content.\n *      NOTE: history content seems like a dataset collection, but differs in that it is mixed:\n *          each element can be either an HDA (dataset) or a DatasetCollection and co-exist on\n *          the same level.\n *      Dataset collections on the other hand are not mixed and (so far) can only contain either\n *          HDAs or child dataset collections on one level.\n *      This is why this does not inherit from any of the DatasetCollections (currently).\n */\nvar HistoryContents = _super.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: \"history\",\n\n    // ........................................................................ set up\n    limitPerPage: limitPerPageDefault,\n\n    /** @type {Integer} how many contents per call to fetch when using progressivelyFetchDetails */\n    limitPerProgressiveFetch: limitPerPageDefault,\n\n    /** @type {String} order used here and when fetching from server */\n    order: \"hid\",\n\n    /** root api url */\n    urlRoot: Galaxy.root + \"api/histories\",\n\n    /** complete api url */\n    url: function url() {\n        return this.urlRoot + \"/\" + this.historyId + \"/contents\";\n    },\n\n    /** Set up */\n    initialize: function initialize(models, options) {\n        this.on({\n            \"sync add\": this.trackJobStates\n        });\n\n        options = options || {};\n        _super.prototype.initialize.call(this, models, options);\n\n        this.history = options.history || null;\n        this.setHistoryId(options.historyId || null);\n        /** @type {Boolean} does this collection contain and fetch deleted elements */\n        this.includeDeleted = options.includeDeleted || this.includeDeleted;\n        /** @type {Boolean} does this collection contain and fetch non-visible elements */\n        this.includeHidden = options.includeHidden || this.includeHidden;\n\n        // backbonejs uses collection.model.prototype.idAttribute to determine if a model is *already* in a collection\n        //  and either merged or replaced. In this case, our 'model' is a function so we need to add idAttribute\n        //  manually here - if we don't, contents will not merge but be replaced/swapped.\n        this.model.prototype.idAttribute = \"type_id\";\n    },\n\n    trackJobStates: function trackJobStates() {\n        var _this = this;\n\n        this.each(function (historyContent) {\n            if (historyContent.has(\"job_states_summary\")) {\n                return;\n            }\n\n            if (historyContent.attributes.history_content_type === \"dataset_collection\") {\n                var jobSourceType = historyContent.attributes.job_source_type;\n                var jobSourceId = historyContent.attributes.job_source_id;\n                if (jobSourceType && _this.jobStateSummariesCollection) {\n                    _this.jobStateSummariesCollection.add({\n                        id: jobSourceId,\n                        model: jobSourceType,\n                        history_id: _this.history_id,\n                        collection_id: historyContent.attributes.id\n                    });\n                    var jobStatesSummary = _this.jobStateSummariesCollection.get(jobSourceId);\n                    historyContent.jobStatesSummary = jobStatesSummary;\n                }\n            }\n        });\n    },\n\n    // ........................................................................ composite collection\n    /** since history content is a mix, override model fn into a factory, creating based on history_content_type */\n    model: function model(attrs, options) {\n        if (attrs.history_content_type === \"dataset\") {\n            return new _hdaModel2.default.HistoryDatasetAssociation(attrs, options);\n        } else if (attrs.history_content_type === \"dataset_collection\") {\n            return new _hdcaModel2.default.HistoryDatasetCollection(attrs, options);\n        } else {\n            return {\n                validationError: \"Unknown history_content_type: \" + attrs.history_content_type\n            };\n        }\n    },\n\n    stopPolling: function stopPolling() {\n        if (this.jobStateSummariesCollection) {\n            this.jobStateSummariesCollection.active = false;\n            this.jobStateSummariesCollection.clearUpdateTimeout();\n        }\n    },\n\n    setHistoryId: function setHistoryId(newId) {\n        this.stopPolling();\n        this.historyId = newId;\n        if (newId) {\n            // If actually reflecting a history - setup storage and monitor jobs.\n\n            this._setUpWebStorage();\n\n            this.jobStateSummariesCollection = new _jobStatesModel2.default.JobStatesSummaryCollection();\n            this.jobStateSummariesCollection.historyId = newId;\n            this.jobStateSummariesCollection.monitor();\n        }\n    },\n\n    /** Set up client side storage. Currently PersistanStorage keyed under 'history:<id>' */\n    _setUpWebStorage: function _setUpWebStorage(initialSettings) {\n        // TODO: use initialSettings\n        this.storage = new _historyPreferences2.default.HistoryPrefs({\n            id: _historyPreferences2.default.HistoryPrefs.historyStorageKey(this.historyId)\n        });\n        this.trigger(\"new-storage\", this.storage, this);\n\n        this.on({\n            \"include-deleted\": function includeDeleted(newVal) {\n                this.storage.includeDeleted(newVal);\n            },\n            \"include-hidden\": function includeHidden(newVal) {\n                this.storage.includeHidden(newVal);\n            }\n        });\n\n        this.includeDeleted = this.storage.includeDeleted() || false;\n        this.includeHidden = this.storage.includeHidden() || false;\n        return this;\n    },\n\n    // ........................................................................ common queries\n    /** @type {Object} map of collection available sorting orders containing comparator fns */\n    comparators: _.extend(_.clone(_super.prototype.comparators), {\n        name: _baseMvc2.default.buildComparator(\"name\", { ascending: true }),\n        \"name-dsc\": _baseMvc2.default.buildComparator(\"name\", {\n            ascending: false\n        }),\n        hid: _baseMvc2.default.buildComparator(\"hid\", { ascending: false }),\n        \"hid-asc\": _baseMvc2.default.buildComparator(\"hid\", { ascending: true })\n    }),\n\n    /** Get every model in this collection not in a 'ready' state (running). */\n    running: function running() {\n        return this.filter(function (c) {\n            return !c.inReadyState();\n        });\n    },\n\n    /** return contents that are not ready and not deleted/hidden */\n    runningAndActive: function runningAndActive() {\n        return this.filter(function (c) {\n            return !c.inReadyState() && c.get(\"visible\") &&\n            // TODO: deletedOrPurged?\n            !c.get(\"deleted\");\n        });\n    },\n\n    /** Get the model with the given hid\n     *  @param {Int} hid the hid to search for\n     *  @returns {HistoryDatasetAssociation} the model with the given hid or undefined if not found\n     */\n    getByHid: function getByHid(hid) {\n        // note: there *can* be more than one content with a given hid, this finds the first based on order\n        return this.findWhere({ hid: hid });\n    },\n\n    /** return true if all contents have details */\n    haveDetails: function haveDetails() {\n        return this.all(function (c) {\n            return c.hasDetails();\n        });\n    },\n\n    // ........................................................................ hidden / deleted\n    /** return a new contents collection of only hidden items */\n    hidden: function hidden() {\n        return this.filter(function (c) {\n            return c.hidden();\n        });\n    },\n\n    /** return a new contents collection of only hidden items */\n    deleted: function deleted() {\n        return this.filter(function (c) {\n            return c.get(\"deleted\");\n        });\n    },\n\n    /** return a new contents collection of only hidden items */\n    visibleAndUndeleted: function visibleAndUndeleted() {\n        return this.filter(function (c) {\n            return c.get(\"visible\") &&\n            // TODO: deletedOrPurged?\n            !c.get(\"deleted\");\n        });\n    },\n\n    /** create a setter in order to publish the change */\n    setIncludeDeleted: function setIncludeDeleted(setting, options) {\n        if (_.isBoolean(setting) && setting !== this.includeDeleted) {\n            this.includeDeleted = setting;\n            if (_.result(options, \"silent\")) {\n                return;\n            }\n            this.trigger(\"include-deleted\", setting, this);\n        }\n    },\n\n    /** create a setter in order to publish the change */\n    setIncludeHidden: function setIncludeHidden(setting, options) {\n        if (_.isBoolean(setting) && setting !== this.includeHidden) {\n            this.includeHidden = setting;\n            options = options || {};\n            if (_.result(options, \"silent\")) {\n                return;\n            }\n            this.trigger(\"include-hidden\", setting, this);\n        }\n    },\n\n    // ........................................................................ ajax\n    // ............ controlled fetch collection\n    /** override to get expanded ids from sessionStorage and pass to API as details */\n    fetch: function fetch(options) {\n        options = options || {};\n        if (this.historyId && !options.details) {\n            var prefs = _historyPreferences2.default.HistoryPrefs.get(this.historyId).toJSON();\n            if (!_.isEmpty(prefs.expandedIds)) {\n                options.details = _.values(prefs.expandedIds).join(\",\");\n            }\n        }\n        return _super.prototype.fetch.call(this, options);\n    },\n\n    // ............. ControlledFetch stuff\n    /** override to include the API versioning flag */\n    _buildFetchData: function _buildFetchData(options) {\n        return _.extend(_super.prototype._buildFetchData.call(this, options), {\n            v: \"dev\"\n        });\n    },\n\n    /** Extend to include details and version */\n    _fetchParams: _super.prototype._fetchParams.concat([\n    // TODO: remove (the need for) both\n    /** version */\n    \"v\",\n    /** dataset ids to get full details of */\n    \"details\"]),\n\n    /** override to add deleted/hidden filters */\n    _buildFetchFilters: function _buildFetchFilters(options) {\n        var superFilters = _super.prototype._buildFetchFilters.call(this, options) || {};\n        var filters = {};\n        if (!this.includeDeleted) {\n            filters.deleted = false;\n            filters.purged = false;\n        }\n        if (!this.includeHidden) {\n            filters.visible = true;\n        }\n        return _.defaults(superFilters, filters);\n    },\n\n    // ............ paginated collection\n    getTotalItemCount: function getTotalItemCount() {\n        return this.history.contentsShown();\n    },\n\n    // ............ history contents specific ajax\n    /** override to filter requested contents to those updated after the Date 'since' */\n    fetchUpdated: function fetchUpdated(since, options) {\n        if (since) {\n            options = options || { filters: {} };\n            options.remove = false;\n            options.filters = {\n                \"update_time-ge\": since.toISOString(),\n                // workflows will produce hidden datasets (non-output datasets) that still\n                // need to be updated in the collection or they'll update forever\n                // we can remove the default visible filter by using an 'empty' value\n                visible: \"\"\n            };\n        }\n        return this.fetch(options);\n    },\n\n    /** fetch all the deleted==true contents of this collection */\n    fetchDeleted: function fetchDeleted(options) {\n        var _this2 = this;\n\n        options = options || {};\n        options.filters = _.extend(options.filters, {\n            // all deleted, purged or not\n            deleted: true,\n            purged: undefined\n        });\n        options.remove = false;\n\n        this.trigger(\"fetching-deleted\", this);\n        return this.fetch(options).always(function () {\n            _this2.trigger(\"fetching-deleted-done\", _this2);\n        });\n    },\n\n    /** fetch all the visible==false contents of this collection */\n    fetchHidden: function fetchHidden(options) {\n        options = options || {};\n        var self = this;\n        options.filters = _.extend(options.filters, {\n            visible: false\n        });\n        options.remove = false;\n\n        self.trigger(\"fetching-hidden\", self);\n        return self.fetch(options).always(function () {\n            self.trigger(\"fetching-hidden-done\", self);\n        });\n    },\n\n    /** fetch detailed model data for all contents in this collection */\n    fetchAllDetails: function fetchAllDetails(options) {\n        options = options || {};\n        var detailsFlag = { details: \"all\" };\n        options.data = _.extend(options.data || {}, detailsFlag);\n        return this.fetch(options);\n    },\n\n    // ............. quasi-batch ops\n    // TODO: to batch\n    /** helper that fetches using filterParams then calls save on each fetched using updateWhat as the save params */\n    _filterAndUpdate: function _filterAndUpdate(filterParams, updateWhat) {\n        var self = this;\n        var idAttribute = self.model.prototype.idAttribute;\n        var updateArgs = [updateWhat];\n\n        return self.fetch({ filters: filterParams, remove: false }).then(function (fetched) {\n            // convert filtered json array to model array\n            fetched = fetched.reduce(function (modelArray, currJson, i) {\n                var model = self.get(currJson[idAttribute]);\n                return model ? modelArray.concat(model) : modelArray;\n            }, []);\n            return self.ajaxQueue(\"save\", updateArgs, fetched);\n        });\n    },\n\n    /** using a queue, perform ajaxFn on each of the models in this collection */\n    ajaxQueue: function ajaxQueue(ajaxFn, args, collection) {\n        collection = collection || this.models;\n        return new _ajaxQueue2.default.AjaxQueue(collection.slice().reverse().map(function (content, i) {\n            var fn = _.isString(ajaxFn) ? content[ajaxFn] : ajaxFn;\n            return function () {\n                return fn.apply(content, args);\n            };\n        })).deferred;\n    },\n\n    /** fetch contents' details in batches of limitPerCall - note: only get searchable details here */\n    progressivelyFetchDetails: function progressivelyFetchDetails(options) {\n        options = options || {};\n        var deferred = jQuery.Deferred();\n        var self = this;\n        var limit = options.limitPerCall || self.limitPerProgressiveFetch;\n        // TODO: only fetch tags and annotations if specifically requested\n        var searchAttributes = _hdaModel2.default.HistoryDatasetAssociation.prototype.searchAttributes;\n        var detailKeys = searchAttributes.join(\",\");\n\n        function _recursivelyFetch(offset) {\n            offset = offset || 0;\n            var _options = _.extend(_.clone(options), {\n                view: \"summary\",\n                keys: detailKeys,\n                limit: limit,\n                offset: offset,\n                reset: offset === 0,\n                remove: false\n            });\n\n            _.defer(function () {\n                self.fetch.call(self, _options).fail(deferred.reject).done(function (response) {\n                    deferred.notify(response, limit, offset);\n                    if (response.length !== limit) {\n                        self.allFetched = true;\n                        deferred.resolve(response, limit, offset);\n                    } else {\n                        _recursivelyFetch(offset + limit);\n                    }\n                });\n            });\n        }\n        _recursivelyFetch();\n        return deferred;\n    },\n\n    /** does some bit of JSON represent something that can be copied into this contents collection */\n    isCopyable: function isCopyable(contentsJSON) {\n        var copyableModelClasses = [\"HistoryDatasetAssociation\", \"HistoryDatasetCollectionAssociation\"];\n        return _.isObject(contentsJSON) && contentsJSON.id && _.contains(copyableModelClasses, contentsJSON.model_class);\n    },\n\n    /** copy an existing, accessible hda into this collection */\n    copy: function copy(json) {\n        // TODO: somehow showhorn all this into 'save'\n        var id;\n\n        var type;\n        var contentType;\n        if (_.isString(json)) {\n            id = json;\n            contentType = \"hda\";\n            type = \"dataset\";\n        } else {\n            id = json.id;\n            contentType = {\n                HistoryDatasetAssociation: \"hda\",\n                LibraryDatasetDatasetAssociation: \"ldda\",\n                HistoryDatasetCollectionAssociation: \"hdca\"\n            }[json.model_class] || \"hda\";\n            type = contentType === \"hdca\" ? \"dataset_collection\" : \"dataset\";\n        }\n        var collection = this;\n\n        var xhr = jQuery.ajax(this.url(), {\n            method: \"POST\",\n            contentType: \"application/json\",\n            data: JSON.stringify({\n                content: id,\n                source: contentType,\n                type: type\n            })\n        }).done(function (response) {\n            collection.add([response], { parse: true });\n        }).fail(function (error, status, message) {\n            collection.trigger(\"error\", collection, xhr, {}, \"Error copying contents\", {\n                type: type,\n                id: id,\n                source: contentType\n            });\n        });\n\n        return xhr;\n    },\n\n    /** create a new HDCA in this collection */\n    createHDCA: function createHDCA(elementIdentifiers, collectionType, name, hideSourceItems, options) {\n        // normally collection.create returns the new model, but we need the promise from the ajax, so we fake create\n        //precondition: elementIdentifiers is an array of plain js objects\n        //  in the proper form to create the collectionType\n        var hdca = this.model({\n            history_content_type: \"dataset_collection\",\n            collection_type: collectionType,\n            history_id: this.historyId,\n            name: name,\n            hide_source_items: hideSourceItems || false,\n            // should probably be able to just send in a bunch of json here and restruct per class\n            // note: element_identifiers is now (incorrectly) an attribute\n            element_identifiers: elementIdentifiers\n            // do not create the model on the client until the ajax returns\n        });\n        return hdca.save(options);\n    },\n\n    // ........................................................................ searching\n    /** return true if all contents have the searchable attributes */\n    haveSearchDetails: function haveSearchDetails() {\n        return this.allFetched && this.all(function (content // null (which is a valid returned annotation value)\n        ) {\n            return (\n                // will return false when using content.has( 'annotation' )\n                //TODO: a bit hacky - formalize\n                _.has(content.attributes, \"annotation\")\n            );\n        });\n    },\n\n    /** return a new collection of contents whose attributes contain the substring matchesWhat */\n    matches: function matches(matchesWhat) {\n        return this.filter(function (content) {\n            return content.matches(matchesWhat);\n        });\n    },\n\n    // ........................................................................ misc\n    /** In this override, copy the historyId to the clone */\n    clone: function clone() {\n        var clone = Backbone.Collection.prototype.clone.call(this);\n        clone.historyId = this.historyId;\n        return clone;\n    },\n\n    /** String representation. */\n    toString: function toString() {\n        return [\"HistoryContents(\", [this.historyId, this.length].join(), \")\"].join(\"\");\n    }\n});\n\n//==============================================================================\nexports.default = {\n    HistoryContents: HistoryContents\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1jb250ZW50cy5qcz8yZmEwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDT05UUk9MTEVEX0ZFVENIX0NPTExFQ1RJT04gZnJvbSBcIm12Yy9iYXNlL2NvbnRyb2xsZWQtZmV0Y2gtY29sbGVjdGlvblwiO1xuaW1wb3J0IEhEQV9NT0RFTCBmcm9tIFwibXZjL2hpc3RvcnkvaGRhLW1vZGVsXCI7XG5pbXBvcnQgSERDQV9NT0RFTCBmcm9tIFwibXZjL2hpc3RvcnkvaGRjYS1tb2RlbFwiO1xuaW1wb3J0IEhJU1RPUllfUFJFRlMgZnJvbSBcIm12Yy9oaXN0b3J5L2hpc3RvcnktcHJlZmVyZW5jZXNcIjtcbmltcG9ydCBKT0JfU1RBVEVTX01PREVMIGZyb20gXCJtdmMvaGlzdG9yeS9qb2Itc3RhdGVzLW1vZGVsXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IEFKQVhfUVVFVUUgZnJvbSBcInV0aWxzL2FqYXgtcXVldWVcIjtcblxudmFyIGxpbWl0UGVyUGFnZURlZmF1bHQgPSA1MDA7XG50cnkge1xuICAgIGxpbWl0UGVyUGFnZURlZmF1bHQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImhpc3RvcnlDb250ZW50c0xpbWl0UGVyUGFnZURlZmF1bHRcIikgfHwgbGltaXRQZXJQYWdlRGVmYXVsdDtcbn0gY2F0Y2ggKGVycikge31cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnZhciBfc3VwZXIgPSBDT05UUk9MTEVEX0ZFVENIX0NPTExFQ1RJT04uUGFnaW5hdGVkQ29sbGVjdGlvbjtcbi8qKiBAY2xhc3MgQmFja2JvbmUgY29sbGVjdGlvbiBmb3IgaGlzdG9yeSBjb250ZW50LlxuICogICAgICBOT1RFOiBoaXN0b3J5IGNvbnRlbnQgc2VlbXMgbGlrZSBhIGRhdGFzZXQgY29sbGVjdGlvbiwgYnV0IGRpZmZlcnMgaW4gdGhhdCBpdCBpcyBtaXhlZDpcbiAqICAgICAgICAgIGVhY2ggZWxlbWVudCBjYW4gYmUgZWl0aGVyIGFuIEhEQSAoZGF0YXNldCkgb3IgYSBEYXRhc2V0Q29sbGVjdGlvbiBhbmQgY28tZXhpc3Qgb25cbiAqICAgICAgICAgIHRoZSBzYW1lIGxldmVsLlxuICogICAgICBEYXRhc2V0IGNvbGxlY3Rpb25zIG9uIHRoZSBvdGhlciBoYW5kIGFyZSBub3QgbWl4ZWQgYW5kIChzbyBmYXIpIGNhbiBvbmx5IGNvbnRhaW4gZWl0aGVyXG4gKiAgICAgICAgICBIREFzIG9yIGNoaWxkIGRhdGFzZXQgY29sbGVjdGlvbnMgb24gb25lIGxldmVsLlxuICogICAgICBUaGlzIGlzIHdoeSB0aGlzIGRvZXMgbm90IGluaGVyaXQgZnJvbSBhbnkgb2YgdGhlIERhdGFzZXRDb2xsZWN0aW9ucyAoY3VycmVudGx5KS5cbiAqL1xudmFyIEhpc3RvcnlDb250ZW50cyA9IF9zdXBlci5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKHtcbiAgICBfbG9nTmFtZXNwYWNlOiBcImhpc3RvcnlcIixcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBzZXQgdXBcbiAgICBsaW1pdFBlclBhZ2U6IGxpbWl0UGVyUGFnZURlZmF1bHQsXG5cbiAgICAvKiogQHR5cGUge0ludGVnZXJ9IGhvdyBtYW55IGNvbnRlbnRzIHBlciBjYWxsIHRvIGZldGNoIHdoZW4gdXNpbmcgcHJvZ3Jlc3NpdmVseUZldGNoRGV0YWlscyAqL1xuICAgIGxpbWl0UGVyUHJvZ3Jlc3NpdmVGZXRjaDogbGltaXRQZXJQYWdlRGVmYXVsdCxcblxuICAgIC8qKiBAdHlwZSB7U3RyaW5nfSBvcmRlciB1c2VkIGhlcmUgYW5kIHdoZW4gZmV0Y2hpbmcgZnJvbSBzZXJ2ZXIgKi9cbiAgICBvcmRlcjogXCJoaWRcIixcblxuICAgIC8qKiByb290IGFwaSB1cmwgKi9cbiAgICB1cmxSb290OiBgJHtHYWxheHkucm9vdH1hcGkvaGlzdG9yaWVzYCxcblxuICAgIC8qKiBjb21wbGV0ZSBhcGkgdXJsICovXG4gICAgdXJsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMudXJsUm9vdH0vJHt0aGlzLmhpc3RvcnlJZH0vY29udGVudHNgO1xuICAgIH0sXG5cbiAgICAvKiogU2V0IHVwICovXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24obW9kZWxzLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMub24oe1xuICAgICAgICAgICAgXCJzeW5jIGFkZFwiOiB0aGlzLnRyYWNrSm9iU3RhdGVzXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBtb2RlbHMsIG9wdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuaGlzdG9yeSA9IG9wdGlvbnMuaGlzdG9yeSB8fCBudWxsO1xuICAgICAgICB0aGlzLnNldEhpc3RvcnlJZChvcHRpb25zLmhpc3RvcnlJZCB8fCBudWxsKTtcbiAgICAgICAgLyoqIEB0eXBlIHtCb29sZWFufSBkb2VzIHRoaXMgY29sbGVjdGlvbiBjb250YWluIGFuZCBmZXRjaCBkZWxldGVkIGVsZW1lbnRzICovXG4gICAgICAgIHRoaXMuaW5jbHVkZURlbGV0ZWQgPSBvcHRpb25zLmluY2x1ZGVEZWxldGVkIHx8IHRoaXMuaW5jbHVkZURlbGV0ZWQ7XG4gICAgICAgIC8qKiBAdHlwZSB7Qm9vbGVhbn0gZG9lcyB0aGlzIGNvbGxlY3Rpb24gY29udGFpbiBhbmQgZmV0Y2ggbm9uLXZpc2libGUgZWxlbWVudHMgKi9cbiAgICAgICAgdGhpcy5pbmNsdWRlSGlkZGVuID0gb3B0aW9ucy5pbmNsdWRlSGlkZGVuIHx8IHRoaXMuaW5jbHVkZUhpZGRlbjtcblxuICAgICAgICAvLyBiYWNrYm9uZWpzIHVzZXMgY29sbGVjdGlvbi5tb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGUgdG8gZGV0ZXJtaW5lIGlmIGEgbW9kZWwgaXMgKmFscmVhZHkqIGluIGEgY29sbGVjdGlvblxuICAgICAgICAvLyAgYW5kIGVpdGhlciBtZXJnZWQgb3IgcmVwbGFjZWQuIEluIHRoaXMgY2FzZSwgb3VyICdtb2RlbCcgaXMgYSBmdW5jdGlvbiBzbyB3ZSBuZWVkIHRvIGFkZCBpZEF0dHJpYnV0ZVxuICAgICAgICAvLyAgbWFudWFsbHkgaGVyZSAtIGlmIHdlIGRvbid0LCBjb250ZW50cyB3aWxsIG5vdCBtZXJnZSBidXQgYmUgcmVwbGFjZWQvc3dhcHBlZC5cbiAgICAgICAgdGhpcy5tb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGUgPSBcInR5cGVfaWRcIjtcbiAgICB9LFxuXG4gICAgdHJhY2tKb2JTdGF0ZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmVhY2goaGlzdG9yeUNvbnRlbnQgPT4ge1xuICAgICAgICAgICAgaWYgKGhpc3RvcnlDb250ZW50LmhhcyhcImpvYl9zdGF0ZXNfc3VtbWFyeVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGhpc3RvcnlDb250ZW50LmF0dHJpYnV0ZXMuaGlzdG9yeV9jb250ZW50X3R5cGUgPT09IFwiZGF0YXNldF9jb2xsZWN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgam9iU291cmNlVHlwZSA9IGhpc3RvcnlDb250ZW50LmF0dHJpYnV0ZXMuam9iX3NvdXJjZV90eXBlO1xuICAgICAgICAgICAgICAgIHZhciBqb2JTb3VyY2VJZCA9IGhpc3RvcnlDb250ZW50LmF0dHJpYnV0ZXMuam9iX3NvdXJjZV9pZDtcbiAgICAgICAgICAgICAgICBpZiAoam9iU291cmNlVHlwZSAmJiB0aGlzLmpvYlN0YXRlU3VtbWFyaWVzQ29sbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmpvYlN0YXRlU3VtbWFyaWVzQ29sbGVjdGlvbi5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGpvYlNvdXJjZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IGpvYlNvdXJjZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5X2lkOiB0aGlzLmhpc3RvcnlfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uX2lkOiBoaXN0b3J5Q29udGVudC5hdHRyaWJ1dGVzLmlkXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgam9iU3RhdGVzU3VtbWFyeSA9IHRoaXMuam9iU3RhdGVTdW1tYXJpZXNDb2xsZWN0aW9uLmdldChqb2JTb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgICAgIGhpc3RvcnlDb250ZW50LmpvYlN0YXRlc1N1bW1hcnkgPSBqb2JTdGF0ZXNTdW1tYXJ5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjb21wb3NpdGUgY29sbGVjdGlvblxuICAgIC8qKiBzaW5jZSBoaXN0b3J5IGNvbnRlbnQgaXMgYSBtaXgsIG92ZXJyaWRlIG1vZGVsIGZuIGludG8gYSBmYWN0b3J5LCBjcmVhdGluZyBiYXNlZCBvbiBoaXN0b3J5X2NvbnRlbnRfdHlwZSAqL1xuICAgIG1vZGVsOiBmdW5jdGlvbihhdHRycywgb3B0aW9ucykge1xuICAgICAgICBpZiAoYXR0cnMuaGlzdG9yeV9jb250ZW50X3R5cGUgPT09IFwiZGF0YXNldFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEhEQV9NT0RFTC5IaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uKGF0dHJzLCBvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmIChhdHRycy5oaXN0b3J5X2NvbnRlbnRfdHlwZSA9PT0gXCJkYXRhc2V0X2NvbGxlY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBIRENBX01PREVMLkhpc3RvcnlEYXRhc2V0Q29sbGVjdGlvbihhdHRycywgb3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbGlkYXRpb25FcnJvcjogYFVua25vd24gaGlzdG9yeV9jb250ZW50X3R5cGU6ICR7YXR0cnMuaGlzdG9yeV9jb250ZW50X3R5cGV9YFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wUG9sbGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmpvYlN0YXRlU3VtbWFyaWVzQ29sbGVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5qb2JTdGF0ZVN1bW1hcmllc0NvbGxlY3Rpb24uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmpvYlN0YXRlU3VtbWFyaWVzQ29sbGVjdGlvbi5jbGVhclVwZGF0ZVRpbWVvdXQoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBzZXRIaXN0b3J5SWQ6IGZ1bmN0aW9uKG5ld0lkKSB7XG4gICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgdGhpcy5oaXN0b3J5SWQgPSBuZXdJZDtcbiAgICAgICAgaWYgKG5ld0lkKSB7XG4gICAgICAgICAgICAvLyBJZiBhY3R1YWxseSByZWZsZWN0aW5nIGEgaGlzdG9yeSAtIHNldHVwIHN0b3JhZ2UgYW5kIG1vbml0b3Igam9icy5cblxuICAgICAgICAgICAgdGhpcy5fc2V0VXBXZWJTdG9yYWdlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuam9iU3RhdGVTdW1tYXJpZXNDb2xsZWN0aW9uID0gbmV3IEpPQl9TVEFURVNfTU9ERUwuSm9iU3RhdGVzU3VtbWFyeUNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMuam9iU3RhdGVTdW1tYXJpZXNDb2xsZWN0aW9uLmhpc3RvcnlJZCA9IG5ld0lkO1xuICAgICAgICAgICAgdGhpcy5qb2JTdGF0ZVN1bW1hcmllc0NvbGxlY3Rpb24ubW9uaXRvcigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBTZXQgdXAgY2xpZW50IHNpZGUgc3RvcmFnZS4gQ3VycmVudGx5IFBlcnNpc3RhblN0b3JhZ2Uga2V5ZWQgdW5kZXIgJ2hpc3Rvcnk6PGlkPicgKi9cbiAgICBfc2V0VXBXZWJTdG9yYWdlOiBmdW5jdGlvbihpbml0aWFsU2V0dGluZ3MpIHtcbiAgICAgICAgLy8gVE9ETzogdXNlIGluaXRpYWxTZXR0aW5nc1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSBuZXcgSElTVE9SWV9QUkVGUy5IaXN0b3J5UHJlZnMoe1xuICAgICAgICAgICAgaWQ6IEhJU1RPUllfUFJFRlMuSGlzdG9yeVByZWZzLmhpc3RvcnlTdG9yYWdlS2V5KHRoaXMuaGlzdG9yeUlkKVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKFwibmV3LXN0b3JhZ2VcIiwgdGhpcy5zdG9yYWdlLCB0aGlzKTtcblxuICAgICAgICB0aGlzLm9uKHtcbiAgICAgICAgICAgIFwiaW5jbHVkZS1kZWxldGVkXCI6IGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5pbmNsdWRlRGVsZXRlZChuZXdWYWwpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiaW5jbHVkZS1oaWRkZW5cIjogZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLmluY2x1ZGVIaWRkZW4obmV3VmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5pbmNsdWRlRGVsZXRlZCA9IHRoaXMuc3RvcmFnZS5pbmNsdWRlRGVsZXRlZCgpIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLmluY2x1ZGVIaWRkZW4gPSB0aGlzLnN0b3JhZ2UuaW5jbHVkZUhpZGRlbigpIHx8IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGNvbW1vbiBxdWVyaWVzXG4gICAgLyoqIEB0eXBlIHtPYmplY3R9IG1hcCBvZiBjb2xsZWN0aW9uIGF2YWlsYWJsZSBzb3J0aW5nIG9yZGVycyBjb250YWluaW5nIGNvbXBhcmF0b3IgZm5zICovXG4gICAgY29tcGFyYXRvcnM6IF8uZXh0ZW5kKF8uY2xvbmUoX3N1cGVyLnByb3RvdHlwZS5jb21wYXJhdG9ycyksIHtcbiAgICAgICAgbmFtZTogQkFTRV9NVkMuYnVpbGRDb21wYXJhdG9yKFwibmFtZVwiLCB7IGFzY2VuZGluZzogdHJ1ZSB9KSxcbiAgICAgICAgXCJuYW1lLWRzY1wiOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJuYW1lXCIsIHtcbiAgICAgICAgICAgIGFzY2VuZGluZzogZmFsc2VcbiAgICAgICAgfSksXG4gICAgICAgIGhpZDogQkFTRV9NVkMuYnVpbGRDb21wYXJhdG9yKFwiaGlkXCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KSxcbiAgICAgICAgXCJoaWQtYXNjXCI6IEJBU0VfTVZDLmJ1aWxkQ29tcGFyYXRvcihcImhpZFwiLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgIH0pLFxuXG4gICAgLyoqIEdldCBldmVyeSBtb2RlbCBpbiB0aGlzIGNvbGxlY3Rpb24gbm90IGluIGEgJ3JlYWR5JyBzdGF0ZSAocnVubmluZykuICovXG4gICAgcnVubmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihjID0+ICFjLmluUmVhZHlTdGF0ZSgpKTtcbiAgICB9LFxuXG4gICAgLyoqIHJldHVybiBjb250ZW50cyB0aGF0IGFyZSBub3QgcmVhZHkgYW5kIG5vdCBkZWxldGVkL2hpZGRlbiAqL1xuICAgIHJ1bm5pbmdBbmRBY3RpdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXIoXG4gICAgICAgICAgICBjID0+XG4gICAgICAgICAgICAgICAgIWMuaW5SZWFkeVN0YXRlKCkgJiZcbiAgICAgICAgICAgICAgICBjLmdldChcInZpc2libGVcIikgJiZcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBkZWxldGVkT3JQdXJnZWQ/XG4gICAgICAgICAgICAgICAgIWMuZ2V0KFwiZGVsZXRlZFwiKVxuICAgICAgICApO1xuICAgIH0sXG5cbiAgICAvKiogR2V0IHRoZSBtb2RlbCB3aXRoIHRoZSBnaXZlbiBoaWRcbiAgICAgKiAgQHBhcmFtIHtJbnR9IGhpZCB0aGUgaGlkIHRvIHNlYXJjaCBmb3JcbiAgICAgKiAgQHJldHVybnMge0hpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb259IHRoZSBtb2RlbCB3aXRoIHRoZSBnaXZlbiBoaWQgb3IgdW5kZWZpbmVkIGlmIG5vdCBmb3VuZFxuICAgICAqL1xuICAgIGdldEJ5SGlkOiBmdW5jdGlvbihoaWQpIHtcbiAgICAgICAgLy8gbm90ZTogdGhlcmUgKmNhbiogYmUgbW9yZSB0aGFuIG9uZSBjb250ZW50IHdpdGggYSBnaXZlbiBoaWQsIHRoaXMgZmluZHMgdGhlIGZpcnN0IGJhc2VkIG9uIG9yZGVyXG4gICAgICAgIHJldHVybiB0aGlzLmZpbmRXaGVyZSh7IGhpZDogaGlkIH0pO1xuICAgIH0sXG5cbiAgICAvKiogcmV0dXJuIHRydWUgaWYgYWxsIGNvbnRlbnRzIGhhdmUgZGV0YWlscyAqL1xuICAgIGhhdmVEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsKGMgPT4gYy5oYXNEZXRhaWxzKCkpO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gaGlkZGVuIC8gZGVsZXRlZFxuICAgIC8qKiByZXR1cm4gYSBuZXcgY29udGVudHMgY29sbGVjdGlvbiBvZiBvbmx5IGhpZGRlbiBpdGVtcyAqL1xuICAgIGhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihjID0+IGMuaGlkZGVuKCkpO1xuICAgIH0sXG5cbiAgICAvKiogcmV0dXJuIGEgbmV3IGNvbnRlbnRzIGNvbGxlY3Rpb24gb2Ygb25seSBoaWRkZW4gaXRlbXMgKi9cbiAgICBkZWxldGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGMgPT4gYy5nZXQoXCJkZWxldGVkXCIpKTtcbiAgICB9LFxuXG4gICAgLyoqIHJldHVybiBhIG5ldyBjb250ZW50cyBjb2xsZWN0aW9uIG9mIG9ubHkgaGlkZGVuIGl0ZW1zICovXG4gICAgdmlzaWJsZUFuZFVuZGVsZXRlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihcbiAgICAgICAgICAgIGMgPT5cbiAgICAgICAgICAgICAgICBjLmdldChcInZpc2libGVcIikgJiZcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBkZWxldGVkT3JQdXJnZWQ/XG4gICAgICAgICAgICAgICAgIWMuZ2V0KFwiZGVsZXRlZFwiKVxuICAgICAgICApO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIGEgc2V0dGVyIGluIG9yZGVyIHRvIHB1Ymxpc2ggdGhlIGNoYW5nZSAqL1xuICAgIHNldEluY2x1ZGVEZWxldGVkOiBmdW5jdGlvbihzZXR0aW5nLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChfLmlzQm9vbGVhbihzZXR0aW5nKSAmJiBzZXR0aW5nICE9PSB0aGlzLmluY2x1ZGVEZWxldGVkKSB7XG4gICAgICAgICAgICB0aGlzLmluY2x1ZGVEZWxldGVkID0gc2V0dGluZztcbiAgICAgICAgICAgIGlmIChfLnJlc3VsdChvcHRpb25zLCBcInNpbGVudFwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImluY2x1ZGUtZGVsZXRlZFwiLCBzZXR0aW5nLCB0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIGEgc2V0dGVyIGluIG9yZGVyIHRvIHB1Ymxpc2ggdGhlIGNoYW5nZSAqL1xuICAgIHNldEluY2x1ZGVIaWRkZW46IGZ1bmN0aW9uKHNldHRpbmcsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKF8uaXNCb29sZWFuKHNldHRpbmcpICYmIHNldHRpbmcgIT09IHRoaXMuaW5jbHVkZUhpZGRlbikge1xuICAgICAgICAgICAgdGhpcy5pbmNsdWRlSGlkZGVuID0gc2V0dGluZztcbiAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgaWYgKF8ucmVzdWx0KG9wdGlvbnMsIFwic2lsZW50XCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwiaW5jbHVkZS1oaWRkZW5cIiwgc2V0dGluZywgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGFqYXhcbiAgICAvLyAuLi4uLi4uLi4uLi4gY29udHJvbGxlZCBmZXRjaCBjb2xsZWN0aW9uXG4gICAgLyoqIG92ZXJyaWRlIHRvIGdldCBleHBhbmRlZCBpZHMgZnJvbSBzZXNzaW9uU3RvcmFnZSBhbmQgcGFzcyB0byBBUEkgYXMgZGV0YWlscyAqL1xuICAgIGZldGNoOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBpZiAodGhpcy5oaXN0b3J5SWQgJiYgIW9wdGlvbnMuZGV0YWlscykge1xuICAgICAgICAgICAgdmFyIHByZWZzID0gSElTVE9SWV9QUkVGUy5IaXN0b3J5UHJlZnMuZ2V0KHRoaXMuaGlzdG9yeUlkKS50b0pTT04oKTtcbiAgICAgICAgICAgIGlmICghXy5pc0VtcHR5KHByZWZzLmV4cGFuZGVkSWRzKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuZGV0YWlscyA9IF8udmFsdWVzKHByZWZzLmV4cGFuZGVkSWRzKS5qb2luKFwiLFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5mZXRjaC5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uIENvbnRyb2xsZWRGZXRjaCBzdHVmZlxuICAgIC8qKiBvdmVycmlkZSB0byBpbmNsdWRlIHRoZSBBUEkgdmVyc2lvbmluZyBmbGFnICovXG4gICAgX2J1aWxkRmV0Y2hEYXRhOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBfLmV4dGVuZChfc3VwZXIucHJvdG90eXBlLl9idWlsZEZldGNoRGF0YS5jYWxsKHRoaXMsIG9wdGlvbnMpLCB7XG4gICAgICAgICAgICB2OiBcImRldlwiXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogRXh0ZW5kIHRvIGluY2x1ZGUgZGV0YWlscyBhbmQgdmVyc2lvbiAqL1xuICAgIF9mZXRjaFBhcmFtczogX3N1cGVyLnByb3RvdHlwZS5fZmV0Y2hQYXJhbXMuY29uY2F0KFtcbiAgICAgICAgLy8gVE9ETzogcmVtb3ZlICh0aGUgbmVlZCBmb3IpIGJvdGhcbiAgICAgICAgLyoqIHZlcnNpb24gKi9cbiAgICAgICAgXCJ2XCIsXG4gICAgICAgIC8qKiBkYXRhc2V0IGlkcyB0byBnZXQgZnVsbCBkZXRhaWxzIG9mICovXG4gICAgICAgIFwiZGV0YWlsc1wiXG4gICAgXSksXG5cbiAgICAvKiogb3ZlcnJpZGUgdG8gYWRkIGRlbGV0ZWQvaGlkZGVuIGZpbHRlcnMgKi9cbiAgICBfYnVpbGRGZXRjaEZpbHRlcnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHN1cGVyRmlsdGVycyA9IF9zdXBlci5wcm90b3R5cGUuX2J1aWxkRmV0Y2hGaWx0ZXJzLmNhbGwodGhpcywgb3B0aW9ucykgfHwge307XG4gICAgICAgIHZhciBmaWx0ZXJzID0ge307XG4gICAgICAgIGlmICghdGhpcy5pbmNsdWRlRGVsZXRlZCkge1xuICAgICAgICAgICAgZmlsdGVycy5kZWxldGVkID0gZmFsc2U7XG4gICAgICAgICAgICBmaWx0ZXJzLnB1cmdlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pbmNsdWRlSGlkZGVuKSB7XG4gICAgICAgICAgICBmaWx0ZXJzLnZpc2libGUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLmRlZmF1bHRzKHN1cGVyRmlsdGVycywgZmlsdGVycyk7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLiBwYWdpbmF0ZWQgY29sbGVjdGlvblxuICAgIGdldFRvdGFsSXRlbUNvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGlzdG9yeS5jb250ZW50c1Nob3duKCk7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLiBoaXN0b3J5IGNvbnRlbnRzIHNwZWNpZmljIGFqYXhcbiAgICAvKiogb3ZlcnJpZGUgdG8gZmlsdGVyIHJlcXVlc3RlZCBjb250ZW50cyB0byB0aG9zZSB1cGRhdGVkIGFmdGVyIHRoZSBEYXRlICdzaW5jZScgKi9cbiAgICBmZXRjaFVwZGF0ZWQ6IGZ1bmN0aW9uKHNpbmNlLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChzaW5jZSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwgeyBmaWx0ZXJzOiB7fSB9O1xuICAgICAgICAgICAgb3B0aW9ucy5yZW1vdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIG9wdGlvbnMuZmlsdGVycyA9IHtcbiAgICAgICAgICAgICAgICBcInVwZGF0ZV90aW1lLWdlXCI6IHNpbmNlLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgLy8gd29ya2Zsb3dzIHdpbGwgcHJvZHVjZSBoaWRkZW4gZGF0YXNldHMgKG5vbi1vdXRwdXQgZGF0YXNldHMpIHRoYXQgc3RpbGxcbiAgICAgICAgICAgICAgICAvLyBuZWVkIHRvIGJlIHVwZGF0ZWQgaW4gdGhlIGNvbGxlY3Rpb24gb3IgdGhleSdsbCB1cGRhdGUgZm9yZXZlclxuICAgICAgICAgICAgICAgIC8vIHdlIGNhbiByZW1vdmUgdGhlIGRlZmF1bHQgdmlzaWJsZSBmaWx0ZXIgYnkgdXNpbmcgYW4gJ2VtcHR5JyB2YWx1ZVxuICAgICAgICAgICAgICAgIHZpc2libGU6IFwiXCJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gob3B0aW9ucyk7XG4gICAgfSxcblxuICAgIC8qKiBmZXRjaCBhbGwgdGhlIGRlbGV0ZWQ9PXRydWUgY29udGVudHMgb2YgdGhpcyBjb2xsZWN0aW9uICovXG4gICAgZmV0Y2hEZWxldGVkOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBvcHRpb25zLmZpbHRlcnMgPSBfLmV4dGVuZChvcHRpb25zLmZpbHRlcnMsIHtcbiAgICAgICAgICAgIC8vIGFsbCBkZWxldGVkLCBwdXJnZWQgb3Igbm90XG4gICAgICAgICAgICBkZWxldGVkOiB0cnVlLFxuICAgICAgICAgICAgcHVyZ2VkOiB1bmRlZmluZWRcbiAgICAgICAgfSk7XG4gICAgICAgIG9wdGlvbnMucmVtb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy50cmlnZ2VyKFwiZmV0Y2hpbmctZGVsZXRlZFwiLCB0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gob3B0aW9ucykuYWx3YXlzKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImZldGNoaW5nLWRlbGV0ZWQtZG9uZVwiLCB0aGlzKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBmZXRjaCBhbGwgdGhlIHZpc2libGU9PWZhbHNlIGNvbnRlbnRzIG9mIHRoaXMgY29sbGVjdGlvbiAqL1xuICAgIGZldGNoSGlkZGVuOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIG9wdGlvbnMuZmlsdGVycyA9IF8uZXh0ZW5kKG9wdGlvbnMuZmlsdGVycywge1xuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICAgIG9wdGlvbnMucmVtb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgc2VsZi50cmlnZ2VyKFwiZmV0Y2hpbmctaGlkZGVuXCIsIHNlbGYpO1xuICAgICAgICByZXR1cm4gc2VsZi5mZXRjaChvcHRpb25zKS5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi50cmlnZ2VyKFwiZmV0Y2hpbmctaGlkZGVuLWRvbmVcIiwgc2VsZik7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogZmV0Y2ggZGV0YWlsZWQgbW9kZWwgZGF0YSBmb3IgYWxsIGNvbnRlbnRzIGluIHRoaXMgY29sbGVjdGlvbiAqL1xuICAgIGZldGNoQWxsRGV0YWlsczogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdmFyIGRldGFpbHNGbGFnID0geyBkZXRhaWxzOiBcImFsbFwiIH07XG4gICAgICAgIG9wdGlvbnMuZGF0YSA9IF8uZXh0ZW5kKG9wdGlvbnMuZGF0YSB8fCB7fSwgZGV0YWlsc0ZsYWcpO1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChvcHRpb25zKTtcbiAgICB9LFxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLiBxdWFzaS1iYXRjaCBvcHNcbiAgICAvLyBUT0RPOiB0byBiYXRjaFxuICAgIC8qKiBoZWxwZXIgdGhhdCBmZXRjaGVzIHVzaW5nIGZpbHRlclBhcmFtcyB0aGVuIGNhbGxzIHNhdmUgb24gZWFjaCBmZXRjaGVkIHVzaW5nIHVwZGF0ZVdoYXQgYXMgdGhlIHNhdmUgcGFyYW1zICovXG4gICAgX2ZpbHRlckFuZFVwZGF0ZTogZnVuY3Rpb24oZmlsdGVyUGFyYW1zLCB1cGRhdGVXaGF0KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGlkQXR0cmlidXRlID0gc2VsZi5tb2RlbC5wcm90b3R5cGUuaWRBdHRyaWJ1dGU7XG4gICAgICAgIHZhciB1cGRhdGVBcmdzID0gW3VwZGF0ZVdoYXRdO1xuXG4gICAgICAgIHJldHVybiBzZWxmLmZldGNoKHsgZmlsdGVyczogZmlsdGVyUGFyYW1zLCByZW1vdmU6IGZhbHNlIH0pLnRoZW4oZmV0Y2hlZCA9PiB7XG4gICAgICAgICAgICAvLyBjb252ZXJ0IGZpbHRlcmVkIGpzb24gYXJyYXkgdG8gbW9kZWwgYXJyYXlcbiAgICAgICAgICAgIGZldGNoZWQgPSBmZXRjaGVkLnJlZHVjZSgobW9kZWxBcnJheSwgY3Vyckpzb24sIGkpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSBzZWxmLmdldChjdXJySnNvbltpZEF0dHJpYnV0ZV0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbCA/IG1vZGVsQXJyYXkuY29uY2F0KG1vZGVsKSA6IG1vZGVsQXJyYXk7XG4gICAgICAgICAgICB9LCBbXSk7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5hamF4UXVldWUoXCJzYXZlXCIsIHVwZGF0ZUFyZ3MsIGZldGNoZWQpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIHVzaW5nIGEgcXVldWUsIHBlcmZvcm0gYWpheEZuIG9uIGVhY2ggb2YgdGhlIG1vZGVscyBpbiB0aGlzIGNvbGxlY3Rpb24gKi9cbiAgICBhamF4UXVldWU6IGZ1bmN0aW9uKGFqYXhGbiwgYXJncywgY29sbGVjdGlvbikge1xuICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbiB8fCB0aGlzLm1vZGVscztcbiAgICAgICAgcmV0dXJuIG5ldyBBSkFYX1FVRVVFLkFqYXhRdWV1ZShcbiAgICAgICAgICAgIGNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuc2xpY2UoKVxuICAgICAgICAgICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgICAgICAgICAubWFwKChjb250ZW50LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IF8uaXNTdHJpbmcoYWpheEZuKSA/IGNvbnRlbnRbYWpheEZuXSA6IGFqYXhGbjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IGZuLmFwcGx5KGNvbnRlbnQsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICkuZGVmZXJyZWQ7XG4gICAgfSxcblxuICAgIC8qKiBmZXRjaCBjb250ZW50cycgZGV0YWlscyBpbiBiYXRjaGVzIG9mIGxpbWl0UGVyQ2FsbCAtIG5vdGU6IG9ubHkgZ2V0IHNlYXJjaGFibGUgZGV0YWlscyBoZXJlICovXG4gICAgcHJvZ3Jlc3NpdmVseUZldGNoRGV0YWlsczogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdmFyIGRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGxpbWl0ID0gb3B0aW9ucy5saW1pdFBlckNhbGwgfHwgc2VsZi5saW1pdFBlclByb2dyZXNzaXZlRmV0Y2g7XG4gICAgICAgIC8vIFRPRE86IG9ubHkgZmV0Y2ggdGFncyBhbmQgYW5ub3RhdGlvbnMgaWYgc3BlY2lmaWNhbGx5IHJlcXVlc3RlZFxuICAgICAgICB2YXIgc2VhcmNoQXR0cmlidXRlcyA9IEhEQV9NT0RFTC5IaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uLnByb3RvdHlwZS5zZWFyY2hBdHRyaWJ1dGVzO1xuICAgICAgICB2YXIgZGV0YWlsS2V5cyA9IHNlYXJjaEF0dHJpYnV0ZXMuam9pbihcIixcIik7XG5cbiAgICAgICAgZnVuY3Rpb24gX3JlY3Vyc2l2ZWx5RmV0Y2gob2Zmc2V0KSB7XG4gICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcbiAgICAgICAgICAgIHZhciBfb3B0aW9ucyA9IF8uZXh0ZW5kKF8uY2xvbmUob3B0aW9ucyksIHtcbiAgICAgICAgICAgICAgICB2aWV3OiBcInN1bW1hcnlcIixcbiAgICAgICAgICAgICAgICBrZXlzOiBkZXRhaWxLZXlzLFxuICAgICAgICAgICAgICAgIGxpbWl0OiBsaW1pdCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICByZXNldDogb2Zmc2V0ID09PSAwLFxuICAgICAgICAgICAgICAgIHJlbW92ZTogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBfLmRlZmVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLmZldGNoXG4gICAgICAgICAgICAgICAgICAgIC5jYWxsKHNlbGYsIF9vcHRpb25zKVxuICAgICAgICAgICAgICAgICAgICAuZmFpbChkZWZlcnJlZC5yZWplY3QpXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLm5vdGlmeShyZXNwb25zZSwgbGltaXQsIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UubGVuZ3RoICE9PSBsaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWxsRmV0Y2hlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZSwgbGltaXQsIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWN1cnNpdmVseUZldGNoKG9mZnNldCArIGxpbWl0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBfcmVjdXJzaXZlbHlGZXRjaCgpO1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQ7XG4gICAgfSxcblxuICAgIC8qKiBkb2VzIHNvbWUgYml0IG9mIEpTT04gcmVwcmVzZW50IHNvbWV0aGluZyB0aGF0IGNhbiBiZSBjb3BpZWQgaW50byB0aGlzIGNvbnRlbnRzIGNvbGxlY3Rpb24gKi9cbiAgICBpc0NvcHlhYmxlOiBmdW5jdGlvbihjb250ZW50c0pTT04pIHtcbiAgICAgICAgdmFyIGNvcHlhYmxlTW9kZWxDbGFzc2VzID0gW1wiSGlzdG9yeURhdGFzZXRBc3NvY2lhdGlvblwiLCBcIkhpc3RvcnlEYXRhc2V0Q29sbGVjdGlvbkFzc29jaWF0aW9uXCJdO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgXy5pc09iamVjdChjb250ZW50c0pTT04pICYmIGNvbnRlbnRzSlNPTi5pZCAmJiBfLmNvbnRhaW5zKGNvcHlhYmxlTW9kZWxDbGFzc2VzLCBjb250ZW50c0pTT04ubW9kZWxfY2xhc3MpXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8qKiBjb3B5IGFuIGV4aXN0aW5nLCBhY2Nlc3NpYmxlIGhkYSBpbnRvIHRoaXMgY29sbGVjdGlvbiAqL1xuICAgIGNvcHk6IGZ1bmN0aW9uKGpzb24pIHtcbiAgICAgICAgLy8gVE9ETzogc29tZWhvdyBzaG93aG9ybiBhbGwgdGhpcyBpbnRvICdzYXZlJ1xuICAgICAgICB2YXIgaWQ7XG5cbiAgICAgICAgdmFyIHR5cGU7XG4gICAgICAgIHZhciBjb250ZW50VHlwZTtcbiAgICAgICAgaWYgKF8uaXNTdHJpbmcoanNvbikpIHtcbiAgICAgICAgICAgIGlkID0ganNvbjtcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gXCJoZGFcIjtcbiAgICAgICAgICAgIHR5cGUgPSBcImRhdGFzZXRcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlkID0ganNvbi5pZDtcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlID1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIEhpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb246IFwiaGRhXCIsXG4gICAgICAgICAgICAgICAgICAgIExpYnJhcnlEYXRhc2V0RGF0YXNldEFzc29jaWF0aW9uOiBcImxkZGFcIixcbiAgICAgICAgICAgICAgICAgICAgSGlzdG9yeURhdGFzZXRDb2xsZWN0aW9uQXNzb2NpYXRpb246IFwiaGRjYVwiXG4gICAgICAgICAgICAgICAgfVtqc29uLm1vZGVsX2NsYXNzXSB8fCBcImhkYVwiO1xuICAgICAgICAgICAgdHlwZSA9IGNvbnRlbnRUeXBlID09PSBcImhkY2FcIiA/IFwiZGF0YXNldF9jb2xsZWN0aW9uXCIgOiBcImRhdGFzZXRcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG5cbiAgICAgICAgdmFyIHhociA9IGpRdWVyeVxuICAgICAgICAgICAgLmFqYXgodGhpcy51cmwoKSwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogaWQsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogY29udGVudFR5cGUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5kb25lKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmFkZChbcmVzcG9uc2VdLCB7IHBhcnNlOiB0cnVlIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5mYWlsKChlcnJvciwgc3RhdHVzLCBtZXNzYWdlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi50cmlnZ2VyKFwiZXJyb3JcIiwgY29sbGVjdGlvbiwgeGhyLCB7fSwgXCJFcnJvciBjb3B5aW5nIGNvbnRlbnRzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGNvbnRlbnRUeXBlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4geGhyO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIGEgbmV3IEhEQ0EgaW4gdGhpcyBjb2xsZWN0aW9uICovXG4gICAgY3JlYXRlSERDQTogZnVuY3Rpb24oZWxlbWVudElkZW50aWZpZXJzLCBjb2xsZWN0aW9uVHlwZSwgbmFtZSwgaGlkZVNvdXJjZUl0ZW1zLCBvcHRpb25zKSB7XG4gICAgICAgIC8vIG5vcm1hbGx5IGNvbGxlY3Rpb24uY3JlYXRlIHJldHVybnMgdGhlIG5ldyBtb2RlbCwgYnV0IHdlIG5lZWQgdGhlIHByb21pc2UgZnJvbSB0aGUgYWpheCwgc28gd2UgZmFrZSBjcmVhdGVcbiAgICAgICAgLy9wcmVjb25kaXRpb246IGVsZW1lbnRJZGVudGlmaWVycyBpcyBhbiBhcnJheSBvZiBwbGFpbiBqcyBvYmplY3RzXG4gICAgICAgIC8vICBpbiB0aGUgcHJvcGVyIGZvcm0gdG8gY3JlYXRlIHRoZSBjb2xsZWN0aW9uVHlwZVxuICAgICAgICB2YXIgaGRjYSA9IHRoaXMubW9kZWwoe1xuICAgICAgICAgICAgaGlzdG9yeV9jb250ZW50X3R5cGU6IFwiZGF0YXNldF9jb2xsZWN0aW9uXCIsXG4gICAgICAgICAgICBjb2xsZWN0aW9uX3R5cGU6IGNvbGxlY3Rpb25UeXBlLFxuICAgICAgICAgICAgaGlzdG9yeV9pZDogdGhpcy5oaXN0b3J5SWQsXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgaGlkZV9zb3VyY2VfaXRlbXM6IGhpZGVTb3VyY2VJdGVtcyB8fCBmYWxzZSxcbiAgICAgICAgICAgIC8vIHNob3VsZCBwcm9iYWJseSBiZSBhYmxlIHRvIGp1c3Qgc2VuZCBpbiBhIGJ1bmNoIG9mIGpzb24gaGVyZSBhbmQgcmVzdHJ1Y3QgcGVyIGNsYXNzXG4gICAgICAgICAgICAvLyBub3RlOiBlbGVtZW50X2lkZW50aWZpZXJzIGlzIG5vdyAoaW5jb3JyZWN0bHkpIGFuIGF0dHJpYnV0ZVxuICAgICAgICAgICAgZWxlbWVudF9pZGVudGlmaWVyczogZWxlbWVudElkZW50aWZpZXJzXG4gICAgICAgICAgICAvLyBkbyBub3QgY3JlYXRlIHRoZSBtb2RlbCBvbiB0aGUgY2xpZW50IHVudGlsIHRoZSBhamF4IHJldHVybnNcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBoZGNhLnNhdmUob3B0aW9ucyk7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBzZWFyY2hpbmdcbiAgICAvKiogcmV0dXJuIHRydWUgaWYgYWxsIGNvbnRlbnRzIGhhdmUgdGhlIHNlYXJjaGFibGUgYXR0cmlidXRlcyAqL1xuICAgIGhhdmVTZWFyY2hEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHRoaXMuYWxsRmV0Y2hlZCAmJlxuICAgICAgICAgICAgdGhpcy5hbGwoKFxuICAgICAgICAgICAgICAgIGNvbnRlbnQgLy8gbnVsbCAod2hpY2ggaXMgYSB2YWxpZCByZXR1cm5lZCBhbm5vdGF0aW9uIHZhbHVlKVxuICAgICAgICAgICAgKSA9PlxuICAgICAgICAgICAgICAgIC8vIHdpbGwgcmV0dXJuIGZhbHNlIHdoZW4gdXNpbmcgY29udGVudC5oYXMoICdhbm5vdGF0aW9uJyApXG4gICAgICAgICAgICAgICAgLy9UT0RPOiBhIGJpdCBoYWNreSAtIGZvcm1hbGl6ZVxuICAgICAgICAgICAgICAgIF8uaGFzKGNvbnRlbnQuYXR0cmlidXRlcywgXCJhbm5vdGF0aW9uXCIpXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8qKiByZXR1cm4gYSBuZXcgY29sbGVjdGlvbiBvZiBjb250ZW50cyB3aG9zZSBhdHRyaWJ1dGVzIGNvbnRhaW4gdGhlIHN1YnN0cmluZyBtYXRjaGVzV2hhdCAqL1xuICAgIG1hdGNoZXM6IGZ1bmN0aW9uKG1hdGNoZXNXaGF0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihjb250ZW50ID0+IGNvbnRlbnQubWF0Y2hlcyhtYXRjaGVzV2hhdCkpO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBjb3B5IHRoZSBoaXN0b3J5SWQgdG8gdGhlIGNsb25lICovXG4gICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5jbG9uZS5jYWxsKHRoaXMpO1xuICAgICAgICBjbG9uZS5oaXN0b3J5SWQgPSB0aGlzLmhpc3RvcnlJZDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH0sXG5cbiAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uLiAqL1xuICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFtcIkhpc3RvcnlDb250ZW50cyhcIiwgW3RoaXMuaGlzdG9yeUlkLCB0aGlzLmxlbmd0aF0uam9pbigpLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICB9XG59KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBIaXN0b3J5Q29udGVudHM6IEhpc3RvcnlDb250ZW50c1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9oaXN0b3J5LWNvbnRlbnRzLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBSEE7QUFVQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUxBO0FBQUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExZUE7QUFDQTtBQTRlQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///16\n");

/***/ }),
/* 17 */
/*!**************************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/dataset-li.js ***!
  \**************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, jQuery, Backbone, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listItem = __webpack_require__(/*! mvc/list/list-item */ 22);\n\nvar _listItem2 = _interopRequireDefault(_listItem);\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"dataset\";\n/*==============================================================================\nTODO:\n    straighten out state rendering and templates used\n    inaccessible/STATES.NOT_VIEWABLE is a special case\n    simplify button rendering\n\n==============================================================================*/\nvar _super = _listItem2.default.ListItemView;\n/** @class Read only list view for either LDDAs, HDAs, or HDADCEs.\n *      Roughly, any DatasetInstance (and not a raw Dataset).\n */\nvar DatasetListItemView = _super.extend(\n/** @lends DatasetListItemView.prototype */{\n    _logNamespace: logNamespace,\n\n    className: _super.prototype.className + \" dataset\",\n    //TODO:?? doesn't exactly match an hda's type_id\n    id: function id() {\n        return [\"dataset\", this.model.get(\"id\")].join(\"-\");\n    },\n\n    /** Set up: instance vars, options, and event handlers */\n    initialize: function initialize(attributes) {\n        if (attributes.logger) {\n            this.logger = this.model.logger = attributes.logger;\n        }\n        this.log(this + \".initialize:\", attributes);\n        _super.prototype.initialize.call(this, attributes);\n\n        /** where should pages from links be displayed? (default to new tab/window) */\n        this.linkTarget = attributes.linkTarget || \"_blank\";\n    },\n\n    /** event listeners */\n    _setUpListeners: function _setUpListeners() {\n        _super.prototype._setUpListeners.call(this);\n        var self = this;\n\n        // re-rendering on any model changes\n        return self.listenTo(self.model, {\n            change: function change(model) {\n                // if the model moved into the ready state and is expanded without details, fetch those details now\n                if (self.model.changedAttributes().state && self.model.inReadyState() && self.expanded && !self.model.hasDetails()) {\n                    // normally, will render automatically (due to fetch -> change),\n                    // but! setting_metadata sometimes doesn't cause any other changes besides state\n                    // so, not rendering causes it to seem frozen in setting_metadata state\n                    self.model.fetch({ silent: true }).done(function () {\n                        self.render();\n                    });\n                } else {\n                    if (_.has(model.changed, \"tags\") && _.keys(model.changed).length === 1) {\n                        // If only the tags have changed, rerender specifically\n                        // the titlebar region.  Otherwise default to the full\n                        // render.\n                        self.$(\".nametags\").html(self._renderNametags());\n                    } else {\n                        self.render();\n                    }\n                }\n            }\n        });\n    },\n\n    // ......................................................................... expandable\n    /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails: function _fetchModelDetails() {\n        var view = this;\n        if (view.model.inReadyState() && !view.model.hasDetails()) {\n            return view.model.fetch({ silent: true });\n        }\n        return jQuery.when();\n    },\n\n    // ......................................................................... removal\n    /** Remove this view's html from the DOM and remove all event listeners.\n     *  @param {Number or String} speed jq effect speed\n     *  @param {Function} callback      an optional function called when removal is done (scoped to this view)\n     */\n    remove: function remove(speed, callback) {\n        var view = this;\n        speed = speed || this.fxSpeed;\n        this.$el.fadeOut(speed, function () {\n            Backbone.View.prototype.remove.call(view);\n            if (callback) {\n                callback.call(view);\n            }\n        });\n    },\n\n    // ......................................................................... rendering\n    /* TODO:\n    dataset states are the issue primarily making dataset rendering complex\n        each state should have it's own way of displaying/set of details\n        often with different actions that can be applied\n    throw in deleted/purged/visible and things get complicated easily\n    I've considered (a couple of times) - creating a view for each state\n        - but recreating the view during an update...seems wrong\n    */\n    /** In this override, add the dataset state as a class for use with state-based CSS */\n    _swapNewRender: function _swapNewRender($newRender) {\n        _super.prototype._swapNewRender.call(this, $newRender);\n        if (this.model.has(\"state\")) {\n            this.$el.addClass(\"state-\" + this.model.get(\"state\"));\n        }\n        return this.$el;\n    },\n\n    // ................................................................................ titlebar\n    /** In this override, add the dataset display button. */\n    _renderPrimaryActions: function _renderPrimaryActions() {\n        // render just the display for read-only\n        return [this._renderDisplayButton()];\n    },\n\n    /** Render icon-button to display dataset data */\n    _renderDisplayButton: function _renderDisplayButton() {\n        // don't show display if not viewable or not accessible\n        var state = this.model.get(\"state\");\n        if (state === _states2.default.NOT_VIEWABLE || state === _states2.default.DISCARDED || !this.model.get(\"accessible\")) {\n            return null;\n        }\n\n        var displayBtnData = {\n            target: this.linkTarget,\n            classes: \"display-btn\"\n        };\n\n        // show a disabled display if the data's been purged\n        if (this.model.get(\"purged\")) {\n            displayBtnData.disabled = true;\n            displayBtnData.title = (0, _localization2.default)(\"Cannot display datasets removed from disk\");\n\n            // disable if still uploading\n        } else if (state === _states2.default.UPLOAD) {\n            displayBtnData.disabled = true;\n            displayBtnData.title = (0, _localization2.default)(\"This dataset must finish uploading before it can be viewed\");\n\n            // disable if still new\n        } else if (state === _states2.default.NEW) {\n            displayBtnData.disabled = true;\n            displayBtnData.title = (0, _localization2.default)(\"This dataset is not yet viewable\");\n        } else {\n            displayBtnData.title = (0, _localization2.default)(\"View data\");\n\n            // default link for dataset\n            displayBtnData.href = this.model.urls.display;\n\n            // add frame manager option onclick event\n            var self = this;\n            displayBtnData.onclick = function (ev) {\n                if (Galaxy.frame && Galaxy.frame.active) {\n                    // Add dataset to frames.\n                    Galaxy.frame.addDataset(self.model.get(\"id\"));\n                    ev.preventDefault();\n                }\n            };\n        }\n        displayBtnData.faIcon = \"fa-eye\";\n        return (0, _faIconButton2.default)(displayBtnData);\n    },\n\n    // ......................................................................... rendering details\n    /** Render the enclosing div of the hda body and, if expanded, the html in the body\n     *  @returns {jQuery} rendered DOM\n     */\n    _renderDetails: function _renderDetails() {\n        //TODO: generalize to be allow different details for each state\n\n        // no access - render nothing but a message\n        if (this.model.get(\"state\") === _states2.default.NOT_VIEWABLE) {\n            return $(this.templates.noAccess(this.model.toJSON(), this));\n        }\n\n        var $details = _super.prototype._renderDetails.call(this);\n        $details.find(\".actions .left\").empty().append(this._renderSecondaryActions());\n        $details.find(\".summary\").html(this._renderSummary()).prepend(this._renderDetailMessages());\n        $details.find(\".display-applications\").html(this._renderDisplayApplications());\n\n        this._setUpBehaviors($details);\n        return $details;\n    },\n\n    /** Defer to the appropo summary rendering fn based on state */\n    _renderSummary: function _renderSummary() {\n        var json = this.model.toJSON();\n        var summaryRenderFn = this.templates.summaries[json.state];\n        summaryRenderFn = summaryRenderFn || this.templates.summaries.unknown;\n        return summaryRenderFn(json, this);\n    },\n\n    /** Render messages to be displayed only when the details are shown */\n    _renderDetailMessages: function _renderDetailMessages() {\n        var view = this;\n        var $warnings = $('<div class=\"detail-messages\"></div>');\n        var json = view.model.toJSON();\n        //TODO:! unordered (map)\n        _.each(view.templates.detailMessages, function (templateFn) {\n            $warnings.append($(templateFn(json, view)));\n        });\n        return $warnings;\n    },\n\n    /** Render the external display application links */\n    _renderDisplayApplications: function _renderDisplayApplications() {\n        if (this.model.isDeletedOrPurged()) {\n            return \"\";\n        }\n        // render both old and new display apps using the same template\n        return [this.templates.displayApplications(this.model.get(\"display_apps\"), this), this.templates.displayApplications(this.model.get(\"display_types\"), this)].join(\"\");\n    },\n\n    // ......................................................................... secondary/details actions\n    /** A series of links/buttons for less commonly used actions: re-run, info, etc. */\n    _renderSecondaryActions: function _renderSecondaryActions() {\n        this.debug(\"_renderSecondaryActions\");\n        switch (this.model.get(\"state\")) {\n            case _states2.default.NOT_VIEWABLE:\n                return [];\n            case _states2.default.OK:\n            case _states2.default.FAILED_METADATA:\n            case _states2.default.ERROR:\n                return [this._renderDownloadButton(), this._renderShowParamsButton()];\n        }\n        return [this._renderShowParamsButton()];\n    },\n\n    /** Render icon-button to show the input and output (stdout/err) for the job that created this.\n     *  @returns {jQuery} rendered DOM\n     */\n    _renderShowParamsButton: function _renderShowParamsButton() {\n        // gen. safe to show in all cases\n        return (0, _faIconButton2.default)({\n            title: (0, _localization2.default)(\"View details\"),\n            classes: \"params-btn\",\n            href: this.model.urls.show_params,\n            target: this.linkTarget,\n            faIcon: \"fa-info-circle\",\n            onclick: function onclick(ev) {\n                if (Galaxy.frame && Galaxy.frame.active) {\n                    Galaxy.frame.add({\n                        title: (0, _localization2.default)(\"Dataset details\"),\n                        url: this.href\n                    });\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                }\n            }\n        });\n    },\n\n    /** Render icon-button/popupmenu to download the data (and/or the associated meta files (bai, etc.)) for this.\n     *  @returns {jQuery} rendered DOM\n     */\n    _renderDownloadButton: function _renderDownloadButton() {\n        // don't show anything if the data's been purged\n        if (this.model.get(\"purged\") || !this.model.hasData()) {\n            return null;\n        }\n\n        // return either: a popupmenu with links to download assoc. meta files (if there are meta files)\n        //  or a single download icon-button (if there are no meta files)\n        if (!_.isEmpty(this.model.get(\"meta_files\"))) {\n            return this._renderMetaFileDownloadButton();\n        }\n\n        return $(\"\\n                <a class=\\\"download-btn icon-btn\\\" href=\\\"\" + this.model.urls.download + \"\\\" title=\\\"\" + (0, _localization2.default)(\"Download\") + \"\\\">\\n                    <span class=\\\"fa fa-floppy-o\\\"></span>\\n                </a>\");\n    },\n\n    /** Render the download button which opens a dropdown with links to download assoc. meta files (indices, etc.) */\n    _renderMetaFileDownloadButton: function _renderMetaFileDownloadButton() {\n        var urls = this.model.urls;\n        return $(\"\\n                <div class=\\\"metafile-dropdown dropdown\\\">\\n                    <a class=\\\"download-btn icon-btn\\\" href=\\\"\" + urls.download + \"\\\" data-toggle=\\\"dropdown\\\" title=\\\"\" + (0, _localization2.default)(\"Download\") + \"\\\">\\n                        <span class=\\\"fa fa-floppy-o\\\"></span>\\n                    </a>\\n                    <ul class=\\\"dropdown-menu\\\" role=\\\"menu\\\">\\n                        <li>\\n                            <a href=\\\"\" + urls.download + \"\\\">\\n                                \" + (0, _localization2.default)(\"Download dataset\") + \"\\n                            </a>\\n                        </li>\\n                        \" + _.map(this.model.get(\"meta_files\"), function (meta_file) {\n            return \"<li>\\n                                    <a href=\\\"\" + (urls.meta_download + meta_file.file_type) + \"\\\">\\n                                        \" + (0, _localization2.default)(\"Download\") + \" \" + meta_file.file_type + \"\\n                                    </a>\\n                                </li>\";\n        }) + \"\\n                    </ul>\\n                </div>\");\n    },\n\n    _renderNametags: function _renderNametags() {\n        var tpl = _.template([\"<% _.each(_.sortBy(_.uniq(tags), function(x) { return x }), function(tag){ %>\", '<% if (tag.indexOf(\"name:\") == 0){ %>', '<span class=\"label label-info\"><%- tag.slice(5) %></span>', \"<% } %>\", \"<% }); %>\"].join(\"\"));\n        return tpl({ tags: this.model.get(\"tags\") });\n    },\n\n    // ......................................................................... misc\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .display-btn\": function clickDisplayBtn(ev) {\n            this.trigger(\"display\", this, ev);\n        },\n        \"click .params-btn\": function clickParamsBtn(ev) {\n            this.trigger(\"params\", this, ev);\n        },\n        \"click .download-btn\": function clickDownloadBtn(ev) {\n            this.trigger(\"download\", this, ev);\n        }\n    }),\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DatasetListItemView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDatasetListItemView.prototype.templates = function () {\n    //TODO: move to require text! plugin\n\n    var warnings = _.extend({}, _super.prototype.templates.warnings, {\n        failed_metadata: _baseMvc2.default.wrapTemplate([\n        // failed metadata is rendered as a warning on an otherwise ok dataset view\n        '<% if( model.state === \"failed_metadata\" ){ %>', '<div class=\"warningmessagesmall\">', (0, _localization2.default)(\"An error occurred setting the metadata for this dataset\"), \"</div>\", \"<% } %>\"]),\n        error: _baseMvc2.default.wrapTemplate([\n        // error during index fetch - show error on dataset\n        \"<% if( model.error ){ %>\", '<div class=\"errormessagesmall\">', (0, _localization2.default)(\"There was an error getting the data for this dataset\"), \": <%- model.error %>\", \"</div>\", \"<% } %>\"]),\n        purged: _baseMvc2.default.wrapTemplate([\"<% if( model.purged ){ %>\", '<div class=\"purged-msg warningmessagesmall\">', (0, _localization2.default)(\"This dataset has been deleted and removed from disk\"), \"</div>\", \"<% } %>\"]),\n        deleted: _baseMvc2.default.wrapTemplate([\n        // deleted not purged\n        \"<% if( model.deleted && !model.purged ){ %>\", '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This dataset has been deleted\"), \"</div>\", \"<% } %>\"])\n\n        //NOTE: hidden warning is only needed for HDAs\n    });\n\n    var detailsTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"details\">', '<div class=\"summary\"></div>', '<div class=\"actions clear\">', '<div class=\"left\"></div>', '<div class=\"right\"></div>', \"</div>\",\n\n    // do not display tags, annotation, display apps, or peek when deleted\n    \"<% if( !dataset.deleted && !dataset.purged ){ %>\", '<div class=\"tags-display\"></div>', '<div class=\"annotation-display\"></div>', '<div class=\"display-applications\"></div>', \"<% if( dataset.peek ){ %>\", '<pre class=\"dataset-peek\"><%= dataset.peek %></pre>', \"<% } %>\", \"<% } %>\", \"</div>\"], \"dataset\");\n\n    var noAccessTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"details\">', '<div class=\"summary\">', (0, _localization2.default)(\"You do not have permission to view this dataset\"), \"</div>\", \"</div>\"], \"dataset\");\n\n    //TODO: still toooooooooooooo complex - rework\n    var summaryTemplates = {};\n    summaryTemplates[_states2.default.OK] = summaryTemplates[_states2.default.FAILED_METADATA] = _baseMvc2.default.wrapTemplate([\"<% if( dataset.misc_blurb ){ %>\", '<div class=\"blurb\">', '<span class=\"value\"><%- dataset.misc_blurb %></span>', \"</div>\", \"<% } %>\", \"<% if( dataset.file_ext ){ %>\", '<div class=\"datatype\">', '<label class=\"prompt\">', (0, _localization2.default)(\"format\"), \"</label>\", '<span class=\"value\"><%- dataset.file_ext %></span>', \"</div>\", \"<% } %>\", \"<% if( dataset.metadata_dbkey ){ %>\", '<div class=\"dbkey\">', '<label class=\"prompt\">', (0, _localization2.default)(\"database\"), \"</label>\", '<span class=\"value\">', \"<%- dataset.metadata_dbkey %>\", \"</span>\", \"</div>\", \"<% } %>\", \"<% if( dataset.misc_info ){ %>\", '<div class=\"info\">', '<span class=\"value\"><%- dataset.misc_info %></span>', \"</div>\", \"<% } %>\"], \"dataset\");\n    summaryTemplates[_states2.default.NEW] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"This is a new dataset and not all of its data are available yet\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.NOT_VIEWABLE] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"You do not have permission to view this dataset\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.DISCARDED] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"The job creating this dataset was cancelled before completion\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.QUEUED] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"This job is waiting to run\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.RUNNING] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"This job is currently running\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.UPLOAD] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"This dataset is currently uploading\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.SETTING_METADATA] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"Metadata is being auto-detected\"), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.PAUSED] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)('This job is paused. Use the \"Resume Paused Jobs\" in the history menu to resume'), \"</div>\"], \"dataset\");\n    summaryTemplates[_states2.default.ERROR] = _baseMvc2.default.wrapTemplate([\"<% if( !dataset.purged ){ %>\", \"<div><%- dataset.misc_blurb %></div>\", \"<% } %>\", '<span class=\"help-text\">', (0, _localization2.default)(\"An error occurred with this dataset\"), \":</span>\", '<div class=\"job-error-text\"><%- dataset.misc_info %></div>'], \"dataset\");\n    summaryTemplates[_states2.default.EMPTY] = _baseMvc2.default.wrapTemplate([\"<div>\", (0, _localization2.default)(\"No data\"), \": <i><%- dataset.misc_blurb %></i></div>\"], \"dataset\");\n    summaryTemplates.unknown = _baseMvc2.default.wrapTemplate(['<div>Error: unknown dataset state: \"<%- dataset.state %>\"</div>'], \"dataset\");\n\n    // messages to be displayed only within the details section ('below the fold')\n    var detailMessageTemplates = {\n        resubmitted: _baseMvc2.default.wrapTemplate([\n        // deleted not purged\n        \"<% if( model.resubmitted ){ %>\", '<div class=\"resubmitted-msg infomessagesmall\">', (0, _localization2.default)(\"The job creating this dataset has been resubmitted\"), \"</div>\", \"<% } %>\"])\n    };\n\n    // this is applied to both old and new style display apps\n    var displayApplicationsTemplate = _baseMvc2.default.wrapTemplate([\"<% _.each( apps, function( app ){ %>\", '<div class=\"display-application\">', '<span class=\"display-application-location\"><%- app.label %></span> ', '<span class=\"display-application-links\">', \"<% _.each( app.links, function( link ){ %>\", '<a target=\"<%- link.target %>\" href=\"<%- link.href %>\">', \"<% print( _l( link.text ) ); %>\", \"</a> \", \"<% }); %>\", \"</span>\", \"</div>\", \"<% }); %>\"], \"apps\");\n\n    return _.extend({}, _super.prototype.templates, {\n        warnings: warnings,\n        details: detailsTemplate,\n        noAccess: noAccessTemplate,\n        summaries: summaryTemplates,\n        detailMessages: detailMessageTemplates,\n        displayApplications: displayApplicationsTemplate\n    });\n}();\n\n// ============================================================================\nexports.default = {\n    DatasetListItemView: DatasetListItemView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1saS5qcz9mMzYxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMSVNUX0lURU0gZnJvbSBcIm12Yy9saXN0L2xpc3QtaXRlbVwiO1xuaW1wb3J0IFNUQVRFUyBmcm9tIFwibXZjL2RhdGFzZXQvc3RhdGVzXCI7XG5pbXBvcnQgZmFJY29uQnV0dG9uIGZyb20gXCJ1aS9mYS1pY29uLWJ1dHRvblwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImRhdGFzZXRcIjtcbi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5UT0RPOlxuICAgIHN0cmFpZ2h0ZW4gb3V0IHN0YXRlIHJlbmRlcmluZyBhbmQgdGVtcGxhdGVzIHVzZWRcbiAgICBpbmFjY2Vzc2libGUvU1RBVEVTLk5PVF9WSUVXQUJMRSBpcyBhIHNwZWNpYWwgY2FzZVxuICAgIHNpbXBsaWZ5IGJ1dHRvbiByZW5kZXJpbmdcblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cbnZhciBfc3VwZXIgPSBMSVNUX0lURU0uTGlzdEl0ZW1WaWV3O1xuLyoqIEBjbGFzcyBSZWFkIG9ubHkgbGlzdCB2aWV3IGZvciBlaXRoZXIgTEREQXMsIEhEQXMsIG9yIEhEQURDRXMuXG4gKiAgICAgIFJvdWdobHksIGFueSBEYXRhc2V0SW5zdGFuY2UgKGFuZCBub3QgYSByYXcgRGF0YXNldCkuXG4gKi9cbnZhciBEYXRhc2V0TGlzdEl0ZW1WaWV3ID0gX3N1cGVyLmV4dGVuZChcbiAgICAvKiogQGxlbmRzIERhdGFzZXRMaXN0SXRlbVZpZXcucHJvdG90eXBlICovIHtcbiAgICAgICAgX2xvZ05hbWVzcGFjZTogbG9nTmFtZXNwYWNlLFxuXG4gICAgICAgIGNsYXNzTmFtZTogYCR7X3N1cGVyLnByb3RvdHlwZS5jbGFzc05hbWV9IGRhdGFzZXRgLFxuICAgICAgICAvL1RPRE86Pz8gZG9lc24ndCBleGFjdGx5IG1hdGNoIGFuIGhkYSdzIHR5cGVfaWRcbiAgICAgICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtcImRhdGFzZXRcIiwgdGhpcy5tb2RlbC5nZXQoXCJpZFwiKV0uam9pbihcIi1cIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFNldCB1cDogaW5zdGFuY2UgdmFycywgb3B0aW9ucywgYW5kIGV2ZW50IGhhbmRsZXJzICovXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmxvZ2dlcikge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyID0gdGhpcy5tb2RlbC5sb2dnZXIgPSBhdHRyaWJ1dGVzLmxvZ2dlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubG9nKGAke3RoaXN9LmluaXRpYWxpemU6YCwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcblxuICAgICAgICAgICAgLyoqIHdoZXJlIHNob3VsZCBwYWdlcyBmcm9tIGxpbmtzIGJlIGRpc3BsYXllZD8gKGRlZmF1bHQgdG8gbmV3IHRhYi93aW5kb3cpICovXG4gICAgICAgICAgICB0aGlzLmxpbmtUYXJnZXQgPSBhdHRyaWJ1dGVzLmxpbmtUYXJnZXQgfHwgXCJfYmxhbmtcIjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZXZlbnQgbGlzdGVuZXJzICovXG4gICAgICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcExpc3RlbmVycy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyByZS1yZW5kZXJpbmcgb24gYW55IG1vZGVsIGNoYW5nZXNcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmxpc3RlblRvKHNlbGYubW9kZWwsIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2U6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBtb2RlbCBtb3ZlZCBpbnRvIHRoZSByZWFkeSBzdGF0ZSBhbmQgaXMgZXhwYW5kZWQgd2l0aG91dCBkZXRhaWxzLCBmZXRjaCB0aG9zZSBkZXRhaWxzIG5vd1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGVsLmNoYW5nZWRBdHRyaWJ1dGVzKCkuc3RhdGUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubW9kZWwuaW5SZWFkeVN0YXRlKCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZXhwYW5kZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICFzZWxmLm1vZGVsLmhhc0RldGFpbHMoKVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vcm1hbGx5LCB3aWxsIHJlbmRlciBhdXRvbWF0aWNhbGx5IChkdWUgdG8gZmV0Y2ggLT4gY2hhbmdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCEgc2V0dGluZ19tZXRhZGF0YSBzb21ldGltZXMgZG9lc24ndCBjYXVzZSBhbnkgb3RoZXIgY2hhbmdlcyBiZXNpZGVzIHN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbywgbm90IHJlbmRlcmluZyBjYXVzZXMgaXQgdG8gc2VlbSBmcm96ZW4gaW4gc2V0dGluZ19tZXRhZGF0YSBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5mZXRjaCh7IHNpbGVudDogdHJ1ZSB9KS5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5oYXMobW9kZWwuY2hhbmdlZCwgXCJ0YWdzXCIpICYmIF8ua2V5cyhtb2RlbC5jaGFuZ2VkKS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBvbmx5IHRoZSB0YWdzIGhhdmUgY2hhbmdlZCwgcmVyZW5kZXIgc3BlY2lmaWNhbGx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHRpdGxlYmFyIHJlZ2lvbi4gIE90aGVyd2lzZSBkZWZhdWx0IHRvIHRoZSBmdWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVuZGVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJChcIi5uYW1ldGFnc1wiKS5odG1sKHNlbGYuX3JlbmRlck5hbWV0YWdzKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBleHBhbmRhYmxlXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBvbmx5IGdldCBkZXRhaWxzIGlmIGluIHRoZSByZWFkeSBzdGF0ZSwgZ2V0IHJlcnVubmFibGUgaWYgaW4gb3RoZXIgc3RhdGVzLlxuICAgICAgICAgKiAgTm90ZTogZmV0Y2ggd2l0aCBubyAnY2hhbmdlJyBldmVudCB0cmlnZ2VyaW5nIHRvIHByZXZlbnQgYXV0b21hdGljIHJlbmRlcmluZy5cbiAgICAgICAgICovXG4gICAgICAgIF9mZXRjaE1vZGVsRGV0YWlsczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodmlldy5tb2RlbC5pblJlYWR5U3RhdGUoKSAmJiAhdmlldy5tb2RlbC5oYXNEZXRhaWxzKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlldy5tb2RlbC5mZXRjaCh7IHNpbGVudDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gcmVtb3ZhbFxuICAgICAgICAvKiogUmVtb3ZlIHRoaXMgdmlldydzIGh0bWwgZnJvbSB0aGUgRE9NIGFuZCByZW1vdmUgYWxsIGV2ZW50IGxpc3RlbmVycy5cbiAgICAgICAgICogIEBwYXJhbSB7TnVtYmVyIG9yIFN0cmluZ30gc3BlZWQganEgZWZmZWN0IHNwZWVkXG4gICAgICAgICAqICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAgICAgIGFuIG9wdGlvbmFsIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIHJlbW92YWwgaXMgZG9uZSAoc2NvcGVkIHRvIHRoaXMgdmlldylcbiAgICAgICAgICovXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgICAgICBzcGVlZCA9IHNwZWVkIHx8IHRoaXMuZnhTcGVlZDtcbiAgICAgICAgICAgIHRoaXMuJGVsLmZhZGVPdXQoc3BlZWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuY2FsbCh2aWV3KTtcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh2aWV3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIHJlbmRlcmluZ1xuICAgICAgICAvKiBUT0RPOlxuICAgICAgICBkYXRhc2V0IHN0YXRlcyBhcmUgdGhlIGlzc3VlIHByaW1hcmlseSBtYWtpbmcgZGF0YXNldCByZW5kZXJpbmcgY29tcGxleFxuICAgICAgICAgICAgZWFjaCBzdGF0ZSBzaG91bGQgaGF2ZSBpdCdzIG93biB3YXkgb2YgZGlzcGxheWluZy9zZXQgb2YgZGV0YWlsc1xuICAgICAgICAgICAgb2Z0ZW4gd2l0aCBkaWZmZXJlbnQgYWN0aW9ucyB0aGF0IGNhbiBiZSBhcHBsaWVkXG4gICAgICAgIHRocm93IGluIGRlbGV0ZWQvcHVyZ2VkL3Zpc2libGUgYW5kIHRoaW5ncyBnZXQgY29tcGxpY2F0ZWQgZWFzaWx5XG4gICAgICAgIEkndmUgY29uc2lkZXJlZCAoYSBjb3VwbGUgb2YgdGltZXMpIC0gY3JlYXRpbmcgYSB2aWV3IGZvciBlYWNoIHN0YXRlXG4gICAgICAgICAgICAtIGJ1dCByZWNyZWF0aW5nIHRoZSB2aWV3IGR1cmluZyBhbiB1cGRhdGUuLi5zZWVtcyB3cm9uZ1xuICAgICovXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQgdGhlIGRhdGFzZXQgc3RhdGUgYXMgYSBjbGFzcyBmb3IgdXNlIHdpdGggc3RhdGUtYmFzZWQgQ1NTICovXG4gICAgICAgIF9zd2FwTmV3UmVuZGVyOiBmdW5jdGlvbigkbmV3UmVuZGVyKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zd2FwTmV3UmVuZGVyLmNhbGwodGhpcywgJG5ld1JlbmRlcik7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbC5oYXMoXCJzdGF0ZVwiKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKGBzdGF0ZS0ke3RoaXMubW9kZWwuZ2V0KFwic3RhdGVcIil9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gdGl0bGViYXJcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGFkZCB0aGUgZGF0YXNldCBkaXNwbGF5IGJ1dHRvbi4gKi9cbiAgICAgICAgX3JlbmRlclByaW1hcnlBY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIHJlbmRlciBqdXN0IHRoZSBkaXNwbGF5IGZvciByZWFkLW9ubHlcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5fcmVuZGVyRGlzcGxheUJ1dHRvbigpXTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIGljb24tYnV0dG9uIHRvIGRpc3BsYXkgZGF0YXNldCBkYXRhICovXG4gICAgICAgIF9yZW5kZXJEaXNwbGF5QnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIGRvbid0IHNob3cgZGlzcGxheSBpZiBub3Qgdmlld2FibGUgb3Igbm90IGFjY2Vzc2libGVcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIik7XG4gICAgICAgICAgICBpZiAoc3RhdGUgPT09IFNUQVRFUy5OT1RfVklFV0FCTEUgfHwgc3RhdGUgPT09IFNUQVRFUy5ESVNDQVJERUQgfHwgIXRoaXMubW9kZWwuZ2V0KFwiYWNjZXNzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGlzcGxheUJ0bkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLmxpbmtUYXJnZXQsXG4gICAgICAgICAgICAgICAgY2xhc3NlczogXCJkaXNwbGF5LWJ0blwiXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBzaG93IGEgZGlzYWJsZWQgZGlzcGxheSBpZiB0aGUgZGF0YSdzIGJlZW4gcHVyZ2VkXG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbC5nZXQoXCJwdXJnZWRcIikpIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZGlzcGxheUJ0bkRhdGEudGl0bGUgPSBfbChcIkNhbm5vdCBkaXNwbGF5IGRhdGFzZXRzIHJlbW92ZWQgZnJvbSBkaXNrXCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gZGlzYWJsZSBpZiBzdGlsbCB1cGxvYWRpbmdcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09IFNUQVRFUy5VUExPQUQpIHtcbiAgICAgICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZGlzcGxheUJ0bkRhdGEudGl0bGUgPSBfbChcIlRoaXMgZGF0YXNldCBtdXN0IGZpbmlzaCB1cGxvYWRpbmcgYmVmb3JlIGl0IGNhbiBiZSB2aWV3ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIGlmIHN0aWxsIG5ld1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gU1RBVEVTLk5FVykge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlCdG5EYXRhLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS50aXRsZSA9IF9sKFwiVGhpcyBkYXRhc2V0IGlzIG5vdCB5ZXQgdmlld2FibGVcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRpc3BsYXlCdG5EYXRhLnRpdGxlID0gX2woXCJWaWV3IGRhdGFcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBkZWZhdWx0IGxpbmsgZm9yIGRhdGFzZXRcbiAgICAgICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS5ocmVmID0gdGhpcy5tb2RlbC51cmxzLmRpc3BsYXk7XG5cbiAgICAgICAgICAgICAgICAvLyBhZGQgZnJhbWUgbWFuYWdlciBvcHRpb24gb25jbGljayBldmVudFxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS5vbmNsaWNrID0gZXYgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoR2FsYXh5LmZyYW1lICYmIEdhbGF4eS5mcmFtZS5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBkYXRhc2V0IHRvIGZyYW1lcy5cbiAgICAgICAgICAgICAgICAgICAgICAgIEdhbGF4eS5mcmFtZS5hZGREYXRhc2V0KHNlbGYubW9kZWwuZ2V0KFwiaWRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkaXNwbGF5QnRuRGF0YS5mYUljb24gPSBcImZhLWV5ZVwiO1xuICAgICAgICAgICAgcmV0dXJuIGZhSWNvbkJ1dHRvbihkaXNwbGF5QnRuRGF0YSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiByZW5kZXJpbmcgZGV0YWlsc1xuICAgICAgICAvKiogUmVuZGVyIHRoZSBlbmNsb3NpbmcgZGl2IG9mIHRoZSBoZGEgYm9keSBhbmQsIGlmIGV4cGFuZGVkLCB0aGUgaHRtbCBpbiB0aGUgYm9keVxuICAgICAgICAgKiAgQHJldHVybnMge2pRdWVyeX0gcmVuZGVyZWQgRE9NXG4gICAgICAgICAqL1xuICAgICAgICBfcmVuZGVyRGV0YWlsczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL1RPRE86IGdlbmVyYWxpemUgdG8gYmUgYWxsb3cgZGlmZmVyZW50IGRldGFpbHMgZm9yIGVhY2ggc3RhdGVcblxuICAgICAgICAgICAgLy8gbm8gYWNjZXNzIC0gcmVuZGVyIG5vdGhpbmcgYnV0IGEgbWVzc2FnZVxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIikgPT09IFNUQVRFUy5OT1RfVklFV0FCTEUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJCh0aGlzLnRlbXBsYXRlcy5ub0FjY2Vzcyh0aGlzLm1vZGVsLnRvSlNPTigpLCB0aGlzKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciAkZGV0YWlscyA9IF9zdXBlci5wcm90b3R5cGUuX3JlbmRlckRldGFpbHMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICRkZXRhaWxzXG4gICAgICAgICAgICAgICAgLmZpbmQoXCIuYWN0aW9ucyAubGVmdFwiKVxuICAgICAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLl9yZW5kZXJTZWNvbmRhcnlBY3Rpb25zKCkpO1xuICAgICAgICAgICAgJGRldGFpbHNcbiAgICAgICAgICAgICAgICAuZmluZChcIi5zdW1tYXJ5XCIpXG4gICAgICAgICAgICAgICAgLmh0bWwodGhpcy5fcmVuZGVyU3VtbWFyeSgpKVxuICAgICAgICAgICAgICAgIC5wcmVwZW5kKHRoaXMuX3JlbmRlckRldGFpbE1lc3NhZ2VzKCkpO1xuICAgICAgICAgICAgJGRldGFpbHMuZmluZChcIi5kaXNwbGF5LWFwcGxpY2F0aW9uc1wiKS5odG1sKHRoaXMuX3JlbmRlckRpc3BsYXlBcHBsaWNhdGlvbnMoKSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCRkZXRhaWxzKTtcbiAgICAgICAgICAgIHJldHVybiAkZGV0YWlscztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogRGVmZXIgdG8gdGhlIGFwcHJvcG8gc3VtbWFyeSByZW5kZXJpbmcgZm4gYmFzZWQgb24gc3RhdGUgKi9cbiAgICAgICAgX3JlbmRlclN1bW1hcnk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGpzb24gPSB0aGlzLm1vZGVsLnRvSlNPTigpO1xuICAgICAgICAgICAgdmFyIHN1bW1hcnlSZW5kZXJGbiA9IHRoaXMudGVtcGxhdGVzLnN1bW1hcmllc1tqc29uLnN0YXRlXTtcbiAgICAgICAgICAgIHN1bW1hcnlSZW5kZXJGbiA9IHN1bW1hcnlSZW5kZXJGbiB8fCB0aGlzLnRlbXBsYXRlcy5zdW1tYXJpZXMudW5rbm93bjtcbiAgICAgICAgICAgIHJldHVybiBzdW1tYXJ5UmVuZGVyRm4oanNvbiwgdGhpcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbmRlciBtZXNzYWdlcyB0byBiZSBkaXNwbGF5ZWQgb25seSB3aGVuIHRoZSBkZXRhaWxzIGFyZSBzaG93biAqL1xuICAgICAgICBfcmVuZGVyRGV0YWlsTWVzc2FnZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICAgICAgdmFyICR3YXJuaW5ncyA9ICQoJzxkaXYgY2xhc3M9XCJkZXRhaWwtbWVzc2FnZXNcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgIHZhciBqc29uID0gdmlldy5tb2RlbC50b0pTT04oKTtcbiAgICAgICAgICAgIC8vVE9ETzohIHVub3JkZXJlZCAobWFwKVxuICAgICAgICAgICAgXy5lYWNoKHZpZXcudGVtcGxhdGVzLmRldGFpbE1lc3NhZ2VzLCB0ZW1wbGF0ZUZuID0+IHtcbiAgICAgICAgICAgICAgICAkd2FybmluZ3MuYXBwZW5kKCQodGVtcGxhdGVGbihqc29uLCB2aWV3KSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gJHdhcm5pbmdzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBSZW5kZXIgdGhlIGV4dGVybmFsIGRpc3BsYXkgYXBwbGljYXRpb24gbGlua3MgKi9cbiAgICAgICAgX3JlbmRlckRpc3BsYXlBcHBsaWNhdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuaXNEZWxldGVkT3JQdXJnZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcmVuZGVyIGJvdGggb2xkIGFuZCBuZXcgZGlzcGxheSBhcHBzIHVzaW5nIHRoZSBzYW1lIHRlbXBsYXRlXG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVzLmRpc3BsYXlBcHBsaWNhdGlvbnModGhpcy5tb2RlbC5nZXQoXCJkaXNwbGF5X2FwcHNcIiksIHRoaXMpLFxuICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVzLmRpc3BsYXlBcHBsaWNhdGlvbnModGhpcy5tb2RlbC5nZXQoXCJkaXNwbGF5X3R5cGVzXCIpLCB0aGlzKVxuICAgICAgICAgICAgXS5qb2luKFwiXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gc2Vjb25kYXJ5L2RldGFpbHMgYWN0aW9uc1xuICAgICAgICAvKiogQSBzZXJpZXMgb2YgbGlua3MvYnV0dG9ucyBmb3IgbGVzcyBjb21tb25seSB1c2VkIGFjdGlvbnM6IHJlLXJ1biwgaW5mbywgZXRjLiAqL1xuICAgICAgICBfcmVuZGVyU2Vjb25kYXJ5QWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnKFwiX3JlbmRlclNlY29uZGFyeUFjdGlvbnNcIik7XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIikpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFNUQVRFUy5OT1RfVklFV0FCTEU6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICBjYXNlIFNUQVRFUy5PSzpcbiAgICAgICAgICAgICAgICBjYXNlIFNUQVRFUy5GQUlMRURfTUVUQURBVEE6XG4gICAgICAgICAgICAgICAgY2FzZSBTVEFURVMuRVJST1I6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdGhpcy5fcmVuZGVyRG93bmxvYWRCdXR0b24oKSwgdGhpcy5fcmVuZGVyU2hvd1BhcmFtc0J1dHRvbigpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5fcmVuZGVyU2hvd1BhcmFtc0J1dHRvbigpXTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIGljb24tYnV0dG9uIHRvIHNob3cgdGhlIGlucHV0IGFuZCBvdXRwdXQgKHN0ZG91dC9lcnIpIGZvciB0aGUgam9iIHRoYXQgY3JlYXRlZCB0aGlzLlxuICAgICAgICAgKiAgQHJldHVybnMge2pRdWVyeX0gcmVuZGVyZWQgRE9NXG4gICAgICAgICAqL1xuICAgICAgICBfcmVuZGVyU2hvd1BhcmFtc0J1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBnZW4uIHNhZmUgdG8gc2hvdyBpbiBhbGwgY2FzZXNcbiAgICAgICAgICAgIHJldHVybiBmYUljb25CdXR0b24oe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlZpZXcgZGV0YWlsc1wiKSxcbiAgICAgICAgICAgICAgICBjbGFzc2VzOiBcInBhcmFtcy1idG5cIixcbiAgICAgICAgICAgICAgICBocmVmOiB0aGlzLm1vZGVsLnVybHMuc2hvd19wYXJhbXMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLmxpbmtUYXJnZXQsXG4gICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLWluZm8tY2lyY2xlXCIsXG4gICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEdhbGF4eS5mcmFtZSAmJiBHYWxheHkuZnJhbWUuYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBHYWxheHkuZnJhbWUuYWRkKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJEYXRhc2V0IGRldGFpbHNcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLmhyZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbmRlciBpY29uLWJ1dHRvbi9wb3B1cG1lbnUgdG8gZG93bmxvYWQgdGhlIGRhdGEgKGFuZC9vciB0aGUgYXNzb2NpYXRlZCBtZXRhIGZpbGVzIChiYWksIGV0Yy4pKSBmb3IgdGhpcy5cbiAgICAgICAgICogIEByZXR1cm5zIHtqUXVlcnl9IHJlbmRlcmVkIERPTVxuICAgICAgICAgKi9cbiAgICAgICAgX3JlbmRlckRvd25sb2FkQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIGRvbid0IHNob3cgYW55dGhpbmcgaWYgdGhlIGRhdGEncyBiZWVuIHB1cmdlZFxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwicHVyZ2VkXCIpIHx8ICF0aGlzLm1vZGVsLmhhc0RhdGEoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZXR1cm4gZWl0aGVyOiBhIHBvcHVwbWVudSB3aXRoIGxpbmtzIHRvIGRvd25sb2FkIGFzc29jLiBtZXRhIGZpbGVzIChpZiB0aGVyZSBhcmUgbWV0YSBmaWxlcylcbiAgICAgICAgICAgIC8vICBvciBhIHNpbmdsZSBkb3dubG9hZCBpY29uLWJ1dHRvbiAoaWYgdGhlcmUgYXJlIG5vIG1ldGEgZmlsZXMpXG4gICAgICAgICAgICBpZiAoIV8uaXNFbXB0eSh0aGlzLm1vZGVsLmdldChcIm1ldGFfZmlsZXNcIikpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlck1ldGFGaWxlRG93bmxvYWRCdXR0b24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICQoYFxuICAgICAgICAgICAgICAgIDxhIGNsYXNzPVwiZG93bmxvYWQtYnRuIGljb24tYnRuXCIgaHJlZj1cIiR7dGhpcy5tb2RlbC51cmxzLmRvd25sb2FkfVwiIHRpdGxlPVwiJHtfbChcIkRvd25sb2FkXCIpfVwiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLWZsb3BweS1vXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvYT5gKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIHRoZSBkb3dubG9hZCBidXR0b24gd2hpY2ggb3BlbnMgYSBkcm9wZG93biB3aXRoIGxpbmtzIHRvIGRvd25sb2FkIGFzc29jLiBtZXRhIGZpbGVzIChpbmRpY2VzLCBldGMuKSAqL1xuICAgICAgICBfcmVuZGVyTWV0YUZpbGVEb3dubG9hZEJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdXJscyA9IHRoaXMubW9kZWwudXJscztcbiAgICAgICAgICAgIHJldHVybiAkKGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWV0YWZpbGUtZHJvcGRvd24gZHJvcGRvd25cIj5cbiAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9XCJkb3dubG9hZC1idG4gaWNvbi1idG5cIiBocmVmPVwiJHt1cmxzLmRvd25sb2FkfVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiB0aXRsZT1cIiR7X2woXG4gICAgICAgICAgICAgICAgXCJEb3dubG9hZFwiXG4gICAgICAgICAgICApfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1mbG9wcHktb1wiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICA8dWwgY2xhc3M9XCJkcm9wZG93bi1tZW51XCIgcm9sZT1cIm1lbnVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJHt1cmxzLmRvd25sb2FkfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAke19sKFwiRG93bmxvYWQgZGF0YXNldFwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgJHtfLm1hcChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmdldChcIm1ldGFfZmlsZXNcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YV9maWxlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8bGk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJHt1cmxzLm1ldGFfZG93bmxvYWQgKyBtZXRhX2ZpbGUuZmlsZV90eXBlfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7X2woXCJEb3dubG9hZFwiKX0gJHttZXRhX2ZpbGUuZmlsZV90eXBlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPmBcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgPC9kaXY+YCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX3JlbmRlck5hbWV0YWdzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0cGwgPSBfLnRlbXBsYXRlKFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgXCI8JSBfLmVhY2goXy5zb3J0QnkoXy51bmlxKHRhZ3MpLCBmdW5jdGlvbih4KSB7IHJldHVybiB4IH0pLCBmdW5jdGlvbih0YWcpeyAlPlwiLFxuICAgICAgICAgICAgICAgICAgICAnPCUgaWYgKHRhZy5pbmRleE9mKFwibmFtZTpcIikgPT0gMCl7ICU+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtaW5mb1wiPjwlLSB0YWcuc2xpY2UoNSkgJT48L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPCUgfSk7ICU+XCJcbiAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gdHBsKHsgdGFnczogdGhpcy5tb2RlbC5nZXQoXCJ0YWdzXCIpIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICBldmVudHM6IF8uZXh0ZW5kKF8uY2xvbmUoX3N1cGVyLnByb3RvdHlwZS5ldmVudHMpLCB7XG4gICAgICAgICAgICBcImNsaWNrIC5kaXNwbGF5LWJ0blwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImRpc3BsYXlcIiwgdGhpcywgZXYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLnBhcmFtcy1idG5cIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJwYXJhbXNcIiwgdGhpcywgZXYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLmRvd25sb2FkLWJ0blwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImRvd25sb2FkXCIsIHRoaXMsIGV2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBEYXRhc2V0TGlzdEl0ZW1WaWV3KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFRFTVBMQVRFU1xuLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGVzICovXG5EYXRhc2V0TGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT4ge1xuICAgIC8vVE9ETzogbW92ZSB0byByZXF1aXJlIHRleHQhIHBsdWdpblxuXG4gICAgdmFyIHdhcm5pbmdzID0gXy5leHRlbmQoe30sIF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzLndhcm5pbmdzLCB7XG4gICAgICAgIGZhaWxlZF9tZXRhZGF0YTogQkFTRV9NVkMud3JhcFRlbXBsYXRlKFtcbiAgICAgICAgICAgIC8vIGZhaWxlZCBtZXRhZGF0YSBpcyByZW5kZXJlZCBhcyBhIHdhcm5pbmcgb24gYW4gb3RoZXJ3aXNlIG9rIGRhdGFzZXQgdmlld1xuICAgICAgICAgICAgJzwlIGlmKCBtb2RlbC5zdGF0ZSA9PT0gXCJmYWlsZWRfbWV0YWRhdGFcIiApeyAlPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIndhcm5pbmdtZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgX2woXCJBbiBlcnJvciBvY2N1cnJlZCBzZXR0aW5nIHRoZSBtZXRhZGF0YSBmb3IgdGhpcyBkYXRhc2V0XCIpLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0pLFxuICAgICAgICBlcnJvcjogQkFTRV9NVkMud3JhcFRlbXBsYXRlKFtcbiAgICAgICAgICAgIC8vIGVycm9yIGR1cmluZyBpbmRleCBmZXRjaCAtIHNob3cgZXJyb3Igb24gZGF0YXNldFxuICAgICAgICAgICAgXCI8JSBpZiggbW9kZWwuZXJyb3IgKXsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZXJyb3JtZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgX2woXCJUaGVyZSB3YXMgYW4gZXJyb3IgZ2V0dGluZyB0aGUgZGF0YSBmb3IgdGhpcyBkYXRhc2V0XCIpLFxuICAgICAgICAgICAgXCI6IDwlLSBtb2RlbC5lcnJvciAlPlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0pLFxuICAgICAgICBwdXJnZWQ6IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShbXG4gICAgICAgICAgICBcIjwlIGlmKCBtb2RlbC5wdXJnZWQgKXsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicHVyZ2VkLW1zZyB3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgIF9sKFwiVGhpcyBkYXRhc2V0IGhhcyBiZWVuIGRlbGV0ZWQgYW5kIHJlbW92ZWQgZnJvbSBkaXNrXCIpLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0pLFxuICAgICAgICBkZWxldGVkOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoW1xuICAgICAgICAgICAgLy8gZGVsZXRlZCBub3QgcHVyZ2VkXG4gICAgICAgICAgICBcIjwlIGlmKCBtb2RlbC5kZWxldGVkICYmICFtb2RlbC5wdXJnZWQgKXsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZGVsZXRlZC1tc2cgd2FybmluZ21lc3NhZ2VzbWFsbFwiPicsXG4gICAgICAgICAgICBfbChcIlRoaXMgZGF0YXNldCBoYXMgYmVlbiBkZWxldGVkXCIpLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0pXG5cbiAgICAgICAgLy9OT1RFOiBoaWRkZW4gd2FybmluZyBpcyBvbmx5IG5lZWRlZCBmb3IgSERBc1xuICAgIH0pO1xuXG4gICAgdmFyIGRldGFpbHNUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkZXRhaWxzXCI+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic3VtbWFyeVwiPjwvZGl2PicsXG5cbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWN0aW9ucyBjbGVhclwiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxlZnRcIj48L2Rpdj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJyaWdodFwiPjwvZGl2PicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuXG4gICAgICAgICAgICAvLyBkbyBub3QgZGlzcGxheSB0YWdzLCBhbm5vdGF0aW9uLCBkaXNwbGF5IGFwcHMsIG9yIHBlZWsgd2hlbiBkZWxldGVkXG4gICAgICAgICAgICBcIjwlIGlmKCAhZGF0YXNldC5kZWxldGVkICYmICFkYXRhc2V0LnB1cmdlZCApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0YWdzLWRpc3BsYXlcIj48L2Rpdj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbm5vdGF0aW9uLWRpc3BsYXlcIj48L2Rpdj4nLFxuXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRpc3BsYXktYXBwbGljYXRpb25zXCI+PC9kaXY+JyxcblxuICAgICAgICAgICAgXCI8JSBpZiggZGF0YXNldC5wZWVrICl7ICU+XCIsXG4gICAgICAgICAgICAnPHByZSBjbGFzcz1cImRhdGFzZXQtcGVla1wiPjwlPSBkYXRhc2V0LnBlZWsgJT48L3ByZT4nLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuXG4gICAgdmFyIG5vQWNjZXNzVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZGV0YWlsc1wiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInN1bW1hcnlcIj4nLFxuICAgICAgICAgICAgX2woXCJZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byB2aWV3IHRoaXMgZGF0YXNldFwiKSxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiZGF0YXNldFwiXG4gICAgKTtcblxuICAgIC8vVE9ETzogc3RpbGwgdG9vb29vb29vb29vb29vIGNvbXBsZXggLSByZXdvcmtcbiAgICB2YXIgc3VtbWFyeVRlbXBsYXRlcyA9IHt9O1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLk9LXSA9IHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLkZBSUxFRF9NRVRBREFUQV0gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgIFwiPCUgaWYoIGRhdGFzZXQubWlzY19ibHVyYiApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJibHVyYlwiPicsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ2YWx1ZVwiPjwlLSBkYXRhc2V0Lm1pc2NfYmx1cmIgJT48L3NwYW4+JyxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIixcblxuICAgICAgICAgICAgXCI8JSBpZiggZGF0YXNldC5maWxlX2V4dCApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkYXRhdHlwZVwiPicsXG4gICAgICAgICAgICAnPGxhYmVsIGNsYXNzPVwicHJvbXB0XCI+JyxcbiAgICAgICAgICAgIF9sKFwiZm9ybWF0XCIpLFxuICAgICAgICAgICAgXCI8L2xhYmVsPlwiLFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidmFsdWVcIj48JS0gZGF0YXNldC5maWxlX2V4dCAlPjwvc3Bhbj4nLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuXG4gICAgICAgICAgICBcIjwlIGlmKCBkYXRhc2V0Lm1ldGFkYXRhX2Ria2V5ICl7ICU+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRia2V5XCI+JyxcbiAgICAgICAgICAgICc8bGFiZWwgY2xhc3M9XCJwcm9tcHRcIj4nLFxuICAgICAgICAgICAgX2woXCJkYXRhYmFzZVwiKSxcbiAgICAgICAgICAgIFwiPC9sYWJlbD5cIixcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInZhbHVlXCI+JyxcbiAgICAgICAgICAgIFwiPCUtIGRhdGFzZXQubWV0YWRhdGFfZGJrZXkgJT5cIixcbiAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuXG4gICAgICAgICAgICBcIjwlIGlmKCBkYXRhc2V0Lm1pc2NfaW5mbyApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJpbmZvXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInZhbHVlXCI+PCUtIGRhdGFzZXQubWlzY19pbmZvICU+PC9zcGFuPicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCJcbiAgICAgICAgXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLk5FV10gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKFwiVGhpcyBpcyBhIG5ldyBkYXRhc2V0IGFuZCBub3QgYWxsIG9mIGl0cyBkYXRhIGFyZSBhdmFpbGFibGUgeWV0XCIpLCBcIjwvZGl2PlwiXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLk5PVF9WSUVXQUJMRV0gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKFwiWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gdmlldyB0aGlzIGRhdGFzZXRcIiksIFwiPC9kaXY+XCJdLFxuICAgICAgICBcImRhdGFzZXRcIlxuICAgICk7XG4gICAgc3VtbWFyeVRlbXBsYXRlc1tTVEFURVMuRElTQ0FSREVEXSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1wiPGRpdj5cIiwgX2woXCJUaGUgam9iIGNyZWF0aW5nIHRoaXMgZGF0YXNldCB3YXMgY2FuY2VsbGVkIGJlZm9yZSBjb21wbGV0aW9uXCIpLCBcIjwvZGl2PlwiXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLlFVRVVFRF0gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKFwiVGhpcyBqb2IgaXMgd2FpdGluZyB0byBydW5cIiksIFwiPC9kaXY+XCJdLFxuICAgICAgICBcImRhdGFzZXRcIlxuICAgICk7XG4gICAgc3VtbWFyeVRlbXBsYXRlc1tTVEFURVMuUlVOTklOR10gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKFwiVGhpcyBqb2IgaXMgY3VycmVudGx5IHJ1bm5pbmdcIiksIFwiPC9kaXY+XCJdLFxuICAgICAgICBcImRhdGFzZXRcIlxuICAgICk7XG4gICAgc3VtbWFyeVRlbXBsYXRlc1tTVEFURVMuVVBMT0FEXSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1wiPGRpdj5cIiwgX2woXCJUaGlzIGRhdGFzZXQgaXMgY3VycmVudGx5IHVwbG9hZGluZ1wiKSwgXCI8L2Rpdj5cIl0sXG4gICAgICAgIFwiZGF0YXNldFwiXG4gICAgKTtcbiAgICBzdW1tYXJ5VGVtcGxhdGVzW1NUQVRFUy5TRVRUSU5HX01FVEFEQVRBXSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1wiPGRpdj5cIiwgX2woXCJNZXRhZGF0YSBpcyBiZWluZyBhdXRvLWRldGVjdGVkXCIpLCBcIjwvZGl2PlwiXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLlBBVVNFRF0gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKCdUaGlzIGpvYiBpcyBwYXVzZWQuIFVzZSB0aGUgXCJSZXN1bWUgUGF1c2VkIEpvYnNcIiBpbiB0aGUgaGlzdG9yeSBtZW51IHRvIHJlc3VtZScpLCBcIjwvZGl2PlwiXSxcbiAgICAgICAgXCJkYXRhc2V0XCJcbiAgICApO1xuICAgIHN1bW1hcnlUZW1wbGF0ZXNbU1RBVEVTLkVSUk9SXSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1xuICAgICAgICAgICAgXCI8JSBpZiggIWRhdGFzZXQucHVyZ2VkICl7ICU+XCIsXG4gICAgICAgICAgICBcIjxkaXY+PCUtIGRhdGFzZXQubWlzY19ibHVyYiAlPjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJoZWxwLXRleHRcIj4nLFxuICAgICAgICAgICAgX2woXCJBbiBlcnJvciBvY2N1cnJlZCB3aXRoIHRoaXMgZGF0YXNldFwiKSxcbiAgICAgICAgICAgIFwiOjwvc3Bhbj5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiam9iLWVycm9yLXRleHRcIj48JS0gZGF0YXNldC5taXNjX2luZm8gJT48L2Rpdj4nXG4gICAgICAgIF0sXG4gICAgICAgIFwiZGF0YXNldFwiXG4gICAgKTtcbiAgICBzdW1tYXJ5VGVtcGxhdGVzW1NUQVRFUy5FTVBUWV0gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcIjxkaXY+XCIsIF9sKFwiTm8gZGF0YVwiKSwgXCI6IDxpPjwlLSBkYXRhc2V0Lm1pc2NfYmx1cmIgJT48L2k+PC9kaXY+XCJdLFxuICAgICAgICBcImRhdGFzZXRcIlxuICAgICk7XG4gICAgc3VtbWFyeVRlbXBsYXRlcy51bmtub3duID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbJzxkaXY+RXJyb3I6IHVua25vd24gZGF0YXNldCBzdGF0ZTogXCI8JS0gZGF0YXNldC5zdGF0ZSAlPlwiPC9kaXY+J10sXG4gICAgICAgIFwiZGF0YXNldFwiXG4gICAgKTtcblxuICAgIC8vIG1lc3NhZ2VzIHRvIGJlIGRpc3BsYXllZCBvbmx5IHdpdGhpbiB0aGUgZGV0YWlscyBzZWN0aW9uICgnYmVsb3cgdGhlIGZvbGQnKVxuICAgIHZhciBkZXRhaWxNZXNzYWdlVGVtcGxhdGVzID0ge1xuICAgICAgICByZXN1Ym1pdHRlZDogQkFTRV9NVkMud3JhcFRlbXBsYXRlKFtcbiAgICAgICAgICAgIC8vIGRlbGV0ZWQgbm90IHB1cmdlZFxuICAgICAgICAgICAgXCI8JSBpZiggbW9kZWwucmVzdWJtaXR0ZWQgKXsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicmVzdWJtaXR0ZWQtbXNnIGluZm9tZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgX2woXCJUaGUgam9iIGNyZWF0aW5nIHRoaXMgZGF0YXNldCBoYXMgYmVlbiByZXN1Ym1pdHRlZFwiKSxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICBdKVxuICAgIH07XG5cbiAgICAvLyB0aGlzIGlzIGFwcGxpZWQgdG8gYm90aCBvbGQgYW5kIG5ldyBzdHlsZSBkaXNwbGF5IGFwcHNcbiAgICB2YXIgZGlzcGxheUFwcGxpY2F0aW9uc1RlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICBcIjwlIF8uZWFjaCggYXBwcywgZnVuY3Rpb24oIGFwcCApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkaXNwbGF5LWFwcGxpY2F0aW9uXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImRpc3BsYXktYXBwbGljYXRpb24tbG9jYXRpb25cIj48JS0gYXBwLmxhYmVsICU+PC9zcGFuPiAnLFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiZGlzcGxheS1hcHBsaWNhdGlvbi1saW5rc1wiPicsXG4gICAgICAgICAgICBcIjwlIF8uZWFjaCggYXBwLmxpbmtzLCBmdW5jdGlvbiggbGluayApeyAlPlwiLFxuICAgICAgICAgICAgJzxhIHRhcmdldD1cIjwlLSBsaW5rLnRhcmdldCAlPlwiIGhyZWY9XCI8JS0gbGluay5ocmVmICU+XCI+JyxcbiAgICAgICAgICAgIFwiPCUgcHJpbnQoIF9sKCBsaW5rLnRleHQgKSApOyAlPlwiLFxuICAgICAgICAgICAgXCI8L2E+IFwiLFxuICAgICAgICAgICAgXCI8JSB9KTsgJT5cIixcbiAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSk7ICU+XCJcbiAgICAgICAgXSxcbiAgICAgICAgXCJhcHBzXCJcbiAgICApO1xuXG4gICAgcmV0dXJuIF8uZXh0ZW5kKHt9LCBfc3VwZXIucHJvdG90eXBlLnRlbXBsYXRlcywge1xuICAgICAgICB3YXJuaW5nczogd2FybmluZ3MsXG4gICAgICAgIGRldGFpbHM6IGRldGFpbHNUZW1wbGF0ZSxcbiAgICAgICAgbm9BY2Nlc3M6IG5vQWNjZXNzVGVtcGxhdGUsXG4gICAgICAgIHN1bW1hcmllczogc3VtbWFyeVRlbXBsYXRlcyxcbiAgICAgICAgZGV0YWlsTWVzc2FnZXM6IGRldGFpbE1lc3NhZ2VUZW1wbGF0ZXMsXG4gICAgICAgIGRpc3BsYXlBcHBsaWNhdGlvbnM6IGRpc3BsYXlBcHBsaWNhdGlvbnNUZW1wbGF0ZVxuICAgIH0pO1xufSkoKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIERhdGFzZXRMaXN0SXRlbVZpZXc6IERhdGFzZXRMaXN0SXRlbVZpZXdcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1saS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6QkE7QUEyQkE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUFpQkE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWVBO0FBQUE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQUNBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBL1VBO0FBQ0E7QUFrVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBT0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBbENBO0FBQ0E7QUFvQ0E7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFvQ0E7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUlBO0FBWUE7QUFJQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///17\n");

/***/ }),
/* 18 */,
/* 19 */,
/* 20 */
/*!**************************************************!*\
  !*** ./galaxy/scripts/mvc/history/hdca-model.js ***!
  \**************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _collectionModel = __webpack_require__(/*! mvc/collection/collection-model */ 30);\n\nvar _collectionModel2 = _interopRequireDefault(_collectionModel);\n\nvar _historyContentModel = __webpack_require__(/*! mvc/history/history-content-model */ 51);\n\nvar _historyContentModel2 = _interopRequireDefault(_historyContentModel);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*==============================================================================\n\nModels for DatasetCollections contained within a history.\n\n==============================================================================*/\nvar hcontentMixin = _historyContentModel2.default.HistoryContentMixin;\n\nvar DC = _collectionModel2.default.DatasetCollection;\n\n//==============================================================================\n/** @class Backbone model for List Dataset Collection within a History.\n */\nvar HistoryDatasetCollection = DC.extend(hcontentMixin).extend(\n/** @lends HistoryDatasetCollection.prototype */{\n    defaults: _.extend(_.clone(DC.prototype.defaults), {\n        history_content_type: \"dataset_collection\",\n        model_class: \"HistoryDatasetCollectionAssociation\"\n    }),\n\n    //==============================================================================\n    /** Override to post to contents route w/o id. */\n    save: function save(attributes, options) {\n        if (this.isNew()) {\n            options = options || {};\n            options.url = this.urlRoot + this.get(\"history_id\") + \"/contents\";\n            attributes = attributes || {};\n            attributes.type = \"dataset_collection\";\n        }\n        return DC.prototype.save.call(this, attributes, options);\n    },\n\n    /** String representation. */\n    toString: function toString() {\n        return \"History\" + DC.prototype.toString.call(this);\n    }\n});\n\n//==============================================================================\nexports.default = {\n    HistoryDatasetCollection: HistoryDatasetCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRjYS1tb2RlbC5qcz8zM2UyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEQ19NT0RFTCBmcm9tIFwibXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1tb2RlbFwiO1xuaW1wb3J0IEhJU1RPUllfQ09OVEVOVCBmcm9tIFwibXZjL2hpc3RvcnkvaGlzdG9yeS1jb250ZW50LW1vZGVsXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuXG4vKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5Nb2RlbHMgZm9yIERhdGFzZXRDb2xsZWN0aW9ucyBjb250YWluZWQgd2l0aGluIGEgaGlzdG9yeS5cblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cbnZhciBoY29udGVudE1peGluID0gSElTVE9SWV9DT05URU5ULkhpc3RvcnlDb250ZW50TWl4aW47XG5cbnZhciBEQyA9IERDX01PREVMLkRhdGFzZXRDb2xsZWN0aW9uO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEBjbGFzcyBCYWNrYm9uZSBtb2RlbCBmb3IgTGlzdCBEYXRhc2V0IENvbGxlY3Rpb24gd2l0aGluIGEgSGlzdG9yeS5cbiAqL1xudmFyIEhpc3RvcnlEYXRhc2V0Q29sbGVjdGlvbiA9IERDLmV4dGVuZChoY29udGVudE1peGluKS5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBIaXN0b3J5RGF0YXNldENvbGxlY3Rpb24ucHJvdG90eXBlICovIHtcbiAgICAgICAgZGVmYXVsdHM6IF8uZXh0ZW5kKF8uY2xvbmUoREMucHJvdG90eXBlLmRlZmF1bHRzKSwge1xuICAgICAgICAgICAgaGlzdG9yeV9jb250ZW50X3R5cGU6IFwiZGF0YXNldF9jb2xsZWN0aW9uXCIsXG4gICAgICAgICAgICBtb2RlbF9jbGFzczogXCJIaXN0b3J5RGF0YXNldENvbGxlY3Rpb25Bc3NvY2lhdGlvblwiXG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8qKiBPdmVycmlkZSB0byBwb3N0IHRvIGNvbnRlbnRzIHJvdXRlIHcvbyBpZC4gKi9cbiAgICAgICAgc2F2ZTogZnVuY3Rpb24oYXR0cmlidXRlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNOZXcoKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgICAgIG9wdGlvbnMudXJsID0gYCR7dGhpcy51cmxSb290ICsgdGhpcy5nZXQoXCJoaXN0b3J5X2lkXCIpfS9jb250ZW50c2A7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IGF0dHJpYnV0ZXMgfHwge307XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy50eXBlID0gXCJkYXRhc2V0X2NvbGxlY3Rpb25cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBEQy5wcm90b3R5cGUuc2F2ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBgSGlzdG9yeSR7REMucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcyl9YDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSGlzdG9yeURhdGFzZXRDb2xsZWN0aW9uOiBIaXN0b3J5RGF0YXNldENvbGxlY3Rpb25cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRjYS1tb2RlbC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUFDQTtBQXdCQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///20\n");

/***/ }),
/* 21 */
/*!********************************************!*\
  !*** ./galaxy/scripts/utils/ajax-queue.js ***!
  \********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n//ASSUMES: jquery\n//=============================================================================\n/** @class AjaxQueue\n *  Class that allows queueing functions that return jQuery promises (such\n *  as ajax calls). Each function waits for the previous to complete before\n *  being called\n *\n *  @constructor accepts a list of functions and automatically begins\n *      processing them\n */\nvar AjaxQueue = function () {\n    function AjaxQueue(initialFunctions) {\n        _classCallCheck(this, AjaxQueue);\n\n        /** the main deferred for the entire queue - note: also sends notifications of progress */\n        this.deferred = jQuery.Deferred();\n        /** the queue array of functions */\n        this.queue = [];\n        /** cache the response from each deferred call - error or success */\n        this.responses = [];\n        /** total number of fn's to process */\n        this.numToProcess = 0;\n        /** is the queue processing/waiting for any calls to return? */\n        this.running = false;\n\n        this.init(initialFunctions || []);\n        this.start();\n    }\n\n    /** add all fns in initialFunctions (if any) to the queue */\n\n\n    _createClass(AjaxQueue, [{\n        key: \"init\",\n        value: function init(initialFunctions) {\n            var _this = this;\n\n            initialFunctions.forEach(function (fn) {\n                _this.add(fn);\n            });\n        }\n    }, {\n        key: \"add\",\n        value: function add(fn) {\n            var _this2 = this;\n\n            var index = this.queue.length;\n            this.numToProcess += 1;\n\n            this.queue.push(function () {\n                var fnIndex = index;\n                var xhr = fn();\n                // if successful, notify using the deferred to allow tracking progress\n                xhr.done(function (response) {\n                    _this2.deferred.notify({\n                        curr: fnIndex,\n                        total: _this2.numToProcess,\n                        response: response\n                    });\n                });\n                // (regardless of previous error or success) if not last ajax call, shift and call the next\n                //  if last fn, resolve deferred\n                xhr.always(function (response) {\n                    _this2.responses.push(response);\n                    if (_this2.queue.length) {\n                        _this2.queue.shift()();\n                    } else {\n                        _this2.stop();\n                    }\n                });\n            });\n            return this;\n        }\n    }, {\n        key: \"start\",\n        value: function start() {\n            if (this.queue.length) {\n                this.running = true;\n                this.queue.shift()();\n            }\n            return this;\n        }\n\n        /** stop the queue\n         *  @param {boolean} causeFail  cause an error/fail on the main deferred\n         *  @param {String} msg         message to send when rejecting the main deferred\n         */\n\n    }, {\n        key: \"stop\",\n        value: function stop(causeFail, msg) {\n            //TODO: doesn't abort current call\n            this.running = false;\n            this.queue = [];\n            if (causeFail) {\n                //TODO: spliced args instead\n                this.deferred.reject(msg);\n            } else {\n                this.deferred.resolve(this.responses);\n            }\n            this.numToProcess = 0;\n            this.deferred = jQuery.Deferred();\n            return this;\n        }\n\n        // only a handful of the deferred interface for now - possible YAGNI\n        /** implement done from the jq deferred interface */\n\n    }, {\n        key: \"done\",\n        value: function done(fn) {\n            return this.deferred.done(fn);\n        }\n\n        /** implement fail from the jq deferred interface */\n\n    }, {\n        key: \"fail\",\n        value: function fail(fn) {\n            return this.deferred.fail(fn);\n        }\n\n        /** implement always from the jq deferred interface */\n\n    }, {\n        key: \"always\",\n        value: function always(fn) {\n            return this.deferred.always(fn);\n        }\n\n        /** implement progress from the jq deferred interface */\n\n    }, {\n        key: \"progress\",\n        value: function progress(fn) {\n            return this.deferred.progress(fn);\n        }\n\n        /** shortcut constructor / fire and forget\n         *  @returns {Deferred} the queue's main deferred\n         */\n\n    }], [{\n        key: \"create\",\n        value: function create(initialFunctions) {\n            return new AjaxQueue(initialFunctions).deferred;\n        }\n    }]);\n\n    return AjaxQueue;\n}();\n\n//=============================================================================\n/** @class NamedAjaxQueue\n *  @augments AjaxQueue\n *  Allows associating a name with a deferring fn and prevents adding deferring\n *  fns if the name has already been used. Useful to prevent build up of duplicate\n *  async calls.\n *  Both the array initialFunctions sent to constructor and any added later with\n *  add() should be objects (NOT functions) of the form:\n *  { name: some unique id,\n *    fn:   the deferring fn or ajax call }\n */\n\n\nvar NamedAjaxQueue = function (_AjaxQueue) {\n    _inherits(NamedAjaxQueue, _AjaxQueue);\n\n    function NamedAjaxQueue(initialFunctions) {\n        _classCallCheck(this, NamedAjaxQueue);\n\n        var _this3 = _possibleConstructorReturn(this, (NamedAjaxQueue.__proto__ || Object.getPrototypeOf(NamedAjaxQueue)).call(this, initialFunctions));\n\n        _this3.names = {};\n        return _this3;\n    }\n\n    /** add the obj.fn to the queue if obj.name hasn't been used before */\n\n\n    _createClass(NamedAjaxQueue, [{\n        key: \"add\",\n        value: function add(obj) {\n            if (!(obj.hasOwnProperty(\"name\") && obj.hasOwnProperty(\"fn\"))) {\n                throw new Error(\"NamedAjaxQueue.add requires an object with both \\\"name\\\" and \\\"fn\\\": \" + JSON.stringify(obj));\n            }\n            if (this.names.hasOwnProperty(obj.name)) {\n                //console.warn( 'name has been used:', obj.name );\n                return;\n            }\n            this.names[obj.name] = true;\n            return _get(NamedAjaxQueue.prototype.__proto__ || Object.getPrototypeOf(NamedAjaxQueue.prototype), \"add\", this).call(this, obj.fn);\n        }\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this.names = {};\n            return this;\n        }\n\n        /** shortcut constructor / fire and forget\n         *  @returns {Deferred} the queue's main deferred\n         */\n\n    }], [{\n        key: \"create\",\n        value: function create(initialFunctions) {\n            return new NamedAjaxQueue(initialFunctions).deferred;\n        }\n    }]);\n\n    return NamedAjaxQueue;\n}(AjaxQueue);\n\n//=============================================================================\n\n\nexports.default = {\n    AjaxQueue: AjaxQueue,\n    NamedAjaxQueue: NamedAjaxQueue\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdXRpbHMvYWpheC1xdWV1ZS5qcz81ZWUzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vQVNTVU1FUzoganF1ZXJ5XG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIEFqYXhRdWV1ZVxuICogIENsYXNzIHRoYXQgYWxsb3dzIHF1ZXVlaW5nIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBqUXVlcnkgcHJvbWlzZXMgKHN1Y2hcbiAqICBhcyBhamF4IGNhbGxzKS4gRWFjaCBmdW5jdGlvbiB3YWl0cyBmb3IgdGhlIHByZXZpb3VzIHRvIGNvbXBsZXRlIGJlZm9yZVxuICogIGJlaW5nIGNhbGxlZFxuICpcbiAqICBAY29uc3RydWN0b3IgYWNjZXB0cyBhIGxpc3Qgb2YgZnVuY3Rpb25zIGFuZCBhdXRvbWF0aWNhbGx5IGJlZ2luc1xuICogICAgICBwcm9jZXNzaW5nIHRoZW1cbiAqL1xuY2xhc3MgQWpheFF1ZXVlIHtcbiAgICBjb25zdHJ1Y3Rvcihpbml0aWFsRnVuY3Rpb25zKSB7XG4gICAgICAgIC8qKiB0aGUgbWFpbiBkZWZlcnJlZCBmb3IgdGhlIGVudGlyZSBxdWV1ZSAtIG5vdGU6IGFsc28gc2VuZHMgbm90aWZpY2F0aW9ucyBvZiBwcm9ncmVzcyAqL1xuICAgICAgICB0aGlzLmRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCk7XG4gICAgICAgIC8qKiB0aGUgcXVldWUgYXJyYXkgb2YgZnVuY3Rpb25zICovXG4gICAgICAgIHRoaXMucXVldWUgPSBbXTtcbiAgICAgICAgLyoqIGNhY2hlIHRoZSByZXNwb25zZSBmcm9tIGVhY2ggZGVmZXJyZWQgY2FsbCAtIGVycm9yIG9yIHN1Y2Nlc3MgKi9cbiAgICAgICAgdGhpcy5yZXNwb25zZXMgPSBbXTtcbiAgICAgICAgLyoqIHRvdGFsIG51bWJlciBvZiBmbidzIHRvIHByb2Nlc3MgKi9cbiAgICAgICAgdGhpcy5udW1Ub1Byb2Nlc3MgPSAwO1xuICAgICAgICAvKiogaXMgdGhlIHF1ZXVlIHByb2Nlc3Npbmcvd2FpdGluZyBmb3IgYW55IGNhbGxzIHRvIHJldHVybj8gKi9cbiAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5pbml0KGluaXRpYWxGdW5jdGlvbnMgfHwgW10pO1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLyoqIGFkZCBhbGwgZm5zIGluIGluaXRpYWxGdW5jdGlvbnMgKGlmIGFueSkgdG8gdGhlIHF1ZXVlICovXG4gICAgaW5pdChpbml0aWFsRnVuY3Rpb25zKSB7XG4gICAgICAgIGluaXRpYWxGdW5jdGlvbnMuZm9yRWFjaChmbiA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZChmbik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFkZChmbikge1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnF1ZXVlLmxlbmd0aDtcbiAgICAgICAgdGhpcy5udW1Ub1Byb2Nlc3MgKz0gMTtcblxuICAgICAgICB0aGlzLnF1ZXVlLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgdmFyIGZuSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgIHZhciB4aHIgPSBmbigpO1xuICAgICAgICAgICAgLy8gaWYgc3VjY2Vzc2Z1bCwgbm90aWZ5IHVzaW5nIHRoZSBkZWZlcnJlZCB0byBhbGxvdyB0cmFja2luZyBwcm9ncmVzc1xuICAgICAgICAgICAgeGhyLmRvbmUocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVmZXJyZWQubm90aWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgY3VycjogZm5JbmRleCxcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IHRoaXMubnVtVG9Qcm9jZXNzLFxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZTogcmVzcG9uc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gKHJlZ2FyZGxlc3Mgb2YgcHJldmlvdXMgZXJyb3Igb3Igc3VjY2VzcykgaWYgbm90IGxhc3QgYWpheCBjYWxsLCBzaGlmdCBhbmQgY2FsbCB0aGUgbmV4dFxuICAgICAgICAgICAgLy8gIGlmIGxhc3QgZm4sIHJlc29sdmUgZGVmZXJyZWRcbiAgICAgICAgICAgIHhoci5hbHdheXMocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VzLnB1c2gocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXVlLnNoaWZ0KCkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHN0YXJ0KCkge1xuICAgICAgICBpZiAodGhpcy5xdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMucnVubmluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnF1ZXVlLnNoaWZ0KCkoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKiogc3RvcCB0aGUgcXVldWVcbiAgICAgKiAgQHBhcmFtIHtib29sZWFufSBjYXVzZUZhaWwgIGNhdXNlIGFuIGVycm9yL2ZhaWwgb24gdGhlIG1haW4gZGVmZXJyZWRcbiAgICAgKiAgQHBhcmFtIHtTdHJpbmd9IG1zZyAgICAgICAgIG1lc3NhZ2UgdG8gc2VuZCB3aGVuIHJlamVjdGluZyB0aGUgbWFpbiBkZWZlcnJlZFxuICAgICAqL1xuICAgIHN0b3AoY2F1c2VGYWlsLCBtc2cpIHtcbiAgICAgICAgLy9UT0RPOiBkb2Vzbid0IGFib3J0IGN1cnJlbnQgY2FsbFxuICAgICAgICB0aGlzLnJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICBpZiAoY2F1c2VGYWlsKSB7XG4gICAgICAgICAgICAvL1RPRE86IHNwbGljZWQgYXJncyBpbnN0ZWFkXG4gICAgICAgICAgICB0aGlzLmRlZmVycmVkLnJlamVjdChtc2cpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kZWZlcnJlZC5yZXNvbHZlKHRoaXMucmVzcG9uc2VzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm51bVRvUHJvY2VzcyA9IDA7XG4gICAgICAgIHRoaXMuZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLy8gb25seSBhIGhhbmRmdWwgb2YgdGhlIGRlZmVycmVkIGludGVyZmFjZSBmb3Igbm93IC0gcG9zc2libGUgWUFHTklcbiAgICAvKiogaW1wbGVtZW50IGRvbmUgZnJvbSB0aGUganEgZGVmZXJyZWQgaW50ZXJmYWNlICovXG4gICAgZG9uZShmbikge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZlcnJlZC5kb25lKGZuKTtcbiAgICB9XG5cbiAgICAvKiogaW1wbGVtZW50IGZhaWwgZnJvbSB0aGUganEgZGVmZXJyZWQgaW50ZXJmYWNlICovXG4gICAgZmFpbChmbikge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZlcnJlZC5mYWlsKGZuKTtcbiAgICB9XG5cbiAgICAvKiogaW1wbGVtZW50IGFsd2F5cyBmcm9tIHRoZSBqcSBkZWZlcnJlZCBpbnRlcmZhY2UgKi9cbiAgICBhbHdheXMoZm4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmZXJyZWQuYWx3YXlzKGZuKTtcbiAgICB9XG5cbiAgICAvKiogaW1wbGVtZW50IHByb2dyZXNzIGZyb20gdGhlIGpxIGRlZmVycmVkIGludGVyZmFjZSAqL1xuICAgIHByb2dyZXNzKGZuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnByb2dyZXNzKGZuKTtcbiAgICB9XG5cbiAgICAvKiogc2hvcnRjdXQgY29uc3RydWN0b3IgLyBmaXJlIGFuZCBmb3JnZXRcbiAgICAgKiAgQHJldHVybnMge0RlZmVycmVkfSB0aGUgcXVldWUncyBtYWluIGRlZmVycmVkXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShpbml0aWFsRnVuY3Rpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgQWpheFF1ZXVlKGluaXRpYWxGdW5jdGlvbnMpLmRlZmVycmVkO1xuICAgIH1cbn1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEBjbGFzcyBOYW1lZEFqYXhRdWV1ZVxuICogIEBhdWdtZW50cyBBamF4UXVldWVcbiAqICBBbGxvd3MgYXNzb2NpYXRpbmcgYSBuYW1lIHdpdGggYSBkZWZlcnJpbmcgZm4gYW5kIHByZXZlbnRzIGFkZGluZyBkZWZlcnJpbmdcbiAqICBmbnMgaWYgdGhlIG5hbWUgaGFzIGFscmVhZHkgYmVlbiB1c2VkLiBVc2VmdWwgdG8gcHJldmVudCBidWlsZCB1cCBvZiBkdXBsaWNhdGVcbiAqICBhc3luYyBjYWxscy5cbiAqICBCb3RoIHRoZSBhcnJheSBpbml0aWFsRnVuY3Rpb25zIHNlbnQgdG8gY29uc3RydWN0b3IgYW5kIGFueSBhZGRlZCBsYXRlciB3aXRoXG4gKiAgYWRkKCkgc2hvdWxkIGJlIG9iamVjdHMgKE5PVCBmdW5jdGlvbnMpIG9mIHRoZSBmb3JtOlxuICogIHsgbmFtZTogc29tZSB1bmlxdWUgaWQsXG4gKiAgICBmbjogICB0aGUgZGVmZXJyaW5nIGZuIG9yIGFqYXggY2FsbCB9XG4gKi9cbmNsYXNzIE5hbWVkQWpheFF1ZXVlIGV4dGVuZHMgQWpheFF1ZXVlIHtcbiAgICBjb25zdHJ1Y3Rvcihpbml0aWFsRnVuY3Rpb25zKSB7XG4gICAgICAgIHN1cGVyKGluaXRpYWxGdW5jdGlvbnMpO1xuICAgICAgICB0aGlzLm5hbWVzID0ge307XG4gICAgfVxuXG4gICAgLyoqIGFkZCB0aGUgb2JqLmZuIHRvIHRoZSBxdWV1ZSBpZiBvYmoubmFtZSBoYXNuJ3QgYmVlbiB1c2VkIGJlZm9yZSAqL1xuICAgIGFkZChvYmopIHtcbiAgICAgICAgaWYgKCEob2JqLmhhc093blByb3BlcnR5KFwibmFtZVwiKSAmJiBvYmouaGFzT3duUHJvcGVydHkoXCJmblwiKSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTmFtZWRBamF4UXVldWUuYWRkIHJlcXVpcmVzIGFuIG9iamVjdCB3aXRoIGJvdGggXCJuYW1lXCIgYW5kIFwiZm5cIjogJHtKU09OLnN0cmluZ2lmeShvYmopfWApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5hbWVzLmhhc093blByb3BlcnR5KG9iai5uYW1lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oICduYW1lIGhhcyBiZWVuIHVzZWQ6Jywgb2JqLm5hbWUgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hbWVzW29iai5uYW1lXSA9IHRydWU7XG4gICAgICAgIHJldHVybiBzdXBlci5hZGQob2JqLmZuKTtcbiAgICB9XG5cbiAgICBjbGVhcigpIHtcbiAgICAgICAgdGhpcy5uYW1lcyA9IHt9O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKiogc2hvcnRjdXQgY29uc3RydWN0b3IgLyBmaXJlIGFuZCBmb3JnZXRcbiAgICAgKiAgQHJldHVybnMge0RlZmVycmVkfSB0aGUgcXVldWUncyBtYWluIGRlZmVycmVkXG4gICAgICovXG4gICAgc3RhdGljIGNyZWF0ZShpbml0aWFsRnVuY3Rpb25zKSB7XG4gICAgICAgIHJldHVybiBuZXcgTmFtZWRBamF4UXVldWUoaW5pdGlhbEZ1bmN0aW9ucykuZGVmZXJyZWQ7XG4gICAgfVxufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgQWpheFF1ZXVlOiBBamF4UXVldWUsXG4gICAgTmFtZWRBamF4UXVldWU6IE5hbWVkQWpheFF1ZXVlXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL3V0aWxzL2FqYXgtcXVldWUuanMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQURBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7QUFDQTtBQUNBOzs7Ozs7QUFHQTtBQUNBOzs7Ozs7Ozs7Ozs7QUFVQTs7O0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBRkE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBQ0E7QUFDQTs7OztBQTdCQTtBQUNBO0FBK0JBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUZBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///21\n");

/***/ }),
/* 22 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/mvc/list/list-item.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"list\";\n//==============================================================================\n/** A view which, when first rendered, shows only summary data/attributes, but\n *      can be expanded to show further details (and optionally fetch those\n *      details from the server).\n */\nvar ExpandableView = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: logNamespace,\n\n    //TODO: Although the reasoning behind them is different, this shares a lot with HiddenUntilActivated above: combine them\n    //PRECONDITION: model must have method hasDetails\n    //PRECONDITION: subclasses must have templates.el and templates.details\n\n    initialize: function initialize(attributes) {\n        /** are the details of this view expanded/shown or not? */\n        this.expanded = attributes.expanded || false;\n        this.log(\"\\t expanded:\", this.expanded);\n        this.fxSpeed = attributes.fxSpeed !== undefined ? attributes.fxSpeed : this.fxSpeed;\n    },\n\n    // ........................................................................ render main\n    /** jq fx speed */\n    fxSpeed: \"fast\",\n\n    /** Render this content, set up ui.\n     *  @param {Number or String} speed   the speed of the render\n     */\n    render: function render(speed) {\n        var $newRender = this._buildNewRender();\n        this._setUpBehaviors($newRender);\n        this._queueNewRender($newRender, speed);\n        return this;\n    },\n\n    /** Build a temp div containing the new children for the view's $el.\n     *      If the view is already expanded, build the details as well.\n     */\n    _buildNewRender: function _buildNewRender() {\n        // create a new render using a skeleton template, render title buttons, render body, and set up events, etc.\n        var $newRender = $(this.templates.el(this.model.toJSON(), this));\n        if (this.expanded) {\n            this.$details($newRender).replaceWith(this._renderDetails().show());\n        }\n        return $newRender;\n    },\n\n    /** Fade out the old el, swap in the new contents, then fade in.\n     *  @param {Number or String} speed   jq speed to use for rendering effects\n     *  @fires rendered when rendered\n     */\n    _queueNewRender: function _queueNewRender($newRender, speed) {\n        speed = speed === undefined ? this.fxSpeed : speed;\n        var view = this;\n\n        if (speed === 0) {\n            view._swapNewRender($newRender);\n            view.trigger(\"rendered\", view);\n        } else {\n            $(view).queue(\"fx\", [function (next) {\n                view.$el.fadeOut(speed, next);\n            }, function (next) {\n                view._swapNewRender($newRender);\n                next();\n            }, function (next) {\n                view.$el.fadeIn(speed, next);\n            }, function (next) {\n                view.trigger(\"rendered\", view);\n                next();\n            }]);\n        }\n    },\n\n    /** empty out the current el, move the $newRender's children in */\n    _swapNewRender: function _swapNewRender($newRender) {\n        return this.$el.empty().attr(\"class\", _.isFunction(this.className) ? this.className() : this.className).append($newRender.children());\n    },\n\n    /** set up js behaviors, event handlers for elements within the given container\n     *  @param {jQuery} $container jq object that contains the elements to process (defaults to this.$el)\n     */\n    _setUpBehaviors: function _setUpBehaviors($where) {\n        $where = $where || this.$el;\n        // set up canned behavior on children (bootstrap, popupmenus, editable_text, etc.)\n        //make_popup_menus( $where );\n        $where.find(\"[title]\").tooltip({ placement: \"bottom\" });\n    },\n\n    // ......................................................................... details\n    /** shortcut to details DOM (as jQ) */\n    $details: function $details($where) {\n        $where = $where || this.$el;\n        return $where.find(\"> .details\");\n    },\n\n    /** build the DOM for the details and set up behaviors on it */\n    _renderDetails: function _renderDetails() {\n        var $newDetails = $(this.templates.details(this.model.toJSON(), this));\n        this._setUpBehaviors($newDetails);\n        return $newDetails;\n    },\n\n    // ......................................................................... expansion/details\n    /** Show or hide the details\n     *  @param {Boolean} expand if true, expand; if false, collapse\n     */\n    toggleExpanded: function toggleExpanded(expand) {\n        expand = expand === undefined ? !this.expanded : expand;\n        if (expand) {\n            this.expand();\n        } else {\n            this.collapse();\n        }\n        return this;\n    },\n\n    /** Render and show the full, detailed body of this view including extra data and controls.\n     *      note: if the model does not have detailed data, fetch that data before showing the body\n     *  @fires expanded when a body has been expanded\n     */\n    expand: function expand() {\n        var view = this;\n        return view._fetchModelDetails().always(function () {\n            view._expand();\n        });\n    },\n\n    /** Check for model details and, if none, fetch them.\n     *  @returns {jQuery.promise} the model.fetch.xhr if details are being fetched, an empty promise if not\n     */\n    _fetchModelDetails: function _fetchModelDetails() {\n        if (!this.model.hasDetails()) {\n            return this.model.fetch();\n        }\n        return jQuery.when();\n    },\n\n    /** Inner fn called when expand (public) has fetched the details */\n    _expand: function _expand() {\n        var view = this;\n        var $newDetails = view._renderDetails();\n        view.$details().replaceWith($newDetails);\n        // needs to be set after the above or the slide will not show\n        view.expanded = true;\n        view.$details().slideDown(view.fxSpeed, function () {\n            view.trigger(\"expanded\", view);\n        });\n    },\n\n    /** Hide the body/details of an HDA.\n     *  @fires collapsed when a body has been collapsed\n     */\n    collapse: function collapse() {\n        this.debug(this + \"(ExpandableView).collapse\");\n        var view = this;\n        view.expanded = false;\n        this.$details().slideUp(view.fxSpeed, function () {\n            view.trigger(\"collapsed\", view);\n        });\n    }\n});\n\n//==============================================================================\n/** A view that is displayed in some larger list/grid/collection.\n *      Inherits from Expandable, Selectable, Draggable.\n *  The DOM contains warnings, a title bar, and a series of primary action controls.\n *      Primary actions are meant to be easily accessible item functions (such as delete)\n *      that are rendered in the title bar.\n *\n *  Details are rendered when the user clicks the title bar or presses enter/space when\n *      the title bar is in focus.\n *\n *  Designed as a base class for history panel contents - but usable elsewhere (I hope).\n */\nvar ListItemView = ExpandableView.extend(_baseMvc2.default.mixin(_baseMvc2.default.SelectableViewMixin, _baseMvc2.default.DraggableViewMixin, {\n    tagName: \"div\",\n    className: \"list-item\",\n\n    /** Set up the base class and all mixins */\n    initialize: function initialize(attributes) {\n        ExpandableView.prototype.initialize.call(this, attributes);\n        _baseMvc2.default.SelectableViewMixin.initialize.call(this, attributes);\n        _baseMvc2.default.DraggableViewMixin.initialize.call(this, attributes);\n        this._setUpListeners();\n    },\n\n    /** event listeners */\n    _setUpListeners: function _setUpListeners() {\n        // hide the primary actions in the title bar when selectable and narrow\n        this.on(\"selectable\", function (isSelectable) {\n            if (isSelectable) {\n                this.$(\".primary-actions\").hide();\n            } else {\n                this.$(\".primary-actions\").show();\n            }\n        }, this);\n        return this;\n    },\n\n    // ........................................................................ rendering\n    /** In this override, call methods to build warnings, titlebar and primary actions */\n    _buildNewRender: function _buildNewRender() {\n        var $newRender = ExpandableView.prototype._buildNewRender.call(this);\n        $newRender.children(\".warnings\").replaceWith(this._renderWarnings());\n        $newRender.children(\".title-bar\").replaceWith(this._renderTitleBar());\n        $newRender.children(\".primary-actions\").append(this._renderPrimaryActions());\n        $newRender.find(\"> .title-bar .subtitle\").replaceWith(this._renderSubtitle());\n        return $newRender;\n    },\n\n    /** In this override, render the selector controls and set up dragging before the swap */\n    _swapNewRender: function _swapNewRender($newRender) {\n        ExpandableView.prototype._swapNewRender.call(this, $newRender);\n        if (this.selectable) {\n            this.showSelector(0);\n        }\n        if (this.draggable) {\n            this.draggableOn();\n        }\n        return this.$el;\n    },\n\n    /** Render any warnings the item may need to show (e.g. \"I'm deleted\") */\n    _renderWarnings: function _renderWarnings() {\n        var view = this;\n        var $warnings = $('<div class=\"warnings\"></div>');\n        var json = view.model.toJSON();\n        //TODO:! unordered (map)\n        _.each(view.templates.warnings, function (templateFn) {\n            $warnings.append($(templateFn(json, view)));\n        });\n        return $warnings;\n    },\n\n    /** Render the title bar (the main/exposed SUMMARY dom element) */\n    _renderTitleBar: function _renderTitleBar() {\n        return $(this.templates.titleBar(this.model.toJSON(), this));\n    },\n\n    /** Return an array of jQ objects containing common/easily-accessible item controls */\n    _renderPrimaryActions: function _renderPrimaryActions() {\n        // override this\n        return [];\n    },\n\n    /** Render the title bar (the main/exposed SUMMARY dom element) */\n    _renderSubtitle: function _renderSubtitle() {\n        return $(this.templates.subtitle(this.model.toJSON(), this));\n    },\n\n    // ......................................................................... events\n    /** event map */\n    events: {\n        // expand the body when the title is clicked or when in focus and space or enter is pressed\n        \"click .title-bar\": \"_clickTitleBar\",\n        \"keydown .title-bar\": \"_keyDownTitleBar\",\n        \"click .selector\": \"toggleSelect\"\n    },\n\n    /** expand when the title bar is clicked */\n    _clickTitleBar: function _clickTitleBar(event) {\n        event.stopPropagation();\n        if (event.altKey) {\n            this.toggleSelect(event);\n            if (!this.selectable) {\n                this.showSelector();\n            }\n        } else {\n            this.toggleExpanded();\n        }\n    },\n\n    /** expand when the title bar is in focus and enter or space is pressed */\n    _keyDownTitleBar: function _keyDownTitleBar(event) {\n        // bail (with propagation) if keydown and not space or enter\n        var KEYCODE_SPACE = 32;\n\n        var KEYCODE_RETURN = 13;\n        if (event && event.type === \"keydown\" && (event.keyCode === KEYCODE_SPACE || event.keyCode === KEYCODE_RETURN)) {\n            this.toggleExpanded();\n            event.stopPropagation();\n            return false;\n        }\n        return true;\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"ListItemView(\" + modelString + \")\";\n    }\n}));\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nListItemView.prototype.templates = function () {\n    var elTemplato = _baseMvc2.default.wrapTemplate(['<div class=\"list-element\">',\n    // errors, messages, etc.\n    '<div class=\"warnings\"></div>',\n\n    // multi-select checkbox\n    '<div class=\"selector\">', '<span class=\"fa fa-2x fa-square-o\"></span>', \"</div>\",\n    // space for title bar buttons - gen. floated to the right\n    '<div class=\"primary-actions\"></div>', '<div class=\"title-bar\"></div>',\n\n    // expandable area for more details\n    '<div class=\"details\"></div>', \"</div>\"]);\n\n    var warnings = {};\n\n    var titleBarTemplate = _baseMvc2.default.wrapTemplate([\n    // adding a tabindex here allows focusing the title bar and the use of keydown to expand the dataset display\n    '<div class=\"title-bar clear\" tabindex=\"0\">',\n    //TODO: prob. belongs in dataset-list-item\n    '<span class=\"state-icon\"></span>', '<div class=\"title\">', '<span class=\"name\"><%- element.name %></span>', \"</div>\", '<div class=\"subtitle\"></div>', \"</div>\"], \"element\");\n\n    var subtitleTemplate = _baseMvc2.default.wrapTemplate([\n    // override this\n    '<div class=\"subtitle\"></div>']);\n\n    var detailsTemplate = _baseMvc2.default.wrapTemplate([\n    // override this\n    '<div class=\"details\"></div>']);\n\n    return {\n        el: elTemplato,\n        warnings: warnings,\n        titleBar: titleBarTemplate,\n        subtitle: subtitleTemplate,\n        details: detailsTemplate\n    };\n}();\n\n//==============================================================================\n/** A view that is displayed in some larger list/grid/collection.\n *  *AND* can display some sub-list of it's own when expanded (e.g. dataset collections).\n *  This list will 'foldout' when the item is expanded depending on this.foldoutStyle:\n *      If 'foldout': will expand vertically to show the nested list\n *      If 'drilldown': will overlay the parent list\n *\n *  Inherits from ListItemView.\n *\n *  _renderDetails does the work of creating this.details: a sub-view that shows the nested list\n */\nvar FoldoutListItemView = ListItemView.extend({\n    /** If 'foldout': show the sub-panel inside the expanded item\n     *  If 'drilldown': only fire events and handle by pub-sub\n     *      (allow the panel containing this item to attach it, hide itself, etc.)\n     */\n    foldoutStyle: \"foldout\",\n    /** Panel view class to instantiate for the sub-panel */\n    foldoutPanelClass: null,\n\n    /** override to:\n     *      add attributes foldoutStyle and foldoutPanelClass for config poly\n     *      disrespect attributes.expanded if drilldown\n     */\n    initialize: function initialize(attributes) {\n        if (this.foldoutStyle === \"drilldown\") {\n            this.expanded = false;\n        }\n        this.foldoutStyle = attributes.foldoutStyle || this.foldoutStyle;\n        this.foldoutPanelClass = attributes.foldoutPanelClass || this.foldoutPanelClass;\n\n        ListItemView.prototype.initialize.call(this, attributes);\n        this.foldout = this._createFoldoutPanel();\n    },\n\n    /** in this override, attach the foldout panel when rendering details */\n    _renderDetails: function _renderDetails() {\n        if (this.foldoutStyle === \"drilldown\") {\n            return $();\n        }\n        var $newDetails = ListItemView.prototype._renderDetails.call(this);\n        return this._attachFoldout(this.foldout, $newDetails);\n    },\n\n    /** In this override, handle collection expansion. */\n    _createFoldoutPanel: function _createFoldoutPanel() {\n        var model = this.model;\n        var FoldoutClass = this._getFoldoutPanelClass(model);\n        var options = this._getFoldoutPanelOptions(model);\n\n        var foldout = new FoldoutClass(_.extend(options, {\n            model: model\n        }));\n\n        return foldout;\n    },\n\n    /** Stub to return proper foldout panel class */\n    _getFoldoutPanelClass: function _getFoldoutPanelClass() {\n        // override\n        return this.foldoutPanelClass;\n    },\n\n    /** Stub to return proper foldout panel options */\n    _getFoldoutPanelOptions: function _getFoldoutPanelOptions() {\n        return {\n            // propagate foldout style down\n            foldoutStyle: this.foldoutStyle,\n            fxSpeed: this.fxSpeed\n        };\n    },\n\n    /** Render the foldout panel inside the view, hiding controls */\n    _attachFoldout: function _attachFoldout(foldout, $whereTo) {\n        $whereTo = $whereTo || this.$(\"> .details\");\n        this.foldout = foldout.render(0);\n        foldout.$(\"> .controls\").hide();\n        return $whereTo.append(foldout.$el);\n    },\n\n    /** In this override, branch on foldoutStyle to show expanded */\n    expand: function expand() {\n        var view = this;\n        return view._fetchModelDetails().always(function () {\n            if (view.foldoutStyle === \"foldout\") {\n                view._expand();\n            } else if (view.foldoutStyle === \"drilldown\") {\n                view._expandByDrilldown();\n            }\n        });\n    },\n\n    /** For drilldown, set up close handler and fire expanded:drilldown\n     *      containing views can listen to this and handle other things\n     *      (like hiding themselves) by listening for expanded/collapsed:drilldown\n     */\n    _expandByDrilldown: function _expandByDrilldown() {\n        var view = this;\n        // attachment and rendering done by listener\n        view.listenTo(view.foldout, \"close\", function () {\n            view.trigger(\"collapsed:drilldown\", view, view.foldout);\n        });\n        view.trigger(\"expanded:drilldown\", view, view.foldout);\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nFoldoutListItemView.prototype.templates = function () {\n    var detailsTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"details\">',\n    // override with more info (that goes above the panel)\n    \"</div>\"], \"collection\");\n\n    return _.extend({}, ListItemView.prototype.templates, {\n        details: detailsTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    ExpandableView: ExpandableView,\n    ListItemView: ListItemView,\n    FoldoutListItemView: FoldoutListItemView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2xpc3QvbGlzdC1pdGVtLmpzPzMzNDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImxpc3RcIjtcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQSB2aWV3IHdoaWNoLCB3aGVuIGZpcnN0IHJlbmRlcmVkLCBzaG93cyBvbmx5IHN1bW1hcnkgZGF0YS9hdHRyaWJ1dGVzLCBidXRcbiAqICAgICAgY2FuIGJlIGV4cGFuZGVkIHRvIHNob3cgZnVydGhlciBkZXRhaWxzIChhbmQgb3B0aW9uYWxseSBmZXRjaCB0aG9zZVxuICogICAgICBkZXRhaWxzIGZyb20gdGhlIHNlcnZlcikuXG4gKi9cbnZhciBFeHBhbmRhYmxlVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKEJBU0VfTVZDLkxvZ2dhYmxlTWl4aW4pLmV4dGVuZCh7XG4gICAgX2xvZ05hbWVzcGFjZTogbG9nTmFtZXNwYWNlLFxuXG4gICAgLy9UT0RPOiBBbHRob3VnaCB0aGUgcmVhc29uaW5nIGJlaGluZCB0aGVtIGlzIGRpZmZlcmVudCwgdGhpcyBzaGFyZXMgYSBsb3Qgd2l0aCBIaWRkZW5VbnRpbEFjdGl2YXRlZCBhYm92ZTogY29tYmluZSB0aGVtXG4gICAgLy9QUkVDT05ESVRJT046IG1vZGVsIG11c3QgaGF2ZSBtZXRob2QgaGFzRGV0YWlsc1xuICAgIC8vUFJFQ09ORElUSU9OOiBzdWJjbGFzc2VzIG11c3QgaGF2ZSB0ZW1wbGF0ZXMuZWwgYW5kIHRlbXBsYXRlcy5kZXRhaWxzXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgIC8qKiBhcmUgdGhlIGRldGFpbHMgb2YgdGhpcyB2aWV3IGV4cGFuZGVkL3Nob3duIG9yIG5vdD8gKi9cbiAgICAgICAgdGhpcy5leHBhbmRlZCA9IGF0dHJpYnV0ZXMuZXhwYW5kZWQgfHwgZmFsc2U7XG4gICAgICAgIHRoaXMubG9nKFwiXFx0IGV4cGFuZGVkOlwiLCB0aGlzLmV4cGFuZGVkKTtcbiAgICAgICAgdGhpcy5meFNwZWVkID0gYXR0cmlidXRlcy5meFNwZWVkICE9PSB1bmRlZmluZWQgPyBhdHRyaWJ1dGVzLmZ4U3BlZWQgOiB0aGlzLmZ4U3BlZWQ7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiByZW5kZXIgbWFpblxuICAgIC8qKiBqcSBmeCBzcGVlZCAqL1xuICAgIGZ4U3BlZWQ6IFwiZmFzdFwiLFxuXG4gICAgLyoqIFJlbmRlciB0aGlzIGNvbnRlbnQsIHNldCB1cCB1aS5cbiAgICAgKiAgQHBhcmFtIHtOdW1iZXIgb3IgU3RyaW5nfSBzcGVlZCAgIHRoZSBzcGVlZCBvZiB0aGUgcmVuZGVyXG4gICAgICovXG4gICAgcmVuZGVyOiBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICB2YXIgJG5ld1JlbmRlciA9IHRoaXMuX2J1aWxkTmV3UmVuZGVyKCk7XG4gICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCRuZXdSZW5kZXIpO1xuICAgICAgICB0aGlzLl9xdWV1ZU5ld1JlbmRlcigkbmV3UmVuZGVyLCBzcGVlZCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKiogQnVpbGQgYSB0ZW1wIGRpdiBjb250YWluaW5nIHRoZSBuZXcgY2hpbGRyZW4gZm9yIHRoZSB2aWV3J3MgJGVsLlxuICAgICAqICAgICAgSWYgdGhlIHZpZXcgaXMgYWxyZWFkeSBleHBhbmRlZCwgYnVpbGQgdGhlIGRldGFpbHMgYXMgd2VsbC5cbiAgICAgKi9cbiAgICBfYnVpbGROZXdSZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjcmVhdGUgYSBuZXcgcmVuZGVyIHVzaW5nIGEgc2tlbGV0b24gdGVtcGxhdGUsIHJlbmRlciB0aXRsZSBidXR0b25zLCByZW5kZXIgYm9keSwgYW5kIHNldCB1cCBldmVudHMsIGV0Yy5cbiAgICAgICAgdmFyICRuZXdSZW5kZXIgPSAkKHRoaXMudGVtcGxhdGVzLmVsKHRoaXMubW9kZWwudG9KU09OKCksIHRoaXMpKTtcbiAgICAgICAgaWYgKHRoaXMuZXhwYW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMuJGRldGFpbHMoJG5ld1JlbmRlcikucmVwbGFjZVdpdGgodGhpcy5fcmVuZGVyRGV0YWlscygpLnNob3coKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRuZXdSZW5kZXI7XG4gICAgfSxcblxuICAgIC8qKiBGYWRlIG91dCB0aGUgb2xkIGVsLCBzd2FwIGluIHRoZSBuZXcgY29udGVudHMsIHRoZW4gZmFkZSBpbi5cbiAgICAgKiAgQHBhcmFtIHtOdW1iZXIgb3IgU3RyaW5nfSBzcGVlZCAgIGpxIHNwZWVkIHRvIHVzZSBmb3IgcmVuZGVyaW5nIGVmZmVjdHNcbiAgICAgKiAgQGZpcmVzIHJlbmRlcmVkIHdoZW4gcmVuZGVyZWRcbiAgICAgKi9cbiAgICBfcXVldWVOZXdSZW5kZXI6IGZ1bmN0aW9uKCRuZXdSZW5kZXIsIHNwZWVkKSB7XG4gICAgICAgIHNwZWVkID0gc3BlZWQgPT09IHVuZGVmaW5lZCA/IHRoaXMuZnhTcGVlZCA6IHNwZWVkO1xuICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHNwZWVkID09PSAwKSB7XG4gICAgICAgICAgICB2aWV3Ll9zd2FwTmV3UmVuZGVyKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgdmlldy50cmlnZ2VyKFwicmVuZGVyZWRcIiwgdmlldyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKHZpZXcpLnF1ZXVlKFwiZnhcIiwgW1xuICAgICAgICAgICAgICAgIG5leHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LiRlbC5mYWRlT3V0KHNwZWVkLCBuZXh0KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5leHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zd2FwTmV3UmVuZGVyKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy4kZWwuZmFkZUluKHNwZWVkLCBuZXh0KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5leHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnRyaWdnZXIoXCJyZW5kZXJlZFwiLCB2aWV3KTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBlbXB0eSBvdXQgdGhlIGN1cnJlbnQgZWwsIG1vdmUgdGhlICRuZXdSZW5kZXIncyBjaGlsZHJlbiBpbiAqL1xuICAgIF9zd2FwTmV3UmVuZGVyOiBmdW5jdGlvbigkbmV3UmVuZGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRlbFxuICAgICAgICAgICAgLmVtcHR5KClcbiAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXy5pc0Z1bmN0aW9uKHRoaXMuY2xhc3NOYW1lKSA/IHRoaXMuY2xhc3NOYW1lKCkgOiB0aGlzLmNsYXNzTmFtZSlcbiAgICAgICAgICAgIC5hcHBlbmQoJG5ld1JlbmRlci5jaGlsZHJlbigpKTtcbiAgICB9LFxuXG4gICAgLyoqIHNldCB1cCBqcyBiZWhhdmlvcnMsIGV2ZW50IGhhbmRsZXJzIGZvciBlbGVtZW50cyB3aXRoaW4gdGhlIGdpdmVuIGNvbnRhaW5lclxuICAgICAqICBAcGFyYW0ge2pRdWVyeX0gJGNvbnRhaW5lciBqcSBvYmplY3QgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgdG8gcHJvY2VzcyAoZGVmYXVsdHMgdG8gdGhpcy4kZWwpXG4gICAgICovXG4gICAgX3NldFVwQmVoYXZpb3JzOiBmdW5jdGlvbigkd2hlcmUpIHtcbiAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICAvLyBzZXQgdXAgY2FubmVkIGJlaGF2aW9yIG9uIGNoaWxkcmVuIChib290c3RyYXAsIHBvcHVwbWVudXMsIGVkaXRhYmxlX3RleHQsIGV0Yy4pXG4gICAgICAgIC8vbWFrZV9wb3B1cF9tZW51cyggJHdoZXJlICk7XG4gICAgICAgICR3aGVyZS5maW5kKFwiW3RpdGxlXVwiKS50b29sdGlwKHsgcGxhY2VtZW50OiBcImJvdHRvbVwiIH0pO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGRldGFpbHNcbiAgICAvKiogc2hvcnRjdXQgdG8gZGV0YWlscyBET00gKGFzIGpRKSAqL1xuICAgICRkZXRhaWxzOiBmdW5jdGlvbigkd2hlcmUpIHtcbiAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICByZXR1cm4gJHdoZXJlLmZpbmQoXCI+IC5kZXRhaWxzXCIpO1xuICAgIH0sXG5cbiAgICAvKiogYnVpbGQgdGhlIERPTSBmb3IgdGhlIGRldGFpbHMgYW5kIHNldCB1cCBiZWhhdmlvcnMgb24gaXQgKi9cbiAgICBfcmVuZGVyRGV0YWlsczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkbmV3RGV0YWlscyA9ICQodGhpcy50ZW1wbGF0ZXMuZGV0YWlscyh0aGlzLm1vZGVsLnRvSlNPTigpLCB0aGlzKSk7XG4gICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCRuZXdEZXRhaWxzKTtcbiAgICAgICAgcmV0dXJuICRuZXdEZXRhaWxzO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGV4cGFuc2lvbi9kZXRhaWxzXG4gICAgLyoqIFNob3cgb3IgaGlkZSB0aGUgZGV0YWlsc1xuICAgICAqICBAcGFyYW0ge0Jvb2xlYW59IGV4cGFuZCBpZiB0cnVlLCBleHBhbmQ7IGlmIGZhbHNlLCBjb2xsYXBzZVxuICAgICAqL1xuICAgIHRvZ2dsZUV4cGFuZGVkOiBmdW5jdGlvbihleHBhbmQpIHtcbiAgICAgICAgZXhwYW5kID0gZXhwYW5kID09PSB1bmRlZmluZWQgPyAhdGhpcy5leHBhbmRlZCA6IGV4cGFuZDtcbiAgICAgICAgaWYgKGV4cGFuZCkge1xuICAgICAgICAgICAgdGhpcy5leHBhbmQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqIFJlbmRlciBhbmQgc2hvdyB0aGUgZnVsbCwgZGV0YWlsZWQgYm9keSBvZiB0aGlzIHZpZXcgaW5jbHVkaW5nIGV4dHJhIGRhdGEgYW5kIGNvbnRyb2xzLlxuICAgICAqICAgICAgbm90ZTogaWYgdGhlIG1vZGVsIGRvZXMgbm90IGhhdmUgZGV0YWlsZWQgZGF0YSwgZmV0Y2ggdGhhdCBkYXRhIGJlZm9yZSBzaG93aW5nIHRoZSBib2R5XG4gICAgICogIEBmaXJlcyBleHBhbmRlZCB3aGVuIGEgYm9keSBoYXMgYmVlbiBleHBhbmRlZFxuICAgICAqL1xuICAgIGV4cGFuZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHZpZXcuX2ZldGNoTW9kZWxEZXRhaWxzKCkuYWx3YXlzKCgpID0+IHtcbiAgICAgICAgICAgIHZpZXcuX2V4cGFuZCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIENoZWNrIGZvciBtb2RlbCBkZXRhaWxzIGFuZCwgaWYgbm9uZSwgZmV0Y2ggdGhlbS5cbiAgICAgKiAgQHJldHVybnMge2pRdWVyeS5wcm9taXNlfSB0aGUgbW9kZWwuZmV0Y2gueGhyIGlmIGRldGFpbHMgYXJlIGJlaW5nIGZldGNoZWQsIGFuIGVtcHR5IHByb21pc2UgaWYgbm90XG4gICAgICovXG4gICAgX2ZldGNoTW9kZWxEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLm1vZGVsLmhhc0RldGFpbHMoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuZmV0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICB9LFxuXG4gICAgLyoqIElubmVyIGZuIGNhbGxlZCB3aGVuIGV4cGFuZCAocHVibGljKSBoYXMgZmV0Y2hlZCB0aGUgZGV0YWlscyAqL1xuICAgIF9leHBhbmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgIHZhciAkbmV3RGV0YWlscyA9IHZpZXcuX3JlbmRlckRldGFpbHMoKTtcbiAgICAgICAgdmlldy4kZGV0YWlscygpLnJlcGxhY2VXaXRoKCRuZXdEZXRhaWxzKTtcbiAgICAgICAgLy8gbmVlZHMgdG8gYmUgc2V0IGFmdGVyIHRoZSBhYm92ZSBvciB0aGUgc2xpZGUgd2lsbCBub3Qgc2hvd1xuICAgICAgICB2aWV3LmV4cGFuZGVkID0gdHJ1ZTtcbiAgICAgICAgdmlldy4kZGV0YWlscygpLnNsaWRlRG93bih2aWV3LmZ4U3BlZWQsICgpID0+IHtcbiAgICAgICAgICAgIHZpZXcudHJpZ2dlcihcImV4cGFuZGVkXCIsIHZpZXcpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIEhpZGUgdGhlIGJvZHkvZGV0YWlscyBvZiBhbiBIREEuXG4gICAgICogIEBmaXJlcyBjb2xsYXBzZWQgd2hlbiBhIGJvZHkgaGFzIGJlZW4gY29sbGFwc2VkXG4gICAgICovXG4gICAgY29sbGFwc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmRlYnVnKGAke3RoaXN9KEV4cGFuZGFibGVWaWV3KS5jb2xsYXBzZWApO1xuICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgIHZpZXcuZXhwYW5kZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy4kZGV0YWlscygpLnNsaWRlVXAodmlldy5meFNwZWVkLCAoKSA9PiB7XG4gICAgICAgICAgICB2aWV3LnRyaWdnZXIoXCJjb2xsYXBzZWRcIiwgdmlldyk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEEgdmlldyB0aGF0IGlzIGRpc3BsYXllZCBpbiBzb21lIGxhcmdlciBsaXN0L2dyaWQvY29sbGVjdGlvbi5cbiAqICAgICAgSW5oZXJpdHMgZnJvbSBFeHBhbmRhYmxlLCBTZWxlY3RhYmxlLCBEcmFnZ2FibGUuXG4gKiAgVGhlIERPTSBjb250YWlucyB3YXJuaW5ncywgYSB0aXRsZSBiYXIsIGFuZCBhIHNlcmllcyBvZiBwcmltYXJ5IGFjdGlvbiBjb250cm9scy5cbiAqICAgICAgUHJpbWFyeSBhY3Rpb25zIGFyZSBtZWFudCB0byBiZSBlYXNpbHkgYWNjZXNzaWJsZSBpdGVtIGZ1bmN0aW9ucyAoc3VjaCBhcyBkZWxldGUpXG4gKiAgICAgIHRoYXQgYXJlIHJlbmRlcmVkIGluIHRoZSB0aXRsZSBiYXIuXG4gKlxuICogIERldGFpbHMgYXJlIHJlbmRlcmVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSB0aXRsZSBiYXIgb3IgcHJlc3NlcyBlbnRlci9zcGFjZSB3aGVuXG4gKiAgICAgIHRoZSB0aXRsZSBiYXIgaXMgaW4gZm9jdXMuXG4gKlxuICogIERlc2lnbmVkIGFzIGEgYmFzZSBjbGFzcyBmb3IgaGlzdG9yeSBwYW5lbCBjb250ZW50cyAtIGJ1dCB1c2FibGUgZWxzZXdoZXJlIChJIGhvcGUpLlxuICovXG52YXIgTGlzdEl0ZW1WaWV3ID0gRXhwYW5kYWJsZVZpZXcuZXh0ZW5kKFxuICAgIEJBU0VfTVZDLm1peGluKEJBU0VfTVZDLlNlbGVjdGFibGVWaWV3TWl4aW4sIEJBU0VfTVZDLkRyYWdnYWJsZVZpZXdNaXhpbiwge1xuICAgICAgICB0YWdOYW1lOiBcImRpdlwiLFxuICAgICAgICBjbGFzc05hbWU6IFwibGlzdC1pdGVtXCIsXG5cbiAgICAgICAgLyoqIFNldCB1cCB0aGUgYmFzZSBjbGFzcyBhbmQgYWxsIG1peGlucyAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBFeHBhbmRhYmxlVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgQkFTRV9NVkMuU2VsZWN0YWJsZVZpZXdNaXhpbi5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICBCQVNFX01WQy5EcmFnZ2FibGVWaWV3TWl4aW4uaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgdGhpcy5fc2V0VXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZXZlbnQgbGlzdGVuZXJzICovXG4gICAgICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBoaWRlIHRoZSBwcmltYXJ5IGFjdGlvbnMgaW4gdGhlIHRpdGxlIGJhciB3aGVuIHNlbGVjdGFibGUgYW5kIG5hcnJvd1xuICAgICAgICAgICAgdGhpcy5vbihcbiAgICAgICAgICAgICAgICBcInNlbGVjdGFibGVcIixcbiAgICAgICAgICAgICAgICBmdW5jdGlvbihpc1NlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2VsZWN0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kKFwiLnByaW1hcnktYWN0aW9uc1wiKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiQoXCIucHJpbWFyeS1hY3Rpb25zXCIpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGhpc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiByZW5kZXJpbmdcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGNhbGwgbWV0aG9kcyB0byBidWlsZCB3YXJuaW5ncywgdGl0bGViYXIgYW5kIHByaW1hcnkgYWN0aW9ucyAqL1xuICAgICAgICBfYnVpbGROZXdSZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyICRuZXdSZW5kZXIgPSBFeHBhbmRhYmxlVmlldy5wcm90b3R5cGUuX2J1aWxkTmV3UmVuZGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAkbmV3UmVuZGVyLmNoaWxkcmVuKFwiLndhcm5pbmdzXCIpLnJlcGxhY2VXaXRoKHRoaXMuX3JlbmRlcldhcm5pbmdzKCkpO1xuICAgICAgICAgICAgJG5ld1JlbmRlci5jaGlsZHJlbihcIi50aXRsZS1iYXJcIikucmVwbGFjZVdpdGgodGhpcy5fcmVuZGVyVGl0bGVCYXIoKSk7XG4gICAgICAgICAgICAkbmV3UmVuZGVyLmNoaWxkcmVuKFwiLnByaW1hcnktYWN0aW9uc1wiKS5hcHBlbmQodGhpcy5fcmVuZGVyUHJpbWFyeUFjdGlvbnMoKSk7XG4gICAgICAgICAgICAkbmV3UmVuZGVyLmZpbmQoXCI+IC50aXRsZS1iYXIgLnN1YnRpdGxlXCIpLnJlcGxhY2VXaXRoKHRoaXMuX3JlbmRlclN1YnRpdGxlKCkpO1xuICAgICAgICAgICAgcmV0dXJuICRuZXdSZW5kZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIHJlbmRlciB0aGUgc2VsZWN0b3IgY29udHJvbHMgYW5kIHNldCB1cCBkcmFnZ2luZyBiZWZvcmUgdGhlIHN3YXAgKi9cbiAgICAgICAgX3N3YXBOZXdSZW5kZXI6IGZ1bmN0aW9uKCRuZXdSZW5kZXIpIHtcbiAgICAgICAgICAgIEV4cGFuZGFibGVWaWV3LnByb3RvdHlwZS5fc3dhcE5ld1JlbmRlci5jYWxsKHRoaXMsICRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0YWJsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1NlbGVjdG9yKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnZ2FibGVPbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBSZW5kZXIgYW55IHdhcm5pbmdzIHRoZSBpdGVtIG1heSBuZWVkIHRvIHNob3cgKGUuZy4gXCJJJ20gZGVsZXRlZFwiKSAqL1xuICAgICAgICBfcmVuZGVyV2FybmluZ3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICAgICAgdmFyICR3YXJuaW5ncyA9ICQoJzxkaXYgY2xhc3M9XCJ3YXJuaW5nc1wiPjwvZGl2PicpO1xuICAgICAgICAgICAgdmFyIGpzb24gPSB2aWV3Lm1vZGVsLnRvSlNPTigpO1xuICAgICAgICAgICAgLy9UT0RPOiEgdW5vcmRlcmVkIChtYXApXG4gICAgICAgICAgICBfLmVhY2godmlldy50ZW1wbGF0ZXMud2FybmluZ3MsIHRlbXBsYXRlRm4gPT4ge1xuICAgICAgICAgICAgICAgICR3YXJuaW5ncy5hcHBlbmQoJCh0ZW1wbGF0ZUZuKGpzb24sIHZpZXcpKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiAkd2FybmluZ3M7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbmRlciB0aGUgdGl0bGUgYmFyICh0aGUgbWFpbi9leHBvc2VkIFNVTU1BUlkgZG9tIGVsZW1lbnQpICovXG4gICAgICAgIF9yZW5kZXJUaXRsZUJhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJCh0aGlzLnRlbXBsYXRlcy50aXRsZUJhcih0aGlzLm1vZGVsLnRvSlNPTigpLCB0aGlzKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJldHVybiBhbiBhcnJheSBvZiBqUSBvYmplY3RzIGNvbnRhaW5pbmcgY29tbW9uL2Vhc2lseS1hY2Nlc3NpYmxlIGl0ZW0gY29udHJvbHMgKi9cbiAgICAgICAgX3JlbmRlclByaW1hcnlBY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIHRoaXNcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIHRoZSB0aXRsZSBiYXIgKHRoZSBtYWluL2V4cG9zZWQgU1VNTUFSWSBkb20gZWxlbWVudCkgKi9cbiAgICAgICAgX3JlbmRlclN1YnRpdGxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkKHRoaXMudGVtcGxhdGVzLnN1YnRpdGxlKHRoaXMubW9kZWwudG9KU09OKCksIHRoaXMpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGV2ZW50c1xuICAgICAgICAvKiogZXZlbnQgbWFwICovXG4gICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgLy8gZXhwYW5kIHRoZSBib2R5IHdoZW4gdGhlIHRpdGxlIGlzIGNsaWNrZWQgb3Igd2hlbiBpbiBmb2N1cyBhbmQgc3BhY2Ugb3IgZW50ZXIgaXMgcHJlc3NlZFxuICAgICAgICAgICAgXCJjbGljayAudGl0bGUtYmFyXCI6IFwiX2NsaWNrVGl0bGVCYXJcIixcbiAgICAgICAgICAgIFwia2V5ZG93biAudGl0bGUtYmFyXCI6IFwiX2tleURvd25UaXRsZUJhclwiLFxuICAgICAgICAgICAgXCJjbGljayAuc2VsZWN0b3JcIjogXCJ0b2dnbGVTZWxlY3RcIlxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBleHBhbmQgd2hlbiB0aGUgdGl0bGUgYmFyIGlzIGNsaWNrZWQgKi9cbiAgICAgICAgX2NsaWNrVGl0bGVCYXI6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGlmIChldmVudC5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVNlbGVjdChldmVudCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93U2VsZWN0b3IoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRXhwYW5kZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZXhwYW5kIHdoZW4gdGhlIHRpdGxlIGJhciBpcyBpbiBmb2N1cyBhbmQgZW50ZXIgb3Igc3BhY2UgaXMgcHJlc3NlZCAqL1xuICAgICAgICBfa2V5RG93blRpdGxlQmFyOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgLy8gYmFpbCAod2l0aCBwcm9wYWdhdGlvbikgaWYga2V5ZG93biBhbmQgbm90IHNwYWNlIG9yIGVudGVyXG4gICAgICAgICAgICB2YXIgS0VZQ09ERV9TUEFDRSA9IDMyO1xuXG4gICAgICAgICAgICB2YXIgS0VZQ09ERV9SRVRVUk4gPSAxMztcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBldmVudCAmJlxuICAgICAgICAgICAgICAgIGV2ZW50LnR5cGUgPT09IFwia2V5ZG93blwiICYmXG4gICAgICAgICAgICAgICAgKGV2ZW50LmtleUNvZGUgPT09IEtFWUNPREVfU1BBQ0UgfHwgZXZlbnQua2V5Q29kZSA9PT0gS0VZQ09ERV9SRVRVUk4pXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUV4cGFuZGVkKCk7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBMaXN0SXRlbVZpZXcoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH0pXG4pO1xuXG4vLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFRFTVBMQVRFU1xuLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGVzICovXG5MaXN0SXRlbVZpZXcucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIGVsVGVtcGxhdG8gPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoW1xuICAgICAgICAnPGRpdiBjbGFzcz1cImxpc3QtZWxlbWVudFwiPicsXG4gICAgICAgIC8vIGVycm9ycywgbWVzc2FnZXMsIGV0Yy5cbiAgICAgICAgJzxkaXYgY2xhc3M9XCJ3YXJuaW5nc1wiPjwvZGl2PicsXG5cbiAgICAgICAgLy8gbXVsdGktc2VsZWN0IGNoZWNrYm94XG4gICAgICAgICc8ZGl2IGNsYXNzPVwic2VsZWN0b3JcIj4nLFxuICAgICAgICAnPHNwYW4gY2xhc3M9XCJmYSBmYS0yeCBmYS1zcXVhcmUtb1wiPjwvc3Bhbj4nLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAvLyBzcGFjZSBmb3IgdGl0bGUgYmFyIGJ1dHRvbnMgLSBnZW4uIGZsb2F0ZWQgdG8gdGhlIHJpZ2h0XG4gICAgICAgICc8ZGl2IGNsYXNzPVwicHJpbWFyeS1hY3Rpb25zXCI+PC9kaXY+JyxcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZS1iYXJcIj48L2Rpdj4nLFxuXG4gICAgICAgIC8vIGV4cGFuZGFibGUgYXJlYSBmb3IgbW9yZSBkZXRhaWxzXG4gICAgICAgICc8ZGl2IGNsYXNzPVwiZGV0YWlsc1wiPjwvZGl2PicsXG4gICAgICAgIFwiPC9kaXY+XCJcbiAgICBdKTtcblxuICAgIHZhciB3YXJuaW5ncyA9IHt9O1xuXG4gICAgdmFyIHRpdGxlQmFyVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgIC8vIGFkZGluZyBhIHRhYmluZGV4IGhlcmUgYWxsb3dzIGZvY3VzaW5nIHRoZSB0aXRsZSBiYXIgYW5kIHRoZSB1c2Ugb2Yga2V5ZG93biB0byBleHBhbmQgdGhlIGRhdGFzZXQgZGlzcGxheVxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZS1iYXIgY2xlYXJcIiB0YWJpbmRleD1cIjBcIj4nLFxuICAgICAgICAgICAgLy9UT0RPOiBwcm9iLiBiZWxvbmdzIGluIGRhdGFzZXQtbGlzdC1pdGVtXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJzdGF0ZS1pY29uXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRpdGxlXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIm5hbWVcIj48JS0gZWxlbWVudC5uYW1lICU+PC9zcGFuPicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPjwvZGl2PicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgKTtcblxuICAgIHZhciBzdWJ0aXRsZVRlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFtcbiAgICAgICAgLy8gb3ZlcnJpZGUgdGhpc1xuICAgICAgICAnPGRpdiBjbGFzcz1cInN1YnRpdGxlXCI+PC9kaXY+J1xuICAgIF0pO1xuXG4gICAgdmFyIGRldGFpbHNUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShbXG4gICAgICAgIC8vIG92ZXJyaWRlIHRoaXNcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJkZXRhaWxzXCI+PC9kaXY+J1xuICAgIF0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZWw6IGVsVGVtcGxhdG8sXG4gICAgICAgIHdhcm5pbmdzOiB3YXJuaW5ncyxcbiAgICAgICAgdGl0bGVCYXI6IHRpdGxlQmFyVGVtcGxhdGUsXG4gICAgICAgIHN1YnRpdGxlOiBzdWJ0aXRsZVRlbXBsYXRlLFxuICAgICAgICBkZXRhaWxzOiBkZXRhaWxzVGVtcGxhdGVcbiAgICB9O1xufSkoKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBBIHZpZXcgdGhhdCBpcyBkaXNwbGF5ZWQgaW4gc29tZSBsYXJnZXIgbGlzdC9ncmlkL2NvbGxlY3Rpb24uXG4gKiAgKkFORCogY2FuIGRpc3BsYXkgc29tZSBzdWItbGlzdCBvZiBpdCdzIG93biB3aGVuIGV4cGFuZGVkIChlLmcuIGRhdGFzZXQgY29sbGVjdGlvbnMpLlxuICogIFRoaXMgbGlzdCB3aWxsICdmb2xkb3V0JyB3aGVuIHRoZSBpdGVtIGlzIGV4cGFuZGVkIGRlcGVuZGluZyBvbiB0aGlzLmZvbGRvdXRTdHlsZTpcbiAqICAgICAgSWYgJ2ZvbGRvdXQnOiB3aWxsIGV4cGFuZCB2ZXJ0aWNhbGx5IHRvIHNob3cgdGhlIG5lc3RlZCBsaXN0XG4gKiAgICAgIElmICdkcmlsbGRvd24nOiB3aWxsIG92ZXJsYXkgdGhlIHBhcmVudCBsaXN0XG4gKlxuICogIEluaGVyaXRzIGZyb20gTGlzdEl0ZW1WaWV3LlxuICpcbiAqICBfcmVuZGVyRGV0YWlscyBkb2VzIHRoZSB3b3JrIG9mIGNyZWF0aW5nIHRoaXMuZGV0YWlsczogYSBzdWItdmlldyB0aGF0IHNob3dzIHRoZSBuZXN0ZWQgbGlzdFxuICovXG52YXIgRm9sZG91dExpc3RJdGVtVmlldyA9IExpc3RJdGVtVmlldy5leHRlbmQoe1xuICAgIC8qKiBJZiAnZm9sZG91dCc6IHNob3cgdGhlIHN1Yi1wYW5lbCBpbnNpZGUgdGhlIGV4cGFuZGVkIGl0ZW1cbiAgICAgKiAgSWYgJ2RyaWxsZG93bic6IG9ubHkgZmlyZSBldmVudHMgYW5kIGhhbmRsZSBieSBwdWItc3ViXG4gICAgICogICAgICAoYWxsb3cgdGhlIHBhbmVsIGNvbnRhaW5pbmcgdGhpcyBpdGVtIHRvIGF0dGFjaCBpdCwgaGlkZSBpdHNlbGYsIGV0Yy4pXG4gICAgICovXG4gICAgZm9sZG91dFN0eWxlOiBcImZvbGRvdXRcIixcbiAgICAvKiogUGFuZWwgdmlldyBjbGFzcyB0byBpbnN0YW50aWF0ZSBmb3IgdGhlIHN1Yi1wYW5lbCAqL1xuICAgIGZvbGRvdXRQYW5lbENsYXNzOiBudWxsLFxuXG4gICAgLyoqIG92ZXJyaWRlIHRvOlxuICAgICAqICAgICAgYWRkIGF0dHJpYnV0ZXMgZm9sZG91dFN0eWxlIGFuZCBmb2xkb3V0UGFuZWxDbGFzcyBmb3IgY29uZmlnIHBvbHlcbiAgICAgKiAgICAgIGRpc3Jlc3BlY3QgYXR0cmlidXRlcy5leHBhbmRlZCBpZiBkcmlsbGRvd25cbiAgICAgKi9cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmICh0aGlzLmZvbGRvdXRTdHlsZSA9PT0gXCJkcmlsbGRvd25cIikge1xuICAgICAgICAgICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9sZG91dFN0eWxlID0gYXR0cmlidXRlcy5mb2xkb3V0U3R5bGUgfHwgdGhpcy5mb2xkb3V0U3R5bGU7XG4gICAgICAgIHRoaXMuZm9sZG91dFBhbmVsQ2xhc3MgPSBhdHRyaWJ1dGVzLmZvbGRvdXRQYW5lbENsYXNzIHx8IHRoaXMuZm9sZG91dFBhbmVsQ2xhc3M7XG5cbiAgICAgICAgTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMuZm9sZG91dCA9IHRoaXMuX2NyZWF0ZUZvbGRvdXRQYW5lbCgpO1xuICAgIH0sXG5cbiAgICAvKiogaW4gdGhpcyBvdmVycmlkZSwgYXR0YWNoIHRoZSBmb2xkb3V0IHBhbmVsIHdoZW4gcmVuZGVyaW5nIGRldGFpbHMgKi9cbiAgICBfcmVuZGVyRGV0YWlsczogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmZvbGRvdXRTdHlsZSA9PT0gXCJkcmlsbGRvd25cIikge1xuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgJG5ld0RldGFpbHMgPSBMaXN0SXRlbVZpZXcucHJvdG90eXBlLl9yZW5kZXJEZXRhaWxzLmNhbGwodGhpcyk7XG4gICAgICAgIHJldHVybiB0aGlzLl9hdHRhY2hGb2xkb3V0KHRoaXMuZm9sZG91dCwgJG5ld0RldGFpbHMpO1xuICAgIH0sXG5cbiAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgaGFuZGxlIGNvbGxlY3Rpb24gZXhwYW5zaW9uLiAqL1xuICAgIF9jcmVhdGVGb2xkb3V0UGFuZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbW9kZWwgPSB0aGlzLm1vZGVsO1xuICAgICAgICB2YXIgRm9sZG91dENsYXNzID0gdGhpcy5fZ2V0Rm9sZG91dFBhbmVsQ2xhc3MobW9kZWwpO1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMuX2dldEZvbGRvdXRQYW5lbE9wdGlvbnMobW9kZWwpO1xuXG4gICAgICAgIHZhciBmb2xkb3V0ID0gbmV3IEZvbGRvdXRDbGFzcyhcbiAgICAgICAgICAgIF8uZXh0ZW5kKG9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIGZvbGRvdXQ7XG4gICAgfSxcblxuICAgIC8qKiBTdHViIHRvIHJldHVybiBwcm9wZXIgZm9sZG91dCBwYW5lbCBjbGFzcyAqL1xuICAgIF9nZXRGb2xkb3V0UGFuZWxDbGFzczogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIG92ZXJyaWRlXG4gICAgICAgIHJldHVybiB0aGlzLmZvbGRvdXRQYW5lbENsYXNzO1xuICAgIH0sXG5cbiAgICAvKiogU3R1YiB0byByZXR1cm4gcHJvcGVyIGZvbGRvdXQgcGFuZWwgb3B0aW9ucyAqL1xuICAgIF9nZXRGb2xkb3V0UGFuZWxPcHRpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC8vIHByb3BhZ2F0ZSBmb2xkb3V0IHN0eWxlIGRvd25cbiAgICAgICAgICAgIGZvbGRvdXRTdHlsZTogdGhpcy5mb2xkb3V0U3R5bGUsXG4gICAgICAgICAgICBmeFNwZWVkOiB0aGlzLmZ4U3BlZWRcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqIFJlbmRlciB0aGUgZm9sZG91dCBwYW5lbCBpbnNpZGUgdGhlIHZpZXcsIGhpZGluZyBjb250cm9scyAqL1xuICAgIF9hdHRhY2hGb2xkb3V0OiBmdW5jdGlvbihmb2xkb3V0LCAkd2hlcmVUbykge1xuICAgICAgICAkd2hlcmVUbyA9ICR3aGVyZVRvIHx8IHRoaXMuJChcIj4gLmRldGFpbHNcIik7XG4gICAgICAgIHRoaXMuZm9sZG91dCA9IGZvbGRvdXQucmVuZGVyKDApO1xuICAgICAgICBmb2xkb3V0LiQoXCI+IC5jb250cm9sc1wiKS5oaWRlKCk7XG4gICAgICAgIHJldHVybiAkd2hlcmVUby5hcHBlbmQoZm9sZG91dC4kZWwpO1xuICAgIH0sXG5cbiAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgYnJhbmNoIG9uIGZvbGRvdXRTdHlsZSB0byBzaG93IGV4cGFuZGVkICovXG4gICAgZXhwYW5kOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdmlldy5fZmV0Y2hNb2RlbERldGFpbHMoKS5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHZpZXcuZm9sZG91dFN0eWxlID09PSBcImZvbGRvdXRcIikge1xuICAgICAgICAgICAgICAgIHZpZXcuX2V4cGFuZCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2aWV3LmZvbGRvdXRTdHlsZSA9PT0gXCJkcmlsbGRvd25cIikge1xuICAgICAgICAgICAgICAgIHZpZXcuX2V4cGFuZEJ5RHJpbGxkb3duKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogRm9yIGRyaWxsZG93biwgc2V0IHVwIGNsb3NlIGhhbmRsZXIgYW5kIGZpcmUgZXhwYW5kZWQ6ZHJpbGxkb3duXG4gICAgICogICAgICBjb250YWluaW5nIHZpZXdzIGNhbiBsaXN0ZW4gdG8gdGhpcyBhbmQgaGFuZGxlIG90aGVyIHRoaW5nc1xuICAgICAqICAgICAgKGxpa2UgaGlkaW5nIHRoZW1zZWx2ZXMpIGJ5IGxpc3RlbmluZyBmb3IgZXhwYW5kZWQvY29sbGFwc2VkOmRyaWxsZG93blxuICAgICAqL1xuICAgIF9leHBhbmRCeURyaWxsZG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgLy8gYXR0YWNobWVudCBhbmQgcmVuZGVyaW5nIGRvbmUgYnkgbGlzdGVuZXJcbiAgICAgICAgdmlldy5saXN0ZW5Ubyh2aWV3LmZvbGRvdXQsIFwiY2xvc2VcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdmlldy50cmlnZ2VyKFwiY29sbGFwc2VkOmRyaWxsZG93blwiLCB2aWV3LCB2aWV3LmZvbGRvdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmlldy50cmlnZ2VyKFwiZXhwYW5kZWQ6ZHJpbGxkb3duXCIsIHZpZXcsIHZpZXcuZm9sZG91dCk7XG4gICAgfVxufSk7XG5cbi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gVEVNUExBVEVTXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkZvbGRvdXRMaXN0SXRlbVZpZXcucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIGRldGFpbHNUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkZXRhaWxzXCI+JyxcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIHdpdGggbW9yZSBpbmZvICh0aGF0IGdvZXMgYWJvdmUgdGhlIHBhbmVsKVxuICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICBdLFxuICAgICAgICBcImNvbGxlY3Rpb25cIlxuICAgICk7XG5cbiAgICByZXR1cm4gXy5leHRlbmQoe30sIExpc3RJdGVtVmlldy5wcm90b3R5cGUudGVtcGxhdGVzLCB7XG4gICAgICAgIGRldGFpbHM6IGRldGFpbHNUZW1wbGF0ZVxuICAgIH0pO1xufSkoKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBFeHBhbmRhYmxlVmlldzogRXhwYW5kYWJsZVZpZXcsXG4gICAgTGlzdEl0ZW1WaWV3OiBMaXN0SXRlbVZpZXcsXG4gICAgRm9sZG91dExpc3RJdGVtVmlldzogRm9sZG91dExpc3RJdGVtVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvbGlzdC9saXN0LWl0ZW0uanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaEtBO0FBQ0E7QUFrS0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdIQTtBQUNBO0FBZ0lBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlGQTtBQUNBO0FBZ0dBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///22\n");

/***/ }),
/* 23 */
/*!***********************************!*\
  !*** ./galaxy/scripts/mvc/tag.js ***!
  \***********************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// =============================================================================\n/** A view on any model that has a 'tags' attribute (a list of tag strings)\n *      Incorporates the select2 jQuery plugin for tags display/editing:\n *      http://ivaynberg.github.io/select2/\n */\nvar TagsEditor = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.HiddenUntilActivatedViewMixin).extend({\n    tagName: \"div\",\n    className: \"tags-display\",\n    select_width: \"100%\",\n    events: {},\n\n    /** Set up listeners, parse options */\n    initialize: function initialize(options) {\n        //console.debug( this, options );\n        // only listen to the model only for changes to tags - re-render\n        this.show_editor = false;\n        if (options.usePrompt === false) {\n            this.label = \"\";\n        } else {\n            this.label = \"<label class=\\\"prompt\\\">\" + (0, _localization2.default)(\"Tags\") + \"</label>\";\n        }\n        this.workflow_mode = options.workflow_mode || false;\n        if (this.workflow_mode) {\n            this.events.click = \"showEditor\";\n            this.events.keydown = \"keydownHandler\";\n        }\n        this.hiddenUntilActivated(options.$activator, options);\n    },\n\n    /** Build the DOM elements, call select to on the created input, and set up behaviors */\n    render: function render() {\n        var self = this;\n        if (this.workflow_mode) {\n            this.$el.html(this._workflowTemplate());\n        } else {\n            this.$el.html(this._defaultTemplate());\n        }\n        this.$input().select2({\n            placeholder: \"Add tags\",\n            width: this.workflow_mode ? this.width : this.select_width,\n            tags: function tags() {\n                // initialize possible tags in the dropdown based on all the tags the user has used so far\n                return self._getTagsUsed();\n            }\n        });\n\n        this._setUpBehaviors();\n        return this;\n    },\n\n    _hashToName: function _hashToName(tag) {\n        if (tag.startsWith(\"#\")) {\n            return \"name:\" + tag.slice(1);\n        }\n        return tag;\n    },\n\n    _nameToHash: function _nameToHash(tag) {\n        if (tag.startsWith(\"name:\")) {\n            tag = \"#\" + tag.slice(5);\n        }\n        return tag;\n    },\n\n    /** @returns {String} the html text used to build the view's DOM */\n    _defaultTemplate: function _defaultTemplate() {\n        return [this.label, this._renderEditor()].join(\"\");\n    },\n\n    _workflowTemplate: function _workflowTemplate() {\n        // Shows labels by default, event handler controls whether we show tags or editor\n        return [this.show_editor ? this._renderEditor() : this._renderTags()].join(\" \");\n    },\n\n    keydownHandler: function keydownHandler(e) {\n        switch (e.which) {\n            // esc\n            case 27:\n                // hide the tag editor when pressing escape\n                this.hideEditor();\n                break;\n        }\n    },\n\n    showEditor: function showEditor() {\n        this.show_editor = true;\n        this.render();\n    },\n\n    hideEditor: function hideEditor() {\n        this.show_editor = false;\n        this.render();\n    },\n\n    _renderEditor: function _renderEditor() {\n        // set up initial tags by adding as CSV to input vals (necc. to init select2)\n        return \"<input class=\\\"tags-input\\\" value=\\\"\" + this.tagsToCSV() + \"\\\"/>\";\n    },\n\n    _renderTags: function _renderTags() {\n        var tags = this.model.get(\"tags\");\n        var addButton = Galaxy.root + \"static/images/fugue/tag--plus.png\";\n        var renderedArray = [];\n        _.each(tags, function (tag) {\n            tag = tag.indexOf(\"name:\") == 0 ? tag.slice(5) : tag;\n            var renderString = \"<span class=\\\"label label-info\\\">\" + tag + \"</span>\";\n            renderedArray.push(renderString);\n        });\n        if (renderedArray.length === 0) {\n            // If there are no tags to render we just show the add-tag-button\n            renderedArray.push(\"<img src=\" + addButton + \" class=\\\"add-tag-button\\\" title=\\\"Add tags\\\"/>\");\n        }\n        return renderedArray.join(\" \");\n    },\n\n    /** @returns {String} the sorted, comma-separated tags from the model */\n    tagsToCSV: function tagsToCSV() {\n        var self = this;\n        var tagsArray = this.model.get(\"tags\");\n        if (!_.isArray(tagsArray) || _.isEmpty(tagsArray)) {\n            return \"\";\n        }\n        return tagsArray.map(function (tag) {\n            return _.escape(self._nameToHash(tag));\n        }).sort().join(\",\");\n    },\n\n    /** @returns {jQuery} the input for this view */\n    $input: function $input() {\n        return this.$el.find(\"input.tags-input\");\n    },\n\n    /** @returns {String[]} all tags used by the current user */\n    _getTagsUsed: function _getTagsUsed() {\n        //TODO: global\n        var self = this;\n        return _.map(Galaxy.user.get(\"tags_used\"), self._nameToHash);\n    },\n\n    /** set up any event listeners on the view's DOM (mostly handled by select2) */\n    _setUpBehaviors: function _setUpBehaviors() {\n        var self = this;\n        this.$input().on(\"change\", function (event) {\n            // Modify any 'hashtag' 'nametags'\n            event.val = _.map(event.val, self._hashToName);\n            // save the model's tags in either remove or added event\n            self.model.save({ tags: event.val });\n            // if it's new, add the tag to the users tags\n            if (event.added) {\n                //??: solve weird behavior in FF on test.galaxyproject.org where\n                //  event.added.text is string object: 'String{ 0=\"o\", 1=\"n\", 2=\"e\" }'\n                self._addNewTagToTagsUsed(\"\" + event.added.text);\n            }\n        });\n    },\n\n    /** add a new tag (if not already there) to the list of all tags used by the user\n     *  @param {String} newTag  the tag to add to the list of used\n     */\n    _addNewTagToTagsUsed: function _addNewTagToTagsUsed(newTag) {\n        //TODO: global\n        var tagsUsed = Galaxy.user.get(\"tags_used\");\n        if (!_.contains(tagsUsed, newTag)) {\n            tagsUsed.push(newTag);\n            tagsUsed.sort();\n            Galaxy.user.set(\"tags_used\", tagsUsed);\n        }\n    },\n\n    /** shut down event listeners and remove this view's DOM */\n    remove: function remove() {\n        this.$input.off();\n        this.stopListening(this.model);\n        Backbone.View.prototype.remove.call(this);\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return [\"TagsEditor(\", \"\" + this.model, \")\"].join(\"\");\n    }\n});\n\nexports.default = {\n    TagsEditor: TagsEditor\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3RhZy5qcz8xZTEwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiYXNlTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEEgdmlldyBvbiBhbnkgbW9kZWwgdGhhdCBoYXMgYSAndGFncycgYXR0cmlidXRlIChhIGxpc3Qgb2YgdGFnIHN0cmluZ3MpXG4gKiAgICAgIEluY29ycG9yYXRlcyB0aGUgc2VsZWN0MiBqUXVlcnkgcGx1Z2luIGZvciB0YWdzIGRpc3BsYXkvZWRpdGluZzpcbiAqICAgICAgaHR0cDovL2l2YXluYmVyZy5naXRodWIuaW8vc2VsZWN0Mi9cbiAqL1xudmFyIFRhZ3NFZGl0b3IgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZChiYXNlTVZDLkxvZ2dhYmxlTWl4aW4pXG4gICAgLmV4dGVuZChiYXNlTVZDLkhpZGRlblVudGlsQWN0aXZhdGVkVmlld01peGluKVxuICAgIC5leHRlbmQoe1xuICAgICAgICB0YWdOYW1lOiBcImRpdlwiLFxuICAgICAgICBjbGFzc05hbWU6IFwidGFncy1kaXNwbGF5XCIsXG4gICAgICAgIHNlbGVjdF93aWR0aDogXCIxMDAlXCIsXG4gICAgICAgIGV2ZW50czoge30sXG5cbiAgICAgICAgLyoqIFNldCB1cCBsaXN0ZW5lcnMsIHBhcnNlIG9wdGlvbnMgKi9cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCB0aGlzLCBvcHRpb25zICk7XG4gICAgICAgICAgICAvLyBvbmx5IGxpc3RlbiB0byB0aGUgbW9kZWwgb25seSBmb3IgY2hhbmdlcyB0byB0YWdzIC0gcmUtcmVuZGVyXG4gICAgICAgICAgICB0aGlzLnNob3dfZWRpdG9yID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy51c2VQcm9tcHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYWJlbCA9IFwiXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubGFiZWwgPSBgPGxhYmVsIGNsYXNzPVwicHJvbXB0XCI+JHtfbChcIlRhZ3NcIil9PC9sYWJlbD5gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy53b3JrZmxvd19tb2RlID0gb3B0aW9ucy53b3JrZmxvd19tb2RlIHx8IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMud29ya2Zsb3dfbW9kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzLmNsaWNrID0gXCJzaG93RWRpdG9yXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudHMua2V5ZG93biA9IFwia2V5ZG93bkhhbmRsZXJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGlkZGVuVW50aWxBY3RpdmF0ZWQob3B0aW9ucy4kYWN0aXZhdG9yLCBvcHRpb25zKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQnVpbGQgdGhlIERPTSBlbGVtZW50cywgY2FsbCBzZWxlY3QgdG8gb24gdGhlIGNyZWF0ZWQgaW5wdXQsIGFuZCBzZXQgdXAgYmVoYXZpb3JzICovXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodGhpcy53b3JrZmxvd19tb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLl93b3JrZmxvd1RlbXBsYXRlKCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMuX2RlZmF1bHRUZW1wbGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuJGlucHV0KCkuc2VsZWN0Mih7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IFwiQWRkIHRhZ3NcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy53b3JrZmxvd19tb2RlID8gdGhpcy53aWR0aCA6IHRoaXMuc2VsZWN0X3dpZHRoLFxuICAgICAgICAgICAgICAgIHRhZ3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIHBvc3NpYmxlIHRhZ3MgaW4gdGhlIGRyb3Bkb3duIGJhc2VkIG9uIGFsbCB0aGUgdGFncyB0aGUgdXNlciBoYXMgdXNlZCBzbyBmYXJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2dldFRhZ3NVc2VkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICBfaGFzaFRvTmFtZTogZnVuY3Rpb24odGFnKSB7XG4gICAgICAgICAgICBpZiAodGFnLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBuYW1lOiR7dGFnLnNsaWNlKDEpfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFnO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9uYW1lVG9IYXNoOiBmdW5jdGlvbih0YWcpIHtcbiAgICAgICAgICAgIGlmICh0YWcuc3RhcnRzV2l0aChcIm5hbWU6XCIpKSB7XG4gICAgICAgICAgICAgICAgdGFnID0gYCMke3RhZy5zbGljZSg1KX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRhZztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQHJldHVybnMge1N0cmluZ30gdGhlIGh0bWwgdGV4dCB1c2VkIHRvIGJ1aWxkIHRoZSB2aWV3J3MgRE9NICovXG4gICAgICAgIF9kZWZhdWx0VGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLmxhYmVsLCB0aGlzLl9yZW5kZXJFZGl0b3IoKV0uam9pbihcIlwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICBfd29ya2Zsb3dUZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBTaG93cyBsYWJlbHMgYnkgZGVmYXVsdCwgZXZlbnQgaGFuZGxlciBjb250cm9scyB3aGV0aGVyIHdlIHNob3cgdGFncyBvciBlZGl0b3JcbiAgICAgICAgICAgIHJldHVybiBbdGhpcy5zaG93X2VkaXRvciA/IHRoaXMuX3JlbmRlckVkaXRvcigpIDogdGhpcy5fcmVuZGVyVGFncygpXS5qb2luKFwiIFwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICBrZXlkb3duSGFuZGxlcjogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgc3dpdGNoIChlLndoaWNoKSB7XG4gICAgICAgICAgICAgICAgLy8gZXNjXG4gICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSB0aGUgdGFnIGVkaXRvciB3aGVuIHByZXNzaW5nIGVzY2FwZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVFZGl0b3IoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd0VkaXRvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dfZWRpdG9yID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGlkZUVkaXRvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dfZWRpdG9yID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9yZW5kZXJFZGl0b3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gc2V0IHVwIGluaXRpYWwgdGFncyBieSBhZGRpbmcgYXMgQ1NWIHRvIGlucHV0IHZhbHMgKG5lY2MuIHRvIGluaXQgc2VsZWN0MilcbiAgICAgICAgICAgIHJldHVybiBgPGlucHV0IGNsYXNzPVwidGFncy1pbnB1dFwiIHZhbHVlPVwiJHt0aGlzLnRhZ3NUb0NTVigpfVwiLz5gO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9yZW5kZXJUYWdzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB0YWdzID0gdGhpcy5tb2RlbC5nZXQoXCJ0YWdzXCIpO1xuICAgICAgICAgICAgdmFyIGFkZEJ1dHRvbiA9IGAke0dhbGF4eS5yb290fXN0YXRpYy9pbWFnZXMvZnVndWUvdGFnLS1wbHVzLnBuZ2A7XG4gICAgICAgICAgICB2YXIgcmVuZGVyZWRBcnJheSA9IFtdO1xuICAgICAgICAgICAgXy5lYWNoKHRhZ3MsIHRhZyA9PiB7XG4gICAgICAgICAgICAgICAgdGFnID0gdGFnLmluZGV4T2YoXCJuYW1lOlwiKSA9PSAwID8gdGFnLnNsaWNlKDUpIDogdGFnO1xuICAgICAgICAgICAgICAgIHZhciByZW5kZXJTdHJpbmcgPSBgPHNwYW4gY2xhc3M9XCJsYWJlbCBsYWJlbC1pbmZvXCI+JHt0YWd9PC9zcGFuPmA7XG4gICAgICAgICAgICAgICAgcmVuZGVyZWRBcnJheS5wdXNoKHJlbmRlclN0cmluZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZW5kZXJlZEFycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBubyB0YWdzIHRvIHJlbmRlciB3ZSBqdXN0IHNob3cgdGhlIGFkZC10YWctYnV0dG9uXG4gICAgICAgICAgICAgICAgcmVuZGVyZWRBcnJheS5wdXNoKGA8aW1nIHNyYz0ke2FkZEJ1dHRvbn0gY2xhc3M9XCJhZGQtdGFnLWJ1dHRvblwiIHRpdGxlPVwiQWRkIHRhZ3NcIi8+YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVuZGVyZWRBcnJheS5qb2luKFwiIFwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQHJldHVybnMge1N0cmluZ30gdGhlIHNvcnRlZCwgY29tbWEtc2VwYXJhdGVkIHRhZ3MgZnJvbSB0aGUgbW9kZWwgKi9cbiAgICAgICAgdGFnc1RvQ1NWOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciB0YWdzQXJyYXkgPSB0aGlzLm1vZGVsLmdldChcInRhZ3NcIik7XG4gICAgICAgICAgICBpZiAoIV8uaXNBcnJheSh0YWdzQXJyYXkpIHx8IF8uaXNFbXB0eSh0YWdzQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFnc0FycmF5XG4gICAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gXy5lc2NhcGUoc2VsZi5fbmFtZVRvSGFzaCh0YWcpKSlcbiAgICAgICAgICAgICAgICAuc29ydCgpXG4gICAgICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBAcmV0dXJucyB7alF1ZXJ5fSB0aGUgaW5wdXQgZm9yIHRoaXMgdmlldyAqL1xuICAgICAgICAkaW5wdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGVsLmZpbmQoXCJpbnB1dC50YWdzLWlucHV0XCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBAcmV0dXJucyB7U3RyaW5nW119IGFsbCB0YWdzIHVzZWQgYnkgdGhlIGN1cnJlbnQgdXNlciAqL1xuICAgICAgICBfZ2V0VGFnc1VzZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy9UT0RPOiBnbG9iYWxcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfLm1hcChHYWxheHkudXNlci5nZXQoXCJ0YWdzX3VzZWRcIiksIHNlbGYuX25hbWVUb0hhc2gpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBzZXQgdXAgYW55IGV2ZW50IGxpc3RlbmVycyBvbiB0aGUgdmlldydzIERPTSAobW9zdGx5IGhhbmRsZWQgYnkgc2VsZWN0MikgKi9cbiAgICAgICAgX3NldFVwQmVoYXZpb3JzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJGlucHV0KCkub24oXCJjaGFuZ2VcIiwgZXZlbnQgPT4ge1xuICAgICAgICAgICAgICAgIC8vIE1vZGlmeSBhbnkgJ2hhc2h0YWcnICduYW1ldGFncydcbiAgICAgICAgICAgICAgICBldmVudC52YWwgPSBfLm1hcChldmVudC52YWwsIHNlbGYuX2hhc2hUb05hbWUpO1xuICAgICAgICAgICAgICAgIC8vIHNhdmUgdGhlIG1vZGVsJ3MgdGFncyBpbiBlaXRoZXIgcmVtb3ZlIG9yIGFkZGVkIGV2ZW50XG4gICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5zYXZlKHsgdGFnczogZXZlbnQudmFsIH0pO1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgbmV3LCBhZGQgdGhlIHRhZyB0byB0aGUgdXNlcnMgdGFnc1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5hZGRlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLz8/OiBzb2x2ZSB3ZWlyZCBiZWhhdmlvciBpbiBGRiBvbiB0ZXN0LmdhbGF4eXByb2plY3Qub3JnIHdoZXJlXG4gICAgICAgICAgICAgICAgICAgIC8vICBldmVudC5hZGRlZC50ZXh0IGlzIHN0cmluZyBvYmplY3Q6ICdTdHJpbmd7IDA9XCJvXCIsIDE9XCJuXCIsIDI9XCJlXCIgfSdcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWRkTmV3VGFnVG9UYWdzVXNlZChgJHtldmVudC5hZGRlZC50ZXh0fWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhZGQgYSBuZXcgdGFnIChpZiBub3QgYWxyZWFkeSB0aGVyZSkgdG8gdGhlIGxpc3Qgb2YgYWxsIHRhZ3MgdXNlZCBieSB0aGUgdXNlclxuICAgICAgICAgKiAgQHBhcmFtIHtTdHJpbmd9IG5ld1RhZyAgdGhlIHRhZyB0byBhZGQgdG8gdGhlIGxpc3Qgb2YgdXNlZFxuICAgICAgICAgKi9cbiAgICAgICAgX2FkZE5ld1RhZ1RvVGFnc1VzZWQ6IGZ1bmN0aW9uKG5ld1RhZykge1xuICAgICAgICAgICAgLy9UT0RPOiBnbG9iYWxcbiAgICAgICAgICAgIHZhciB0YWdzVXNlZCA9IEdhbGF4eS51c2VyLmdldChcInRhZ3NfdXNlZFwiKTtcbiAgICAgICAgICAgIGlmICghXy5jb250YWlucyh0YWdzVXNlZCwgbmV3VGFnKSkge1xuICAgICAgICAgICAgICAgIHRhZ3NVc2VkLnB1c2gobmV3VGFnKTtcbiAgICAgICAgICAgICAgICB0YWdzVXNlZC5zb3J0KCk7XG4gICAgICAgICAgICAgICAgR2FsYXh5LnVzZXIuc2V0KFwidGFnc191c2VkXCIsIHRhZ3NVc2VkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2h1dCBkb3duIGV2ZW50IGxpc3RlbmVycyBhbmQgcmVtb3ZlIHRoaXMgdmlldydzIERPTSAqL1xuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy4kaW5wdXQub2ZmKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCk7XG4gICAgICAgICAgICBCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gW1wiVGFnc0VkaXRvcihcIiwgYCR7dGhpcy5tb2RlbH1gLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVGFnc0VkaXRvcjogVGFnc0VkaXRvclxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdGFnLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7Ozs7QUFJQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEvS0E7QUFDQTtBQWlMQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///23\n");

/***/ }),
/* 24 */,
/* 25 */,
/* 26 */,
/* 27 */,
/* 28 */
/*!*********************************************!*\
  !*** ./galaxy/scripts/mvc/ui/ui-popover.js ***!
  \*********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar View = Backbone.View.extend({\n    optionsDefault: {\n        with_close: true,\n        title: null,\n        placement: \"top\",\n        container: \"body\",\n        body: null\n    },\n\n    initialize: function initialize(options) {\n        this.setElement(this._template());\n        this.uid = _utils2.default.uid();\n        this.options = _.defaults(options || {}, this.optionsDefault);\n        this.options.container.parent().append(this.el);\n        this.$title = this.$(\".popover-title-label\");\n        this.$close = this.$(\".popover-close\");\n        this.$body = this.$(\".popover-content\");\n\n        // add initial content\n        this.options.body && this.append(this.options.body);\n\n        // add event to hide if click is outside of popup and not on container\n        var self = this;\n        $(\"body\").on(\"mousedown.\" + this.uid, function (e) {\n            // the 'is' for buttons that trigger popups\n            // the 'has' for icons within a button that triggers a popup\n            self.visible && !$(self.options.container).is(e.target) && !$(self.el).is(e.target) && $(self.el).has(e.target).length === 0 && self.hide();\n        });\n    },\n\n    /**\n     * Render popover\n     */\n    render: function render() {\n        this.$title.html(this.options.title);\n        this.$el.removeClass().addClass(\"ui-popover popover fade in\").addClass(this.options.placement);\n        this.$el.css(this._get_placement(this.options.placement));\n\n        // configure close option\n        var self = this;\n        if (this.options.with_close) {\n            this.$close.on(\"click\", function () {\n                self.hide();\n            }).show();\n        } else {\n            this.$close.off().hide();\n        }\n    },\n\n    /**\n     * Set the popover title\n     * @params{ String }    newTitle    - New popover title\n     */\n    title: function title(newTitle) {\n        if (newTitle !== undefined) {\n            this.options.title = newTitle;\n            this.$title.html(newTitle);\n        }\n    },\n\n    /**\n     * Show popover\n     */\n    show: function show() {\n        this.render();\n        this.$el.show();\n        this.visible = true;\n    },\n\n    /**\n     * Hide popover\n     */\n    hide: function hide() {\n        this.$el.hide();\n        this.visible = false;\n    },\n\n    /**\n     * Append new content to the popover\n     * @params{ Object }  $el - Dom element\n     */\n    append: function append($el) {\n        this.$body.append($el);\n    },\n\n    /**\n     * Remove all content\n     */\n    empty: function empty() {\n        this.$body.empty();\n    },\n\n    /**\n     * Remove popover\n     */\n    remove: function remove() {\n        $(\"body\").off(\"mousedown.\" + this.uid);\n        this.$el.remove();\n    },\n\n    /**\n     * Improve popover location/placement\n     */\n    _get_placement: function _get_placement(placement) {\n        // get popover dimensions\n        var width = this._get_width(this.$el);\n        var height = this.$el.height();\n\n        // get container details\n        var $container = this.options.container;\n        var container_width = this._get_width($container);\n        var container_height = this._get_height($container);\n        var container_position = $container.position();\n\n        // get position\n        var top;\n\n        var left;\n        top = left = 0;\n        if ([\"top\", \"bottom\"].indexOf(placement) != -1) {\n            left = container_position.left - width + (container_width + width) / 2;\n            switch (placement) {\n                case \"top\":\n                    top = container_position.top - height - 5;\n                    break;\n                case \"bottom\":\n                    top = container_position.top + container_height + 5;\n                    break;\n            }\n        } else {\n            top = container_position.top - height + (container_height + height) / 2;\n            switch (placement) {\n                case \"right\":\n                    left = container_position.left + container_width;\n                    break;\n            }\n        }\n        return { top: top, left: left };\n    },\n\n    /**\n     * Returns padding/margin corrected width\n     */\n    _get_width: function _get_width($el) {\n        return $el.width() + parseInt($el.css(\"padding-left\")) + parseInt($el.css(\"margin-left\")) + parseInt($el.css(\"padding-right\")) + parseInt($el.css(\"margin-right\"));\n    },\n\n    /**\n     * Returns padding corrected height\n     */\n    _get_height: function _get_height($el) {\n        return $el.height() + parseInt($el.css(\"padding-top\")) + parseInt($el.css(\"padding-bottom\"));\n    },\n\n    /**\n     * Return the popover template\n     */\n    _template: function _template(options) {\n        return '<div class=\"ui-popover popover fade in\">' + '<div class=\"arrow\"/>' + '<div class=\"popover-title\">' + '<div class=\"popover-title-label\"/>' + '<div class=\"popover-close fa fa-times-circle\"/>' + \"</div>\" + '<div class=\"popover-content\"/>' + \"</div>\";\n    }\n}); /**\n     * Popover wrapper\n     */\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VpL3VpLXBvcG92ZXIuanM/NzJjOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBvcG92ZXIgd3JhcHBlclxuICovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG52YXIgVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBvcHRpb25zRGVmYXVsdDoge1xuICAgICAgICB3aXRoX2Nsb3NlOiB0cnVlLFxuICAgICAgICB0aXRsZTogbnVsbCxcbiAgICAgICAgcGxhY2VtZW50OiBcInRvcFwiLFxuICAgICAgICBjb250YWluZXI6IFwiYm9keVwiLFxuICAgICAgICBib2R5OiBudWxsXG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMuX3RlbXBsYXRlKCkpO1xuICAgICAgICB0aGlzLnVpZCA9IFV0aWxzLnVpZCgpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBfLmRlZmF1bHRzKG9wdGlvbnMgfHwge30sIHRoaXMub3B0aW9uc0RlZmF1bHQpO1xuICAgICAgICB0aGlzLm9wdGlvbnMuY29udGFpbmVyLnBhcmVudCgpLmFwcGVuZCh0aGlzLmVsKTtcbiAgICAgICAgdGhpcy4kdGl0bGUgPSB0aGlzLiQoXCIucG9wb3Zlci10aXRsZS1sYWJlbFwiKTtcbiAgICAgICAgdGhpcy4kY2xvc2UgPSB0aGlzLiQoXCIucG9wb3Zlci1jbG9zZVwiKTtcbiAgICAgICAgdGhpcy4kYm9keSA9IHRoaXMuJChcIi5wb3BvdmVyLWNvbnRlbnRcIik7XG5cbiAgICAgICAgLy8gYWRkIGluaXRpYWwgY29udGVudFxuICAgICAgICB0aGlzLm9wdGlvbnMuYm9keSAmJiB0aGlzLmFwcGVuZCh0aGlzLm9wdGlvbnMuYm9keSk7XG5cbiAgICAgICAgLy8gYWRkIGV2ZW50IHRvIGhpZGUgaWYgY2xpY2sgaXMgb3V0c2lkZSBvZiBwb3B1cCBhbmQgbm90IG9uIGNvbnRhaW5lclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICQoXCJib2R5XCIpLm9uKGBtb3VzZWRvd24uJHt0aGlzLnVpZH1gLCBlID0+IHtcbiAgICAgICAgICAgIC8vIHRoZSAnaXMnIGZvciBidXR0b25zIHRoYXQgdHJpZ2dlciBwb3B1cHNcbiAgICAgICAgICAgIC8vIHRoZSAnaGFzJyBmb3IgaWNvbnMgd2l0aGluIGEgYnV0dG9uIHRoYXQgdHJpZ2dlcnMgYSBwb3B1cFxuICAgICAgICAgICAgc2VsZi52aXNpYmxlICYmXG4gICAgICAgICAgICAgICAgISQoc2VsZi5vcHRpb25zLmNvbnRhaW5lcikuaXMoZS50YXJnZXQpICYmXG4gICAgICAgICAgICAgICAgISQoc2VsZi5lbCkuaXMoZS50YXJnZXQpICYmXG4gICAgICAgICAgICAgICAgJChzZWxmLmVsKS5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHBvcG92ZXJcbiAgICAgKi9cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiR0aXRsZS5odG1sKHRoaXMub3B0aW9ucy50aXRsZSk7XG4gICAgICAgIHRoaXMuJGVsXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwidWktcG9wb3ZlciBwb3BvdmVyIGZhZGUgaW5cIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMucGxhY2VtZW50KTtcbiAgICAgICAgdGhpcy4kZWwuY3NzKHRoaXMuX2dldF9wbGFjZW1lbnQodGhpcy5vcHRpb25zLnBsYWNlbWVudCkpO1xuXG4gICAgICAgIC8vIGNvbmZpZ3VyZSBjbG9zZSBvcHRpb25cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLndpdGhfY2xvc2UpIHtcbiAgICAgICAgICAgIHRoaXMuJGNsb3NlXG4gICAgICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiRjbG9zZS5vZmYoKS5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBwb3BvdmVyIHRpdGxlXG4gICAgICogQHBhcmFtc3sgU3RyaW5nIH0gICAgbmV3VGl0bGUgICAgLSBOZXcgcG9wb3ZlciB0aXRsZVxuICAgICAqL1xuICAgIHRpdGxlOiBmdW5jdGlvbihuZXdUaXRsZSkge1xuICAgICAgICBpZiAobmV3VGl0bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLnRpdGxlID0gbmV3VGl0bGU7XG4gICAgICAgICAgICB0aGlzLiR0aXRsZS5odG1sKG5ld1RpdGxlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTaG93IHBvcG92ZXJcbiAgICAgKi9cbiAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy4kZWwuc2hvdygpO1xuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIaWRlIHBvcG92ZXJcbiAgICAgKi9cbiAgICBoaWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuaGlkZSgpO1xuICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQXBwZW5kIG5ldyBjb250ZW50IHRvIHRoZSBwb3BvdmVyXG4gICAgICogQHBhcmFtc3sgT2JqZWN0IH0gICRlbCAtIERvbSBlbGVtZW50XG4gICAgICovXG4gICAgYXBwZW5kOiBmdW5jdGlvbigkZWwpIHtcbiAgICAgICAgdGhpcy4kYm9keS5hcHBlbmQoJGVsKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBjb250ZW50XG4gICAgICovXG4gICAgZW1wdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRib2R5LmVtcHR5KCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBwb3BvdmVyXG4gICAgICovXG4gICAgcmVtb3ZlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgJChcImJvZHlcIikub2ZmKGBtb3VzZWRvd24uJHt0aGlzLnVpZH1gKTtcbiAgICAgICAgdGhpcy4kZWwucmVtb3ZlKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEltcHJvdmUgcG9wb3ZlciBsb2NhdGlvbi9wbGFjZW1lbnRcbiAgICAgKi9cbiAgICBfZ2V0X3BsYWNlbWVudDogZnVuY3Rpb24ocGxhY2VtZW50KSB7XG4gICAgICAgIC8vIGdldCBwb3BvdmVyIGRpbWVuc2lvbnNcbiAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5fZ2V0X3dpZHRoKHRoaXMuJGVsKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuJGVsLmhlaWdodCgpO1xuXG4gICAgICAgIC8vIGdldCBjb250YWluZXIgZGV0YWlsc1xuICAgICAgICB2YXIgJGNvbnRhaW5lciA9IHRoaXMub3B0aW9ucy5jb250YWluZXI7XG4gICAgICAgIHZhciBjb250YWluZXJfd2lkdGggPSB0aGlzLl9nZXRfd2lkdGgoJGNvbnRhaW5lcik7XG4gICAgICAgIHZhciBjb250YWluZXJfaGVpZ2h0ID0gdGhpcy5fZ2V0X2hlaWdodCgkY29udGFpbmVyKTtcbiAgICAgICAgdmFyIGNvbnRhaW5lcl9wb3NpdGlvbiA9ICRjb250YWluZXIucG9zaXRpb24oKTtcblxuICAgICAgICAvLyBnZXQgcG9zaXRpb25cbiAgICAgICAgdmFyIHRvcDtcblxuICAgICAgICB2YXIgbGVmdDtcbiAgICAgICAgdG9wID0gbGVmdCA9IDA7XG4gICAgICAgIGlmIChbXCJ0b3BcIiwgXCJib3R0b21cIl0uaW5kZXhPZihwbGFjZW1lbnQpICE9IC0xKSB7XG4gICAgICAgICAgICBsZWZ0ID0gY29udGFpbmVyX3Bvc2l0aW9uLmxlZnQgLSB3aWR0aCArIChjb250YWluZXJfd2lkdGggKyB3aWR0aCkgLyAyO1xuICAgICAgICAgICAgc3dpdGNoIChwbGFjZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IGNvbnRhaW5lcl9wb3NpdGlvbi50b3AgLSBoZWlnaHQgLSA1O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICAgICAgICAgIHRvcCA9IGNvbnRhaW5lcl9wb3NpdGlvbi50b3AgKyBjb250YWluZXJfaGVpZ2h0ICsgNTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0b3AgPSBjb250YWluZXJfcG9zaXRpb24udG9wIC0gaGVpZ2h0ICsgKGNvbnRhaW5lcl9oZWlnaHQgKyBoZWlnaHQpIC8gMjtcbiAgICAgICAgICAgIHN3aXRjaCAocGxhY2VtZW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgICAgIGxlZnQgPSBjb250YWluZXJfcG9zaXRpb24ubGVmdCArIGNvbnRhaW5lcl93aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdG9wOiB0b3AsIGxlZnQ6IGxlZnQgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBwYWRkaW5nL21hcmdpbiBjb3JyZWN0ZWQgd2lkdGhcbiAgICAgKi9cbiAgICBfZ2V0X3dpZHRoOiBmdW5jdGlvbigkZWwpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICRlbC53aWR0aCgpICtcbiAgICAgICAgICAgIHBhcnNlSW50KCRlbC5jc3MoXCJwYWRkaW5nLWxlZnRcIikpICtcbiAgICAgICAgICAgIHBhcnNlSW50KCRlbC5jc3MoXCJtYXJnaW4tbGVmdFwiKSkgK1xuICAgICAgICAgICAgcGFyc2VJbnQoJGVsLmNzcyhcInBhZGRpbmctcmlnaHRcIikpICtcbiAgICAgICAgICAgIHBhcnNlSW50KCRlbC5jc3MoXCJtYXJnaW4tcmlnaHRcIikpXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgcGFkZGluZyBjb3JyZWN0ZWQgaGVpZ2h0XG4gICAgICovXG4gICAgX2dldF9oZWlnaHQ6IGZ1bmN0aW9uKCRlbCkge1xuICAgICAgICByZXR1cm4gJGVsLmhlaWdodCgpICsgcGFyc2VJbnQoJGVsLmNzcyhcInBhZGRpbmctdG9wXCIpKSArIHBhcnNlSW50KCRlbC5jc3MoXCJwYWRkaW5nLWJvdHRvbVwiKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgcG9wb3ZlciB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1aS1wb3BvdmVyIHBvcG92ZXIgZmFkZSBpblwiPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhcnJvd1wiLz4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicG9wb3Zlci10aXRsZVwiPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwb3BvdmVyLXRpdGxlLWxhYmVsXCIvPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwb3BvdmVyLWNsb3NlIGZhIGZhLXRpbWVzLWNpcmNsZVwiLz4nICtcbiAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwb3BvdmVyLWNvbnRlbnRcIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91aS91aS1wb3BvdmVyLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFHQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQVVBO0FBdkxBOzs7QUEwTEE7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///28\n");

/***/ }),
/* 29 */
/*!******************************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/list-collection-creator.js ***!
  \******************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _hdcaModel = __webpack_require__(/*! mvc/history/hdca-model */ 20);\n\nvar _hdcaModel2 = _interopRequireDefault(_hdcaModel);\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _baseCreator = __webpack_require__(/*! mvc/collection/base-creator */ 52);\n\nvar _baseCreator2 = _interopRequireDefault(_baseCreator);\n\nvar _uiModal = __webpack_require__(/*! mvc/ui/ui-modal */ 9);\n\nvar _uiModal2 = _interopRequireDefault(_uiModal);\n\nvar _naturalSort = __webpack_require__(/*! utils/natural-sort */ 53);\n\nvar _naturalSort2 = _interopRequireDefault(_naturalSort);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/hoverhighlight */ 54);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"collections\";\n\n/*==============================================================================\nTODO:\n    use proper Element model and not just json\n    straighten out createFn, collection.createHDCA\n    possibly stop using modals for this\n    It would be neat to do a drag and drop\n\n==============================================================================*/\n/** A view for both DatasetDCEs and NestedDCDCEs\n *  (things that implement collection-model:DatasetCollectionElementMixin)\n */\nvar DatasetCollectionElementView = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: logNamespace,\n\n    //TODO: use proper class (DatasetDCE or NestedDCDCE (or the union of both))\n    tagName: \"li\",\n    className: \"collection-element\",\n\n    initialize: function initialize(attributes) {\n        this.element = attributes.element || {};\n        this.selected = attributes.selected || false;\n    },\n\n    render: function render() {\n        this.dragStartHandler = _.bind(this._dragstart, this);\n        this.dragEndHandler = _.bind(this._dragend, this);\n        var handle = this.$el.attr(\"data-element-id\", this.element.id).attr(\"draggable\", true).html(this.template({ element: this.element })).get(0);\n        handle.addEventListener(\"dragstart\", this.dragStartHandler, false);\n        handle.addEventListener(\"dragend\", this.dragEndHandler, false);\n        if (this.selected) {\n            this.$el.addClass(\"selected\");\n        }\n        return this;\n    },\n\n    //TODO: lots of unused space in the element - possibly load details and display them horiz.\n    template: _.template(['<a class=\"name\" title=\"', (0, _localization2.default)(\"Click to rename\"), '\" href=\"javascript:void(0)\">', \"<%- element.name %>\", \"</a>\", '<button class=\"discard btn btn-sm\" title=\"', (0, _localization2.default)(\"Remove this dataset from the list\"), '\">', (0, _localization2.default)(\"Discard\"), \"</button>\"].join(\"\")),\n\n    /** select this element and pub */\n    select: function select(toggle) {\n        this.$el.toggleClass(\"selected\", toggle);\n        this.trigger(\"select\", {\n            source: this,\n            selected: this.$el.hasClass(\"selected\")\n        });\n    },\n\n    /** animate the removal of this element and pub */\n    discard: function discard() {\n        var view = this;\n        var parentWidth = this.$el.parent().width();\n        this.$el.animate({ \"margin-right\": parentWidth }, \"fast\", function () {\n            view.trigger(\"discard\", {\n                source: view\n            });\n            view.destroy();\n        });\n    },\n\n    /** remove the DOM and any listeners */\n    destroy: function destroy() {\n        this.off();\n        this.$el.remove();\n    },\n\n    events: {\n        click: \"_click\",\n        \"click .name\": \"_clickName\",\n        \"click .discard\": \"_clickDiscard\",\n\n        dragover: \"_sendToParent\",\n        drop: \"_sendToParent\"\n    },\n\n    /** select when the li is clicked */\n    _click: function _click(ev) {\n        ev.stopPropagation();\n        this.select(ev);\n    },\n\n    /** rename a pair when the name is clicked */\n    _clickName: function _clickName(ev) {\n        ev.stopPropagation();\n        ev.preventDefault();\n\n        var promptString = [(0, _localization2.default)(\"Enter a new name for the element\"), \":\\n(\", (0, _localization2.default)(\"Note that changing the name here will not rename the dataset\"), \")\"].join(\"\");\n\n        var response = prompt((0, _localization2.default)(\"Enter a new name for the element\") + \":\", this.element.name);\n\n        if (response) {\n            this.element.name = response;\n            this.render();\n        }\n        //TODO: cancelling with ESC leads to closure of the creator...\n    },\n\n    /** discard when the discard button is clicked */\n    _clickDiscard: function _clickDiscard(ev) {\n        ev.stopPropagation();\n        this.discard();\n    },\n\n    /** dragging pairs for re-ordering */\n    _dragstart: function _dragstart(ev) {\n        if (ev.originalEvent) {\n            ev = ev.originalEvent;\n        }\n        ev.dataTransfer.effectAllowed = \"move\";\n        ev.dataTransfer.setData(\"text/plain\", JSON.stringify(this.element));\n\n        this.$el.addClass(\"dragging\");\n        this.$el.parent().trigger(\"collection-element.dragstart\", [this]);\n    },\n\n    /** dragging for re-ordering */\n    _dragend: function _dragend(ev) {\n        this.$el.removeClass(\"dragging\");\n        this.$el.parent().trigger(\"collection-element.dragend\", [this]);\n    },\n\n    /** manually bubble up an event to the parent/container */\n    _sendToParent: function _sendToParent(ev) {\n        this.$el.parent().trigger(ev);\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return \"DatasetCollectionElementView()\";\n    }\n});\n\n// ============================================================================\n/** An interface for building collections.\n */\nvar ListCollectionCreator = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend(_baseCreator2.default.CollectionCreatorMixin).extend({\n    _logNamespace: logNamespace,\n\n    /** the class used to display individual elements */\n    elementViewClass: DatasetCollectionElementView,\n    /** the class this creator will create and save */\n    collectionClass: _hdcaModel2.default.HistoryDatasetCollection,\n    className: \"list-collection-creator collection-creator flex-row-container\",\n\n    /** minimum number of valid elements to start with in order to build a collection of this type */\n    minElements: 1,\n\n    defaultAttributes: {\n        //TODO: remove - use new collectionClass().save()\n        /** takes elements and creates the proper collection - returns a promise */\n        creationFn: function creationFn() {\n            throw new TypeError(\"no creation fn for creator\");\n        },\n        /** fn to call when the collection is created (scoped to this) */\n        oncreate: function oncreate() {},\n        /** fn to call when the cancel button is clicked (scoped to this) - if falsy, no btn is displayed */\n        oncancel: function oncancel() {},\n        /** distance from list edge to begin autoscrolling list */\n        autoscrollDist: 24,\n        /** Color passed to hoverhighlight */\n        highlightClr: \"rgba( 64, 255, 255, 1.0 )\"\n    },\n\n    footerSettings: {\n        \".hide-originals\": \"hideOriginals\"\n    },\n\n    /** set up initial options, instance vars, behaviors */\n    initialize: function initialize(attributes) {\n        this.metric(\"ListCollectionCreator.initialize\", attributes);\n        var creator = this;\n        _.each(this.defaultAttributes, function (value, key) {\n            value = attributes[key] || value;\n            creator[key] = value;\n        });\n\n        /** unordered, original list - cache to allow reversal */\n        creator.initialElements = attributes.elements || [];\n\n        this._setUpCommonSettings(attributes);\n        this._instanceSetUp();\n        this._elementsSetUp();\n        this._setUpBehaviors();\n    },\n\n    /** set up instance vars */\n    _instanceSetUp: function _instanceSetUp() {\n        /** Ids of elements that have been selected by the user - to preserve over renders */\n        this.selectedIds = {};\n        /** DOM elements currently being dragged */\n        this.$dragging = null;\n        /** Used for blocking UI events during ajax/operations (don't post twice) */\n        this.blocking = false;\n    },\n\n    // ------------------------------------------------------------------------ process raw list\n    /** set up main data */\n    _elementsSetUp: function _elementsSetUp() {\n        //this.debug( '-- _dataSetUp' );\n        /** a list of invalid elements and the reasons they aren't valid */\n        this.invalidElements = [];\n        //TODO: handle fundamental problem of syncing DOM, views, and list here\n        /** data for list in progress */\n        this.workingElements = [];\n        /** views for workingElements */\n        this.elementViews = [];\n\n        // copy initial list, sort, add ids if needed\n        this.workingElements = this.initialElements.slice(0);\n        this._ensureElementIds();\n        this._validateElements();\n        this._mangleDuplicateNames();\n        this._sortElements();\n    },\n\n    /** add ids to dataset objs in initial list if none */\n    _ensureElementIds: function _ensureElementIds() {\n        this.workingElements.forEach(function (element) {\n            if (!element.hasOwnProperty(\"id\")) {\n                element.id = _.uniqueId();\n            }\n        });\n        return this.workingElements;\n    },\n\n    /** separate working list into valid and invalid elements for this collection */\n    _validateElements: function _validateElements() {\n        var creator = this;\n        var existingNames = {};\n        creator.invalidElements = [];\n\n        this.workingElements = this.workingElements.filter(function (element) {\n            var problem = creator._isElementInvalid(element);\n            if (problem) {\n                creator.invalidElements.push({\n                    element: element,\n                    text: problem\n                });\n            }\n            return !problem;\n        });\n        return this.workingElements;\n    },\n\n    /** describe what is wrong with a particular element if anything */\n    _isElementInvalid: function _isElementInvalid(element) {\n        if (element.history_content_type === \"dataset_collection\") {\n            return (0, _localization2.default)(\"is a collection, this is not allowed\");\n        }\n        var validState = element.state === _states2.default.OK || _.contains(_states2.default.NOT_READY_STATES, element.state);\n        if (!validState) {\n            return (0, _localization2.default)(\"has errored, is paused, or is not accessible\");\n        }\n        if (element.deleted || element.purged) {\n            return (0, _localization2.default)(\"has been deleted or purged\");\n        }\n        return null;\n    },\n\n    /** mangle duplicate names using a mac-like '(counter)' addition to any duplicates */\n    _mangleDuplicateNames: function _mangleDuplicateNames() {\n        var SAFETY = 900;\n        var counter = 1;\n        var existingNames = {};\n        this.workingElements.forEach(function (element) {\n            var currName = element.name;\n            while (existingNames.hasOwnProperty(currName)) {\n                currName = element.name + \" (\" + counter + \")\";\n                counter += 1;\n                if (counter >= SAFETY) {\n                    throw new Error(\"Safety hit in while loop - thats impressive\");\n                }\n            }\n            element.name = currName;\n            existingNames[element.name] = true;\n        });\n    },\n\n    /** sort a list of elements */\n    _sortElements: function _sortElements(list) {\n        // // currently only natural sort by name\n        // this.workingElements.sort( function( a, b ){ return naturalSort( a.name, b.name ); });\n        // return this.workingElements;\n    },\n\n    // ------------------------------------------------------------------------ rendering\n    // templates : ListCollectionCreator.templates,\n    /** render the entire interface */\n    render: function render(speed, callback) {\n        //this.debug( '-- _render' );\n        if (this.workingElements.length < this.minElements) {\n            return this._renderInvalid(speed, callback);\n        }\n\n        this.$el.empty().html(this.templates.main());\n        this._renderHeader(speed);\n        this._renderMiddle(speed);\n        this._renderFooter(speed);\n        this._addPluginComponents();\n        this.$(\".collection-name\").focus();\n        this.trigger(\"rendered\", this);\n        return this;\n    },\n\n    /** render a simplified interface aimed at telling the user why they can't move forward */\n    _renderInvalid: function _renderInvalid(speed, callback) {\n        //this.debug( '-- _render' );\n        this.$el.empty().html(this.templates.invalidInitial({\n            problems: this.invalidElements,\n            elements: this.workingElements\n        }));\n        if (typeof this.oncancel === \"function\") {\n            this.$(\".cancel-create.btn\").show();\n        }\n        this.trigger(\"rendered\", this);\n        return this;\n    },\n\n    /** render the header section */\n    _renderHeader: function _renderHeader(speed, callback) {\n        var $header = this.$(\".header\").empty().html(this.templates.header()).find(\".help-content\").prepend($(this.templates.helpContent()));\n        //TODO: should only show once despite calling _renderHeader again\n        if (this.invalidElements.length) {\n            this._invalidElementsAlert();\n        }\n        return $header;\n    },\n\n    /** render the middle including the elements */\n    _renderMiddle: function _renderMiddle(speed, callback) {\n        var $middle = this.$(\".middle\").empty().html(this.templates.middle());\n        this._renderList(speed);\n        return $middle;\n    },\n\n    /** add any jQuery/bootstrap/custom plugins to elements rendered */\n    _addPluginComponents: function _addPluginComponents() {\n        this.$(\".help-content i\").hoverhighlight(\".collection-creator\", this.highlightClr);\n    },\n\n    /** build and show an alert describing any elements that could not be included due to problems */\n    _invalidElementsAlert: function _invalidElementsAlert() {\n        this._showAlert(this.templates.invalidElements({\n            problems: this.invalidElements\n        }), \"alert-warning\");\n    },\n\n    _disableNameAndCreate: function _disableNameAndCreate(disable) {\n        disable = !_.isUndefined(disable) ? disable : true;\n        if (disable) {\n            this.$(\".collection-name\").prop(\"disabled\", true);\n            this.$(\".create-collection\").toggleClass(\"disabled\", true);\n            // } else {\n            //     this.$( '.collection-name' ).prop( 'disabled', false );\n            //     this.$( '.create-collection' ).removeClass( 'disable' );\n        }\n    },\n\n    // ------------------------------------------------------------------------ rendering elements\n    /** conv. to the main list display DOM */\n    $list: function $list() {\n        return this.$(\".collection-elements\");\n    },\n\n    /** show or hide the clear selected control based on the num of selected elements */\n    _renderClearSelected: function _renderClearSelected() {\n        if (_.size(this.selectedIds)) {\n            this.$(\".collection-elements-controls > .clear-selected\").show();\n        } else {\n            this.$(\".collection-elements-controls > .clear-selected\").hide();\n        }\n    },\n\n    /** render the elements in order (or a warning if no elements found) */\n    _renderList: function _renderList(speed, callback) {\n        //this.debug( '-- _renderList' );\n        var creator = this;\n\n        var $tmp = jQuery(\"<div/>\");\n        var $list = creator.$list();\n\n        _.each(this.elementViews, function (view) {\n            view.destroy();\n            creator.removeElementView(view);\n        });\n\n        // if( !this.workingElements.length ){\n        //     this._renderNoValidElements();\n        //     return;\n        // }\n\n        creator.workingElements.forEach(function (element) {\n            var elementView = creator._createElementView(element);\n            $tmp.append(elementView.$el);\n        });\n\n        creator._renderClearSelected();\n        $list.empty().append($tmp.children());\n        _.invoke(creator.elementViews, \"render\");\n\n        if ($list.height() > $list.css(\"max-height\")) {\n            $list.css(\"border-width\", \"1px 0px 1px 0px\");\n        } else {\n            $list.css(\"border-width\", \"0px\");\n        }\n    },\n\n    /** create an element view, cache in elementViews, set up listeners, and return */\n    _createElementView: function _createElementView(element) {\n        var elementView = new this.elementViewClass({\n            //TODO: use non-generic class or not all\n            // model : COLLECTION.DatasetDCE( element )\n            element: element,\n            selected: _.has(this.selectedIds, element.id)\n        });\n        this.elementViews.push(elementView);\n        this._listenToElementView(elementView);\n        return elementView;\n    },\n\n    /** listen to any element events */\n    _listenToElementView: function _listenToElementView(view) {\n        var creator = this;\n        creator.listenTo(view, {\n            select: function select(data) {\n                var element = data.source.element;\n                if (data.selected) {\n                    creator.selectedIds[element.id] = true;\n                } else {\n                    delete creator.selectedIds[element.id];\n                }\n                creator.trigger(\"elements:select\", data);\n            },\n            discard: function discard(data) {\n                creator.trigger(\"elements:discard\", data);\n            }\n        });\n    },\n\n    /** add a new element view based on the json in element */\n    addElementView: function addElementView(element) {\n        //TODO: workingElements is sorted, add element in appropo index\n        // add element, sort elements, find element index\n        // var view = this._createElementView( element );\n        // return view;\n    },\n\n    /** stop listening to view and remove from caches */\n    removeElementView: function removeElementView(view) {\n        delete this.selectedIds[view.element.id];\n        this._renderClearSelected();\n\n        this.elementViews = _.without(this.elementViews, view);\n        this.stopListening(view);\n    },\n\n    /** render a message in the list that no elements remain to create a collection */\n    _renderNoElementsLeft: function _renderNoElementsLeft() {\n        this._disableNameAndCreate(true);\n        this.$(\".collection-elements\").append(this.templates.noElementsLeft());\n    },\n\n    // /** render a message in the list that no valid elements were found to create a collection */\n    // _renderNoValidElements : function(){\n    //     this._disableNameAndCreate( true );\n    //     this.$( '.collection-elements' ).append( this.templates.noValidElements() );\n    // },\n\n    // ------------------------------------------------------------------------ API\n    /** convert element into JSON compatible with the collections API */\n    _elementToJSON: function _elementToJSON(element) {\n        // return element.toJSON();\n        return element;\n    },\n\n    /** create the collection via the API\n     *  @returns {jQuery.xhr Object} the jquery ajax request\n     */\n    createList: function createList(name) {\n        if (!this.workingElements.length) {\n            var message = (0, _localization2.default)(\"No valid elements for final list\") + \". \";\n            message += \"<a class=\\\"cancel-create\\\" href=\\\"javascript:void(0);\\\">\" + (0, _localization2.default)(\"Cancel\") + \"</a> \";\n            message += (0, _localization2.default)(\"or\");\n            message += \" <a class=\\\"reset\\\" href=\\\"javascript:void(0);\\\">\" + (0, _localization2.default)(\"start over\") + \"</a>.\";\n            this._showAlert(message);\n            return;\n        }\n\n        var creator = this;\n\n        var elements = this.workingElements.map(function (element) {\n            return creator._elementToJSON(element);\n        });\n\n        creator.blocking = true;\n        return creator.creationFn(elements, name, creator.hideOriginals).always(function () {\n            creator.blocking = false;\n        }).fail(function (xhr, status, message) {\n            creator.trigger(\"error\", {\n                xhr: xhr,\n                status: status,\n                message: (0, _localization2.default)(\"An error occurred while creating this collection\")\n            });\n        }).done(function (response, message, xhr) {\n            creator.trigger(\"collection:created\", response, message, xhr);\n            creator.metric(\"collection:created\", response);\n            if (typeof creator.oncreate === \"function\") {\n                creator.oncreate.call(this, response, message, xhr);\n            }\n        });\n    },\n\n    // ------------------------------------------------------------------------ events\n    /** set up event handlers on self */\n    _setUpBehaviors: function _setUpBehaviors() {\n        this.on(\"error\", this._errorHandler);\n\n        this.once(\"rendered\", function () {\n            this.trigger(\"rendered:initial\", this);\n        });\n\n        this.on(\"elements:select\", function (data) {\n            this._renderClearSelected();\n        });\n\n        this.on(\"elements:discard\", function (data) {\n            var element = data.source.element;\n            this.removeElementView(data.source);\n\n            this.workingElements = _.without(this.workingElements, element);\n            if (!this.workingElements.length) {\n                this._renderNoElementsLeft();\n            }\n        });\n\n        //this.on( 'all', function(){\n        //    this.info( arguments );\n        //});\n        return this;\n    },\n\n    /** handle errors with feedback and details to the user (if available) */\n    _errorHandler: function _errorHandler(data) {\n        this.error(data);\n\n        var creator = this;\n        var content = data.message || (0, _localization2.default)(\"An error occurred\");\n        if (data.xhr) {\n            var xhr = data.xhr;\n            var message = data.message;\n            if (xhr.readyState === 0 && xhr.status === 0) {\n                content += \": \" + (0, _localization2.default)(\"Galaxy could not be reached and may be updating.\") + (0, _localization2.default)(\" Try again in a few minutes.\");\n            } else if (xhr.responseJSON) {\n                content += \":<br /><pre>\" + JSON.stringify(xhr.responseJSON) + \"</pre>\";\n            } else {\n                content += \": \" + message;\n            }\n        }\n        creator._showAlert(content, \"alert-danger\");\n    },\n\n    events: {\n        // header\n        \"click .more-help\": \"_clickMoreHelp\",\n        \"click .less-help\": \"_clickLessHelp\",\n        \"click .main-help\": \"_toggleHelp\",\n        \"click .header .alert button\": \"_hideAlert\",\n\n        \"click .reset\": \"reset\",\n        \"click .clear-selected\": \"clearSelectedElements\",\n\n        // elements - selection\n        \"click .collection-elements\": \"clearSelectedElements\",\n\n        // elements - drop target\n        // 'dragenter .collection-elements': '_dragenterElements',\n        // 'dragleave .collection-elements': '_dragleaveElements',\n        \"dragover .collection-elements\": \"_dragoverElements\",\n        \"drop .collection-elements\": \"_dropElements\",\n\n        // these bubble up from the elements as custom events\n        \"collection-element.dragstart .collection-elements\": \"_elementDragstart\",\n        \"collection-element.dragend   .collection-elements\": \"_elementDragend\",\n\n        // footer\n        \"change .collection-name\": \"_changeName\",\n        \"keydown .collection-name\": \"_nameCheckForEnter\",\n        \"change .hide-originals\": \"_changeHideOriginals\",\n        \"click .cancel-create\": \"_cancelCreate\",\n        \"click .create-collection\": \"_clickCreate\" //,\n    },\n\n    // ........................................................................ elements\n    /** reset all data to the initial state */\n    reset: function reset() {\n        this._instanceSetUp();\n        this._elementsSetUp();\n        this.render();\n    },\n\n    /** deselect all elements */\n    clearSelectedElements: function clearSelectedElements(ev) {\n        this.$(\".collection-elements .collection-element\").removeClass(\"selected\");\n        this.$(\".collection-elements-controls > .clear-selected\").hide();\n    },\n\n    //_dragenterElements : function( ev ){\n    //    //this.debug( '_dragenterElements:', ev );\n    //},\n    //TODO: if selected are dragged out of the list area - remove the placeholder - cuz it won't work anyway\n    // _dragleaveElements : function( ev ){\n    //    //this.debug( '_dragleaveElements:', ev );\n    // },\n\n    /** track the mouse drag over the list adding a placeholder to show where the drop would occur */\n    _dragoverElements: function _dragoverElements(ev) {\n        //this.debug( '_dragoverElements:', ev );\n        ev.preventDefault();\n\n        var $list = this.$list();\n        this._checkForAutoscroll($list, ev.originalEvent.clientY);\n        var $nearest = this._getNearestElement(ev.originalEvent.clientY);\n\n        //TODO: no need to re-create - move instead\n        this.$(\".element-drop-placeholder\").remove();\n        var $placeholder = $('<div class=\"element-drop-placeholder\"></div>');\n        if (!$nearest.length) {\n            $list.append($placeholder);\n        } else {\n            $nearest.before($placeholder);\n        }\n    },\n\n    /** If the mouse is near enough to the list's top or bottom, scroll the list */\n    _checkForAutoscroll: function _checkForAutoscroll($element, y) {\n        var AUTOSCROLL_SPEED = 2;\n        var offset = $element.offset();\n        var scrollTop = $element.scrollTop();\n        var upperDist = y - offset.top;\n        var lowerDist = offset.top + $element.outerHeight() - y;\n        if (upperDist >= 0 && upperDist < this.autoscrollDist) {\n            $element.scrollTop(scrollTop - AUTOSCROLL_SPEED);\n        } else if (lowerDist >= 0 && lowerDist < this.autoscrollDist) {\n            $element.scrollTop(scrollTop + AUTOSCROLL_SPEED);\n        }\n    },\n\n    /** get the nearest element based on the mouse's Y coordinate.\n     *  If the y is at the end of the list, return an empty jQuery object.\n     */\n    _getNearestElement: function _getNearestElement(y) {\n        var WIGGLE = 4;\n\n        var lis = this.$(\".collection-elements li.collection-element\").toArray();\n\n        for (var i = 0; i < lis.length; i++) {\n            var $li = $(lis[i]);\n            var top = $li.offset().top;\n            var halfHeight = Math.floor($li.outerHeight() / 2) + WIGGLE;\n            if (top + halfHeight > y && top - halfHeight < y) {\n                return $li;\n            }\n        }\n        return $();\n    },\n\n    /** drop (dragged/selected elements) onto the list, re-ordering the internal list */\n    _dropElements: function _dropElements(ev) {\n        if (ev.originalEvent) {\n            ev = ev.originalEvent;\n        }\n        // both required for firefox\n        ev.preventDefault();\n        ev.dataTransfer.dropEffect = \"move\";\n\n        // insert before the nearest element or after the last.\n        var $nearest = this._getNearestElement(ev.clientY);\n        if ($nearest.length) {\n            this.$dragging.insertBefore($nearest);\n        } else {\n            // no nearest before - insert after last element\n            this.$dragging.insertAfter(this.$(\".collection-elements .collection-element\").last());\n        }\n        // resync the creator's list based on the new DOM order\n        this._syncOrderToDom();\n        return false;\n    },\n\n    /** resync the creator's list of elements based on the DOM order */\n    _syncOrderToDom: function _syncOrderToDom() {\n        var creator = this;\n        var newElements = [];\n        //TODO: doesn't seem wise to use the dom to store these - can't we sync another way?\n        this.$(\".collection-elements .collection-element\").each(function () {\n            var id = $(this).attr(\"data-element-id\");\n\n            var element = _.findWhere(creator.workingElements, {\n                id: id\n            });\n\n            if (element) {\n                newElements.push(element);\n            } else {\n                console.error(\"missing element: \", id);\n            }\n        });\n        this.workingElements = newElements;\n        this._renderList();\n    },\n\n    /** drag communication with element sub-views: dragstart */\n    _elementDragstart: function _elementDragstart(ev, element) {\n        // auto select the element causing the event and move all selected\n        element.select(true);\n        this.$dragging = this.$(\".collection-elements .collection-element.selected\");\n    },\n\n    /** drag communication with element sub-views: dragend - remove the placeholder */\n    _elementDragend: function _elementDragend(ev, element) {\n        $(\".element-drop-placeholder\").remove();\n        this.$dragging = null;\n    },\n\n    // ------------------------------------------------------------------------ templates\n    //TODO: move to require text plugin and load these as text\n    //TODO: underscore currently unnecc. bc no vars are used\n    //TODO: better way of localizing text-nodes in long strings\n    /** underscore template fns attached to class */\n    templates: _.extend({}, _baseCreator2.default.CollectionCreatorMixin._creatorTemplates, {\n        /** the header (not including help text) */\n        header: _.template(['<div class=\"main-help well clear\">', '<a class=\"more-help\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"More help\"), \"</a>\", '<div class=\"help-content\">', '<a class=\"less-help\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Less\"), \"</a>\", \"</div>\", \"</div>\", '<div class=\"alert alert-dismissable\">', '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" ', 'title=\"', (0, _localization2.default)(\"Close and show more help\"), '\" aria-hidden=\"true\">&times;</button>', '<span class=\"alert-message\"></span>', \"</div>\"].join(\"\")),\n\n        /** the middle: element list */\n        middle: _.template(['<div class=\"collection-elements-controls\">', '<a class=\"reset\" href=\"javascript:void(0);\" ', 'title=\"', (0, _localization2.default)(\"Undo all reordering and discards\"), '\">', (0, _localization2.default)(\"Start over\"), \"</a>\", '<a class=\"clear-selected\" href=\"javascript:void(0);\" ', 'title=\"', (0, _localization2.default)(\"De-select all selected datasets\"), '\">', (0, _localization2.default)(\"Clear selected\"), \"</a>\", \"</div>\", '<div class=\"collection-elements scroll-container flex-row\">', \"</div>\"].join(\"\")),\n\n        /** creation and cancel controls */\n        footer: _.template(['<div class=\"attributes clear\">', '<div class=\"clear\">', '<label class=\"setting-prompt pull-right\">', (0, _localization2.default)(\"Hide original elements\"), \"?\", '<input class=\"hide-originals pull-right\" type=\"checkbox\" />', \"</label>\", \"</div>\", '<div class=\"clear\">', '<input class=\"collection-name form-control pull-right\" ', 'placeholder=\"', (0, _localization2.default)(\"Enter a name for your new collection\"), '\" />', '<div class=\"collection-name-prompt pull-right\">', (0, _localization2.default)(\"Name\"), \":</div>\", \"</div>\", \"</div>\", '<div class=\"actions clear vertically-spaced\">', '<div class=\"other-options pull-left\">', '<button class=\"cancel-create btn\" tabindex=\"-1\">', (0, _localization2.default)(\"Cancel\"), \"</button>\", '<div class=\"create-other btn-group dropup\">', '<button class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">', (0, _localization2.default)(\"Create a different kind of collection\"), ' <span class=\"caret\"></span>', \"</button>\", '<ul class=\"dropdown-menu\" role=\"menu\">', '<li><a href=\"#\">', (0, _localization2.default)(\"Create a <i>single</i> pair\"), \"</a></li>\", '<li><a href=\"#\">', (0, _localization2.default)(\"Create a list of <i>unpaired</i> datasets\"), \"</a></li>\", \"</ul>\", \"</div>\", \"</div>\", '<div class=\"main-options pull-right\">', '<button class=\"create-collection btn btn-primary\">', (0, _localization2.default)(\"Create list\"), \"</button>\", \"</div>\", \"</div>\"].join(\"\")),\n\n        /** help content */\n        helpContent: _.template([\"<p>\", (0, _localization2.default)([\"Collections of datasets are permanent, ordered lists of datasets that can be passed to tools and \", \"workflows in order to have analyses done on each member of the entire group. This interface allows \", \"you to create a collection and re-order the final collection.\"].join(\"\")), \"</p>\", \"<ul>\", \"<li>\", (0, _localization2.default)([\"Rename elements in the list by clicking on \", '<i data-target=\".collection-element .name\">the existing name</i>.'].join(\"\")), \"</li>\", \"<li>\", (0, _localization2.default)([\"Discard elements from the final created list by clicking on the \", '<i data-target=\".collection-element .discard\">\"Discard\"</i> button.'].join(\"\")), \"</li>\", \"<li>\", (0, _localization2.default)([\"Reorder the list by clicking and dragging elements. Select multiple elements by clicking on \", '<i data-target=\".collection-element\">them</i> and you can then move those selected by dragging the ', \"entire group. Deselect them by clicking them again or by clicking the \", 'the <i data-target=\".clear-selected\">\"Clear selected\"</i> link.'].join(\"\")), \"</li>\", \"<li>\", (0, _localization2.default)(['Click the <i data-target=\".reset\">\"Start over\"</i> link to begin again as if you had just opened ', \"the interface.\"].join(\"\")), \"</li>\", \"<li>\", (0, _localization2.default)(['Click the <i data-target=\".cancel-create\">\"Cancel\"</i> button to exit the interface.'].join(\"\")), \"</li>\", \"</ul><br />\", \"<p>\", (0, _localization2.default)(['Once your collection is complete, enter a <i data-target=\".collection-name\">name</i> and ', 'click <i data-target=\".create-collection\">\"Create list\"</i>.'].join(\"\")), \"</p>\"].join(\"\")),\n\n        /** shown in list when all elements are discarded */\n        invalidElements: _.template([(0, _localization2.default)(\"The following selections could not be included due to problems:\"), \"<ul><% _.each( problems, function( problem ){ %>\", \"<li><b><%- problem.element.name %></b>: <%- problem.text %></li>\", \"<% }); %></ul>\"].join(\"\")),\n\n        /** shown in list when all elements are discarded */\n        noElementsLeft: _.template(['<li class=\"no-elements-left-message\">', (0, _localization2.default)(\"No elements left! \"), (0, _localization2.default)(\"Would you like to \"), '<a class=\"reset\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"start over\"), \"</a>?\", \"</li>\"].join(\"\")),\n\n        /** a simplified page communicating what went wrong and why the user needs to reselect something else */\n        invalidInitial: _.template(['<div class=\"header flex-row no-flex\">', '<div class=\"alert alert-warning\" style=\"display: block\">', '<span class=\"alert-message\">', \"<% if( _.size( problems ) ){ %>\", (0, _localization2.default)(\"The following selections could not be included due to problems\"), \":\", \"<ul><% _.each( problems, function( problem ){ %>\", \"<li><b><%- problem.element.name %></b>: <%- problem.text %></li>\", \"<% }); %></ul>\", \"<% } else if( _.size( elements ) < 1 ){ %>\", (0, _localization2.default)(\"No datasets were selected\"), \".\", \"<% } %>\", \"<br />\", (0, _localization2.default)(\"At least one element is needed for the collection\"), \". \", (0, _localization2.default)(\"You may need to \"), '<a class=\"cancel-create\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"cancel\"), \"</a> \", (0, _localization2.default)(\"and reselect new elements\"), \".\", \"</span>\", \"</div>\", \"</div>\", '<div class=\"footer flex-row no-flex\">', '<div class=\"actions clear vertically-spaced\">', '<div class=\"other-options pull-left\">', '<button class=\"cancel-create btn\" tabindex=\"-1\">', (0, _localization2.default)(\"Cancel\"), \"</button>\",\n        // _l( 'Create a different kind of collection' ),\n        \"</div>\", \"</div>\", \"</div>\"].join(\"\"))\n    }),\n\n    // ------------------------------------------------------------------------ misc\n    /** string rep */\n    toString: function toString() {\n        return \"ListCollectionCreator\";\n    }\n});\n\n//=============================================================================\n/** Create a modal and load its body with the given CreatorClass creator type\n *  @returns {Deferred} resolved when creator has built a collection.\n */\nvar collectionCreatorModal = function _collectionCreatorModal(elements, options, CreatorClass) {\n    var deferred = jQuery.Deferred();\n    var modal = Galaxy.modal || new _uiModal2.default.View();\n    var creator;\n\n    options = _.defaults(options || {}, {\n        elements: elements,\n        oncancel: function oncancel() {\n            modal.hide();\n            deferred.reject(\"cancelled\");\n        },\n        oncreate: function oncreate(creator, response) {\n            modal.hide();\n            deferred.resolve(response);\n        }\n    });\n\n    creator = new CreatorClass(options);\n    modal.show({\n        title: options.title || (0, _localization2.default)(\"Create a collection\"),\n        body: creator.$el,\n        width: \"80%\",\n        height: \"100%\",\n        closing_events: true\n    });\n    creator.render();\n    window._collectionCreator = creator;\n\n    //TODO: remove modal header\n    return deferred;\n};\n\n/** List collection flavor of collectionCreatorModal. */\nvar listCollectionCreatorModal = function _listCollectionCreatorModal(elements, options) {\n    options = options || {};\n    options.title = (0, _localization2.default)(\"Create a collection from a list of datasets\");\n    return collectionCreatorModal(elements, options, ListCollectionCreator);\n};\n\n//==============================================================================\n/** Use a modal to create a list collection, then add it to the given history contents.\n *  @returns {Deferred} resolved when the collection is added to the history.\n */\nfunction createListCollection(contents, defaultHideSourceItems) {\n    var elements = contents.toJSON();\n\n    var promise = listCollectionCreatorModal(elements, {\n        defaultHideSourceItems: defaultHideSourceItems,\n        creationFn: function creationFn(elements, name, hideSourceItems) {\n            elements = elements.map(function (element) {\n                return {\n                    id: element.id,\n                    name: element.name,\n\n                    //TODO: this allows for list:list even if the filter above does not - reconcile\n                    src: element.history_content_type === \"dataset\" ? \"hda\" : \"hdca\"\n                };\n            });\n            return contents.createHDCA(elements, \"list\", name, hideSourceItems);\n        }\n    });\n\n    return promise;\n}\n\n//==============================================================================\nexports.default = {\n    DatasetCollectionElementView: DatasetCollectionElementView,\n    ListCollectionCreator: ListCollectionCreator,\n\n    collectionCreatorModal: collectionCreatorModal,\n    listCollectionCreatorModal: listCollectionCreatorModal,\n    createListCollection: createListCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vbGlzdC1jb2xsZWN0aW9uLWNyZWF0b3IuanM/ZGNmZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSERDQSBmcm9tIFwibXZjL2hpc3RvcnkvaGRjYS1tb2RlbFwiO1xuaW1wb3J0IFNUQVRFUyBmcm9tIFwibXZjL2RhdGFzZXQvc3RhdGVzXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IGJhc2VDcmVhdG9yIGZyb20gXCJtdmMvY29sbGVjdGlvbi9iYXNlLWNyZWF0b3JcIjtcbmltcG9ydCBVSV9NT0RBTCBmcm9tIFwibXZjL3VpL3VpLW1vZGFsXCI7XG5pbXBvcnQgbmF0dXJhbFNvcnQgZnJvbSBcInV0aWxzL25hdHVyYWwtc29ydFwiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbmltcG9ydCBcInVpL2hvdmVyaGlnaGxpZ2h0XCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImNvbGxlY3Rpb25zXCI7XG5cbi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5UT0RPOlxuICAgIHVzZSBwcm9wZXIgRWxlbWVudCBtb2RlbCBhbmQgbm90IGp1c3QganNvblxuICAgIHN0cmFpZ2h0ZW4gb3V0IGNyZWF0ZUZuLCBjb2xsZWN0aW9uLmNyZWF0ZUhEQ0FcbiAgICBwb3NzaWJseSBzdG9wIHVzaW5nIG1vZGFscyBmb3IgdGhpc1xuICAgIEl0IHdvdWxkIGJlIG5lYXQgdG8gZG8gYSBkcmFnIGFuZCBkcm9wXG5cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4vKiogQSB2aWV3IGZvciBib3RoIERhdGFzZXREQ0VzIGFuZCBOZXN0ZWREQ0RDRXNcbiAqICAodGhpbmdzIHRoYXQgaW1wbGVtZW50IGNvbGxlY3Rpb24tbW9kZWw6RGF0YXNldENvbGxlY3Rpb25FbGVtZW50TWl4aW4pXG4gKi9cbnZhciBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKHtcbiAgICBfbG9nTmFtZXNwYWNlOiBsb2dOYW1lc3BhY2UsXG5cbiAgICAvL1RPRE86IHVzZSBwcm9wZXIgY2xhc3MgKERhdGFzZXREQ0Ugb3IgTmVzdGVkRENEQ0UgKG9yIHRoZSB1bmlvbiBvZiBib3RoKSlcbiAgICB0YWdOYW1lOiBcImxpXCIsXG4gICAgY2xhc3NOYW1lOiBcImNvbGxlY3Rpb24tZWxlbWVudFwiLFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBhdHRyaWJ1dGVzLmVsZW1lbnQgfHwge307XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBhdHRyaWJ1dGVzLnNlbGVjdGVkIHx8IGZhbHNlO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmRyYWdTdGFydEhhbmRsZXIgPSBfLmJpbmQodGhpcy5fZHJhZ3N0YXJ0LCB0aGlzKTtcbiAgICAgICAgdGhpcy5kcmFnRW5kSGFuZGxlciA9IF8uYmluZCh0aGlzLl9kcmFnZW5kLCB0aGlzKTtcbiAgICAgICAgdmFyIGhhbmRsZSA9IHRoaXMuJGVsXG4gICAgICAgICAgICAuYXR0cihcImRhdGEtZWxlbWVudC1pZFwiLCB0aGlzLmVsZW1lbnQuaWQpXG4gICAgICAgICAgICAuYXR0cihcImRyYWdnYWJsZVwiLCB0cnVlKVxuICAgICAgICAgICAgLmh0bWwodGhpcy50ZW1wbGF0ZSh7IGVsZW1lbnQ6IHRoaXMuZWxlbWVudCB9KSlcbiAgICAgICAgICAgIC5nZXQoMCk7XG4gICAgICAgIGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlciwgZmFsc2UpO1xuICAgICAgICBoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbmRcIiwgdGhpcy5kcmFnRW5kSGFuZGxlciwgZmFsc2UpO1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy4kZWwuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLy9UT0RPOiBsb3RzIG9mIHVudXNlZCBzcGFjZSBpbiB0aGUgZWxlbWVudCAtIHBvc3NpYmx5IGxvYWQgZGV0YWlscyBhbmQgZGlzcGxheSB0aGVtIGhvcml6LlxuICAgIHRlbXBsYXRlOiBfLnRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICAnPGEgY2xhc3M9XCJuYW1lXCIgdGl0bGU9XCInLFxuICAgICAgICAgICAgX2woXCJDbGljayB0byByZW5hbWVcIiksXG4gICAgICAgICAgICAnXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsXG4gICAgICAgICAgICBcIjwlLSBlbGVtZW50Lm5hbWUgJT5cIixcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJkaXNjYXJkIGJ0biBidG4tc21cIiB0aXRsZT1cIicsXG4gICAgICAgICAgICBfbChcIlJlbW92ZSB0aGlzIGRhdGFzZXQgZnJvbSB0aGUgbGlzdFwiKSxcbiAgICAgICAgICAgICdcIj4nLFxuICAgICAgICAgICAgX2woXCJEaXNjYXJkXCIpLFxuICAgICAgICAgICAgXCI8L2J1dHRvbj5cIlxuICAgICAgICBdLmpvaW4oXCJcIilcbiAgICApLFxuXG4gICAgLyoqIHNlbGVjdCB0aGlzIGVsZW1lbnQgYW5kIHB1YiAqL1xuICAgIHNlbGVjdDogZnVuY3Rpb24odG9nZ2xlKSB7XG4gICAgICAgIHRoaXMuJGVsLnRvZ2dsZUNsYXNzKFwic2VsZWN0ZWRcIiwgdG9nZ2xlKTtcbiAgICAgICAgdGhpcy50cmlnZ2VyKFwic2VsZWN0XCIsIHtcbiAgICAgICAgICAgIHNvdXJjZTogdGhpcyxcbiAgICAgICAgICAgIHNlbGVjdGVkOiB0aGlzLiRlbC5oYXNDbGFzcyhcInNlbGVjdGVkXCIpXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogYW5pbWF0ZSB0aGUgcmVtb3ZhbCBvZiB0aGlzIGVsZW1lbnQgYW5kIHB1YiAqL1xuICAgIGRpc2NhcmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgIHZhciBwYXJlbnRXaWR0aCA9IHRoaXMuJGVsLnBhcmVudCgpLndpZHRoKCk7XG4gICAgICAgIHRoaXMuJGVsLmFuaW1hdGUoeyBcIm1hcmdpbi1yaWdodFwiOiBwYXJlbnRXaWR0aCB9LCBcImZhc3RcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdmlldy50cmlnZ2VyKFwiZGlzY2FyZFwiLCB7XG4gICAgICAgICAgICAgICAgc291cmNlOiB2aWV3XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZpZXcuZGVzdHJveSgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIHJlbW92ZSB0aGUgRE9NIGFuZCBhbnkgbGlzdGVuZXJzICovXG4gICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMub2ZmKCk7XG4gICAgICAgIHRoaXMuJGVsLnJlbW92ZSgpO1xuICAgIH0sXG5cbiAgICBldmVudHM6IHtcbiAgICAgICAgY2xpY2s6IFwiX2NsaWNrXCIsXG4gICAgICAgIFwiY2xpY2sgLm5hbWVcIjogXCJfY2xpY2tOYW1lXCIsXG4gICAgICAgIFwiY2xpY2sgLmRpc2NhcmRcIjogXCJfY2xpY2tEaXNjYXJkXCIsXG5cbiAgICAgICAgZHJhZ292ZXI6IFwiX3NlbmRUb1BhcmVudFwiLFxuICAgICAgICBkcm9wOiBcIl9zZW5kVG9QYXJlbnRcIlxuICAgIH0sXG5cbiAgICAvKiogc2VsZWN0IHdoZW4gdGhlIGxpIGlzIGNsaWNrZWQgKi9cbiAgICBfY2xpY2s6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB0aGlzLnNlbGVjdChldik7XG4gICAgfSxcblxuICAgIC8qKiByZW5hbWUgYSBwYWlyIHdoZW4gdGhlIG5hbWUgaXMgY2xpY2tlZCAqL1xuICAgIF9jbGlja05hbWU6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHZhciBwcm9tcHRTdHJpbmcgPSBbXG4gICAgICAgICAgICBfbChcIkVudGVyIGEgbmV3IG5hbWUgZm9yIHRoZSBlbGVtZW50XCIpLFxuICAgICAgICAgICAgXCI6XFxuKFwiLFxuICAgICAgICAgICAgX2woXCJOb3RlIHRoYXQgY2hhbmdpbmcgdGhlIG5hbWUgaGVyZSB3aWxsIG5vdCByZW5hbWUgdGhlIGRhdGFzZXRcIiksXG4gICAgICAgICAgICBcIilcIlxuICAgICAgICBdLmpvaW4oXCJcIik7XG5cbiAgICAgICAgdmFyIHJlc3BvbnNlID0gcHJvbXB0KGAke19sKFwiRW50ZXIgYSBuZXcgbmFtZSBmb3IgdGhlIGVsZW1lbnRcIil9OmAsIHRoaXMuZWxlbWVudC5uYW1lKTtcblxuICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5uYW1lID0gcmVzcG9uc2U7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgICAgIC8vVE9ETzogY2FuY2VsbGluZyB3aXRoIEVTQyBsZWFkcyB0byBjbG9zdXJlIG9mIHRoZSBjcmVhdG9yLi4uXG4gICAgfSxcblxuICAgIC8qKiBkaXNjYXJkIHdoZW4gdGhlIGRpc2NhcmQgYnV0dG9uIGlzIGNsaWNrZWQgKi9cbiAgICBfY2xpY2tEaXNjYXJkOiBmdW5jdGlvbihldikge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy5kaXNjYXJkKCk7XG4gICAgfSxcblxuICAgIC8qKiBkcmFnZ2luZyBwYWlycyBmb3IgcmUtb3JkZXJpbmcgKi9cbiAgICBfZHJhZ3N0YXJ0OiBmdW5jdGlvbihldikge1xuICAgICAgICBpZiAoZXYub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgZXYgPSBldi5vcmlnaW5hbEV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGV2LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XG4gICAgICAgIGV2LmRhdGFUcmFuc2Zlci5zZXREYXRhKFwidGV4dC9wbGFpblwiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmVsZW1lbnQpKTtcblxuICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhcImRyYWdnaW5nXCIpO1xuICAgICAgICB0aGlzLiRlbC5wYXJlbnQoKS50cmlnZ2VyKFwiY29sbGVjdGlvbi1lbGVtZW50LmRyYWdzdGFydFwiLCBbdGhpc10pO1xuICAgIH0sXG5cbiAgICAvKiogZHJhZ2dpbmcgZm9yIHJlLW9yZGVyaW5nICovXG4gICAgX2RyYWdlbmQ6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIHRoaXMuJGVsLnJlbW92ZUNsYXNzKFwiZHJhZ2dpbmdcIik7XG4gICAgICAgIHRoaXMuJGVsLnBhcmVudCgpLnRyaWdnZXIoXCJjb2xsZWN0aW9uLWVsZW1lbnQuZHJhZ2VuZFwiLCBbdGhpc10pO1xuICAgIH0sXG5cbiAgICAvKiogbWFudWFsbHkgYnViYmxlIHVwIGFuIGV2ZW50IHRvIHRoZSBwYXJlbnQvY29udGFpbmVyICovXG4gICAgX3NlbmRUb1BhcmVudDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgdGhpcy4kZWwucGFyZW50KCkudHJpZ2dlcihldik7XG4gICAgfSxcblxuICAgIC8qKiBzdHJpbmcgcmVwICovXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXCJEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRWaWV3KClcIjtcbiAgICB9XG59KTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEFuIGludGVyZmFjZSBmb3IgYnVpbGRpbmcgY29sbGVjdGlvbnMuXG4gKi9cbnZhciBMaXN0Q29sbGVjdGlvbkNyZWF0b3IgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZChCQVNFX01WQy5Mb2dnYWJsZU1peGluKVxuICAgIC5leHRlbmQoYmFzZUNyZWF0b3IuQ29sbGVjdGlvbkNyZWF0b3JNaXhpbilcbiAgICAuZXh0ZW5kKHtcbiAgICAgICAgX2xvZ05hbWVzcGFjZTogbG9nTmFtZXNwYWNlLFxuXG4gICAgICAgIC8qKiB0aGUgY2xhc3MgdXNlZCB0byBkaXNwbGF5IGluZGl2aWR1YWwgZWxlbWVudHMgKi9cbiAgICAgICAgZWxlbWVudFZpZXdDbGFzczogRGF0YXNldENvbGxlY3Rpb25FbGVtZW50VmlldyxcbiAgICAgICAgLyoqIHRoZSBjbGFzcyB0aGlzIGNyZWF0b3Igd2lsbCBjcmVhdGUgYW5kIHNhdmUgKi9cbiAgICAgICAgY29sbGVjdGlvbkNsYXNzOiBIRENBLkhpc3RvcnlEYXRhc2V0Q29sbGVjdGlvbixcbiAgICAgICAgY2xhc3NOYW1lOiBcImxpc3QtY29sbGVjdGlvbi1jcmVhdG9yIGNvbGxlY3Rpb24tY3JlYXRvciBmbGV4LXJvdy1jb250YWluZXJcIixcblxuICAgICAgICAvKiogbWluaW11bSBudW1iZXIgb2YgdmFsaWQgZWxlbWVudHMgdG8gc3RhcnQgd2l0aCBpbiBvcmRlciB0byBidWlsZCBhIGNvbGxlY3Rpb24gb2YgdGhpcyB0eXBlICovXG4gICAgICAgIG1pbkVsZW1lbnRzOiAxLFxuXG4gICAgICAgIGRlZmF1bHRBdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgICAvL1RPRE86IHJlbW92ZSAtIHVzZSBuZXcgY29sbGVjdGlvbkNsYXNzKCkuc2F2ZSgpXG4gICAgICAgICAgICAvKiogdGFrZXMgZWxlbWVudHMgYW5kIGNyZWF0ZXMgdGhlIHByb3BlciBjb2xsZWN0aW9uIC0gcmV0dXJucyBhIHByb21pc2UgKi9cbiAgICAgICAgICAgIGNyZWF0aW9uRm46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJubyBjcmVhdGlvbiBmbiBmb3IgY3JlYXRvclwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKiogZm4gdG8gY2FsbCB3aGVuIHRoZSBjb2xsZWN0aW9uIGlzIGNyZWF0ZWQgKHNjb3BlZCB0byB0aGlzKSAqL1xuICAgICAgICAgICAgb25jcmVhdGU6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICAvKiogZm4gdG8gY2FsbCB3aGVuIHRoZSBjYW5jZWwgYnV0dG9uIGlzIGNsaWNrZWQgKHNjb3BlZCB0byB0aGlzKSAtIGlmIGZhbHN5LCBubyBidG4gaXMgZGlzcGxheWVkICovXG4gICAgICAgICAgICBvbmNhbmNlbDogZnVuY3Rpb24oKSB7fSxcbiAgICAgICAgICAgIC8qKiBkaXN0YW5jZSBmcm9tIGxpc3QgZWRnZSB0byBiZWdpbiBhdXRvc2Nyb2xsaW5nIGxpc3QgKi9cbiAgICAgICAgICAgIGF1dG9zY3JvbGxEaXN0OiAyNCxcbiAgICAgICAgICAgIC8qKiBDb2xvciBwYXNzZWQgdG8gaG92ZXJoaWdobGlnaHQgKi9cbiAgICAgICAgICAgIGhpZ2hsaWdodENscjogXCJyZ2JhKCA2NCwgMjU1LCAyNTUsIDEuMCApXCJcbiAgICAgICAgfSxcblxuICAgICAgICBmb290ZXJTZXR0aW5nczoge1xuICAgICAgICAgICAgXCIuaGlkZS1vcmlnaW5hbHNcIjogXCJoaWRlT3JpZ2luYWxzXCJcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2V0IHVwIGluaXRpYWwgb3B0aW9ucywgaW5zdGFuY2UgdmFycywgYmVoYXZpb3JzICovXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHRoaXMubWV0cmljKFwiTGlzdENvbGxlY3Rpb25DcmVhdG9yLmluaXRpYWxpemVcIiwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IHRoaXM7XG4gICAgICAgICAgICBfLmVhY2godGhpcy5kZWZhdWx0QXR0cmlidXRlcywgKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGF0dHJpYnV0ZXNba2V5XSB8fCB2YWx1ZTtcbiAgICAgICAgICAgICAgICBjcmVhdG9yW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvKiogdW5vcmRlcmVkLCBvcmlnaW5hbCBsaXN0IC0gY2FjaGUgdG8gYWxsb3cgcmV2ZXJzYWwgKi9cbiAgICAgICAgICAgIGNyZWF0b3IuaW5pdGlhbEVsZW1lbnRzID0gYXR0cmlidXRlcy5lbGVtZW50cyB8fCBbXTtcblxuICAgICAgICAgICAgdGhpcy5fc2V0VXBDb21tb25TZXR0aW5ncyhhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlU2V0VXAoKTtcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzU2V0VXAoKTtcbiAgICAgICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNldCB1cCBpbnN0YW5jZSB2YXJzICovXG4gICAgICAgIF9pbnN0YW5jZVNldFVwOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8qKiBJZHMgb2YgZWxlbWVudHMgdGhhdCBoYXZlIGJlZW4gc2VsZWN0ZWQgYnkgdGhlIHVzZXIgLSB0byBwcmVzZXJ2ZSBvdmVyIHJlbmRlcnMgKi9cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJZHMgPSB7fTtcbiAgICAgICAgICAgIC8qKiBET00gZWxlbWVudHMgY3VycmVudGx5IGJlaW5nIGRyYWdnZWQgKi9cbiAgICAgICAgICAgIHRoaXMuJGRyYWdnaW5nID0gbnVsbDtcbiAgICAgICAgICAgIC8qKiBVc2VkIGZvciBibG9ja2luZyBVSSBldmVudHMgZHVyaW5nIGFqYXgvb3BlcmF0aW9ucyAoZG9uJ3QgcG9zdCB0d2ljZSkgKi9cbiAgICAgICAgICAgIHRoaXMuYmxvY2tpbmcgPSBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcHJvY2VzcyByYXcgbGlzdFxuICAgICAgICAvKiogc2V0IHVwIG1haW4gZGF0YSAqL1xuICAgICAgICBfZWxlbWVudHNTZXRVcDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSBfZGF0YVNldFVwJyApO1xuICAgICAgICAgICAgLyoqIGEgbGlzdCBvZiBpbnZhbGlkIGVsZW1lbnRzIGFuZCB0aGUgcmVhc29ucyB0aGV5IGFyZW4ndCB2YWxpZCAqL1xuICAgICAgICAgICAgdGhpcy5pbnZhbGlkRWxlbWVudHMgPSBbXTtcbiAgICAgICAgICAgIC8vVE9ETzogaGFuZGxlIGZ1bmRhbWVudGFsIHByb2JsZW0gb2Ygc3luY2luZyBET00sIHZpZXdzLCBhbmQgbGlzdCBoZXJlXG4gICAgICAgICAgICAvKiogZGF0YSBmb3IgbGlzdCBpbiBwcm9ncmVzcyAqL1xuICAgICAgICAgICAgdGhpcy53b3JraW5nRWxlbWVudHMgPSBbXTtcbiAgICAgICAgICAgIC8qKiB2aWV3cyBmb3Igd29ya2luZ0VsZW1lbnRzICovXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRWaWV3cyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBjb3B5IGluaXRpYWwgbGlzdCwgc29ydCwgYWRkIGlkcyBpZiBuZWVkZWRcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0VsZW1lbnRzID0gdGhpcy5pbml0aWFsRWxlbWVudHMuc2xpY2UoMCk7XG4gICAgICAgICAgICB0aGlzLl9lbnN1cmVFbGVtZW50SWRzKCk7XG4gICAgICAgICAgICB0aGlzLl92YWxpZGF0ZUVsZW1lbnRzKCk7XG4gICAgICAgICAgICB0aGlzLl9tYW5nbGVEdXBsaWNhdGVOYW1lcygpO1xuICAgICAgICAgICAgdGhpcy5fc29ydEVsZW1lbnRzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGFkZCBpZHMgdG8gZGF0YXNldCBvYmpzIGluIGluaXRpYWwgbGlzdCBpZiBub25lICovXG4gICAgICAgIF9lbnN1cmVFbGVtZW50SWRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0VsZW1lbnRzLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFlbGVtZW50Lmhhc093blByb3BlcnR5KFwiaWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9IF8udW5pcXVlSWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndvcmtpbmdFbGVtZW50cztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2VwYXJhdGUgd29ya2luZyBsaXN0IGludG8gdmFsaWQgYW5kIGludmFsaWQgZWxlbWVudHMgZm9yIHRoaXMgY29sbGVjdGlvbiAqL1xuICAgICAgICBfdmFsaWRhdGVFbGVtZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdOYW1lcyA9IHt9O1xuICAgICAgICAgICAgY3JlYXRvci5pbnZhbGlkRWxlbWVudHMgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy53b3JraW5nRWxlbWVudHMgPSB0aGlzLndvcmtpbmdFbGVtZW50cy5maWx0ZXIoZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHByb2JsZW0gPSBjcmVhdG9yLl9pc0VsZW1lbnRJbnZhbGlkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGlmIChwcm9ibGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0b3IuaW52YWxpZEVsZW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHByb2JsZW1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhcHJvYmxlbTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMud29ya2luZ0VsZW1lbnRzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBkZXNjcmliZSB3aGF0IGlzIHdyb25nIHdpdGggYSBwYXJ0aWN1bGFyIGVsZW1lbnQgaWYgYW55dGhpbmcgKi9cbiAgICAgICAgX2lzRWxlbWVudEludmFsaWQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50Lmhpc3RvcnlfY29udGVudF90eXBlID09PSBcImRhdGFzZXRfY29sbGVjdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9sKFwiaXMgYSBjb2xsZWN0aW9uLCB0aGlzIGlzIG5vdCBhbGxvd2VkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbGlkU3RhdGUgPSBlbGVtZW50LnN0YXRlID09PSBTVEFURVMuT0sgfHwgXy5jb250YWlucyhTVEFURVMuTk9UX1JFQURZX1NUQVRFUywgZWxlbWVudC5zdGF0ZSk7XG4gICAgICAgICAgICBpZiAoIXZhbGlkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2woXCJoYXMgZXJyb3JlZCwgaXMgcGF1c2VkLCBvciBpcyBub3QgYWNjZXNzaWJsZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbGVtZW50LmRlbGV0ZWQgfHwgZWxlbWVudC5wdXJnZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2woXCJoYXMgYmVlbiBkZWxldGVkIG9yIHB1cmdlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBtYW5nbGUgZHVwbGljYXRlIG5hbWVzIHVzaW5nIGEgbWFjLWxpa2UgJyhjb3VudGVyKScgYWRkaXRpb24gdG8gYW55IGR1cGxpY2F0ZXMgKi9cbiAgICAgICAgX21hbmdsZUR1cGxpY2F0ZU5hbWVzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBTQUZFVFkgPSA5MDA7XG4gICAgICAgICAgICB2YXIgY291bnRlciA9IDE7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdOYW1lcyA9IHt9O1xuICAgICAgICAgICAgdGhpcy53b3JraW5nRWxlbWVudHMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgY3Vyck5hbWUgPSBlbGVtZW50Lm5hbWU7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGV4aXN0aW5nTmFtZXMuaGFzT3duUHJvcGVydHkoY3Vyck5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJOYW1lID0gYCR7ZWxlbWVudC5uYW1lfSAoJHtjb3VudGVyfSlgO1xuICAgICAgICAgICAgICAgICAgICBjb3VudGVyICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb3VudGVyID49IFNBRkVUWSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2FmZXR5IGhpdCBpbiB3aGlsZSBsb29wIC0gdGhhdHMgaW1wcmVzc2l2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbGVtZW50Lm5hbWUgPSBjdXJyTmFtZTtcbiAgICAgICAgICAgICAgICBleGlzdGluZ05hbWVzW2VsZW1lbnQubmFtZV0gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNvcnQgYSBsaXN0IG9mIGVsZW1lbnRzICovXG4gICAgICAgIF9zb3J0RWxlbWVudHM6IGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgICAgIC8vIC8vIGN1cnJlbnRseSBvbmx5IG5hdHVyYWwgc29ydCBieSBuYW1lXG4gICAgICAgICAgICAvLyB0aGlzLndvcmtpbmdFbGVtZW50cy5zb3J0KCBmdW5jdGlvbiggYSwgYiApeyByZXR1cm4gbmF0dXJhbFNvcnQoIGEubmFtZSwgYi5uYW1lICk7IH0pO1xuICAgICAgICAgICAgLy8gcmV0dXJuIHRoaXMud29ya2luZ0VsZW1lbnRzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSByZW5kZXJpbmdcbiAgICAgICAgLy8gdGVtcGxhdGVzIDogTGlzdENvbGxlY3Rpb25DcmVhdG9yLnRlbXBsYXRlcyxcbiAgICAgICAgLyoqIHJlbmRlciB0aGUgZW50aXJlIGludGVyZmFjZSAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKHNwZWVkLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnLS0gX3JlbmRlcicgKTtcbiAgICAgICAgICAgIGlmICh0aGlzLndvcmtpbmdFbGVtZW50cy5sZW5ndGggPCB0aGlzLm1pbkVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckludmFsaWQoc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kZWwuZW1wdHkoKS5odG1sKHRoaXMudGVtcGxhdGVzLm1haW4oKSk7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJIZWFkZXIoc3BlZWQpO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyTWlkZGxlKHNwZWVkKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckZvb3RlcihzcGVlZCk7XG4gICAgICAgICAgICB0aGlzLl9hZGRQbHVnaW5Db21wb25lbnRzKCk7XG4gICAgICAgICAgICB0aGlzLiQoXCIuY29sbGVjdGlvbi1uYW1lXCIpLmZvY3VzKCk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJyZW5kZXJlZFwiLCB0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgYSBzaW1wbGlmaWVkIGludGVyZmFjZSBhaW1lZCBhdCB0ZWxsaW5nIHRoZSB1c2VyIHdoeSB0aGV5IGNhbid0IG1vdmUgZm9yd2FyZCAqL1xuICAgICAgICBfcmVuZGVySW52YWxpZDogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSBfcmVuZGVyJyApO1xuICAgICAgICAgICAgdGhpcy4kZWwuZW1wdHkoKS5odG1sKFxuICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGVzLmludmFsaWRJbml0aWFsKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvYmxlbXM6IHRoaXMuaW52YWxpZEVsZW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50czogdGhpcy53b3JraW5nRWxlbWVudHNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5vbmNhbmNlbCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLmNhbmNlbC1jcmVhdGUuYnRuXCIpLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInJlbmRlcmVkXCIsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciB0aGUgaGVhZGVyIHNlY3Rpb24gKi9cbiAgICAgICAgX3JlbmRlckhlYWRlcjogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgJGhlYWRlciA9IHRoaXMuJChcIi5oZWFkZXJcIilcbiAgICAgICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgICAgIC5odG1sKHRoaXMudGVtcGxhdGVzLmhlYWRlcigpKVxuICAgICAgICAgICAgICAgIC5maW5kKFwiLmhlbHAtY29udGVudFwiKVxuICAgICAgICAgICAgICAgIC5wcmVwZW5kKCQodGhpcy50ZW1wbGF0ZXMuaGVscENvbnRlbnQoKSkpO1xuICAgICAgICAgICAgLy9UT0RPOiBzaG91bGQgb25seSBzaG93IG9uY2UgZGVzcGl0ZSBjYWxsaW5nIF9yZW5kZXJIZWFkZXIgYWdhaW5cbiAgICAgICAgICAgIGlmICh0aGlzLmludmFsaWRFbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnZhbGlkRWxlbWVudHNBbGVydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRoZWFkZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciB0aGUgbWlkZGxlIGluY2x1ZGluZyB0aGUgZWxlbWVudHMgKi9cbiAgICAgICAgX3JlbmRlck1pZGRsZTogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgJG1pZGRsZSA9IHRoaXMuJChcIi5taWRkbGVcIilcbiAgICAgICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgICAgIC5odG1sKHRoaXMudGVtcGxhdGVzLm1pZGRsZSgpKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckxpc3Qoc3BlZWQpO1xuICAgICAgICAgICAgcmV0dXJuICRtaWRkbGU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGFkZCBhbnkgalF1ZXJ5L2Jvb3RzdHJhcC9jdXN0b20gcGx1Z2lucyB0byBlbGVtZW50cyByZW5kZXJlZCAqL1xuICAgICAgICBfYWRkUGx1Z2luQ29tcG9uZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLiQoXCIuaGVscC1jb250ZW50IGlcIikuaG92ZXJoaWdobGlnaHQoXCIuY29sbGVjdGlvbi1jcmVhdG9yXCIsIHRoaXMuaGlnaGxpZ2h0Q2xyKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogYnVpbGQgYW5kIHNob3cgYW4gYWxlcnQgZGVzY3JpYmluZyBhbnkgZWxlbWVudHMgdGhhdCBjb3VsZCBub3QgYmUgaW5jbHVkZWQgZHVlIHRvIHByb2JsZW1zICovXG4gICAgICAgIF9pbnZhbGlkRWxlbWVudHNBbGVydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93QWxlcnQoXG4gICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMuaW52YWxpZEVsZW1lbnRzKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvYmxlbXM6IHRoaXMuaW52YWxpZEVsZW1lbnRzXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgXCJhbGVydC13YXJuaW5nXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2Rpc2FibGVOYW1lQW5kQ3JlYXRlOiBmdW5jdGlvbihkaXNhYmxlKSB7XG4gICAgICAgICAgICBkaXNhYmxlID0gIV8uaXNVbmRlZmluZWQoZGlzYWJsZSkgPyBkaXNhYmxlIDogdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkaXNhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLmNvbGxlY3Rpb24tbmFtZVwiKS5wcm9wKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLmNyZWF0ZS1jb2xsZWN0aW9uXCIpLnRvZ2dsZUNsYXNzKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy4kKCAnLmNvbGxlY3Rpb24tbmFtZScgKS5wcm9wKCAnZGlzYWJsZWQnLCBmYWxzZSApO1xuICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLiQoICcuY3JlYXRlLWNvbGxlY3Rpb24nICkucmVtb3ZlQ2xhc3MoICdkaXNhYmxlJyApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSByZW5kZXJpbmcgZWxlbWVudHNcbiAgICAgICAgLyoqIGNvbnYuIHRvIHRoZSBtYWluIGxpc3QgZGlzcGxheSBET00gKi9cbiAgICAgICAgJGxpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJChcIi5jb2xsZWN0aW9uLWVsZW1lbnRzXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBzaG93IG9yIGhpZGUgdGhlIGNsZWFyIHNlbGVjdGVkIGNvbnRyb2wgYmFzZWQgb24gdGhlIG51bSBvZiBzZWxlY3RlZCBlbGVtZW50cyAqL1xuICAgICAgICBfcmVuZGVyQ2xlYXJTZWxlY3RlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoXy5zaXplKHRoaXMuc2VsZWN0ZWRJZHMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLmNvbGxlY3Rpb24tZWxlbWVudHMtY29udHJvbHMgPiAuY2xlYXItc2VsZWN0ZWRcIikuc2hvdygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLiQoXCIuY29sbGVjdGlvbi1lbGVtZW50cy1jb250cm9scyA+IC5jbGVhci1zZWxlY3RlZFwiKS5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciB0aGUgZWxlbWVudHMgaW4gb3JkZXIgKG9yIGEgd2FybmluZyBpZiBubyBlbGVtZW50cyBmb3VuZCkgKi9cbiAgICAgICAgX3JlbmRlckxpc3Q6IGZ1bmN0aW9uKHNwZWVkLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnLS0gX3JlbmRlckxpc3QnICk7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciAkdG1wID0galF1ZXJ5KFwiPGRpdi8+XCIpO1xuICAgICAgICAgICAgdmFyICRsaXN0ID0gY3JlYXRvci4kbGlzdCgpO1xuXG4gICAgICAgICAgICBfLmVhY2godGhpcy5lbGVtZW50Vmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXcuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIGNyZWF0b3IucmVtb3ZlRWxlbWVudFZpZXcodmlldyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gaWYoICF0aGlzLndvcmtpbmdFbGVtZW50cy5sZW5ndGggKXtcbiAgICAgICAgICAgIC8vICAgICB0aGlzLl9yZW5kZXJOb1ZhbGlkRWxlbWVudHMoKTtcbiAgICAgICAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIGNyZWF0b3Iud29ya2luZ0VsZW1lbnRzLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRWaWV3ID0gY3JlYXRvci5fY3JlYXRlRWxlbWVudFZpZXcoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgJHRtcC5hcHBlbmQoZWxlbWVudFZpZXcuJGVsKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjcmVhdG9yLl9yZW5kZXJDbGVhclNlbGVjdGVkKCk7XG4gICAgICAgICAgICAkbGlzdC5lbXB0eSgpLmFwcGVuZCgkdG1wLmNoaWxkcmVuKCkpO1xuICAgICAgICAgICAgXy5pbnZva2UoY3JlYXRvci5lbGVtZW50Vmlld3MsIFwicmVuZGVyXCIpO1xuXG4gICAgICAgICAgICBpZiAoJGxpc3QuaGVpZ2h0KCkgPiAkbGlzdC5jc3MoXCJtYXgtaGVpZ2h0XCIpKSB7XG4gICAgICAgICAgICAgICAgJGxpc3QuY3NzKFwiYm9yZGVyLXdpZHRoXCIsIFwiMXB4IDBweCAxcHggMHB4XCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkbGlzdC5jc3MoXCJib3JkZXItd2lkdGhcIiwgXCIwcHhcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGNyZWF0ZSBhbiBlbGVtZW50IHZpZXcsIGNhY2hlIGluIGVsZW1lbnRWaWV3cywgc2V0IHVwIGxpc3RlbmVycywgYW5kIHJldHVybiAqL1xuICAgICAgICBfY3JlYXRlRWxlbWVudFZpZXc6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50VmlldyA9IG5ldyB0aGlzLmVsZW1lbnRWaWV3Q2xhc3Moe1xuICAgICAgICAgICAgICAgIC8vVE9ETzogdXNlIG5vbi1nZW5lcmljIGNsYXNzIG9yIG5vdCBhbGxcbiAgICAgICAgICAgICAgICAvLyBtb2RlbCA6IENPTExFQ1RJT04uRGF0YXNldERDRSggZWxlbWVudCApXG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogXy5oYXModGhpcy5zZWxlY3RlZElkcywgZWxlbWVudC5pZClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50Vmlld3MucHVzaChlbGVtZW50Vmlldyk7XG4gICAgICAgICAgICB0aGlzLl9saXN0ZW5Ub0VsZW1lbnRWaWV3KGVsZW1lbnRWaWV3KTtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50VmlldztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogbGlzdGVuIHRvIGFueSBlbGVtZW50IGV2ZW50cyAqL1xuICAgICAgICBfbGlzdGVuVG9FbGVtZW50VmlldzogZnVuY3Rpb24odmlldykge1xuICAgICAgICAgICAgdmFyIGNyZWF0b3IgPSB0aGlzO1xuICAgICAgICAgICAgY3JlYXRvci5saXN0ZW5Ubyh2aWV3LCB7XG4gICAgICAgICAgICAgICAgc2VsZWN0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZGF0YS5zb3VyY2UuZWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0b3Iuc2VsZWN0ZWRJZHNbZWxlbWVudC5pZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNyZWF0b3Iuc2VsZWN0ZWRJZHNbZWxlbWVudC5pZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY3JlYXRvci50cmlnZ2VyKFwiZWxlbWVudHM6c2VsZWN0XCIsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGlzY2FyZDogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdG9yLnRyaWdnZXIoXCJlbGVtZW50czpkaXNjYXJkXCIsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhZGQgYSBuZXcgZWxlbWVudCB2aWV3IGJhc2VkIG9uIHRoZSBqc29uIGluIGVsZW1lbnQgKi9cbiAgICAgICAgYWRkRWxlbWVudFZpZXc6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIC8vVE9ETzogd29ya2luZ0VsZW1lbnRzIGlzIHNvcnRlZCwgYWRkIGVsZW1lbnQgaW4gYXBwcm9wbyBpbmRleFxuICAgICAgICAgICAgLy8gYWRkIGVsZW1lbnQsIHNvcnQgZWxlbWVudHMsIGZpbmQgZWxlbWVudCBpbmRleFxuICAgICAgICAgICAgLy8gdmFyIHZpZXcgPSB0aGlzLl9jcmVhdGVFbGVtZW50VmlldyggZWxlbWVudCApO1xuICAgICAgICAgICAgLy8gcmV0dXJuIHZpZXc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHN0b3AgbGlzdGVuaW5nIHRvIHZpZXcgYW5kIHJlbW92ZSBmcm9tIGNhY2hlcyAqL1xuICAgICAgICByZW1vdmVFbGVtZW50VmlldzogZnVuY3Rpb24odmlldykge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuc2VsZWN0ZWRJZHNbdmlldy5lbGVtZW50LmlkXTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckNsZWFyU2VsZWN0ZWQoKTtcblxuICAgICAgICAgICAgdGhpcy5lbGVtZW50Vmlld3MgPSBfLndpdGhvdXQodGhpcy5lbGVtZW50Vmlld3MsIHZpZXcpO1xuICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKHZpZXcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgYSBtZXNzYWdlIGluIHRoZSBsaXN0IHRoYXQgbm8gZWxlbWVudHMgcmVtYWluIHRvIGNyZWF0ZSBhIGNvbGxlY3Rpb24gKi9cbiAgICAgICAgX3JlbmRlck5vRWxlbWVudHNMZWZ0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVOYW1lQW5kQ3JlYXRlKHRydWUpO1xuICAgICAgICAgICAgdGhpcy4kKFwiLmNvbGxlY3Rpb24tZWxlbWVudHNcIikuYXBwZW5kKHRoaXMudGVtcGxhdGVzLm5vRWxlbWVudHNMZWZ0KCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC8qKiByZW5kZXIgYSBtZXNzYWdlIGluIHRoZSBsaXN0IHRoYXQgbm8gdmFsaWQgZWxlbWVudHMgd2VyZSBmb3VuZCB0byBjcmVhdGUgYSBjb2xsZWN0aW9uICovXG4gICAgICAgIC8vIF9yZW5kZXJOb1ZhbGlkRWxlbWVudHMgOiBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgdGhpcy5fZGlzYWJsZU5hbWVBbmRDcmVhdGUoIHRydWUgKTtcbiAgICAgICAgLy8gICAgIHRoaXMuJCggJy5jb2xsZWN0aW9uLWVsZW1lbnRzJyApLmFwcGVuZCggdGhpcy50ZW1wbGF0ZXMubm9WYWxpZEVsZW1lbnRzKCkgKTtcbiAgICAgICAgLy8gfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQVBJXG4gICAgICAgIC8qKiBjb252ZXJ0IGVsZW1lbnQgaW50byBKU09OIGNvbXBhdGlibGUgd2l0aCB0aGUgY29sbGVjdGlvbnMgQVBJICovXG4gICAgICAgIF9lbGVtZW50VG9KU09OOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICAvLyByZXR1cm4gZWxlbWVudC50b0pTT04oKTtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBjcmVhdGUgdGhlIGNvbGxlY3Rpb24gdmlhIHRoZSBBUElcbiAgICAgICAgICogIEByZXR1cm5zIHtqUXVlcnkueGhyIE9iamVjdH0gdGhlIGpxdWVyeSBhamF4IHJlcXVlc3RcbiAgICAgICAgICovXG4gICAgICAgIGNyZWF0ZUxpc3Q6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy53b3JraW5nRWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBgJHtfbChcIk5vIHZhbGlkIGVsZW1lbnRzIGZvciBmaW5hbCBsaXN0XCIpfS4gYDtcbiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGA8YSBjbGFzcz1cImNhbmNlbC1jcmVhdGVcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPiR7X2woXCJDYW5jZWxcIil9PC9hPiBgO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gX2woXCJvclwiKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGAgPGEgY2xhc3M9XCJyZXNldFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JHtfbChcInN0YXJ0IG92ZXJcIil9PC9hPi5gO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dBbGVydChtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjcmVhdG9yID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gdGhpcy53b3JraW5nRWxlbWVudHMubWFwKGVsZW1lbnQgPT4gY3JlYXRvci5fZWxlbWVudFRvSlNPTihlbGVtZW50KSk7XG5cbiAgICAgICAgICAgIGNyZWF0b3IuYmxvY2tpbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0b3JcbiAgICAgICAgICAgICAgICAuY3JlYXRpb25GbihlbGVtZW50cywgbmFtZSwgY3JlYXRvci5oaWRlT3JpZ2luYWxzKVxuICAgICAgICAgICAgICAgIC5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdG9yLmJsb2NraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmFpbCgoeGhyLCBzdGF0dXMsIG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRvci50cmlnZ2VyKFwiZXJyb3JcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyOiB4aHIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF9sKFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY3JlYXRpbmcgdGhpcyBjb2xsZWN0aW9uXCIpXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2UsIG1lc3NhZ2UsIHhocikge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdG9yLnRyaWdnZXIoXCJjb2xsZWN0aW9uOmNyZWF0ZWRcIiwgcmVzcG9uc2UsIG1lc3NhZ2UsIHhocik7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0b3IubWV0cmljKFwiY29sbGVjdGlvbjpjcmVhdGVkXCIsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjcmVhdG9yLm9uY3JlYXRlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0b3Iub25jcmVhdGUuY2FsbCh0aGlzLCByZXNwb25zZSwgbWVzc2FnZSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBldmVudHNcbiAgICAgICAgLyoqIHNldCB1cCBldmVudCBoYW5kbGVycyBvbiBzZWxmICovXG4gICAgICAgIF9zZXRVcEJlaGF2aW9yczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm9uKFwiZXJyb3JcIiwgdGhpcy5fZXJyb3JIYW5kbGVyKTtcblxuICAgICAgICAgICAgdGhpcy5vbmNlKFwicmVuZGVyZWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwicmVuZGVyZWQ6aW5pdGlhbFwiLCB0aGlzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLm9uKFwiZWxlbWVudHM6c2VsZWN0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJDbGVhclNlbGVjdGVkKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5vbihcImVsZW1lbnRzOmRpc2NhcmRcIiwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZGF0YS5zb3VyY2UuZWxlbWVudDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUVsZW1lbnRWaWV3KGRhdGEuc291cmNlKTtcblxuICAgICAgICAgICAgICAgIHRoaXMud29ya2luZ0VsZW1lbnRzID0gXy53aXRob3V0KHRoaXMud29ya2luZ0VsZW1lbnRzLCBlbGVtZW50KTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud29ya2luZ0VsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJOb0VsZW1lbnRzTGVmdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvL3RoaXMub24oICdhbGwnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gICAgdGhpcy5pbmZvKCBhcmd1bWVudHMgKTtcbiAgICAgICAgICAgIC8vfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGFuZGxlIGVycm9ycyB3aXRoIGZlZWRiYWNrIGFuZCBkZXRhaWxzIHRvIHRoZSB1c2VyIChpZiBhdmFpbGFibGUpICovXG4gICAgICAgIF9lcnJvckhhbmRsZXI6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IoZGF0YSk7XG5cbiAgICAgICAgICAgIHZhciBjcmVhdG9yID0gdGhpcztcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gZGF0YS5tZXNzYWdlIHx8IF9sKFwiQW4gZXJyb3Igb2NjdXJyZWRcIik7XG4gICAgICAgICAgICBpZiAoZGF0YS54aHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgeGhyID0gZGF0YS54aHI7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSAwICYmIHhoci5zdGF0dXMgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgOiAke19sKFwiR2FsYXh5IGNvdWxkIG5vdCBiZSByZWFjaGVkIGFuZCBtYXkgYmUgdXBkYXRpbmcuXCIpfSR7X2woXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBUcnkgYWdhaW4gaW4gYSBmZXcgbWludXRlcy5cIlxuICAgICAgICAgICAgICAgICAgICApfWA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVzcG9uc2VKU09OKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDo8YnIgLz48cHJlPiR7SlNPTi5zdHJpbmdpZnkoeGhyLnJlc3BvbnNlSlNPTil9PC9wcmU+YDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA6ICR7bWVzc2FnZX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNyZWF0b3IuX3Nob3dBbGVydChjb250ZW50LCBcImFsZXJ0LWRhbmdlclwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgIC8vIGhlYWRlclxuICAgICAgICAgICAgXCJjbGljayAubW9yZS1oZWxwXCI6IFwiX2NsaWNrTW9yZUhlbHBcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLmxlc3MtaGVscFwiOiBcIl9jbGlja0xlc3NIZWxwXCIsXG4gICAgICAgICAgICBcImNsaWNrIC5tYWluLWhlbHBcIjogXCJfdG9nZ2xlSGVscFwiLFxuICAgICAgICAgICAgXCJjbGljayAuaGVhZGVyIC5hbGVydCBidXR0b25cIjogXCJfaGlkZUFsZXJ0XCIsXG5cbiAgICAgICAgICAgIFwiY2xpY2sgLnJlc2V0XCI6IFwicmVzZXRcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLmNsZWFyLXNlbGVjdGVkXCI6IFwiY2xlYXJTZWxlY3RlZEVsZW1lbnRzXCIsXG5cbiAgICAgICAgICAgIC8vIGVsZW1lbnRzIC0gc2VsZWN0aW9uXG4gICAgICAgICAgICBcImNsaWNrIC5jb2xsZWN0aW9uLWVsZW1lbnRzXCI6IFwiY2xlYXJTZWxlY3RlZEVsZW1lbnRzXCIsXG5cbiAgICAgICAgICAgIC8vIGVsZW1lbnRzIC0gZHJvcCB0YXJnZXRcbiAgICAgICAgICAgIC8vICdkcmFnZW50ZXIgLmNvbGxlY3Rpb24tZWxlbWVudHMnOiAnX2RyYWdlbnRlckVsZW1lbnRzJyxcbiAgICAgICAgICAgIC8vICdkcmFnbGVhdmUgLmNvbGxlY3Rpb24tZWxlbWVudHMnOiAnX2RyYWdsZWF2ZUVsZW1lbnRzJyxcbiAgICAgICAgICAgIFwiZHJhZ292ZXIgLmNvbGxlY3Rpb24tZWxlbWVudHNcIjogXCJfZHJhZ292ZXJFbGVtZW50c1wiLFxuICAgICAgICAgICAgXCJkcm9wIC5jb2xsZWN0aW9uLWVsZW1lbnRzXCI6IFwiX2Ryb3BFbGVtZW50c1wiLFxuXG4gICAgICAgICAgICAvLyB0aGVzZSBidWJibGUgdXAgZnJvbSB0aGUgZWxlbWVudHMgYXMgY3VzdG9tIGV2ZW50c1xuICAgICAgICAgICAgXCJjb2xsZWN0aW9uLWVsZW1lbnQuZHJhZ3N0YXJ0IC5jb2xsZWN0aW9uLWVsZW1lbnRzXCI6IFwiX2VsZW1lbnREcmFnc3RhcnRcIixcbiAgICAgICAgICAgIFwiY29sbGVjdGlvbi1lbGVtZW50LmRyYWdlbmQgICAuY29sbGVjdGlvbi1lbGVtZW50c1wiOiBcIl9lbGVtZW50RHJhZ2VuZFwiLFxuXG4gICAgICAgICAgICAvLyBmb290ZXJcbiAgICAgICAgICAgIFwiY2hhbmdlIC5jb2xsZWN0aW9uLW5hbWVcIjogXCJfY2hhbmdlTmFtZVwiLFxuICAgICAgICAgICAgXCJrZXlkb3duIC5jb2xsZWN0aW9uLW5hbWVcIjogXCJfbmFtZUNoZWNrRm9yRW50ZXJcIixcbiAgICAgICAgICAgIFwiY2hhbmdlIC5oaWRlLW9yaWdpbmFsc1wiOiBcIl9jaGFuZ2VIaWRlT3JpZ2luYWxzXCIsXG4gICAgICAgICAgICBcImNsaWNrIC5jYW5jZWwtY3JlYXRlXCI6IFwiX2NhbmNlbENyZWF0ZVwiLFxuICAgICAgICAgICAgXCJjbGljayAuY3JlYXRlLWNvbGxlY3Rpb25cIjogXCJfY2xpY2tDcmVhdGVcIiAvLyxcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gZWxlbWVudHNcbiAgICAgICAgLyoqIHJlc2V0IGFsbCBkYXRhIHRvIHRoZSBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlU2V0VXAoKTtcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzU2V0VXAoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGRlc2VsZWN0IGFsbCBlbGVtZW50cyAqL1xuICAgICAgICBjbGVhclNlbGVjdGVkRWxlbWVudHM6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICB0aGlzLiQoXCIuY29sbGVjdGlvbi1lbGVtZW50cyAuY29sbGVjdGlvbi1lbGVtZW50XCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgICAgICAgICB0aGlzLiQoXCIuY29sbGVjdGlvbi1lbGVtZW50cy1jb250cm9scyA+IC5jbGVhci1zZWxlY3RlZFwiKS5oaWRlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9fZHJhZ2VudGVyRWxlbWVudHMgOiBmdW5jdGlvbiggZXYgKXtcbiAgICAgICAgLy8gICAgLy90aGlzLmRlYnVnKCAnX2RyYWdlbnRlckVsZW1lbnRzOicsIGV2ICk7XG4gICAgICAgIC8vfSxcbiAgICAgICAgLy9UT0RPOiBpZiBzZWxlY3RlZCBhcmUgZHJhZ2dlZCBvdXQgb2YgdGhlIGxpc3QgYXJlYSAtIHJlbW92ZSB0aGUgcGxhY2Vob2xkZXIgLSBjdXogaXQgd29uJ3Qgd29yayBhbnl3YXlcbiAgICAgICAgLy8gX2RyYWdsZWF2ZUVsZW1lbnRzIDogZnVuY3Rpb24oIGV2ICl7XG4gICAgICAgIC8vICAgIC8vdGhpcy5kZWJ1ZyggJ19kcmFnbGVhdmVFbGVtZW50czonLCBldiApO1xuICAgICAgICAvLyB9LFxuXG4gICAgICAgIC8qKiB0cmFjayB0aGUgbW91c2UgZHJhZyBvdmVyIHRoZSBsaXN0IGFkZGluZyBhIHBsYWNlaG9sZGVyIHRvIHNob3cgd2hlcmUgdGhlIGRyb3Agd291bGQgb2NjdXIgKi9cbiAgICAgICAgX2RyYWdvdmVyRWxlbWVudHM6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICdfZHJhZ292ZXJFbGVtZW50czonLCBldiApO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgdmFyICRsaXN0ID0gdGhpcy4kbGlzdCgpO1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tGb3JBdXRvc2Nyb2xsKCRsaXN0LCBldi5vcmlnaW5hbEV2ZW50LmNsaWVudFkpO1xuICAgICAgICAgICAgdmFyICRuZWFyZXN0ID0gdGhpcy5fZ2V0TmVhcmVzdEVsZW1lbnQoZXYub3JpZ2luYWxFdmVudC5jbGllbnRZKTtcblxuICAgICAgICAgICAgLy9UT0RPOiBubyBuZWVkIHRvIHJlLWNyZWF0ZSAtIG1vdmUgaW5zdGVhZFxuICAgICAgICAgICAgdGhpcy4kKFwiLmVsZW1lbnQtZHJvcC1wbGFjZWhvbGRlclwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHZhciAkcGxhY2Vob2xkZXIgPSAkKCc8ZGl2IGNsYXNzPVwiZWxlbWVudC1kcm9wLXBsYWNlaG9sZGVyXCI+PC9kaXY+Jyk7XG4gICAgICAgICAgICBpZiAoISRuZWFyZXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRsaXN0LmFwcGVuZCgkcGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkbmVhcmVzdC5iZWZvcmUoJHBsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSWYgdGhlIG1vdXNlIGlzIG5lYXIgZW5vdWdoIHRvIHRoZSBsaXN0J3MgdG9wIG9yIGJvdHRvbSwgc2Nyb2xsIHRoZSBsaXN0ICovXG4gICAgICAgIF9jaGVja0ZvckF1dG9zY3JvbGw6IGZ1bmN0aW9uKCRlbGVtZW50LCB5KSB7XG4gICAgICAgICAgICB2YXIgQVVUT1NDUk9MTF9TUEVFRCA9IDI7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gJGVsZW1lbnQub2Zmc2V0KCk7XG4gICAgICAgICAgICB2YXIgc2Nyb2xsVG9wID0gJGVsZW1lbnQuc2Nyb2xsVG9wKCk7XG4gICAgICAgICAgICB2YXIgdXBwZXJEaXN0ID0geSAtIG9mZnNldC50b3A7XG4gICAgICAgICAgICB2YXIgbG93ZXJEaXN0ID0gb2Zmc2V0LnRvcCArICRlbGVtZW50Lm91dGVySGVpZ2h0KCkgLSB5O1xuICAgICAgICAgICAgaWYgKHVwcGVyRGlzdCA+PSAwICYmIHVwcGVyRGlzdCA8IHRoaXMuYXV0b3Njcm9sbERpc3QpIHtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5zY3JvbGxUb3Aoc2Nyb2xsVG9wIC0gQVVUT1NDUk9MTF9TUEVFRCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxvd2VyRGlzdCA+PSAwICYmIGxvd2VyRGlzdCA8IHRoaXMuYXV0b3Njcm9sbERpc3QpIHtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5zY3JvbGxUb3Aoc2Nyb2xsVG9wICsgQVVUT1NDUk9MTF9TUEVFRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGdldCB0aGUgbmVhcmVzdCBlbGVtZW50IGJhc2VkIG9uIHRoZSBtb3VzZSdzIFkgY29vcmRpbmF0ZS5cbiAgICAgICAgICogIElmIHRoZSB5IGlzIGF0IHRoZSBlbmQgb2YgdGhlIGxpc3QsIHJldHVybiBhbiBlbXB0eSBqUXVlcnkgb2JqZWN0LlxuICAgICAgICAgKi9cbiAgICAgICAgX2dldE5lYXJlc3RFbGVtZW50OiBmdW5jdGlvbih5KSB7XG4gICAgICAgICAgICB2YXIgV0lHR0xFID0gNDtcblxuICAgICAgICAgICAgdmFyIGxpcyA9IHRoaXMuJChcIi5jb2xsZWN0aW9uLWVsZW1lbnRzIGxpLmNvbGxlY3Rpb24tZWxlbWVudFwiKS50b0FycmF5KCk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyICRsaSA9ICQobGlzW2ldKTtcbiAgICAgICAgICAgICAgICB2YXIgdG9wID0gJGxpLm9mZnNldCgpLnRvcDtcbiAgICAgICAgICAgICAgICB2YXIgaGFsZkhlaWdodCA9IE1hdGguZmxvb3IoJGxpLm91dGVySGVpZ2h0KCkgLyAyKSArIFdJR0dMRTtcbiAgICAgICAgICAgICAgICBpZiAodG9wICsgaGFsZkhlaWdodCA+IHkgJiYgdG9wIC0gaGFsZkhlaWdodCA8IHkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRsaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBkcm9wIChkcmFnZ2VkL3NlbGVjdGVkIGVsZW1lbnRzKSBvbnRvIHRoZSBsaXN0LCByZS1vcmRlcmluZyB0aGUgaW50ZXJuYWwgbGlzdCAqL1xuICAgICAgICBfZHJvcEVsZW1lbnRzOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgaWYgKGV2Lm9yaWdpbmFsRXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldiA9IGV2Lm9yaWdpbmFsRXZlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBib3RoIHJlcXVpcmVkIGZvciBmaXJlZm94XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXYuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSBcIm1vdmVcIjtcblxuICAgICAgICAgICAgLy8gaW5zZXJ0IGJlZm9yZSB0aGUgbmVhcmVzdCBlbGVtZW50IG9yIGFmdGVyIHRoZSBsYXN0LlxuICAgICAgICAgICAgdmFyICRuZWFyZXN0ID0gdGhpcy5fZ2V0TmVhcmVzdEVsZW1lbnQoZXYuY2xpZW50WSk7XG4gICAgICAgICAgICBpZiAoJG5lYXJlc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kZHJhZ2dpbmcuaW5zZXJ0QmVmb3JlKCRuZWFyZXN0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbm8gbmVhcmVzdCBiZWZvcmUgLSBpbnNlcnQgYWZ0ZXIgbGFzdCBlbGVtZW50XG4gICAgICAgICAgICAgICAgdGhpcy4kZHJhZ2dpbmcuaW5zZXJ0QWZ0ZXIodGhpcy4kKFwiLmNvbGxlY3Rpb24tZWxlbWVudHMgLmNvbGxlY3Rpb24tZWxlbWVudFwiKS5sYXN0KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcmVzeW5jIHRoZSBjcmVhdG9yJ3MgbGlzdCBiYXNlZCBvbiB0aGUgbmV3IERPTSBvcmRlclxuICAgICAgICAgICAgdGhpcy5fc3luY09yZGVyVG9Eb20oKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmVzeW5jIHRoZSBjcmVhdG9yJ3MgbGlzdCBvZiBlbGVtZW50cyBiYXNlZCBvbiB0aGUgRE9NIG9yZGVyICovXG4gICAgICAgIF9zeW5jT3JkZXJUb0RvbTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgY3JlYXRvciA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbmV3RWxlbWVudHMgPSBbXTtcbiAgICAgICAgICAgIC8vVE9ETzogZG9lc24ndCBzZWVtIHdpc2UgdG8gdXNlIHRoZSBkb20gdG8gc3RvcmUgdGhlc2UgLSBjYW4ndCB3ZSBzeW5jIGFub3RoZXIgd2F5P1xuICAgICAgICAgICAgdGhpcy4kKFwiLmNvbGxlY3Rpb24tZWxlbWVudHMgLmNvbGxlY3Rpb24tZWxlbWVudFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBpZCA9ICQodGhpcykuYXR0cihcImRhdGEtZWxlbWVudC1pZFwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gXy5maW5kV2hlcmUoY3JlYXRvci53b3JraW5nRWxlbWVudHMsIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGlkXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJtaXNzaW5nIGVsZW1lbnQ6IFwiLCBpZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLndvcmtpbmdFbGVtZW50cyA9IG5ld0VsZW1lbnRzO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyTGlzdCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBkcmFnIGNvbW11bmljYXRpb24gd2l0aCBlbGVtZW50IHN1Yi12aWV3czogZHJhZ3N0YXJ0ICovXG4gICAgICAgIF9lbGVtZW50RHJhZ3N0YXJ0OiBmdW5jdGlvbihldiwgZWxlbWVudCkge1xuICAgICAgICAgICAgLy8gYXV0byBzZWxlY3QgdGhlIGVsZW1lbnQgY2F1c2luZyB0aGUgZXZlbnQgYW5kIG1vdmUgYWxsIHNlbGVjdGVkXG4gICAgICAgICAgICBlbGVtZW50LnNlbGVjdCh0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuJGRyYWdnaW5nID0gdGhpcy4kKFwiLmNvbGxlY3Rpb24tZWxlbWVudHMgLmNvbGxlY3Rpb24tZWxlbWVudC5zZWxlY3RlZFwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZHJhZyBjb21tdW5pY2F0aW9uIHdpdGggZWxlbWVudCBzdWItdmlld3M6IGRyYWdlbmQgLSByZW1vdmUgdGhlIHBsYWNlaG9sZGVyICovXG4gICAgICAgIF9lbGVtZW50RHJhZ2VuZDogZnVuY3Rpb24oZXYsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgICQoXCIuZWxlbWVudC1kcm9wLXBsYWNlaG9sZGVyXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy4kZHJhZ2dpbmcgPSBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSB0ZW1wbGF0ZXNcbiAgICAgICAgLy9UT0RPOiBtb3ZlIHRvIHJlcXVpcmUgdGV4dCBwbHVnaW4gYW5kIGxvYWQgdGhlc2UgYXMgdGV4dFxuICAgICAgICAvL1RPRE86IHVuZGVyc2NvcmUgY3VycmVudGx5IHVubmVjYy4gYmMgbm8gdmFycyBhcmUgdXNlZFxuICAgICAgICAvL1RPRE86IGJldHRlciB3YXkgb2YgbG9jYWxpemluZyB0ZXh0LW5vZGVzIGluIGxvbmcgc3RyaW5nc1xuICAgICAgICAvKiogdW5kZXJzY29yZSB0ZW1wbGF0ZSBmbnMgYXR0YWNoZWQgdG8gY2xhc3MgKi9cbiAgICAgICAgdGVtcGxhdGVzOiBfLmV4dGVuZCh7fSwgYmFzZUNyZWF0b3IuQ29sbGVjdGlvbkNyZWF0b3JNaXhpbi5fY3JlYXRvclRlbXBsYXRlcywge1xuICAgICAgICAgICAgLyoqIHRoZSBoZWFkZXIgKG5vdCBpbmNsdWRpbmcgaGVscCB0ZXh0KSAqL1xuICAgICAgICAgICAgaGVhZGVyOiBfLnRlbXBsYXRlKFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtYWluLWhlbHAgd2VsbCBjbGVhclwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cIm1vcmUtaGVscFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJNb3JlIGhlbHBcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImhlbHAtY29udGVudFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cImxlc3MtaGVscFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJMZXNzXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC1kaXNtaXNzYWJsZVwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCIgZGF0YS1kaXNtaXNzPVwiYWxlcnRcIiAnLFxuICAgICAgICAgICAgICAgICAgICAndGl0bGU9XCInLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkNsb3NlIGFuZCBzaG93IG1vcmUgaGVscFwiKSxcbiAgICAgICAgICAgICAgICAgICAgJ1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L2J1dHRvbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJhbGVydC1tZXNzYWdlXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgIC8qKiB0aGUgbWlkZGxlOiBlbGVtZW50IGxpc3QgKi9cbiAgICAgICAgICAgIG1pZGRsZTogXy50ZW1wbGF0ZShcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29sbGVjdGlvbi1lbGVtZW50cy1jb250cm9sc1wiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cInJlc2V0XCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIiAnLFxuICAgICAgICAgICAgICAgICAgICAndGl0bGU9XCInLFxuICAgICAgICAgICAgICAgICAgICBfbChcIlVuZG8gYWxsIHJlb3JkZXJpbmcgYW5kIGRpc2NhcmRzXCIpLFxuICAgICAgICAgICAgICAgICAgICAnXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJTdGFydCBvdmVyXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwiY2xlYXItc2VsZWN0ZWRcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiICcsXG4gICAgICAgICAgICAgICAgICAgICd0aXRsZT1cIicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiRGUtc2VsZWN0IGFsbCBzZWxlY3RlZCBkYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICAgICAgICAgJ1wiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQ2xlYXIgc2VsZWN0ZWRcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tZWxlbWVudHMgc2Nyb2xsLWNvbnRhaW5lciBmbGV4LXJvd1wiPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgIC8qKiBjcmVhdGlvbiBhbmQgY2FuY2VsIGNvbnRyb2xzICovXG4gICAgICAgICAgICBmb290ZXI6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImF0dHJpYnV0ZXMgY2xlYXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxsYWJlbCBjbGFzcz1cInNldHRpbmctcHJvbXB0IHB1bGwtcmlnaHRcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkhpZGUgb3JpZ2luYWwgZWxlbWVudHNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiP1wiLFxuICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGNsYXNzPVwiaGlkZS1vcmlnaW5hbHMgcHVsbC1yaWdodFwiIHR5cGU9XCJjaGVja2JveFwiIC8+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xhYmVsPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCBjbGFzcz1cImNvbGxlY3Rpb24tbmFtZSBmb3JtLWNvbnRyb2wgcHVsbC1yaWdodFwiICcsXG4gICAgICAgICAgICAgICAgICAgICdwbGFjZWhvbGRlcj1cIicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiRW50ZXIgYSBuYW1lIGZvciB5b3VyIG5ldyBjb2xsZWN0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICAnXCIgLz4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tbmFtZS1wcm9tcHQgcHVsbC1yaWdodFwiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiTmFtZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI6PC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG5cbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhY3Rpb25zIGNsZWFyIHZlcnRpY2FsbHktc3BhY2VkXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJvdGhlci1vcHRpb25zIHB1bGwtbGVmdFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiY2FuY2VsLWNyZWF0ZSBidG5cIiB0YWJpbmRleD1cIi0xXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJDYW5jZWxcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY3JlYXRlLW90aGVyIGJ0bi1ncm91cCBkcm9wdXBcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBkcm9wZG93bi10b2dnbGVcIiBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJDcmVhdGUgYSBkaWZmZXJlbnQga2luZCBvZiBjb2xsZWN0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICAnIDxzcGFuIGNsYXNzPVwiY2FyZXRcIj48L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2J1dHRvbj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiByb2xlPVwibWVudVwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8bGk+PGEgaHJlZj1cIiNcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkNyZWF0ZSBhIDxpPnNpbmdsZTwvaT4gcGFpclwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2E+PC9saT5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxsaT48YSBocmVmPVwiI1wiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQ3JlYXRlIGEgbGlzdCBvZiA8aT51bnBhaXJlZDwvaT4gZGF0YXNldHNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC91bD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcblxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1haW4tb3B0aW9ucyBwdWxsLXJpZ2h0XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJjcmVhdGUtY29sbGVjdGlvbiBidG4gYnRuLXByaW1hcnlcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkNyZWF0ZSBsaXN0XCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAvKiogaGVscCBjb250ZW50ICovXG4gICAgICAgICAgICBoZWxwQ29udGVudDogXy50ZW1wbGF0ZShcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIFwiPHA+XCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ29sbGVjdGlvbnMgb2YgZGF0YXNldHMgYXJlIHBlcm1hbmVudCwgb3JkZXJlZCBsaXN0cyBvZiBkYXRhc2V0cyB0aGF0IGNhbiBiZSBwYXNzZWQgdG8gdG9vbHMgYW5kIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya2Zsb3dzIGluIG9yZGVyIHRvIGhhdmUgYW5hbHlzZXMgZG9uZSBvbiBlYWNoIG1lbWJlciBvZiB0aGUgZW50aXJlIGdyb3VwLiBUaGlzIGludGVyZmFjZSBhbGxvd3MgXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ5b3UgdG8gY3JlYXRlIGEgY29sbGVjdGlvbiBhbmQgcmUtb3JkZXIgdGhlIGZpbmFsIGNvbGxlY3Rpb24uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvcD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8dWw+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPGxpPlwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlJlbmFtZSBlbGVtZW50cyBpbiB0aGUgbGlzdCBieSBjbGlja2luZyBvbiBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIuY29sbGVjdGlvbi1lbGVtZW50IC5uYW1lXCI+dGhlIGV4aXN0aW5nIG5hbWU8L2k+LidcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPGxpPlwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkRpc2NhcmQgZWxlbWVudHMgZnJvbSB0aGUgZmluYWwgY3JlYXRlZCBsaXN0IGJ5IGNsaWNraW5nIG9uIHRoZSBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIuY29sbGVjdGlvbi1lbGVtZW50IC5kaXNjYXJkXCI+XCJEaXNjYXJkXCI8L2k+IGJ1dHRvbi4nXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxsaT5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJSZW9yZGVyIHRoZSBsaXN0IGJ5IGNsaWNraW5nIGFuZCBkcmFnZ2luZyBlbGVtZW50cy4gU2VsZWN0IG11bHRpcGxlIGVsZW1lbnRzIGJ5IGNsaWNraW5nIG9uIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aSBkYXRhLXRhcmdldD1cIi5jb2xsZWN0aW9uLWVsZW1lbnRcIj50aGVtPC9pPiBhbmQgeW91IGNhbiB0aGVuIG1vdmUgdGhvc2Ugc2VsZWN0ZWQgYnkgZHJhZ2dpbmcgdGhlICcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbnRpcmUgZ3JvdXAuIERlc2VsZWN0IHRoZW0gYnkgY2xpY2tpbmcgdGhlbSBhZ2FpbiBvciBieSBjbGlja2luZyB0aGUgXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RoZSA8aSBkYXRhLXRhcmdldD1cIi5jbGVhci1zZWxlY3RlZFwiPlwiQ2xlYXIgc2VsZWN0ZWRcIjwvaT4gbGluay4nXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxsaT5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NsaWNrIHRoZSA8aSBkYXRhLXRhcmdldD1cIi5yZXNldFwiPlwiU3RhcnQgb3ZlclwiPC9pPiBsaW5rIHRvIGJlZ2luIGFnYWluIGFzIGlmIHlvdSBoYWQganVzdCBvcGVuZWQgJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRoZSBpbnRlcmZhY2UuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPGxpPlwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgICAgIFsnQ2xpY2sgdGhlIDxpIGRhdGEtdGFyZ2V0PVwiLmNhbmNlbC1jcmVhdGVcIj5cIkNhbmNlbFwiPC9pPiBidXR0b24gdG8gZXhpdCB0aGUgaW50ZXJmYWNlLiddLmpvaW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC91bD48YnIgLz5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8cD5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ09uY2UgeW91ciBjb2xsZWN0aW9uIGlzIGNvbXBsZXRlLCBlbnRlciBhIDxpIGRhdGEtdGFyZ2V0PVwiLmNvbGxlY3Rpb24tbmFtZVwiPm5hbWU8L2k+IGFuZCAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjbGljayA8aSBkYXRhLXRhcmdldD1cIi5jcmVhdGUtY29sbGVjdGlvblwiPlwiQ3JlYXRlIGxpc3RcIjwvaT4uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9wPlwiXG4gICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAvKiogc2hvd24gaW4gbGlzdCB3aGVuIGFsbCBlbGVtZW50cyBhcmUgZGlzY2FyZGVkICovXG4gICAgICAgICAgICBpbnZhbGlkRWxlbWVudHM6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICBfbChcIlRoZSBmb2xsb3dpbmcgc2VsZWN0aW9ucyBjb3VsZCBub3QgYmUgaW5jbHVkZWQgZHVlIHRvIHByb2JsZW1zOlwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8dWw+PCUgXy5lYWNoKCBwcm9ibGVtcywgZnVuY3Rpb24oIHByb2JsZW0gKXsgJT5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8bGk+PGI+PCUtIHByb2JsZW0uZWxlbWVudC5uYW1lICU+PC9iPjogPCUtIHByb2JsZW0udGV4dCAlPjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPCUgfSk7ICU+PC91bD5cIlxuICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgKSxcblxuICAgICAgICAgICAgLyoqIHNob3duIGluIGxpc3Qgd2hlbiBhbGwgZWxlbWVudHMgYXJlIGRpc2NhcmRlZCAqL1xuICAgICAgICAgICAgbm9FbGVtZW50c0xlZnQ6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAnPGxpIGNsYXNzPVwibm8tZWxlbWVudHMtbGVmdC1tZXNzYWdlXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJObyBlbGVtZW50cyBsZWZ0ISBcIiksXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiV291bGQgeW91IGxpa2UgdG8gXCIpLFxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJyZXNldFwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcInN0YXJ0IG92ZXJcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPj9cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiXG4gICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAvKiogYSBzaW1wbGlmaWVkIHBhZ2UgY29tbXVuaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcgYW5kIHdoeSB0aGUgdXNlciBuZWVkcyB0byByZXNlbGVjdCBzb21ldGhpbmcgZWxzZSAqL1xuICAgICAgICAgICAgaW52YWxpZEluaXRpYWw6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImhlYWRlciBmbGV4LXJvdyBuby1mbGV4XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhbGVydCBhbGVydC13YXJuaW5nXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9ja1wiPicsXG4gICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImFsZXJ0LW1lc3NhZ2VcIj4nLFxuICAgICAgICAgICAgICAgICAgICBcIjwlIGlmKCBfLnNpemUoIHByb2JsZW1zICkgKXsgJT5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXCJUaGUgZm9sbG93aW5nIHNlbGVjdGlvbnMgY291bGQgbm90IGJlIGluY2x1ZGVkIGR1ZSB0byBwcm9ibGVtc1wiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI6XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPHVsPjwlIF8uZWFjaCggcHJvYmxlbXMsIGZ1bmN0aW9uKCBwcm9ibGVtICl7ICU+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPGxpPjxiPjwlLSBwcm9ibGVtLmVsZW1lbnQubmFtZSAlPjwvYj46IDwlLSBwcm9ibGVtLnRleHQgJT48L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwlIH0pOyAlPjwvdWw+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPCUgfSBlbHNlIGlmKCBfLnNpemUoIGVsZW1lbnRzICkgPCAxICl7ICU+XCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiTm8gZGF0YXNldHMgd2VyZSBzZWxlY3RlZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCIuXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxiciAvPlwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkF0IGxlYXN0IG9uZSBlbGVtZW50IGlzIG5lZWRlZCBmb3IgdGhlIGNvbGxlY3Rpb25cIiksXG4gICAgICAgICAgICAgICAgICAgIFwiLiBcIixcbiAgICAgICAgICAgICAgICAgICAgX2woXCJZb3UgbWF5IG5lZWQgdG8gXCIpLFxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJjYW5jZWwtY3JlYXRlXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiY2FuY2VsXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYT4gXCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiYW5kIHJlc2VsZWN0IG5ldyBlbGVtZW50c1wiKSxcbiAgICAgICAgICAgICAgICAgICAgXCIuXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3RlciBmbGV4LXJvdyBuby1mbGV4XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhY3Rpb25zIGNsZWFyIHZlcnRpY2FsbHktc3BhY2VkXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJvdGhlci1vcHRpb25zIHB1bGwtbGVmdFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiY2FuY2VsLWNyZWF0ZSBidG5cIiB0YWJpbmRleD1cIi0xXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJDYW5jZWxcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgICAgICAgICAgICAgIC8vIF9sKCAnQ3JlYXRlIGEgZGlmZmVyZW50IGtpbmQgb2YgY29sbGVjdGlvbicgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgKVxuICAgICAgICB9KSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gbWlzY1xuICAgICAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJMaXN0Q29sbGVjdGlvbkNyZWF0b3JcIjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQ3JlYXRlIGEgbW9kYWwgYW5kIGxvYWQgaXRzIGJvZHkgd2l0aCB0aGUgZ2l2ZW4gQ3JlYXRvckNsYXNzIGNyZWF0b3IgdHlwZVxuICogIEByZXR1cm5zIHtEZWZlcnJlZH0gcmVzb2x2ZWQgd2hlbiBjcmVhdG9yIGhhcyBidWlsdCBhIGNvbGxlY3Rpb24uXG4gKi9cbnZhciBjb2xsZWN0aW9uQ3JlYXRvck1vZGFsID0gZnVuY3Rpb24gX2NvbGxlY3Rpb25DcmVhdG9yTW9kYWwoZWxlbWVudHMsIG9wdGlvbnMsIENyZWF0b3JDbGFzcykge1xuICAgIHZhciBkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpO1xuICAgIHZhciBtb2RhbCA9IEdhbGF4eS5tb2RhbCB8fCBuZXcgVUlfTU9EQUwuVmlldygpO1xuICAgIHZhciBjcmVhdG9yO1xuXG4gICAgb3B0aW9ucyA9IF8uZGVmYXVsdHMob3B0aW9ucyB8fCB7fSwge1xuICAgICAgICBlbGVtZW50czogZWxlbWVudHMsXG4gICAgICAgIG9uY2FuY2VsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG1vZGFsLmhpZGUoKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChcImNhbmNlbGxlZFwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25jcmVhdGU6IGZ1bmN0aW9uKGNyZWF0b3IsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBtb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgY3JlYXRvciA9IG5ldyBDcmVhdG9yQ2xhc3Mob3B0aW9ucyk7XG4gICAgbW9kYWwuc2hvdyh7XG4gICAgICAgIHRpdGxlOiBvcHRpb25zLnRpdGxlIHx8IF9sKFwiQ3JlYXRlIGEgY29sbGVjdGlvblwiKSxcbiAgICAgICAgYm9keTogY3JlYXRvci4kZWwsXG4gICAgICAgIHdpZHRoOiBcIjgwJVwiLFxuICAgICAgICBoZWlnaHQ6IFwiMTAwJVwiLFxuICAgICAgICBjbG9zaW5nX2V2ZW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGNyZWF0b3IucmVuZGVyKCk7XG4gICAgd2luZG93Ll9jb2xsZWN0aW9uQ3JlYXRvciA9IGNyZWF0b3I7XG5cbiAgICAvL1RPRE86IHJlbW92ZSBtb2RhbCBoZWFkZXJcbiAgICByZXR1cm4gZGVmZXJyZWQ7XG59O1xuXG4vKiogTGlzdCBjb2xsZWN0aW9uIGZsYXZvciBvZiBjb2xsZWN0aW9uQ3JlYXRvck1vZGFsLiAqL1xudmFyIGxpc3RDb2xsZWN0aW9uQ3JlYXRvck1vZGFsID0gZnVuY3Rpb24gX2xpc3RDb2xsZWN0aW9uQ3JlYXRvck1vZGFsKGVsZW1lbnRzLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgb3B0aW9ucy50aXRsZSA9IF9sKFwiQ3JlYXRlIGEgY29sbGVjdGlvbiBmcm9tIGEgbGlzdCBvZiBkYXRhc2V0c1wiKTtcbiAgICByZXR1cm4gY29sbGVjdGlvbkNyZWF0b3JNb2RhbChlbGVtZW50cywgb3B0aW9ucywgTGlzdENvbGxlY3Rpb25DcmVhdG9yKTtcbn07XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogVXNlIGEgbW9kYWwgdG8gY3JlYXRlIGEgbGlzdCBjb2xsZWN0aW9uLCB0aGVuIGFkZCBpdCB0byB0aGUgZ2l2ZW4gaGlzdG9yeSBjb250ZW50cy5cbiAqICBAcmV0dXJucyB7RGVmZXJyZWR9IHJlc29sdmVkIHdoZW4gdGhlIGNvbGxlY3Rpb24gaXMgYWRkZWQgdG8gdGhlIGhpc3RvcnkuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUxpc3RDb2xsZWN0aW9uKGNvbnRlbnRzLCBkZWZhdWx0SGlkZVNvdXJjZUl0ZW1zKSB7XG4gICAgdmFyIGVsZW1lbnRzID0gY29udGVudHMudG9KU09OKCk7XG5cbiAgICB2YXIgcHJvbWlzZSA9IGxpc3RDb2xsZWN0aW9uQ3JlYXRvck1vZGFsKGVsZW1lbnRzLCB7XG4gICAgICAgIGRlZmF1bHRIaWRlU291cmNlSXRlbXM6IGRlZmF1bHRIaWRlU291cmNlSXRlbXMsXG4gICAgICAgIGNyZWF0aW9uRm46IGZ1bmN0aW9uKGVsZW1lbnRzLCBuYW1lLCBoaWRlU291cmNlSXRlbXMpIHtcbiAgICAgICAgICAgIGVsZW1lbnRzID0gZWxlbWVudHMubWFwKGVsZW1lbnQgPT4gKHtcbiAgICAgICAgICAgICAgICBpZDogZWxlbWVudC5pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBlbGVtZW50Lm5hbWUsXG5cbiAgICAgICAgICAgICAgICAvL1RPRE86IHRoaXMgYWxsb3dzIGZvciBsaXN0Omxpc3QgZXZlbiBpZiB0aGUgZmlsdGVyIGFib3ZlIGRvZXMgbm90IC0gcmVjb25jaWxlXG4gICAgICAgICAgICAgICAgc3JjOiBlbGVtZW50Lmhpc3RvcnlfY29udGVudF90eXBlID09PSBcImRhdGFzZXRcIiA/IFwiaGRhXCIgOiBcImhkY2FcIlxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnRzLmNyZWF0ZUhEQ0EoZWxlbWVudHMsIFwibGlzdFwiLCBuYW1lLCBoaWRlU291cmNlSXRlbXMpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRWaWV3OiBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRWaWV3LFxuICAgIExpc3RDb2xsZWN0aW9uQ3JlYXRvcjogTGlzdENvbGxlY3Rpb25DcmVhdG9yLFxuXG4gICAgY29sbGVjdGlvbkNyZWF0b3JNb2RhbDogY29sbGVjdGlvbkNyZWF0b3JNb2RhbCxcbiAgICBsaXN0Q29sbGVjdGlvbkNyZWF0b3JNb2RhbDogbGlzdENvbGxlY3Rpb25DcmVhdG9yTW9kYWwsXG4gICAgY3JlYXRlTGlzdENvbGxlY3Rpb246IGNyZWF0ZUxpc3RDb2xsZWN0aW9uXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9jb2xsZWN0aW9uL2xpc3QtY29sbGVjdGlvbi1jcmVhdG9yLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBM0lBO0FBQ0E7QUE2SUE7QUFDQTs7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFDQTtBQWVBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQUNBO0FBOEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcUJBO0FBQ0E7QUFDQTtBQW9CQTtBQUNBO0FBQ0E7QUFrREE7QUFDQTtBQUNBO0FBZ0VBO0FBQ0E7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFpQ0E7QUFDQTtBQTlOQTtBQUNBO0FBb09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6MEJBO0FBQ0E7QUEyMEJBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFBQTtBQU9BO0FBQ0E7QUFYQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///29\n");

/***/ }),
/* 30 */
/*!***********************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/collection-model.js ***!
  \***********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, Backbone, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _datasetModel = __webpack_require__(/*! mvc/dataset/dataset-model */ 50);\n\nvar _datasetModel2 = _interopRequireDefault(_datasetModel);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\n/*\nNotes:\n\nTerminology:\n    DatasetCollection/DC : a container of datasets or nested DatasetCollections\n    Element/DatasetCollectionElement/DCE : an item contained in a DatasetCollection\n    HistoryDatasetCollectionAssociation/HDCA: a DatasetCollection contained in a history\n\n\nThis all seems too complex unfortunately:\n\n- Terminology collision between DatasetCollections (DCs) and Backbone Collections.\n- In the DatasetCollections API JSON, DC Elements use a 'Has A' stucture to *contain*\n    either a dataset or a nested DC. This would make the hierarchy much taller. I've\n    decided to merge the contained JSON with the DC element json - making the 'has a'\n    relation into an 'is a' relation. This seems simpler to me and allowed a lot of\n    DRY in both models and views, but may make tracking or tracing within these models\n    more difficult (since DatasetCollectionElements are now *also* DatasetAssociations\n    or DatasetCollections (nested)). This also violates the rule of thumb about\n    favoring aggregation over inheritance.\n- Currently, there are three DatasetCollection subclasses: List, Pair, and ListPaired.\n    These each should a) be usable on their own, b) be usable in the context of\n    nesting within a collection model (at least in the case of ListPaired), and\n    c) be usable within the context of other container models (like History or\n    LibraryFolder, etc.). I've tried to separate/extract classes in order to\n    handle those three situations, but it's proven difficult to do in a simple,\n    readable manner.\n- Ideally, histories and libraries would inherit from the same server models as\n    dataset collections do since they are (in essence) dataset collections themselves -\n    making the whole nested structure simpler. This would be a large, error-prone\n    refactoring and migration.\n\nMany of the classes and heirarchy are meant as extension points so, while the\nrelations and flow may be difficult to understand initially, they'll allow us to\nhandle the growth or flux dataset collection in the future (w/o actually implementing\nany YAGNI).\n\n*/\n//_________________________________________________________________________________________________ ELEMENTS\n/** @class mixin for Dataset collection elements.\n *      When collection elements are passed from the API, the underlying element is\n *          in a sub-object 'object' (IOW, a DCE representing an HDA will have HDA json in element.object).\n *      This mixin uses the constructor and parse methods to merge that JSON with the DCE attribtues\n *          effectively changing a DCE from a container to a subclass (has a --> is a).\n */\nvar DatasetCollectionElementMixin = {\n    /** default attributes used by elements in a dataset collection */\n    defaults: {\n        model_class: \"DatasetCollectionElement\",\n        element_identifier: null,\n        element_index: null,\n        element_type: null\n    },\n\n    /** merge the attributes of the sub-object 'object' into this model */\n    _mergeObject: function _mergeObject(attributes) {\n        // if we don't preserve and correct ids here, the element id becomes the object id\n        // and collision in backbone's _byId will occur and only\n        _.extend(attributes, attributes.object, {\n            element_id: attributes.id\n        });\n        delete attributes.object;\n        return attributes;\n    },\n\n    /** override to merge this.object into this */\n    constructor: function constructor(attributes, options) {\n        // console.debug( '\\t DatasetCollectionElement.constructor:', attributes, options );\n        attributes = this._mergeObject(attributes);\n        this.idAttribute = \"element_id\";\n        Backbone.Model.apply(this, arguments);\n    },\n\n    /** when the model is fetched, merge this.object into this */\n    parse: function parse(response, options) {\n        var attributes = response;\n        attributes = this._mergeObject(attributes);\n        return attributes;\n    }\n};\n\n/** @class Concrete class of Generic DatasetCollectionElement */\nvar DatasetCollectionElement = Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(DatasetCollectionElementMixin).extend({ _logNamespace: \"collections\" });\n\n//==============================================================================\n/** @class Base/Abstract Backbone collection for Generic DCEs - \n    current may be associated with a dataset (DatasetDCECollection)\n    or another collection (NestedDCDCECollection).\n*/\nvar DCECollection = Backbone.Collection.extend(_baseMvc2.default.LoggableMixin).extend(\n/** @lends DCECollection.prototype */{\n    _logNamespace: \"collections\",\n\n    model: DatasetCollectionElement,\n\n    /** String representation. */\n    toString: function toString() {\n        return [\"DatasetCollectionElementCollection(\", this.length, \")\"].join(\"\");\n    }\n});\n\n//==============================================================================\n/** @class Backbone model for a dataset collection element that is a dataset (HDA).\n */\nvar DatasetDCE = _datasetModel2.default.DatasetAssociation.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,\n/** @lends DatasetDCE.prototype */{\n    /** url fn */\n    url: function url() {\n        // won't always be an hda\n        if (!this.has(\"history_id\")) {\n            console.warn(\"no endpoint for non-hdas within a collection yet\");\n            // (a little silly since this api endpoint *also* points at hdas)\n            return Galaxy.root + \"api/datasets\";\n        }\n        return Galaxy.root + \"api/histories/\" + this.get(\"history_id\") + \"/contents/\" + this.get(\"id\");\n    },\n\n    defaults: _.extend({}, _datasetModel2.default.DatasetAssociation.prototype.defaults, DatasetCollectionElementMixin.defaults),\n\n    _downloadQueryParameters: function _downloadQueryParameters() {\n        var fileExt = this.get(\"file_ext\");\n        var elementIdentifier = this.get(\"element_identifier\");\n        var parentHdcaId = this.get(\"parent_hdca_id\");\n        return \"?to_ext=\" + fileExt + \"&hdca_id=\" + parentHdcaId + \"&element_identifier=\" + elementIdentifier;\n    },\n\n    // because all objects have constructors (as this hashmap would even if this next line wasn't present)\n    //  the constructor in hcontentMixin won't be attached by BASE_MVC.mixin to this model\n    //  - re-apply manually for now\n    /** call the mixin constructor */\n    constructor: function constructor(attributes, options) {\n        this.debug(\"\\t DatasetDCE.constructor:\", attributes, options);\n        //DATASET_MODEL.DatasetAssociation.prototype.constructor.call( this, attributes, options );\n        DatasetCollectionElementMixin.constructor.call(this, attributes, options);\n    },\n\n    /** Does this model already contain detailed data (as opposed to just summary level data)? */\n    hasDetails: function hasDetails() {\n        return this.elements && this.elements.length;\n    },\n\n    /** String representation. */\n    toString: function toString() {\n        var objStr = this.get(\"element_identifier\");\n        return \"DatasetDCE({objStr})\";\n    }\n}));\n\n//==============================================================================\n/** @class DCECollection of DatasetDCE's (a list of datasets, a pair of datasets).\n */\nvar DatasetDCECollection = DCECollection.extend(\n/** @lends DatasetDCECollection.prototype */{\n    model: DatasetDCE,\n\n    /** String representation. */\n    toString: function toString() {\n        return [\"DatasetDCECollection(\", this.length, \")\"].join(\"\");\n    }\n});\n\n//_________________________________________________________________________________________________ COLLECTIONS\n/** @class Backbone model for Dataset Collections.\n *      The DC API returns an array of JSON objects under the attribute elements.\n *      This model:\n *          - removes that array/attribute ('elements') from the model,\n *          - creates a bbone collection (of the class defined in the 'collectionClass' attribute),\n *          - passes that json onto the bbone collection\n *          - caches the bbone collection in this.elements\n */\nvar DatasetCollection = Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.SearchableModelMixin).extend(\n/** @lends DatasetCollection.prototype */{\n    _logNamespace: \"collections\",\n\n    /** default attributes for a model */\n    defaults: {\n        /* 'list', 'paired', or 'list:paired' */\n        collection_type: null,\n        //??\n        deleted: false\n    },\n\n    /** Which class to use for elements */\n    collectionClass: function collectionClass() {\n        if (this.attributes.collection_type.indexOf(\":\") > 0) {\n            return NestedDCDCECollection;\n        } else {\n            return DatasetDCECollection;\n        }\n    },\n\n    /** set up: create elements instance var and (on changes to elements) update them  */\n    initialize: function initialize(model, options) {\n        this.debug(this + \"(DatasetCollection).initialize:\", model, options, this);\n        this.elements = this._createElementsModel();\n        this.on(\"change:elements\", function () {\n            this.log(\"change:elements\");\n            //TODO: prob. better to update the collection instead of re-creating it\n            this.elements = this._createElementsModel();\n        });\n    },\n\n    /** move elements model attribute to full collection */\n    _createElementsModel: function _createElementsModel() {\n        var collectionClass = this.collectionClass();\n        this.debug(this + \"._createElementsModel\", collectionClass, this.get(\"elements\"), this.elements);\n        //TODO: same patterns as DatasetCollectionElement _createObjectModel - refactor to BASE_MVC.hasSubModel?\n        var elements = this.get(\"elements\") || [];\n        this.unset(\"elements\", { silent: true });\n        var self = this;\n        _.each(elements, function (element, index) {\n            _.extend(element, {\n                parent_hdca_id: self.get(\"id\")\n            });\n        });\n        this.elements = new collectionClass(elements);\n        //this.debug( 'collectionClass:', this.collectionClass + '', this.elements );\n        return this.elements;\n    },\n\n    // ........................................................................ common queries\n    /** pass the elements back within the model json when this is serialized */\n    toJSON: function toJSON() {\n        var json = Backbone.Model.prototype.toJSON.call(this);\n        if (this.elements) {\n            json.elements = this.elements.toJSON();\n        }\n        return json;\n    },\n\n    /** Is this collection in a 'ready' state no processing (for the collection) is left\n     *  to do on the server.\n     */\n    inReadyState: function inReadyState() {\n        var populated = this.get(\"populated\");\n        return this.isDeletedOrPurged() || populated;\n    },\n\n    //TODO:?? the following are the same interface as DatasetAssociation - can we combine?\n    /** Does the DC contain any elements yet? Is a fetch() required? */\n    hasDetails: function hasDetails() {\n        return this.elements.length !== 0;\n    },\n\n    /** Given the filters, what models in this.elements would be returned? */\n    getVisibleContents: function getVisibleContents(filters) {\n        // filters unused for now\n        return this.elements;\n    },\n\n    // ........................................................................ ajax\n    /** override to use actual Dates objects for create/update times */\n    parse: function parse(response, options) {\n        var parsed = Backbone.Model.prototype.parse.call(this, response, options);\n        if (parsed.create_time) {\n            parsed.create_time = new Date(parsed.create_time);\n        }\n        if (parsed.update_time) {\n            parsed.update_time = new Date(parsed.update_time);\n        }\n        return parsed;\n    },\n\n    /** save this collection, _Mark_ing it as deleted (just a flag) */\n    delete: function _delete(recursive, purge, options) {\n        recursive = recursive || false;\n        purge = purge || false;\n        if (this.get(\"deleted\")) {\n            return jQuery.when();\n        }\n        options = _utils2.default.merge(options, { method: \"delete\" });\n        return this.save({ deleted: true, recursive: recursive, purge: purge }, options);\n    },\n    /** save this collection, _Mark_ing it as undeleted */\n    undelete: function undelete(options) {\n        if (!this.get(\"deleted\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: false }, options);\n    },\n\n    /** Is this collection deleted or purged? */\n    isDeletedOrPurged: function isDeletedOrPurged() {\n        return this.get(\"deleted\") || this.get(\"purged\");\n    },\n\n    // ........................................................................ searchable\n    /** searchable attributes for collections */\n    searchAttributes: [\"name\", \"tags\"],\n\n    // ........................................................................ misc\n    /** String representation */\n    toString: function toString() {\n        var idAndName = [this.get(\"id\"), this.get(\"name\") || this.get(\"element_identifier\")];\n        return \"DatasetCollection(\" + idAndName.join(\",\") + \")\";\n    }\n});\n\n//_________________________________________________________________________________________________ NESTED COLLECTIONS\n// this is where things get weird, man. Weird.\n//TODO: it might be possible to compact all the following...I think.\n//==============================================================================\n/** @class Backbone model for a Generic DatasetCollectionElement that is also a DatasetCollection\n *      (a nested collection).\n */\nvar NestedDCDCE = DatasetCollection.extend(_baseMvc2.default.mixin(DatasetCollectionElementMixin,\n/** @lends NestedDCDCE.prototype */{\n    // because all objects have constructors (as this hashmap would even if this next line wasn't present)\n    //  the constructor in hcontentMixin won't be attached by BASE_MVC.mixin to this model\n    //  - re-apply manually it now\n    /** call the mixin constructor */\n    constructor: function constructor(attributes, options) {\n        this.debug(\"\\t NestedDCDCE.constructor:\", attributes, options);\n        DatasetCollectionElementMixin.constructor.call(this, attributes, options);\n    },\n\n    /** String representation. */\n    toString: function toString() {\n        var objStr = this.object ? \"\" + this.object : this.get(\"element_identifier\");\n        return [\"NestedDCDCE(\", objStr, \")\"].join(\"\");\n    }\n}));\n\n//==============================================================================\n/** @class Backbone collection containing Generic NestedDCDCE's (nested dataset collections).\n */\nvar NestedDCDCECollection = DCECollection.extend(\n/** @lends NestedDCDCECollection.prototype */{\n    /** This is a collection of nested collections */\n    model: NestedDCDCE,\n\n    /** String representation. */\n    toString: function toString() {\n        return [\"NestedDCDCECollection(\", this.length, \")\"].join(\"\");\n    }\n});\n\n//==============================================================================\nexports.default = {\n    DatasetCollection: DatasetCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1tb2RlbC5qcz8yZGU0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEQVRBU0VUX01PREVMIGZyb20gXCJtdmMvZGF0YXNldC9kYXRhc2V0LW1vZGVsXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCJ1dGlscy91dGlsc1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qXG5Ob3RlczpcblxuVGVybWlub2xvZ3k6XG4gICAgRGF0YXNldENvbGxlY3Rpb24vREMgOiBhIGNvbnRhaW5lciBvZiBkYXRhc2V0cyBvciBuZXN0ZWQgRGF0YXNldENvbGxlY3Rpb25zXG4gICAgRWxlbWVudC9EYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnQvRENFIDogYW4gaXRlbSBjb250YWluZWQgaW4gYSBEYXRhc2V0Q29sbGVjdGlvblxuICAgIEhpc3RvcnlEYXRhc2V0Q29sbGVjdGlvbkFzc29jaWF0aW9uL0hEQ0E6IGEgRGF0YXNldENvbGxlY3Rpb24gY29udGFpbmVkIGluIGEgaGlzdG9yeVxuXG5cblRoaXMgYWxsIHNlZW1zIHRvbyBjb21wbGV4IHVuZm9ydHVuYXRlbHk6XG5cbi0gVGVybWlub2xvZ3kgY29sbGlzaW9uIGJldHdlZW4gRGF0YXNldENvbGxlY3Rpb25zIChEQ3MpIGFuZCBCYWNrYm9uZSBDb2xsZWN0aW9ucy5cbi0gSW4gdGhlIERhdGFzZXRDb2xsZWN0aW9ucyBBUEkgSlNPTiwgREMgRWxlbWVudHMgdXNlIGEgJ0hhcyBBJyBzdHVjdHVyZSB0byAqY29udGFpbipcbiAgICBlaXRoZXIgYSBkYXRhc2V0IG9yIGEgbmVzdGVkIERDLiBUaGlzIHdvdWxkIG1ha2UgdGhlIGhpZXJhcmNoeSBtdWNoIHRhbGxlci4gSSd2ZVxuICAgIGRlY2lkZWQgdG8gbWVyZ2UgdGhlIGNvbnRhaW5lZCBKU09OIHdpdGggdGhlIERDIGVsZW1lbnQganNvbiAtIG1ha2luZyB0aGUgJ2hhcyBhJ1xuICAgIHJlbGF0aW9uIGludG8gYW4gJ2lzIGEnIHJlbGF0aW9uLiBUaGlzIHNlZW1zIHNpbXBsZXIgdG8gbWUgYW5kIGFsbG93ZWQgYSBsb3Qgb2ZcbiAgICBEUlkgaW4gYm90aCBtb2RlbHMgYW5kIHZpZXdzLCBidXQgbWF5IG1ha2UgdHJhY2tpbmcgb3IgdHJhY2luZyB3aXRoaW4gdGhlc2UgbW9kZWxzXG4gICAgbW9yZSBkaWZmaWN1bHQgKHNpbmNlIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudHMgYXJlIG5vdyAqYWxzbyogRGF0YXNldEFzc29jaWF0aW9uc1xuICAgIG9yIERhdGFzZXRDb2xsZWN0aW9ucyAobmVzdGVkKSkuIFRoaXMgYWxzbyB2aW9sYXRlcyB0aGUgcnVsZSBvZiB0aHVtYiBhYm91dFxuICAgIGZhdm9yaW5nIGFnZ3JlZ2F0aW9uIG92ZXIgaW5oZXJpdGFuY2UuXG4tIEN1cnJlbnRseSwgdGhlcmUgYXJlIHRocmVlIERhdGFzZXRDb2xsZWN0aW9uIHN1YmNsYXNzZXM6IExpc3QsIFBhaXIsIGFuZCBMaXN0UGFpcmVkLlxuICAgIFRoZXNlIGVhY2ggc2hvdWxkIGEpIGJlIHVzYWJsZSBvbiB0aGVpciBvd24sIGIpIGJlIHVzYWJsZSBpbiB0aGUgY29udGV4dCBvZlxuICAgIG5lc3Rpbmcgd2l0aGluIGEgY29sbGVjdGlvbiBtb2RlbCAoYXQgbGVhc3QgaW4gdGhlIGNhc2Ugb2YgTGlzdFBhaXJlZCksIGFuZFxuICAgIGMpIGJlIHVzYWJsZSB3aXRoaW4gdGhlIGNvbnRleHQgb2Ygb3RoZXIgY29udGFpbmVyIG1vZGVscyAobGlrZSBIaXN0b3J5IG9yXG4gICAgTGlicmFyeUZvbGRlciwgZXRjLikuIEkndmUgdHJpZWQgdG8gc2VwYXJhdGUvZXh0cmFjdCBjbGFzc2VzIGluIG9yZGVyIHRvXG4gICAgaGFuZGxlIHRob3NlIHRocmVlIHNpdHVhdGlvbnMsIGJ1dCBpdCdzIHByb3ZlbiBkaWZmaWN1bHQgdG8gZG8gaW4gYSBzaW1wbGUsXG4gICAgcmVhZGFibGUgbWFubmVyLlxuLSBJZGVhbGx5LCBoaXN0b3JpZXMgYW5kIGxpYnJhcmllcyB3b3VsZCBpbmhlcml0IGZyb20gdGhlIHNhbWUgc2VydmVyIG1vZGVscyBhc1xuICAgIGRhdGFzZXQgY29sbGVjdGlvbnMgZG8gc2luY2UgdGhleSBhcmUgKGluIGVzc2VuY2UpIGRhdGFzZXQgY29sbGVjdGlvbnMgdGhlbXNlbHZlcyAtXG4gICAgbWFraW5nIHRoZSB3aG9sZSBuZXN0ZWQgc3RydWN0dXJlIHNpbXBsZXIuIFRoaXMgd291bGQgYmUgYSBsYXJnZSwgZXJyb3ItcHJvbmVcbiAgICByZWZhY3RvcmluZyBhbmQgbWlncmF0aW9uLlxuXG5NYW55IG9mIHRoZSBjbGFzc2VzIGFuZCBoZWlyYXJjaHkgYXJlIG1lYW50IGFzIGV4dGVuc2lvbiBwb2ludHMgc28sIHdoaWxlIHRoZVxucmVsYXRpb25zIGFuZCBmbG93IG1heSBiZSBkaWZmaWN1bHQgdG8gdW5kZXJzdGFuZCBpbml0aWFsbHksIHRoZXknbGwgYWxsb3cgdXMgdG9cbmhhbmRsZSB0aGUgZ3Jvd3RoIG9yIGZsdXggZGF0YXNldCBjb2xsZWN0aW9uIGluIHRoZSBmdXR1cmUgKHcvbyBhY3R1YWxseSBpbXBsZW1lbnRpbmdcbmFueSBZQUdOSSkuXG5cbiovXG4vL19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18gRUxFTUVOVFNcbi8qKiBAY2xhc3MgbWl4aW4gZm9yIERhdGFzZXQgY29sbGVjdGlvbiBlbGVtZW50cy5cbiAqICAgICAgV2hlbiBjb2xsZWN0aW9uIGVsZW1lbnRzIGFyZSBwYXNzZWQgZnJvbSB0aGUgQVBJLCB0aGUgdW5kZXJseWluZyBlbGVtZW50IGlzXG4gKiAgICAgICAgICBpbiBhIHN1Yi1vYmplY3QgJ29iamVjdCcgKElPVywgYSBEQ0UgcmVwcmVzZW50aW5nIGFuIEhEQSB3aWxsIGhhdmUgSERBIGpzb24gaW4gZWxlbWVudC5vYmplY3QpLlxuICogICAgICBUaGlzIG1peGluIHVzZXMgdGhlIGNvbnN0cnVjdG9yIGFuZCBwYXJzZSBtZXRob2RzIHRvIG1lcmdlIHRoYXQgSlNPTiB3aXRoIHRoZSBEQ0UgYXR0cmlidHVlc1xuICogICAgICAgICAgZWZmZWN0aXZlbHkgY2hhbmdpbmcgYSBEQ0UgZnJvbSBhIGNvbnRhaW5lciB0byBhIHN1YmNsYXNzIChoYXMgYSAtLT4gaXMgYSkuXG4gKi9cbnZhciBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRNaXhpbiA9IHtcbiAgICAvKiogZGVmYXVsdCBhdHRyaWJ1dGVzIHVzZWQgYnkgZWxlbWVudHMgaW4gYSBkYXRhc2V0IGNvbGxlY3Rpb24gKi9cbiAgICBkZWZhdWx0czoge1xuICAgICAgICBtb2RlbF9jbGFzczogXCJEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRcIixcbiAgICAgICAgZWxlbWVudF9pZGVudGlmaWVyOiBudWxsLFxuICAgICAgICBlbGVtZW50X2luZGV4OiBudWxsLFxuICAgICAgICBlbGVtZW50X3R5cGU6IG51bGxcbiAgICB9LFxuXG4gICAgLyoqIG1lcmdlIHRoZSBhdHRyaWJ1dGVzIG9mIHRoZSBzdWItb2JqZWN0ICdvYmplY3QnIGludG8gdGhpcyBtb2RlbCAqL1xuICAgIF9tZXJnZU9iamVjdDogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICAvLyBpZiB3ZSBkb24ndCBwcmVzZXJ2ZSBhbmQgY29ycmVjdCBpZHMgaGVyZSwgdGhlIGVsZW1lbnQgaWQgYmVjb21lcyB0aGUgb2JqZWN0IGlkXG4gICAgICAgIC8vIGFuZCBjb2xsaXNpb24gaW4gYmFja2JvbmUncyBfYnlJZCB3aWxsIG9jY3VyIGFuZCBvbmx5XG4gICAgICAgIF8uZXh0ZW5kKGF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMub2JqZWN0LCB7XG4gICAgICAgICAgICBlbGVtZW50X2lkOiBhdHRyaWJ1dGVzLmlkXG4gICAgICAgIH0pO1xuICAgICAgICBkZWxldGUgYXR0cmlidXRlcy5vYmplY3Q7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICAgIH0sXG5cbiAgICAvKiogb3ZlcnJpZGUgdG8gbWVyZ2UgdGhpcy5vYmplY3QgaW50byB0aGlzICovXG4gICAgY29uc3RydWN0b3I6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgLy8gY29uc29sZS5kZWJ1ZyggJ1xcdCBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnQuY29uc3RydWN0b3I6JywgYXR0cmlidXRlcywgb3B0aW9ucyApO1xuICAgICAgICBhdHRyaWJ1dGVzID0gdGhpcy5fbWVyZ2VPYmplY3QoYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMuaWRBdHRyaWJ1dGUgPSBcImVsZW1lbnRfaWRcIjtcbiAgICAgICAgQmFja2JvbmUuTW9kZWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9LFxuXG4gICAgLyoqIHdoZW4gdGhlIG1vZGVsIGlzIGZldGNoZWQsIG1lcmdlIHRoaXMub2JqZWN0IGludG8gdGhpcyAqL1xuICAgIHBhcnNlOiBmdW5jdGlvbihyZXNwb25zZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IHJlc3BvbnNlO1xuICAgICAgICBhdHRyaWJ1dGVzID0gdGhpcy5fbWVyZ2VPYmplY3QoYXR0cmlidXRlcyk7XG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVzO1xuICAgIH1cbn07XG5cbi8qKiBAY2xhc3MgQ29uY3JldGUgY2xhc3Mgb2YgR2VuZXJpYyBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnQgKi9cbnZhciBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnQgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbilcbiAgICAuZXh0ZW5kKERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudE1peGluKVxuICAgIC5leHRlbmQoeyBfbG9nTmFtZXNwYWNlOiBcImNvbGxlY3Rpb25zXCIgfSk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIEJhc2UvQWJzdHJhY3QgQmFja2JvbmUgY29sbGVjdGlvbiBmb3IgR2VuZXJpYyBEQ0VzIC0gXG4gICAgY3VycmVudCBtYXkgYmUgYXNzb2NpYXRlZCB3aXRoIGEgZGF0YXNldCAoRGF0YXNldERDRUNvbGxlY3Rpb24pXG4gICAgb3IgYW5vdGhlciBjb2xsZWN0aW9uIChOZXN0ZWREQ0RDRUNvbGxlY3Rpb24pLlxuKi9cbnZhciBEQ0VDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgRENFQ29sbGVjdGlvbi5wcm90b3R5cGUgKi8ge1xuICAgICAgICBfbG9nTmFtZXNwYWNlOiBcImNvbGxlY3Rpb25zXCIsXG5cbiAgICAgICAgbW9kZWw6IERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudCxcblxuICAgICAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uLiAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gW1wiRGF0YXNldENvbGxlY3Rpb25FbGVtZW50Q29sbGVjdGlvbihcIiwgdGhpcy5sZW5ndGgsIFwiKVwiXS5qb2luKFwiXCIpO1xuICAgICAgICB9XG4gICAgfVxuKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBAY2xhc3MgQmFja2JvbmUgbW9kZWwgZm9yIGEgZGF0YXNldCBjb2xsZWN0aW9uIGVsZW1lbnQgdGhhdCBpcyBhIGRhdGFzZXQgKEhEQSkuXG4gKi9cbnZhciBEYXRhc2V0RENFID0gREFUQVNFVF9NT0RFTC5EYXRhc2V0QXNzb2NpYXRpb24uZXh0ZW5kKFxuICAgIEJBU0VfTVZDLm1peGluKFxuICAgICAgICBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRNaXhpbixcbiAgICAgICAgLyoqIEBsZW5kcyBEYXRhc2V0RENFLnByb3RvdHlwZSAqLyB7XG4gICAgICAgICAgICAvKiogdXJsIGZuICovXG4gICAgICAgICAgICB1cmw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIHdvbid0IGFsd2F5cyBiZSBhbiBoZGFcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaGFzKFwiaGlzdG9yeV9pZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJubyBlbmRwb2ludCBmb3Igbm9uLWhkYXMgd2l0aGluIGEgY29sbGVjdGlvbiB5ZXRcIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIChhIGxpdHRsZSBzaWxseSBzaW5jZSB0aGlzIGFwaSBlbmRwb2ludCAqYWxzbyogcG9pbnRzIGF0IGhkYXMpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtHYWxheHkucm9vdH1hcGkvZGF0YXNldHNgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllcy8ke3RoaXMuZ2V0KFwiaGlzdG9yeV9pZFwiKX0vY29udGVudHMvJHt0aGlzLmdldChcImlkXCIpfWA7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBkZWZhdWx0czogXy5leHRlbmQoXG4gICAgICAgICAgICAgICAge30sXG4gICAgICAgICAgICAgICAgREFUQVNFVF9NT0RFTC5EYXRhc2V0QXNzb2NpYXRpb24ucHJvdG90eXBlLmRlZmF1bHRzLFxuICAgICAgICAgICAgICAgIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudE1peGluLmRlZmF1bHRzXG4gICAgICAgICAgICApLFxuXG4gICAgICAgICAgICBfZG93bmxvYWRRdWVyeVBhcmFtZXRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBmaWxlRXh0ID0gdGhpcy5nZXQoXCJmaWxlX2V4dFwiKTtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudElkZW50aWZpZXIgPSB0aGlzLmdldChcImVsZW1lbnRfaWRlbnRpZmllclwiKTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50SGRjYUlkID0gdGhpcy5nZXQoXCJwYXJlbnRfaGRjYV9pZFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYD90b19leHQ9JHtmaWxlRXh0fSZoZGNhX2lkPSR7cGFyZW50SGRjYUlkfSZlbGVtZW50X2lkZW50aWZpZXI9JHtlbGVtZW50SWRlbnRpZmllcn1gO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gYmVjYXVzZSBhbGwgb2JqZWN0cyBoYXZlIGNvbnN0cnVjdG9ycyAoYXMgdGhpcyBoYXNobWFwIHdvdWxkIGV2ZW4gaWYgdGhpcyBuZXh0IGxpbmUgd2Fzbid0IHByZXNlbnQpXG4gICAgICAgICAgICAvLyAgdGhlIGNvbnN0cnVjdG9yIGluIGhjb250ZW50TWl4aW4gd29uJ3QgYmUgYXR0YWNoZWQgYnkgQkFTRV9NVkMubWl4aW4gdG8gdGhpcyBtb2RlbFxuICAgICAgICAgICAgLy8gIC0gcmUtYXBwbHkgbWFudWFsbHkgZm9yIG5vd1xuICAgICAgICAgICAgLyoqIGNhbGwgdGhlIG1peGluIGNvbnN0cnVjdG9yICovXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcjogZnVuY3Rpb24oYXR0cmlidXRlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVidWcoXCJcXHQgRGF0YXNldERDRS5jb25zdHJ1Y3RvcjpcIiwgYXR0cmlidXRlcywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgLy9EQVRBU0VUX01PREVMLkRhdGFzZXRBc3NvY2lhdGlvbi5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCggdGhpcywgYXR0cmlidXRlcywgb3B0aW9ucyApO1xuICAgICAgICAgICAgICAgIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudE1peGluLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgYXR0cmlidXRlcywgb3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogRG9lcyB0aGlzIG1vZGVsIGFscmVhZHkgY29udGFpbiBkZXRhaWxlZCBkYXRhIChhcyBvcHBvc2VkIHRvIGp1c3Qgc3VtbWFyeSBsZXZlbCBkYXRhKT8gKi9cbiAgICAgICAgICAgIGhhc0RldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzICYmIHRoaXMuZWxlbWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIFN0cmluZyByZXByZXNlbnRhdGlvbi4gKi9cbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqU3RyID0gdGhpcy5nZXQoXCJlbGVtZW50X2lkZW50aWZpZXJcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBEYXRhc2V0RENFKHtvYmpTdHJ9KWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICApXG4pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEBjbGFzcyBEQ0VDb2xsZWN0aW9uIG9mIERhdGFzZXREQ0UncyAoYSBsaXN0IG9mIGRhdGFzZXRzLCBhIHBhaXIgb2YgZGF0YXNldHMpLlxuICovXG52YXIgRGF0YXNldERDRUNvbGxlY3Rpb24gPSBEQ0VDb2xsZWN0aW9uLmV4dGVuZChcbiAgICAvKiogQGxlbmRzIERhdGFzZXREQ0VDb2xsZWN0aW9uLnByb3RvdHlwZSAqLyB7XG4gICAgICAgIG1vZGVsOiBEYXRhc2V0RENFLFxuXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXCJEYXRhc2V0RENFQ29sbGVjdGlvbihcIiwgdGhpcy5sZW5ndGgsIFwiKVwiXS5qb2luKFwiXCIpO1xuICAgICAgICB9XG4gICAgfVxuKTtcblxuLy9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIENPTExFQ1RJT05TXG4vKiogQGNsYXNzIEJhY2tib25lIG1vZGVsIGZvciBEYXRhc2V0IENvbGxlY3Rpb25zLlxuICogICAgICBUaGUgREMgQVBJIHJldHVybnMgYW4gYXJyYXkgb2YgSlNPTiBvYmplY3RzIHVuZGVyIHRoZSBhdHRyaWJ1dGUgZWxlbWVudHMuXG4gKiAgICAgIFRoaXMgbW9kZWw6XG4gKiAgICAgICAgICAtIHJlbW92ZXMgdGhhdCBhcnJheS9hdHRyaWJ1dGUgKCdlbGVtZW50cycpIGZyb20gdGhlIG1vZGVsLFxuICogICAgICAgICAgLSBjcmVhdGVzIGEgYmJvbmUgY29sbGVjdGlvbiAob2YgdGhlIGNsYXNzIGRlZmluZWQgaW4gdGhlICdjb2xsZWN0aW9uQ2xhc3MnIGF0dHJpYnV0ZSksXG4gKiAgICAgICAgICAtIHBhc3NlcyB0aGF0IGpzb24gb250byB0aGUgYmJvbmUgY29sbGVjdGlvblxuICogICAgICAgICAgLSBjYWNoZXMgdGhlIGJib25lIGNvbGxlY3Rpb24gaW4gdGhpcy5lbGVtZW50c1xuICovXG52YXIgRGF0YXNldENvbGxlY3Rpb24gPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbilcbiAgICAuZXh0ZW5kKEJBU0VfTVZDLlNlYXJjaGFibGVNb2RlbE1peGluKVxuICAgIC5leHRlbmQoXG4gICAgICAgIC8qKiBAbGVuZHMgRGF0YXNldENvbGxlY3Rpb24ucHJvdG90eXBlICovIHtcbiAgICAgICAgICAgIF9sb2dOYW1lc3BhY2U6IFwiY29sbGVjdGlvbnNcIixcblxuICAgICAgICAgICAgLyoqIGRlZmF1bHQgYXR0cmlidXRlcyBmb3IgYSBtb2RlbCAqL1xuICAgICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgICAgICAvKiAnbGlzdCcsICdwYWlyZWQnLCBvciAnbGlzdDpwYWlyZWQnICovXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbl90eXBlOiBudWxsLFxuICAgICAgICAgICAgICAgIC8vPz9cbiAgICAgICAgICAgICAgICBkZWxldGVkOiBmYWxzZVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIFdoaWNoIGNsYXNzIHRvIHVzZSBmb3IgZWxlbWVudHMgKi9cbiAgICAgICAgICAgIGNvbGxlY3Rpb25DbGFzczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXR0cmlidXRlcy5jb2xsZWN0aW9uX3R5cGUuaW5kZXhPZihcIjpcIikgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBOZXN0ZWREQ0RDRUNvbGxlY3Rpb247XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERhdGFzZXREQ0VDb2xsZWN0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBzZXQgdXA6IGNyZWF0ZSBlbGVtZW50cyBpbnN0YW5jZSB2YXIgYW5kIChvbiBjaGFuZ2VzIHRvIGVsZW1lbnRzKSB1cGRhdGUgdGhlbSAgKi9cbiAgICAgICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG1vZGVsLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhgJHt0aGlzfShEYXRhc2V0Q29sbGVjdGlvbikuaW5pdGlhbGl6ZTpgLCBtb2RlbCwgb3B0aW9ucywgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cyA9IHRoaXMuX2NyZWF0ZUVsZW1lbnRzTW9kZWwoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwiY2hhbmdlOmVsZW1lbnRzXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhcImNoYW5nZTplbGVtZW50c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgLy9UT0RPOiBwcm9iLiBiZXR0ZXIgdG8gdXBkYXRlIHRoZSBjb2xsZWN0aW9uIGluc3RlYWQgb2YgcmUtY3JlYXRpbmcgaXRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cyA9IHRoaXMuX2NyZWF0ZUVsZW1lbnRzTW9kZWwoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBtb3ZlIGVsZW1lbnRzIG1vZGVsIGF0dHJpYnV0ZSB0byBmdWxsIGNvbGxlY3Rpb24gKi9cbiAgICAgICAgICAgIF9jcmVhdGVFbGVtZW50c01vZGVsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbkNsYXNzID0gdGhpcy5jb2xsZWN0aW9uQ2xhc3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRlYnVnKGAke3RoaXN9Ll9jcmVhdGVFbGVtZW50c01vZGVsYCwgY29sbGVjdGlvbkNsYXNzLCB0aGlzLmdldChcImVsZW1lbnRzXCIpLCB0aGlzLmVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAvL1RPRE86IHNhbWUgcGF0dGVybnMgYXMgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50IF9jcmVhdGVPYmplY3RNb2RlbCAtIHJlZmFjdG9yIHRvIEJBU0VfTVZDLmhhc1N1Yk1vZGVsP1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuZ2V0KFwiZWxlbWVudHNcIikgfHwgW107XG4gICAgICAgICAgICAgICAgdGhpcy51bnNldChcImVsZW1lbnRzXCIsIHsgc2lsZW50OiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgICAgICBfLmVhY2goZWxlbWVudHMsIChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBfLmV4dGVuZChlbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfaGRjYV9pZDogc2VsZi5nZXQoXCJpZFwiKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gbmV3IGNvbGxlY3Rpb25DbGFzcyhlbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnY29sbGVjdGlvbkNsYXNzOicsIHRoaXMuY29sbGVjdGlvbkNsYXNzICsgJycsIHRoaXMuZWxlbWVudHMgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50cztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjb21tb24gcXVlcmllc1xuICAgICAgICAgICAgLyoqIHBhc3MgdGhlIGVsZW1lbnRzIGJhY2sgd2l0aGluIHRoZSBtb2RlbCBqc29uIHdoZW4gdGhpcyBpcyBzZXJpYWxpemVkICovXG4gICAgICAgICAgICB0b0pTT046IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBqc29uID0gQmFja2JvbmUuTW9kZWwucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGpzb24uZWxlbWVudHMgPSB0aGlzLmVsZW1lbnRzLnRvSlNPTigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ganNvbjtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBJcyB0aGlzIGNvbGxlY3Rpb24gaW4gYSAncmVhZHknIHN0YXRlIG5vIHByb2Nlc3NpbmcgKGZvciB0aGUgY29sbGVjdGlvbikgaXMgbGVmdFxuICAgICAgICAgICAgICogIHRvIGRvIG9uIHRoZSBzZXJ2ZXIuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGluUmVhZHlTdGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvcHVsYXRlZCA9IHRoaXMuZ2V0KFwicG9wdWxhdGVkXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRGVsZXRlZE9yUHVyZ2VkKCkgfHwgcG9wdWxhdGVkO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy9UT0RPOj8/IHRoZSBmb2xsb3dpbmcgYXJlIHRoZSBzYW1lIGludGVyZmFjZSBhcyBEYXRhc2V0QXNzb2NpYXRpb24gLSBjYW4gd2UgY29tYmluZT9cbiAgICAgICAgICAgIC8qKiBEb2VzIHRoZSBEQyBjb250YWluIGFueSBlbGVtZW50cyB5ZXQ/IElzIGEgZmV0Y2goKSByZXF1aXJlZD8gKi9cbiAgICAgICAgICAgIGhhc0RldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmxlbmd0aCAhPT0gMDtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBHaXZlbiB0aGUgZmlsdGVycywgd2hhdCBtb2RlbHMgaW4gdGhpcy5lbGVtZW50cyB3b3VsZCBiZSByZXR1cm5lZD8gKi9cbiAgICAgICAgICAgIGdldFZpc2libGVDb250ZW50czogZnVuY3Rpb24oZmlsdGVycykge1xuICAgICAgICAgICAgICAgIC8vIGZpbHRlcnMgdW51c2VkIGZvciBub3dcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50cztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBhamF4XG4gICAgICAgICAgICAvKiogb3ZlcnJpZGUgdG8gdXNlIGFjdHVhbCBEYXRlcyBvYmplY3RzIGZvciBjcmVhdGUvdXBkYXRlIHRpbWVzICovXG4gICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24ocmVzcG9uc2UsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkID0gQmFja2JvbmUuTW9kZWwucHJvdG90eXBlLnBhcnNlLmNhbGwodGhpcywgcmVzcG9uc2UsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZWQuY3JlYXRlX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkLmNyZWF0ZV90aW1lID0gbmV3IERhdGUocGFyc2VkLmNyZWF0ZV90aW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZC51cGRhdGVfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWQudXBkYXRlX3RpbWUgPSBuZXcgRGF0ZShwYXJzZWQudXBkYXRlX3RpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIHNhdmUgdGhpcyBjb2xsZWN0aW9uLCBfTWFya19pbmcgaXQgYXMgZGVsZXRlZCAoanVzdCBhIGZsYWcpICovXG4gICAgICAgICAgICBkZWxldGU6IGZ1bmN0aW9uKHJlY3Vyc2l2ZSwgcHVyZ2UsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICByZWN1cnNpdmUgPSByZWN1cnNpdmUgfHwgZmFsc2U7XG4gICAgICAgICAgICAgICAgcHVyZ2UgPSBwdXJnZSB8fCBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcHRpb25zID0gVXRpbHMubWVyZ2Uob3B0aW9ucywgeyBtZXRob2Q6IFwiZGVsZXRlXCIgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZSh7IGRlbGV0ZWQ6IHRydWUsIHJlY3Vyc2l2ZTogcmVjdXJzaXZlLCBwdXJnZTogcHVyZ2UgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqIHNhdmUgdGhpcyBjb2xsZWN0aW9uLCBfTWFya19pbmcgaXQgYXMgdW5kZWxldGVkICovXG4gICAgICAgICAgICB1bmRlbGV0ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXQoXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zYXZlKHsgZGVsZXRlZDogZmFsc2UgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogSXMgdGhpcyBjb2xsZWN0aW9uIGRlbGV0ZWQgb3IgcHVyZ2VkPyAqL1xuICAgICAgICAgICAgaXNEZWxldGVkT3JQdXJnZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldChcImRlbGV0ZWRcIikgfHwgdGhpcy5nZXQoXCJwdXJnZWRcIik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gc2VhcmNoYWJsZVxuICAgICAgICAgICAgLyoqIHNlYXJjaGFibGUgYXR0cmlidXRlcyBmb3IgY29sbGVjdGlvbnMgKi9cbiAgICAgICAgICAgIHNlYXJjaEF0dHJpYnV0ZXM6IFtcIm5hbWVcIiwgXCJ0YWdzXCJdLFxuXG4gICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAgICAgLyoqIFN0cmluZyByZXByZXNlbnRhdGlvbiAqL1xuICAgICAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBpZEFuZE5hbWUgPSBbdGhpcy5nZXQoXCJpZFwiKSwgdGhpcy5nZXQoXCJuYW1lXCIpIHx8IHRoaXMuZ2V0KFwiZWxlbWVudF9pZGVudGlmaWVyXCIpXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYERhdGFzZXRDb2xsZWN0aW9uKCR7aWRBbmROYW1lLmpvaW4oXCIsXCIpfSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKTtcblxuLy9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fIE5FU1RFRCBDT0xMRUNUSU9OU1xuLy8gdGhpcyBpcyB3aGVyZSB0aGluZ3MgZ2V0IHdlaXJkLCBtYW4uIFdlaXJkLlxuLy9UT0RPOiBpdCBtaWdodCBiZSBwb3NzaWJsZSB0byBjb21wYWN0IGFsbCB0aGUgZm9sbG93aW5nLi4uSSB0aGluay5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIEJhY2tib25lIG1vZGVsIGZvciBhIEdlbmVyaWMgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50IHRoYXQgaXMgYWxzbyBhIERhdGFzZXRDb2xsZWN0aW9uXG4gKiAgICAgIChhIG5lc3RlZCBjb2xsZWN0aW9uKS5cbiAqL1xudmFyIE5lc3RlZERDRENFID0gRGF0YXNldENvbGxlY3Rpb24uZXh0ZW5kKFxuICAgIEJBU0VfTVZDLm1peGluKFxuICAgICAgICBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnRNaXhpbixcbiAgICAgICAgLyoqIEBsZW5kcyBOZXN0ZWREQ0RDRS5wcm90b3R5cGUgKi8ge1xuICAgICAgICAgICAgLy8gYmVjYXVzZSBhbGwgb2JqZWN0cyBoYXZlIGNvbnN0cnVjdG9ycyAoYXMgdGhpcyBoYXNobWFwIHdvdWxkIGV2ZW4gaWYgdGhpcyBuZXh0IGxpbmUgd2Fzbid0IHByZXNlbnQpXG4gICAgICAgICAgICAvLyAgdGhlIGNvbnN0cnVjdG9yIGluIGhjb250ZW50TWl4aW4gd29uJ3QgYmUgYXR0YWNoZWQgYnkgQkFTRV9NVkMubWl4aW4gdG8gdGhpcyBtb2RlbFxuICAgICAgICAgICAgLy8gIC0gcmUtYXBwbHkgbWFudWFsbHkgaXQgbm93XG4gICAgICAgICAgICAvKiogY2FsbCB0aGUgbWl4aW4gY29uc3RydWN0b3IgKi9cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbihhdHRyaWJ1dGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcIlxcdCBOZXN0ZWREQ0RDRS5jb25zdHJ1Y3RvcjpcIiwgYXR0cmlidXRlcywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50TWl4aW4uY29uc3RydWN0b3IuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzLCBvcHRpb25zKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24uICovXG4gICAgICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9ialN0ciA9IHRoaXMub2JqZWN0ID8gYCR7dGhpcy5vYmplY3R9YCA6IHRoaXMuZ2V0KFwiZWxlbWVudF9pZGVudGlmaWVyXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBbXCJOZXN0ZWREQ0RDRShcIiwgb2JqU3RyLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIClcbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIEJhY2tib25lIGNvbGxlY3Rpb24gY29udGFpbmluZyBHZW5lcmljIE5lc3RlZERDRENFJ3MgKG5lc3RlZCBkYXRhc2V0IGNvbGxlY3Rpb25zKS5cbiAqL1xudmFyIE5lc3RlZERDRENFQ29sbGVjdGlvbiA9IERDRUNvbGxlY3Rpb24uZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgTmVzdGVkRENEQ0VDb2xsZWN0aW9uLnByb3RvdHlwZSAqLyB7XG4gICAgICAgIC8qKiBUaGlzIGlzIGEgY29sbGVjdGlvbiBvZiBuZXN0ZWQgY29sbGVjdGlvbnMgKi9cbiAgICAgICAgbW9kZWw6IE5lc3RlZERDRENFLFxuXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXCJOZXN0ZWREQ0RDRUNvbGxlY3Rpb24oXCIsIHRoaXMubGVuZ3RoLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgRGF0YXNldENvbGxlY3Rpb246IERhdGFzZXRDb2xsZWN0aW9uXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tbW9kZWwuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqQ0E7QUFDQTtBQW1DQTtBQUNBO0FBQ0E7QUFHQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBV0E7QUFDQTs7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1Q0E7QUFDQTtBQWdEQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBU0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUhBO0FBQ0E7QUErSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFkQTtBQUNBO0FBa0JBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///30\n");

/***/ }),
/* 31 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-model.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _historyContents = __webpack_require__(/*! mvc/history/history-contents */ 16);\n\nvar _historyContents2 = _interopRequireDefault(_historyContents);\n\nvar _controlledFetchCollection = __webpack_require__(/*! mvc/base/controlled-fetch-collection */ 56);\n\nvar _controlledFetchCollection2 = _interopRequireDefault(_controlledFetchCollection);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _underscore = __webpack_require__(/*! libs/underscore */ 1);\n\nvar _ = _interopRequireWildcard(_underscore);\n\nvar _backbone = __webpack_require__(/*! libs/backbone */ 2);\n\nvar Backbone = _interopRequireWildcard(_backbone);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* global jQuery */\n/* global Galaxy */\n\n//==============================================================================\n/** @class Model for a Galaxy history resource - both a record of user\n *      tool use and a collection of the datasets those tools produced.\n *  @name History\n *  @augments Backbone.Model\n */\nvar History = Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.mixin(_baseMvc2.default.SearchableModelMixin,\n/** @lends History.prototype */{\n    _logNamespace: \"history\",\n\n    /** ms between fetches when checking running jobs/datasets for updates */\n    UPDATE_DELAY: 4000,\n\n    // values from api (may need more)\n    defaults: {\n        model_class: \"History\",\n        id: null,\n        name: \"Unnamed History\",\n        state: \"new\",\n\n        deleted: false,\n        contents_active: {},\n        contents_states: {}\n    },\n\n    urlRoot: Galaxy.root + \"api/histories\",\n\n    contentsClass: _historyContents2.default.HistoryContents,\n\n    /** What model fields to search with */\n    searchAttributes: [\"name\", \"annotation\", \"tags\"],\n\n    /** Adding title and singular tag */\n    searchAliases: {\n        title: \"name\",\n        tag: \"tags\"\n    },\n\n    // ........................................................................ set up/tear down\n    /** Set up the model\n     *  @param {Object} historyJSON model data for this History\n     *  @param {Object} options     any extra settings including logger\n     */\n    initialize: function initialize(historyJSON, options) {\n        options = options || {};\n        this.logger = options.logger || null;\n        this.log(this + \".initialize:\", historyJSON, options);\n\n        /** HistoryContents collection of the HDAs contained in this history. */\n        this.contents = new this.contentsClass([], {\n            history: this,\n            historyId: this.get(\"id\"),\n            order: options.order\n        });\n\n        this._setUpListeners();\n        this._setUpCollectionListeners();\n\n        /** cached timeout id for the dataset updater */\n        this.updateTimeoutId = null;\n    },\n\n    /** set up any event listeners for this history including those to the contained HDAs\n     *  events: error:contents  if an error occurred with the contents collection\n     */\n    _setUpListeners: function _setUpListeners() {\n        // if the model's id changes ('current' or null -> an actual id), update the contents history_id\n        return this.on({\n            error: function error(model, xhr, options, msg, details) {\n                this.clearUpdateTimeout();\n            },\n            \"change:id\": function changeId(model, newId) {\n                if (this.contents) {\n                    this.contents.historyId = newId;\n                }\n            }\n        });\n    },\n\n    /** event handlers for the contents submodels */\n    _setUpCollectionListeners: function _setUpCollectionListeners() {\n        if (!this.contents) {\n            return this;\n        }\n        // bubble up errors\n        return this.listenTo(this.contents, {\n            error: function error() {\n                this.trigger.apply(this, jQuery.makeArray(arguments));\n            }\n        });\n    },\n\n    // ........................................................................ derived attributes\n    /**  */\n    contentsShown: function contentsShown() {\n        var contentsActive = this.get(\"contents_active\");\n        var shown = contentsActive.active || 0;\n        shown += this.contents.includeDeleted ? contentsActive.deleted : 0;\n        shown += this.contents.includeHidden ? contentsActive.hidden : 0;\n        return shown;\n    },\n\n    /** convert size in bytes to a more human readable version */\n    nice_size: function nice_size() {\n        var size = this.get(\"size\");\n        return size ? _utils2.default.bytesToString(size, true, 2) : (0, _localization2.default)(\"(empty)\");\n    },\n\n    /** override to add nice_size */\n    toJSON: function toJSON() {\n        return _.extend(Backbone.Model.prototype.toJSON.call(this), {\n            nice_size: this.nice_size()\n        });\n    },\n\n    /** override to allow getting nice_size */\n    get: function get(key) {\n        if (key === \"nice_size\") {\n            return this.nice_size();\n        }\n        return Backbone.Model.prototype.get.apply(this, arguments);\n    },\n\n    // ........................................................................ common queries\n    /** T/F is this history owned by the current user (Galaxy.user)\n     *      Note: that this will return false for an anon user even if the history is theirs.\n     */\n    ownedByCurrUser: function ownedByCurrUser() {\n        // no currUser\n        if (!Galaxy || !Galaxy.user) {\n            return false;\n        }\n        // user is anon or history isn't owned\n        if (Galaxy.user.isAnonymous() || Galaxy.user.id !== this.get(\"user_id\")) {\n            return false;\n        }\n        return true;\n    },\n\n    /** Return the number of running jobs assoc with this history (note: unknown === 0) */\n    numOfUnfinishedJobs: function numOfUnfinishedJobs() {\n        var unfinishedJobIds = this.get(\"non_ready_jobs\");\n        return unfinishedJobIds ? unfinishedJobIds.length : 0;\n    },\n\n    /** Return the number of running hda/hdcas in this history (note: unknown === 0) */\n    numOfUnfinishedShownContents: function numOfUnfinishedShownContents() {\n        return this.contents.runningAndActive().length || 0;\n    },\n\n    // ........................................................................ updates\n    _fetchContentRelatedAttributes: function _fetchContentRelatedAttributes() {\n        var contentRelatedAttrs = [\"size\", \"non_ready_jobs\", \"contents_active\", \"hid_counter\"];\n        return this.fetch({\n            data: jQuery.param({\n                keys: contentRelatedAttrs.join(\",\")\n            })\n        });\n    },\n\n    /** check for any changes since the last time we updated (or fetch all if ) */\n    refresh: function refresh(options) {\n        var _this = this;\n\n        // console.log( this + '.refresh' );\n        options = options || {};\n\n        // note if there was no previous update time, all summary contents will be fetched\n        var lastUpdateTime = this.lastUpdateTime;\n        // if we don't flip this, then a fully-fetched list will not be re-checked via fetch\n        this.contents.allFetched = false;\n        var fetchFn = this.contents.currentPage !== 0 ? function () {\n            return _this.contents.fetchPage(_this.contents.currentPage);\n        } : function () {\n            return _this.contents.fetchUpdated(lastUpdateTime);\n        };\n        // note: if there was no previous update time, all summary contents will be fetched\n        return fetchFn().done(function (response, status, xhr) {\n            var serverResponseDatetime;\n            try {\n                serverResponseDatetime = new Date(xhr.getResponseHeader(\"Date\"));\n            } catch (err) {\n                console.error(err);\n            }\n            _this.lastUpdateTime = serverResponseDatetime || new Date();\n            _this.checkForUpdates(options);\n        });\n    },\n\n    /** continuously fetch updated contents every UPDATE_DELAY ms if this history's datasets or jobs are unfinished */\n    checkForUpdates: function checkForUpdates(options) {\n        var _this2 = this;\n\n        // console.log( this + '.checkForUpdates' );\n        options = options || {};\n        var delay = this.UPDATE_DELAY;\n        if (!this.id) {\n            return;\n        }\n\n        var _delayThenUpdate = function _delayThenUpdate() {\n            // prevent buildup of updater timeouts by clearing previous if any, then set new and cache id\n            _this2.clearUpdateTimeout();\n            _this2.updateTimeoutId = setTimeout(function () {\n                _this2.refresh(options);\n            }, delay);\n        };\n\n        // if there are still datasets in the non-ready state, recurse into this function with the new time\n        var nonReadyContentCount = this.numOfUnfinishedShownContents();\n        // console.log( 'nonReadyContentCount:', nonReadyContentCount );\n        if (nonReadyContentCount > 0) {\n            _delayThenUpdate();\n        } else {\n            // no datasets are running, but currently runnning jobs may still produce new datasets\n            // see if the history has any running jobs and continue to update if so\n            // (also update the size for the user in either case)\n            this._fetchContentRelatedAttributes().done(function (historyData) {\n                // console.log( 'non_ready_jobs:', historyData.non_ready_jobs );\n                if (_this2.numOfUnfinishedJobs() > 0) {\n                    _delayThenUpdate();\n                } else {\n                    // otherwise, let listeners know that all updates have stopped\n                    _this2.trigger(\"ready\");\n                }\n            });\n        }\n    },\n\n    /** clear the timeout and the cached timeout id */\n    clearUpdateTimeout: function clearUpdateTimeout() {\n        if (this.updateTimeoutId) {\n            clearTimeout(this.updateTimeoutId);\n            this.updateTimeoutId = null;\n        }\n    },\n\n    stopPolling: function stopPolling() {\n        this.clearUpdateTimeout();\n        if (this.contents) {\n            this.contents.stopPolling();\n        }\n    },\n\n    // ........................................................................ ajax\n    /** override to use actual Dates objects for create/update times */\n    parse: function parse(response, options) {\n        var parsed = Backbone.Model.prototype.parse.call(this, response, options);\n        if (parsed.create_time) {\n            parsed.create_time = new Date(parsed.create_time);\n        }\n        if (parsed.update_time) {\n            parsed.update_time = new Date(parsed.update_time);\n        }\n        return parsed;\n    },\n\n    /** fetch this histories data (using options) then it's contents (using contentsOptions) */\n    fetchWithContents: function fetchWithContents(options, contentsOptions) {\n        options = options || {};\n        var self = this;\n\n        // console.log( this + '.fetchWithContents' );\n        // TODO: push down to a base class\n        options.view = \"dev-detailed\";\n\n        // fetch history then use history data to fetch (paginated) contents\n        return this.fetch(options).then(function getContents(history) {\n            self.contents.history = self;\n            self.contents.setHistoryId(history.id);\n            return self.fetchContents(contentsOptions);\n        });\n    },\n\n    /** fetch this histories contents, adjusting options based on the stored history preferences */\n    fetchContents: function fetchContents(options) {\n        options = options || {};\n\n        // we're updating, reset the update time\n        this.lastUpdateTime = new Date();\n        return this.contents.fetchCurrentPage(options);\n    },\n\n    /** save this history, _Mark_ing it as deleted (just a flag) */\n    _delete: function _delete(options) {\n        if (this.get(\"deleted\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: true }, options);\n    },\n    /** purge this history, _Mark_ing it as purged and removing all dataset data from the server */\n    purge: function purge(options) {\n        if (this.get(\"purged\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: true, purged: true }, options);\n    },\n    /** save this history, _Mark_ing it as undeleted */\n    undelete: function undelete(options) {\n        if (!this.get(\"deleted\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: false }, options);\n    },\n\n    /** Make a copy of this history on the server\n     *  @param {Boolean} current    if true, set the copy as the new current history (default: true)\n     *  @param {String} name        name of new history (default: none - server sets to: Copy of <current name>)\n     *  @fires copied               passed this history and the response JSON from the copy\n     *  @returns {xhr}\n     */\n    copy: function copy(current, name, allDatasets) {\n        current = current !== undefined ? current : true;\n        if (!this.id) {\n            throw new Error(\"You must set the history ID before copying it.\");\n        }\n\n        var postData = { history_id: this.id };\n        if (current) {\n            postData.current = true;\n        }\n        if (name) {\n            postData.name = name;\n        }\n        if (!allDatasets) {\n            postData.all_datasets = false;\n        }\n        postData.view = \"dev-detailed\";\n\n        var history = this;\n        var copy = jQuery.post(this.urlRoot, postData);\n        // if current - queue to setAsCurrent before firing 'copied'\n        if (current) {\n            return copy.then(function (response) {\n                var newHistory = new History(response);\n                return newHistory.setAsCurrent().done(function () {\n                    history.trigger(\"copied\", history, response);\n                });\n            });\n        }\n        return copy.done(function (response) {\n            history.trigger(\"copied\", history, response);\n        });\n    },\n\n    setAsCurrent: function setAsCurrent() {\n        var history = this;\n\n        var xhr = jQuery.getJSON(Galaxy.root + \"history/set_as_current?id=\" + this.id);\n\n        xhr.done(function () {\n            history.trigger(\"set-as-current\", history);\n        });\n        return xhr;\n    },\n\n    // ........................................................................ misc\n    toString: function toString() {\n        return \"History(\" + this.get(\"id\") + \",\" + this.get(\"name\") + \")\";\n    }\n}));\n\n//==============================================================================\nvar _collectionSuper = _controlledFetchCollection2.default.InfinitelyScrollingCollection;\n/** @class A collection of histories (per user)\n *      that maintains the current history as the first in the collection.\n *  New or copied histories become the current history.\n */\nvar HistoryCollection = _collectionSuper.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: \"history\",\n\n    model: History,\n    /** @type {String} initial order used by collection */\n    order: \"update_time\",\n    /** @type {Number} limit used for the first fetch (or a reset) */\n    limitOnFirstFetch: 10,\n    /** @type {Number} limit used for each subsequent fetch */\n    limitPerFetch: 10,\n\n    initialize: function initialize(models, options) {\n        options = options || {};\n        this.log(\"HistoryCollection.initialize\", models, options);\n        _collectionSuper.prototype.initialize.call(this, models, options);\n\n        /** @type {boolean} should deleted histories be included */\n        this.includeDeleted = options.includeDeleted || false;\n\n        /** @type {String} encoded id of the history that's current */\n        this.currentHistoryId = options.currentHistoryId;\n\n        this.setUpListeners();\n        // note: models are sent to reset *after* this fn ends; up to this point\n        // the collection *is empty*\n    },\n\n    urlRoot: Galaxy.root + \"api/histories\",\n    url: function url() {\n        return this.urlRoot;\n    },\n\n    /** set up reflexive event handlers */\n    setUpListeners: function setUpListeners() {\n        return this.on({\n            // when a history is deleted, remove it from the collection (if optionally set to do so)\n            \"change:deleted\": function changeDeleted(history) {\n                // TODO: this becomes complicated when more filters are used\n                this.debug(\"change:deleted\", this.includeDeleted, history.get(\"deleted\"));\n                if (!this.includeDeleted && history.get(\"deleted\")) {\n                    this.remove(history);\n                }\n            },\n            // listen for a history copy, setting it to current\n            copied: function copied(original, newData) {\n                this.setCurrent(new History(newData, []));\n            },\n            // when a history is made current, track the id in the collection\n            \"set-as-current\": function setAsCurrent(history) {\n                var oldCurrentId = this.currentHistoryId;\n                this.trigger(\"no-longer-current\", oldCurrentId);\n                this.currentHistoryId = history.id;\n            }\n        });\n    },\n\n    /** override to change view */\n    _buildFetchData: function _buildFetchData(options) {\n        return _.extend(_collectionSuper.prototype._buildFetchData.call(this, options), {\n            view: \"dev-detailed\"\n        });\n    },\n\n    /** override to filter out deleted and purged */\n    _buildFetchFilters: function _buildFetchFilters(options) {\n        var superFilters = _collectionSuper.prototype._buildFetchFilters.call(this, options) || {};\n        var filters = {};\n        if (this.includeDeleted !== true) {\n            filters.deleted = false;\n            filters.purged = false;\n        } else {\n            // force API to return both deleted and non\n            //TODO: when the API is updated, remove this\n            filters.deleted = null;\n        }\n        return _.defaults(superFilters, filters);\n    },\n\n    /** override to fetch current as well (as it may be outside the first 10, etc.) */\n    fetchFirst: function fetchFirst(options) {\n        var _this3 = this;\n\n        // TODO: batch?\n        var xhr = jQuery.when();\n        if (this.currentHistoryId) {\n            xhr = _collectionSuper.prototype.fetchFirst.call(this, {\n                silent: true,\n                limit: 1,\n                filters: {\n                    \"encoded_id-in\": this.currentHistoryId,\n                    // without these a deleted current history will return [] here and block the other xhr\n                    deleted: null,\n                    purged: \"\"\n                }\n            });\n        }\n        return xhr.then(function () {\n            options = options || {};\n            options.offset = 0;\n            return _this3.fetchMore(options);\n        });\n    },\n\n    /** @type {Object} map of collection available sorting orders containing comparator fns */\n    comparators: _.extend(_.clone(_collectionSuper.prototype.comparators), {\n        name: _baseMvc2.default.buildComparator(\"name\", {\n            ascending: true\n        }),\n        \"name-dsc\": _baseMvc2.default.buildComparator(\"name\", {\n            ascending: false\n        }),\n        size: _baseMvc2.default.buildComparator(\"size\", {\n            ascending: false\n        }),\n        \"size-asc\": _baseMvc2.default.buildComparator(\"size\", {\n            ascending: true\n        })\n    }),\n\n    /** override to always have the current history first */\n    sort: function sort(options) {\n        options = options || {};\n        var silent = options.silent;\n        var currentHistory = this.remove(this.get(this.currentHistoryId));\n        _collectionSuper.prototype.sort.call(this, _.defaults({ silent: true }, options));\n        this.unshift(currentHistory, { silent: true });\n        if (!silent) {\n            this.trigger(\"sort\", this, options);\n        }\n        return this;\n    },\n\n    /** create a new history and by default set it to be the current history */\n    create: function create(data, hdas, historyOptions, xhrOptions) {\n        //TODO: .create is actually a collection function that's overridden here\n        var collection = this;\n\n        var xhr = jQuery.getJSON(Galaxy.root + \"history/create_new_current\");\n        return xhr.done(function (newData) {\n            collection.setCurrent(new History(newData, [], historyOptions || {}));\n        });\n    },\n\n    /** set the current history to the given history, placing it first in the collection.\n     *  Pass standard bbone options for use in unshift.\n     *  @triggers new-current passed history and this collection\n     */\n    setCurrent: function setCurrent(history, options) {\n        options = options || {};\n        // new histories go in the front\n        this.unshift(history, options);\n        this.currentHistoryId = history.get(\"id\");\n        if (!options.silent) {\n            this.trigger(\"new-current\", history, this);\n        }\n        return this;\n    },\n\n    toString: function toString() {\n        return \"HistoryCollection(\" + this.length + \",current:\" + this.currentHistoryId + \")\";\n    }\n});\n\n//==============================================================================\nexports.default = {\n    History: History,\n    HistoryCollection: HistoryCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1tb2RlbC5qcz83Yjg5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBISVNUT1JZX0NPTlRFTlRTIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LWNvbnRlbnRzXCI7XG5pbXBvcnQgQ09OVFJPTExFRF9GRVRDSF9DT0xMRUNUSU9OIGZyb20gXCJtdmMvYmFzZS9jb250cm9sbGVkLWZldGNoLWNvbGxlY3Rpb25cIjtcbmltcG9ydCBVVElMUyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuaW1wb3J0ICogYXMgXyBmcm9tIFwibGlicy91bmRlcnNjb3JlXCI7XG5pbXBvcnQgKiBhcyBCYWNrYm9uZSBmcm9tIFwibGlicy9iYWNrYm9uZVwiO1xuXG4vKiBnbG9iYWwgalF1ZXJ5ICovXG4vKiBnbG9iYWwgR2FsYXh5ICovXG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIE1vZGVsIGZvciBhIEdhbGF4eSBoaXN0b3J5IHJlc291cmNlIC0gYm90aCBhIHJlY29yZCBvZiB1c2VyXG4gKiAgICAgIHRvb2wgdXNlIGFuZCBhIGNvbGxlY3Rpb24gb2YgdGhlIGRhdGFzZXRzIHRob3NlIHRvb2xzIHByb2R1Y2VkLlxuICogIEBuYW1lIEhpc3RvcnlcbiAqICBAYXVnbWVudHMgQmFja2JvbmUuTW9kZWxcbiAqL1xudmFyIEhpc3RvcnkgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKFxuICAgIEJBU0VfTVZDLm1peGluKFxuICAgICAgICBCQVNFX01WQy5TZWFyY2hhYmxlTW9kZWxNaXhpbixcbiAgICAgICAgLyoqIEBsZW5kcyBIaXN0b3J5LnByb3RvdHlwZSAqLyB7XG4gICAgICAgICAgICBfbG9nTmFtZXNwYWNlOiBcImhpc3RvcnlcIixcblxuICAgICAgICAgICAgLyoqIG1zIGJldHdlZW4gZmV0Y2hlcyB3aGVuIGNoZWNraW5nIHJ1bm5pbmcgam9icy9kYXRhc2V0cyBmb3IgdXBkYXRlcyAqL1xuICAgICAgICAgICAgVVBEQVRFX0RFTEFZOiA0MDAwLFxuXG4gICAgICAgICAgICAvLyB2YWx1ZXMgZnJvbSBhcGkgKG1heSBuZWVkIG1vcmUpXG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIG1vZGVsX2NsYXNzOiBcIkhpc3RvcnlcIixcbiAgICAgICAgICAgICAgICBpZDogbnVsbCxcbiAgICAgICAgICAgICAgICBuYW1lOiBcIlVubmFtZWQgSGlzdG9yeVwiLFxuICAgICAgICAgICAgICAgIHN0YXRlOiBcIm5ld1wiLFxuXG4gICAgICAgICAgICAgICAgZGVsZXRlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGVudHNfYWN0aXZlOiB7fSxcbiAgICAgICAgICAgICAgICBjb250ZW50c19zdGF0ZXM6IHt9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB1cmxSb290OiBgJHtHYWxheHkucm9vdH1hcGkvaGlzdG9yaWVzYCxcblxuICAgICAgICAgICAgY29udGVudHNDbGFzczogSElTVE9SWV9DT05URU5UUy5IaXN0b3J5Q29udGVudHMsXG5cbiAgICAgICAgICAgIC8qKiBXaGF0IG1vZGVsIGZpZWxkcyB0byBzZWFyY2ggd2l0aCAqL1xuICAgICAgICAgICAgc2VhcmNoQXR0cmlidXRlczogW1wibmFtZVwiLCBcImFubm90YXRpb25cIiwgXCJ0YWdzXCJdLFxuXG4gICAgICAgICAgICAvKiogQWRkaW5nIHRpdGxlIGFuZCBzaW5ndWxhciB0YWcgKi9cbiAgICAgICAgICAgIHNlYXJjaEFsaWFzZXM6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJuYW1lXCIsXG4gICAgICAgICAgICAgICAgdGFnOiBcInRhZ3NcIlxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIHNldCB1cC90ZWFyIGRvd25cbiAgICAgICAgICAgIC8qKiBTZXQgdXAgdGhlIG1vZGVsXG4gICAgICAgICAgICAgKiAgQHBhcmFtIHtPYmplY3R9IGhpc3RvcnlKU09OIG1vZGVsIGRhdGEgZm9yIHRoaXMgSGlzdG9yeVxuICAgICAgICAgICAgICogIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zICAgICBhbnkgZXh0cmEgc2V0dGluZ3MgaW5jbHVkaW5nIGxvZ2dlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihoaXN0b3J5SlNPTiwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyID0gb3B0aW9ucy5sb2dnZXIgfHwgbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgJHt0aGlzfS5pbml0aWFsaXplOmAsIGhpc3RvcnlKU09OLCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICAgIC8qKiBIaXN0b3J5Q29udGVudHMgY29sbGVjdGlvbiBvZiB0aGUgSERBcyBjb250YWluZWQgaW4gdGhpcyBoaXN0b3J5LiAqL1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgdGhpcy5jb250ZW50c0NsYXNzKFtdLCB7XG4gICAgICAgICAgICAgICAgICAgIGhpc3Rvcnk6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGhpc3RvcnlJZDogdGhpcy5nZXQoXCJpZFwiKSxcbiAgICAgICAgICAgICAgICAgICAgb3JkZXI6IG9wdGlvbnMub3JkZXJcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3NldFVwTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0VXBDb2xsZWN0aW9uTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgICAgICAgICAvKiogY2FjaGVkIHRpbWVvdXQgaWQgZm9yIHRoZSBkYXRhc2V0IHVwZGF0ZXIgKi9cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogc2V0IHVwIGFueSBldmVudCBsaXN0ZW5lcnMgZm9yIHRoaXMgaGlzdG9yeSBpbmNsdWRpbmcgdGhvc2UgdG8gdGhlIGNvbnRhaW5lZCBIREFzXG4gICAgICAgICAgICAgKiAgZXZlbnRzOiBlcnJvcjpjb250ZW50cyAgaWYgYW4gZXJyb3Igb2NjdXJyZWQgd2l0aCB0aGUgY29udGVudHMgY29sbGVjdGlvblxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBfc2V0VXBMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBtb2RlbCdzIGlkIGNoYW5nZXMgKCdjdXJyZW50JyBvciBudWxsIC0+IGFuIGFjdHVhbCBpZCksIHVwZGF0ZSB0aGUgY29udGVudHMgaGlzdG9yeV9pZFxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1vZGVsLCB4aHIsIG9wdGlvbnMsIG1zZywgZGV0YWlscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclVwZGF0ZVRpbWVvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJjaGFuZ2U6aWRcIjogZnVuY3Rpb24obW9kZWwsIG5ld0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250ZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGVudHMuaGlzdG9yeUlkID0gbmV3SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBldmVudCBoYW5kbGVycyBmb3IgdGhlIGNvbnRlbnRzIHN1Ym1vZGVscyAqL1xuICAgICAgICAgICAgX3NldFVwQ29sbGVjdGlvbkxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNvbnRlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBidWJibGUgdXAgZXJyb3JzXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuVG8odGhpcy5jb250ZW50cywge1xuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIuYXBwbHkodGhpcywgalF1ZXJ5Lm1ha2VBcnJheShhcmd1bWVudHMpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGRlcml2ZWQgYXR0cmlidXRlc1xuICAgICAgICAgICAgLyoqICAqL1xuICAgICAgICAgICAgY29udGVudHNTaG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRzQWN0aXZlID0gdGhpcy5nZXQoXCJjb250ZW50c19hY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgdmFyIHNob3duID0gY29udGVudHNBY3RpdmUuYWN0aXZlIHx8IDA7XG4gICAgICAgICAgICAgICAgc2hvd24gKz0gdGhpcy5jb250ZW50cy5pbmNsdWRlRGVsZXRlZCA/IGNvbnRlbnRzQWN0aXZlLmRlbGV0ZWQgOiAwO1xuICAgICAgICAgICAgICAgIHNob3duICs9IHRoaXMuY29udGVudHMuaW5jbHVkZUhpZGRlbiA/IGNvbnRlbnRzQWN0aXZlLmhpZGRlbiA6IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNob3duO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIGNvbnZlcnQgc2l6ZSBpbiBieXRlcyB0byBhIG1vcmUgaHVtYW4gcmVhZGFibGUgdmVyc2lvbiAqL1xuICAgICAgICAgICAgbmljZV9zaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IHRoaXMuZ2V0KFwic2l6ZVwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZSA/IFVUSUxTLmJ5dGVzVG9TdHJpbmcoc2l6ZSwgdHJ1ZSwgMikgOiBfbChcIihlbXB0eSlcIik7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogb3ZlcnJpZGUgdG8gYWRkIG5pY2Vfc2l6ZSAqL1xuICAgICAgICAgICAgdG9KU09OOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5leHRlbmQoQmFja2JvbmUuTW9kZWwucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMpLCB7XG4gICAgICAgICAgICAgICAgICAgIG5pY2Vfc2l6ZTogdGhpcy5uaWNlX3NpemUoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIG92ZXJyaWRlIHRvIGFsbG93IGdldHRpbmcgbmljZV9zaXplICovXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IFwibmljZV9zaXplXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubmljZV9zaXplKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBCYWNrYm9uZS5Nb2RlbC5wcm90b3R5cGUuZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gY29tbW9uIHF1ZXJpZXNcbiAgICAgICAgICAgIC8qKiBUL0YgaXMgdGhpcyBoaXN0b3J5IG93bmVkIGJ5IHRoZSBjdXJyZW50IHVzZXIgKEdhbGF4eS51c2VyKVxuICAgICAgICAgICAgICogICAgICBOb3RlOiB0aGF0IHRoaXMgd2lsbCByZXR1cm4gZmFsc2UgZm9yIGFuIGFub24gdXNlciBldmVuIGlmIHRoZSBoaXN0b3J5IGlzIHRoZWlycy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgb3duZWRCeUN1cnJVc2VyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBubyBjdXJyVXNlclxuICAgICAgICAgICAgICAgIGlmICghR2FsYXh5IHx8ICFHYWxheHkudXNlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHVzZXIgaXMgYW5vbiBvciBoaXN0b3J5IGlzbid0IG93bmVkXG4gICAgICAgICAgICAgICAgaWYgKEdhbGF4eS51c2VyLmlzQW5vbnltb3VzKCkgfHwgR2FsYXh5LnVzZXIuaWQgIT09IHRoaXMuZ2V0KFwidXNlcl9pZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIFJldHVybiB0aGUgbnVtYmVyIG9mIHJ1bm5pbmcgam9icyBhc3NvYyB3aXRoIHRoaXMgaGlzdG9yeSAobm90ZTogdW5rbm93biA9PT0gMCkgKi9cbiAgICAgICAgICAgIG51bU9mVW5maW5pc2hlZEpvYnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciB1bmZpbmlzaGVkSm9iSWRzID0gdGhpcy5nZXQoXCJub25fcmVhZHlfam9ic1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5maW5pc2hlZEpvYklkcyA/IHVuZmluaXNoZWRKb2JJZHMubGVuZ3RoIDogMDtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBSZXR1cm4gdGhlIG51bWJlciBvZiBydW5uaW5nIGhkYS9oZGNhcyBpbiB0aGlzIGhpc3RvcnkgKG5vdGU6IHVua25vd24gPT09IDApICovXG4gICAgICAgICAgICBudW1PZlVuZmluaXNoZWRTaG93bkNvbnRlbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5ydW5uaW5nQW5kQWN0aXZlKCkubGVuZ3RoIHx8IDA7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gdXBkYXRlc1xuICAgICAgICAgICAgX2ZldGNoQ29udGVudFJlbGF0ZWRBdHRyaWJ1dGVzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudFJlbGF0ZWRBdHRycyA9IFtcInNpemVcIiwgXCJub25fcmVhZHlfam9ic1wiLCBcImNvbnRlbnRzX2FjdGl2ZVwiLCBcImhpZF9jb3VudGVyXCJdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoKHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogalF1ZXJ5LnBhcmFtKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleXM6IGNvbnRlbnRSZWxhdGVkQXR0cnMuam9pbihcIixcIilcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBjaGVjayBmb3IgYW55IGNoYW5nZXMgc2luY2UgdGhlIGxhc3QgdGltZSB3ZSB1cGRhdGVkIChvciBmZXRjaCBhbGwgaWYgKSAqL1xuICAgICAgICAgICAgcmVmcmVzaDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCB0aGlzICsgJy5yZWZyZXNoJyApO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgICAgICAgICAgLy8gbm90ZSBpZiB0aGVyZSB3YXMgbm8gcHJldmlvdXMgdXBkYXRlIHRpbWUsIGFsbCBzdW1tYXJ5IGNvbnRlbnRzIHdpbGwgYmUgZmV0Y2hlZFxuICAgICAgICAgICAgICAgIHZhciBsYXN0VXBkYXRlVGltZSA9IHRoaXMubGFzdFVwZGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgLy8gaWYgd2UgZG9uJ3QgZmxpcCB0aGlzLCB0aGVuIGEgZnVsbHktZmV0Y2hlZCBsaXN0IHdpbGwgbm90IGJlIHJlLWNoZWNrZWQgdmlhIGZldGNoXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50cy5hbGxGZXRjaGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIGZldGNoRm4gPVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRzLmN1cnJlbnRQYWdlICE9PSAwXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICgpID0+IHRoaXMuY29udGVudHMuZmV0Y2hQYWdlKHRoaXMuY29udGVudHMuY3VycmVudFBhZ2UpXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICgpID0+IHRoaXMuY29udGVudHMuZmV0Y2hVcGRhdGVkKGxhc3RVcGRhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICAvLyBub3RlOiBpZiB0aGVyZSB3YXMgbm8gcHJldmlvdXMgdXBkYXRlIHRpbWUsIGFsbCBzdW1tYXJ5IGNvbnRlbnRzIHdpbGwgYmUgZmV0Y2hlZFxuICAgICAgICAgICAgICAgIHJldHVybiBmZXRjaEZuKCkuZG9uZSgocmVzcG9uc2UsIHN0YXR1cywgeGhyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJSZXNwb25zZURhdGV0aW1lO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyUmVzcG9uc2VEYXRldGltZSA9IG5ldyBEYXRlKHhoci5nZXRSZXNwb25zZUhlYWRlcihcIkRhdGVcIikpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RVcGRhdGVUaW1lID0gc2VydmVyUmVzcG9uc2VEYXRldGltZSB8fCBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrRm9yVXBkYXRlcyhvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBjb250aW51b3VzbHkgZmV0Y2ggdXBkYXRlZCBjb250ZW50cyBldmVyeSBVUERBVEVfREVMQVkgbXMgaWYgdGhpcyBoaXN0b3J5J3MgZGF0YXNldHMgb3Igam9icyBhcmUgdW5maW5pc2hlZCAqL1xuICAgICAgICAgICAgY2hlY2tGb3JVcGRhdGVzOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHRoaXMgKyAnLmNoZWNrRm9yVXBkYXRlcycgKTtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsYXkgPSB0aGlzLlVQREFURV9ERUxBWTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBfZGVsYXlUaGVuVXBkYXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBwcmV2ZW50IGJ1aWxkdXAgb2YgdXBkYXRlciB0aW1lb3V0cyBieSBjbGVhcmluZyBwcmV2aW91cyBpZiBhbnksIHRoZW4gc2V0IG5ldyBhbmQgY2FjaGUgaWRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclVwZGF0ZVRpbWVvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgc3RpbGwgZGF0YXNldHMgaW4gdGhlIG5vbi1yZWFkeSBzdGF0ZSwgcmVjdXJzZSBpbnRvIHRoaXMgZnVuY3Rpb24gd2l0aCB0aGUgbmV3IHRpbWVcbiAgICAgICAgICAgICAgICB2YXIgbm9uUmVhZHlDb250ZW50Q291bnQgPSB0aGlzLm51bU9mVW5maW5pc2hlZFNob3duQ29udGVudHMoKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggJ25vblJlYWR5Q29udGVudENvdW50OicsIG5vblJlYWR5Q29udGVudENvdW50ICk7XG4gICAgICAgICAgICAgICAgaWYgKG5vblJlYWR5Q29udGVudENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBfZGVsYXlUaGVuVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbm8gZGF0YXNldHMgYXJlIHJ1bm5pbmcsIGJ1dCBjdXJyZW50bHkgcnVubm5pbmcgam9icyBtYXkgc3RpbGwgcHJvZHVjZSBuZXcgZGF0YXNldHNcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VlIGlmIHRoZSBoaXN0b3J5IGhhcyBhbnkgcnVubmluZyBqb2JzIGFuZCBjb250aW51ZSB0byB1cGRhdGUgaWYgc29cbiAgICAgICAgICAgICAgICAgICAgLy8gKGFsc28gdXBkYXRlIHRoZSBzaXplIGZvciB0aGUgdXNlciBpbiBlaXRoZXIgY2FzZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmV0Y2hDb250ZW50UmVsYXRlZEF0dHJpYnV0ZXMoKS5kb25lKGhpc3RvcnlEYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCAnbm9uX3JlYWR5X2pvYnM6JywgaGlzdG9yeURhdGEubm9uX3JlYWR5X2pvYnMgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm51bU9mVW5maW5pc2hlZEpvYnMoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGVsYXlUaGVuVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgbGV0IGxpc3RlbmVycyBrbm93IHRoYXQgYWxsIHVwZGF0ZXMgaGF2ZSBzdG9wcGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwicmVhZHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBjbGVhciB0aGUgdGltZW91dCBhbmQgdGhlIGNhY2hlZCB0aW1lb3V0IGlkICovXG4gICAgICAgICAgICBjbGVhclVwZGF0ZVRpbWVvdXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnVwZGF0ZVRpbWVvdXRJZCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy51cGRhdGVUaW1lb3V0SWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc3RvcFBvbGxpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJVcGRhdGVUaW1lb3V0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50cy5zdG9wUG9sbGluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBhamF4XG4gICAgICAgICAgICAvKiogb3ZlcnJpZGUgdG8gdXNlIGFjdHVhbCBEYXRlcyBvYmplY3RzIGZvciBjcmVhdGUvdXBkYXRlIHRpbWVzICovXG4gICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24ocmVzcG9uc2UsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkID0gQmFja2JvbmUuTW9kZWwucHJvdG90eXBlLnBhcnNlLmNhbGwodGhpcywgcmVzcG9uc2UsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZWQuY3JlYXRlX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkLmNyZWF0ZV90aW1lID0gbmV3IERhdGUocGFyc2VkLmNyZWF0ZV90aW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZC51cGRhdGVfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWQudXBkYXRlX3RpbWUgPSBuZXcgRGF0ZShwYXJzZWQudXBkYXRlX3RpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VkO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIGZldGNoIHRoaXMgaGlzdG9yaWVzIGRhdGEgKHVzaW5nIG9wdGlvbnMpIHRoZW4gaXQncyBjb250ZW50cyAodXNpbmcgY29udGVudHNPcHRpb25zKSAqL1xuICAgICAgICAgICAgZmV0Y2hXaXRoQ29udGVudHM6IGZ1bmN0aW9uKG9wdGlvbnMsIGNvbnRlbnRzT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCB0aGlzICsgJy5mZXRjaFdpdGhDb250ZW50cycgKTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBwdXNoIGRvd24gdG8gYSBiYXNlIGNsYXNzXG4gICAgICAgICAgICAgICAgb3B0aW9ucy52aWV3ID0gXCJkZXYtZGV0YWlsZWRcIjtcblxuICAgICAgICAgICAgICAgIC8vIGZldGNoIGhpc3RvcnkgdGhlbiB1c2UgaGlzdG9yeSBkYXRhIHRvIGZldGNoIChwYWdpbmF0ZWQpIGNvbnRlbnRzXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gob3B0aW9ucykudGhlbihmdW5jdGlvbiBnZXRDb250ZW50cyhoaXN0b3J5KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29udGVudHMuaGlzdG9yeSA9IHNlbGY7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29udGVudHMuc2V0SGlzdG9yeUlkKGhpc3RvcnkuaWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5mZXRjaENvbnRlbnRzKGNvbnRlbnRzT3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogZmV0Y2ggdGhpcyBoaXN0b3JpZXMgY29udGVudHMsIGFkanVzdGluZyBvcHRpb25zIGJhc2VkIG9uIHRoZSBzdG9yZWQgaGlzdG9yeSBwcmVmZXJlbmNlcyAqL1xuICAgICAgICAgICAgZmV0Y2hDb250ZW50czogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAgICAgICAgICAgLy8gd2UncmUgdXBkYXRpbmcsIHJlc2V0IHRoZSB1cGRhdGUgdGltZVxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFVwZGF0ZVRpbWUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmZldGNoQ3VycmVudFBhZ2Uob3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogc2F2ZSB0aGlzIGhpc3RvcnksIF9NYXJrX2luZyBpdCBhcyBkZWxldGVkIChqdXN0IGEgZmxhZykgKi9cbiAgICAgICAgICAgIF9kZWxldGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zYXZlKHsgZGVsZXRlZDogdHJ1ZSB9LCBvcHRpb25zKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKiogcHVyZ2UgdGhpcyBoaXN0b3J5LCBfTWFya19pbmcgaXQgYXMgcHVyZ2VkIGFuZCByZW1vdmluZyBhbGwgZGF0YXNldCBkYXRhIGZyb20gdGhlIHNlcnZlciAqL1xuICAgICAgICAgICAgcHVyZ2U6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoXCJwdXJnZWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNhdmUoeyBkZWxldGVkOiB0cnVlLCBwdXJnZWQ6IHRydWUgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqIHNhdmUgdGhpcyBoaXN0b3J5LCBfTWFya19pbmcgaXQgYXMgdW5kZWxldGVkICovXG4gICAgICAgICAgICB1bmRlbGV0ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXQoXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zYXZlKHsgZGVsZXRlZDogZmFsc2UgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogTWFrZSBhIGNvcHkgb2YgdGhpcyBoaXN0b3J5IG9uIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAqICBAcGFyYW0ge0Jvb2xlYW59IGN1cnJlbnQgICAgaWYgdHJ1ZSwgc2V0IHRoZSBjb3B5IGFzIHRoZSBuZXcgY3VycmVudCBoaXN0b3J5IChkZWZhdWx0OiB0cnVlKVxuICAgICAgICAgICAgICogIEBwYXJhbSB7U3RyaW5nfSBuYW1lICAgICAgICBuYW1lIG9mIG5ldyBoaXN0b3J5IChkZWZhdWx0OiBub25lIC0gc2VydmVyIHNldHMgdG86IENvcHkgb2YgPGN1cnJlbnQgbmFtZT4pXG4gICAgICAgICAgICAgKiAgQGZpcmVzIGNvcGllZCAgICAgICAgICAgICAgIHBhc3NlZCB0aGlzIGhpc3RvcnkgYW5kIHRoZSByZXNwb25zZSBKU09OIGZyb20gdGhlIGNvcHlcbiAgICAgICAgICAgICAqICBAcmV0dXJucyB7eGhyfVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb3B5OiBmdW5jdGlvbihjdXJyZW50LCBuYW1lLCBhbGxEYXRhc2V0cykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50ICE9PSB1bmRlZmluZWQgPyBjdXJyZW50IDogdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IG11c3Qgc2V0IHRoZSBoaXN0b3J5IElEIGJlZm9yZSBjb3B5aW5nIGl0LlwiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcG9zdERhdGEgPSB7IGhpc3RvcnlfaWQ6IHRoaXMuaWQgfTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudCkge1xuICAgICAgICAgICAgICAgICAgICBwb3N0RGF0YS5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdERhdGEubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghYWxsRGF0YXNldHMpIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdERhdGEuYWxsX2RhdGFzZXRzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBvc3REYXRhLnZpZXcgPSBcImRldi1kZXRhaWxlZFwiO1xuXG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnkgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBjb3B5ID0galF1ZXJ5LnBvc3QodGhpcy51cmxSb290LCBwb3N0RGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gaWYgY3VycmVudCAtIHF1ZXVlIHRvIHNldEFzQ3VycmVudCBiZWZvcmUgZmlyaW5nICdjb3BpZWQnXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvcHkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3SGlzdG9yeSA9IG5ldyBIaXN0b3J5KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdIaXN0b3J5LnNldEFzQ3VycmVudCgpLmRvbmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnkudHJpZ2dlcihcImNvcGllZFwiLCBoaXN0b3J5LCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjb3B5LmRvbmUocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnRyaWdnZXIoXCJjb3BpZWRcIiwgaGlzdG9yeSwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc2V0QXNDdXJyZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeSA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICB2YXIgeGhyID0galF1ZXJ5LmdldEpTT04oYCR7R2FsYXh5LnJvb3R9aGlzdG9yeS9zZXRfYXNfY3VycmVudD9pZD0ke3RoaXMuaWR9YCk7XG5cbiAgICAgICAgICAgICAgICB4aHIuZG9uZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGhpc3RvcnkudHJpZ2dlcihcInNldC1hcy1jdXJyZW50XCIsIGhpc3RvcnkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiB4aHI7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBgSGlzdG9yeSgke3RoaXMuZ2V0KFwiaWRcIil9LCR7dGhpcy5nZXQoXCJuYW1lXCIpfSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKVxuKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnZhciBfY29sbGVjdGlvblN1cGVyID0gQ09OVFJPTExFRF9GRVRDSF9DT0xMRUNUSU9OLkluZmluaXRlbHlTY3JvbGxpbmdDb2xsZWN0aW9uO1xuLyoqIEBjbGFzcyBBIGNvbGxlY3Rpb24gb2YgaGlzdG9yaWVzIChwZXIgdXNlcilcbiAqICAgICAgdGhhdCBtYWludGFpbnMgdGhlIGN1cnJlbnQgaGlzdG9yeSBhcyB0aGUgZmlyc3QgaW4gdGhlIGNvbGxlY3Rpb24uXG4gKiAgTmV3IG9yIGNvcGllZCBoaXN0b3JpZXMgYmVjb21lIHRoZSBjdXJyZW50IGhpc3RvcnkuXG4gKi9cbnZhciBIaXN0b3J5Q29sbGVjdGlvbiA9IF9jb2xsZWN0aW9uU3VwZXIuZXh0ZW5kKEJBU0VfTVZDLkxvZ2dhYmxlTWl4aW4pLmV4dGVuZCh7XG4gICAgX2xvZ05hbWVzcGFjZTogXCJoaXN0b3J5XCIsXG5cbiAgICBtb2RlbDogSGlzdG9yeSxcbiAgICAvKiogQHR5cGUge1N0cmluZ30gaW5pdGlhbCBvcmRlciB1c2VkIGJ5IGNvbGxlY3Rpb24gKi9cbiAgICBvcmRlcjogXCJ1cGRhdGVfdGltZVwiLFxuICAgIC8qKiBAdHlwZSB7TnVtYmVyfSBsaW1pdCB1c2VkIGZvciB0aGUgZmlyc3QgZmV0Y2ggKG9yIGEgcmVzZXQpICovXG4gICAgbGltaXRPbkZpcnN0RmV0Y2g6IDEwLFxuICAgIC8qKiBAdHlwZSB7TnVtYmVyfSBsaW1pdCB1c2VkIGZvciBlYWNoIHN1YnNlcXVlbnQgZmV0Y2ggKi9cbiAgICBsaW1pdFBlckZldGNoOiAxMCxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG1vZGVscywgb3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgdGhpcy5sb2coXCJIaXN0b3J5Q29sbGVjdGlvbi5pbml0aWFsaXplXCIsIG1vZGVscywgb3B0aW9ucyk7XG4gICAgICAgIF9jb2xsZWN0aW9uU3VwZXIucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBtb2RlbHMsIG9wdGlvbnMpO1xuXG4gICAgICAgIC8qKiBAdHlwZSB7Ym9vbGVhbn0gc2hvdWxkIGRlbGV0ZWQgaGlzdG9yaWVzIGJlIGluY2x1ZGVkICovXG4gICAgICAgIHRoaXMuaW5jbHVkZURlbGV0ZWQgPSBvcHRpb25zLmluY2x1ZGVEZWxldGVkIHx8IGZhbHNlO1xuXG4gICAgICAgIC8qKiBAdHlwZSB7U3RyaW5nfSBlbmNvZGVkIGlkIG9mIHRoZSBoaXN0b3J5IHRoYXQncyBjdXJyZW50ICovXG4gICAgICAgIHRoaXMuY3VycmVudEhpc3RvcnlJZCA9IG9wdGlvbnMuY3VycmVudEhpc3RvcnlJZDtcblxuICAgICAgICB0aGlzLnNldFVwTGlzdGVuZXJzKCk7XG4gICAgICAgIC8vIG5vdGU6IG1vZGVscyBhcmUgc2VudCB0byByZXNldCAqYWZ0ZXIqIHRoaXMgZm4gZW5kczsgdXAgdG8gdGhpcyBwb2ludFxuICAgICAgICAvLyB0aGUgY29sbGVjdGlvbiAqaXMgZW1wdHkqXG4gICAgfSxcblxuICAgIHVybFJvb3Q6IGAke0dhbGF4eS5yb290fWFwaS9oaXN0b3JpZXNgLFxuICAgIHVybDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVybFJvb3Q7XG4gICAgfSxcblxuICAgIC8qKiBzZXQgdXAgcmVmbGV4aXZlIGV2ZW50IGhhbmRsZXJzICovXG4gICAgc2V0VXBMaXN0ZW5lcnM6IGZ1bmN0aW9uIHNldFVwTGlzdGVuZXJzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vbih7XG4gICAgICAgICAgICAvLyB3aGVuIGEgaGlzdG9yeSBpcyBkZWxldGVkLCByZW1vdmUgaXQgZnJvbSB0aGUgY29sbGVjdGlvbiAoaWYgb3B0aW9uYWxseSBzZXQgdG8gZG8gc28pXG4gICAgICAgICAgICBcImNoYW5nZTpkZWxldGVkXCI6IGZ1bmN0aW9uKGhpc3RvcnkpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiB0aGlzIGJlY29tZXMgY29tcGxpY2F0ZWQgd2hlbiBtb3JlIGZpbHRlcnMgYXJlIHVzZWRcbiAgICAgICAgICAgICAgICB0aGlzLmRlYnVnKFwiY2hhbmdlOmRlbGV0ZWRcIiwgdGhpcy5pbmNsdWRlRGVsZXRlZCwgaGlzdG9yeS5nZXQoXCJkZWxldGVkXCIpKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5jbHVkZURlbGV0ZWQgJiYgaGlzdG9yeS5nZXQoXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKGhpc3RvcnkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyBsaXN0ZW4gZm9yIGEgaGlzdG9yeSBjb3B5LCBzZXR0aW5nIGl0IHRvIGN1cnJlbnRcbiAgICAgICAgICAgIGNvcGllZDogZnVuY3Rpb24ob3JpZ2luYWwsIG5ld0RhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEN1cnJlbnQobmV3IEhpc3RvcnkobmV3RGF0YSwgW10pKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyB3aGVuIGEgaGlzdG9yeSBpcyBtYWRlIGN1cnJlbnQsIHRyYWNrIHRoZSBpZCBpbiB0aGUgY29sbGVjdGlvblxuICAgICAgICAgICAgXCJzZXQtYXMtY3VycmVudFwiOiBmdW5jdGlvbihoaXN0b3J5KSB7XG4gICAgICAgICAgICAgICAgdmFyIG9sZEN1cnJlbnRJZCA9IHRoaXMuY3VycmVudEhpc3RvcnlJZDtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJuby1sb25nZXItY3VycmVudFwiLCBvbGRDdXJyZW50SWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudEhpc3RvcnlJZCA9IGhpc3RvcnkuaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogb3ZlcnJpZGUgdG8gY2hhbmdlIHZpZXcgKi9cbiAgICBfYnVpbGRGZXRjaERhdGE6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIF8uZXh0ZW5kKF9jb2xsZWN0aW9uU3VwZXIucHJvdG90eXBlLl9idWlsZEZldGNoRGF0YS5jYWxsKHRoaXMsIG9wdGlvbnMpLCB7XG4gICAgICAgICAgICB2aWV3OiBcImRldi1kZXRhaWxlZFwiXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogb3ZlcnJpZGUgdG8gZmlsdGVyIG91dCBkZWxldGVkIGFuZCBwdXJnZWQgKi9cbiAgICBfYnVpbGRGZXRjaEZpbHRlcnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHN1cGVyRmlsdGVycyA9IF9jb2xsZWN0aW9uU3VwZXIucHJvdG90eXBlLl9idWlsZEZldGNoRmlsdGVycy5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHt9O1xuICAgICAgICB2YXIgZmlsdGVycyA9IHt9O1xuICAgICAgICBpZiAodGhpcy5pbmNsdWRlRGVsZXRlZCAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgZmlsdGVycy5kZWxldGVkID0gZmFsc2U7XG4gICAgICAgICAgICBmaWx0ZXJzLnB1cmdlZCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZm9yY2UgQVBJIHRvIHJldHVybiBib3RoIGRlbGV0ZWQgYW5kIG5vblxuICAgICAgICAgICAgLy9UT0RPOiB3aGVuIHRoZSBBUEkgaXMgdXBkYXRlZCwgcmVtb3ZlIHRoaXNcbiAgICAgICAgICAgIGZpbHRlcnMuZGVsZXRlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8uZGVmYXVsdHMoc3VwZXJGaWx0ZXJzLCBmaWx0ZXJzKTtcbiAgICB9LFxuXG4gICAgLyoqIG92ZXJyaWRlIHRvIGZldGNoIGN1cnJlbnQgYXMgd2VsbCAoYXMgaXQgbWF5IGJlIG91dHNpZGUgdGhlIGZpcnN0IDEwLCBldGMuKSAqL1xuICAgIGZldGNoRmlyc3Q6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gVE9ETzogYmF0Y2g/XG4gICAgICAgIHZhciB4aHIgPSBqUXVlcnkud2hlbigpO1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50SGlzdG9yeUlkKSB7XG4gICAgICAgICAgICB4aHIgPSBfY29sbGVjdGlvblN1cGVyLnByb3RvdHlwZS5mZXRjaEZpcnN0LmNhbGwodGhpcywge1xuICAgICAgICAgICAgICAgIHNpbGVudDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBsaW1pdDogMSxcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiZW5jb2RlZF9pZC1pblwiOiB0aGlzLmN1cnJlbnRIaXN0b3J5SWQsXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpdGhvdXQgdGhlc2UgYSBkZWxldGVkIGN1cnJlbnQgaGlzdG9yeSB3aWxsIHJldHVybiBbXSBoZXJlIGFuZCBibG9jayB0aGUgb3RoZXIgeGhyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHB1cmdlZDogXCJcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4aHIudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIG9wdGlvbnMub2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoTW9yZShvcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBAdHlwZSB7T2JqZWN0fSBtYXAgb2YgY29sbGVjdGlvbiBhdmFpbGFibGUgc29ydGluZyBvcmRlcnMgY29udGFpbmluZyBjb21wYXJhdG9yIGZucyAqL1xuICAgIGNvbXBhcmF0b3JzOiBfLmV4dGVuZChfLmNsb25lKF9jb2xsZWN0aW9uU3VwZXIucHJvdG90eXBlLmNvbXBhcmF0b3JzKSwge1xuICAgICAgICBuYW1lOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJuYW1lXCIsIHtcbiAgICAgICAgICAgIGFzY2VuZGluZzogdHJ1ZVxuICAgICAgICB9KSxcbiAgICAgICAgXCJuYW1lLWRzY1wiOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJuYW1lXCIsIHtcbiAgICAgICAgICAgIGFzY2VuZGluZzogZmFsc2VcbiAgICAgICAgfSksXG4gICAgICAgIHNpemU6IEJBU0VfTVZDLmJ1aWxkQ29tcGFyYXRvcihcInNpemVcIiwge1xuICAgICAgICAgICAgYXNjZW5kaW5nOiBmYWxzZVxuICAgICAgICB9KSxcbiAgICAgICAgXCJzaXplLWFzY1wiOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJzaXplXCIsIHtcbiAgICAgICAgICAgIGFzY2VuZGluZzogdHJ1ZVxuICAgICAgICB9KVxuICAgIH0pLFxuXG4gICAgLyoqIG92ZXJyaWRlIHRvIGFsd2F5cyBoYXZlIHRoZSBjdXJyZW50IGhpc3RvcnkgZmlyc3QgKi9cbiAgICBzb3J0OiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICB2YXIgc2lsZW50ID0gb3B0aW9ucy5zaWxlbnQ7XG4gICAgICAgIHZhciBjdXJyZW50SGlzdG9yeSA9IHRoaXMucmVtb3ZlKHRoaXMuZ2V0KHRoaXMuY3VycmVudEhpc3RvcnlJZCkpO1xuICAgICAgICBfY29sbGVjdGlvblN1cGVyLnByb3RvdHlwZS5zb3J0LmNhbGwodGhpcywgXy5kZWZhdWx0cyh7IHNpbGVudDogdHJ1ZSB9LCBvcHRpb25zKSk7XG4gICAgICAgIHRoaXMudW5zaGlmdChjdXJyZW50SGlzdG9yeSwgeyBzaWxlbnQ6IHRydWUgfSk7XG4gICAgICAgIGlmICghc2lsZW50KSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJzb3J0XCIsIHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIGEgbmV3IGhpc3RvcnkgYW5kIGJ5IGRlZmF1bHQgc2V0IGl0IHRvIGJlIHRoZSBjdXJyZW50IGhpc3RvcnkgKi9cbiAgICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZShkYXRhLCBoZGFzLCBoaXN0b3J5T3B0aW9ucywgeGhyT3B0aW9ucykge1xuICAgICAgICAvL1RPRE86IC5jcmVhdGUgaXMgYWN0dWFsbHkgYSBjb2xsZWN0aW9uIGZ1bmN0aW9uIHRoYXQncyBvdmVycmlkZGVuIGhlcmVcbiAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSB0aGlzO1xuXG4gICAgICAgIHZhciB4aHIgPSBqUXVlcnkuZ2V0SlNPTihgJHtHYWxheHkucm9vdH1oaXN0b3J5L2NyZWF0ZV9uZXdfY3VycmVudGApO1xuICAgICAgICByZXR1cm4geGhyLmRvbmUobmV3RGF0YSA9PiB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLnNldEN1cnJlbnQobmV3IEhpc3RvcnkobmV3RGF0YSwgW10sIGhpc3RvcnlPcHRpb25zIHx8IHt9KSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogc2V0IHRoZSBjdXJyZW50IGhpc3RvcnkgdG8gdGhlIGdpdmVuIGhpc3RvcnksIHBsYWNpbmcgaXQgZmlyc3QgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAgICogIFBhc3Mgc3RhbmRhcmQgYmJvbmUgb3B0aW9ucyBmb3IgdXNlIGluIHVuc2hpZnQuXG4gICAgICogIEB0cmlnZ2VycyBuZXctY3VycmVudCBwYXNzZWQgaGlzdG9yeSBhbmQgdGhpcyBjb2xsZWN0aW9uXG4gICAgICovXG4gICAgc2V0Q3VycmVudDogZnVuY3Rpb24oaGlzdG9yeSwgb3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgLy8gbmV3IGhpc3RvcmllcyBnbyBpbiB0aGUgZnJvbnRcbiAgICAgICAgdGhpcy51bnNoaWZ0KGhpc3RvcnksIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmN1cnJlbnRIaXN0b3J5SWQgPSBoaXN0b3J5LmdldChcImlkXCIpO1xuICAgICAgICBpZiAoIW9wdGlvbnMuc2lsZW50KSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJuZXctY3VycmVudFwiLCBoaXN0b3J5LCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gYEhpc3RvcnlDb2xsZWN0aW9uKCR7dGhpcy5sZW5ndGh9LGN1cnJlbnQ6JHt0aGlzLmN1cnJlbnRIaXN0b3J5SWR9KWA7XG4gICAgfVxufSk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSGlzdG9yeTogSGlzdG9yeSxcbiAgICBIaXN0b3J5Q29sbGVjdGlvbjogSGlzdG9yeUNvbGxlY3Rpb25cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1tb2RlbC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUtBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFEQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNWQTtBQUNBO0FBK1ZBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQkE7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFIQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQURBO0FBVkE7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlKQTtBQUNBO0FBZ0tBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///31\n");

/***/ }),
/* 32 */
/*!********************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/collection-li.js ***!
  \********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, $, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listItem = __webpack_require__(/*! mvc/list/list-item */ 22);\n\nvar _listItem2 = _interopRequireDefault(_listItem);\n\nvar _datasetLi = __webpack_require__(/*! mvc/dataset/dataset-li */ 17);\n\nvar _datasetLi2 = _interopRequireDefault(_datasetLi);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar FoldoutListItemView = _listItem2.default.FoldoutListItemView;\n\nvar ListItemView = _listItem2.default.ListItemView;\n/** @class Read only view for DatasetCollection.\n */\nvar DCListItemView = FoldoutListItemView.extend(\n/** @lends DCListItemView.prototype */{\n    className: FoldoutListItemView.prototype.className + \" dataset-collection\",\n    id: function id() {\n        return [\"dataset_collection\", this.model.get(\"id\")].join(\"-\");\n    },\n\n    /** override to add linkTarget */\n    initialize: function initialize(attributes) {\n        this.linkTarget = attributes.linkTarget || \"_blank\";\n        this.hasUser = attributes.hasUser;\n        FoldoutListItemView.prototype.initialize.call(this, attributes);\n    },\n\n    /** event listeners */\n    _setUpListeners: function _setUpListeners() {\n        FoldoutListItemView.prototype._setUpListeners.call(this);\n        this.listenTo(this.model, \"change\", function (model, options) {\n            // if the model has changed deletion status render it entirely\n            if (_.has(model.changed, \"deleted\")) {\n                this.render();\n\n                // if the model has been decorated after the fact with the element count,\n                // render the subtitle where the count is displayed\n            } else if (_.has(model.changed, \"element_count\")) {\n                this.$(\"> .title-bar .subtitle\").replaceWith(this._renderSubtitle());\n            }\n        });\n    },\n\n    // ......................................................................... rendering\n    /** render a subtitle to show the user what sort of collection this is */\n    _renderSubtitle: function _renderSubtitle() {\n        return $(this.templates.subtitle(this.model.toJSON(), this));\n    },\n\n    // ......................................................................... foldout\n    /** override to add linktarget to sub-panel */\n    _getFoldoutPanelOptions: function _getFoldoutPanelOptions() {\n        var options = FoldoutListItemView.prototype._getFoldoutPanelOptions.call(this);\n        return _.extend(options, {\n            linkTarget: this.linkTarget,\n            hasUser: this.hasUser\n        });\n    },\n\n    /** override to not catch sub-panel selectors */\n    $selector: function $selector() {\n        return this.$(\"> .selector\");\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DCListItemView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDCListItemView.prototype.templates = function () {\n    var warnings = _.extend({}, FoldoutListItemView.prototype.templates.warnings, {\n        error: _baseMvc2.default.wrapTemplate([\n        // error during index fetch - show error on dataset\n        \"<% if( model.error ){ %>\", '<div class=\"errormessagesmall\">', (0, _localization2.default)(\"There was an error getting the data for this collection\"), \": <%- model.error %>\", \"</div>\", \"<% } %>\"]),\n        purged: _baseMvc2.default.wrapTemplate([\"<% if( model.purged ){ %>\", '<div class=\"purged-msg warningmessagesmall\">', (0, _localization2.default)(\"This collection has been deleted and removed from disk\"), \"</div>\", \"<% } %>\"]),\n        deleted: _baseMvc2.default.wrapTemplate([\n        // deleted not purged\n        \"<% if( model.deleted && !model.purged ){ %>\", '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This collection has been deleted\"), \"</div>\", \"<% } %>\"])\n    });\n\n    // use element identifier\n    var titleBarTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"title-bar clear\" tabindex=\"0\">', '<div class=\"title\">', '<span class=\"name\"><%- collection.element_identifier || collection.name %></span>', \"</div>\", '<div class=\"subtitle\"></div>', \"</div>\"], \"collection\");\n\n    // use element identifier\n    var subtitleTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"subtitle\">', '<% var countText = collection.element_count? ( collection.element_count + \" \" ) : \"\"; %>', '<%        if( collection.collection_type === \"list\" ){ %>', (0, _localization2.default)(\"a list of <%- countText %>datasets\"), '<% } else if( collection.collection_type === \"paired\" ){ %>', (0, _localization2.default)(\"a pair of datasets\"), '<% } else if( collection.collection_type === \"list:paired\" ){ %>', (0, _localization2.default)(\"a list of <%- countText %>dataset pairs\"), '<% } else if( collection.collection_type === \"list:list\" ){ %>', (0, _localization2.default)(\"a list of <%- countText %>dataset lists\"), \"<% } %>\", \"</div>\"], \"collection\");\n\n    return _.extend({}, FoldoutListItemView.prototype.templates, {\n        warnings: warnings,\n        titleBar: titleBarTemplate,\n        subtitle: subtitleTemplate\n    });\n}();\n\n//==============================================================================\n/** @class Read only view for DatasetCollectionElement.\n */\nvar DCEListItemView = ListItemView.extend(\n/** @lends DCEListItemView.prototype */{\n    /** add the DCE class to the list item */\n    className: ListItemView.prototype.className + \" dataset-collection-element\",\n\n    /** set up */\n    initialize: function initialize(attributes) {\n        if (attributes.logger) {\n            this.logger = this.model.logger = attributes.logger;\n        }\n        this.log(\"DCEListItemView.initialize:\", attributes);\n        ListItemView.prototype.initialize.call(this, attributes);\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DCEListItemView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDCEListItemView.prototype.templates = function () {\n    // use the element identifier here - since that will persist and the user will need it\n    var titleBarTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"title-bar clear\" tabindex=\"0\">', '<div class=\"title\">', '<span class=\"name\"><%- element.element_identifier %></span>', \"</div>\", '<div class=\"subtitle\"></div>', \"</div>\"], \"element\");\n\n    return _.extend({}, ListItemView.prototype.templates, {\n        titleBar: titleBarTemplate\n    });\n}();\n\n//==============================================================================\n/** @class Read only view for a DatasetCollectionElement that is also an DatasetAssociation\n *      (a dataset contained in a dataset collection).\n */\nvar DatasetDCEListItemView = _datasetLi2.default.DatasetListItemView.extend(\n/** @lends DatasetDCEListItemView.prototype */{\n    className: _datasetLi2.default.DatasetListItemView.prototype.className + \" dataset-collection-element\",\n\n    /** set up */\n    initialize: function initialize(attributes) {\n        if (attributes.logger) {\n            this.logger = this.model.logger = attributes.logger;\n        }\n        this.log(\"DatasetDCEListItemView.initialize:\", attributes);\n        _datasetLi2.default.DatasetListItemView.prototype.initialize.call(this, attributes);\n    },\n\n    /** In this override, only get details if in the ready state.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails: function _fetchModelDetails() {\n        var view = this;\n        if (view.model.inReadyState() && !view.model.hasDetails()) {\n            return view.model.fetch({ silent: true });\n        }\n        return jQuery.when();\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DatasetDCEListItemView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDatasetDCEListItemView.prototype.templates = function () {\n    // use the element identifier here and not the dataset name\n    //TODO:?? can we steal the DCE titlebar?\n    var titleBarTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"title-bar clear\" tabindex=\"0\">', '<span class=\"state-icon\"></span>', '<div class=\"title\">', '<span class=\"name\"><%- element.element_identifier %></span>', \"</div>\", \"</div>\"], \"element\");\n\n    return _.extend({}, _datasetLi2.default.DatasetListItemView.prototype.templates, {\n        titleBar: titleBarTemplate\n    });\n}();\n\n//==============================================================================\n/** @class Read only view for a DatasetCollectionElement that is also a DatasetCollection\n *      (a nested DC).\n */\nvar NestedDCDCEListItemView = DCListItemView.extend(\n/** @lends NestedDCDCEListItemView.prototype */{\n    className: DCListItemView.prototype.className + \" dataset-collection-element\",\n\n    /** In this override, add the state as a class for use with state-based CSS */\n    _swapNewRender: function _swapNewRender($newRender) {\n        DCListItemView.prototype._swapNewRender.call(this, $newRender);\n        var state = this.model.get(\"state\") || \"ok\";\n        this.$el.addClass(\"state-\" + state);\n        return this.$el;\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"NestedDCDCEListItemView(\" + modelString + \")\";\n    }\n});\n\n//==============================================================================\nexports.default = {\n    DCListItemView: DCListItemView,\n    DCEListItemView: DCEListItemView,\n    DatasetDCEListItemView: DatasetDCEListItemView,\n    NestedDCDCEListItemView: NestedDCDCEListItemView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1saS5qcz9jODllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMSVNUX0lURU0gZnJvbSBcIm12Yy9saXN0L2xpc3QtaXRlbVwiO1xuaW1wb3J0IERBVEFTRVRfTEkgZnJvbSBcIm12Yy9kYXRhc2V0L2RhdGFzZXQtbGlcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxudmFyIEZvbGRvdXRMaXN0SXRlbVZpZXcgPSBMSVNUX0lURU0uRm9sZG91dExpc3RJdGVtVmlldztcblxudmFyIExpc3RJdGVtVmlldyA9IExJU1RfSVRFTS5MaXN0SXRlbVZpZXc7XG4vKiogQGNsYXNzIFJlYWQgb25seSB2aWV3IGZvciBEYXRhc2V0Q29sbGVjdGlvbi5cbiAqL1xudmFyIERDTGlzdEl0ZW1WaWV3ID0gRm9sZG91dExpc3RJdGVtVmlldy5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBEQ0xpc3RJdGVtVmlldy5wcm90b3R5cGUgKi8ge1xuICAgICAgICBjbGFzc05hbWU6IGAke0ZvbGRvdXRMaXN0SXRlbVZpZXcucHJvdG90eXBlLmNsYXNzTmFtZX0gZGF0YXNldC1jb2xsZWN0aW9uYCxcbiAgICAgICAgaWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtcImRhdGFzZXRfY29sbGVjdGlvblwiLCB0aGlzLm1vZGVsLmdldChcImlkXCIpXS5qb2luKFwiLVwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogb3ZlcnJpZGUgdG8gYWRkIGxpbmtUYXJnZXQgKi9cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdGhpcy5saW5rVGFyZ2V0ID0gYXR0cmlidXRlcy5saW5rVGFyZ2V0IHx8IFwiX2JsYW5rXCI7XG4gICAgICAgICAgICB0aGlzLmhhc1VzZXIgPSBhdHRyaWJ1dGVzLmhhc1VzZXI7XG4gICAgICAgICAgICBGb2xkb3V0TGlzdEl0ZW1WaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGV2ZW50IGxpc3RlbmVycyAqL1xuICAgICAgICBfc2V0VXBMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgRm9sZG91dExpc3RJdGVtVmlldy5wcm90b3R5cGUuX3NldFVwTGlzdGVuZXJzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIGZ1bmN0aW9uKG1vZGVsLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1vZGVsIGhhcyBjaGFuZ2VkIGRlbGV0aW9uIHN0YXR1cyByZW5kZXIgaXQgZW50aXJlbHlcbiAgICAgICAgICAgICAgICBpZiAoXy5oYXMobW9kZWwuY2hhbmdlZCwgXCJkZWxldGVkXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIG1vZGVsIGhhcyBiZWVuIGRlY29yYXRlZCBhZnRlciB0aGUgZmFjdCB3aXRoIHRoZSBlbGVtZW50IGNvdW50LFxuICAgICAgICAgICAgICAgICAgICAvLyByZW5kZXIgdGhlIHN1YnRpdGxlIHdoZXJlIHRoZSBjb3VudCBpcyBkaXNwbGF5ZWRcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF8uaGFzKG1vZGVsLmNoYW5nZWQsIFwiZWxlbWVudF9jb3VudFwiKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiQoXCI+IC50aXRsZS1iYXIgLnN1YnRpdGxlXCIpLnJlcGxhY2VXaXRoKHRoaXMuX3JlbmRlclN1YnRpdGxlKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gcmVuZGVyaW5nXG4gICAgICAgIC8qKiByZW5kZXIgYSBzdWJ0aXRsZSB0byBzaG93IHRoZSB1c2VyIHdoYXQgc29ydCBvZiBjb2xsZWN0aW9uIHRoaXMgaXMgKi9cbiAgICAgICAgX3JlbmRlclN1YnRpdGxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAkKHRoaXMudGVtcGxhdGVzLnN1YnRpdGxlKHRoaXMubW9kZWwudG9KU09OKCksIHRoaXMpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGZvbGRvdXRcbiAgICAgICAgLyoqIG92ZXJyaWRlIHRvIGFkZCBsaW5rdGFyZ2V0IHRvIHN1Yi1wYW5lbCAqL1xuICAgICAgICBfZ2V0Rm9sZG91dFBhbmVsT3B0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IEZvbGRvdXRMaXN0SXRlbVZpZXcucHJvdG90eXBlLl9nZXRGb2xkb3V0UGFuZWxPcHRpb25zLmNhbGwodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gXy5leHRlbmQob3B0aW9ucywge1xuICAgICAgICAgICAgICAgIGxpbmtUYXJnZXQ6IHRoaXMubGlua1RhcmdldCxcbiAgICAgICAgICAgICAgICBoYXNVc2VyOiB0aGlzLmhhc1VzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBvdmVycmlkZSB0byBub3QgY2F0Y2ggc3ViLXBhbmVsIHNlbGVjdG9ycyAqL1xuICAgICAgICAkc2VsZWN0b3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJChcIj4gLnNlbGVjdG9yXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbFN0cmluZyA9IHRoaXMubW9kZWwgPyBgJHt0aGlzLm1vZGVsfWAgOiBcIihubyBtb2RlbClcIjtcbiAgICAgICAgICAgIHJldHVybiBgRENMaXN0SXRlbVZpZXcoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gVEVNUExBVEVTXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkRDTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT4ge1xuICAgIHZhciB3YXJuaW5ncyA9IF8uZXh0ZW5kKHt9LCBGb2xkb3V0TGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMud2FybmluZ3MsIHtcbiAgICAgICAgZXJyb3I6IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShbXG4gICAgICAgICAgICAvLyBlcnJvciBkdXJpbmcgaW5kZXggZmV0Y2ggLSBzaG93IGVycm9yIG9uIGRhdGFzZXRcbiAgICAgICAgICAgIFwiPCUgaWYoIG1vZGVsLmVycm9yICl7ICU+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImVycm9ybWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgIF9sKFwiVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgdGhlIGRhdGEgZm9yIHRoaXMgY29sbGVjdGlvblwiKSxcbiAgICAgICAgICAgIFwiOiA8JS0gbW9kZWwuZXJyb3IgJT5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICBdKSxcbiAgICAgICAgcHVyZ2VkOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoW1xuICAgICAgICAgICAgXCI8JSBpZiggbW9kZWwucHVyZ2VkICl7ICU+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInB1cmdlZC1tc2cgd2FybmluZ21lc3NhZ2VzbWFsbFwiPicsXG4gICAgICAgICAgICBfbChcIlRoaXMgY29sbGVjdGlvbiBoYXMgYmVlbiBkZWxldGVkIGFuZCByZW1vdmVkIGZyb20gZGlza1wiKSxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICBdKSxcbiAgICAgICAgZGVsZXRlZDogQkFTRV9NVkMud3JhcFRlbXBsYXRlKFtcbiAgICAgICAgICAgIC8vIGRlbGV0ZWQgbm90IHB1cmdlZFxuICAgICAgICAgICAgXCI8JSBpZiggbW9kZWwuZGVsZXRlZCAmJiAhbW9kZWwucHVyZ2VkICl7ICU+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRlbGV0ZWQtbXNnIHdhcm5pbmdtZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgX2woXCJUaGlzIGNvbGxlY3Rpb24gaGFzIGJlZW4gZGVsZXRlZFwiKSxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICBdKVxuICAgIH0pO1xuXG4gICAgLy8gdXNlIGVsZW1lbnQgaWRlbnRpZmllclxuICAgIHZhciB0aXRsZUJhclRlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRpdGxlLWJhciBjbGVhclwiIHRhYmluZGV4PVwiMFwiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRpdGxlXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIm5hbWVcIj48JS0gY29sbGVjdGlvbi5lbGVtZW50X2lkZW50aWZpZXIgfHwgY29sbGVjdGlvbi5uYW1lICU+PC9zcGFuPicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPjwvZGl2PicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiY29sbGVjdGlvblwiXG4gICAgKTtcblxuICAgIC8vIHVzZSBlbGVtZW50IGlkZW50aWZpZXJcbiAgICB2YXIgc3VidGl0bGVUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPicsXG4gICAgICAgICAgICAnPCUgdmFyIGNvdW50VGV4dCA9IGNvbGxlY3Rpb24uZWxlbWVudF9jb3VudD8gKCBjb2xsZWN0aW9uLmVsZW1lbnRfY291bnQgKyBcIiBcIiApIDogXCJcIjsgJT4nLFxuICAgICAgICAgICAgJzwlICAgICAgICBpZiggY29sbGVjdGlvbi5jb2xsZWN0aW9uX3R5cGUgPT09IFwibGlzdFwiICl7ICU+JyxcbiAgICAgICAgICAgIF9sKFwiYSBsaXN0IG9mIDwlLSBjb3VudFRleHQgJT5kYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICc8JSB9IGVsc2UgaWYoIGNvbGxlY3Rpb24uY29sbGVjdGlvbl90eXBlID09PSBcInBhaXJlZFwiICl7ICU+JyxcbiAgICAgICAgICAgIF9sKFwiYSBwYWlyIG9mIGRhdGFzZXRzXCIpLFxuICAgICAgICAgICAgJzwlIH0gZWxzZSBpZiggY29sbGVjdGlvbi5jb2xsZWN0aW9uX3R5cGUgPT09IFwibGlzdDpwYWlyZWRcIiApeyAlPicsXG4gICAgICAgICAgICBfbChcImEgbGlzdCBvZiA8JS0gY291bnRUZXh0ICU+ZGF0YXNldCBwYWlyc1wiKSxcbiAgICAgICAgICAgICc8JSB9IGVsc2UgaWYoIGNvbGxlY3Rpb24uY29sbGVjdGlvbl90eXBlID09PSBcImxpc3Q6bGlzdFwiICl7ICU+JyxcbiAgICAgICAgICAgIF9sKFwiYSBsaXN0IG9mIDwlLSBjb3VudFRleHQgJT5kYXRhc2V0IGxpc3RzXCIpLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiY29sbGVjdGlvblwiXG4gICAgKTtcblxuICAgIHJldHVybiBfLmV4dGVuZCh7fSwgRm9sZG91dExpc3RJdGVtVmlldy5wcm90b3R5cGUudGVtcGxhdGVzLCB7XG4gICAgICAgIHdhcm5pbmdzOiB3YXJuaW5ncyxcbiAgICAgICAgdGl0bGVCYXI6IHRpdGxlQmFyVGVtcGxhdGUsXG4gICAgICAgIHN1YnRpdGxlOiBzdWJ0aXRsZVRlbXBsYXRlXG4gICAgfSk7XG59KSgpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEBjbGFzcyBSZWFkIG9ubHkgdmlldyBmb3IgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50LlxuICovXG52YXIgRENFTGlzdEl0ZW1WaWV3ID0gTGlzdEl0ZW1WaWV3LmV4dGVuZChcbiAgICAvKiogQGxlbmRzIERDRUxpc3RJdGVtVmlldy5wcm90b3R5cGUgKi8ge1xuICAgICAgICAvKiogYWRkIHRoZSBEQ0UgY2xhc3MgdG8gdGhlIGxpc3QgaXRlbSAqL1xuICAgICAgICBjbGFzc05hbWU6IGAke0xpc3RJdGVtVmlldy5wcm90b3R5cGUuY2xhc3NOYW1lfSBkYXRhc2V0LWNvbGxlY3Rpb24tZWxlbWVudGAsXG5cbiAgICAgICAgLyoqIHNldCB1cCAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5sb2dnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlciA9IHRoaXMubW9kZWwubG9nZ2VyID0gYXR0cmlidXRlcy5sb2dnZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxvZyhcIkRDRUxpc3RJdGVtVmlldy5pbml0aWFsaXplOlwiLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIExpc3RJdGVtVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbFN0cmluZyA9IHRoaXMubW9kZWwgPyBgJHt0aGlzLm1vZGVsfWAgOiBcIihubyBtb2RlbClcIjtcbiAgICAgICAgICAgIHJldHVybiBgRENFTGlzdEl0ZW1WaWV3KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFRFTVBMQVRFU1xuLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGVzICovXG5EQ0VMaXN0SXRlbVZpZXcucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgLy8gdXNlIHRoZSBlbGVtZW50IGlkZW50aWZpZXIgaGVyZSAtIHNpbmNlIHRoYXQgd2lsbCBwZXJzaXN0IGFuZCB0aGUgdXNlciB3aWxsIG5lZWQgaXRcbiAgICB2YXIgdGl0bGVCYXJUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShcbiAgICAgICAgW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZS1iYXIgY2xlYXJcIiB0YWJpbmRleD1cIjBcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZVwiPicsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJuYW1lXCI+PCUtIGVsZW1lbnQuZWxlbWVudF9pZGVudGlmaWVyICU+PC9zcGFuPicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPjwvZGl2PicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgKTtcblxuICAgIHJldHVybiBfLmV4dGVuZCh7fSwgTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMsIHtcbiAgICAgICAgdGl0bGVCYXI6IHRpdGxlQmFyVGVtcGxhdGVcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIFJlYWQgb25seSB2aWV3IGZvciBhIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudCB0aGF0IGlzIGFsc28gYW4gRGF0YXNldEFzc29jaWF0aW9uXG4gKiAgICAgIChhIGRhdGFzZXQgY29udGFpbmVkIGluIGEgZGF0YXNldCBjb2xsZWN0aW9uKS5cbiAqL1xudmFyIERhdGFzZXREQ0VMaXN0SXRlbVZpZXcgPSBEQVRBU0VUX0xJLkRhdGFzZXRMaXN0SXRlbVZpZXcuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgRGF0YXNldERDRUxpc3RJdGVtVmlldy5wcm90b3R5cGUgKi8ge1xuICAgICAgICBjbGFzc05hbWU6IGAke0RBVEFTRVRfTEkuRGF0YXNldExpc3RJdGVtVmlldy5wcm90b3R5cGUuY2xhc3NOYW1lfSBkYXRhc2V0LWNvbGxlY3Rpb24tZWxlbWVudGAsXG5cbiAgICAgICAgLyoqIHNldCB1cCAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5sb2dnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlciA9IHRoaXMubW9kZWwubG9nZ2VyID0gYXR0cmlidXRlcy5sb2dnZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxvZyhcIkRhdGFzZXREQ0VMaXN0SXRlbVZpZXcuaW5pdGlhbGl6ZTpcIiwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICBEQVRBU0VUX0xJLkRhdGFzZXRMaXN0SXRlbVZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgb25seSBnZXQgZGV0YWlscyBpZiBpbiB0aGUgcmVhZHkgc3RhdGUuXG4gICAgICAgICAqICBOb3RlOiBmZXRjaCB3aXRoIG5vICdjaGFuZ2UnIGV2ZW50IHRyaWdnZXJpbmcgdG8gcHJldmVudCBhdXRvbWF0aWMgcmVuZGVyaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgX2ZldGNoTW9kZWxEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgICAgIGlmICh2aWV3Lm1vZGVsLmluUmVhZHlTdGF0ZSgpICYmICF2aWV3Lm1vZGVsLmhhc0RldGFpbHMoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3Lm1vZGVsLmZldGNoKHsgc2lsZW50OiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBEYXRhc2V0RENFTGlzdEl0ZW1WaWV3KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFRFTVBMQVRFU1xuLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGVzICovXG5EYXRhc2V0RENFTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT4ge1xuICAgIC8vIHVzZSB0aGUgZWxlbWVudCBpZGVudGlmaWVyIGhlcmUgYW5kIG5vdCB0aGUgZGF0YXNldCBuYW1lXG4gICAgLy9UT0RPOj8/IGNhbiB3ZSBzdGVhbCB0aGUgRENFIHRpdGxlYmFyP1xuICAgIHZhciB0aXRsZUJhclRlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRpdGxlLWJhciBjbGVhclwiIHRhYmluZGV4PVwiMFwiPicsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJzdGF0ZS1pY29uXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRpdGxlXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cIm5hbWVcIj48JS0gZWxlbWVudC5lbGVtZW50X2lkZW50aWZpZXIgJT48L3NwYW4+JyxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiZWxlbWVudFwiXG4gICAgKTtcblxuICAgIHJldHVybiBfLmV4dGVuZCh7fSwgREFUQVNFVF9MSS5EYXRhc2V0TGlzdEl0ZW1WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMsIHtcbiAgICAgICAgdGl0bGVCYXI6IHRpdGxlQmFyVGVtcGxhdGVcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIFJlYWQgb25seSB2aWV3IGZvciBhIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudCB0aGF0IGlzIGFsc28gYSBEYXRhc2V0Q29sbGVjdGlvblxuICogICAgICAoYSBuZXN0ZWQgREMpLlxuICovXG52YXIgTmVzdGVkRENEQ0VMaXN0SXRlbVZpZXcgPSBEQ0xpc3RJdGVtVmlldy5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBOZXN0ZWREQ0RDRUxpc3RJdGVtVmlldy5wcm90b3R5cGUgKi8ge1xuICAgICAgICBjbGFzc05hbWU6IGAke0RDTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS5jbGFzc05hbWV9IGRhdGFzZXQtY29sbGVjdGlvbi1lbGVtZW50YCxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgYWRkIHRoZSBzdGF0ZSBhcyBhIGNsYXNzIGZvciB1c2Ugd2l0aCBzdGF0ZS1iYXNlZCBDU1MgKi9cbiAgICAgICAgX3N3YXBOZXdSZW5kZXI6IGZ1bmN0aW9uKCRuZXdSZW5kZXIpIHtcbiAgICAgICAgICAgIERDTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS5fc3dhcE5ld1JlbmRlci5jYWxsKHRoaXMsICRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5tb2RlbC5nZXQoXCJzdGF0ZVwiKSB8fCBcIm9rXCI7XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhgc3RhdGUtJHtzdGF0ZX1gKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRlbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIG1pc2NcbiAgICAgICAgLyoqIFN0cmluZyByZXByZXNlbnRhdGlvbiAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWxTdHJpbmcgPSB0aGlzLm1vZGVsID8gYCR7dGhpcy5tb2RlbH1gIDogXCIobm8gbW9kZWwpXCI7XG4gICAgICAgICAgICByZXR1cm4gYE5lc3RlZERDRENFTGlzdEl0ZW1WaWV3KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIERDTGlzdEl0ZW1WaWV3OiBEQ0xpc3RJdGVtVmlldyxcbiAgICBEQ0VMaXN0SXRlbVZpZXc6IERDRUxpc3RJdGVtVmlldyxcbiAgICBEYXRhc2V0RENFTGlzdEl0ZW1WaWV3OiBEYXRhc2V0RENFTGlzdEl0ZW1WaWV3LFxuICAgIE5lc3RlZERDRENFTGlzdEl0ZW1WaWV3OiBOZXN0ZWREQ0RDRUxpc3RJdGVtVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvY29sbGVjdGlvbi9jb2xsZWN0aW9uLWxpLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdkRBO0FBQ0E7QUEwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQU9BO0FBQ0E7QUFDQTtBQW5CQTtBQUNBO0FBMEJBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFDQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWxCQTtBQUNBO0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNUJBO0FBQ0E7QUErQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBaEJBO0FBQ0E7QUFtQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///32\n");

/***/ }),
/* 33 */,
/* 34 */,
/* 35 */,
/* 36 */,
/* 37 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/mvc/ui/error-modal.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//TODO: toastr is another possibility - I didn't see where I might add details, tho\n\n/* ============================================================================\nError modals meant to replace the o-so-easy alerts.\n\nThese are currently styled as errormessages but use the Galaxy.modal\ninfrastructure to be shown/closed. They're capable of showing details in a\ntogglable dropdown and the details are formatted in a pre.\n\nExample:\n    errorModal( 'Heres a message', 'A Title', { some_details: 'here' });\n    errorModal( 'Heres a message' ); // no details, title is 'Error'\n\nThere are three specialized forms:\n    offlineErrorModal       a canned response for when there's no connection\n    badGatewayErrorModal    canned response for when Galaxy is restarting\n    ajaxErrorModal          plugable into any Backbone class as an\n        error event handler by accepting the error args: model, xhr, options\n\nExamples:\n    if( navigator.offLine ){ offlineErrorModal(); }\n    if( xhr.status === 502 ){ badGatewayErrorModal(); }\n    this.listenTo( this.model, 'error', ajaxErrorModal );\n\n============================================================================ */\n\nvar CONTACT_MSG = (0, _localization2.default)(\"Please contact a Galaxy administrator if the problem persists.\");\nvar DEFAULT_AJAX_ERR_MSG = (0, _localization2.default)(\"An error occurred while updating information with the server.\");\nvar DETAILS_MSG = (0, _localization2.default)(\"The following information can assist the developers in finding the source of the error:\");\n\n/** private helper that builds the modal and handles adding details */\nfunction _errorModal(message, title, details) {\n    // create and return the modal, adding details button only if needed\n    Galaxy.modal.show({\n        title: title,\n        body: message,\n        closing_events: true,\n        buttons: {\n            Ok: function Ok() {\n                Galaxy.modal.hide();\n            }\n        }\n    });\n    Galaxy.modal.$el.addClass(\"error-modal\");\n\n    if (details) {\n        Galaxy.modal.$(\".error-details\").add(Galaxy.modal.$('button:contains(\"Details\")')).remove();\n        $(\"<div/>\").addClass(\"error-details\").hide().appendTo(Galaxy.modal.$(\".modal-content\")).append([$(\"<p/>\").text(DETAILS_MSG), $(\"<pre/>\").text(JSON.stringify(details, null, \"  \"))]);\n\n        $(\"<button id=\\\"button-1\\\" class=\\\"pull-left\\\">\" + (0, _localization2.default)(\"Details\") + \"</button>\").appendTo(Galaxy.modal.$(\".buttons\")).click(function () {\n            Galaxy.modal.$(\".error-details\").toggle();\n        });\n    }\n    return Galaxy.modal;\n}\n\n/** Display a modal showing an error message but fallback to alert if there's no modal */\nfunction errorModal(message, title, details) {\n    if (!message) {\n        return;\n    }\n\n    message = (0, _localization2.default)(message);\n    title = (0, _localization2.default)(title) || (0, _localization2.default)(\"Error:\");\n    if (window.Galaxy && Galaxy.modal) {\n        return _errorModal(message, title, details);\n    }\n\n    alert(title + \"\\n\\n\" + message);\n    console.log(\"error details:\", JSON.stringify(details));\n}\n\n// ----------------------------------------------------------------------------\n/** display a modal when the user may be offline */\nfunction offlineErrorModal() {\n    return errorModal((0, _localization2.default)(\"You appear to be offline. Please check your connection and try again.\"), (0, _localization2.default)(\"Offline?\"));\n}\n\n// ----------------------------------------------------------------------------\n/** 502 messages that should be displayed when galaxy is restarting */\nfunction badGatewayErrorModal() {\n    return errorModal((0, _localization2.default)(\"Galaxy is currently unreachable. Please try again in a few minutes.\") + \" \" + CONTACT_MSG, (0, _localization2.default)(\"Cannot connect to Galaxy\"));\n}\n\n// ----------------------------------------------------------------------------\n/** display a modal (with details) about a failed Backbone ajax operation */\nfunction ajaxErrorModal(model, xhr, options, message, title) {\n    message = message || DEFAULT_AJAX_ERR_MSG;\n    message += \" \" + CONTACT_MSG;\n    title = title || (0, _localization2.default)(\"An error occurred\");\n    var details = _ajaxDetails(model, xhr, options);\n    return errorModal(message, title, details);\n}\n\n/** build details which may help debugging the ajax call */\nfunction _ajaxDetails(model, xhr, options) {\n    return {\n        //TODO: still can't manage Raven id\n        raven: _.result(window.Raven, \"lastEventId\"),\n        userAgent: navigator.userAgent,\n        onLine: navigator.onLine,\n        version: _.result(Galaxy.config, \"version_major\"),\n        xhr: _.omit(xhr, _.functions(xhr)),\n        options: _.omit(options, \"xhr\"),\n        // add ajax data from Galaxy object cache\n        url: _.result(Galaxy.lastAjax, \"url\"),\n        data: _.result(Galaxy.lastAjax, \"data\"),\n        // backbone stuff (auto-redacting email for user)\n        model: _.result(model, \"toJSON\", \"\" + model),\n        user: _.omit(_.result(Galaxy.user, \"toJSON\"), \"email\")\n    };\n}\n\n//=============================================================================\nexports.default = {\n    errorModal: errorModal,\n    offlineErrorModal: offlineErrorModal,\n    badGatewayErrorModal: badGatewayErrorModal,\n    ajaxErrorModal: ajaxErrorModal\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VpL2Vycm9yLW1vZGFsLmpzPzc3MDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcblxuLy9UT0RPOiB0b2FzdHIgaXMgYW5vdGhlciBwb3NzaWJpbGl0eSAtIEkgZGlkbid0IHNlZSB3aGVyZSBJIG1pZ2h0IGFkZCBkZXRhaWxzLCB0aG9cblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuRXJyb3IgbW9kYWxzIG1lYW50IHRvIHJlcGxhY2UgdGhlIG8tc28tZWFzeSBhbGVydHMuXG5cblRoZXNlIGFyZSBjdXJyZW50bHkgc3R5bGVkIGFzIGVycm9ybWVzc2FnZXMgYnV0IHVzZSB0aGUgR2FsYXh5Lm1vZGFsXG5pbmZyYXN0cnVjdHVyZSB0byBiZSBzaG93bi9jbG9zZWQuIFRoZXkncmUgY2FwYWJsZSBvZiBzaG93aW5nIGRldGFpbHMgaW4gYVxudG9nZ2xhYmxlIGRyb3Bkb3duIGFuZCB0aGUgZGV0YWlscyBhcmUgZm9ybWF0dGVkIGluIGEgcHJlLlxuXG5FeGFtcGxlOlxuICAgIGVycm9yTW9kYWwoICdIZXJlcyBhIG1lc3NhZ2UnLCAnQSBUaXRsZScsIHsgc29tZV9kZXRhaWxzOiAnaGVyZScgfSk7XG4gICAgZXJyb3JNb2RhbCggJ0hlcmVzIGEgbWVzc2FnZScgKTsgLy8gbm8gZGV0YWlscywgdGl0bGUgaXMgJ0Vycm9yJ1xuXG5UaGVyZSBhcmUgdGhyZWUgc3BlY2lhbGl6ZWQgZm9ybXM6XG4gICAgb2ZmbGluZUVycm9yTW9kYWwgICAgICAgYSBjYW5uZWQgcmVzcG9uc2UgZm9yIHdoZW4gdGhlcmUncyBubyBjb25uZWN0aW9uXG4gICAgYmFkR2F0ZXdheUVycm9yTW9kYWwgICAgY2FubmVkIHJlc3BvbnNlIGZvciB3aGVuIEdhbGF4eSBpcyByZXN0YXJ0aW5nXG4gICAgYWpheEVycm9yTW9kYWwgICAgICAgICAgcGx1Z2FibGUgaW50byBhbnkgQmFja2JvbmUgY2xhc3MgYXMgYW5cbiAgICAgICAgZXJyb3IgZXZlbnQgaGFuZGxlciBieSBhY2NlcHRpbmcgdGhlIGVycm9yIGFyZ3M6IG1vZGVsLCB4aHIsIG9wdGlvbnNcblxuRXhhbXBsZXM6XG4gICAgaWYoIG5hdmlnYXRvci5vZmZMaW5lICl7IG9mZmxpbmVFcnJvck1vZGFsKCk7IH1cbiAgICBpZiggeGhyLnN0YXR1cyA9PT0gNTAyICl7IGJhZEdhdGV3YXlFcnJvck1vZGFsKCk7IH1cbiAgICB0aGlzLmxpc3RlblRvKCB0aGlzLm1vZGVsLCAnZXJyb3InLCBhamF4RXJyb3JNb2RhbCApO1xuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbnZhciBDT05UQUNUX01TRyA9IF9sKFwiUGxlYXNlIGNvbnRhY3QgYSBHYWxheHkgYWRtaW5pc3RyYXRvciBpZiB0aGUgcHJvYmxlbSBwZXJzaXN0cy5cIik7XG52YXIgREVGQVVMVF9BSkFYX0VSUl9NU0cgPSBfbChcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHVwZGF0aW5nIGluZm9ybWF0aW9uIHdpdGggdGhlIHNlcnZlci5cIik7XG52YXIgREVUQUlMU19NU0cgPSBfbChcIlRoZSBmb2xsb3dpbmcgaW5mb3JtYXRpb24gY2FuIGFzc2lzdCB0aGUgZGV2ZWxvcGVycyBpbiBmaW5kaW5nIHRoZSBzb3VyY2Ugb2YgdGhlIGVycm9yOlwiKTtcblxuLyoqIHByaXZhdGUgaGVscGVyIHRoYXQgYnVpbGRzIHRoZSBtb2RhbCBhbmQgaGFuZGxlcyBhZGRpbmcgZGV0YWlscyAqL1xuZnVuY3Rpb24gX2Vycm9yTW9kYWwobWVzc2FnZSwgdGl0bGUsIGRldGFpbHMpIHtcbiAgICAvLyBjcmVhdGUgYW5kIHJldHVybiB0aGUgbW9kYWwsIGFkZGluZyBkZXRhaWxzIGJ1dHRvbiBvbmx5IGlmIG5lZWRlZFxuICAgIEdhbGF4eS5tb2RhbC5zaG93KHtcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICBib2R5OiBtZXNzYWdlLFxuICAgICAgICBjbG9zaW5nX2V2ZW50czogdHJ1ZSxcbiAgICAgICAgYnV0dG9uczoge1xuICAgICAgICAgICAgT2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIEdhbGF4eS5tb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBHYWxheHkubW9kYWwuJGVsLmFkZENsYXNzKFwiZXJyb3ItbW9kYWxcIik7XG5cbiAgICBpZiAoZGV0YWlscykge1xuICAgICAgICBHYWxheHkubW9kYWxcbiAgICAgICAgICAgIC4kKFwiLmVycm9yLWRldGFpbHNcIilcbiAgICAgICAgICAgIC5hZGQoR2FsYXh5Lm1vZGFsLiQoJ2J1dHRvbjpjb250YWlucyhcIkRldGFpbHNcIiknKSlcbiAgICAgICAgICAgIC5yZW1vdmUoKTtcbiAgICAgICAgJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwiZXJyb3ItZGV0YWlsc1wiKVxuICAgICAgICAgICAgLmhpZGUoKVxuICAgICAgICAgICAgLmFwcGVuZFRvKEdhbGF4eS5tb2RhbC4kKFwiLm1vZGFsLWNvbnRlbnRcIikpXG4gICAgICAgICAgICAuYXBwZW5kKFskKFwiPHAvPlwiKS50ZXh0KERFVEFJTFNfTVNHKSwgJChcIjxwcmUvPlwiKS50ZXh0KEpTT04uc3RyaW5naWZ5KGRldGFpbHMsIG51bGwsIFwiICBcIikpXSk7XG5cbiAgICAgICAgJChgPGJ1dHRvbiBpZD1cImJ1dHRvbi0xXCIgY2xhc3M9XCJwdWxsLWxlZnRcIj4ke19sKFwiRGV0YWlsc1wiKX08L2J1dHRvbj5gKVxuICAgICAgICAgICAgLmFwcGVuZFRvKEdhbGF4eS5tb2RhbC4kKFwiLmJ1dHRvbnNcIikpXG4gICAgICAgICAgICAuY2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIEdhbGF4eS5tb2RhbC4kKFwiLmVycm9yLWRldGFpbHNcIikudG9nZ2xlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIEdhbGF4eS5tb2RhbDtcbn1cblxuLyoqIERpc3BsYXkgYSBtb2RhbCBzaG93aW5nIGFuIGVycm9yIG1lc3NhZ2UgYnV0IGZhbGxiYWNrIHRvIGFsZXJ0IGlmIHRoZXJlJ3Mgbm8gbW9kYWwgKi9cbmZ1bmN0aW9uIGVycm9yTW9kYWwobWVzc2FnZSwgdGl0bGUsIGRldGFpbHMpIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIG1lc3NhZ2UgPSBfbChtZXNzYWdlKTtcbiAgICB0aXRsZSA9IF9sKHRpdGxlKSB8fCBfbChcIkVycm9yOlwiKTtcbiAgICBpZiAod2luZG93LkdhbGF4eSAmJiBHYWxheHkubW9kYWwpIHtcbiAgICAgICAgcmV0dXJuIF9lcnJvck1vZGFsKG1lc3NhZ2UsIHRpdGxlLCBkZXRhaWxzKTtcbiAgICB9XG5cbiAgICBhbGVydChgJHt0aXRsZX1cXG5cXG4ke21lc3NhZ2V9YCk7XG4gICAgY29uc29sZS5sb2coXCJlcnJvciBkZXRhaWxzOlwiLCBKU09OLnN0cmluZ2lmeShkZXRhaWxzKSk7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBkaXNwbGF5IGEgbW9kYWwgd2hlbiB0aGUgdXNlciBtYXkgYmUgb2ZmbGluZSAqL1xuZnVuY3Rpb24gb2ZmbGluZUVycm9yTW9kYWwoKSB7XG4gICAgcmV0dXJuIGVycm9yTW9kYWwoX2woXCJZb3UgYXBwZWFyIHRvIGJlIG9mZmxpbmUuIFBsZWFzZSBjaGVjayB5b3VyIGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi5cIiksIF9sKFwiT2ZmbGluZT9cIikpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogNTAyIG1lc3NhZ2VzIHRoYXQgc2hvdWxkIGJlIGRpc3BsYXllZCB3aGVuIGdhbGF4eSBpcyByZXN0YXJ0aW5nICovXG5mdW5jdGlvbiBiYWRHYXRld2F5RXJyb3JNb2RhbCgpIHtcbiAgICByZXR1cm4gZXJyb3JNb2RhbChcbiAgICAgICAgYCR7X2woXCJHYWxheHkgaXMgY3VycmVudGx5IHVucmVhY2hhYmxlLiBQbGVhc2UgdHJ5IGFnYWluIGluIGEgZmV3IG1pbnV0ZXMuXCIpfSAke0NPTlRBQ1RfTVNHfWAsXG4gICAgICAgIF9sKFwiQ2Fubm90IGNvbm5lY3QgdG8gR2FsYXh5XCIpXG4gICAgKTtcbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIGRpc3BsYXkgYSBtb2RhbCAod2l0aCBkZXRhaWxzKSBhYm91dCBhIGZhaWxlZCBCYWNrYm9uZSBhamF4IG9wZXJhdGlvbiAqL1xuZnVuY3Rpb24gYWpheEVycm9yTW9kYWwobW9kZWwsIHhociwgb3B0aW9ucywgbWVzc2FnZSwgdGl0bGUpIHtcbiAgICBtZXNzYWdlID0gbWVzc2FnZSB8fCBERUZBVUxUX0FKQVhfRVJSX01TRztcbiAgICBtZXNzYWdlICs9IGAgJHtDT05UQUNUX01TR31gO1xuICAgIHRpdGxlID0gdGl0bGUgfHwgX2woXCJBbiBlcnJvciBvY2N1cnJlZFwiKTtcbiAgICB2YXIgZGV0YWlscyA9IF9hamF4RGV0YWlscyhtb2RlbCwgeGhyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gZXJyb3JNb2RhbChtZXNzYWdlLCB0aXRsZSwgZGV0YWlscyk7XG59XG5cbi8qKiBidWlsZCBkZXRhaWxzIHdoaWNoIG1heSBoZWxwIGRlYnVnZ2luZyB0aGUgYWpheCBjYWxsICovXG5mdW5jdGlvbiBfYWpheERldGFpbHMobW9kZWwsIHhociwgb3B0aW9ucykge1xuICAgIHJldHVybiB7XG4gICAgICAgIC8vVE9ETzogc3RpbGwgY2FuJ3QgbWFuYWdlIFJhdmVuIGlkXG4gICAgICAgIHJhdmVuOiBfLnJlc3VsdCh3aW5kb3cuUmF2ZW4sIFwibGFzdEV2ZW50SWRcIiksXG4gICAgICAgIHVzZXJBZ2VudDogbmF2aWdhdG9yLnVzZXJBZ2VudCxcbiAgICAgICAgb25MaW5lOiBuYXZpZ2F0b3Iub25MaW5lLFxuICAgICAgICB2ZXJzaW9uOiBfLnJlc3VsdChHYWxheHkuY29uZmlnLCBcInZlcnNpb25fbWFqb3JcIiksXG4gICAgICAgIHhocjogXy5vbWl0KHhociwgXy5mdW5jdGlvbnMoeGhyKSksXG4gICAgICAgIG9wdGlvbnM6IF8ub21pdChvcHRpb25zLCBcInhoclwiKSxcbiAgICAgICAgLy8gYWRkIGFqYXggZGF0YSBmcm9tIEdhbGF4eSBvYmplY3QgY2FjaGVcbiAgICAgICAgdXJsOiBfLnJlc3VsdChHYWxheHkubGFzdEFqYXgsIFwidXJsXCIpLFxuICAgICAgICBkYXRhOiBfLnJlc3VsdChHYWxheHkubGFzdEFqYXgsIFwiZGF0YVwiKSxcbiAgICAgICAgLy8gYmFja2JvbmUgc3R1ZmYgKGF1dG8tcmVkYWN0aW5nIGVtYWlsIGZvciB1c2VyKVxuICAgICAgICBtb2RlbDogXy5yZXN1bHQobW9kZWwsIFwidG9KU09OXCIsIGAke21vZGVsfWApLFxuICAgICAgICB1c2VyOiBfLm9taXQoXy5yZXN1bHQoR2FsYXh5LnVzZXIsIFwidG9KU09OXCIpLCBcImVtYWlsXCIpXG4gICAgfTtcbn1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIGVycm9yTW9kYWw6IGVycm9yTW9kYWwsXG4gICAgb2ZmbGluZUVycm9yTW9kYWw6IG9mZmxpbmVFcnJvck1vZGFsLFxuICAgIGJhZEdhdGV3YXlFcnJvck1vZGFsOiBiYWRHYXRld2F5RXJyb3JNb2RhbCxcbiAgICBhamF4RXJyb3JNb2RhbDogYWpheEVycm9yTW9kYWxcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VpL2Vycm9yLW1vZGFsLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBd0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBSkE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFLQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///37\n");

/***/ }),
/* 38 */
/*!*************************************************!*\
  !*** ./galaxy/scripts/mvc/history/hda-model.js ***!
  \*************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _datasetModel = __webpack_require__(/*! mvc/dataset/dataset-model */ 50);\n\nvar _datasetModel2 = _interopRequireDefault(_datasetModel);\n\nvar _historyContentModel = __webpack_require__(/*! mvc/history/history-content-model */ 51);\n\nvar _historyContentModel2 = _interopRequireDefault(_historyContentModel);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _datasetModel2.default.DatasetAssociation;\n\nvar hcontentMixin = _historyContentModel2.default.HistoryContentMixin;\n/** @class (HDA) model for a Galaxy dataset contained in and related to a history.\n */\nvar HistoryDatasetAssociation = _super.extend(_baseMvc2.default.mixin(hcontentMixin,\n/** @lends HistoryDatasetAssociation.prototype */{\n    /** default attributes for a model */\n    defaults: _.extend({}, _super.prototype.defaults, hcontentMixin.defaults, {\n        history_content_type: \"dataset\",\n        model_class: \"HistoryDatasetAssociation\"\n    })\n}));\n\n//==============================================================================\nexports.default = {\n    HistoryDatasetAssociation: HistoryDatasetAssociation\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRhLW1vZGVsLmpzPzQ2ZTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERBVEFTRVQgZnJvbSBcIm12Yy9kYXRhc2V0L2RhdGFzZXQtbW9kZWxcIjtcbmltcG9ydCBISVNUT1JZX0NPTlRFTlQgZnJvbSBcIm12Yy9oaXN0b3J5L2hpc3RvcnktY29udGVudC1tb2RlbFwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgX3N1cGVyID0gREFUQVNFVC5EYXRhc2V0QXNzb2NpYXRpb247XG5cbnZhciBoY29udGVudE1peGluID0gSElTVE9SWV9DT05URU5ULkhpc3RvcnlDb250ZW50TWl4aW47XG4vKiogQGNsYXNzIChIREEpIG1vZGVsIGZvciBhIEdhbGF4eSBkYXRhc2V0IGNvbnRhaW5lZCBpbiBhbmQgcmVsYXRlZCB0byBhIGhpc3RvcnkuXG4gKi9cbnZhciBIaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uID0gX3N1cGVyLmV4dGVuZChcbiAgICBCQVNFX01WQy5taXhpbihcbiAgICAgICAgaGNvbnRlbnRNaXhpbixcbiAgICAgICAgLyoqIEBsZW5kcyBIaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uLnByb3RvdHlwZSAqLyB7XG4gICAgICAgICAgICAvKiogZGVmYXVsdCBhdHRyaWJ1dGVzIGZvciBhIG1vZGVsICovXG4gICAgICAgICAgICBkZWZhdWx0czogXy5leHRlbmQoe30sIF9zdXBlci5wcm90b3R5cGUuZGVmYXVsdHMsIGhjb250ZW50TWl4aW4uZGVmYXVsdHMsIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5X2NvbnRlbnRfdHlwZTogXCJkYXRhc2V0XCIsXG4gICAgICAgICAgICAgICAgbW9kZWxfY2xhc3M6IFwiSGlzdG9yeURhdGFzZXRBc3NvY2lhdGlvblwiXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgKVxuKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBIaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uOiBIaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L2hkYS1tb2RlbC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBRkE7QUFDQTtBQVNBO0FBQ0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///38\n");

/***/ }),
/* 39 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/mvc/list/list-view.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listItem = __webpack_require__(/*! mvc/list/list-item */ 22);\n\nvar _listItem2 = _interopRequireDefault(_listItem);\n\nvar _loadingIndicator = __webpack_require__(/*! ui/loading-indicator */ 36);\n\nvar _loadingIndicator2 = _interopRequireDefault(_loadingIndicator);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/search-input */ 40);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"list\";\n/* ============================================================================\nTODO:\n\n============================================================================ */\n/** @class View for a list/collection of models and the sub-views of those models.\n *      Sub-views must (at least have the interface if not) inherit from ListItemView.\n *      (For a list panel that also includes some 'container' model (History->HistoryContents)\n *      use ModelWithListPanel)\n *\n *  Allows for:\n *      searching collection/sub-views\n *      selecting/multi-selecting sub-views\n *\n *  Currently used:\n *      for dataset/dataset-choice\n *      as superclass of ModelListPanel\n */\nvar ListPanel = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend(\n/** @lends ListPanel.prototype */{\n    _logNamespace: logNamespace,\n\n    /** class to use for constructing the sub-views */\n    viewClass: _listItem2.default.ListItemView,\n    /** class to used for constructing collection of sub-view models */\n    collectionClass: Backbone.Collection,\n\n    tagName: \"div\",\n    className: \"list-panel\",\n\n    /** (in ms) that jquery effects will use */\n    fxSpeed: \"fast\",\n\n    /** string to display when the collection has no contents */\n    emptyMsg: (0, _localization2.default)(\"This list is empty\"),\n    /** displayed when no items match the search terms */\n    noneFoundMsg: (0, _localization2.default)(\"No matching items found\"),\n    /** string used for search placeholder */\n    searchPlaceholder: (0, _localization2.default)(\"search\"),\n\n    // ......................................................................... SET UP\n    /** Set up the view, set up storage, bind listeners to HistoryContents events\n     *  @param {Object} attributes optional settings for the list\n     */\n    initialize: function initialize(attributes, options) {\n        attributes = attributes || {};\n        // set the logger if requested\n        if (attributes.logger) {\n            this.logger = attributes.logger;\n        }\n        this.log(this + \".initialize:\", attributes);\n\n        // ---- instance vars\n        /** how quickly should jquery fx run? */\n        this.fxSpeed = _.has(attributes, \"fxSpeed\") ? attributes.fxSpeed : this.fxSpeed;\n\n        /** filters for displaying subviews */\n        this.filters = [];\n        /** current search terms */\n        this.searchFor = attributes.searchFor || \"\";\n\n        /** loading indicator */\n        // this.indicator = new LoadingIndicator( this.$el );\n\n        /** currently showing selectors on items? */\n        this.selecting = attributes.selecting !== undefined ? attributes.selecting : true;\n        //this.selecting = false;\n\n        /** cached selected item.model.ids to persist btwn renders */\n        this.selected = attributes.selected || [];\n        /** the last selected item.model.id */\n        this.lastSelected = null;\n\n        /** are sub-views draggable */\n        this.dragItems = attributes.dragItems || false;\n\n        /** list item view class (when passed models) */\n        this.viewClass = attributes.viewClass || this.viewClass;\n\n        /** list item views */\n        this.views = [];\n        /** list item models */\n        this.collection = attributes.collection || this._createDefaultCollection();\n\n        /** filter fns run over collection items to see if they should show in the list */\n        this.filters = attributes.filters || [];\n\n        /** override $scrollContainer fn via attributes - fn should return jq for elem to call scrollTo on */\n        this.$scrollContainer = attributes.$scrollContainer || this.$scrollContainer;\n\n        /** @type {String} generic title */\n        this.title = attributes.title || \"\";\n        /** @type {String} generic subtitle */\n        this.subtitle = attributes.subtitle || \"\";\n\n        this._setUpListeners();\n    },\n\n    // ------------------------------------------------------------------------ listeners\n    /** create any event listeners for the list */\n    _setUpListeners: function _setUpListeners() {\n        this.off();\n\n        //TODO: move errorHandler down into list-view from history-view or\n        //  pass to global error handler (Galaxy)\n        this.on({\n            error: function error(model, xhr, options, msg, details) {\n                //this.errorHandler( model, xhr, options, msg, details );\n                console.error(model, xhr, options, msg, details);\n            },\n            // show hide the loading indicator\n            loading: function loading() {\n                this._showLoadingIndicator(\"loading...\", 40);\n            },\n            \"loading-done\": function loadingDone() {\n                this._hideLoadingIndicator(40);\n            }\n        });\n\n        // throw the first render up as a diff namespace using once (for outside consumption)\n        this.once(\"rendered\", function () {\n            this.trigger(\"rendered:initial\", this);\n        });\n\n        this._setUpCollectionListeners();\n        this._setUpViewListeners();\n        return this;\n    },\n\n    /** create and return a collection for when none is initially passed */\n    _createDefaultCollection: function _createDefaultCollection() {\n        // override\n        return new this.collectionClass([]);\n    },\n\n    /** listening for collection events */\n    _setUpCollectionListeners: function _setUpCollectionListeners() {\n        this.log(this + \"._setUpCollectionListeners\", this.collection);\n        this.stopListening(this.collection);\n\n        // bubble up error events\n        this.listenTo(this.collection, {\n            error: function error(model, xhr, options, msg, details) {\n                this.trigger(\"error\", model, xhr, options, msg, details);\n            },\n            update: function update(collection, options) {\n                var changes = options.changes;\n                // console.info( collection + ', update:', changes, '\\noptions:', options );\n                // more than one: render everything\n                if (options.renderAll || changes.added.length + changes.removed.length > 1) {\n                    return this.renderItems();\n                }\n                // otherwise, let the single add/remove handlers do it\n                if (changes.added.length === 1) {\n                    return this.addItemView(_.first(changes.added), collection, options);\n                }\n                if (changes.removed.length === 1) {\n                    return this.removeItemView(_.first(changes.removed), collection, options);\n                }\n            }\n        });\n        return this;\n    },\n\n    /** listening for sub-view events that bubble up with the 'view:' prefix */\n    _setUpViewListeners: function _setUpViewListeners() {\n        this.log(this + \"._setUpViewListeners\");\n\n        // shift to select a range\n        this.on({\n            \"view:selected\": function viewSelected(view, ev) {\n                if (ev && ev.shiftKey && this.lastSelected) {\n                    var lastSelectedView = this.viewFromModelId(this.lastSelected);\n                    if (lastSelectedView) {\n                        this.selectRange(view, lastSelectedView);\n                    }\n                } else if (ev && ev.altKey && !this.selecting) {\n                    this.showSelectors();\n                }\n                this.selected.push(view.model.id);\n                this.lastSelected = view.model.id;\n            },\n\n            \"view:de-selected\": function viewDeSelected(view, ev) {\n                this.selected = _.without(this.selected, view.model.id);\n            }\n        });\n    },\n\n    // ------------------------------------------------------------------------ rendering\n    /** Render this content, set up ui.\n     *  @param {Number or String} speed   the speed of the render\n     */\n    render: function render(speed) {\n        this.log(this + \".render\", speed);\n        var $newRender = this._buildNewRender();\n        this._setUpBehaviors($newRender);\n        this._queueNewRender($newRender, speed);\n        return this;\n    },\n\n    /** Build a temp div containing the new children for the view's $el. */\n    _buildNewRender: function _buildNewRender() {\n        this.debug(this + \"(ListPanel)._buildNewRender\");\n        var $newRender = $(this.templates.el({}, this));\n        this._renderControls($newRender);\n        this._renderTitle($newRender);\n        this._renderSubtitle($newRender);\n        this._renderSearch($newRender);\n        this.renderItems($newRender);\n        return $newRender;\n    },\n\n    /** Build a temp div containing the new children for the view's $el. */\n    _renderControls: function _renderControls($newRender) {\n        this.debug(this + \"(ListPanel)._renderControls\");\n        var $controls = $(this.templates.controls({}, this));\n        $newRender.find(\".controls\").replaceWith($controls);\n        return $controls;\n    },\n\n    /** return a jQuery object containing the title DOM */\n    _renderTitle: function _renderTitle($where) {\n        //$where = $where || this.$el;\n        //$where.find( '.title' ).replaceWith( ... )\n    },\n\n    /** return a jQuery object containing the subtitle DOM (if any) */\n    _renderSubtitle: function _renderSubtitle($where) {\n        //$where = $where || this.$el;\n        //$where.find( '.title' ).replaceWith( ... )\n    },\n\n    /** Fade out the old el, swap in the new contents, then fade in.\n     *  @param {Number or String} speed   jq speed to use for rendering effects\n     *  @fires rendered when rendered\n     */\n    _queueNewRender: function _queueNewRender($newRender, speed) {\n        speed = speed === undefined ? this.fxSpeed : speed;\n        var panel = this;\n        panel.log(\"_queueNewRender:\", $newRender, speed);\n\n        $(panel).queue(\"fx\", [function (next) {\n            panel.$el.fadeOut(speed, next);\n        }, function (next) {\n            panel._swapNewRender($newRender);\n            next();\n        }, function (next) {\n            panel.$el.fadeIn(speed, next);\n        }, function (next) {\n            panel.trigger(\"rendered\", panel);\n            next();\n        }]);\n    },\n\n    /** empty out the current el, move the $newRender's children in */\n    _swapNewRender: function _swapNewRender($newRender) {\n        this.$el.empty().attr(\"class\", this.className).append($newRender.children());\n        if (this.selecting) {\n            this.showSelectors(0);\n        }\n        return this;\n    },\n\n    /** Set up any behaviors, handlers (ep. plugins) that need to be called when the entire view has been built but\n     *  not attached to the page yet.\n     */\n    _setUpBehaviors: function _setUpBehaviors($where) {\n        $where = $where || this.$el;\n        this.$controls($where).find(\"[title]\").tooltip();\n        // set up the pupup for actions available when multi selecting\n        this._renderMultiselectActionMenu($where);\n        return this;\n    },\n\n    /** render a menu containing the actions available to sets of selected items */\n    _renderMultiselectActionMenu: function _renderMultiselectActionMenu($where) {\n        $where = $where || this.$el;\n        var $menu = $where.find(\".list-action-menu\");\n        var actions = this.multiselectActions();\n        if (!actions.length) {\n            return $menu.empty();\n        }\n\n        var $newMenu = $(['<div class=\"list-action-menu btn-group\">', '<button class=\"list-action-menu-btn btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">', (0, _localization2.default)(\"For all selected\"), \"...\", \"</button>\", '<ul class=\"dropdown-menu pull-right\" role=\"menu\">', \"</ul>\", \"</div>\"].join(\"\"));\n        var $actions = actions.map(function (action) {\n            var html = ['<li><a href=\"javascript:void(0);\">', action.html, \"</a></li>\"].join(\"\");\n            return $(html).click(function (ev) {\n                ev.preventDefault();\n                return action.func(ev);\n            });\n        });\n        $newMenu.find(\"ul\").append($actions);\n        $menu.replaceWith($newMenu);\n        return $newMenu;\n    },\n\n    /** return a list of plain objects used to render multiselect actions menu. Each object should have:\n     *      html: an html string used as the anchor contents\n     *      func: a function called when the anchor is clicked (passed the click event)\n     */\n    multiselectActions: function multiselectActions() {\n        return [];\n    },\n\n    // ------------------------------------------------------------------------ sub-$element shortcuts\n    /** the scroll container for this panel - can be $el, $el.parent(), or grandparent depending on context */\n    $scrollContainer: function $scrollContainer($where) {\n        // override or set via attributes.$scrollContainer\n        return ($where || this.$el).parent().parent();\n    },\n    /** convenience selector for the section that displays the list controls */\n    $controls: function $controls($where) {\n        return ($where || this.$el).find(\"> .controls\");\n    },\n    /** list-items: where the subviews are contained in the view's dom */\n    $list: function $list($where) {\n        return ($where || this.$el).find(\"> .list-items\");\n    },\n    /** container where list messages are attached */\n    $messages: function $messages($where) {\n        //TODO: controls isn't really correct here (only for ModelListPanel)\n        return ($where || this.$el).find(\"> .controls .messages\");\n    },\n    /** the message displayed when no views can be shown (no views, none matching search) */\n    $emptyMessage: function $emptyMessage($where) {\n        return ($where || this.$el).find(\"> .empty-message\");\n    },\n\n    // ------------------------------------------------------------------------ hda sub-views\n    /** render the subviews for the list's collection */\n    renderItems: function renderItems($whereTo) {\n        $whereTo = $whereTo || this.$el;\n        var panel = this;\n        panel.log(this + \".renderItems\", $whereTo);\n\n        var $list = panel.$list($whereTo);\n        panel.freeViews();\n        // console.log( 'views freed' );\n        //TODO:? cache and re-use views?\n        var shownModels = panel._filterCollection();\n        // console.log( 'models filtered:', shownModels );\n\n        panel.views = shownModels.map(function (itemModel) {\n            var view = panel._createItemView(itemModel);\n            return view;\n        });\n\n        $list.empty();\n        // console.log( 'list emptied' );\n        if (panel.views.length) {\n            panel._attachItems($whereTo);\n            // console.log( 'items attached' );\n        }\n        panel._renderEmptyMessage($whereTo).toggle(!panel.views.length);\n        panel.trigger(\"views:ready\", panel.views);\n\n        // console.log( '------------------------------------------- rendering items' );\n        return panel.views;\n    },\n\n    /** Filter the collection to only those models that should be currently viewed */\n    _filterCollection: function _filterCollection() {\n        // override this\n        var panel = this;\n        return panel.collection.filter(_.bind(panel._filterItem, panel));\n    },\n\n    /** Should the model be viewable in the current state?\n     *     Checks against this.filters and this.searchFor\n     */\n    _filterItem: function _filterItem(model) {\n        // override this\n        var panel = this;\n        return _.every(panel.filters.map(function (fn) {\n            return fn.call(model);\n        })) && (!panel.searchFor || model.matchesAll(panel.searchFor));\n    },\n\n    /** Create a view for a model and set up it's listeners */\n    _createItemView: function _createItemView(model) {\n        var ViewClass = this._getItemViewClass(model);\n        var options = _.extend(this._getItemViewOptions(model), {\n            model: model\n        });\n        var view = new ViewClass(options);\n        this._setUpItemViewListeners(view);\n        return view;\n    },\n\n    /** Free a view for a model. Note: does not remove it from the DOM */\n    _destroyItemView: function _destroyItemView(view) {\n        this.stopListening(view);\n        this.views = _.without(this.views, view);\n    },\n\n    _destroyItemViews: function _destroyItemViews(view) {\n        var self = this;\n        self.views.forEach(function (v) {\n            self.stopListening(v);\n        });\n        self.views = [];\n        return self;\n    },\n\n    /** free any sub-views the list has */\n    freeViews: function freeViews() {\n        return this._destroyItemViews();\n    },\n\n    /** Get the bbone view class based on the model */\n    _getItemViewClass: function _getItemViewClass(model) {\n        // override this\n        return this.viewClass;\n    },\n\n    /** Get the options passed to the new view based on the model */\n    _getItemViewOptions: function _getItemViewOptions(model) {\n        // override this\n        return {\n            //logger      : this.logger,\n            fxSpeed: this.fxSpeed,\n            expanded: false,\n            selectable: this.selecting,\n            selected: _.contains(this.selected, model.id),\n            draggable: this.dragItems\n        };\n    },\n\n    /** Set up listeners for new models */\n    _setUpItemViewListeners: function _setUpItemViewListeners(view) {\n        var panel = this;\n        // send all events to the panel, re-namspaceing them with the view prefix\n        this.listenTo(view, \"all\", function () {\n            var args = Array.prototype.slice.call(arguments, 0);\n            args[0] = \"view:\" + args[0];\n            panel.trigger.apply(panel, args);\n        });\n\n        // drag multiple - hijack ev.setData to add all selected items\n        this.listenTo(view, \"draggable:dragstart\", function (ev, v) {\n            //TODO: set multiple drag data here\n            var json = {};\n\n            var selected = this.getSelectedModels();\n            if (selected.length) {\n                json = selected.toJSON();\n            } else {\n                json = [v.model.toJSON()];\n            }\n            ev.dataTransfer.setData(\"text\", JSON.stringify(json));\n            //ev.dataTransfer.setDragImage( v.el, 60, 60 );\n        }, this);\n\n        return panel;\n    },\n\n    /** Attach views in this.views to the model based on $whereTo */\n    _attachItems: function _attachItems($whereTo) {\n        var self = this;\n        // console.log( '_attachItems:', $whereTo, this.$list( $whereTo ) );\n        //ASSUMES: $list has been emptied\n        this.$list($whereTo).append(this.views.map(function (view) {\n            return self._renderItemView$el(view);\n        }));\n        return this;\n    },\n\n    /** get a given subview's $el (or whatever may wrap it) and return it */\n    _renderItemView$el: function _renderItemView$el(view) {\n        // useful to wrap and override\n        return view.render(0).$el;\n    },\n\n    /** render the empty/none-found message */\n    _renderEmptyMessage: function _renderEmptyMessage($whereTo) {\n        this.debug(\"_renderEmptyMessage\", $whereTo, this.searchFor);\n        var text = this.searchFor ? this.noneFoundMsg : this.emptyMsg;\n        return this.$emptyMessage($whereTo).text(text);\n    },\n\n    /** expand all item views */\n    expandAll: function expandAll() {\n        _.each(this.views, function (view) {\n            view.expand();\n        });\n    },\n\n    /** collapse all item views */\n    collapseAll: function collapseAll() {\n        _.each(this.views, function (view) {\n            view.collapse();\n        });\n    },\n\n    // ------------------------------------------------------------------------ collection/views syncing\n    /** Add a view (if the model should be viewable) to the panel */\n    addItemView: function addItemView(model, collection, options) {\n        // console.log( this + '.addItemView:', model );\n        var panel = this;\n        // get the index of the model in the list of filtered models shown by this list\n        // in order to insert the view in the proper place\n        //TODO:? potentially expensive\n        var modelIndex = panel._filterCollection().indexOf(model);\n        if (modelIndex === -1) {\n            return undefined;\n        }\n        var view = panel._createItemView(model);\n        // console.log( 'adding and rendering:', modelIndex, view.toString() );\n\n        $(view).queue(\"fx\", [function (next) {\n            // hide the empty message first if only view\n            if (panel.$emptyMessage().is(\":visible\")) {\n                panel.$emptyMessage().fadeOut(panel.fxSpeed, next);\n            } else {\n                next();\n            }\n        }, function (next) {\n            panel._attachView(view, modelIndex);\n            next();\n        }]);\n        return view;\n    },\n\n    /** internal fn to add view (to both panel.views and panel.$list) */\n    _attachView: function _attachView(view, modelIndex, useFx) {\n        // console.log( this + '._attachView:', view, modelIndex, useFx );\n        useFx = _.isUndefined(useFx) ? true : useFx;\n        modelIndex = modelIndex || 0;\n        var panel = this;\n\n        // use the modelIndex to splice into views and insert at the proper index in the DOM\n        panel.views.splice(modelIndex, 0, view);\n        panel._insertIntoListAt(modelIndex, panel._renderItemView$el(view).hide());\n\n        panel.trigger(\"view:attached\", view);\n        if (useFx) {\n            view.$el.slideDown(panel.fxSpeed, function () {\n                panel.trigger(\"view:attached:rendered\");\n            });\n        } else {\n            view.$el.show();\n            panel.trigger(\"view:attached:rendered\");\n        }\n        return view;\n    },\n\n    /** insert a jq object as a child of list-items at the specified *DOM index* */\n    _insertIntoListAt: function _insertIntoListAt(index, $what) {\n        // console.log( this + '._insertIntoListAt:', index, $what );\n        var $list = this.$list();\n        if (index === 0) {\n            $list.prepend($what);\n        } else {\n            $list.children().eq(index - 1).after($what);\n        }\n        return $what;\n    },\n\n    /** Remove a view from the panel (if found) */\n    removeItemView: function removeItemView(model, collection, options) {\n        var panel = this;\n        var view = _.find(panel.views, function (v) {\n            return v.model === model;\n        });\n        if (!view) {\n            return undefined;\n        }\n        panel.views = _.without(panel.views, view);\n        panel.trigger(\"view:removed\", view);\n\n        // potentially show the empty message if no views left\n        // use anonymous queue here - since remove can happen multiple times\n        $({}).queue(\"fx\", [function (next) {\n            view.$el.fadeOut(panel.fxSpeed, next);\n        }, function (next) {\n            view.remove();\n            panel.trigger(\"view:removed:rendered\");\n            if (!panel.views.length) {\n                panel._renderEmptyMessage().fadeIn(panel.fxSpeed, next);\n            } else {\n                next();\n            }\n        }]);\n        return view;\n    },\n\n    /** get views based on model.id */\n    viewFromModelId: function viewFromModelId(id) {\n        return _.find(this.views, function (v) {\n            return v.model.id === id;\n        });\n    },\n\n    /** get views based on model */\n    viewFromModel: function viewFromModel(model) {\n        return model ? this.viewFromModelId(model.id) : undefined;\n    },\n\n    /** get views based on model properties */\n    viewsWhereModel: function viewsWhereModel(properties) {\n        return this.views.filter(function (view) {\n            return _.isMatch(view.model.attributes, properties);\n        });\n    },\n\n    /** A range of views between (and including) viewA and viewB */\n    viewRange: function viewRange(viewA, viewB) {\n        if (viewA === viewB) {\n            return viewA ? [viewA] : [];\n        }\n\n        var indexA = this.views.indexOf(viewA);\n        var indexB = this.views.indexOf(viewB);\n\n        // handle not found\n        if (indexA === -1 || indexB === -1) {\n            if (indexA === indexB) {\n                return [];\n            }\n            return indexA === -1 ? [viewB] : [viewA];\n        }\n        // reverse if indeces are\n        //note: end inclusive\n        return indexA < indexB ? this.views.slice(indexA, indexB + 1) : this.views.slice(indexB, indexA + 1);\n    },\n\n    // ------------------------------------------------------------------------ searching\n    /** render a search input for filtering datasets shown\n     *      (see SearchableMixin in base-mvc for implementation of the actual searching)\n     *      return will start the search\n     *      esc will clear the search\n     *      clicking the clear button will clear the search\n     *      uses searchInput in ui.js\n     */\n    _renderSearch: function _renderSearch($where) {\n        $where.find(\".controls .search-input\").searchInput({\n            placeholder: this.searchPlaceholder,\n            initialVal: this.searchFor,\n            onfirstsearch: _.bind(this._firstSearch, this),\n            onsearch: _.bind(this.searchItems, this),\n            onclear: _.bind(this.clearSearch, this)\n        });\n        return $where;\n    },\n\n    /** What to do on the first search entered */\n    _firstSearch: function _firstSearch(searchFor) {\n        // override to load model details if necc.\n        this.log(\"onFirstSearch\", searchFor);\n        return this.searchItems(searchFor);\n    },\n\n    /** filter view list to those that contain the searchFor terms */\n    searchItems: function searchItems(searchFor, force) {\n        this.log(\"searchItems\", searchFor, this.searchFor, force);\n        if (!force && this.searchFor === searchFor) {\n            return this;\n        }\n        this.searchFor = searchFor;\n        this.renderItems();\n        this.trigger(\"search:searching\", searchFor, this);\n        var $search = this.$(\"> .controls .search-query\");\n        if ($search.val() !== searchFor) {\n            $search.val(searchFor);\n        }\n        return this;\n    },\n\n    /** clear the search filters and show all views that are normally shown */\n    clearSearch: function clearSearch(searchFor) {\n        //this.log( 'onSearchClear', this );\n        this.searchFor = \"\";\n        this.trigger(\"search:clear\", this);\n        this.$(\"> .controls .search-query\").val(\"\");\n        this.renderItems();\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ selection\n    /** @type Integer when the number of list item views is >= to this, don't animate selectors */\n    THROTTLE_SELECTOR_FX_AT: 20,\n\n    /** show selectors on all visible itemViews and associated controls */\n    showSelectors: function showSelectors(speed) {\n        speed = speed !== undefined ? speed : this.fxSpeed;\n        this.selecting = true;\n        this.$(\".list-actions\").slideDown(speed);\n        speed = this.views.length >= this.THROTTLE_SELECTOR_FX_AT ? 0 : speed;\n        _.each(this.views, function (view) {\n            view.showSelector(speed);\n        });\n        //this.selected = [];\n        //this.lastSelected = null;\n    },\n\n    /** hide selectors on all visible itemViews and associated controls */\n    hideSelectors: function hideSelectors(speed) {\n        speed = speed !== undefined ? speed : this.fxSpeed;\n        this.selecting = false;\n        this.$(\".list-actions\").slideUp(speed);\n        speed = this.views.length >= this.THROTTLE_SELECTOR_FX_AT ? 0 : speed;\n        _.each(this.views, function (view) {\n            view.hideSelector(speed);\n        });\n        this.selected = [];\n        this.lastSelected = null;\n    },\n\n    /** show or hide selectors on all visible itemViews and associated controls */\n    toggleSelectors: function toggleSelectors() {\n        if (!this.selecting) {\n            this.showSelectors();\n        } else {\n            this.hideSelectors();\n        }\n    },\n\n    /** select all visible items */\n    selectAll: function selectAll(event) {\n        _.each(this.views, function (view) {\n            view.select(event);\n        });\n    },\n\n    /** deselect all visible items */\n    deselectAll: function deselectAll(event) {\n        this.lastSelected = null;\n        _.each(this.views, function (view) {\n            view.deselect(event);\n        });\n    },\n\n    /** select a range of datasets between A and B */\n    selectRange: function selectRange(viewA, viewB) {\n        var range = this.viewRange(viewA, viewB);\n        _.each(range, function (view) {\n            view.select();\n        });\n        return range;\n    },\n\n    /** return an array of all currently selected itemViews */\n    getSelectedViews: function getSelectedViews() {\n        return _.filter(this.views, function (v) {\n            return v.selected;\n        });\n    },\n\n    /** return a collection of the models of all currenly selected items */\n    getSelectedModels: function getSelectedModels() {\n        // console.log( '(getSelectedModels)' );\n        return new this.collection.constructor(_.map(this.getSelectedViews(), function (view) {\n            return view.model;\n        }));\n    },\n\n    // ------------------------------------------------------------------------ loading indicator\n    /** hide the $el and display a loading indicator (in the $el's parent) when loading new data */\n    _showLoadingIndicator: function _showLoadingIndicator(msg, speed, callback) {\n        this.debug(\"_showLoadingIndicator\", this.indicator, msg, speed, callback);\n        speed = speed !== undefined ? speed : this.fxSpeed;\n        if (!this.indicator) {\n            this.indicator = new _loadingIndicator2.default.LoadingIndicator(this.$el);\n            this.debug(\"\\t created\", this.indicator);\n        }\n        if (!this.$el.is(\":visible\")) {\n            this.indicator.show(0, callback);\n        } else {\n            this.$el.fadeOut(speed);\n            this.indicator.show(msg, speed, callback);\n        }\n    },\n\n    /** hide the loading indicator */\n    _hideLoadingIndicator: function _hideLoadingIndicator(speed, callback) {\n        this.debug(\"_hideLoadingIndicator\", this.indicator, speed, callback);\n        speed = speed !== undefined ? speed : this.fxSpeed;\n        if (this.indicator) {\n            this.indicator.hide(speed, callback);\n        }\n    },\n\n    // ------------------------------------------------------------------------ scrolling\n    /** get the current scroll position of the panel in its parent */\n    scrollPosition: function scrollPosition() {\n        return this.$scrollContainer().scrollTop();\n    },\n\n    /** set the current scroll position of the panel in its parent */\n    scrollTo: function scrollTo(pos, speed) {\n        speed = speed || 0;\n        this.$scrollContainer().animate({ scrollTop: pos }, speed);\n        return this;\n    },\n\n    /** Scrolls the panel to the top. */\n    scrollToTop: function scrollToTop(speed) {\n        return this.scrollTo(0, speed);\n    },\n\n    /** scroll to the given view in list-items */\n    scrollToItem: function scrollToItem(view, speed) {\n        if (!view) {\n            return this;\n        }\n        return this;\n    },\n\n    /** Scrolls the panel to show the content with the given id. */\n    scrollToId: function scrollToId(id, speed) {\n        return this.scrollToItem(this.viewFromModelId(id), speed);\n    },\n\n    // ------------------------------------------------------------------------ panel events\n    /** event map */\n    events: {\n        \"click .select-all\": \"selectAll\",\n        \"click .deselect-all\": \"deselectAll\"\n    },\n\n    // ------------------------------------------------------------------------ misc\n    /** Return a string rep of the panel */\n    toString: function toString() {\n        return \"ListPanel(\" + this.collection + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nListPanel.prototype.templates = function () {\n    var elTemplate = _baseMvc2.default.wrapTemplate([\n    // temp container\n    \"<div>\", '<div class=\"controls\"></div>', '<div class=\"list-items\"></div>', '<div class=\"empty-message infomessagesmall\"></div>', \"</div>\"]);\n\n    var controlsTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"controls\">', '<div class=\"title\">', '<div class=\"name\"><%- view.title %></div>', \"</div>\", '<div class=\"subtitle\"><%- view.subtitle %></div>',\n    // buttons, controls go here\n    '<div class=\"actions\"></div>',\n    // deleted msg, etc.\n    '<div class=\"messages\"></div>', '<div class=\"search\">', '<div class=\"search-input\"></div>', \"</div>\",\n\n    // show when selectors are shown\n    '<div class=\"list-actions\">', '<div class=\"btn-group\">', '<button class=\"select-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"All\"), \"</button>\", '<button class=\"deselect-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"None\"), \"</button>\", \"</div>\", '<div class=\"list-action-menu btn-group\">', \"</div>\", \"</div>\", \"</div>\"]);\n\n    return {\n        el: elTemplate,\n        controls: controlsTemplate\n    };\n}();\n\n//=============================================================================\n/** View for a model that has a sub-collection (e.g. History, DatasetCollection)\n *  Allows:\n *      the model to be reset\n *      auto assign panel.collection to panel.model[ panel.modelCollectionKey ]\n *\n */\nvar ModelListPanel = ListPanel.extend({\n    /** key of attribute in model to assign to this.collection */\n    modelCollectionKey: \"contents\",\n\n    initialize: function initialize(attributes) {\n        ListPanel.prototype.initialize.call(this, attributes);\n        this.selecting = attributes.selecting !== undefined ? attributes.selecting : false;\n\n        this.setModel(this.model, attributes);\n    },\n\n    /** release/free/shutdown old models and set up panel for new models\n     *  @fires new-model with the panel as parameter\n     */\n    setModel: function setModel(model, attributes) {\n        attributes = attributes || {};\n        this.debug(this + \".setModel:\", model, attributes);\n\n        this.freeModel();\n        this.freeViews();\n\n        if (model) {\n            var oldModelId = this.model ? this.model.get(\"id\") : null;\n\n            // set up the new model with user, logger, storage, events\n            this.model = model;\n            if (this.logger) {\n                this.model.logger = this.logger;\n            }\n            this._setUpModelListeners();\n\n            //TODO: relation btwn model, collection becoming tangled here\n            // free the collection, and assign the new collection to either\n            //  the model[ modelCollectionKey ], attributes.collection, or an empty vanilla collection\n            this.stopListening(this.collection);\n            this.collection = this.model[this.modelCollectionKey] || attributes.collection || this._createDefaultCollection();\n            this._setUpCollectionListeners();\n\n            if (oldModelId && model.get(\"id\") !== oldModelId) {\n                this.trigger(\"new-model\", this);\n            }\n        }\n        return this;\n    },\n\n    /** free the current model and all listeners for it, free any views for the model */\n    freeModel: function freeModel() {\n        // stop/release the previous model, and clear cache to sub-views\n        if (this.model) {\n            this.stopListening(this.model);\n            //TODO: see base-mvc\n            //this.model.free();\n            //this.model = null;\n        }\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ listening\n    /** listening for model events */\n    _setUpModelListeners: function _setUpModelListeners() {\n        // override\n        this.log(this + \"._setUpModelListeners\", this.model);\n        // bounce model errors up to the panel\n        this.listenTo(this.model, \"error\", function () {\n            var args = Array.prototype.slice.call(arguments, 0);\n            //args.unshift( 'model:error' );\n            args.unshift(\"error\");\n            this.trigger.apply(this, args);\n        }, this);\n\n        // debugging\n        if (this.logger) {\n            this.listenTo(this.model, \"all\", function (event) {\n                this.info(this + \"(model)\", event, arguments);\n            });\n        }\n        return this;\n    },\n\n    /** Build a temp div containing the new children for the view's $el.\n     */\n    _renderControls: function _renderControls($newRender) {\n        this.debug(this + \"(ModelListPanel)._renderControls\");\n        var json = this.model ? this.model.toJSON() : {};\n        var $controls = $(this.templates.controls(json, this));\n        $newRender.find(\".controls\").replaceWith($controls);\n        return $controls;\n    },\n\n    // ------------------------------------------------------------------------ misc\n    /** Return a string rep of the panel */\n    toString: function toString() {\n        return \"ModelListPanel(\" + this.model + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nModelListPanel.prototype.templates = function () {\n    var controlsTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"controls\">', '<div class=\"title\">',\n    //TODO: this is really the only difference - consider factoring titlebar out\n    '<div class=\"name\"><%- model.name %></div>', \"</div>\", '<div class=\"subtitle\"><%- view.subtitle %></div>', '<div class=\"actions\"></div>', '<div class=\"messages\"></div>', '<div class=\"search\">', '<div class=\"search-input\"></div>', \"</div>\", '<div class=\"list-actions\">', '<div class=\"btn-group\">', '<button class=\"select-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"All\"), \"</button>\", '<button class=\"deselect-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"None\"), \"</button>\", \"</div>\", '<div class=\"list-action-menu btn-group\">', \"</div>\", \"</div>\", \"</div>\"]);\n\n    return _.extend(_.clone(ListPanel.prototype.templates), {\n        controls: controlsTemplate\n    });\n}();\n\n//=============================================================================\nexports.default = {\n    ListPanel: ListPanel,\n    ModelListPanel: ModelListPanel\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2xpc3QvbGlzdC12aWV3LmpzP2QzOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExJU1RfSVRFTSBmcm9tIFwibXZjL2xpc3QvbGlzdC1pdGVtXCI7XG5pbXBvcnQgTG9hZGluZ0luZGljYXRvciBmcm9tIFwidWkvbG9hZGluZy1pbmRpY2F0b3JcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuaW1wb3J0IFwidWkvc2VhcmNoLWlucHV0XCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImxpc3RcIjtcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblRPRE86XG5cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbi8qKiBAY2xhc3MgVmlldyBmb3IgYSBsaXN0L2NvbGxlY3Rpb24gb2YgbW9kZWxzIGFuZCB0aGUgc3ViLXZpZXdzIG9mIHRob3NlIG1vZGVscy5cbiAqICAgICAgU3ViLXZpZXdzIG11c3QgKGF0IGxlYXN0IGhhdmUgdGhlIGludGVyZmFjZSBpZiBub3QpIGluaGVyaXQgZnJvbSBMaXN0SXRlbVZpZXcuXG4gKiAgICAgIChGb3IgYSBsaXN0IHBhbmVsIHRoYXQgYWxzbyBpbmNsdWRlcyBzb21lICdjb250YWluZXInIG1vZGVsIChIaXN0b3J5LT5IaXN0b3J5Q29udGVudHMpXG4gKiAgICAgIHVzZSBNb2RlbFdpdGhMaXN0UGFuZWwpXG4gKlxuICogIEFsbG93cyBmb3I6XG4gKiAgICAgIHNlYXJjaGluZyBjb2xsZWN0aW9uL3N1Yi12aWV3c1xuICogICAgICBzZWxlY3RpbmcvbXVsdGktc2VsZWN0aW5nIHN1Yi12aWV3c1xuICpcbiAqICBDdXJyZW50bHkgdXNlZDpcbiAqICAgICAgZm9yIGRhdGFzZXQvZGF0YXNldC1jaG9pY2VcbiAqICAgICAgYXMgc3VwZXJjbGFzcyBvZiBNb2RlbExpc3RQYW5lbFxuICovXG52YXIgTGlzdFBhbmVsID0gQmFja2JvbmUuVmlldy5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgTGlzdFBhbmVsLnByb3RvdHlwZSAqLyB7XG4gICAgICAgIF9sb2dOYW1lc3BhY2U6IGxvZ05hbWVzcGFjZSxcblxuICAgICAgICAvKiogY2xhc3MgdG8gdXNlIGZvciBjb25zdHJ1Y3RpbmcgdGhlIHN1Yi12aWV3cyAqL1xuICAgICAgICB2aWV3Q2xhc3M6IExJU1RfSVRFTS5MaXN0SXRlbVZpZXcsXG4gICAgICAgIC8qKiBjbGFzcyB0byB1c2VkIGZvciBjb25zdHJ1Y3RpbmcgY29sbGVjdGlvbiBvZiBzdWItdmlldyBtb2RlbHMgKi9cbiAgICAgICAgY29sbGVjdGlvbkNsYXNzOiBCYWNrYm9uZS5Db2xsZWN0aW9uLFxuXG4gICAgICAgIHRhZ05hbWU6IFwiZGl2XCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJsaXN0LXBhbmVsXCIsXG5cbiAgICAgICAgLyoqIChpbiBtcykgdGhhdCBqcXVlcnkgZWZmZWN0cyB3aWxsIHVzZSAqL1xuICAgICAgICBmeFNwZWVkOiBcImZhc3RcIixcblxuICAgICAgICAvKiogc3RyaW5nIHRvIGRpc3BsYXkgd2hlbiB0aGUgY29sbGVjdGlvbiBoYXMgbm8gY29udGVudHMgKi9cbiAgICAgICAgZW1wdHlNc2c6IF9sKFwiVGhpcyBsaXN0IGlzIGVtcHR5XCIpLFxuICAgICAgICAvKiogZGlzcGxheWVkIHdoZW4gbm8gaXRlbXMgbWF0Y2ggdGhlIHNlYXJjaCB0ZXJtcyAqL1xuICAgICAgICBub25lRm91bmRNc2c6IF9sKFwiTm8gbWF0Y2hpbmcgaXRlbXMgZm91bmRcIiksXG4gICAgICAgIC8qKiBzdHJpbmcgdXNlZCBmb3Igc2VhcmNoIHBsYWNlaG9sZGVyICovXG4gICAgICAgIHNlYXJjaFBsYWNlaG9sZGVyOiBfbChcInNlYXJjaFwiKSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFNFVCBVUFxuICAgICAgICAvKiogU2V0IHVwIHRoZSB2aWV3LCBzZXQgdXAgc3RvcmFnZSwgYmluZCBsaXN0ZW5lcnMgdG8gSGlzdG9yeUNvbnRlbnRzIGV2ZW50c1xuICAgICAgICAgKiAgQHBhcmFtIHtPYmplY3R9IGF0dHJpYnV0ZXMgb3B0aW9uYWwgc2V0dGluZ3MgZm9yIHRoZSBsaXN0XG4gICAgICAgICAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzID0gYXR0cmlidXRlcyB8fCB7fTtcbiAgICAgICAgICAgIC8vIHNldCB0aGUgbG9nZ2VyIGlmIHJlcXVlc3RlZFxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMubG9nZ2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIgPSBhdHRyaWJ1dGVzLmxvZ2dlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubG9nKGAke3RoaXN9LmluaXRpYWxpemU6YCwgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgICAgIC8vIC0tLS0gaW5zdGFuY2UgdmFyc1xuICAgICAgICAgICAgLyoqIGhvdyBxdWlja2x5IHNob3VsZCBqcXVlcnkgZnggcnVuPyAqL1xuICAgICAgICAgICAgdGhpcy5meFNwZWVkID0gXy5oYXMoYXR0cmlidXRlcywgXCJmeFNwZWVkXCIpID8gYXR0cmlidXRlcy5meFNwZWVkIDogdGhpcy5meFNwZWVkO1xuXG4gICAgICAgICAgICAvKiogZmlsdGVycyBmb3IgZGlzcGxheWluZyBzdWJ2aWV3cyAqL1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJzID0gW107XG4gICAgICAgICAgICAvKiogY3VycmVudCBzZWFyY2ggdGVybXMgKi9cbiAgICAgICAgICAgIHRoaXMuc2VhcmNoRm9yID0gYXR0cmlidXRlcy5zZWFyY2hGb3IgfHwgXCJcIjtcblxuICAgICAgICAgICAgLyoqIGxvYWRpbmcgaW5kaWNhdG9yICovXG4gICAgICAgICAgICAvLyB0aGlzLmluZGljYXRvciA9IG5ldyBMb2FkaW5nSW5kaWNhdG9yKCB0aGlzLiRlbCApO1xuXG4gICAgICAgICAgICAvKiogY3VycmVudGx5IHNob3dpbmcgc2VsZWN0b3JzIG9uIGl0ZW1zPyAqL1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RpbmcgPSBhdHRyaWJ1dGVzLnNlbGVjdGluZyAhPT0gdW5kZWZpbmVkID8gYXR0cmlidXRlcy5zZWxlY3RpbmcgOiB0cnVlO1xuICAgICAgICAgICAgLy90aGlzLnNlbGVjdGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvKiogY2FjaGVkIHNlbGVjdGVkIGl0ZW0ubW9kZWwuaWRzIHRvIHBlcnNpc3QgYnR3biByZW5kZXJzICovXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gYXR0cmlidXRlcy5zZWxlY3RlZCB8fCBbXTtcbiAgICAgICAgICAgIC8qKiB0aGUgbGFzdCBzZWxlY3RlZCBpdGVtLm1vZGVsLmlkICovXG4gICAgICAgICAgICB0aGlzLmxhc3RTZWxlY3RlZCA9IG51bGw7XG5cbiAgICAgICAgICAgIC8qKiBhcmUgc3ViLXZpZXdzIGRyYWdnYWJsZSAqL1xuICAgICAgICAgICAgdGhpcy5kcmFnSXRlbXMgPSBhdHRyaWJ1dGVzLmRyYWdJdGVtcyB8fCBmYWxzZTtcblxuICAgICAgICAgICAgLyoqIGxpc3QgaXRlbSB2aWV3IGNsYXNzICh3aGVuIHBhc3NlZCBtb2RlbHMpICovXG4gICAgICAgICAgICB0aGlzLnZpZXdDbGFzcyA9IGF0dHJpYnV0ZXMudmlld0NsYXNzIHx8IHRoaXMudmlld0NsYXNzO1xuXG4gICAgICAgICAgICAvKiogbGlzdCBpdGVtIHZpZXdzICovXG4gICAgICAgICAgICB0aGlzLnZpZXdzID0gW107XG4gICAgICAgICAgICAvKiogbGlzdCBpdGVtIG1vZGVscyAqL1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gYXR0cmlidXRlcy5jb2xsZWN0aW9uIHx8IHRoaXMuX2NyZWF0ZURlZmF1bHRDb2xsZWN0aW9uKCk7XG5cbiAgICAgICAgICAgIC8qKiBmaWx0ZXIgZm5zIHJ1biBvdmVyIGNvbGxlY3Rpb24gaXRlbXMgdG8gc2VlIGlmIHRoZXkgc2hvdWxkIHNob3cgaW4gdGhlIGxpc3QgKi9cbiAgICAgICAgICAgIHRoaXMuZmlsdGVycyA9IGF0dHJpYnV0ZXMuZmlsdGVycyB8fCBbXTtcblxuICAgICAgICAgICAgLyoqIG92ZXJyaWRlICRzY3JvbGxDb250YWluZXIgZm4gdmlhIGF0dHJpYnV0ZXMgLSBmbiBzaG91bGQgcmV0dXJuIGpxIGZvciBlbGVtIHRvIGNhbGwgc2Nyb2xsVG8gb24gKi9cbiAgICAgICAgICAgIHRoaXMuJHNjcm9sbENvbnRhaW5lciA9IGF0dHJpYnV0ZXMuJHNjcm9sbENvbnRhaW5lciB8fCB0aGlzLiRzY3JvbGxDb250YWluZXI7XG5cbiAgICAgICAgICAgIC8qKiBAdHlwZSB7U3RyaW5nfSBnZW5lcmljIHRpdGxlICovXG4gICAgICAgICAgICB0aGlzLnRpdGxlID0gYXR0cmlidXRlcy50aXRsZSB8fCBcIlwiO1xuICAgICAgICAgICAgLyoqIEB0eXBlIHtTdHJpbmd9IGdlbmVyaWMgc3VidGl0bGUgKi9cbiAgICAgICAgICAgIHRoaXMuc3VidGl0bGUgPSBhdHRyaWJ1dGVzLnN1YnRpdGxlIHx8IFwiXCI7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldFVwTGlzdGVuZXJzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGxpc3RlbmVyc1xuICAgICAgICAvKiogY3JlYXRlIGFueSBldmVudCBsaXN0ZW5lcnMgZm9yIHRoZSBsaXN0ICovXG4gICAgICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm9mZigpO1xuXG4gICAgICAgICAgICAvL1RPRE86IG1vdmUgZXJyb3JIYW5kbGVyIGRvd24gaW50byBsaXN0LXZpZXcgZnJvbSBoaXN0b3J5LXZpZXcgb3JcbiAgICAgICAgICAgIC8vICBwYXNzIHRvIGdsb2JhbCBlcnJvciBoYW5kbGVyIChHYWxheHkpXG4gICAgICAgICAgICB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHhociwgb3B0aW9ucywgbXNnLCBkZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5lcnJvckhhbmRsZXIoIG1vZGVsLCB4aHIsIG9wdGlvbnMsIG1zZywgZGV0YWlscyApO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKG1vZGVsLCB4aHIsIG9wdGlvbnMsIG1zZywgZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBzaG93IGhpZGUgdGhlIGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgbG9hZGluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dMb2FkaW5nSW5kaWNhdG9yKFwibG9hZGluZy4uLlwiLCA0MCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImxvYWRpbmctZG9uZVwiOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZUxvYWRpbmdJbmRpY2F0b3IoNDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyB0aHJvdyB0aGUgZmlyc3QgcmVuZGVyIHVwIGFzIGEgZGlmZiBuYW1lc3BhY2UgdXNpbmcgb25jZSAoZm9yIG91dHNpZGUgY29uc3VtcHRpb24pXG4gICAgICAgICAgICB0aGlzLm9uY2UoXCJyZW5kZXJlZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJyZW5kZXJlZDppbml0aWFsXCIsIHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldFVwQ29sbGVjdGlvbkxpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fc2V0VXBWaWV3TGlzdGVuZXJzKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY3JlYXRlIGFuZCByZXR1cm4gYSBjb2xsZWN0aW9uIGZvciB3aGVuIG5vbmUgaXMgaW5pdGlhbGx5IHBhc3NlZCAqL1xuICAgICAgICBfY3JlYXRlRGVmYXVsdENvbGxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGVcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5jb2xsZWN0aW9uQ2xhc3MoW10pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBsaXN0ZW5pbmcgZm9yIGNvbGxlY3Rpb24gZXZlbnRzICovXG4gICAgICAgIF9zZXRVcENvbGxlY3Rpb25MaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5sb2coYCR7dGhpc30uX3NldFVwQ29sbGVjdGlvbkxpc3RlbmVyc2AsIHRoaXMuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5jb2xsZWN0aW9uKTtcblxuICAgICAgICAgICAgLy8gYnViYmxlIHVwIGVycm9yIGV2ZW50c1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIHtcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHhociwgb3B0aW9ucywgbXNnLCBkZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImVycm9yXCIsIG1vZGVsLCB4aHIsIG9wdGlvbnMsIG1zZywgZGV0YWlscyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoYW5nZXMgPSBvcHRpb25zLmNoYW5nZXM7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUuaW5mbyggY29sbGVjdGlvbiArICcsIHVwZGF0ZTonLCBjaGFuZ2VzLCAnXFxub3B0aW9uczonLCBvcHRpb25zICk7XG4gICAgICAgICAgICAgICAgICAgIC8vIG1vcmUgdGhhbiBvbmU6IHJlbmRlciBldmVyeXRoaW5nXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnJlbmRlckFsbCB8fCBjaGFuZ2VzLmFkZGVkLmxlbmd0aCArIGNoYW5nZXMucmVtb3ZlZC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJJdGVtcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgbGV0IHRoZSBzaW5nbGUgYWRkL3JlbW92ZSBoYW5kbGVycyBkbyBpdFxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdlcy5hZGRlZC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZEl0ZW1WaWV3KF8uZmlyc3QoY2hhbmdlcy5hZGRlZCksIGNvbGxlY3Rpb24sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VzLnJlbW92ZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVJdGVtVmlldyhfLmZpcnN0KGNoYW5nZXMucmVtb3ZlZCksIGNvbGxlY3Rpb24sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogbGlzdGVuaW5nIGZvciBzdWItdmlldyBldmVudHMgdGhhdCBidWJibGUgdXAgd2l0aCB0aGUgJ3ZpZXc6JyBwcmVmaXggKi9cbiAgICAgICAgX3NldFVwVmlld0xpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmxvZyhgJHt0aGlzfS5fc2V0VXBWaWV3TGlzdGVuZXJzYCk7XG5cbiAgICAgICAgICAgIC8vIHNoaWZ0IHRvIHNlbGVjdCBhIHJhbmdlXG4gICAgICAgICAgICB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICBcInZpZXc6c2VsZWN0ZWRcIjogZnVuY3Rpb24odmlldywgZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ICYmIGV2LnNoaWZ0S2V5ICYmIHRoaXMubGFzdFNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdFNlbGVjdGVkVmlldyA9IHRoaXMudmlld0Zyb21Nb2RlbElkKHRoaXMubGFzdFNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0U2VsZWN0ZWRWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RSYW5nZSh2aWV3LCBsYXN0U2VsZWN0ZWRWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldiAmJiBldi5hbHRLZXkgJiYgIXRoaXMuc2VsZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkLnB1c2godmlldy5tb2RlbC5pZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFNlbGVjdGVkID0gdmlldy5tb2RlbC5pZDtcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgXCJ2aWV3OmRlLXNlbGVjdGVkXCI6IGZ1bmN0aW9uKHZpZXcsIGV2KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBfLndpdGhvdXQodGhpcy5zZWxlY3RlZCwgdmlldy5tb2RlbC5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHJlbmRlcmluZ1xuICAgICAgICAvKiogUmVuZGVyIHRoaXMgY29udGVudCwgc2V0IHVwIHVpLlxuICAgICAgICAgKiAgQHBhcmFtIHtOdW1iZXIgb3IgU3RyaW5nfSBzcGVlZCAgIHRoZSBzcGVlZCBvZiB0aGUgcmVuZGVyXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKHNwZWVkKSB7XG4gICAgICAgICAgICB0aGlzLmxvZyhgJHt0aGlzfS5yZW5kZXJgLCBzcGVlZCk7XG4gICAgICAgICAgICB2YXIgJG5ld1JlbmRlciA9IHRoaXMuX2J1aWxkTmV3UmVuZGVyKCk7XG4gICAgICAgICAgICB0aGlzLl9zZXRVcEJlaGF2aW9ycygkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgIHRoaXMuX3F1ZXVlTmV3UmVuZGVyKCRuZXdSZW5kZXIsIHNwZWVkKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBCdWlsZCBhIHRlbXAgZGl2IGNvbnRhaW5pbmcgdGhlIG5ldyBjaGlsZHJlbiBmb3IgdGhlIHZpZXcncyAkZWwuICovXG4gICAgICAgIF9idWlsZE5ld1JlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnKGAke3RoaXN9KExpc3RQYW5lbCkuX2J1aWxkTmV3UmVuZGVyYCk7XG4gICAgICAgICAgICB2YXIgJG5ld1JlbmRlciA9ICQodGhpcy50ZW1wbGF0ZXMuZWwoe30sIHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckNvbnRyb2xzKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyVGl0bGUoJG5ld1JlbmRlcik7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJTdWJ0aXRsZSgkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclNlYXJjaCgkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVySXRlbXMoJG5ld1JlbmRlcik7XG4gICAgICAgICAgICByZXR1cm4gJG5ld1JlbmRlcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQnVpbGQgYSB0ZW1wIGRpdiBjb250YWluaW5nIHRoZSBuZXcgY2hpbGRyZW4gZm9yIHRoZSB2aWV3J3MgJGVsLiAqL1xuICAgICAgICBfcmVuZGVyQ29udHJvbHM6IGZ1bmN0aW9uKCRuZXdSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoYCR7dGhpc30oTGlzdFBhbmVsKS5fcmVuZGVyQ29udHJvbHNgKTtcbiAgICAgICAgICAgIHZhciAkY29udHJvbHMgPSAkKHRoaXMudGVtcGxhdGVzLmNvbnRyb2xzKHt9LCB0aGlzKSk7XG4gICAgICAgICAgICAkbmV3UmVuZGVyLmZpbmQoXCIuY29udHJvbHNcIikucmVwbGFjZVdpdGgoJGNvbnRyb2xzKTtcbiAgICAgICAgICAgIHJldHVybiAkY29udHJvbHM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJldHVybiBhIGpRdWVyeSBvYmplY3QgY29udGFpbmluZyB0aGUgdGl0bGUgRE9NICovXG4gICAgICAgIF9yZW5kZXJUaXRsZTogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICAvLyR3aGVyZSA9ICR3aGVyZSB8fCB0aGlzLiRlbDtcbiAgICAgICAgICAgIC8vJHdoZXJlLmZpbmQoICcudGl0bGUnICkucmVwbGFjZVdpdGgoIC4uLiApXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJldHVybiBhIGpRdWVyeSBvYmplY3QgY29udGFpbmluZyB0aGUgc3VidGl0bGUgRE9NIChpZiBhbnkpICovXG4gICAgICAgIF9yZW5kZXJTdWJ0aXRsZTogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICAvLyR3aGVyZSA9ICR3aGVyZSB8fCB0aGlzLiRlbDtcbiAgICAgICAgICAgIC8vJHdoZXJlLmZpbmQoICcudGl0bGUnICkucmVwbGFjZVdpdGgoIC4uLiApXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEZhZGUgb3V0IHRoZSBvbGQgZWwsIHN3YXAgaW4gdGhlIG5ldyBjb250ZW50cywgdGhlbiBmYWRlIGluLlxuICAgICAgICAgKiAgQHBhcmFtIHtOdW1iZXIgb3IgU3RyaW5nfSBzcGVlZCAgIGpxIHNwZWVkIHRvIHVzZSBmb3IgcmVuZGVyaW5nIGVmZmVjdHNcbiAgICAgICAgICogIEBmaXJlcyByZW5kZXJlZCB3aGVuIHJlbmRlcmVkXG4gICAgICAgICAqL1xuICAgICAgICBfcXVldWVOZXdSZW5kZXI6IGZ1bmN0aW9uKCRuZXdSZW5kZXIsIHNwZWVkKSB7XG4gICAgICAgICAgICBzcGVlZCA9IHNwZWVkID09PSB1bmRlZmluZWQgPyB0aGlzLmZ4U3BlZWQgOiBzcGVlZDtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICBwYW5lbC5sb2coXCJfcXVldWVOZXdSZW5kZXI6XCIsICRuZXdSZW5kZXIsIHNwZWVkKTtcblxuICAgICAgICAgICAgJChwYW5lbCkucXVldWUoXCJmeFwiLCBbXG4gICAgICAgICAgICAgICAgbmV4dCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLiRlbC5mYWRlT3V0KHNwZWVkLCBuZXh0KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG5leHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwYW5lbC5fc3dhcE5ld1JlbmRlcigkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmV4dCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLiRlbC5mYWRlSW4oc3BlZWQsIG5leHQpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbmV4dCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLnRyaWdnZXIoXCJyZW5kZXJlZFwiLCBwYW5lbCk7XG4gICAgICAgICAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZW1wdHkgb3V0IHRoZSBjdXJyZW50IGVsLCBtb3ZlIHRoZSAkbmV3UmVuZGVyJ3MgY2hpbGRyZW4gaW4gKi9cbiAgICAgICAgX3N3YXBOZXdSZW5kZXI6IGZ1bmN0aW9uKCRuZXdSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuJGVsXG4gICAgICAgICAgICAgICAgLmVtcHR5KClcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIHRoaXMuY2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJG5ld1JlbmRlci5jaGlsZHJlbigpKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1NlbGVjdG9ycygwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTZXQgdXAgYW55IGJlaGF2aW9ycywgaGFuZGxlcnMgKGVwLiBwbHVnaW5zKSB0aGF0IG5lZWQgdG8gYmUgY2FsbGVkIHdoZW4gdGhlIGVudGlyZSB2aWV3IGhhcyBiZWVuIGJ1aWx0IGJ1dFxuICAgICAgICAgKiAgbm90IGF0dGFjaGVkIHRvIHRoZSBwYWdlIHlldC5cbiAgICAgICAgICovXG4gICAgICAgIF9zZXRVcEJlaGF2aW9yczogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICAkd2hlcmUgPSAkd2hlcmUgfHwgdGhpcy4kZWw7XG4gICAgICAgICAgICB0aGlzLiRjb250cm9scygkd2hlcmUpXG4gICAgICAgICAgICAgICAgLmZpbmQoXCJbdGl0bGVdXCIpXG4gICAgICAgICAgICAgICAgLnRvb2x0aXAoKTtcbiAgICAgICAgICAgIC8vIHNldCB1cCB0aGUgcHVwdXAgZm9yIGFjdGlvbnMgYXZhaWxhYmxlIHdoZW4gbXVsdGkgc2VsZWN0aW5nXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJNdWx0aXNlbGVjdEFjdGlvbk1lbnUoJHdoZXJlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgYSBtZW51IGNvbnRhaW5pbmcgdGhlIGFjdGlvbnMgYXZhaWxhYmxlIHRvIHNldHMgb2Ygc2VsZWN0ZWQgaXRlbXMgKi9cbiAgICAgICAgX3JlbmRlck11bHRpc2VsZWN0QWN0aW9uTWVudTogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICAkd2hlcmUgPSAkd2hlcmUgfHwgdGhpcy4kZWw7XG4gICAgICAgICAgICB2YXIgJG1lbnUgPSAkd2hlcmUuZmluZChcIi5saXN0LWFjdGlvbi1tZW51XCIpO1xuICAgICAgICAgICAgdmFyIGFjdGlvbnMgPSB0aGlzLm11bHRpc2VsZWN0QWN0aW9ucygpO1xuICAgICAgICAgICAgaWYgKCFhY3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkbWVudS5lbXB0eSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgJG5ld01lbnUgPSAkKFxuICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsaXN0LWFjdGlvbi1tZW51IGJ0bi1ncm91cFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwibGlzdC1hY3Rpb24tbWVudS1idG4gYnRuIGJ0bi1kZWZhdWx0IGRyb3Bkb3duLXRvZ2dsZVwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkZvciBhbGwgc2VsZWN0ZWRcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiLi4uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8dWwgY2xhc3M9XCJkcm9wZG93bi1tZW51IHB1bGwtcmlnaHRcIiByb2xlPVwibWVudVwiPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC91bD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHZhciAkYWN0aW9ucyA9IGFjdGlvbnMubWFwKGFjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGh0bWwgPSBbJzxsaT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsIGFjdGlvbi5odG1sLCBcIjwvYT48L2xpPlwiXS5qb2luKFwiXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiAkKGh0bWwpLmNsaWNrKGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbi5mdW5jKGV2KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJG5ld01lbnUuZmluZChcInVsXCIpLmFwcGVuZCgkYWN0aW9ucyk7XG4gICAgICAgICAgICAkbWVudS5yZXBsYWNlV2l0aCgkbmV3TWVudSk7XG4gICAgICAgICAgICByZXR1cm4gJG5ld01lbnU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJldHVybiBhIGxpc3Qgb2YgcGxhaW4gb2JqZWN0cyB1c2VkIHRvIHJlbmRlciBtdWx0aXNlbGVjdCBhY3Rpb25zIG1lbnUuIEVhY2ggb2JqZWN0IHNob3VsZCBoYXZlOlxuICAgICAgICAgKiAgICAgIGh0bWw6IGFuIGh0bWwgc3RyaW5nIHVzZWQgYXMgdGhlIGFuY2hvciBjb250ZW50c1xuICAgICAgICAgKiAgICAgIGZ1bmM6IGEgZnVuY3Rpb24gY2FsbGVkIHdoZW4gdGhlIGFuY2hvciBpcyBjbGlja2VkIChwYXNzZWQgdGhlIGNsaWNrIGV2ZW50KVxuICAgICAgICAgKi9cbiAgICAgICAgbXVsdGlzZWxlY3RBY3Rpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gc3ViLSRlbGVtZW50IHNob3J0Y3V0c1xuICAgICAgICAvKiogdGhlIHNjcm9sbCBjb250YWluZXIgZm9yIHRoaXMgcGFuZWwgLSBjYW4gYmUgJGVsLCAkZWwucGFyZW50KCksIG9yIGdyYW5kcGFyZW50IGRlcGVuZGluZyBvbiBjb250ZXh0ICovXG4gICAgICAgICRzY3JvbGxDb250YWluZXI6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgb3Igc2V0IHZpYSBhdHRyaWJ1dGVzLiRzY3JvbGxDb250YWluZXJcbiAgICAgICAgICAgIHJldHVybiAoJHdoZXJlIHx8IHRoaXMuJGVsKS5wYXJlbnQoKS5wYXJlbnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGNvbnZlbmllbmNlIHNlbGVjdG9yIGZvciB0aGUgc2VjdGlvbiB0aGF0IGRpc3BsYXlzIHRoZSBsaXN0IGNvbnRyb2xzICovXG4gICAgICAgICRjb250cm9sczogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICByZXR1cm4gKCR3aGVyZSB8fCB0aGlzLiRlbCkuZmluZChcIj4gLmNvbnRyb2xzXCIpO1xuICAgICAgICB9LFxuICAgICAgICAvKiogbGlzdC1pdGVtczogd2hlcmUgdGhlIHN1YnZpZXdzIGFyZSBjb250YWluZWQgaW4gdGhlIHZpZXcncyBkb20gKi9cbiAgICAgICAgJGxpc3Q6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgcmV0dXJuICgkd2hlcmUgfHwgdGhpcy4kZWwpLmZpbmQoXCI+IC5saXN0LWl0ZW1zXCIpO1xuICAgICAgICB9LFxuICAgICAgICAvKiogY29udGFpbmVyIHdoZXJlIGxpc3QgbWVzc2FnZXMgYXJlIGF0dGFjaGVkICovXG4gICAgICAgICRtZXNzYWdlczogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICAvL1RPRE86IGNvbnRyb2xzIGlzbid0IHJlYWxseSBjb3JyZWN0IGhlcmUgKG9ubHkgZm9yIE1vZGVsTGlzdFBhbmVsKVxuICAgICAgICAgICAgcmV0dXJuICgkd2hlcmUgfHwgdGhpcy4kZWwpLmZpbmQoXCI+IC5jb250cm9scyAubWVzc2FnZXNcIik7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiB0aGUgbWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiBubyB2aWV3cyBjYW4gYmUgc2hvd24gKG5vIHZpZXdzLCBub25lIG1hdGNoaW5nIHNlYXJjaCkgKi9cbiAgICAgICAgJGVtcHR5TWVzc2FnZTogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICByZXR1cm4gKCR3aGVyZSB8fCB0aGlzLiRlbCkuZmluZChcIj4gLmVtcHR5LW1lc3NhZ2VcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGhkYSBzdWItdmlld3NcbiAgICAgICAgLyoqIHJlbmRlciB0aGUgc3Vidmlld3MgZm9yIHRoZSBsaXN0J3MgY29sbGVjdGlvbiAqL1xuICAgICAgICByZW5kZXJJdGVtczogZnVuY3Rpb24oJHdoZXJlVG8pIHtcbiAgICAgICAgICAgICR3aGVyZVRvID0gJHdoZXJlVG8gfHwgdGhpcy4kZWw7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgcGFuZWwubG9nKGAke3RoaXN9LnJlbmRlckl0ZW1zYCwgJHdoZXJlVG8pO1xuXG4gICAgICAgICAgICB2YXIgJGxpc3QgPSBwYW5lbC4kbGlzdCgkd2hlcmVUbyk7XG4gICAgICAgICAgICBwYW5lbC5mcmVlVmlld3MoKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCAndmlld3MgZnJlZWQnICk7XG4gICAgICAgICAgICAvL1RPRE86PyBjYWNoZSBhbmQgcmUtdXNlIHZpZXdzP1xuICAgICAgICAgICAgdmFyIHNob3duTW9kZWxzID0gcGFuZWwuX2ZpbHRlckNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCAnbW9kZWxzIGZpbHRlcmVkOicsIHNob3duTW9kZWxzICk7XG5cbiAgICAgICAgICAgIHBhbmVsLnZpZXdzID0gc2hvd25Nb2RlbHMubWFwKGl0ZW1Nb2RlbCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBwYW5lbC5fY3JlYXRlSXRlbVZpZXcoaXRlbU1vZGVsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlldztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkbGlzdC5lbXB0eSgpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coICdsaXN0IGVtcHRpZWQnICk7XG4gICAgICAgICAgICBpZiAocGFuZWwudmlld3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcGFuZWwuX2F0dGFjaEl0ZW1zKCR3aGVyZVRvKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggJ2l0ZW1zIGF0dGFjaGVkJyApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFuZWwuX3JlbmRlckVtcHR5TWVzc2FnZSgkd2hlcmVUbykudG9nZ2xlKCFwYW5lbC52aWV3cy5sZW5ndGgpO1xuICAgICAgICAgICAgcGFuZWwudHJpZ2dlcihcInZpZXdzOnJlYWR5XCIsIHBhbmVsLnZpZXdzKTtcblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHJlbmRlcmluZyBpdGVtcycgKTtcbiAgICAgICAgICAgIHJldHVybiBwYW5lbC52aWV3cztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogRmlsdGVyIHRoZSBjb2xsZWN0aW9uIHRvIG9ubHkgdGhvc2UgbW9kZWxzIHRoYXQgc2hvdWxkIGJlIGN1cnJlbnRseSB2aWV3ZWQgKi9cbiAgICAgICAgX2ZpbHRlckNvbGxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgdGhpc1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBwYW5lbC5jb2xsZWN0aW9uLmZpbHRlcihfLmJpbmQocGFuZWwuX2ZpbHRlckl0ZW0sIHBhbmVsKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFNob3VsZCB0aGUgbW9kZWwgYmUgdmlld2FibGUgaW4gdGhlIGN1cnJlbnQgc3RhdGU/XG4gICAgICAgICAqICAgICBDaGVja3MgYWdhaW5zdCB0aGlzLmZpbHRlcnMgYW5kIHRoaXMuc2VhcmNoRm9yXG4gICAgICAgICAqL1xuICAgICAgICBfZmlsdGVySXRlbTogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIHRoaXNcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIF8uZXZlcnkocGFuZWwuZmlsdGVycy5tYXAoZm4gPT4gZm4uY2FsbChtb2RlbCkpKSAmJlxuICAgICAgICAgICAgICAgICghcGFuZWwuc2VhcmNoRm9yIHx8IG1vZGVsLm1hdGNoZXNBbGwocGFuZWwuc2VhcmNoRm9yKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIENyZWF0ZSBhIHZpZXcgZm9yIGEgbW9kZWwgYW5kIHNldCB1cCBpdCdzIGxpc3RlbmVycyAqL1xuICAgICAgICBfY3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgVmlld0NsYXNzID0gdGhpcy5fZ2V0SXRlbVZpZXdDbGFzcyhtb2RlbCk7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF8uZXh0ZW5kKHRoaXMuX2dldEl0ZW1WaWV3T3B0aW9ucyhtb2RlbCksIHtcbiAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBuZXcgVmlld0NsYXNzKG9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5fc2V0VXBJdGVtVmlld0xpc3RlbmVycyh2aWV3KTtcbiAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBGcmVlIGEgdmlldyBmb3IgYSBtb2RlbC4gTm90ZTogZG9lcyBub3QgcmVtb3ZlIGl0IGZyb20gdGhlIERPTSAqL1xuICAgICAgICBfZGVzdHJveUl0ZW1WaWV3OiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodmlldyk7XG4gICAgICAgICAgICB0aGlzLnZpZXdzID0gXy53aXRob3V0KHRoaXMudmlld3MsIHZpZXcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9kZXN0cm95SXRlbVZpZXdzOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBzZWxmLnZpZXdzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5zdG9wTGlzdGVuaW5nKHYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLnZpZXdzID0gW107XG4gICAgICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZnJlZSBhbnkgc3ViLXZpZXdzIHRoZSBsaXN0IGhhcyAqL1xuICAgICAgICBmcmVlVmlld3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Rlc3Ryb3lJdGVtVmlld3MoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogR2V0IHRoZSBiYm9uZSB2aWV3IGNsYXNzIGJhc2VkIG9uIHRoZSBtb2RlbCAqL1xuICAgICAgICBfZ2V0SXRlbVZpZXdDbGFzczogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIHRoaXNcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXdDbGFzcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogR2V0IHRoZSBvcHRpb25zIHBhc3NlZCB0byB0aGUgbmV3IHZpZXcgYmFzZWQgb24gdGhlIG1vZGVsICovXG4gICAgICAgIF9nZXRJdGVtVmlld09wdGlvbnM6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAvLyBvdmVycmlkZSB0aGlzXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIC8vbG9nZ2VyICAgICAgOiB0aGlzLmxvZ2dlcixcbiAgICAgICAgICAgICAgICBmeFNwZWVkOiB0aGlzLmZ4U3BlZWQsXG4gICAgICAgICAgICAgICAgZXhwYW5kZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHNlbGVjdGFibGU6IHRoaXMuc2VsZWN0aW5nLFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBfLmNvbnRhaW5zKHRoaXMuc2VsZWN0ZWQsIG1vZGVsLmlkKSxcbiAgICAgICAgICAgICAgICBkcmFnZ2FibGU6IHRoaXMuZHJhZ0l0ZW1zXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTZXQgdXAgbGlzdGVuZXJzIGZvciBuZXcgbW9kZWxzICovXG4gICAgICAgIF9zZXRVcEl0ZW1WaWV3TGlzdGVuZXJzOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgLy8gc2VuZCBhbGwgZXZlbnRzIHRvIHRoZSBwYW5lbCwgcmUtbmFtc3BhY2VpbmcgdGhlbSB3aXRoIHRoZSB2aWV3IHByZWZpeFxuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh2aWV3LCBcImFsbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG4gICAgICAgICAgICAgICAgYXJnc1swXSA9IGB2aWV3OiR7YXJnc1swXX1gO1xuICAgICAgICAgICAgICAgIHBhbmVsLnRyaWdnZXIuYXBwbHkocGFuZWwsIGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGRyYWcgbXVsdGlwbGUgLSBoaWphY2sgZXYuc2V0RGF0YSB0byBhZGQgYWxsIHNlbGVjdGVkIGl0ZW1zXG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvKFxuICAgICAgICAgICAgICAgIHZpZXcsXG4gICAgICAgICAgICAgICAgXCJkcmFnZ2FibGU6ZHJhZ3N0YXJ0XCIsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oZXYsIHYpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9UT0RPOiBzZXQgbXVsdGlwbGUgZHJhZyBkYXRhIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpzb24gPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzLmdldFNlbGVjdGVkTW9kZWxzKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBzZWxlY3RlZC50b0pTT04oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBbdi5tb2RlbC50b0pTT04oKV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZXYuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJ0ZXh0XCIsIEpTT04uc3RyaW5naWZ5KGpzb24pKTtcbiAgICAgICAgICAgICAgICAgICAgLy9ldi5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlKCB2LmVsLCA2MCwgNjAgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybiBwYW5lbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQXR0YWNoIHZpZXdzIGluIHRoaXMudmlld3MgdG8gdGhlIG1vZGVsIGJhc2VkIG9uICR3aGVyZVRvICovXG4gICAgICAgIF9hdHRhY2hJdGVtczogZnVuY3Rpb24oJHdoZXJlVG8pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCAnX2F0dGFjaEl0ZW1zOicsICR3aGVyZVRvLCB0aGlzLiRsaXN0KCAkd2hlcmVUbyApICk7XG4gICAgICAgICAgICAvL0FTU1VNRVM6ICRsaXN0IGhhcyBiZWVuIGVtcHRpZWRcbiAgICAgICAgICAgIHRoaXMuJGxpc3QoJHdoZXJlVG8pLmFwcGVuZCh0aGlzLnZpZXdzLm1hcCh2aWV3ID0+IHNlbGYuX3JlbmRlckl0ZW1WaWV3JGVsKHZpZXcpKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZ2V0IGEgZ2l2ZW4gc3VidmlldydzICRlbCAob3Igd2hhdGV2ZXIgbWF5IHdyYXAgaXQpIGFuZCByZXR1cm4gaXQgKi9cbiAgICAgICAgX3JlbmRlckl0ZW1WaWV3JGVsOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICAvLyB1c2VmdWwgdG8gd3JhcCBhbmQgb3ZlcnJpZGVcbiAgICAgICAgICAgIHJldHVybiB2aWV3LnJlbmRlcigwKS4kZWw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciB0aGUgZW1wdHkvbm9uZS1mb3VuZCBtZXNzYWdlICovXG4gICAgICAgIF9yZW5kZXJFbXB0eU1lc3NhZ2U6IGZ1bmN0aW9uKCR3aGVyZVRvKSB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnKFwiX3JlbmRlckVtcHR5TWVzc2FnZVwiLCAkd2hlcmVUbywgdGhpcy5zZWFyY2hGb3IpO1xuICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLnNlYXJjaEZvciA/IHRoaXMubm9uZUZvdW5kTXNnIDogdGhpcy5lbXB0eU1zZztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRlbXB0eU1lc3NhZ2UoJHdoZXJlVG8pLnRleHQodGV4dCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGV4cGFuZCBhbGwgaXRlbSB2aWV3cyAqL1xuICAgICAgICBleHBhbmRBbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXy5lYWNoKHRoaXMudmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXcuZXhwYW5kKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY29sbGFwc2UgYWxsIGl0ZW0gdmlld3MgKi9cbiAgICAgICAgY29sbGFwc2VBbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXy5lYWNoKHRoaXMudmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXcuY29sbGFwc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBjb2xsZWN0aW9uL3ZpZXdzIHN5bmNpbmdcbiAgICAgICAgLyoqIEFkZCBhIHZpZXcgKGlmIHRoZSBtb2RlbCBzaG91bGQgYmUgdmlld2FibGUpIHRvIHRoZSBwYW5lbCAqL1xuICAgICAgICBhZGRJdGVtVmlldzogZnVuY3Rpb24obW9kZWwsIGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCB0aGlzICsgJy5hZGRJdGVtVmlldzonLCBtb2RlbCApO1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIC8vIGdldCB0aGUgaW5kZXggb2YgdGhlIG1vZGVsIGluIHRoZSBsaXN0IG9mIGZpbHRlcmVkIG1vZGVscyBzaG93biBieSB0aGlzIGxpc3RcbiAgICAgICAgICAgIC8vIGluIG9yZGVyIHRvIGluc2VydCB0aGUgdmlldyBpbiB0aGUgcHJvcGVyIHBsYWNlXG4gICAgICAgICAgICAvL1RPRE86PyBwb3RlbnRpYWxseSBleHBlbnNpdmVcbiAgICAgICAgICAgIHZhciBtb2RlbEluZGV4ID0gcGFuZWwuX2ZpbHRlckNvbGxlY3Rpb24oKS5pbmRleE9mKG1vZGVsKTtcbiAgICAgICAgICAgIGlmIChtb2RlbEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmlldyA9IHBhbmVsLl9jcmVhdGVJdGVtVmlldyhtb2RlbCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggJ2FkZGluZyBhbmQgcmVuZGVyaW5nOicsIG1vZGVsSW5kZXgsIHZpZXcudG9TdHJpbmcoKSApO1xuXG4gICAgICAgICAgICAkKHZpZXcpLnF1ZXVlKFwiZnhcIiwgW1xuICAgICAgICAgICAgICAgIG5leHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBoaWRlIHRoZSBlbXB0eSBtZXNzYWdlIGZpcnN0IGlmIG9ubHkgdmlld1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFuZWwuJGVtcHR5TWVzc2FnZSgpLmlzKFwiOnZpc2libGVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLiRlbXB0eU1lc3NhZ2UoKS5mYWRlT3V0KHBhbmVsLmZ4U3BlZWQsIG5leHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwuX2F0dGFjaFZpZXcodmlldywgbW9kZWxJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIG5leHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBpbnRlcm5hbCBmbiB0byBhZGQgdmlldyAodG8gYm90aCBwYW5lbC52aWV3cyBhbmQgcGFuZWwuJGxpc3QpICovXG4gICAgICAgIF9hdHRhY2hWaWV3OiBmdW5jdGlvbih2aWV3LCBtb2RlbEluZGV4LCB1c2VGeCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHRoaXMgKyAnLl9hdHRhY2hWaWV3OicsIHZpZXcsIG1vZGVsSW5kZXgsIHVzZUZ4ICk7XG4gICAgICAgICAgICB1c2VGeCA9IF8uaXNVbmRlZmluZWQodXNlRngpID8gdHJ1ZSA6IHVzZUZ4O1xuICAgICAgICAgICAgbW9kZWxJbmRleCA9IG1vZGVsSW5kZXggfHwgMDtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHVzZSB0aGUgbW9kZWxJbmRleCB0byBzcGxpY2UgaW50byB2aWV3cyBhbmQgaW5zZXJ0IGF0IHRoZSBwcm9wZXIgaW5kZXggaW4gdGhlIERPTVxuICAgICAgICAgICAgcGFuZWwudmlld3Muc3BsaWNlKG1vZGVsSW5kZXgsIDAsIHZpZXcpO1xuICAgICAgICAgICAgcGFuZWwuX2luc2VydEludG9MaXN0QXQobW9kZWxJbmRleCwgcGFuZWwuX3JlbmRlckl0ZW1WaWV3JGVsKHZpZXcpLmhpZGUoKSk7XG5cbiAgICAgICAgICAgIHBhbmVsLnRyaWdnZXIoXCJ2aWV3OmF0dGFjaGVkXCIsIHZpZXcpO1xuICAgICAgICAgICAgaWYgKHVzZUZ4KSB7XG4gICAgICAgICAgICAgICAgdmlldy4kZWwuc2xpZGVEb3duKHBhbmVsLmZ4U3BlZWQsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwudHJpZ2dlcihcInZpZXc6YXR0YWNoZWQ6cmVuZGVyZWRcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZpZXcuJGVsLnNob3coKTtcbiAgICAgICAgICAgICAgICBwYW5lbC50cmlnZ2VyKFwidmlldzphdHRhY2hlZDpyZW5kZXJlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBpbnNlcnQgYSBqcSBvYmplY3QgYXMgYSBjaGlsZCBvZiBsaXN0LWl0ZW1zIGF0IHRoZSBzcGVjaWZpZWQgKkRPTSBpbmRleCogKi9cbiAgICAgICAgX2luc2VydEludG9MaXN0QXQ6IGZ1bmN0aW9uKGluZGV4LCAkd2hhdCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHRoaXMgKyAnLl9pbnNlcnRJbnRvTGlzdEF0OicsIGluZGV4LCAkd2hhdCApO1xuICAgICAgICAgICAgdmFyICRsaXN0ID0gdGhpcy4kbGlzdCgpO1xuICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgJGxpc3QucHJlcGVuZCgkd2hhdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRsaXN0XG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZHJlbigpXG4gICAgICAgICAgICAgICAgICAgIC5lcShpbmRleCAtIDEpXG4gICAgICAgICAgICAgICAgICAgIC5hZnRlcigkd2hhdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJHdoYXQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbW92ZSBhIHZpZXcgZnJvbSB0aGUgcGFuZWwgKGlmIGZvdW5kKSAqL1xuICAgICAgICByZW1vdmVJdGVtVmlldzogZnVuY3Rpb24obW9kZWwsIGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdmlldyA9IF8uZmluZChwYW5lbC52aWV3cywgdiA9PiB2Lm1vZGVsID09PSBtb2RlbCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFuZWwudmlld3MgPSBfLndpdGhvdXQocGFuZWwudmlld3MsIHZpZXcpO1xuICAgICAgICAgICAgcGFuZWwudHJpZ2dlcihcInZpZXc6cmVtb3ZlZFwiLCB2aWV3KTtcblxuICAgICAgICAgICAgLy8gcG90ZW50aWFsbHkgc2hvdyB0aGUgZW1wdHkgbWVzc2FnZSBpZiBubyB2aWV3cyBsZWZ0XG4gICAgICAgICAgICAvLyB1c2UgYW5vbnltb3VzIHF1ZXVlIGhlcmUgLSBzaW5jZSByZW1vdmUgY2FuIGhhcHBlbiBtdWx0aXBsZSB0aW1lc1xuICAgICAgICAgICAgJCh7fSkucXVldWUoXCJmeFwiLCBbXG4gICAgICAgICAgICAgICAgbmV4dCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuJGVsLmZhZGVPdXQocGFuZWwuZnhTcGVlZCwgbmV4dCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBuZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwudHJpZ2dlcihcInZpZXc6cmVtb3ZlZDpyZW5kZXJlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYW5lbC52aWV3cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLl9yZW5kZXJFbXB0eU1lc3NhZ2UoKS5mYWRlSW4ocGFuZWwuZnhTcGVlZCwgbmV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBnZXQgdmlld3MgYmFzZWQgb24gbW9kZWwuaWQgKi9cbiAgICAgICAgdmlld0Zyb21Nb2RlbElkOiBmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgcmV0dXJuIF8uZmluZCh0aGlzLnZpZXdzLCB2ID0+IHYubW9kZWwuaWQgPT09IGlkKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZ2V0IHZpZXdzIGJhc2VkIG9uIG1vZGVsICovXG4gICAgICAgIHZpZXdGcm9tTW9kZWw6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWwgPyB0aGlzLnZpZXdGcm9tTW9kZWxJZChtb2RlbC5pZCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGdldCB2aWV3cyBiYXNlZCBvbiBtb2RlbCBwcm9wZXJ0aWVzICovXG4gICAgICAgIHZpZXdzV2hlcmVNb2RlbDogZnVuY3Rpb24ocHJvcGVydGllcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlld3MuZmlsdGVyKHZpZXcgPT4gXy5pc01hdGNoKHZpZXcubW9kZWwuYXR0cmlidXRlcywgcHJvcGVydGllcykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBBIHJhbmdlIG9mIHZpZXdzIGJldHdlZW4gKGFuZCBpbmNsdWRpbmcpIHZpZXdBIGFuZCB2aWV3QiAqL1xuICAgICAgICB2aWV3UmFuZ2U6IGZ1bmN0aW9uKHZpZXdBLCB2aWV3Qikge1xuICAgICAgICAgICAgaWYgKHZpZXdBID09PSB2aWV3Qikge1xuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3QSA/IFt2aWV3QV0gOiBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluZGV4QSA9IHRoaXMudmlld3MuaW5kZXhPZih2aWV3QSk7XG4gICAgICAgICAgICB2YXIgaW5kZXhCID0gdGhpcy52aWV3cy5pbmRleE9mKHZpZXdCKTtcblxuICAgICAgICAgICAgLy8gaGFuZGxlIG5vdCBmb3VuZFxuICAgICAgICAgICAgaWYgKGluZGV4QSA9PT0gLTEgfHwgaW5kZXhCID09PSAtMSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmRleEEgPT09IGluZGV4Qikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleEEgPT09IC0xID8gW3ZpZXdCXSA6IFt2aWV3QV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyByZXZlcnNlIGlmIGluZGVjZXMgYXJlXG4gICAgICAgICAgICAvL25vdGU6IGVuZCBpbmNsdXNpdmVcbiAgICAgICAgICAgIHJldHVybiBpbmRleEEgPCBpbmRleEIgPyB0aGlzLnZpZXdzLnNsaWNlKGluZGV4QSwgaW5kZXhCICsgMSkgOiB0aGlzLnZpZXdzLnNsaWNlKGluZGV4QiwgaW5kZXhBICsgMSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHNlYXJjaGluZ1xuICAgICAgICAvKiogcmVuZGVyIGEgc2VhcmNoIGlucHV0IGZvciBmaWx0ZXJpbmcgZGF0YXNldHMgc2hvd25cbiAgICAgICAgICogICAgICAoc2VlIFNlYXJjaGFibGVNaXhpbiBpbiBiYXNlLW12YyBmb3IgaW1wbGVtZW50YXRpb24gb2YgdGhlIGFjdHVhbCBzZWFyY2hpbmcpXG4gICAgICAgICAqICAgICAgcmV0dXJuIHdpbGwgc3RhcnQgdGhlIHNlYXJjaFxuICAgICAgICAgKiAgICAgIGVzYyB3aWxsIGNsZWFyIHRoZSBzZWFyY2hcbiAgICAgICAgICogICAgICBjbGlja2luZyB0aGUgY2xlYXIgYnV0dG9uIHdpbGwgY2xlYXIgdGhlIHNlYXJjaFxuICAgICAgICAgKiAgICAgIHVzZXMgc2VhcmNoSW5wdXQgaW4gdWkuanNcbiAgICAgICAgICovXG4gICAgICAgIF9yZW5kZXJTZWFyY2g6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgJHdoZXJlLmZpbmQoXCIuY29udHJvbHMgLnNlYXJjaC1pbnB1dFwiKS5zZWFyY2hJbnB1dCh7XG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHRoaXMuc2VhcmNoUGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAgICAgaW5pdGlhbFZhbDogdGhpcy5zZWFyY2hGb3IsXG4gICAgICAgICAgICAgICAgb25maXJzdHNlYXJjaDogXy5iaW5kKHRoaXMuX2ZpcnN0U2VhcmNoLCB0aGlzKSxcbiAgICAgICAgICAgICAgICBvbnNlYXJjaDogXy5iaW5kKHRoaXMuc2VhcmNoSXRlbXMsIHRoaXMpLFxuICAgICAgICAgICAgICAgIG9uY2xlYXI6IF8uYmluZCh0aGlzLmNsZWFyU2VhcmNoLCB0aGlzKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gJHdoZXJlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBXaGF0IHRvIGRvIG9uIHRoZSBmaXJzdCBzZWFyY2ggZW50ZXJlZCAqL1xuICAgICAgICBfZmlyc3RTZWFyY2g6IGZ1bmN0aW9uKHNlYXJjaEZvcikge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgdG8gbG9hZCBtb2RlbCBkZXRhaWxzIGlmIG5lY2MuXG4gICAgICAgICAgICB0aGlzLmxvZyhcIm9uRmlyc3RTZWFyY2hcIiwgc2VhcmNoRm9yKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlYXJjaEl0ZW1zKHNlYXJjaEZvcik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGZpbHRlciB2aWV3IGxpc3QgdG8gdGhvc2UgdGhhdCBjb250YWluIHRoZSBzZWFyY2hGb3IgdGVybXMgKi9cbiAgICAgICAgc2VhcmNoSXRlbXM6IGZ1bmN0aW9uKHNlYXJjaEZvciwgZm9yY2UpIHtcbiAgICAgICAgICAgIHRoaXMubG9nKFwic2VhcmNoSXRlbXNcIiwgc2VhcmNoRm9yLCB0aGlzLnNlYXJjaEZvciwgZm9yY2UpO1xuICAgICAgICAgICAgaWYgKCFmb3JjZSAmJiB0aGlzLnNlYXJjaEZvciA9PT0gc2VhcmNoRm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEZvciA9IHNlYXJjaEZvcjtcbiAgICAgICAgICAgIHRoaXMucmVuZGVySXRlbXMoKTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInNlYXJjaDpzZWFyY2hpbmdcIiwgc2VhcmNoRm9yLCB0aGlzKTtcbiAgICAgICAgICAgIHZhciAkc2VhcmNoID0gdGhpcy4kKFwiPiAuY29udHJvbHMgLnNlYXJjaC1xdWVyeVwiKTtcbiAgICAgICAgICAgIGlmICgkc2VhcmNoLnZhbCgpICE9PSBzZWFyY2hGb3IpIHtcbiAgICAgICAgICAgICAgICAkc2VhcmNoLnZhbChzZWFyY2hGb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGNsZWFyIHRoZSBzZWFyY2ggZmlsdGVycyBhbmQgc2hvdyBhbGwgdmlld3MgdGhhdCBhcmUgbm9ybWFsbHkgc2hvd24gKi9cbiAgICAgICAgY2xlYXJTZWFyY2g6IGZ1bmN0aW9uKHNlYXJjaEZvcikge1xuICAgICAgICAgICAgLy90aGlzLmxvZyggJ29uU2VhcmNoQ2xlYXInLCB0aGlzICk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEZvciA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJzZWFyY2g6Y2xlYXJcIiwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLiQoXCI+IC5jb250cm9scyAuc2VhcmNoLXF1ZXJ5XCIpLnZhbChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVySXRlbXMoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzZWxlY3Rpb25cbiAgICAgICAgLyoqIEB0eXBlIEludGVnZXIgd2hlbiB0aGUgbnVtYmVyIG9mIGxpc3QgaXRlbSB2aWV3cyBpcyA+PSB0byB0aGlzLCBkb24ndCBhbmltYXRlIHNlbGVjdG9ycyAqL1xuICAgICAgICBUSFJPVFRMRV9TRUxFQ1RPUl9GWF9BVDogMjAsXG5cbiAgICAgICAgLyoqIHNob3cgc2VsZWN0b3JzIG9uIGFsbCB2aXNpYmxlIGl0ZW1WaWV3cyBhbmQgYXNzb2NpYXRlZCBjb250cm9scyAqL1xuICAgICAgICBzaG93U2VsZWN0b3JzOiBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICAgICAgc3BlZWQgPSBzcGVlZCAhPT0gdW5kZWZpbmVkID8gc3BlZWQgOiB0aGlzLmZ4U3BlZWQ7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLiQoXCIubGlzdC1hY3Rpb25zXCIpLnNsaWRlRG93bihzcGVlZCk7XG4gICAgICAgICAgICBzcGVlZCA9IHRoaXMudmlld3MubGVuZ3RoID49IHRoaXMuVEhST1RUTEVfU0VMRUNUT1JfRlhfQVQgPyAwIDogc3BlZWQ7XG4gICAgICAgICAgICBfLmVhY2godGhpcy52aWV3cywgdmlldyA9PiB7XG4gICAgICAgICAgICAgICAgdmlldy5zaG93U2VsZWN0b3Ioc3BlZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL3RoaXMuc2VsZWN0ZWQgPSBbXTtcbiAgICAgICAgICAgIC8vdGhpcy5sYXN0U2VsZWN0ZWQgPSBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBoaWRlIHNlbGVjdG9ycyBvbiBhbGwgdmlzaWJsZSBpdGVtVmlld3MgYW5kIGFzc29jaWF0ZWQgY29udHJvbHMgKi9cbiAgICAgICAgaGlkZVNlbGVjdG9yczogZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgICAgIHNwZWVkID0gc3BlZWQgIT09IHVuZGVmaW5lZCA/IHNwZWVkIDogdGhpcy5meFNwZWVkO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5saXN0LWFjdGlvbnNcIikuc2xpZGVVcChzcGVlZCk7XG4gICAgICAgICAgICBzcGVlZCA9IHRoaXMudmlld3MubGVuZ3RoID49IHRoaXMuVEhST1RUTEVfU0VMRUNUT1JfRlhfQVQgPyAwIDogc3BlZWQ7XG4gICAgICAgICAgICBfLmVhY2godGhpcy52aWV3cywgdmlldyA9PiB7XG4gICAgICAgICAgICAgICAgdmlldy5oaWRlU2VsZWN0b3Ioc3BlZWQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkID0gW107XG4gICAgICAgICAgICB0aGlzLmxhc3RTZWxlY3RlZCA9IG51bGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNob3cgb3IgaGlkZSBzZWxlY3RvcnMgb24gYWxsIHZpc2libGUgaXRlbVZpZXdzIGFuZCBhc3NvY2lhdGVkIGNvbnRyb2xzICovXG4gICAgICAgIHRvZ2dsZVNlbGVjdG9yczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc2VsZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93U2VsZWN0b3JzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVNlbGVjdG9ycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBzZWxlY3QgYWxsIHZpc2libGUgaXRlbXMgKi9cbiAgICAgICAgc2VsZWN0QWxsOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgXy5lYWNoKHRoaXMudmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIHZpZXcuc2VsZWN0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBkZXNlbGVjdCBhbGwgdmlzaWJsZSBpdGVtcyAqL1xuICAgICAgICBkZXNlbGVjdEFsbDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMubGFzdFNlbGVjdGVkID0gbnVsbDtcbiAgICAgICAgICAgIF8uZWFjaCh0aGlzLnZpZXdzLCB2aWV3ID0+IHtcbiAgICAgICAgICAgICAgICB2aWV3LmRlc2VsZWN0KGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBzZWxlY3QgYSByYW5nZSBvZiBkYXRhc2V0cyBiZXR3ZWVuIEEgYW5kIEIgKi9cbiAgICAgICAgc2VsZWN0UmFuZ2U6IGZ1bmN0aW9uKHZpZXdBLCB2aWV3Qikge1xuICAgICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy52aWV3UmFuZ2Uodmlld0EsIHZpZXdCKTtcbiAgICAgICAgICAgIF8uZWFjaChyYW5nZSwgdmlldyA9PiB7XG4gICAgICAgICAgICAgICAgdmlldy5zZWxlY3QoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJhbmdlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZXR1cm4gYW4gYXJyYXkgb2YgYWxsIGN1cnJlbnRseSBzZWxlY3RlZCBpdGVtVmlld3MgKi9cbiAgICAgICAgZ2V0U2VsZWN0ZWRWaWV3czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gXy5maWx0ZXIodGhpcy52aWV3cywgdiA9PiB2LnNlbGVjdGVkKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmV0dXJuIGEgY29sbGVjdGlvbiBvZiB0aGUgbW9kZWxzIG9mIGFsbCBjdXJyZW5seSBzZWxlY3RlZCBpdGVtcyAqL1xuICAgICAgICBnZXRTZWxlY3RlZE1vZGVsczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggJyhnZXRTZWxlY3RlZE1vZGVscyknICk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuY29sbGVjdGlvbi5jb25zdHJ1Y3RvcihfLm1hcCh0aGlzLmdldFNlbGVjdGVkVmlld3MoKSwgdmlldyA9PiB2aWV3Lm1vZGVsKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgIC8qKiBoaWRlIHRoZSAkZWwgYW5kIGRpc3BsYXkgYSBsb2FkaW5nIGluZGljYXRvciAoaW4gdGhlICRlbCdzIHBhcmVudCkgd2hlbiBsb2FkaW5nIG5ldyBkYXRhICovXG4gICAgICAgIF9zaG93TG9hZGluZ0luZGljYXRvcjogZnVuY3Rpb24obXNnLCBzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoXCJfc2hvd0xvYWRpbmdJbmRpY2F0b3JcIiwgdGhpcy5pbmRpY2F0b3IsIG1zZywgc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHNwZWVkID0gc3BlZWQgIT09IHVuZGVmaW5lZCA/IHNwZWVkIDogdGhpcy5meFNwZWVkO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmluZGljYXRvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yID0gbmV3IExvYWRpbmdJbmRpY2F0b3IuTG9hZGluZ0luZGljYXRvcih0aGlzLiRlbCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcIlxcdCBjcmVhdGVkXCIsIHRoaXMuaW5kaWNhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy4kZWwuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yLnNob3coMCwgY2FsbGJhY2spO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbC5mYWRlT3V0KHNwZWVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluZGljYXRvci5zaG93KG1zZywgc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGlkZSB0aGUgbG9hZGluZyBpbmRpY2F0b3IgKi9cbiAgICAgICAgX2hpZGVMb2FkaW5nSW5kaWNhdG9yOiBmdW5jdGlvbihzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoXCJfaGlkZUxvYWRpbmdJbmRpY2F0b3JcIiwgdGhpcy5pbmRpY2F0b3IsIHNwZWVkLCBjYWxsYmFjayk7XG4gICAgICAgICAgICBzcGVlZCA9IHNwZWVkICE9PSB1bmRlZmluZWQgPyBzcGVlZCA6IHRoaXMuZnhTcGVlZDtcbiAgICAgICAgICAgIGlmICh0aGlzLmluZGljYXRvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5kaWNhdG9yLmhpZGUoc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gc2Nyb2xsaW5nXG4gICAgICAgIC8qKiBnZXQgdGhlIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uIG9mIHRoZSBwYW5lbCBpbiBpdHMgcGFyZW50ICovXG4gICAgICAgIHNjcm9sbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzY3JvbGxDb250YWluZXIoKS5zY3JvbGxUb3AoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2V0IHRoZSBjdXJyZW50IHNjcm9sbCBwb3NpdGlvbiBvZiB0aGUgcGFuZWwgaW4gaXRzIHBhcmVudCAqL1xuICAgICAgICBzY3JvbGxUbzogZnVuY3Rpb24ocG9zLCBzcGVlZCkge1xuICAgICAgICAgICAgc3BlZWQgPSBzcGVlZCB8fCAwO1xuICAgICAgICAgICAgdGhpcy4kc2Nyb2xsQ29udGFpbmVyKCkuYW5pbWF0ZSh7IHNjcm9sbFRvcDogcG9zIH0sIHNwZWVkKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTY3JvbGxzIHRoZSBwYW5lbCB0byB0aGUgdG9wLiAqL1xuICAgICAgICBzY3JvbGxUb1RvcDogZnVuY3Rpb24oc3BlZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcm9sbFRvKDAsIHNwZWVkKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2Nyb2xsIHRvIHRoZSBnaXZlbiB2aWV3IGluIGxpc3QtaXRlbXMgKi9cbiAgICAgICAgc2Nyb2xsVG9JdGVtOiBmdW5jdGlvbih2aWV3LCBzcGVlZCkge1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogU2Nyb2xscyB0aGUgcGFuZWwgdG8gc2hvdyB0aGUgY29udGVudCB3aXRoIHRoZSBnaXZlbiBpZC4gKi9cbiAgICAgICAgc2Nyb2xsVG9JZDogZnVuY3Rpb24oaWQsIHNwZWVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY3JvbGxUb0l0ZW0odGhpcy52aWV3RnJvbU1vZGVsSWQoaWQpLCBzcGVlZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBhbmVsIGV2ZW50c1xuICAgICAgICAvKiogZXZlbnQgbWFwICovXG4gICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgXCJjbGljayAuc2VsZWN0LWFsbFwiOiBcInNlbGVjdEFsbFwiLFxuICAgICAgICAgICAgXCJjbGljayAuZGVzZWxlY3QtYWxsXCI6IFwiZGVzZWxlY3RBbGxcIlxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBtaXNjXG4gICAgICAgIC8qKiBSZXR1cm4gYSBzdHJpbmcgcmVwIG9mIHRoZSBwYW5lbCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gYExpc3RQYW5lbCgke3RoaXMuY29sbGVjdGlvbn0pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gVEVNUExBVEVTXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkxpc3RQYW5lbC5wcm90b3R5cGUudGVtcGxhdGVzID0gKCgpID0+IHtcbiAgICB2YXIgZWxUZW1wbGF0ZSA9IEJBU0VfTVZDLndyYXBUZW1wbGF0ZShbXG4gICAgICAgIC8vIHRlbXAgY29udGFpbmVyXG4gICAgICAgIFwiPGRpdj5cIixcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJjb250cm9sc1wiPjwvZGl2PicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibGlzdC1pdGVtc1wiPjwvZGl2PicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZSBpbmZvbWVzc2FnZXNtYWxsXCI+PC9kaXY+JyxcbiAgICAgICAgXCI8L2Rpdj5cIlxuICAgIF0pO1xuXG4gICAgdmFyIGNvbnRyb2xzVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoW1xuICAgICAgICAnPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+JyxcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZVwiPicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibmFtZVwiPjwlLSB2aWV3LnRpdGxlICU+PC9kaXY+JyxcbiAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPjwlLSB2aWV3LnN1YnRpdGxlICU+PC9kaXY+JyxcbiAgICAgICAgLy8gYnV0dG9ucywgY29udHJvbHMgZ28gaGVyZVxuICAgICAgICAnPGRpdiBjbGFzcz1cImFjdGlvbnNcIj48L2Rpdj4nLFxuICAgICAgICAvLyBkZWxldGVkIG1zZywgZXRjLlxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1lc3NhZ2VzXCI+PC9kaXY+JyxcblxuICAgICAgICAnPGRpdiBjbGFzcz1cInNlYXJjaFwiPicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwic2VhcmNoLWlucHV0XCI+PC9kaXY+JyxcbiAgICAgICAgXCI8L2Rpdj5cIixcblxuICAgICAgICAvLyBzaG93IHdoZW4gc2VsZWN0b3JzIGFyZSBzaG93blxuICAgICAgICAnPGRpdiBjbGFzcz1cImxpc3QtYWN0aW9uc1wiPicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwXCI+JyxcbiAgICAgICAgJzxidXR0b24gY2xhc3M9XCJzZWxlY3QtYWxsIGJ0biBidG4tZGVmYXVsdFwiJyxcbiAgICAgICAgJ2RhdGEtbW9kZT1cInNlbGVjdFwiPicsXG4gICAgICAgIF9sKFwiQWxsXCIpLFxuICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cImRlc2VsZWN0LWFsbCBidG4gYnRuLWRlZmF1bHRcIicsXG4gICAgICAgICdkYXRhLW1vZGU9XCJzZWxlY3RcIj4nLFxuICAgICAgICBfbChcIk5vbmVcIiksXG4gICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibGlzdC1hY3Rpb24tbWVudSBidG4tZ3JvdXBcIj4nLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICBcIjwvZGl2PlwiXG4gICAgXSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBlbDogZWxUZW1wbGF0ZSxcbiAgICAgICAgY29udHJvbHM6IGNvbnRyb2xzVGVtcGxhdGVcbiAgICB9O1xufSkoKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIFZpZXcgZm9yIGEgbW9kZWwgdGhhdCBoYXMgYSBzdWItY29sbGVjdGlvbiAoZS5nLiBIaXN0b3J5LCBEYXRhc2V0Q29sbGVjdGlvbilcbiAqICBBbGxvd3M6XG4gKiAgICAgIHRoZSBtb2RlbCB0byBiZSByZXNldFxuICogICAgICBhdXRvIGFzc2lnbiBwYW5lbC5jb2xsZWN0aW9uIHRvIHBhbmVsLm1vZGVsWyBwYW5lbC5tb2RlbENvbGxlY3Rpb25LZXkgXVxuICpcbiAqL1xudmFyIE1vZGVsTGlzdFBhbmVsID0gTGlzdFBhbmVsLmV4dGVuZCh7XG4gICAgLyoqIGtleSBvZiBhdHRyaWJ1dGUgaW4gbW9kZWwgdG8gYXNzaWduIHRvIHRoaXMuY29sbGVjdGlvbiAqL1xuICAgIG1vZGVsQ29sbGVjdGlvbktleTogXCJjb250ZW50c1wiLFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICBMaXN0UGFuZWwucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgdGhpcy5zZWxlY3RpbmcgPSBhdHRyaWJ1dGVzLnNlbGVjdGluZyAhPT0gdW5kZWZpbmVkID8gYXR0cmlidXRlcy5zZWxlY3RpbmcgOiBmYWxzZTtcblxuICAgICAgICB0aGlzLnNldE1vZGVsKHRoaXMubW9kZWwsIGF0dHJpYnV0ZXMpO1xuICAgIH0sXG5cbiAgICAvKiogcmVsZWFzZS9mcmVlL3NodXRkb3duIG9sZCBtb2RlbHMgYW5kIHNldCB1cCBwYW5lbCBmb3IgbmV3IG1vZGVsc1xuICAgICAqICBAZmlyZXMgbmV3LW1vZGVsIHdpdGggdGhlIHBhbmVsIGFzIHBhcmFtZXRlclxuICAgICAqL1xuICAgIHNldE1vZGVsOiBmdW5jdGlvbihtb2RlbCwgYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyaWJ1dGVzID0gYXR0cmlidXRlcyB8fCB7fTtcbiAgICAgICAgdGhpcy5kZWJ1ZyhgJHt0aGlzfS5zZXRNb2RlbDpgLCBtb2RlbCwgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgdGhpcy5mcmVlTW9kZWwoKTtcbiAgICAgICAgdGhpcy5mcmVlVmlld3MoKTtcblxuICAgICAgICBpZiAobW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBvbGRNb2RlbElkID0gdGhpcy5tb2RlbCA/IHRoaXMubW9kZWwuZ2V0KFwiaWRcIikgOiBudWxsO1xuXG4gICAgICAgICAgICAvLyBzZXQgdXAgdGhlIG5ldyBtb2RlbCB3aXRoIHVzZXIsIGxvZ2dlciwgc3RvcmFnZSwgZXZlbnRzXG4gICAgICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgICAgICAgICBpZiAodGhpcy5sb2dnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmxvZ2dlciA9IHRoaXMubG9nZ2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc2V0VXBNb2RlbExpc3RlbmVycygpO1xuXG4gICAgICAgICAgICAvL1RPRE86IHJlbGF0aW9uIGJ0d24gbW9kZWwsIGNvbGxlY3Rpb24gYmVjb21pbmcgdGFuZ2xlZCBoZXJlXG4gICAgICAgICAgICAvLyBmcmVlIHRoZSBjb2xsZWN0aW9uLCBhbmQgYXNzaWduIHRoZSBuZXcgY29sbGVjdGlvbiB0byBlaXRoZXJcbiAgICAgICAgICAgIC8vICB0aGUgbW9kZWxbIG1vZGVsQ29sbGVjdGlvbktleSBdLCBhdHRyaWJ1dGVzLmNvbGxlY3Rpb24sIG9yIGFuIGVtcHR5IHZhbmlsbGEgY29sbGVjdGlvblxuICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29sbGVjdGlvbik7XG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPVxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWxbdGhpcy5tb2RlbENvbGxlY3Rpb25LZXldIHx8IGF0dHJpYnV0ZXMuY29sbGVjdGlvbiB8fCB0aGlzLl9jcmVhdGVEZWZhdWx0Q29sbGVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5fc2V0VXBDb2xsZWN0aW9uTGlzdGVuZXJzKCk7XG5cbiAgICAgICAgICAgIGlmIChvbGRNb2RlbElkICYmIG1vZGVsLmdldChcImlkXCIpICE9PSBvbGRNb2RlbElkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwibmV3LW1vZGVsXCIsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKiogZnJlZSB0aGUgY3VycmVudCBtb2RlbCBhbmQgYWxsIGxpc3RlbmVycyBmb3IgaXQsIGZyZWUgYW55IHZpZXdzIGZvciB0aGUgbW9kZWwgKi9cbiAgICBmcmVlTW9kZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBzdG9wL3JlbGVhc2UgdGhlIHByZXZpb3VzIG1vZGVsLCBhbmQgY2xlYXIgY2FjaGUgdG8gc3ViLXZpZXdzXG4gICAgICAgIGlmICh0aGlzLm1vZGVsKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCk7XG4gICAgICAgICAgICAvL1RPRE86IHNlZSBiYXNlLW12Y1xuICAgICAgICAgICAgLy90aGlzLm1vZGVsLmZyZWUoKTtcbiAgICAgICAgICAgIC8vdGhpcy5tb2RlbCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBsaXN0ZW5pbmdcbiAgICAvKiogbGlzdGVuaW5nIGZvciBtb2RlbCBldmVudHMgKi9cbiAgICBfc2V0VXBNb2RlbExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIG92ZXJyaWRlXG4gICAgICAgIHRoaXMubG9nKGAke3RoaXN9Ll9zZXRVcE1vZGVsTGlzdGVuZXJzYCwgdGhpcy5tb2RlbCk7XG4gICAgICAgIC8vIGJvdW5jZSBtb2RlbCBlcnJvcnMgdXAgdG8gdGhlIHBhbmVsXG4gICAgICAgIHRoaXMubGlzdGVuVG8oXG4gICAgICAgICAgICB0aGlzLm1vZGVsLFxuICAgICAgICAgICAgXCJlcnJvclwiLFxuICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApO1xuICAgICAgICAgICAgICAgIC8vYXJncy51bnNoaWZ0KCAnbW9kZWw6ZXJyb3InICk7XG4gICAgICAgICAgICAgICAgYXJncy51bnNoaWZ0KFwiZXJyb3JcIik7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXNcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBkZWJ1Z2dpbmdcbiAgICAgICAgaWYgKHRoaXMubG9nZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiYWxsXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmZvKGAke3RoaXN9KG1vZGVsKWAsIGV2ZW50LCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKiBCdWlsZCBhIHRlbXAgZGl2IGNvbnRhaW5pbmcgdGhlIG5ldyBjaGlsZHJlbiBmb3IgdGhlIHZpZXcncyAkZWwuXG4gICAgICovXG4gICAgX3JlbmRlckNvbnRyb2xzOiBmdW5jdGlvbigkbmV3UmVuZGVyKSB7XG4gICAgICAgIHRoaXMuZGVidWcoYCR7dGhpc30oTW9kZWxMaXN0UGFuZWwpLl9yZW5kZXJDb250cm9sc2ApO1xuICAgICAgICB2YXIganNvbiA9IHRoaXMubW9kZWwgPyB0aGlzLm1vZGVsLnRvSlNPTigpIDoge307XG4gICAgICAgIHZhciAkY29udHJvbHMgPSAkKHRoaXMudGVtcGxhdGVzLmNvbnRyb2xzKGpzb24sIHRoaXMpKTtcbiAgICAgICAgJG5ld1JlbmRlci5maW5kKFwiLmNvbnRyb2xzXCIpLnJlcGxhY2VXaXRoKCRjb250cm9scyk7XG4gICAgICAgIHJldHVybiAkY29udHJvbHM7XG4gICAgfSxcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBtaXNjXG4gICAgLyoqIFJldHVybiBhIHN0cmluZyByZXAgb2YgdGhlIHBhbmVsICovXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gYE1vZGVsTGlzdFBhbmVsKCR7dGhpcy5tb2RlbH0pYDtcbiAgICB9XG59KTtcblxuLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBURU1QTEFURVNcbi8qKiB1bmRlcnNjb3JlIHRlbXBsYXRlcyAqL1xuTW9kZWxMaXN0UGFuZWwucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIGNvbnRyb2xzVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoW1xuICAgICAgICAnPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+JyxcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZVwiPicsXG4gICAgICAgIC8vVE9ETzogdGhpcyBpcyByZWFsbHkgdGhlIG9ubHkgZGlmZmVyZW5jZSAtIGNvbnNpZGVyIGZhY3RvcmluZyB0aXRsZWJhciBvdXRcbiAgICAgICAgJzxkaXYgY2xhc3M9XCJuYW1lXCI+PCUtIG1vZGVsLm5hbWUgJT48L2Rpdj4nLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAnPGRpdiBjbGFzcz1cInN1YnRpdGxlXCI+PCUtIHZpZXcuc3VidGl0bGUgJT48L2Rpdj4nLFxuICAgICAgICAnPGRpdiBjbGFzcz1cImFjdGlvbnNcIj48L2Rpdj4nLFxuICAgICAgICAnPGRpdiBjbGFzcz1cIm1lc3NhZ2VzXCI+PC9kaXY+JyxcblxuICAgICAgICAnPGRpdiBjbGFzcz1cInNlYXJjaFwiPicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwic2VhcmNoLWlucHV0XCI+PC9kaXY+JyxcbiAgICAgICAgXCI8L2Rpdj5cIixcblxuICAgICAgICAnPGRpdiBjbGFzcz1cImxpc3QtYWN0aW9uc1wiPicsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwiYnRuLWdyb3VwXCI+JyxcbiAgICAgICAgJzxidXR0b24gY2xhc3M9XCJzZWxlY3QtYWxsIGJ0biBidG4tZGVmYXVsdFwiJyxcbiAgICAgICAgJ2RhdGEtbW9kZT1cInNlbGVjdFwiPicsXG4gICAgICAgIF9sKFwiQWxsXCIpLFxuICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cImRlc2VsZWN0LWFsbCBidG4gYnRuLWRlZmF1bHRcIicsXG4gICAgICAgICdkYXRhLW1vZGU9XCJzZWxlY3RcIj4nLFxuICAgICAgICBfbChcIk5vbmVcIiksXG4gICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICc8ZGl2IGNsYXNzPVwibGlzdC1hY3Rpb24tbWVudSBidG4tZ3JvdXBcIj4nLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICBcIjwvZGl2PlwiXG4gICAgXSk7XG5cbiAgICByZXR1cm4gXy5leHRlbmQoXy5jbG9uZShMaXN0UGFuZWwucHJvdG90eXBlLnRlbXBsYXRlcyksIHtcbiAgICAgICAgY29udHJvbHM6IGNvbnRyb2xzVGVtcGxhdGVcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBMaXN0UGFuZWw6IExpc3RQYW5lbCxcbiAgICBNb2RlbExpc3RQYW5lbDogTW9kZWxMaXN0UGFuZWxcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2xpc3QvbGlzdC12aWV3LmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7O0FBSUE7Ozs7Ozs7Ozs7Ozs7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFDQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsQkE7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFoQkE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOXpCQTtBQUNBO0FBaTBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQWdCQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5HQTtBQUNBO0FBcUdBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBMEJBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///39\n");

/***/ }),
/* 40 */
/*!*******************************************!*\
  !*** ./galaxy/scripts/ui/search-input.js ***!
  \*******************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _jquery = __webpack_require__(/*! jquery */ 0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\"use_strict\";\n\nvar $ = _jquery2.default;\nvar _l = window._l || function (s) {\n    return s;\n};\n\n//TODO: consolidate with tool menu functionality, use there\n\n/** searchInput: (jQuery plugin)\n *      Creates a search input, a clear button, and loading indicator\n *      within the selected node.\n *\n *      When the user either presses return or enters some minimal number\n *      of characters, a callback is called. Pressing ESC when the input\n *      is focused will clear the input and call a separate callback.\n */\nfunction searchInput(parentNode, options) {\n    var KEYCODE_ESC = 27;\n    var KEYCODE_RETURN = 13;\n    var $parentNode = $(parentNode);\n    var firstSearch = true;\n\n    var defaults = {\n        initialVal: \"\",\n        name: \"search\",\n        placeholder: \"search\",\n        classes: \"\",\n        onclear: function onclear() {},\n        onfirstsearch: null,\n        onsearch: function onsearch(inputVal) {},\n        minSearchLen: 0,\n        escWillClear: true,\n        oninit: function oninit() {}\n    };\n\n    // .................................................................... input rendering and events\n    // visually clear the search, trigger an event, and call the callback\n    function clearSearchInput(event) {\n        var $input = $(this).parent().children(\"input\");\n        $input.val(\"\").trigger(\"searchInput.clear\").blur();\n        options.onclear();\n    }\n\n    // search for searchTerms, trigger an event, call the appropo callback (based on whether this is the first)\n    function search(event, searchTerms) {\n        if (!searchTerms) {\n            return clearSearchInput();\n        }\n        $(this).trigger(\"search.search\", searchTerms);\n        if (typeof options.onfirstsearch === \"function\" && firstSearch) {\n            firstSearch = false;\n            options.onfirstsearch(searchTerms);\n        } else {\n            options.onsearch(searchTerms);\n        }\n    }\n\n    // .................................................................... input rendering and events\n    function inputTemplate() {\n        // class search-query is bootstrap 2.3 style that now lives in base.less\n        return ['<input type=\"text\" name=\"', options.name, '\" placeholder=\"', options.placeholder, '\" ', 'class=\"search-query ', options.classes, '\" ', \"/>\"].join(\"\");\n    }\n\n    // the search input that responds to keyboard events and displays the search value\n    function $input() {\n        return $(inputTemplate())\n        // select all text on a focus\n        .focus(function (event) {\n            $(this).select();\n        })\n        // attach behaviors to esc, return if desired, search on some min len string\n        .keyup(function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n\n            // esc key will clear if desired\n            if (event.which === KEYCODE_ESC && options.escWillClear) {\n                clearSearchInput.call(this, event);\n            } else {\n                var searchTerms = $(this).val();\n                // return key or the search string len > minSearchLen (if not 0) triggers search\n                if (event.which === KEYCODE_RETURN || options.minSearchLen && searchTerms.length >= options.minSearchLen) {\n                    search.call(this, event, searchTerms);\n                }\n            }\n        }).val(options.initialVal);\n    }\n\n    // .................................................................... clear button rendering and events\n    // a button for clearing the search bar, placed on the right hand side\n    function $clearBtn() {\n        return $(['<span class=\"search-clear fa fa-times-circle\" ', 'title=\"', _l(\"clear search (esc)\"), '\"></span>'].join(\"\")).tooltip({ placement: \"bottom\" }).click(function (event) {\n            clearSearchInput.call(this, event);\n        });\n    }\n\n    // .................................................................... loadingIndicator rendering\n    // a button for clearing the search bar, placed on the right hand side\n    function $loadingIndicator() {\n        return $(['<span class=\"search-loading fa fa-spinner fa-spin\" ', 'title=\"', _l(\"loading...\"), '\"></span>'].join(\"\")).hide().tooltip({ placement: \"bottom\" });\n    }\n\n    // .................................................................... commands\n    // visually swap the load, clear buttons\n    function toggleLoadingIndicator() {\n        $parentNode.find(\".search-loading\").toggle();\n        $parentNode.find(\".search-clear\").toggle();\n    }\n\n    // .................................................................... init\n    // string command (not constructor)\n    if (_jquery2.default.type(options) === \"string\") {\n        if (options === \"toggle-loading\") {\n            toggleLoadingIndicator();\n        }\n        return $parentNode;\n    }\n\n    // initial render\n    if (_jquery2.default.type(options) === \"object\") {\n        options = _jquery2.default.extend(true, {}, defaults, options);\n    }\n    //NOTE: prepended\n    return $parentNode.addClass(\"search-input\").prepend([$input(), $clearBtn(), $loadingIndicator()]);\n}\n\n// as jq plugin\n_jquery2.default.fn.extend({\n    searchInput: function $searchInput(options) {\n        return this.each(function () {\n            return searchInput(this, options);\n        });\n    }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdWkvc2VhcmNoLWlucHV0LmpzPzRiMTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGpRdWVyeSBmcm9tIFwianF1ZXJ5XCI7XG4oXCJ1c2Vfc3RyaWN0XCIpO1xuXG52YXIgJCA9IGpRdWVyeTtcbnZhciBfbCA9IHdpbmRvdy5fbCB8fCAocyA9PiBzKTtcblxuLy9UT0RPOiBjb25zb2xpZGF0ZSB3aXRoIHRvb2wgbWVudSBmdW5jdGlvbmFsaXR5LCB1c2UgdGhlcmVcblxuLyoqIHNlYXJjaElucHV0OiAoalF1ZXJ5IHBsdWdpbilcbiAqICAgICAgQ3JlYXRlcyBhIHNlYXJjaCBpbnB1dCwgYSBjbGVhciBidXR0b24sIGFuZCBsb2FkaW5nIGluZGljYXRvclxuICogICAgICB3aXRoaW4gdGhlIHNlbGVjdGVkIG5vZGUuXG4gKlxuICogICAgICBXaGVuIHRoZSB1c2VyIGVpdGhlciBwcmVzc2VzIHJldHVybiBvciBlbnRlcnMgc29tZSBtaW5pbWFsIG51bWJlclxuICogICAgICBvZiBjaGFyYWN0ZXJzLCBhIGNhbGxiYWNrIGlzIGNhbGxlZC4gUHJlc3NpbmcgRVNDIHdoZW4gdGhlIGlucHV0XG4gKiAgICAgIGlzIGZvY3VzZWQgd2lsbCBjbGVhciB0aGUgaW5wdXQgYW5kIGNhbGwgYSBzZXBhcmF0ZSBjYWxsYmFjay5cbiAqL1xuZnVuY3Rpb24gc2VhcmNoSW5wdXQocGFyZW50Tm9kZSwgb3B0aW9ucykge1xuICAgIHZhciBLRVlDT0RFX0VTQyA9IDI3O1xuICAgIHZhciBLRVlDT0RFX1JFVFVSTiA9IDEzO1xuICAgIHZhciAkcGFyZW50Tm9kZSA9ICQocGFyZW50Tm9kZSk7XG4gICAgdmFyIGZpcnN0U2VhcmNoID0gdHJ1ZTtcblxuICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgICAgaW5pdGlhbFZhbDogXCJcIixcbiAgICAgICAgbmFtZTogXCJzZWFyY2hcIixcbiAgICAgICAgcGxhY2Vob2xkZXI6IFwic2VhcmNoXCIsXG4gICAgICAgIGNsYXNzZXM6IFwiXCIsXG4gICAgICAgIG9uY2xlYXI6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgIG9uZmlyc3RzZWFyY2g6IG51bGwsXG4gICAgICAgIG9uc2VhcmNoOiBmdW5jdGlvbihpbnB1dFZhbCkge30sXG4gICAgICAgIG1pblNlYXJjaExlbjogMCxcbiAgICAgICAgZXNjV2lsbENsZWFyOiB0cnVlLFxuICAgICAgICBvbmluaXQ6IGZ1bmN0aW9uKCkge31cbiAgICB9O1xuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gaW5wdXQgcmVuZGVyaW5nIGFuZCBldmVudHNcbiAgICAvLyB2aXN1YWxseSBjbGVhciB0aGUgc2VhcmNoLCB0cmlnZ2VyIGFuIGV2ZW50LCBhbmQgY2FsbCB0aGUgY2FsbGJhY2tcbiAgICBmdW5jdGlvbiBjbGVhclNlYXJjaElucHV0KGV2ZW50KSB7XG4gICAgICAgIHZhciAkaW5wdXQgPSAkKHRoaXMpXG4gICAgICAgICAgICAucGFyZW50KClcbiAgICAgICAgICAgIC5jaGlsZHJlbihcImlucHV0XCIpO1xuICAgICAgICAkaW5wdXRcbiAgICAgICAgICAgIC52YWwoXCJcIilcbiAgICAgICAgICAgIC50cmlnZ2VyKFwic2VhcmNoSW5wdXQuY2xlYXJcIilcbiAgICAgICAgICAgIC5ibHVyKCk7XG4gICAgICAgIG9wdGlvbnMub25jbGVhcigpO1xuICAgIH1cblxuICAgIC8vIHNlYXJjaCBmb3Igc2VhcmNoVGVybXMsIHRyaWdnZXIgYW4gZXZlbnQsIGNhbGwgdGhlIGFwcHJvcG8gY2FsbGJhY2sgKGJhc2VkIG9uIHdoZXRoZXIgdGhpcyBpcyB0aGUgZmlyc3QpXG4gICAgZnVuY3Rpb24gc2VhcmNoKGV2ZW50LCBzZWFyY2hUZXJtcykge1xuICAgICAgICBpZiAoIXNlYXJjaFRlcm1zKSB7XG4gICAgICAgICAgICByZXR1cm4gY2xlYXJTZWFyY2hJbnB1dCgpO1xuICAgICAgICB9XG4gICAgICAgICQodGhpcykudHJpZ2dlcihcInNlYXJjaC5zZWFyY2hcIiwgc2VhcmNoVGVybXMpO1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMub25maXJzdHNlYXJjaCA9PT0gXCJmdW5jdGlvblwiICYmIGZpcnN0U2VhcmNoKSB7XG4gICAgICAgICAgICBmaXJzdFNlYXJjaCA9IGZhbHNlO1xuICAgICAgICAgICAgb3B0aW9ucy5vbmZpcnN0c2VhcmNoKHNlYXJjaFRlcm1zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbnMub25zZWFyY2goc2VhcmNoVGVybXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gaW5wdXQgcmVuZGVyaW5nIGFuZCBldmVudHNcbiAgICBmdW5jdGlvbiBpbnB1dFRlbXBsYXRlKCkge1xuICAgICAgICAvLyBjbGFzcyBzZWFyY2gtcXVlcnkgaXMgYm9vdHN0cmFwIDIuMyBzdHlsZSB0aGF0IG5vdyBsaXZlcyBpbiBiYXNlLmxlc3NcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICc8aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwiJyxcbiAgICAgICAgICAgIG9wdGlvbnMubmFtZSxcbiAgICAgICAgICAgICdcIiBwbGFjZWhvbGRlcj1cIicsXG4gICAgICAgICAgICBvcHRpb25zLnBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgJ1wiICcsXG4gICAgICAgICAgICAnY2xhc3M9XCJzZWFyY2gtcXVlcnkgJyxcbiAgICAgICAgICAgIG9wdGlvbnMuY2xhc3NlcyxcbiAgICAgICAgICAgICdcIiAnLFxuICAgICAgICAgICAgXCIvPlwiXG4gICAgICAgIF0uam9pbihcIlwiKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgc2VhcmNoIGlucHV0IHRoYXQgcmVzcG9uZHMgdG8ga2V5Ym9hcmQgZXZlbnRzIGFuZCBkaXNwbGF5cyB0aGUgc2VhcmNoIHZhbHVlXG4gICAgZnVuY3Rpb24gJGlucHV0KCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJChpbnB1dFRlbXBsYXRlKCkpXG4gICAgICAgICAgICAgICAgLy8gc2VsZWN0IGFsbCB0ZXh0IG9uIGEgZm9jdXNcbiAgICAgICAgICAgICAgICAuZm9jdXMoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5zZWxlY3QoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC8vIGF0dGFjaCBiZWhhdmlvcnMgdG8gZXNjLCByZXR1cm4gaWYgZGVzaXJlZCwgc2VhcmNoIG9uIHNvbWUgbWluIGxlbiBzdHJpbmdcbiAgICAgICAgICAgICAgICAua2V5dXAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZXNjIGtleSB3aWxsIGNsZWFyIGlmIGRlc2lyZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSBLRVlDT0RFX0VTQyAmJiBvcHRpb25zLmVzY1dpbGxDbGVhcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJTZWFyY2hJbnB1dC5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hUZXJtcyA9ICQodGhpcykudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4ga2V5IG9yIHRoZSBzZWFyY2ggc3RyaW5nIGxlbiA+IG1pblNlYXJjaExlbiAoaWYgbm90IDApIHRyaWdnZXJzIHNlYXJjaFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LndoaWNoID09PSBLRVlDT0RFX1JFVFVSTiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLm1pblNlYXJjaExlbiAmJiBzZWFyY2hUZXJtcy5sZW5ndGggPj0gb3B0aW9ucy5taW5TZWFyY2hMZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2guY2FsbCh0aGlzLCBldmVudCwgc2VhcmNoVGVybXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudmFsKG9wdGlvbnMuaW5pdGlhbFZhbClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjbGVhciBidXR0b24gcmVuZGVyaW5nIGFuZCBldmVudHNcbiAgICAvLyBhIGJ1dHRvbiBmb3IgY2xlYXJpbmcgdGhlIHNlYXJjaCBiYXIsIHBsYWNlZCBvbiB0aGUgcmlnaHQgaGFuZCBzaWRlXG4gICAgZnVuY3Rpb24gJGNsZWFyQnRuKCkge1xuICAgICAgICByZXR1cm4gJChcbiAgICAgICAgICAgIFsnPHNwYW4gY2xhc3M9XCJzZWFyY2gtY2xlYXIgZmEgZmEtdGltZXMtY2lyY2xlXCIgJywgJ3RpdGxlPVwiJywgX2woXCJjbGVhciBzZWFyY2ggKGVzYylcIiksICdcIj48L3NwYW4+J10uam9pbihcbiAgICAgICAgICAgICAgICBcIlwiXG4gICAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgICAgIC50b29sdGlwKHsgcGxhY2VtZW50OiBcImJvdHRvbVwiIH0pXG4gICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBjbGVhclNlYXJjaElucHV0LmNhbGwodGhpcywgZXZlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbG9hZGluZ0luZGljYXRvciByZW5kZXJpbmdcbiAgICAvLyBhIGJ1dHRvbiBmb3IgY2xlYXJpbmcgdGhlIHNlYXJjaCBiYXIsIHBsYWNlZCBvbiB0aGUgcmlnaHQgaGFuZCBzaWRlXG4gICAgZnVuY3Rpb24gJGxvYWRpbmdJbmRpY2F0b3IoKSB7XG4gICAgICAgIHJldHVybiAkKFxuICAgICAgICAgICAgWyc8c3BhbiBjbGFzcz1cInNlYXJjaC1sb2FkaW5nIGZhIGZhLXNwaW5uZXIgZmEtc3BpblwiICcsICd0aXRsZT1cIicsIF9sKFwibG9hZGluZy4uLlwiKSwgJ1wiPjwvc3Bhbj4nXS5qb2luKFwiXCIpXG4gICAgICAgIClcbiAgICAgICAgICAgIC5oaWRlKClcbiAgICAgICAgICAgIC50b29sdGlwKHsgcGxhY2VtZW50OiBcImJvdHRvbVwiIH0pO1xuICAgIH1cblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGNvbW1hbmRzXG4gICAgLy8gdmlzdWFsbHkgc3dhcCB0aGUgbG9hZCwgY2xlYXIgYnV0dG9uc1xuICAgIGZ1bmN0aW9uIHRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoKSB7XG4gICAgICAgICRwYXJlbnROb2RlLmZpbmQoXCIuc2VhcmNoLWxvYWRpbmdcIikudG9nZ2xlKCk7XG4gICAgICAgICRwYXJlbnROb2RlLmZpbmQoXCIuc2VhcmNoLWNsZWFyXCIpLnRvZ2dsZSgpO1xuICAgIH1cblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGluaXRcbiAgICAvLyBzdHJpbmcgY29tbWFuZCAobm90IGNvbnN0cnVjdG9yKVxuICAgIGlmIChqUXVlcnkudHlwZShvcHRpb25zKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gXCJ0b2dnbGUtbG9hZGluZ1wiKSB7XG4gICAgICAgICAgICB0b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICRwYXJlbnROb2RlO1xuICAgIH1cblxuICAgIC8vIGluaXRpYWwgcmVuZGVyXG4gICAgaWYgKGpRdWVyeS50eXBlKG9wdGlvbnMpID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIG9wdGlvbnMgPSBqUXVlcnkuZXh0ZW5kKHRydWUsIHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG4gICAgfVxuICAgIC8vTk9URTogcHJlcGVuZGVkXG4gICAgcmV0dXJuICRwYXJlbnROb2RlLmFkZENsYXNzKFwic2VhcmNoLWlucHV0XCIpLnByZXBlbmQoWyRpbnB1dCgpLCAkY2xlYXJCdG4oKSwgJGxvYWRpbmdJbmRpY2F0b3IoKV0pO1xufVxuXG4vLyBhcyBqcSBwbHVnaW5cbmpRdWVyeS5mbi5leHRlbmQoe1xuICAgIHNlYXJjaElucHV0OiBmdW5jdGlvbiAkc2VhcmNoSW5wdXQob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHNlYXJjaElucHV0KHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy91aS9zZWFyY2gtaW5wdXQuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///40\n");

/***/ }),
/* 41 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/mvc/history/hda-li.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _datasetLi = __webpack_require__(/*! mvc/dataset/dataset-li */ 17);\n\nvar _datasetLi2 = _interopRequireDefault(_datasetLi);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _historyItemLi = __webpack_require__(/*! mvc/history/history-item-li */ 59);\n\nvar _historyItemLi2 = _interopRequireDefault(_historyItemLi);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _datasetLi2.default.DatasetListItemView;\n/** @class Read only view for HistoryDatasetAssociation.\n *      Since there are no controls on the HDAView to hide the dataset,\n *      the primary thing this class does (currently) is override templates\n *      to render the HID.\n */\nvar HDAListItemView = _super.extend(\n/** @lends HDAListItemView.prototype */{\n    className: _super.prototype.className + \" history-content\",\n\n    initialize: function initialize(attributes, options) {\n        _super.prototype.initialize.call(this, attributes, options);\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"HDAListItemView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nHDAListItemView.prototype.templates = function () {\n    var titleBarTemplate = function titleBarTemplate(dataset) {\n        return \"\\n        <div class=\\\"title-bar clear\\\" tabindex=\\\"0\\\">\\n            <span class=\\\"state-icon\\\"></span>\\n            <div class=\\\"title\\\">\\n                <span class=\\\"hid\\\">\" + dataset.hid + \"</span>\\n                <span class=\\\"name\\\">\" + _.escape(dataset.name) + \"</span>\\n            </div>\\n            </br>\\n            \" + _historyItemLi2.default.nametagTemplate(dataset) + \"\\n        </div>\\n    \";\n    };\n\n    var warnings = _.extend({}, _super.prototype.templates.warnings, {\n        hidden: _baseMvc2.default.wrapTemplate([\n        // add a warning when hidden\n        \"<% if( !dataset.visible ){ %>\", '<div class=\"hidden-msg warningmessagesmall\">', (0, _localization2.default)(\"This dataset has been hidden\"), \"</div>\", \"<% } %>\"], \"dataset\")\n    });\n\n    return _.extend({}, _super.prototype.templates, {\n        titleBar: titleBarTemplate,\n        warnings: warnings\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    HDAListItemView: HDAListItemView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRhLWxpLmpzPzM5ZDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERBVEFTRVRfTEkgZnJvbSBcIm12Yy9kYXRhc2V0L2RhdGFzZXQtbGlcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgSElTVE9SWV9JVEVNX0xJIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LWl0ZW0tbGlcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgX3N1cGVyID0gREFUQVNFVF9MSS5EYXRhc2V0TGlzdEl0ZW1WaWV3O1xuLyoqIEBjbGFzcyBSZWFkIG9ubHkgdmlldyBmb3IgSGlzdG9yeURhdGFzZXRBc3NvY2lhdGlvbi5cbiAqICAgICAgU2luY2UgdGhlcmUgYXJlIG5vIGNvbnRyb2xzIG9uIHRoZSBIREFWaWV3IHRvIGhpZGUgdGhlIGRhdGFzZXQsXG4gKiAgICAgIHRoZSBwcmltYXJ5IHRoaW5nIHRoaXMgY2xhc3MgZG9lcyAoY3VycmVudGx5KSBpcyBvdmVycmlkZSB0ZW1wbGF0ZXNcbiAqICAgICAgdG8gcmVuZGVyIHRoZSBISUQuXG4gKi9cbnZhciBIREFMaXN0SXRlbVZpZXcgPSBfc3VwZXIuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgSERBTGlzdEl0ZW1WaWV3LnByb3RvdHlwZSAqLyB7XG4gICAgICAgIGNsYXNzTmFtZTogYCR7X3N1cGVyLnByb3RvdHlwZS5jbGFzc05hbWV9IGhpc3RvcnktY29udGVudGAsXG5cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcywgb3B0aW9ucykge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcywgb3B0aW9ucyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBIREFMaXN0SXRlbVZpZXcoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gVEVNUExBVEVTXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkhEQUxpc3RJdGVtVmlldy5wcm90b3R5cGUudGVtcGxhdGVzID0gKCgpID0+IHtcbiAgICB2YXIgdGl0bGVCYXJUZW1wbGF0ZSA9IGRhdGFzZXQgPT4gYFxuICAgICAgICA8ZGl2IGNsYXNzPVwidGl0bGUtYmFyIGNsZWFyXCIgdGFiaW5kZXg9XCIwXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cInN0YXRlLWljb25cIj48L3NwYW4+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGl0bGVcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImhpZFwiPiR7ZGF0YXNldC5oaWR9PC9zcGFuPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibmFtZVwiPiR7Xy5lc2NhcGUoZGF0YXNldC5uYW1lKX08L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvYnI+XG4gICAgICAgICAgICAke0hJU1RPUllfSVRFTV9MSS5uYW1ldGFnVGVtcGxhdGUoZGF0YXNldCl9XG4gICAgICAgIDwvZGl2PlxuICAgIGA7XG5cbiAgICB2YXIgd2FybmluZ3MgPSBfLmV4dGVuZCh7fSwgX3N1cGVyLnByb3RvdHlwZS50ZW1wbGF0ZXMud2FybmluZ3MsIHtcbiAgICAgICAgaGlkZGVuOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgLy8gYWRkIGEgd2FybmluZyB3aGVuIGhpZGRlblxuICAgICAgICAgICAgICAgIFwiPCUgaWYoICFkYXRhc2V0LnZpc2libGUgKXsgJT5cIixcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImhpZGRlbi1tc2cgd2FybmluZ21lc3NhZ2VzbWFsbFwiPicsXG4gICAgICAgICAgICAgICAgX2woXCJUaGlzIGRhdGFzZXQgaGFzIGJlZW4gaGlkZGVuXCIpLFxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgXCI8JSB9ICU+XCJcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBcImRhdGFzZXRcIlxuICAgICAgICApXG4gICAgfSk7XG5cbiAgICByZXR1cm4gXy5leHRlbmQoe30sIF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzLCB7XG4gICAgICAgIHRpdGxlQmFyOiB0aXRsZUJhclRlbXBsYXRlLFxuICAgICAgICB3YXJuaW5nczogd2FybmluZ3NcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSERBTGlzdEl0ZW1WaWV3OiBIREFMaXN0SXRlbVZpZXdcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRhLWxpLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFDQTtBQWVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBV0E7QUFDQTtBQUVBO0FBQ0E7QUFKQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///41\n");

/***/ }),
/* 42 */
/*!***********************************************!*\
  !*** ./galaxy/scripts/mvc/history/hdca-li.js ***!
  \***********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _collectionLi = __webpack_require__(/*! mvc/collection/collection-li */ 32);\n\nvar _collectionLi2 = _interopRequireDefault(_collectionLi);\n\nvar _collectionView = __webpack_require__(/*! mvc/collection/collection-view */ 60);\n\nvar _collectionView2 = _interopRequireDefault(_collectionView);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _historyItemLi = __webpack_require__(/*! mvc/history/history-item-li */ 59);\n\nvar _historyItemLi2 = _interopRequireDefault(_historyItemLi);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _collectionLi2.default.DCListItemView;\n/** @class Read only view for HistoryDatasetCollectionAssociation (a dataset collection inside a history).\n */\nvar HDCAListItemView = _super.extend(\n/** @lends HDCAListItemView.prototype */{\n    className: _super.prototype.className + \" history-content\",\n\n    /** event listeners */\n    _setUpListeners: function _setUpListeners() {\n        var _this = this;\n\n        _super.prototype._setUpListeners.call(this);\n        var renderListen = function renderListen(model, options) {\n            _this.render();\n        };\n        if (this.model.jobStatesSummary) {\n            this.listenTo(this.model.jobStatesSummary, \"change\", renderListen);\n        }\n        this.listenTo(this.model, {\n            \"change:tags change:visible change:state\": renderListen\n        });\n    },\n\n    /** Override to provide the proper collections panels as the foldout */\n    _getFoldoutPanelClass: function _getFoldoutPanelClass() {\n        return _collectionView2.default.CollectionView;\n    },\n\n    /** In this override, add the state as a class for use with state-based CSS */\n    _swapNewRender: function _swapNewRender($newRender) {\n        _super.prototype._swapNewRender.call(this, $newRender);\n        //TODO: model currently has no state\n        var state;\n        var jobStatesSummary = this.model.jobStatesSummary;\n        if (jobStatesSummary) {\n            if (jobStatesSummary.new()) {\n                state = \"loading\";\n            } else if (jobStatesSummary.errored()) {\n                state = \"error\";\n            } else if (jobStatesSummary.terminal()) {\n                state = \"ok\";\n            } else if (jobStatesSummary.running()) {\n                state = \"running\";\n            } else {\n                state = \"queued\";\n            }\n        } else if (this.model.get(\"job_source_id\")) {\n            // Initial rendering - polling will fill in more details in a bit.\n            state = \"loading\";\n        } else {\n            state = this.model.get(\"populated_state\") ? _states2.default.OK : _states2.default.RUNNING;\n        }\n        this.$el.addClass(\"state-\" + state);\n        var stateDescription = this.stateDescription();\n        this.$(\".state-description\").html(stateDescription);\n        return this.$el;\n    },\n\n    stateDescription: function stateDescription() {\n        var collection = this.model;\n        var elementCount = collection.get(\"element_count\");\n        var jobStateSource = collection.get(\"job_source_type\");\n        var collectionType = this.model.get(\"collection_type\");\n        var collectionTypeDescription = _collectionView2.default.collectionTypeDescription(collection);\n        var simpleDescription = _collectionView2.default.collectionDescription(collection);\n        var jobStatesSummary = collection.jobStatesSummary;\n        if (!jobStateSource || jobStateSource == \"Job\") {\n            return simpleDescription;\n        } else if (!jobStatesSummary || !jobStatesSummary.hasDetails()) {\n            return \"\\n                    <div class=\\\"progress state-progress\\\">\\n                        <span class=\\\"note\\\">Loading job data for \" + collectionTypeDescription + \".<span class=\\\"blinking\\\">..</span></span>\\n                        <div class=\\\"progress-bar info\\\" style=\\\"width:100%\\\">\\n                    </div>\";\n        } else {\n            var isNew = jobStatesSummary.new();\n            var jobCount = isNew ? null : jobStatesSummary.jobCount();\n            if (isNew) {\n                return \"\\n                        <div class=\\\"progress state-progress\\\">\\n                            <span class=\\\"note\\\">Creating jobs.<span class=\\\"blinking\\\">..</span></span>\\n                            <div class=\\\"progress-bar info\\\" style=\\\"width:100%\\\">\\n                        </div>\";\n            } else if (jobStatesSummary.errored()) {\n                var errorCount = jobStatesSummary.numInError();\n                return \"a \" + collectionTypeDescription + \" with \" + errorCount + \" / \" + jobCount + \" jobs in error\";\n            } else if (jobStatesSummary.terminal()) {\n                return simpleDescription;\n            } else {\n                var running = jobStatesSummary.states()[\"running\"] || 0;\n                var ok = jobStatesSummary.states()[\"ok\"] || 0;\n                var okPercent = ok / (jobCount * 1.0);\n                var runningPercent = running / (jobCount * 1.0);\n                var otherPercent = 1.0 - okPercent - runningPercent;\n                var jobsStr = jobCount && jobCount > 1 ? jobCount + \" jobs\" : \"a job\";\n                return \"\\n                        <div class=\\\"progress state-progress\\\">\\n                            <span class=\\\"note\\\">\" + jobsStr + \" generating a \" + collectionTypeDescription + \"</span>\\n                            <div class=\\\"progress-bar ok\\\" style=\\\"width:\" + okPercent * 100.0 + \"%\\\"></div>\\n                            <div class=\\\"progress-bar running\\\" style=\\\"width:\" + runningPercent * 100.0 + \"%\\\"></div>\\n                            <div class=\\\"progress-bar new\\\" style=\\\"width:\" + otherPercent * 100.0 + \"%\\\">\\n                        </div>\";\n            }\n        }\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"HDCAListItemView(\" + modelString + \")\";\n    }\n});\n\n/** underscore templates */\nHDCAListItemView.prototype.templates = function () {\n    var warnings = _.extend({}, _super.prototype.templates.warnings, {\n        hidden: function hidden(collection) {\n            collection.visible ? \"\" : \"<div class=\\\"hidden-msg warningmessagesmall\\\">\" + (0, _localization2.default)(\"This collection has been hidden\") + \"</div>\";\n        }\n    });\n\n    var titleBarTemplate = function titleBarTemplate(collection) {\n        return \"\\n        <div class=\\\"title-bar clear\\\" tabindex=\\\"0\\\">\\n            <span class=\\\"state-icon\\\"></span>\\n            <div class=\\\"title\\\">\\n                <span class=\\\"hid\\\">\" + collection.hid + \"</span>\\n                <span class=\\\"name\\\">\" + _.escape(collection.name) + \"</span>\\n            </div>\\n            <div class=\\\"state-description\\\">\\n            </div>\\n            \" + _historyItemLi2.default.nametagTemplate(collection) + \"\\n        </div>\\n    \";\n    };\n\n    return _.extend({}, _super.prototype.templates, {\n        warnings: warnings,\n        titleBar: titleBarTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    HDCAListItemView: HDCAListItemView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRjYS1saS5qcz8yZjllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTVEFURVMgZnJvbSBcIm12Yy9kYXRhc2V0L3N0YXRlc1wiO1xuaW1wb3J0IERDX0xJIGZyb20gXCJtdmMvY29sbGVjdGlvbi9jb2xsZWN0aW9uLWxpXCI7XG5pbXBvcnQgRENfVklFVyBmcm9tIFwibXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi12aWV3XCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IEhJU1RPUllfSVRFTV9MSSBmcm9tIFwibXZjL2hpc3RvcnkvaGlzdG9yeS1pdGVtLWxpXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxudmFyIF9zdXBlciA9IERDX0xJLkRDTGlzdEl0ZW1WaWV3O1xuLyoqIEBjbGFzcyBSZWFkIG9ubHkgdmlldyBmb3IgSGlzdG9yeURhdGFzZXRDb2xsZWN0aW9uQXNzb2NpYXRpb24gKGEgZGF0YXNldCBjb2xsZWN0aW9uIGluc2lkZSBhIGhpc3RvcnkpLlxuICovXG52YXIgSERDQUxpc3RJdGVtVmlldyA9IF9zdXBlci5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBIRENBTGlzdEl0ZW1WaWV3LnByb3RvdHlwZSAqLyB7XG4gICAgICAgIGNsYXNzTmFtZTogYCR7X3N1cGVyLnByb3RvdHlwZS5jbGFzc05hbWV9IGhpc3RvcnktY29udGVudGAsXG5cbiAgICAgICAgLyoqIGV2ZW50IGxpc3RlbmVycyAqL1xuICAgICAgICBfc2V0VXBMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBMaXN0ZW5lcnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHZhciByZW5kZXJMaXN0ZW4gPSAobW9kZWwsIG9wdGlvbnMpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGVsLmpvYlN0YXRlc1N1bW1hcnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwuam9iU3RhdGVzU3VtbWFyeSwgXCJjaGFuZ2VcIiwgcmVuZGVyTGlzdGVuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwge1xuICAgICAgICAgICAgICAgIFwiY2hhbmdlOnRhZ3MgY2hhbmdlOnZpc2libGUgY2hhbmdlOnN0YXRlXCI6IHJlbmRlckxpc3RlblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIHByb3ZpZGUgdGhlIHByb3BlciBjb2xsZWN0aW9ucyBwYW5lbHMgYXMgdGhlIGZvbGRvdXQgKi9cbiAgICAgICAgX2dldEZvbGRvdXRQYW5lbENsYXNzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBEQ19WSUVXLkNvbGxlY3Rpb25WaWV3O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQgdGhlIHN0YXRlIGFzIGEgY2xhc3MgZm9yIHVzZSB3aXRoIHN0YXRlLWJhc2VkIENTUyAqL1xuICAgICAgICBfc3dhcE5ld1JlbmRlcjogZnVuY3Rpb24oJG5ld1JlbmRlcikge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc3dhcE5ld1JlbmRlci5jYWxsKHRoaXMsICRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgLy9UT0RPOiBtb2RlbCBjdXJyZW50bHkgaGFzIG5vIHN0YXRlXG4gICAgICAgICAgICB2YXIgc3RhdGU7XG4gICAgICAgICAgICB2YXIgam9iU3RhdGVzU3VtbWFyeSA9IHRoaXMubW9kZWwuam9iU3RhdGVzU3VtbWFyeTtcbiAgICAgICAgICAgIGlmIChqb2JTdGF0ZXNTdW1tYXJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGpvYlN0YXRlc1N1bW1hcnkubmV3KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBcImxvYWRpbmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGpvYlN0YXRlc1N1bW1hcnkuZXJyb3JlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gXCJlcnJvclwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoam9iU3RhdGVzU3VtbWFyeS50ZXJtaW5hbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gXCJva1wiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoam9iU3RhdGVzU3VtbWFyeS5ydW5uaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBcInJ1bm5pbmdcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IFwicXVldWVkXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGVsLmdldChcImpvYl9zb3VyY2VfaWRcIikpIHtcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsIHJlbmRlcmluZyAtIHBvbGxpbmcgd2lsbCBmaWxsIGluIG1vcmUgZGV0YWlscyBpbiBhIGJpdC5cbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFwibG9hZGluZ1wiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXMubW9kZWwuZ2V0KFwicG9wdWxhdGVkX3N0YXRlXCIpID8gU1RBVEVTLk9LIDogU1RBVEVTLlJVTk5JTkc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhgc3RhdGUtJHtzdGF0ZX1gKTtcbiAgICAgICAgICAgIHZhciBzdGF0ZURlc2NyaXB0aW9uID0gdGhpcy5zdGF0ZURlc2NyaXB0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLiQoXCIuc3RhdGUtZGVzY3JpcHRpb25cIikuaHRtbChzdGF0ZURlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRlbDtcbiAgICAgICAgfSxcblxuICAgICAgICBzdGF0ZURlc2NyaXB0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcy5tb2RlbDtcbiAgICAgICAgICAgIHZhciBlbGVtZW50Q291bnQgPSBjb2xsZWN0aW9uLmdldChcImVsZW1lbnRfY291bnRcIik7XG4gICAgICAgICAgICB2YXIgam9iU3RhdGVTb3VyY2UgPSBjb2xsZWN0aW9uLmdldChcImpvYl9zb3VyY2VfdHlwZVwiKTtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uVHlwZSA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGVjdGlvbl90eXBlXCIpO1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24gPSBEQ19WSUVXLmNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24oY29sbGVjdGlvbik7XG4gICAgICAgICAgICB2YXIgc2ltcGxlRGVzY3JpcHRpb24gPSBEQ19WSUVXLmNvbGxlY3Rpb25EZXNjcmlwdGlvbihjb2xsZWN0aW9uKTtcbiAgICAgICAgICAgIHZhciBqb2JTdGF0ZXNTdW1tYXJ5ID0gY29sbGVjdGlvbi5qb2JTdGF0ZXNTdW1tYXJ5O1xuICAgICAgICAgICAgaWYgKCFqb2JTdGF0ZVNvdXJjZSB8fCBqb2JTdGF0ZVNvdXJjZSA9PSBcIkpvYlwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpbXBsZURlc2NyaXB0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgham9iU3RhdGVzU3VtbWFyeSB8fCAham9iU3RhdGVzU3VtbWFyeS5oYXNEZXRhaWxzKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3Mgc3RhdGUtcHJvZ3Jlc3NcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibm90ZVwiPkxvYWRpbmcgam9iIGRhdGEgZm9yICR7Y29sbGVjdGlvblR5cGVEZXNjcmlwdGlvbn0uPHNwYW4gY2xhc3M9XCJibGlua2luZ1wiPi4uPC9zcGFuPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwcm9ncmVzcy1iYXIgaW5mb1wiIHN0eWxlPVwid2lkdGg6MTAwJVwiPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgaXNOZXcgPSBqb2JTdGF0ZXNTdW1tYXJ5Lm5ldygpO1xuICAgICAgICAgICAgICAgIHZhciBqb2JDb3VudCA9IGlzTmV3ID8gbnVsbCA6IGpvYlN0YXRlc1N1bW1hcnkuam9iQ291bnQoKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwcm9ncmVzcyBzdGF0ZS1wcm9ncmVzc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibm90ZVwiPkNyZWF0aW5nIGpvYnMuPHNwYW4gY2xhc3M9XCJibGlua2luZ1wiPi4uPC9zcGFuPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyIGluZm9cIiBzdHlsZT1cIndpZHRoOjEwMCVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqb2JTdGF0ZXNTdW1tYXJ5LmVycm9yZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JDb3VudCA9IGpvYlN0YXRlc1N1bW1hcnkubnVtSW5FcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYGEgJHtjb2xsZWN0aW9uVHlwZURlc2NyaXB0aW9ufSB3aXRoICR7ZXJyb3JDb3VudH0gLyAke2pvYkNvdW50fSBqb2JzIGluIGVycm9yYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGpvYlN0YXRlc1N1bW1hcnkudGVybWluYWwoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2ltcGxlRGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJ1bm5pbmcgPSBqb2JTdGF0ZXNTdW1tYXJ5LnN0YXRlcygpW1wicnVubmluZ1wiXSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb2sgPSBqb2JTdGF0ZXNTdW1tYXJ5LnN0YXRlcygpW1wib2tcIl0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9rUGVyY2VudCA9IG9rIC8gKGpvYkNvdW50ICogMS4wKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJ1bm5pbmdQZXJjZW50ID0gcnVubmluZyAvIChqb2JDb3VudCAqIDEuMCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvdGhlclBlcmNlbnQgPSAxLjAgLSBva1BlcmNlbnQgLSBydW5uaW5nUGVyY2VudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGpvYnNTdHIgPSBqb2JDb3VudCAmJiBqb2JDb3VudCA+IDEgPyBgJHtqb2JDb3VudH0gam9ic2AgOiBgYSBqb2JgO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInByb2dyZXNzIHN0YXRlLXByb2dyZXNzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJub3RlXCI+JHtqb2JzU3RyfSBnZW5lcmF0aW5nIGEgJHtjb2xsZWN0aW9uVHlwZURlc2NyaXB0aW9ufTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyIG9rXCIgc3R5bGU9XCJ3aWR0aDoke29rUGVyY2VudCAqIDEwMC4wfSVcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyIHJ1bm5pbmdcIiBzdHlsZT1cIndpZHRoOiR7cnVubmluZ1BlcmNlbnQgKiAxMDAuMH0lXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInByb2dyZXNzLWJhciBuZXdcIiBzdHlsZT1cIndpZHRoOiR7b3RoZXJQZXJjZW50ICogMTAwLjB9JVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBIRENBTGlzdEl0ZW1WaWV3KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkhEQ0FMaXN0SXRlbVZpZXcucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIHdhcm5pbmdzID0gXy5leHRlbmQoe30sIF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzLndhcm5pbmdzLCB7XG4gICAgICAgIGhpZGRlbjogY29sbGVjdGlvbiA9PiB7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLnZpc2libGVcbiAgICAgICAgICAgICAgICA/IFwiXCJcbiAgICAgICAgICAgICAgICA6IGA8ZGl2IGNsYXNzPVwiaGlkZGVuLW1zZyB3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JHtfbChcIlRoaXMgY29sbGVjdGlvbiBoYXMgYmVlbiBoaWRkZW5cIil9PC9kaXY+YDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgdmFyIHRpdGxlQmFyVGVtcGxhdGUgPSBjb2xsZWN0aW9uID0+IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlLWJhciBjbGVhclwiIHRhYmluZGV4PVwiMFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzdGF0ZS1pY29uXCI+PC9zcGFuPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJoaWRcIj4ke2NvbGxlY3Rpb24uaGlkfTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm5hbWVcIj4ke18uZXNjYXBlKGNvbGxlY3Rpb24ubmFtZSl9PC9zcGFuPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3RhdGUtZGVzY3JpcHRpb25cIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgJHtISVNUT1JZX0lURU1fTEkubmFtZXRhZ1RlbXBsYXRlKGNvbGxlY3Rpb24pfVxuICAgICAgICA8L2Rpdj5cbiAgICBgO1xuXG4gICAgcmV0dXJuIF8uZXh0ZW5kKHt9LCBfc3VwZXIucHJvdG90eXBlLnRlbXBsYXRlcywge1xuICAgICAgICB3YXJuaW5nczogd2FybmluZ3MsXG4gICAgICAgIHRpdGxlQmFyOiB0aXRsZUJhclRlbXBsYXRlXG4gICAgfSk7XG59KSgpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIEhEQ0FMaXN0SXRlbVZpZXc6IEhEQ0FMaXN0SXRlbVZpZXdcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRjYS1saS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXpHQTtBQUNBO0FBNEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUxBO0FBQ0E7QUFPQTtBQUFBO0FBQUE7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///42\n");

/***/ }),
/* 43 */,
/* 44 */
/*!***************************************!*\
  !*** ./galaxy/scripts/layout/page.js ***!
  \***************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _masthead = __webpack_require__(/*! layout/masthead */ 68);\n\nvar _masthead2 = _interopRequireDefault(_masthead);\n\nvar _panel = __webpack_require__(/*! layout/panel */ 43);\n\nvar _panel2 = _interopRequireDefault(_panel);\n\nvar _uiModal = __webpack_require__(/*! mvc/ui/ui-modal */ 9);\n\nvar _uiModal2 = _interopRequireDefault(_uiModal);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar View = Backbone.View.extend({\n    el: \"body\",\n    className: \"full-content\",\n    _panelids: [\"left\", \"right\"],\n\n    initialize: function initialize(options) {\n        var self = this;\n        this.config = _.defaults(options.config || {}, {\n            message_box_visible: false,\n            message_box_content: \"\",\n            message_box_class: \"info\",\n            show_inactivity_warning: false,\n            inactivity_box_content: \"\"\n        });\n\n        // attach global objects, build mastheads\n        Galaxy.modal = this.modal = new _uiModal2.default.View();\n        Galaxy.display = this.display = function (view) {\n            if (view.title) {\n                _utils2.default.setWindowTitle(view.title);\n                view.allow_title_display = false;\n            } else {\n                _utils2.default.setWindowTitle();\n                view.allow_title_display = true;\n            }\n            self.center.display(view);\n        };\n        Galaxy.router = this.router = options.Router && new options.Router(self, options);\n        this.masthead = new _masthead2.default.View(this.config);\n        this.center = new _panel2.default.CenterPanel();\n\n        // build page template\n        this.$el.attr(\"scroll\", \"no\");\n        this.$el.html(this._template());\n        this.$(\"#masthead\").replaceWith(this.masthead.$el);\n        this.$(\"#center\").append(this.center.$el);\n        this.$el.append(this.masthead.frame.$el);\n        this.$el.append(this.modal.$el);\n        this.$messagebox = this.$(\"#messagebox\");\n        this.$inactivebox = this.$(\"#inactivebox\");\n\n        // build panels\n        this.panels = {};\n        _.each(this._panelids, function (panel_id) {\n            var panel_class_name = panel_id.charAt(0).toUpperCase() + panel_id.slice(1);\n            var panel_class = options[panel_class_name];\n            if (panel_class) {\n                var panel_instance = new panel_class(self, options);\n                self[panel_instance.toString()] = panel_instance;\n                self.panels[panel_id] = new _panel2.default.SidePanel({\n                    id: panel_id,\n                    el: self.$(\"#\" + panel_id),\n                    view: panel_instance\n                });\n            }\n        });\n        this.render();\n\n        // start the router\n        if (this.router) {\n            Backbone.history.start({\n                root: Galaxy.root,\n                pushState: true\n            });\n        }\n    },\n\n    render: function render() {\n        // TODO: Remove this line after select2 update\n        $(\".select2-hidden-accessible\").remove();\n        this.masthead.render();\n        this.renderMessageBox();\n        this.renderInactivityBox();\n        this.renderPanels();\n        this._checkCommunicationServerOnline();\n        return this;\n    },\n\n    /** Render message box */\n    renderMessageBox: function renderMessageBox() {\n        if (this.config.message_box_visible) {\n            var content = this.config.message_box_content || \"\";\n            var level = this.config.message_box_class || \"info\";\n            this.$el.addClass(\"has-message-box\");\n            this.$messagebox.attr(\"class\", \"panel-\" + level + \"-message\").html(content).toggle(!!content).show();\n        } else {\n            this.$el.removeClass(\"has-message-box\");\n            this.$messagebox.hide();\n        }\n        return this;\n    },\n\n    /** Render inactivity warning */\n    renderInactivityBox: function renderInactivityBox() {\n        if (this.config.show_inactivity_warning) {\n            var content = this.config.inactivity_box_content || \"\";\n            var verificationLink = $(\"<a/>\").attr(\"href\", Galaxy.root + \"user/resend_verification\").text(\"Resend verification\");\n            this.$el.addClass(\"has-inactivity-box\");\n            this.$inactivebox.html(content + \" \").append(verificationLink).toggle(!!content).show();\n        } else {\n            this.$el.removeClass(\"has-inactivity-box\");\n            this.$inactivebox.hide();\n        }\n        return this;\n    },\n\n    /** Render panels */\n    renderPanels: function renderPanels() {\n        var self = this;\n        _.each(this._panelids, function (panel_id) {\n            var panel = self.panels[panel_id];\n            if (panel) {\n                panel.render();\n            } else {\n                self.$(\"#center\").css(panel_id, 0);\n                self.$(\"#\" + panel_id).hide();\n            }\n        });\n        return this;\n    },\n\n    /** body template */\n    _template: function _template() {\n        return ['<div id=\"everything\">', '<div id=\"background\"/>', '<div id=\"masthead\"/>', '<div id=\"messagebox\"/>', '<div id=\"inactivebox\" class=\"panel-warning-message\" />', '<div id=\"left\" />', '<div id=\"center\" />', '<div id=\"right\" />', \"</div>\", '<div id=\"dd-helper\" />'].join(\"\");\n    },\n\n    toString: function toString() {\n        return \"PageLayoutView\";\n    },\n\n    /** Check if the communication server is online and show the icon otherwise hide the icon */\n    _checkCommunicationServerOnline: function _checkCommunicationServerOnline() {\n        var host = window.Galaxy.config.communication_server_host;\n        var port = window.Galaxy.config.communication_server_port;\n        var preferences = window.Galaxy.user.attributes.preferences;\n        var $chat_icon_element = $(\"#show-chat-online\");\n        /** Check if the user has deactivated the communication in it's personal settings */\n        if (preferences && [\"1\", \"true\"].indexOf(preferences.communication_server) != -1) {\n            // See if the configured communication server is available\n            $.ajax({\n                url: host + \":\" + port\n            }).success(function (data) {\n                // enable communication only when a user is logged in\n                if (window.Galaxy.user.id !== null) {\n                    if ($chat_icon_element.css(\"visibility\") === \"hidden\") {\n                        $chat_icon_element.css(\"visibility\", \"visible\");\n                    }\n                }\n            }).error(function (data) {\n                // hide the communication icon if the communication server is not available\n                $chat_icon_element.css(\"visibility\", \"hidden\");\n            });\n        } else {\n            $chat_icon_element.css(\"visibility\", \"hidden\");\n        }\n    }\n});\n\nexports.default = { View: View };\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbGF5b3V0L3BhZ2UuanM/MDU4YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTWFzdGhlYWQgZnJvbSBcImxheW91dC9tYXN0aGVhZFwiO1xuaW1wb3J0IFBhbmVsIGZyb20gXCJsYXlvdXQvcGFuZWxcIjtcbmltcG9ydCBNb2RhbCBmcm9tIFwibXZjL3VpL3VpLW1vZGFsXCI7XG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5cbnZhciBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGVsOiBcImJvZHlcIixcbiAgICBjbGFzc05hbWU6IFwiZnVsbC1jb250ZW50XCIsXG4gICAgX3BhbmVsaWRzOiBbXCJsZWZ0XCIsIFwicmlnaHRcIl0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5jb25maWcgPSBfLmRlZmF1bHRzKG9wdGlvbnMuY29uZmlnIHx8IHt9LCB7XG4gICAgICAgICAgICBtZXNzYWdlX2JveF92aXNpYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIG1lc3NhZ2VfYm94X2NvbnRlbnQ6IFwiXCIsXG4gICAgICAgICAgICBtZXNzYWdlX2JveF9jbGFzczogXCJpbmZvXCIsXG4gICAgICAgICAgICBzaG93X2luYWN0aXZpdHlfd2FybmluZzogZmFsc2UsXG4gICAgICAgICAgICBpbmFjdGl2aXR5X2JveF9jb250ZW50OiBcIlwiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGF0dGFjaCBnbG9iYWwgb2JqZWN0cywgYnVpbGQgbWFzdGhlYWRzXG4gICAgICAgIEdhbGF4eS5tb2RhbCA9IHRoaXMubW9kYWwgPSBuZXcgTW9kYWwuVmlldygpO1xuICAgICAgICBHYWxheHkuZGlzcGxheSA9IHRoaXMuZGlzcGxheSA9IHZpZXcgPT4ge1xuICAgICAgICAgICAgaWYgKHZpZXcudGl0bGUpIHtcbiAgICAgICAgICAgICAgICBVdGlscy5zZXRXaW5kb3dUaXRsZSh2aWV3LnRpdGxlKTtcbiAgICAgICAgICAgICAgICB2aWV3LmFsbG93X3RpdGxlX2Rpc3BsYXkgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgVXRpbHMuc2V0V2luZG93VGl0bGUoKTtcbiAgICAgICAgICAgICAgICB2aWV3LmFsbG93X3RpdGxlX2Rpc3BsYXkgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5jZW50ZXIuZGlzcGxheSh2aWV3KTtcbiAgICAgICAgfTtcbiAgICAgICAgR2FsYXh5LnJvdXRlciA9IHRoaXMucm91dGVyID0gb3B0aW9ucy5Sb3V0ZXIgJiYgbmV3IG9wdGlvbnMuUm91dGVyKHNlbGYsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLm1hc3RoZWFkID0gbmV3IE1hc3RoZWFkLlZpZXcodGhpcy5jb25maWcpO1xuICAgICAgICB0aGlzLmNlbnRlciA9IG5ldyBQYW5lbC5DZW50ZXJQYW5lbCgpO1xuXG4gICAgICAgIC8vIGJ1aWxkIHBhZ2UgdGVtcGxhdGVcbiAgICAgICAgdGhpcy4kZWwuYXR0cihcInNjcm9sbFwiLCBcIm5vXCIpO1xuICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMuX3RlbXBsYXRlKCkpO1xuICAgICAgICB0aGlzLiQoXCIjbWFzdGhlYWRcIikucmVwbGFjZVdpdGgodGhpcy5tYXN0aGVhZC4kZWwpO1xuICAgICAgICB0aGlzLiQoXCIjY2VudGVyXCIpLmFwcGVuZCh0aGlzLmNlbnRlci4kZWwpO1xuICAgICAgICB0aGlzLiRlbC5hcHBlbmQodGhpcy5tYXN0aGVhZC5mcmFtZS4kZWwpO1xuICAgICAgICB0aGlzLiRlbC5hcHBlbmQodGhpcy5tb2RhbC4kZWwpO1xuICAgICAgICB0aGlzLiRtZXNzYWdlYm94ID0gdGhpcy4kKFwiI21lc3NhZ2Vib3hcIik7XG4gICAgICAgIHRoaXMuJGluYWN0aXZlYm94ID0gdGhpcy4kKFwiI2luYWN0aXZlYm94XCIpO1xuXG4gICAgICAgIC8vIGJ1aWxkIHBhbmVsc1xuICAgICAgICB0aGlzLnBhbmVscyA9IHt9O1xuICAgICAgICBfLmVhY2godGhpcy5fcGFuZWxpZHMsIHBhbmVsX2lkID0+IHtcbiAgICAgICAgICAgIHZhciBwYW5lbF9jbGFzc19uYW1lID0gcGFuZWxfaWQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwYW5lbF9pZC5zbGljZSgxKTtcbiAgICAgICAgICAgIHZhciBwYW5lbF9jbGFzcyA9IG9wdGlvbnNbcGFuZWxfY2xhc3NfbmFtZV07XG4gICAgICAgICAgICBpZiAocGFuZWxfY2xhc3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFuZWxfaW5zdGFuY2UgPSBuZXcgcGFuZWxfY2xhc3Moc2VsZiwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgc2VsZltwYW5lbF9pbnN0YW5jZS50b1N0cmluZygpXSA9IHBhbmVsX2luc3RhbmNlO1xuICAgICAgICAgICAgICAgIHNlbGYucGFuZWxzW3BhbmVsX2lkXSA9IG5ldyBQYW5lbC5TaWRlUGFuZWwoe1xuICAgICAgICAgICAgICAgICAgICBpZDogcGFuZWxfaWQsXG4gICAgICAgICAgICAgICAgICAgIGVsOiBzZWxmLiQoYCMke3BhbmVsX2lkfWApLFxuICAgICAgICAgICAgICAgICAgICB2aWV3OiBwYW5lbF9pbnN0YW5jZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcblxuICAgICAgICAvLyBzdGFydCB0aGUgcm91dGVyXG4gICAgICAgIGlmICh0aGlzLnJvdXRlcikge1xuICAgICAgICAgICAgQmFja2JvbmUuaGlzdG9yeS5zdGFydCh7XG4gICAgICAgICAgICAgICAgcm9vdDogR2FsYXh5LnJvb3QsXG4gICAgICAgICAgICAgICAgcHVzaFN0YXRlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUT0RPOiBSZW1vdmUgdGhpcyBsaW5lIGFmdGVyIHNlbGVjdDIgdXBkYXRlXG4gICAgICAgICQoXCIuc2VsZWN0Mi1oaWRkZW4tYWNjZXNzaWJsZVwiKS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5tYXN0aGVhZC5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy5yZW5kZXJNZXNzYWdlQm94KCk7XG4gICAgICAgIHRoaXMucmVuZGVySW5hY3Rpdml0eUJveCgpO1xuICAgICAgICB0aGlzLnJlbmRlclBhbmVscygpO1xuICAgICAgICB0aGlzLl9jaGVja0NvbW11bmljYXRpb25TZXJ2ZXJPbmxpbmUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgbWVzc2FnZSBib3ggKi9cbiAgICByZW5kZXJNZXNzYWdlQm94OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLm1lc3NhZ2VfYm94X3Zpc2libGUpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb25maWcubWVzc2FnZV9ib3hfY29udGVudCB8fCBcIlwiO1xuICAgICAgICAgICAgdmFyIGxldmVsID0gdGhpcy5jb25maWcubWVzc2FnZV9ib3hfY2xhc3MgfHwgXCJpbmZvXCI7XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhcImhhcy1tZXNzYWdlLWJveFwiKTtcbiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Vib3hcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIGBwYW5lbC0ke2xldmVsfS1tZXNzYWdlYClcbiAgICAgICAgICAgICAgICAuaHRtbChjb250ZW50KVxuICAgICAgICAgICAgICAgIC50b2dnbGUoISFjb250ZW50KVxuICAgICAgICAgICAgICAgIC5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiRlbC5yZW1vdmVDbGFzcyhcImhhcy1tZXNzYWdlLWJveFwiKTtcbiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Vib3guaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKiogUmVuZGVyIGluYWN0aXZpdHkgd2FybmluZyAqL1xuICAgIHJlbmRlckluYWN0aXZpdHlCb3g6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jb25maWcuc2hvd19pbmFjdGl2aXR5X3dhcm5pbmcpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb25maWcuaW5hY3Rpdml0eV9ib3hfY29udGVudCB8fCBcIlwiO1xuICAgICAgICAgICAgdmFyIHZlcmlmaWNhdGlvbkxpbmsgPSAkKFwiPGEvPlwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiaHJlZlwiLCBgJHtHYWxheHkucm9vdH11c2VyL3Jlc2VuZF92ZXJpZmljYXRpb25gKVxuICAgICAgICAgICAgICAgIC50ZXh0KFwiUmVzZW5kIHZlcmlmaWNhdGlvblwiKTtcbiAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKFwiaGFzLWluYWN0aXZpdHktYm94XCIpO1xuICAgICAgICAgICAgdGhpcy4kaW5hY3RpdmVib3hcbiAgICAgICAgICAgICAgICAuaHRtbChgJHtjb250ZW50fSBgKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQodmVyaWZpY2F0aW9uTGluaylcbiAgICAgICAgICAgICAgICAudG9nZ2xlKCEhY29udGVudClcbiAgICAgICAgICAgICAgICAuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kZWwucmVtb3ZlQ2xhc3MoXCJoYXMtaW5hY3Rpdml0eS1ib3hcIik7XG4gICAgICAgICAgICB0aGlzLiRpbmFjdGl2ZWJveC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgcGFuZWxzICovXG4gICAgcmVuZGVyUGFuZWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBfLmVhY2godGhpcy5fcGFuZWxpZHMsIHBhbmVsX2lkID0+IHtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHNlbGYucGFuZWxzW3BhbmVsX2lkXTtcbiAgICAgICAgICAgIGlmIChwYW5lbCkge1xuICAgICAgICAgICAgICAgIHBhbmVsLnJlbmRlcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLiQoXCIjY2VudGVyXCIpLmNzcyhwYW5lbF9pZCwgMCk7XG4gICAgICAgICAgICAgICAgc2VsZi4kKGAjJHtwYW5lbF9pZH1gKS5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqIGJvZHkgdGVtcGxhdGUgKi9cbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJzxkaXYgaWQ9XCJldmVyeXRoaW5nXCI+JyxcbiAgICAgICAgICAgICc8ZGl2IGlkPVwiYmFja2dyb3VuZFwiLz4nLFxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJtYXN0aGVhZFwiLz4nLFxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJtZXNzYWdlYm94XCIvPicsXG4gICAgICAgICAgICAnPGRpdiBpZD1cImluYWN0aXZlYm94XCIgY2xhc3M9XCJwYW5lbC13YXJuaW5nLW1lc3NhZ2VcIiAvPicsXG4gICAgICAgICAgICAnPGRpdiBpZD1cImxlZnRcIiAvPicsXG4gICAgICAgICAgICAnPGRpdiBpZD1cImNlbnRlclwiIC8+JyxcbiAgICAgICAgICAgICc8ZGl2IGlkPVwicmlnaHRcIiAvPicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJkZC1oZWxwZXJcIiAvPidcbiAgICAgICAgXS5qb2luKFwiXCIpO1xuICAgIH0sXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBcIlBhZ2VMYXlvdXRWaWV3XCI7XG4gICAgfSxcblxuICAgIC8qKiBDaGVjayBpZiB0aGUgY29tbXVuaWNhdGlvbiBzZXJ2ZXIgaXMgb25saW5lIGFuZCBzaG93IHRoZSBpY29uIG90aGVyd2lzZSBoaWRlIHRoZSBpY29uICovXG4gICAgX2NoZWNrQ29tbXVuaWNhdGlvblNlcnZlck9ubGluZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBob3N0ID0gd2luZG93LkdhbGF4eS5jb25maWcuY29tbXVuaWNhdGlvbl9zZXJ2ZXJfaG9zdDtcbiAgICAgICAgdmFyIHBvcnQgPSB3aW5kb3cuR2FsYXh5LmNvbmZpZy5jb21tdW5pY2F0aW9uX3NlcnZlcl9wb3J0O1xuICAgICAgICB2YXIgcHJlZmVyZW5jZXMgPSB3aW5kb3cuR2FsYXh5LnVzZXIuYXR0cmlidXRlcy5wcmVmZXJlbmNlcztcbiAgICAgICAgdmFyICRjaGF0X2ljb25fZWxlbWVudCA9ICQoXCIjc2hvdy1jaGF0LW9ubGluZVwiKTtcbiAgICAgICAgLyoqIENoZWNrIGlmIHRoZSB1c2VyIGhhcyBkZWFjdGl2YXRlZCB0aGUgY29tbXVuaWNhdGlvbiBpbiBpdCdzIHBlcnNvbmFsIHNldHRpbmdzICovXG4gICAgICAgIGlmIChwcmVmZXJlbmNlcyAmJiBbXCIxXCIsIFwidHJ1ZVwiXS5pbmRleE9mKHByZWZlcmVuY2VzLmNvbW11bmljYXRpb25fc2VydmVyKSAhPSAtMSkge1xuICAgICAgICAgICAgLy8gU2VlIGlmIHRoZSBjb25maWd1cmVkIGNvbW11bmljYXRpb24gc2VydmVyIGlzIGF2YWlsYWJsZVxuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6IGAke2hvc3R9OiR7cG9ydH1gXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbmFibGUgY29tbXVuaWNhdGlvbiBvbmx5IHdoZW4gYSB1c2VyIGlzIGxvZ2dlZCBpblxuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LkdhbGF4eS51c2VyLmlkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGNoYXRfaWNvbl9lbGVtZW50LmNzcyhcInZpc2liaWxpdHlcIikgPT09IFwiaGlkZGVuXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2hhdF9pY29uX2VsZW1lbnQuY3NzKFwidmlzaWJpbGl0eVwiLCBcInZpc2libGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSB0aGUgY29tbXVuaWNhdGlvbiBpY29uIGlmIHRoZSBjb21tdW5pY2F0aW9uIHNlcnZlciBpcyBub3QgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgICAgICRjaGF0X2ljb25fZWxlbWVudC5jc3MoXCJ2aXNpYmlsaXR5XCIsIFwiaGlkZGVuXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJGNoYXRfaWNvbl9lbGVtZW50LmNzcyhcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgeyBWaWV3OiBWaWV3IH07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbGF5b3V0L3BhZ2UuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbExBO0FBQ0E7QUFvTEE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///44\n");

/***/ }),
/* 45 */,
/* 46 */,
/* 47 */,
/* 48 */,
/* 49 */
/*!***************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-model.js ***!
  \***************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar Model = Backbone.Model.extend({\n    defaults: {\n        extension: \"auto\",\n        genome: \"?\",\n        url_paste: \"\",\n        status: \"init\",\n        info: null,\n        file_name: \"\",\n        file_mode: \"\",\n        file_size: 0,\n        file_type: null,\n        file_path: \"\",\n        file_data: null,\n        percentage: 0,\n        space_to_tab: false,\n        to_posix_lines: true,\n        enabled: true\n    },\n    reset: function reset(attr) {\n        this.clear().set(this.defaults).set(attr);\n    }\n});\nvar Collection = Backbone.Collection.extend({ model: Model });\nexports.default = { Model: Model, Collection: Collection };\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtbW9kZWwuanM/YWE3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgTW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuICAgIGRlZmF1bHRzOiB7XG4gICAgICAgIGV4dGVuc2lvbjogXCJhdXRvXCIsXG4gICAgICAgIGdlbm9tZTogXCI/XCIsXG4gICAgICAgIHVybF9wYXN0ZTogXCJcIixcbiAgICAgICAgc3RhdHVzOiBcImluaXRcIixcbiAgICAgICAgaW5mbzogbnVsbCxcbiAgICAgICAgZmlsZV9uYW1lOiBcIlwiLFxuICAgICAgICBmaWxlX21vZGU6IFwiXCIsXG4gICAgICAgIGZpbGVfc2l6ZTogMCxcbiAgICAgICAgZmlsZV90eXBlOiBudWxsLFxuICAgICAgICBmaWxlX3BhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVfZGF0YTogbnVsbCxcbiAgICAgICAgcGVyY2VudGFnZTogMCxcbiAgICAgICAgc3BhY2VfdG9fdGFiOiBmYWxzZSxcbiAgICAgICAgdG9fcG9zaXhfbGluZXM6IHRydWUsXG4gICAgICAgIGVuYWJsZWQ6IHRydWVcbiAgICB9LFxuICAgIHJlc2V0OiBmdW5jdGlvbihhdHRyKSB7XG4gICAgICAgIHRoaXMuY2xlYXIoKVxuICAgICAgICAgICAgLnNldCh0aGlzLmRlZmF1bHRzKVxuICAgICAgICAgICAgLnNldChhdHRyKTtcbiAgICB9XG59KTtcbnZhciBDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoeyBtb2RlbDogTW9kZWwgfSk7XG5leHBvcnQgZGVmYXVsdCB7IE1vZGVsOiBNb2RlbCwgQ29sbGVjdGlvbjogQ29sbGVjdGlvbiB9O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvdXBsb2FkLW1vZGVsLmpzIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBR0E7QUF0QkE7QUF3QkE7QUFDQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///49\n");

/***/ }),
/* 50 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/dataset-model.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"dataset\";\n//==============================================================================\nvar searchableMixin = _baseMvc2.default.SearchableModelMixin;\n/** @class base model for any DatasetAssociation (HDAs, LDDAs, DatasetCollectionDAs).\n *      No knowledge of what type (HDA/LDDA/DCDA) should be needed here.\n *  The DA's are made searchable (by attribute) by mixing in SearchableModelMixin.\n */\nvar DatasetAssociation = Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.mixin(searchableMixin,\n/** @lends DatasetAssociation.prototype */{\n    _logNamespace: logNamespace,\n\n    /** default attributes for a model */\n    defaults: {\n        state: _states2.default.NEW,\n        deleted: false,\n        purged: false,\n        name: \"(unnamed dataset)\",\n        accessible: true,\n        // sniffed datatype (sam, tabular, bed, etc.)\n        data_type: \"\",\n        file_ext: \"\",\n        file_size: 0,\n\n        // array of associated file types (eg. [ 'bam_index', ... ])\n        meta_files: [],\n\n        misc_blurb: \"\",\n        misc_info: \"\",\n\n        tags: []\n        // do NOT default on annotation, as this default is valid and will be passed on 'save'\n        //  which is incorrect behavior when the model is only partially fetched (annos are not passed in summary data)\n        //annotation          : ''\n    },\n\n    /** instance vars and listeners */\n    initialize: function initialize(attributes, options) {\n        this.debug(this + \"(Dataset).initialize\", attributes, options);\n\n        //!! this state is not in trans.app.model.Dataset.states - set it here -\n        if (!this.get(\"accessible\")) {\n            this.set(\"state\", _states2.default.NOT_VIEWABLE);\n        }\n\n        /** Datasets rely/use some web controllers - have the model generate those URLs on startup */\n        this.urls = this._generateUrls();\n\n        this._setUpListeners();\n    },\n\n    /** returns misc. web urls for rendering things like re-run, display, etc. */\n    _generateUrls: function _generateUrls() {\n        var id = this.get(\"id\");\n        if (!id) {\n            return {};\n        }\n        var urls = {\n            purge: \"datasets/\" + id + \"/purge_async\",\n            display: \"datasets/\" + id + \"/display/?preview=True\",\n            edit: \"datasets/edit?dataset_id=\" + id,\n            download: \"datasets/\" + id + \"/display\" + this._downloadQueryParameters(),\n            report_error: \"dataset/errors?id=\" + id,\n            rerun: \"tool_runner/rerun?id=\" + id,\n            show_params: \"datasets/\" + id + \"/show_params\",\n            visualization: \"visualization\",\n            meta_download: \"dataset/get_metadata_file?hda_id=\" + id + \"&metadata_name=\"\n        };\n        _.each(urls, function (value, key) {\n            urls[key] = Galaxy.root + value;\n        });\n        this.urls = urls;\n        return urls;\n    },\n\n    _downloadQueryParameters: function _downloadQueryParameters() {\n        return \"?to_ext=\" + this.get(\"file_ext\");\n    },\n\n    /** set up any event listeners\n     *  event: state:ready  fired when this DA moves into/is already in a ready state\n     */\n    _setUpListeners: function _setUpListeners() {\n        // if the state has changed and the new state is a ready state, fire an event\n        this.on(\"change:state\", function (currModel, newState) {\n            this.log(this + \" has changed state:\", currModel, newState);\n            if (this.inReadyState()) {\n                this.trigger(\"state:ready\", currModel, newState, this.previous(\"state\"));\n            }\n        });\n        // the download url (currently) relies on having a correct file extension\n        this.on(\"change:id change:file_ext\", function (currModel) {\n            this._generateUrls();\n        });\n    },\n\n    // ........................................................................ common queries\n    /** override to add urls */\n    toJSON: function toJSON() {\n        var json = Backbone.Model.prototype.toJSON.call(this);\n        //console.warn( 'returning json?' );\n        //return json;\n        return _.extend(json, {\n            urls: this.urls\n        });\n    },\n\n    /** Is this dataset deleted or purged? */\n    isDeletedOrPurged: function isDeletedOrPurged() {\n        return this.get(\"deleted\") || this.get(\"purged\");\n    },\n\n    /** Is this dataset in a 'ready' state; where 'Ready' states are states where no\n     *      processing (for the ds) is left to do on the server.\n     */\n    inReadyState: function inReadyState() {\n        var ready = _.contains(_states2.default.READY_STATES, this.get(\"state\"));\n        return this.isDeletedOrPurged() || ready;\n    },\n\n    /** Does this model already contain detailed data (as opposed to just summary level data)? */\n    hasDetails: function hasDetails() {\n        // if it's inaccessible assume it has everything it needs\n        if (!this.get(\"accessible\")) {\n            return true;\n        }\n        return this.has(\"annotation\");\n    },\n\n    /** Convenience function to match dataset.has_data. */\n    hasData: function hasData() {\n        return this.get(\"file_size\") > 0;\n    },\n\n    // ........................................................................ ajax\n    fetch: function fetch(options) {\n        var dataset = this;\n        return Backbone.Model.prototype.fetch.call(this, options).always(function () {\n            dataset._generateUrls();\n        });\n    },\n\n    /** override to use actual Dates objects for create/update times */\n    parse: function parse(response, options) {\n        var parsed = Backbone.Model.prototype.parse.call(this, response, options);\n        if (parsed.create_time) {\n            parsed.create_time = new Date(parsed.create_time);\n        }\n        if (parsed.update_time) {\n            parsed.update_time = new Date(parsed.update_time);\n        }\n        return parsed;\n    },\n\n    /** override to wait by default */\n    save: function save(attrs, options) {\n        options = options || {};\n        options.wait = _.isUndefined(options.wait) ? true : options.wait;\n        return Backbone.Model.prototype.save.call(this, attrs, options);\n    },\n\n    //NOTE: subclasses of DA's will need to implement url and urlRoot in order to have these work properly\n    /** save this dataset, _Mark_ing it as deleted (just a flag) */\n    delete: function _delete(options) {\n        if (this.get(\"deleted\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: true }, options);\n    },\n    /** save this dataset, _Mark_ing it as undeleted */\n    undelete: function undelete(options) {\n        if (!this.get(\"deleted\") || this.get(\"purged\")) {\n            return jQuery.when();\n        }\n        return this.save({ deleted: false }, options);\n    },\n\n    /** remove the file behind this dataset from the filesystem (if permitted) */\n    purge: function _purge(options) {\n        //TODO: use, override model.destroy, HDA.delete({ purge: true })\n        if (this.get(\"purged\")) {\n            return jQuery.when();\n        }\n        options = options || {};\n        options.url = this.urls.purge;\n\n        //TODO: ideally this would be a DELETE call to the api\n        //  using purge async for now\n        var hda = this;\n\n        var xhr = jQuery.ajax(options);\n        xhr.done(function (message, status, responseObj) {\n            hda.set({ deleted: true, purged: true });\n        });\n        xhr.fail(function (xhr, status, message) {\n            // Exception messages are hidden within error page including:  '...not allowed in this Galaxy instance.'\n            // unbury and re-add to xhr\n            var error = (0, _localization2.default)(\"Unable to purge dataset\");\n            var messageBuriedInUnfortunatelyFormattedError = \"Removal of datasets by users \" + \"is not allowed in this Galaxy instance\";\n            if (xhr.responseJSON && xhr.responseJSON.error) {\n                error = xhr.responseJSON.error;\n            } else if (xhr.responseText.indexOf(messageBuriedInUnfortunatelyFormattedError) !== -1) {\n                error = messageBuriedInUnfortunatelyFormattedError;\n            }\n            xhr.responseText = error;\n            hda.trigger(\"error\", hda, xhr, options, (0, _localization2.default)(error), {\n                error: error\n            });\n        });\n        return xhr;\n    },\n\n    // ........................................................................ searching\n    /** what attributes of an HDA will be used in a text search */\n    searchAttributes: [\"name\", \"file_ext\", \"genome_build\", \"misc_blurb\", \"misc_info\", \"annotation\", \"tags\"],\n\n    /** our attr keys don't often match the labels we display to the user - so, when using\n     *      attribute specifiers ('name=\"bler\"') in a term, allow passing in aliases for the\n     *      following attr keys.\n     */\n    searchAliases: {\n        title: \"name\",\n        format: \"file_ext\",\n        database: \"genome_build\",\n        blurb: \"misc_blurb\",\n        description: \"misc_blurb\",\n        info: \"misc_info\",\n        tag: \"tags\"\n    },\n\n    // ........................................................................ misc\n    /** String representation */\n    toString: function toString() {\n        var nameAndId = this.get(\"id\") || \"\";\n        if (this.get(\"name\")) {\n            nameAndId = \"\\\"\" + this.get(\"name\") + \"\\\",\" + nameAndId;\n        }\n        return \"Dataset(\" + nameAndId + \")\";\n    }\n}));\n\n//==============================================================================\n/** @class Backbone collection for dataset associations.\n */\nvar DatasetAssociationCollection = Backbone.Collection.extend(_baseMvc2.default.LoggableMixin).extend(\n/** @lends HistoryContents.prototype */{\n    _logNamespace: logNamespace,\n\n    model: DatasetAssociation,\n\n    /** root api url */\n    urlRoot: Galaxy.root + \"api/datasets\",\n\n    /** url fn */\n    url: function url() {\n        return this.urlRoot;\n    },\n\n    // ........................................................................ common queries\n    /** Get the ids of every item in this collection\n     *  @returns array of encoded ids\n     */\n    ids: function ids() {\n        return this.map(function (item) {\n            return item.get(\"id\");\n        });\n    },\n\n    /** Get contents that are not ready\n     *  @returns array of content models\n     */\n    notReady: function notReady() {\n        return this.filter(function (content) {\n            return !content.inReadyState();\n        });\n    },\n\n    /** return true if any datasets don't have details */\n    haveDetails: function haveDetails() {\n        return this.all(function (dataset) {\n            return dataset.hasDetails();\n        });\n    },\n\n    // ........................................................................ ajax\n    /** using a queue, perform ajaxFn on each of the models in this collection */\n    ajaxQueue: function ajaxQueue(ajaxFn, options) {\n        var deferred = jQuery.Deferred();\n        var startingLength = this.length;\n        var responses = [];\n\n        if (!startingLength) {\n            deferred.resolve([]);\n            return deferred;\n        }\n\n        // use reverse order (stylistic choice)\n        var ajaxFns = this.chain().reverse().map(function (dataset, i) {\n            return function () {\n                var xhr = ajaxFn.call(dataset, options);\n                // if successful, notify using the deferred to allow tracking progress\n                xhr.done(function (response) {\n                    deferred.notify({\n                        curr: i,\n                        total: startingLength,\n                        response: response,\n                        model: dataset\n                    });\n                });\n                // (regardless of previous error or success) if not last ajax call, shift and call the next\n                //  if last fn, resolve deferred\n                xhr.always(function (response) {\n                    responses.push(response);\n                    if (ajaxFns.length) {\n                        ajaxFns.shift()();\n                    } else {\n                        deferred.resolve(responses);\n                    }\n                });\n            };\n        }).value();\n        // start the queue\n        ajaxFns.shift()();\n\n        return deferred;\n    },\n\n    // ........................................................................ sorting/filtering\n    /** return a new collection of datasets whose attributes contain the substring matchesWhat */\n    matches: function matches(matchesWhat) {\n        return this.filter(function (dataset) {\n            return dataset.matches(matchesWhat);\n        });\n    },\n\n    /** String representation. */\n    toString: function toString() {\n        return [\"DatasetAssociationCollection(\", this.length, \")\"].join(\"\");\n    }\n});\n\n//==============================================================================\nexports.default = {\n    DatasetAssociation: DatasetAssociation,\n    DatasetAssociationCollection: DatasetAssociationCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1tb2RlbC5qcz80ZDUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTVEFURVMgZnJvbSBcIm12Yy9kYXRhc2V0L3N0YXRlc1wiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImRhdGFzZXRcIjtcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgc2VhcmNoYWJsZU1peGluID0gQkFTRV9NVkMuU2VhcmNoYWJsZU1vZGVsTWl4aW47XG4vKiogQGNsYXNzIGJhc2UgbW9kZWwgZm9yIGFueSBEYXRhc2V0QXNzb2NpYXRpb24gKEhEQXMsIExEREFzLCBEYXRhc2V0Q29sbGVjdGlvbkRBcykuXG4gKiAgICAgIE5vIGtub3dsZWRnZSBvZiB3aGF0IHR5cGUgKEhEQS9MRERBL0RDREEpIHNob3VsZCBiZSBuZWVkZWQgaGVyZS5cbiAqICBUaGUgREEncyBhcmUgbWFkZSBzZWFyY2hhYmxlIChieSBhdHRyaWJ1dGUpIGJ5IG1peGluZyBpbiBTZWFyY2hhYmxlTW9kZWxNaXhpbi5cbiAqL1xudmFyIERhdGFzZXRBc3NvY2lhdGlvbiA9IEJhY2tib25lLk1vZGVsLmV4dGVuZChCQVNFX01WQy5Mb2dnYWJsZU1peGluKS5leHRlbmQoXG4gICAgQkFTRV9NVkMubWl4aW4oXG4gICAgICAgIHNlYXJjaGFibGVNaXhpbixcbiAgICAgICAgLyoqIEBsZW5kcyBEYXRhc2V0QXNzb2NpYXRpb24ucHJvdG90eXBlICovIHtcbiAgICAgICAgICAgIF9sb2dOYW1lc3BhY2U6IGxvZ05hbWVzcGFjZSxcblxuICAgICAgICAgICAgLyoqIGRlZmF1bHQgYXR0cmlidXRlcyBmb3IgYSBtb2RlbCAqL1xuICAgICAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogU1RBVEVTLk5FVyxcbiAgICAgICAgICAgICAgICBkZWxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwdXJnZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5hbWU6IFwiKHVubmFtZWQgZGF0YXNldClcIixcbiAgICAgICAgICAgICAgICBhY2Nlc3NpYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIC8vIHNuaWZmZWQgZGF0YXR5cGUgKHNhbSwgdGFidWxhciwgYmVkLCBldGMuKVxuICAgICAgICAgICAgICAgIGRhdGFfdHlwZTogXCJcIixcbiAgICAgICAgICAgICAgICBmaWxlX2V4dDogXCJcIixcbiAgICAgICAgICAgICAgICBmaWxlX3NpemU6IDAsXG5cbiAgICAgICAgICAgICAgICAvLyBhcnJheSBvZiBhc3NvY2lhdGVkIGZpbGUgdHlwZXMgKGVnLiBbICdiYW1faW5kZXgnLCAuLi4gXSlcbiAgICAgICAgICAgICAgICBtZXRhX2ZpbGVzOiBbXSxcblxuICAgICAgICAgICAgICAgIG1pc2NfYmx1cmI6IFwiXCIsXG4gICAgICAgICAgICAgICAgbWlzY19pbmZvOiBcIlwiLFxuXG4gICAgICAgICAgICAgICAgdGFnczogW11cbiAgICAgICAgICAgICAgICAvLyBkbyBOT1QgZGVmYXVsdCBvbiBhbm5vdGF0aW9uLCBhcyB0aGlzIGRlZmF1bHQgaXMgdmFsaWQgYW5kIHdpbGwgYmUgcGFzc2VkIG9uICdzYXZlJ1xuICAgICAgICAgICAgICAgIC8vICB3aGljaCBpcyBpbmNvcnJlY3QgYmVoYXZpb3Igd2hlbiB0aGUgbW9kZWwgaXMgb25seSBwYXJ0aWFsbHkgZmV0Y2hlZCAoYW5ub3MgYXJlIG5vdCBwYXNzZWQgaW4gc3VtbWFyeSBkYXRhKVxuICAgICAgICAgICAgICAgIC8vYW5ub3RhdGlvbiAgICAgICAgICA6ICcnXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogaW5zdGFuY2UgdmFycyBhbmQgbGlzdGVuZXJzICovXG4gICAgICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhgJHt0aGlzfShEYXRhc2V0KS5pbml0aWFsaXplYCwgYXR0cmlidXRlcywgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAvLyEhIHRoaXMgc3RhdGUgaXMgbm90IGluIHRyYW5zLmFwcC5tb2RlbC5EYXRhc2V0LnN0YXRlcyAtIHNldCBpdCBoZXJlIC1cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ2V0KFwiYWNjZXNzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldChcInN0YXRlXCIsIFNUQVRFUy5OT1RfVklFV0FCTEUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKiBEYXRhc2V0cyByZWx5L3VzZSBzb21lIHdlYiBjb250cm9sbGVycyAtIGhhdmUgdGhlIG1vZGVsIGdlbmVyYXRlIHRob3NlIFVSTHMgb24gc3RhcnR1cCAqL1xuICAgICAgICAgICAgICAgIHRoaXMudXJscyA9IHRoaXMuX2dlbmVyYXRlVXJscygpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0VXBMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiByZXR1cm5zIG1pc2MuIHdlYiB1cmxzIGZvciByZW5kZXJpbmcgdGhpbmdzIGxpa2UgcmUtcnVuLCBkaXNwbGF5LCBldGMuICovXG4gICAgICAgICAgICBfZ2VuZXJhdGVVcmxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSB0aGlzLmdldChcImlkXCIpO1xuICAgICAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgdXJscyA9IHtcbiAgICAgICAgICAgICAgICAgICAgcHVyZ2U6IGBkYXRhc2V0cy8ke2lkfS9wdXJnZV9hc3luY2AsXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGBkYXRhc2V0cy8ke2lkfS9kaXNwbGF5Lz9wcmV2aWV3PVRydWVgLFxuICAgICAgICAgICAgICAgICAgICBlZGl0OiBgZGF0YXNldHMvZWRpdD9kYXRhc2V0X2lkPSR7aWR9YCxcbiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWQ6IGBkYXRhc2V0cy8ke2lkfS9kaXNwbGF5JHt0aGlzLl9kb3dubG9hZFF1ZXJ5UGFyYW1ldGVycygpfWAsXG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydF9lcnJvcjogYGRhdGFzZXQvZXJyb3JzP2lkPSR7aWR9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVydW46IGB0b29sX3J1bm5lci9yZXJ1bj9pZD0ke2lkfWAsXG4gICAgICAgICAgICAgICAgICAgIHNob3dfcGFyYW1zOiBgZGF0YXNldHMvJHtpZH0vc2hvd19wYXJhbXNgLFxuICAgICAgICAgICAgICAgICAgICB2aXN1YWxpemF0aW9uOiBcInZpc3VhbGl6YXRpb25cIixcbiAgICAgICAgICAgICAgICAgICAgbWV0YV9kb3dubG9hZDogYGRhdGFzZXQvZ2V0X21ldGFkYXRhX2ZpbGU/aGRhX2lkPSR7aWR9Jm1ldGFkYXRhX25hbWU9YFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgXy5lYWNoKHVybHMsICh2YWx1ZSwga2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHVybHNba2V5XSA9IEdhbGF4eS5yb290ICsgdmFsdWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy51cmxzID0gdXJscztcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJscztcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9kb3dubG9hZFF1ZXJ5UGFyYW1ldGVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGA/dG9fZXh0PSR7dGhpcy5nZXQoXCJmaWxlX2V4dFwiKX1gO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIHNldCB1cCBhbnkgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgICAgICAgKiAgZXZlbnQ6IHN0YXRlOnJlYWR5ICBmaXJlZCB3aGVuIHRoaXMgREEgbW92ZXMgaW50by9pcyBhbHJlYWR5IGluIGEgcmVhZHkgc3RhdGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgX3NldFVwTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgc3RhdGUgaGFzIGNoYW5nZWQgYW5kIHRoZSBuZXcgc3RhdGUgaXMgYSByZWFkeSBzdGF0ZSwgZmlyZSBhbiBldmVudFxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGFuZ2U6c3RhdGVcIiwgZnVuY3Rpb24oY3Vyck1vZGVsLCBuZXdTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgJHt0aGlzfSBoYXMgY2hhbmdlZCBzdGF0ZTpgLCBjdXJyTW9kZWwsIG5ld1N0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5SZWFkeVN0YXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInN0YXRlOnJlYWR5XCIsIGN1cnJNb2RlbCwgbmV3U3RhdGUsIHRoaXMucHJldmlvdXMoXCJzdGF0ZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyB0aGUgZG93bmxvYWQgdXJsIChjdXJyZW50bHkpIHJlbGllcyBvbiBoYXZpbmcgYSBjb3JyZWN0IGZpbGUgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTppZCBjaGFuZ2U6ZmlsZV9leHRcIiwgZnVuY3Rpb24oY3Vyck1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dlbmVyYXRlVXJscygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGNvbW1vbiBxdWVyaWVzXG4gICAgICAgICAgICAvKiogb3ZlcnJpZGUgdG8gYWRkIHVybHMgKi9cbiAgICAgICAgICAgIHRvSlNPTjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGpzb24gPSBCYWNrYm9uZS5Nb2RlbC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLndhcm4oICdyZXR1cm5pbmcganNvbj8nICk7XG4gICAgICAgICAgICAgICAgLy9yZXR1cm4ganNvbjtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5leHRlbmQoanNvbiwge1xuICAgICAgICAgICAgICAgICAgICB1cmxzOiB0aGlzLnVybHNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBJcyB0aGlzIGRhdGFzZXQgZGVsZXRlZCBvciBwdXJnZWQ/ICovXG4gICAgICAgICAgICBpc0RlbGV0ZWRPclB1cmdlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KFwiZGVsZXRlZFwiKSB8fCB0aGlzLmdldChcInB1cmdlZFwiKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBJcyB0aGlzIGRhdGFzZXQgaW4gYSAncmVhZHknIHN0YXRlOyB3aGVyZSAnUmVhZHknIHN0YXRlcyBhcmUgc3RhdGVzIHdoZXJlIG5vXG4gICAgICAgICAgICAgKiAgICAgIHByb2Nlc3NpbmcgKGZvciB0aGUgZHMpIGlzIGxlZnQgdG8gZG8gb24gdGhlIHNlcnZlci5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaW5SZWFkeVN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZHkgPSBfLmNvbnRhaW5zKFNUQVRFUy5SRUFEWV9TVEFURVMsIHRoaXMuZ2V0KFwic3RhdGVcIikpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRGVsZXRlZE9yUHVyZ2VkKCkgfHwgcmVhZHk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogRG9lcyB0aGlzIG1vZGVsIGFscmVhZHkgY29udGFpbiBkZXRhaWxlZCBkYXRhIChhcyBvcHBvc2VkIHRvIGp1c3Qgc3VtbWFyeSBsZXZlbCBkYXRhKT8gKi9cbiAgICAgICAgICAgIGhhc0RldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIC8vIGlmIGl0J3MgaW5hY2Nlc3NpYmxlIGFzc3VtZSBpdCBoYXMgZXZlcnl0aGluZyBpdCBuZWVkc1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXQoXCJhY2Nlc3NpYmxlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5oYXMoXCJhbm5vdGF0aW9uXCIpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIG1hdGNoIGRhdGFzZXQuaGFzX2RhdGEuICovXG4gICAgICAgICAgICBoYXNEYXRhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoXCJmaWxlX3NpemVcIikgPiAwO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGFqYXhcbiAgICAgICAgICAgIGZldGNoOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFzZXQgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBCYWNrYm9uZS5Nb2RlbC5wcm90b3R5cGUuZmV0Y2guY2FsbCh0aGlzLCBvcHRpb25zKS5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0Ll9nZW5lcmF0ZVVybHMoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8qKiBvdmVycmlkZSB0byB1c2UgYWN0dWFsIERhdGVzIG9iamVjdHMgZm9yIGNyZWF0ZS91cGRhdGUgdGltZXMgKi9cbiAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbihyZXNwb25zZSwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHZhciBwYXJzZWQgPSBCYWNrYm9uZS5Nb2RlbC5wcm90b3R5cGUucGFyc2UuY2FsbCh0aGlzLCByZXNwb25zZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZC5jcmVhdGVfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWQuY3JlYXRlX3RpbWUgPSBuZXcgRGF0ZShwYXJzZWQuY3JlYXRlX3RpbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocGFyc2VkLnVwZGF0ZV90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlZC51cGRhdGVfdGltZSA9IG5ldyBEYXRlKHBhcnNlZC51cGRhdGVfdGltZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvKiogb3ZlcnJpZGUgdG8gd2FpdCBieSBkZWZhdWx0ICovXG4gICAgICAgICAgICBzYXZlOiBmdW5jdGlvbihhdHRycywgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgICAgIG9wdGlvbnMud2FpdCA9IF8uaXNVbmRlZmluZWQob3B0aW9ucy53YWl0KSA/IHRydWUgOiBvcHRpb25zLndhaXQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEJhY2tib25lLk1vZGVsLnByb3RvdHlwZS5zYXZlLmNhbGwodGhpcywgYXR0cnMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy9OT1RFOiBzdWJjbGFzc2VzIG9mIERBJ3Mgd2lsbCBuZWVkIHRvIGltcGxlbWVudCB1cmwgYW5kIHVybFJvb3QgaW4gb3JkZXIgdG8gaGF2ZSB0aGVzZSB3b3JrIHByb3Blcmx5XG4gICAgICAgICAgICAvKiogc2F2ZSB0aGlzIGRhdGFzZXQsIF9NYXJrX2luZyBpdCBhcyBkZWxldGVkIChqdXN0IGEgZmxhZykgKi9cbiAgICAgICAgICAgIGRlbGV0ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldChcImRlbGV0ZWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNhdmUoeyBkZWxldGVkOiB0cnVlIH0sIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8qKiBzYXZlIHRoaXMgZGF0YXNldCwgX01hcmtfaW5nIGl0IGFzIHVuZGVsZXRlZCAqL1xuICAgICAgICAgICAgdW5kZWxldGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ2V0KFwiZGVsZXRlZFwiKSB8fCB0aGlzLmdldChcInB1cmdlZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZSh7IGRlbGV0ZWQ6IGZhbHNlIH0sIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLyoqIHJlbW92ZSB0aGUgZmlsZSBiZWhpbmQgdGhpcyBkYXRhc2V0IGZyb20gdGhlIGZpbGVzeXN0ZW0gKGlmIHBlcm1pdHRlZCkgKi9cbiAgICAgICAgICAgIHB1cmdlOiBmdW5jdGlvbiBfcHVyZ2Uob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIC8vVE9ETzogdXNlLCBvdmVycmlkZSBtb2RlbC5kZXN0cm95LCBIREEuZGVsZXRlKHsgcHVyZ2U6IHRydWUgfSlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoXCJwdXJnZWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgICAgIG9wdGlvbnMudXJsID0gdGhpcy51cmxzLnB1cmdlO1xuXG4gICAgICAgICAgICAgICAgLy9UT0RPOiBpZGVhbGx5IHRoaXMgd291bGQgYmUgYSBERUxFVEUgY2FsbCB0byB0aGUgYXBpXG4gICAgICAgICAgICAgICAgLy8gIHVzaW5nIHB1cmdlIGFzeW5jIGZvciBub3dcbiAgICAgICAgICAgICAgICB2YXIgaGRhID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHZhciB4aHIgPSBqUXVlcnkuYWpheChvcHRpb25zKTtcbiAgICAgICAgICAgICAgICB4aHIuZG9uZSgobWVzc2FnZSwgc3RhdHVzLCByZXNwb25zZU9iaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBoZGEuc2V0KHsgZGVsZXRlZDogdHJ1ZSwgcHVyZ2VkOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHhoci5mYWlsKCh4aHIsIHN0YXR1cywgbWVzc2FnZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBFeGNlcHRpb24gbWVzc2FnZXMgYXJlIGhpZGRlbiB3aXRoaW4gZXJyb3IgcGFnZSBpbmNsdWRpbmc6ICAnLi4ubm90IGFsbG93ZWQgaW4gdGhpcyBHYWxheHkgaW5zdGFuY2UuJ1xuICAgICAgICAgICAgICAgICAgICAvLyB1bmJ1cnkgYW5kIHJlLWFkZCB0byB4aHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gX2woXCJVbmFibGUgdG8gcHVyZ2UgZGF0YXNldFwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VCdXJpZWRJblVuZm9ydHVuYXRlbHlGb3JtYXR0ZWRFcnJvciA9XG4gICAgICAgICAgICAgICAgICAgICAgICBcIlJlbW92YWwgb2YgZGF0YXNldHMgYnkgdXNlcnMgXCIgKyBcImlzIG5vdCBhbGxvd2VkIGluIHRoaXMgR2FsYXh5IGluc3RhbmNlXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VKU09OICYmIHhoci5yZXNwb25zZUpTT04uZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0geGhyLnJlc3BvbnNlSlNPTi5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVzcG9uc2VUZXh0LmluZGV4T2YobWVzc2FnZUJ1cmllZEluVW5mb3J0dW5hdGVseUZvcm1hdHRlZEVycm9yKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gbWVzc2FnZUJ1cmllZEluVW5mb3J0dW5hdGVseUZvcm1hdHRlZEVycm9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHhoci5yZXNwb25zZVRleHQgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgaGRhLnRyaWdnZXIoXCJlcnJvclwiLCBoZGEsIHhociwgb3B0aW9ucywgX2woZXJyb3IpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHhocjtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBzZWFyY2hpbmdcbiAgICAgICAgICAgIC8qKiB3aGF0IGF0dHJpYnV0ZXMgb2YgYW4gSERBIHdpbGwgYmUgdXNlZCBpbiBhIHRleHQgc2VhcmNoICovXG4gICAgICAgICAgICBzZWFyY2hBdHRyaWJ1dGVzOiBbXCJuYW1lXCIsIFwiZmlsZV9leHRcIiwgXCJnZW5vbWVfYnVpbGRcIiwgXCJtaXNjX2JsdXJiXCIsIFwibWlzY19pbmZvXCIsIFwiYW5ub3RhdGlvblwiLCBcInRhZ3NcIl0sXG5cbiAgICAgICAgICAgIC8qKiBvdXIgYXR0ciBrZXlzIGRvbid0IG9mdGVuIG1hdGNoIHRoZSBsYWJlbHMgd2UgZGlzcGxheSB0byB0aGUgdXNlciAtIHNvLCB3aGVuIHVzaW5nXG4gICAgICAgICAgICAgKiAgICAgIGF0dHJpYnV0ZSBzcGVjaWZpZXJzICgnbmFtZT1cImJsZXJcIicpIGluIGEgdGVybSwgYWxsb3cgcGFzc2luZyBpbiBhbGlhc2VzIGZvciB0aGVcbiAgICAgICAgICAgICAqICAgICAgZm9sbG93aW5nIGF0dHIga2V5cy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2VhcmNoQWxpYXNlczoge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBcIm5hbWVcIixcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZmlsZV9leHRcIixcbiAgICAgICAgICAgICAgICBkYXRhYmFzZTogXCJnZW5vbWVfYnVpbGRcIixcbiAgICAgICAgICAgICAgICBibHVyYjogXCJtaXNjX2JsdXJiXCIsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwibWlzY19ibHVyYlwiLFxuICAgICAgICAgICAgICAgIGluZm86IFwibWlzY19pbmZvXCIsXG4gICAgICAgICAgICAgICAgdGFnOiBcInRhZ3NcIlxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIG1pc2NcbiAgICAgICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZUFuZElkID0gdGhpcy5nZXQoXCJpZFwiKSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldChcIm5hbWVcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZUFuZElkID0gYFwiJHt0aGlzLmdldChcIm5hbWVcIil9XCIsJHtuYW1lQW5kSWR9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGBEYXRhc2V0KCR7bmFtZUFuZElkfSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKVxuKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBAY2xhc3MgQmFja2JvbmUgY29sbGVjdGlvbiBmb3IgZGF0YXNldCBhc3NvY2lhdGlvbnMuXG4gKi9cbnZhciBEYXRhc2V0QXNzb2NpYXRpb25Db2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoQkFTRV9NVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgSGlzdG9yeUNvbnRlbnRzLnByb3RvdHlwZSAqLyB7XG4gICAgICAgIF9sb2dOYW1lc3BhY2U6IGxvZ05hbWVzcGFjZSxcblxuICAgICAgICBtb2RlbDogRGF0YXNldEFzc29jaWF0aW9uLFxuXG4gICAgICAgIC8qKiByb290IGFwaSB1cmwgKi9cbiAgICAgICAgdXJsUm9vdDogYCR7R2FsYXh5LnJvb3R9YXBpL2RhdGFzZXRzYCxcblxuICAgICAgICAvKiogdXJsIGZuICovXG4gICAgICAgIHVybDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51cmxSb290O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjb21tb24gcXVlcmllc1xuICAgICAgICAvKiogR2V0IHRoZSBpZHMgb2YgZXZlcnkgaXRlbSBpbiB0aGlzIGNvbGxlY3Rpb25cbiAgICAgICAgICogIEByZXR1cm5zIGFycmF5IG9mIGVuY29kZWQgaWRzXG4gICAgICAgICAqL1xuICAgICAgICBpZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWFwKGl0ZW0gPT4gaXRlbS5nZXQoXCJpZFwiKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEdldCBjb250ZW50cyB0aGF0IGFyZSBub3QgcmVhZHlcbiAgICAgICAgICogIEByZXR1cm5zIGFycmF5IG9mIGNvbnRlbnQgbW9kZWxzXG4gICAgICAgICAqL1xuICAgICAgICBub3RSZWFkeTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXIoY29udGVudCA9PiAhY29udGVudC5pblJlYWR5U3RhdGUoKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJldHVybiB0cnVlIGlmIGFueSBkYXRhc2V0cyBkb24ndCBoYXZlIGRldGFpbHMgKi9cbiAgICAgICAgaGF2ZURldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWxsKGRhdGFzZXQgPT4gZGF0YXNldC5oYXNEZXRhaWxzKCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBhamF4XG4gICAgICAgIC8qKiB1c2luZyBhIHF1ZXVlLCBwZXJmb3JtIGFqYXhGbiBvbiBlYWNoIG9mIHRoZSBtb2RlbHMgaW4gdGhpcyBjb2xsZWN0aW9uICovXG4gICAgICAgIGFqYXhRdWV1ZTogZnVuY3Rpb24oYWpheEZuLCBvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKTtcbiAgICAgICAgICAgIHZhciBzdGFydGluZ0xlbmd0aCA9IHRoaXMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHJlc3BvbnNlcyA9IFtdO1xuXG4gICAgICAgICAgICBpZiAoIXN0YXJ0aW5nTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShbXSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB1c2UgcmV2ZXJzZSBvcmRlciAoc3R5bGlzdGljIGNob2ljZSlcbiAgICAgICAgICAgIHZhciBhamF4Rm5zID0gdGhpcy5jaGFpbigpXG4gICAgICAgICAgICAgICAgLnJldmVyc2UoKVxuICAgICAgICAgICAgICAgIC5tYXAoKGRhdGFzZXQsIGkpID0+ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhociA9IGFqYXhGbi5jYWxsKGRhdGFzZXQsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiBzdWNjZXNzZnVsLCBub3RpZnkgdXNpbmcgdGhlIGRlZmVycmVkIHRvIGFsbG93IHRyYWNraW5nIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgICAgIHhoci5kb25lKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLm5vdGlmeSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycjogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogc3RhcnRpbmdMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBkYXRhc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIChyZWdhcmRsZXNzIG9mIHByZXZpb3VzIGVycm9yIG9yIHN1Y2Nlc3MpIGlmIG5vdCBsYXN0IGFqYXggY2FsbCwgc2hpZnQgYW5kIGNhbGwgdGhlIG5leHRcbiAgICAgICAgICAgICAgICAgICAgLy8gIGlmIGxhc3QgZm4sIHJlc29sdmUgZGVmZXJyZWRcbiAgICAgICAgICAgICAgICAgICAgeGhyLmFsd2F5cyhyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZXMucHVzaChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWpheEZucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhamF4Rm5zLnNoaWZ0KCkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShyZXNwb25zZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC52YWx1ZSgpO1xuICAgICAgICAgICAgLy8gc3RhcnQgdGhlIHF1ZXVlXG4gICAgICAgICAgICBhamF4Rm5zLnNoaWZ0KCkoKTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBzb3J0aW5nL2ZpbHRlcmluZ1xuICAgICAgICAvKiogcmV0dXJuIGEgbmV3IGNvbGxlY3Rpb24gb2YgZGF0YXNldHMgd2hvc2UgYXR0cmlidXRlcyBjb250YWluIHRoZSBzdWJzdHJpbmcgbWF0Y2hlc1doYXQgKi9cbiAgICAgICAgbWF0Y2hlczogZnVuY3Rpb24obWF0Y2hlc1doYXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihkYXRhc2V0ID0+IGRhdGFzZXQubWF0Y2hlcyhtYXRjaGVzV2hhdCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXCJEYXRhc2V0QXNzb2NpYXRpb25Db2xsZWN0aW9uKFwiLCB0aGlzLmxlbmd0aCwgXCIpXCJdLmpvaW4oXCJcIik7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIERhdGFzZXRBc3NvY2lhdGlvbjogRGF0YXNldEFzc29jaWF0aW9uLFxuICAgIERhdGFzZXRBc3NvY2lhdGlvbkNvbGxlY3Rpb246IERhdGFzZXRBc3NvY2lhdGlvbkNvbGxlY3Rpb25cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1tb2RlbC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkE7QUFDQTtBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0T0E7QUFDQTtBQTBPQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUF1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdEZBO0FBQ0E7QUF5RkE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///50\n");

/***/ }),
/* 51 */
/*!*************************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-content-model.js ***!
  \*************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar collectionFuzzyCountDefault = 1000;\ntry {\n    collectionFuzzyCountDefault = localStorage.getItem(\"collectionFuzzyCountDefault\") || collectionFuzzyCountDefault;\n} catch (err) {}\n\n//==============================================================================\n/** @class Mixin for HistoryContents content (HDAs, HDCAs).\n */\nvar HistoryContentMixin = {\n    /** default attributes for a model */\n    defaults: {\n        /** parent (containing) history */\n        history_id: null,\n        /** some content_type (HistoryContents can contain mixed model classes) */\n        history_content_type: null,\n        /** indicating when/what order the content was generated in the context of the history */\n        hid: null,\n        /** whether the user wants the content shown (visible) */\n        visible: true\n    },\n\n    // ........................................................................ mixed content element\n    // In order to be part of a MIXED bbone collection, we can't rely on the id\n    //  (which may collide btwn models of different classes)\n    // Instead, use type_id which prefixes the history_content_type so the bbone collection can differentiate\n    idAttribute: \"type_id\",\n\n    // ........................................................................ common queries\n    /** the more common alias of visible */\n    hidden: function hidden() {\n        return !this.get(\"visible\");\n    },\n\n    //TODO: remove\n    /** based on includeDeleted, includeHidden (gen. from the container control),\n     *      would this ds show in the list of ds's?\n     *  @param {Boolean} includeDeleted are we showing deleted hdas?\n     *  @param {Boolean} includeHidden are we showing hidden hdas?\n     */\n    isVisible: function isVisible(includeDeleted, includeHidden) {\n        var isVisible = true;\n        if (!includeDeleted && (this.get(\"deleted\") || this.get(\"purged\"))) {\n            isVisible = false;\n        }\n        if (!includeHidden && !this.get(\"visible\")) {\n            isVisible = false;\n        }\n        return isVisible;\n    },\n\n    // ........................................................................ ajax\n    //TODO?: these are probably better done on the leaf classes\n    /** history content goes through the 'api/histories' API */\n    urlRoot: Galaxy.root + \"api/histories/\",\n\n    /** full url spec. for this content */\n    url: function url() {\n        var historyContentType = this.get(\"history_content_type\");\n        var historyId = this.get(\"history_id\");\n        var historyContentId = this.get(\"id\");\n        var url = \"\" + this.urlRoot + historyId + \"/contents/\" + historyContentType + \"s/\" + historyContentId;\n        if (historyContentType == \"dataset_collection\") {\n            // Don't fetch whole collection - just enought to render outline. Backbone will\n            // make a detailed request if any datasets are expanded beyond that point.\n            url = url + \"?view=element-reference&fuzzy_count=\" + collectionFuzzyCountDefault;\n        }\n        return url;\n    },\n\n    /** save this content as not visible */\n    hide: function hide(options) {\n        if (!this.get(\"visible\")) {\n            return jQuery.when();\n        }\n        return this.save({ visible: false }, options);\n    },\n    /** save this content as visible */\n    unhide: function unhide(options) {\n        if (this.get(\"visible\")) {\n            return jQuery.when();\n        }\n        return this.save({ visible: true }, options);\n    },\n\n    // ........................................................................ misc\n    toString: function toString() {\n        return [this.get(\"type_id\"), this.get(\"hid\"), this.get(\"name\")].join(\":\");\n    }\n};\n\n//==============================================================================\nexports.default = {\n    HistoryContentMixin: HistoryContentMixin\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1jb250ZW50LW1vZGVsLmpzPzg1ODkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNUQVRFUyBmcm9tIFwibXZjL2RhdGFzZXQvc3RhdGVzXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcblxudmFyIGNvbGxlY3Rpb25GdXp6eUNvdW50RGVmYXVsdCA9IDEwMDA7XG50cnkge1xuICAgIGNvbGxlY3Rpb25GdXp6eUNvdW50RGVmYXVsdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY29sbGVjdGlvbkZ1enp5Q291bnREZWZhdWx0XCIpIHx8IGNvbGxlY3Rpb25GdXp6eUNvdW50RGVmYXVsdDtcbn0gY2F0Y2ggKGVycikge31cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBAY2xhc3MgTWl4aW4gZm9yIEhpc3RvcnlDb250ZW50cyBjb250ZW50IChIREFzLCBIRENBcykuXG4gKi9cbnZhciBIaXN0b3J5Q29udGVudE1peGluID0ge1xuICAgIC8qKiBkZWZhdWx0IGF0dHJpYnV0ZXMgZm9yIGEgbW9kZWwgKi9cbiAgICBkZWZhdWx0czoge1xuICAgICAgICAvKiogcGFyZW50IChjb250YWluaW5nKSBoaXN0b3J5ICovXG4gICAgICAgIGhpc3RvcnlfaWQ6IG51bGwsXG4gICAgICAgIC8qKiBzb21lIGNvbnRlbnRfdHlwZSAoSGlzdG9yeUNvbnRlbnRzIGNhbiBjb250YWluIG1peGVkIG1vZGVsIGNsYXNzZXMpICovXG4gICAgICAgIGhpc3RvcnlfY29udGVudF90eXBlOiBudWxsLFxuICAgICAgICAvKiogaW5kaWNhdGluZyB3aGVuL3doYXQgb3JkZXIgdGhlIGNvbnRlbnQgd2FzIGdlbmVyYXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgaGlzdG9yeSAqL1xuICAgICAgICBoaWQ6IG51bGwsXG4gICAgICAgIC8qKiB3aGV0aGVyIHRoZSB1c2VyIHdhbnRzIHRoZSBjb250ZW50IHNob3duICh2aXNpYmxlKSAqL1xuICAgICAgICB2aXNpYmxlOiB0cnVlXG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXhlZCBjb250ZW50IGVsZW1lbnRcbiAgICAvLyBJbiBvcmRlciB0byBiZSBwYXJ0IG9mIGEgTUlYRUQgYmJvbmUgY29sbGVjdGlvbiwgd2UgY2FuJ3QgcmVseSBvbiB0aGUgaWRcbiAgICAvLyAgKHdoaWNoIG1heSBjb2xsaWRlIGJ0d24gbW9kZWxzIG9mIGRpZmZlcmVudCBjbGFzc2VzKVxuICAgIC8vIEluc3RlYWQsIHVzZSB0eXBlX2lkIHdoaWNoIHByZWZpeGVzIHRoZSBoaXN0b3J5X2NvbnRlbnRfdHlwZSBzbyB0aGUgYmJvbmUgY29sbGVjdGlvbiBjYW4gZGlmZmVyZW50aWF0ZVxuICAgIGlkQXR0cmlidXRlOiBcInR5cGVfaWRcIixcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjb21tb24gcXVlcmllc1xuICAgIC8qKiB0aGUgbW9yZSBjb21tb24gYWxpYXMgb2YgdmlzaWJsZSAqL1xuICAgIGhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5nZXQoXCJ2aXNpYmxlXCIpO1xuICAgIH0sXG5cbiAgICAvL1RPRE86IHJlbW92ZVxuICAgIC8qKiBiYXNlZCBvbiBpbmNsdWRlRGVsZXRlZCwgaW5jbHVkZUhpZGRlbiAoZ2VuLiBmcm9tIHRoZSBjb250YWluZXIgY29udHJvbCksXG4gICAgICogICAgICB3b3VsZCB0aGlzIGRzIHNob3cgaW4gdGhlIGxpc3Qgb2YgZHMncz9cbiAgICAgKiAgQHBhcmFtIHtCb29sZWFufSBpbmNsdWRlRGVsZXRlZCBhcmUgd2Ugc2hvd2luZyBkZWxldGVkIGhkYXM/XG4gICAgICogIEBwYXJhbSB7Qm9vbGVhbn0gaW5jbHVkZUhpZGRlbiBhcmUgd2Ugc2hvd2luZyBoaWRkZW4gaGRhcz9cbiAgICAgKi9cbiAgICBpc1Zpc2libGU6IGZ1bmN0aW9uKGluY2x1ZGVEZWxldGVkLCBpbmNsdWRlSGlkZGVuKSB7XG4gICAgICAgIHZhciBpc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICBpZiAoIWluY2x1ZGVEZWxldGVkICYmICh0aGlzLmdldChcImRlbGV0ZWRcIikgfHwgdGhpcy5nZXQoXCJwdXJnZWRcIikpKSB7XG4gICAgICAgICAgICBpc1Zpc2libGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWluY2x1ZGVIaWRkZW4gJiYgIXRoaXMuZ2V0KFwidmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgaXNWaXNpYmxlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzVmlzaWJsZTtcbiAgICB9LFxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGFqYXhcbiAgICAvL1RPRE8/OiB0aGVzZSBhcmUgcHJvYmFibHkgYmV0dGVyIGRvbmUgb24gdGhlIGxlYWYgY2xhc3Nlc1xuICAgIC8qKiBoaXN0b3J5IGNvbnRlbnQgZ29lcyB0aHJvdWdoIHRoZSAnYXBpL2hpc3RvcmllcycgQVBJICovXG4gICAgdXJsUm9vdDogYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllcy9gLFxuXG4gICAgLyoqIGZ1bGwgdXJsIHNwZWMuIGZvciB0aGlzIGNvbnRlbnQgKi9cbiAgICB1cmw6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaGlzdG9yeUNvbnRlbnRUeXBlID0gdGhpcy5nZXQoXCJoaXN0b3J5X2NvbnRlbnRfdHlwZVwiKTtcbiAgICAgICAgdmFyIGhpc3RvcnlJZCA9IHRoaXMuZ2V0KFwiaGlzdG9yeV9pZFwiKTtcbiAgICAgICAgdmFyIGhpc3RvcnlDb250ZW50SWQgPSB0aGlzLmdldChcImlkXCIpO1xuICAgICAgICB2YXIgdXJsID0gYCR7dGhpcy51cmxSb290fSR7aGlzdG9yeUlkfS9jb250ZW50cy8ke2hpc3RvcnlDb250ZW50VHlwZX1zLyR7aGlzdG9yeUNvbnRlbnRJZH1gO1xuICAgICAgICBpZiAoaGlzdG9yeUNvbnRlbnRUeXBlID09IFwiZGF0YXNldF9jb2xsZWN0aW9uXCIpIHtcbiAgICAgICAgICAgIC8vIERvbid0IGZldGNoIHdob2xlIGNvbGxlY3Rpb24gLSBqdXN0IGVub3VnaHQgdG8gcmVuZGVyIG91dGxpbmUuIEJhY2tib25lIHdpbGxcbiAgICAgICAgICAgIC8vIG1ha2UgYSBkZXRhaWxlZCByZXF1ZXN0IGlmIGFueSBkYXRhc2V0cyBhcmUgZXhwYW5kZWQgYmV5b25kIHRoYXQgcG9pbnQuXG4gICAgICAgICAgICB1cmwgPSBgJHt1cmx9P3ZpZXc9ZWxlbWVudC1yZWZlcmVuY2UmZnV6enlfY291bnQ9JHtjb2xsZWN0aW9uRnV6enlDb3VudERlZmF1bHR9YDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG5cbiAgICAvKiogc2F2ZSB0aGlzIGNvbnRlbnQgYXMgbm90IHZpc2libGUgKi9cbiAgICBoaWRlOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIGlmICghdGhpcy5nZXQoXCJ2aXNpYmxlXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zYXZlKHsgdmlzaWJsZTogZmFsc2UgfSwgb3B0aW9ucyk7XG4gICAgfSxcbiAgICAvKiogc2F2ZSB0aGlzIGNvbnRlbnQgYXMgdmlzaWJsZSAqL1xuICAgIHVuaGlkZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBpZiAodGhpcy5nZXQoXCJ2aXNpYmxlXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zYXZlKHsgdmlzaWJsZTogdHJ1ZSB9LCBvcHRpb25zKTtcbiAgICB9LFxuXG4gICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIG1pc2NcbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5nZXQoXCJ0eXBlX2lkXCIpLCB0aGlzLmdldChcImhpZFwiKSwgdGhpcy5nZXQoXCJuYW1lXCIpXS5qb2luKFwiOlwiKTtcbiAgICB9XG59O1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIEhpc3RvcnlDb250ZW50TWl4aW46IEhpc3RvcnlDb250ZW50TWl4aW5cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1jb250ZW50LW1vZGVsLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQS9FQTtBQUNBO0FBaUZBO0FBQ0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///51\n");

/***/ }),
/* 52 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/base-creator.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/* For presentation-related functionality shared across collection creators.\n   Particularily overlapping functionality related to name processing and help.\n*/\nvar CollectionCreatorMixin = {\n    /** add (or clear if clear is truthy) a validation warning to the DOM element described in what */\n    _validationWarning: function _validationWarning(what, clear) {\n        var VALIDATION_CLASS = \"validation-warning\";\n        if (what === \"name\") {\n            what = this.$(\".collection-name\").add(this.$(\".collection-name-prompt\"));\n            this.$(\".collection-name\").focus().select();\n        }\n        if (clear) {\n            what = what || this.$(\".\" + VALIDATION_CLASS);\n            what.removeClass(VALIDATION_CLASS);\n        } else {\n            what.addClass(VALIDATION_CLASS);\n        }\n    },\n\n    _changeHideOriginals: function _changeHideOriginals(ev) {\n        this.hideOriginals = this.$(\".hide-originals\").prop(\"checked\");\n    },\n\n    // ........................................................................ footer\n    /** handle a collection name change */\n    _changeName: function _changeName(ev) {\n        this._validationWarning(\"name\", !!this._getName());\n    },\n\n    /** check for enter key press when in the collection name and submit */\n    _nameCheckForEnter: function _nameCheckForEnter(ev) {\n        if (ev.keyCode === 13 && !this.blocking) {\n            this._clickCreate();\n        }\n    },\n\n    /** get the current collection name */\n    _getName: function _getName() {\n        return _.escape(this.$(\".collection-name\").val());\n    },\n\n    // ........................................................................ header\n    /** expand help */\n    _clickMoreHelp: function _clickMoreHelp(ev) {\n        ev.stopPropagation();\n        this.$(\".main-help\").addClass(\"expanded\");\n        this.$(\".more-help\").hide();\n    },\n    /** collapse help */\n    _clickLessHelp: function _clickLessHelp(ev) {\n        ev.stopPropagation();\n        this.$(\".main-help\").removeClass(\"expanded\");\n        this.$(\".more-help\").show();\n    },\n    /** toggle help */\n    _toggleHelp: function _toggleHelp(ev) {\n        ev.stopPropagation();\n        this.$(\".main-help\").toggleClass(\"expanded\");\n        this.$(\".more-help\").toggle();\n    },\n\n    /** show an alert on the top of the interface containing message (alertClass is bootstrap's alert-*) */\n    _showAlert: function _showAlert(message, alertClass) {\n        alertClass = alertClass || \"alert-danger\";\n        this.$(\".main-help\").hide();\n        this.$(\".header .alert\").attr(\"class\", \"alert alert-dismissable\").addClass(alertClass).show().find(\".alert-message\").html(message);\n    },\n    /** hide the alerts at the top */\n    _hideAlert: function _hideAlert(message) {\n        this.$(\".main-help\").show();\n        this.$(\".header .alert\").hide();\n    },\n\n    _cancelCreate: function _cancelCreate(ev) {\n        if (typeof this.oncancel === \"function\") {\n            this.oncancel.call(this);\n        }\n    },\n\n    /** attempt to create the current collection */\n    _clickCreate: function _clickCreate(ev) {\n        var name = this._getName();\n        if (!name) {\n            this._validationWarning(\"name\");\n        } else if (!this.blocking) {\n            this.createList(name);\n        }\n    },\n\n    _setUpCommonSettings: function _setUpCommonSettings(attributes) {\n        this.hideOriginals = attributes.defaultHideSourceItems || false;\n    },\n\n    /** render the footer, completion controls, and cancel controls */\n    _renderFooter: function _renderFooter(speed, callback) {\n        var self = this;\n        var $footer = this.$(\".footer\").empty().html(this.templates.footer());\n        _.each(this.footerSettings, function (property, selector) {\n            self.$(selector).prop(\"checked\", self[property]);\n        });\n        if (typeof this.oncancel === \"function\") {\n            this.$(\".cancel-create.btn\").show();\n        }\n        return $footer;\n    },\n\n    _creatorTemplates: {\n        main: _.template(['<div class=\"header flex-row no-flex\"></div>', '<div class=\"middle flex-row flex-row-container\"></div>', '<div class=\"footer flex-row no-flex\"></div>'].join(\"\"))\n    }\n};\n\n//==============================================================================\nexports.default = {\n    CollectionCreatorMixin: CollectionCreatorMixin\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vYmFzZS1jcmVhdG9yLmpzPzUxMzkiXSwic291cmNlc0NvbnRlbnQiOlsiLyogRm9yIHByZXNlbnRhdGlvbi1yZWxhdGVkIGZ1bmN0aW9uYWxpdHkgc2hhcmVkIGFjcm9zcyBjb2xsZWN0aW9uIGNyZWF0b3JzLlxuICAgUGFydGljdWxhcmlseSBvdmVybGFwcGluZyBmdW5jdGlvbmFsaXR5IHJlbGF0ZWQgdG8gbmFtZSBwcm9jZXNzaW5nIGFuZCBoZWxwLlxuKi9cbnZhciBDb2xsZWN0aW9uQ3JlYXRvck1peGluID0ge1xuICAgIC8qKiBhZGQgKG9yIGNsZWFyIGlmIGNsZWFyIGlzIHRydXRoeSkgYSB2YWxpZGF0aW9uIHdhcm5pbmcgdG8gdGhlIERPTSBlbGVtZW50IGRlc2NyaWJlZCBpbiB3aGF0ICovXG4gICAgX3ZhbGlkYXRpb25XYXJuaW5nOiBmdW5jdGlvbih3aGF0LCBjbGVhcikge1xuICAgICAgICB2YXIgVkFMSURBVElPTl9DTEFTUyA9IFwidmFsaWRhdGlvbi13YXJuaW5nXCI7XG4gICAgICAgIGlmICh3aGF0ID09PSBcIm5hbWVcIikge1xuICAgICAgICAgICAgd2hhdCA9IHRoaXMuJChcIi5jb2xsZWN0aW9uLW5hbWVcIikuYWRkKHRoaXMuJChcIi5jb2xsZWN0aW9uLW5hbWUtcHJvbXB0XCIpKTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5jb2xsZWN0aW9uLW5hbWVcIilcbiAgICAgICAgICAgICAgICAuZm9jdXMoKVxuICAgICAgICAgICAgICAgIC5zZWxlY3QoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xlYXIpIHtcbiAgICAgICAgICAgIHdoYXQgPSB3aGF0IHx8IHRoaXMuJChgLiR7VkFMSURBVElPTl9DTEFTU31gKTtcbiAgICAgICAgICAgIHdoYXQucmVtb3ZlQ2xhc3MoVkFMSURBVElPTl9DTEFTUyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3aGF0LmFkZENsYXNzKFZBTElEQVRJT05fQ0xBU1MpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIF9jaGFuZ2VIaWRlT3JpZ2luYWxzOiBmdW5jdGlvbihldikge1xuICAgICAgICB0aGlzLmhpZGVPcmlnaW5hbHMgPSB0aGlzLiQoXCIuaGlkZS1vcmlnaW5hbHNcIikucHJvcChcImNoZWNrZWRcIik7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBmb290ZXJcbiAgICAvKiogaGFuZGxlIGEgY29sbGVjdGlvbiBuYW1lIGNoYW5nZSAqL1xuICAgIF9jaGFuZ2VOYW1lOiBmdW5jdGlvbihldikge1xuICAgICAgICB0aGlzLl92YWxpZGF0aW9uV2FybmluZyhcIm5hbWVcIiwgISF0aGlzLl9nZXROYW1lKCkpO1xuICAgIH0sXG5cbiAgICAvKiogY2hlY2sgZm9yIGVudGVyIGtleSBwcmVzcyB3aGVuIGluIHRoZSBjb2xsZWN0aW9uIG5hbWUgYW5kIHN1Ym1pdCAqL1xuICAgIF9uYW1lQ2hlY2tGb3JFbnRlcjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgaWYgKGV2LmtleUNvZGUgPT09IDEzICYmICF0aGlzLmJsb2NraW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGlja0NyZWF0ZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBnZXQgdGhlIGN1cnJlbnQgY29sbGVjdGlvbiBuYW1lICovXG4gICAgX2dldE5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXy5lc2NhcGUodGhpcy4kKFwiLmNvbGxlY3Rpb24tbmFtZVwiKS52YWwoKSk7XG4gICAgfSxcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBoZWFkZXJcbiAgICAvKiogZXhwYW5kIGhlbHAgKi9cbiAgICBfY2xpY2tNb3JlSGVscDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMuJChcIi5tYWluLWhlbHBcIikuYWRkQ2xhc3MoXCJleHBhbmRlZFwiKTtcbiAgICAgICAgdGhpcy4kKFwiLm1vcmUtaGVscFwiKS5oaWRlKCk7XG4gICAgfSxcbiAgICAvKiogY29sbGFwc2UgaGVscCAqL1xuICAgIF9jbGlja0xlc3NIZWxwOiBmdW5jdGlvbihldikge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy4kKFwiLm1haW4taGVscFwiKS5yZW1vdmVDbGFzcyhcImV4cGFuZGVkXCIpO1xuICAgICAgICB0aGlzLiQoXCIubW9yZS1oZWxwXCIpLnNob3coKTtcbiAgICB9LFxuICAgIC8qKiB0b2dnbGUgaGVscCAqL1xuICAgIF90b2dnbGVIZWxwOiBmdW5jdGlvbihldikge1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy4kKFwiLm1haW4taGVscFwiKS50b2dnbGVDbGFzcyhcImV4cGFuZGVkXCIpO1xuICAgICAgICB0aGlzLiQoXCIubW9yZS1oZWxwXCIpLnRvZ2dsZSgpO1xuICAgIH0sXG5cbiAgICAvKiogc2hvdyBhbiBhbGVydCBvbiB0aGUgdG9wIG9mIHRoZSBpbnRlcmZhY2UgY29udGFpbmluZyBtZXNzYWdlIChhbGVydENsYXNzIGlzIGJvb3RzdHJhcCdzIGFsZXJ0LSopICovXG4gICAgX3Nob3dBbGVydDogZnVuY3Rpb24obWVzc2FnZSwgYWxlcnRDbGFzcykge1xuICAgICAgICBhbGVydENsYXNzID0gYWxlcnRDbGFzcyB8fCBcImFsZXJ0LWRhbmdlclwiO1xuICAgICAgICB0aGlzLiQoXCIubWFpbi1oZWxwXCIpLmhpZGUoKTtcbiAgICAgICAgdGhpcy4kKFwiLmhlYWRlciAuYWxlcnRcIilcbiAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbGVydCBhbGVydC1kaXNtaXNzYWJsZVwiKVxuICAgICAgICAgICAgLmFkZENsYXNzKGFsZXJ0Q2xhc3MpXG4gICAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgICAuZmluZChcIi5hbGVydC1tZXNzYWdlXCIpXG4gICAgICAgICAgICAuaHRtbChtZXNzYWdlKTtcbiAgICB9LFxuICAgIC8qKiBoaWRlIHRoZSBhbGVydHMgYXQgdGhlIHRvcCAqL1xuICAgIF9oaWRlQWxlcnQ6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgdGhpcy4kKFwiLm1haW4taGVscFwiKS5zaG93KCk7XG4gICAgICAgIHRoaXMuJChcIi5oZWFkZXIgLmFsZXJ0XCIpLmhpZGUoKTtcbiAgICB9LFxuXG4gICAgX2NhbmNlbENyZWF0ZTogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9uY2FuY2VsID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRoaXMub25jYW5jZWwuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogYXR0ZW1wdCB0byBjcmVhdGUgdGhlIGN1cnJlbnQgY29sbGVjdGlvbiAqL1xuICAgIF9jbGlja0NyZWF0ZTogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLl9nZXROYW1lKCk7XG4gICAgICAgIGlmICghbmFtZSkge1xuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGlvbldhcm5pbmcoXCJuYW1lXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmJsb2NraW5nKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpc3QobmFtZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgX3NldFVwQ29tbW9uU2V0dGluZ3M6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdGhpcy5oaWRlT3JpZ2luYWxzID0gYXR0cmlidXRlcy5kZWZhdWx0SGlkZVNvdXJjZUl0ZW1zIHx8IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvKiogcmVuZGVyIHRoZSBmb290ZXIsIGNvbXBsZXRpb24gY29udHJvbHMsIGFuZCBjYW5jZWwgY29udHJvbHMgKi9cbiAgICBfcmVuZGVyRm9vdGVyOiBmdW5jdGlvbihzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgJGZvb3RlciA9IHRoaXMuJChcIi5mb290ZXJcIilcbiAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAuaHRtbCh0aGlzLnRlbXBsYXRlcy5mb290ZXIoKSk7XG4gICAgICAgIF8uZWFjaCh0aGlzLmZvb3RlclNldHRpbmdzLCAocHJvcGVydHksIHNlbGVjdG9yKSA9PiB7XG4gICAgICAgICAgICBzZWxmLiQoc2VsZWN0b3IpLnByb3AoXCJjaGVja2VkXCIsIHNlbGZbcHJvcGVydHldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5vbmNhbmNlbCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aGlzLiQoXCIuY2FuY2VsLWNyZWF0ZS5idG5cIikuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkZm9vdGVyO1xuICAgIH0sXG5cbiAgICBfY3JlYXRvclRlbXBsYXRlczoge1xuICAgICAgICBtYWluOiBfLnRlbXBsYXRlKFxuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGVhZGVyIGZsZXgtcm93IG5vLWZsZXhcIj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibWlkZGxlIGZsZXgtcm93IGZsZXgtcm93LWNvbnRhaW5lclwiPjwvZGl2PicsXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmb290ZXIgZmxleC1yb3cgbm8tZmxleFwiPjwvZGl2PidcbiAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICApXG4gICAgfVxufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBDb2xsZWN0aW9uQ3JlYXRvck1peGluOiBDb2xsZWN0aW9uQ3JlYXRvck1peGluXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9jb2xsZWN0aW9uL2Jhc2UtY3JlYXRvci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFoSEE7QUFDQTtBQTBIQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///52\n");

/***/ }),
/* 53 */
/*!**********************************************!*\
  !*** ./galaxy/scripts/utils/natural-sort.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n// Alphanumeric/natural sort fn\nfunction naturalSort(a, b) {\n    // setup temp-scope variables for comparison evauluation\n    var re = /(-?[0-9\\.]+)/g;\n\n    var x = a.toString().toLowerCase() || \"\";\n    var y = b.toString().toLowerCase() || \"\";\n    var nC = String.fromCharCode(0);\n    var xN = x.replace(re, nC + \"$1\" + nC).split(nC);\n    var yN = y.replace(re, nC + \"$1\" + nC).split(nC);\n    var xD = new Date(x).getTime();\n    var yD = xD ? new Date(y).getTime() : null;\n    // natural sorting of dates\n    if (yD) {\n        if (xD < yD) {\n            return -1;\n        } else if (xD > yD) {\n            return 1;\n        }\n    }\n\n    // natural sorting through split numeric strings and default strings\n    var oFxNcL;\n\n    var oFyNcL;\n    for (var cLoc = 0, numS = Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {\n        oFxNcL = parseFloat(xN[cLoc]) || xN[cLoc];\n        oFyNcL = parseFloat(yN[cLoc]) || yN[cLoc];\n        if (oFxNcL < oFyNcL) {\n            return -1;\n        } else if (oFxNcL > oFyNcL) {\n            return 1;\n        }\n    }\n    return 0;\n}\n\nexports.default = naturalSort;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdXRpbHMvbmF0dXJhbC1zb3J0LmpzPzQzMmEiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQWxwaGFudW1lcmljL25hdHVyYWwgc29ydCBmblxuZnVuY3Rpb24gbmF0dXJhbFNvcnQoYSwgYikge1xuICAgIC8vIHNldHVwIHRlbXAtc2NvcGUgdmFyaWFibGVzIGZvciBjb21wYXJpc29uIGV2YXVsdWF0aW9uXG4gICAgdmFyIHJlID0gLygtP1swLTlcXC5dKykvZztcblxuICAgIHZhciB4ID0gYS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkgfHwgXCJcIjtcbiAgICB2YXIgeSA9IGIudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpIHx8IFwiXCI7XG4gICAgdmFyIG5DID0gU3RyaW5nLmZyb21DaGFyQ29kZSgwKTtcbiAgICB2YXIgeE4gPSB4LnJlcGxhY2UocmUsIGAke25DfSQxJHtuQ31gKS5zcGxpdChuQyk7XG4gICAgdmFyIHlOID0geS5yZXBsYWNlKHJlLCBgJHtuQ30kMSR7bkN9YCkuc3BsaXQobkMpO1xuICAgIHZhciB4RCA9IG5ldyBEYXRlKHgpLmdldFRpbWUoKTtcbiAgICB2YXIgeUQgPSB4RCA/IG5ldyBEYXRlKHkpLmdldFRpbWUoKSA6IG51bGw7XG4gICAgLy8gbmF0dXJhbCBzb3J0aW5nIG9mIGRhdGVzXG4gICAgaWYgKHlEKSB7XG4gICAgICAgIGlmICh4RCA8IHlEKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH0gZWxzZSBpZiAoeEQgPiB5RCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBuYXR1cmFsIHNvcnRpbmcgdGhyb3VnaCBzcGxpdCBudW1lcmljIHN0cmluZ3MgYW5kIGRlZmF1bHQgc3RyaW5nc1xuICAgIHZhciBvRnhOY0w7XG5cbiAgICB2YXIgb0Z5TmNMO1xuICAgIGZvciAodmFyIGNMb2MgPSAwLCBudW1TID0gTWF0aC5tYXgoeE4ubGVuZ3RoLCB5Ti5sZW5ndGgpOyBjTG9jIDwgbnVtUzsgY0xvYysrKSB7XG4gICAgICAgIG9GeE5jTCA9IHBhcnNlRmxvYXQoeE5bY0xvY10pIHx8IHhOW2NMb2NdO1xuICAgICAgICBvRnlOY0wgPSBwYXJzZUZsb2F0KHlOW2NMb2NdKSB8fCB5TltjTG9jXTtcbiAgICAgICAgaWYgKG9GeE5jTCA8IG9GeU5jTCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9IGVsc2UgaWYgKG9GeE5jTCA+IG9GeU5jTCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5hdHVyYWxTb3J0O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL3V0aWxzL25hdHVyYWwtc29ydC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///53\n");

/***/ }),
/* 54 */
/*!*********************************************!*\
  !*** ./galaxy/scripts/ui/hoverhighlight.js ***!
  \*********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _jquery = __webpack_require__(/*! jquery */ 0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\"use_strict\";\n\nvar $ = _jquery2.default;\n//=============================================================================\n\n_jquery2.default.fn.extend({\n    hoverhighlight: function $hoverhighlight(scope, color) {\n        scope = scope || \"body\";\n        if (!this.length) {\n            return this;\n        }\n\n        $(this).each(function () {\n            var $this = $(this);\n            var targetSelector = $this.data(\"target\");\n\n            if (targetSelector) {\n                $this.mouseover(function (ev) {\n                    $(targetSelector, scope).css({\n                        background: color\n                    });\n                }).mouseout(function (ev) {\n                    $(targetSelector).css({\n                        background: \"\"\n                    });\n                });\n            }\n        });\n        return this;\n    }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdWkvaG92ZXJoaWdobGlnaHQuanM/MWI4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgalF1ZXJ5IGZyb20gXCJqcXVlcnlcIjtcbihcInVzZV9zdHJpY3RcIik7XG5cbnZhciAkID0galF1ZXJ5O1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5qUXVlcnkuZm4uZXh0ZW5kKHtcbiAgICBob3ZlcmhpZ2hsaWdodDogZnVuY3Rpb24gJGhvdmVyaGlnaGxpZ2h0KHNjb3BlLCBjb2xvcikge1xuICAgICAgICBzY29wZSA9IHNjb3BlIHx8IFwiYm9keVwiO1xuICAgICAgICBpZiAoIXRoaXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgICQodGhpcykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0U2VsZWN0b3IgPSAkdGhpcy5kYXRhKFwidGFyZ2V0XCIpO1xuXG4gICAgICAgICAgICBpZiAodGFyZ2V0U2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAkdGhpc1xuICAgICAgICAgICAgICAgICAgICAubW91c2VvdmVyKGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGFyZ2V0U2VsZWN0b3IsIHNjb3BlKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IGNvbG9yXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLm1vdXNlb3V0KGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGFyZ2V0U2VsZWN0b3IpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvdWkvaG92ZXJoaWdobGlnaHQuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQkEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///54\n");

/***/ }),
/* 55 */
/*!***************************************************!*\
  !*** ./galaxy/scripts/mvc/history/copy-dialog.js ***!
  \***************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, jQuery, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _uiModal = __webpack_require__(/*! mvc/ui/ui-modal */ 9);\n\nvar _uiModal2 = _interopRequireDefault(_uiModal);\n\nvar _errorModal = __webpack_require__(/*! mvc/ui/error-modal */ 37);\n\nvar _errorModal2 = _interopRequireDefault(_errorModal);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\n/**\n * A dialog/modal that allows copying a user history or 'importing' from user\n * another. Generally called via historyCopyDialog below.\n * @type {Object}\n */\nvar CopyDialog = {\n    // language related strings/fns\n    defaultName: _.template(\"Copy of '<%- name %>'\"),\n    title: _.template((0, _localization2.default)(\"Copying history\") + \" \\\"<%- name %>\\\"\"),\n    submitLabel: (0, _localization2.default)(\"Copy\"),\n    errorMessage: (0, _localization2.default)(\"History could not be copied.\"),\n    progressive: (0, _localization2.default)(\"Copying history\"),\n    activeLabel: (0, _localization2.default)(\"Copy only the active, non-deleted datasets\"),\n    allLabel: (0, _localization2.default)(\"Copy all datasets including deleted ones\"),\n    anonWarning: (0, _localization2.default)(\"As an anonymous user, unless you login or register, you will lose your current history \") + (0, _localization2.default)(\"after copying this history. \"),\n\n    // template for modal body\n    _template: _.template([\n    //TODO: remove inline styles\n    // show a warning message for losing current to anon users\n    \"<% if( isAnon ){ %>\", '<div class=\"warningmessage\">', \"<%- anonWarning %>\", (0, _localization2.default)(\"You can\"), ' <a href=\"/user/login\">', (0, _localization2.default)(\"login here\"), \"</a> \", (0, _localization2.default)(\"or\"), \" \", ' <a href=\"/user/create\">', (0, _localization2.default)(\"register here\"), \"</a>.\", \"</div>\", \"<% } %>\", \"<form>\", '<label for=\"copy-modal-title\">', (0, _localization2.default)(\"Enter a title for the new history\"), \":\", \"</label><br />\",\n    // TODO: could use required here and the form validators\n    // NOTE: use unescaped here if escaped in the modal function below\n    '<input id=\"copy-modal-title\" class=\"form-control\" style=\"width: 100%\" value=\"<%= name %>\" />', '<p class=\"invalid-title bg-danger\" style=\"color: red; margin: 8px 0px 8px 0px; display: none\">', (0, _localization2.default)(\"Please enter a valid history title\"), \"</p>\",\n    // if allowAll, add the option to copy deleted datasets, too\n    \"<% if( allowAll ){ %>\", \"<br />\", \"<p>\", (0, _localization2.default)(\"Choose which datasets from the original history to include:\"), \"</p>\",\n    // copy non-deleted is the default\n    '<input name=\"copy-what\" type=\"radio\" id=\"copy-non-deleted\" value=\"copy-non-deleted\" ', '<% if( copyWhat === \"copy-non-deleted\" ){ print( \"checked\" ); } %>/>', '<label for=\"copy-non-deleted\"> <%- activeLabel %></label>', \"<br />\", '<input name=\"copy-what\" type=\"radio\" id=\"copy-all\" value=\"copy-all\" ', '<% if( copyWhat === \"copy-all\" ){ print( \"checked\" ); } %>/>', '<label for=\"copy-all\"> <%- allLabel %></label>', \"<% } %>\", \"</form>\"].join(\"\")),\n\n    // empty modal body and let the user know the copy is happening\n    _showAjaxIndicator: function _showAjaxIndicator() {\n        var indicator = \"<p><span class=\\\"fa fa-spinner fa-spin\\\"></span> \" + this.progressive + \"...</p>\";\n        this.modal.$(\".modal-body\").empty().append(indicator).css({ \"margin-top\": \"8px\" });\n    },\n\n    // (sorta) public interface - display the modal, render the form, and potentially copy the history\n    // returns a jQuery.Deferred done->history copied, fail->user cancelled\n    dialog: function _dialog(modal, history, options) {\n        options = options || {};\n\n        var dialog = this;\n        var deferred = jQuery.Deferred();\n\n        var // TODO: getting a little byzantine here\n        defaultCopyNameFn = options.nameFn || this.defaultName;\n\n        var defaultCopyName = defaultCopyNameFn({\n            name: history.get(\"name\")\n        });\n\n        var // TODO: these two might be simpler as one 3 state option (all,active,no-choice)\n        defaultCopyWhat = options.allDatasets ? \"copy-all\" : \"copy-non-deleted\";\n\n        var allowAll = !_.isUndefined(options.allowAll) ? options.allowAll : true;\n\n        var autoClose = !_.isUndefined(options.autoClose) ? options.autoClose : true;\n\n        this.modal = modal;\n\n        // validate the name and copy if good\n        function checkNameAndCopy() {\n            var name = modal.$(\"#copy-modal-title\").val();\n            if (!name) {\n                modal.$(\".invalid-title\").show();\n                return;\n            }\n            // get further settings, shut down and indicate the ajax call, then hide and resolve/reject\n            var copyAllDatasets = modal.$('input[name=\"copy-what\"]:checked').val() === \"copy-all\";\n            modal.$(\"button\").prop(\"disabled\", true);\n            dialog._showAjaxIndicator();\n            history.copy(true, name, copyAllDatasets).done(function (response) {\n                deferred.resolve(response);\n            }).fail(function (xhr, status, message) {\n                var options = {\n                    name: name,\n                    copyAllDatasets: copyAllDatasets\n                };\n                _errorModal2.default.ajaxErrorModal(history, xhr, options, dialog.errorMessage);\n                deferred.rejectWith(deferred, arguments);\n            }).done(function () {\n                if (autoClose) {\n                    modal.hide();\n                }\n            });\n        }\n\n        var originalClosingCallback = options.closing_callback;\n        modal.show(_.extend(options, {\n            title: this.title({ name: history.get(\"name\") }),\n            body: $(dialog._template({\n                name: defaultCopyName,\n                isAnon: Galaxy.user.isAnonymous(),\n                allowAll: allowAll,\n                copyWhat: defaultCopyWhat,\n                activeLabel: this.activeLabel,\n                allLabel: this.allLabel,\n                anonWarning: this.anonWarning\n            })),\n            buttons: _.object([[(0, _localization2.default)(\"Cancel\"), function () {\n                modal.hide();\n            }], [this.submitLabel, checkNameAndCopy]]),\n            height: \"auto\",\n            closing_events: true,\n            closing_callback: function _historyCopyClose(cancelled) {\n                if (cancelled) {\n                    deferred.reject({ cancelled: true });\n                }\n                if (originalClosingCallback) {\n                    originalClosingCallback(cancelled);\n                }\n            }\n        }));\n\n        // set the default dataset copy, autofocus the title, and set up for a simple return\n        modal.$(\"#copy-modal-title\").focus().select();\n        modal.$(\"#copy-modal-title\").on(\"keydown\", function (ev) {\n            if (ev.keyCode === 13) {\n                ev.preventDefault();\n                checkNameAndCopy();\n            }\n        });\n\n        return deferred;\n    }\n};\n\n//==============================================================================\n// maintain the (slight) distinction between copy and import\n/**\n * Subclass CopyDialog to use the import language.\n */\nvar ImportDialog = _.extend({}, CopyDialog, {\n    defaultName: _.template(\"imported: <%- name %>\"),\n    title: _.template((0, _localization2.default)(\"Importing history\") + \" \\\"<%- name %>\\\"\"),\n    submitLabel: (0, _localization2.default)(\"Import\"),\n    errorMessage: (0, _localization2.default)(\"History could not be imported.\"),\n    progressive: (0, _localization2.default)(\"Importing history\"),\n    activeLabel: (0, _localization2.default)(\"Import only the active, non-deleted datasets\"),\n    allLabel: (0, _localization2.default)(\"Import all datasets including deleted ones\"),\n    anonWarning: (0, _localization2.default)(\"As an anonymous user, unless you login or register, you will lose your current history \") + (0, _localization2.default)(\"after importing this history. \")\n});\n\n//==============================================================================\n/**\n * Main interface for both history import and history copy dialogs.\n * @param  {Backbone.Model} history     the history to copy\n * @param  {Object}         options     a hash\n * @return {jQuery.Deferred}            promise that fails on close and succeeds on copy\n *\n * options:\n *     (this object is also passed to the modal used to display the dialog and accepts modal options)\n *     {Function} nameFn    if defined, use this to build the default name shown to the user\n *                          (the fn is passed: {name: <original history's name>})\n *     {bool} useImport     if true, use the 'import' language (instead of Copy)\n *     {bool} allowAll      if true, allow the user to choose between copying all datasets and\n *                          only non-deleted datasets\n *     {String} allDatasets default initial checked radio button: 'copy-all' or 'copy-non-deleted',\n */\nvar historyCopyDialog = function historyCopyDialog(history, options) {\n    options = options || {};\n    // create our own modal if Galaxy doesn't have one (mako tab without use_panels)\n    var modal = window.parent.Galaxy.modal || new _uiModal2.default.View({});\n    return options.useImport ? ImportDialog.dialog(modal, history, options) : CopyDialog.dialog(modal, history, options);\n};\n\n//==============================================================================\nexports.default = historyCopyDialog;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvY29weS1kaWFsb2cuanM/MzE4MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTU9EQUwgZnJvbSBcIm12Yy91aS91aS1tb2RhbFwiO1xuaW1wb3J0IEVSUk9SX01PREFMIGZyb20gXCJtdmMvdWkvZXJyb3ItbW9kYWxcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKipcbiAqIEEgZGlhbG9nL21vZGFsIHRoYXQgYWxsb3dzIGNvcHlpbmcgYSB1c2VyIGhpc3Rvcnkgb3IgJ2ltcG9ydGluZycgZnJvbSB1c2VyXG4gKiBhbm90aGVyLiBHZW5lcmFsbHkgY2FsbGVkIHZpYSBoaXN0b3J5Q29weURpYWxvZyBiZWxvdy5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbnZhciBDb3B5RGlhbG9nID0ge1xuICAgIC8vIGxhbmd1YWdlIHJlbGF0ZWQgc3RyaW5ncy9mbnNcbiAgICBkZWZhdWx0TmFtZTogXy50ZW1wbGF0ZShcIkNvcHkgb2YgJzwlLSBuYW1lICU+J1wiKSxcbiAgICB0aXRsZTogXy50ZW1wbGF0ZShgJHtfbChcIkNvcHlpbmcgaGlzdG9yeVwiKX0gXCI8JS0gbmFtZSAlPlwiYCksXG4gICAgc3VibWl0TGFiZWw6IF9sKFwiQ29weVwiKSxcbiAgICBlcnJvck1lc3NhZ2U6IF9sKFwiSGlzdG9yeSBjb3VsZCBub3QgYmUgY29waWVkLlwiKSxcbiAgICBwcm9ncmVzc2l2ZTogX2woXCJDb3B5aW5nIGhpc3RvcnlcIiksXG4gICAgYWN0aXZlTGFiZWw6IF9sKFwiQ29weSBvbmx5IHRoZSBhY3RpdmUsIG5vbi1kZWxldGVkIGRhdGFzZXRzXCIpLFxuICAgIGFsbExhYmVsOiBfbChcIkNvcHkgYWxsIGRhdGFzZXRzIGluY2x1ZGluZyBkZWxldGVkIG9uZXNcIiksXG4gICAgYW5vbldhcm5pbmc6XG4gICAgICAgIF9sKFwiQXMgYW4gYW5vbnltb3VzIHVzZXIsIHVubGVzcyB5b3UgbG9naW4gb3IgcmVnaXN0ZXIsIHlvdSB3aWxsIGxvc2UgeW91ciBjdXJyZW50IGhpc3RvcnkgXCIpICtcbiAgICAgICAgX2woXCJhZnRlciBjb3B5aW5nIHRoaXMgaGlzdG9yeS4gXCIpLFxuXG4gICAgLy8gdGVtcGxhdGUgZm9yIG1vZGFsIGJvZHlcbiAgICBfdGVtcGxhdGU6IF8udGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgIC8vVE9ETzogcmVtb3ZlIGlubGluZSBzdHlsZXNcbiAgICAgICAgICAgIC8vIHNob3cgYSB3YXJuaW5nIG1lc3NhZ2UgZm9yIGxvc2luZyBjdXJyZW50IHRvIGFub24gdXNlcnNcbiAgICAgICAgICAgIFwiPCUgaWYoIGlzQW5vbiApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ3YXJuaW5nbWVzc2FnZVwiPicsXG4gICAgICAgICAgICBcIjwlLSBhbm9uV2FybmluZyAlPlwiLFxuICAgICAgICAgICAgX2woXCJZb3UgY2FuXCIpLFxuICAgICAgICAgICAgJyA8YSBocmVmPVwiL3VzZXIvbG9naW5cIj4nLFxuICAgICAgICAgICAgX2woXCJsb2dpbiBoZXJlXCIpLFxuICAgICAgICAgICAgXCI8L2E+IFwiLFxuICAgICAgICAgICAgX2woXCJvclwiKSxcbiAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgJyA8YSBocmVmPVwiL3VzZXIvY3JlYXRlXCI+JyxcbiAgICAgICAgICAgIF9sKFwicmVnaXN0ZXIgaGVyZVwiKSxcbiAgICAgICAgICAgIFwiPC9hPi5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIixcbiAgICAgICAgICAgIFwiPGZvcm0+XCIsXG4gICAgICAgICAgICAnPGxhYmVsIGZvcj1cImNvcHktbW9kYWwtdGl0bGVcIj4nLFxuICAgICAgICAgICAgX2woXCJFbnRlciBhIHRpdGxlIGZvciB0aGUgbmV3IGhpc3RvcnlcIiksXG4gICAgICAgICAgICBcIjpcIixcbiAgICAgICAgICAgIFwiPC9sYWJlbD48YnIgLz5cIixcbiAgICAgICAgICAgIC8vIFRPRE86IGNvdWxkIHVzZSByZXF1aXJlZCBoZXJlIGFuZCB0aGUgZm9ybSB2YWxpZGF0b3JzXG4gICAgICAgICAgICAvLyBOT1RFOiB1c2UgdW5lc2NhcGVkIGhlcmUgaWYgZXNjYXBlZCBpbiB0aGUgbW9kYWwgZnVuY3Rpb24gYmVsb3dcbiAgICAgICAgICAgICc8aW5wdXQgaWQ9XCJjb3B5LW1vZGFsLXRpdGxlXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBzdHlsZT1cIndpZHRoOiAxMDAlXCIgdmFsdWU9XCI8JT0gbmFtZSAlPlwiIC8+JyxcbiAgICAgICAgICAgICc8cCBjbGFzcz1cImludmFsaWQtdGl0bGUgYmctZGFuZ2VyXCIgc3R5bGU9XCJjb2xvcjogcmVkOyBtYXJnaW46IDhweCAwcHggOHB4IDBweDsgZGlzcGxheTogbm9uZVwiPicsXG4gICAgICAgICAgICBfbChcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGhpc3RvcnkgdGl0bGVcIiksXG4gICAgICAgICAgICBcIjwvcD5cIixcbiAgICAgICAgICAgIC8vIGlmIGFsbG93QWxsLCBhZGQgdGhlIG9wdGlvbiB0byBjb3B5IGRlbGV0ZWQgZGF0YXNldHMsIHRvb1xuICAgICAgICAgICAgXCI8JSBpZiggYWxsb3dBbGwgKXsgJT5cIixcbiAgICAgICAgICAgIFwiPGJyIC8+XCIsXG4gICAgICAgICAgICBcIjxwPlwiLFxuICAgICAgICAgICAgX2woXCJDaG9vc2Ugd2hpY2ggZGF0YXNldHMgZnJvbSB0aGUgb3JpZ2luYWwgaGlzdG9yeSB0byBpbmNsdWRlOlwiKSxcbiAgICAgICAgICAgIFwiPC9wPlwiLFxuICAgICAgICAgICAgLy8gY29weSBub24tZGVsZXRlZCBpcyB0aGUgZGVmYXVsdFxuICAgICAgICAgICAgJzxpbnB1dCBuYW1lPVwiY29weS13aGF0XCIgdHlwZT1cInJhZGlvXCIgaWQ9XCJjb3B5LW5vbi1kZWxldGVkXCIgdmFsdWU9XCJjb3B5LW5vbi1kZWxldGVkXCIgJyxcbiAgICAgICAgICAgICc8JSBpZiggY29weVdoYXQgPT09IFwiY29weS1ub24tZGVsZXRlZFwiICl7IHByaW50KCBcImNoZWNrZWRcIiApOyB9ICU+Lz4nLFxuICAgICAgICAgICAgJzxsYWJlbCBmb3I9XCJjb3B5LW5vbi1kZWxldGVkXCI+IDwlLSBhY3RpdmVMYWJlbCAlPjwvbGFiZWw+JyxcbiAgICAgICAgICAgIFwiPGJyIC8+XCIsXG4gICAgICAgICAgICAnPGlucHV0IG5hbWU9XCJjb3B5LXdoYXRcIiB0eXBlPVwicmFkaW9cIiBpZD1cImNvcHktYWxsXCIgdmFsdWU9XCJjb3B5LWFsbFwiICcsXG4gICAgICAgICAgICAnPCUgaWYoIGNvcHlXaGF0ID09PSBcImNvcHktYWxsXCIgKXsgcHJpbnQoIFwiY2hlY2tlZFwiICk7IH0gJT4vPicsXG4gICAgICAgICAgICAnPGxhYmVsIGZvcj1cImNvcHktYWxsXCI+IDwlLSBhbGxMYWJlbCAlPjwvbGFiZWw+JyxcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuICAgICAgICAgICAgXCI8L2Zvcm0+XCJcbiAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgKSxcblxuICAgIC8vIGVtcHR5IG1vZGFsIGJvZHkgYW5kIGxldCB0aGUgdXNlciBrbm93IHRoZSBjb3B5IGlzIGhhcHBlbmluZ1xuICAgIF9zaG93QWpheEluZGljYXRvcjogZnVuY3Rpb24gX3Nob3dBamF4SW5kaWNhdG9yKCkge1xuICAgICAgICB2YXIgaW5kaWNhdG9yID0gYDxwPjxzcGFuIGNsYXNzPVwiZmEgZmEtc3Bpbm5lciBmYS1zcGluXCI+PC9zcGFuPiAke3RoaXMucHJvZ3Jlc3NpdmV9Li4uPC9wPmA7XG4gICAgICAgIHRoaXMubW9kYWxcbiAgICAgICAgICAgIC4kKFwiLm1vZGFsLWJvZHlcIilcbiAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAuYXBwZW5kKGluZGljYXRvcilcbiAgICAgICAgICAgIC5jc3MoeyBcIm1hcmdpbi10b3BcIjogXCI4cHhcIiB9KTtcbiAgICB9LFxuXG4gICAgLy8gKHNvcnRhKSBwdWJsaWMgaW50ZXJmYWNlIC0gZGlzcGxheSB0aGUgbW9kYWwsIHJlbmRlciB0aGUgZm9ybSwgYW5kIHBvdGVudGlhbGx5IGNvcHkgdGhlIGhpc3RvcnlcbiAgICAvLyByZXR1cm5zIGEgalF1ZXJ5LkRlZmVycmVkIGRvbmUtPmhpc3RvcnkgY29waWVkLCBmYWlsLT51c2VyIGNhbmNlbGxlZFxuICAgIGRpYWxvZzogZnVuY3Rpb24gX2RpYWxvZyhtb2RhbCwgaGlzdG9yeSwgb3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgICB2YXIgZGlhbG9nID0gdGhpcztcbiAgICAgICAgdmFyIGRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCk7XG5cbiAgICAgICAgdmFyIC8vIFRPRE86IGdldHRpbmcgYSBsaXR0bGUgYnl6YW50aW5lIGhlcmVcbiAgICAgICAgZGVmYXVsdENvcHlOYW1lRm4gPSBvcHRpb25zLm5hbWVGbiB8fCB0aGlzLmRlZmF1bHROYW1lO1xuXG4gICAgICAgIHZhciBkZWZhdWx0Q29weU5hbWUgPSBkZWZhdWx0Q29weU5hbWVGbih7XG4gICAgICAgICAgICBuYW1lOiBoaXN0b3J5LmdldChcIm5hbWVcIilcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIC8vIFRPRE86IHRoZXNlIHR3byBtaWdodCBiZSBzaW1wbGVyIGFzIG9uZSAzIHN0YXRlIG9wdGlvbiAoYWxsLGFjdGl2ZSxuby1jaG9pY2UpXG4gICAgICAgIGRlZmF1bHRDb3B5V2hhdCA9IG9wdGlvbnMuYWxsRGF0YXNldHMgPyBcImNvcHktYWxsXCIgOiBcImNvcHktbm9uLWRlbGV0ZWRcIjtcblxuICAgICAgICB2YXIgYWxsb3dBbGwgPSAhXy5pc1VuZGVmaW5lZChvcHRpb25zLmFsbG93QWxsKSA/IG9wdGlvbnMuYWxsb3dBbGwgOiB0cnVlO1xuXG4gICAgICAgIHZhciBhdXRvQ2xvc2UgPSAhXy5pc1VuZGVmaW5lZChvcHRpb25zLmF1dG9DbG9zZSkgPyBvcHRpb25zLmF1dG9DbG9zZSA6IHRydWU7XG5cbiAgICAgICAgdGhpcy5tb2RhbCA9IG1vZGFsO1xuXG4gICAgICAgIC8vIHZhbGlkYXRlIHRoZSBuYW1lIGFuZCBjb3B5IGlmIGdvb2RcbiAgICAgICAgZnVuY3Rpb24gY2hlY2tOYW1lQW5kQ29weSgpIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbW9kYWwuJChcIiNjb3B5LW1vZGFsLXRpdGxlXCIpLnZhbCgpO1xuICAgICAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgICAgICAgbW9kYWwuJChcIi5pbnZhbGlkLXRpdGxlXCIpLnNob3coKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBnZXQgZnVydGhlciBzZXR0aW5ncywgc2h1dCBkb3duIGFuZCBpbmRpY2F0ZSB0aGUgYWpheCBjYWxsLCB0aGVuIGhpZGUgYW5kIHJlc29sdmUvcmVqZWN0XG4gICAgICAgICAgICB2YXIgY29weUFsbERhdGFzZXRzID0gbW9kYWwuJCgnaW5wdXRbbmFtZT1cImNvcHktd2hhdFwiXTpjaGVja2VkJykudmFsKCkgPT09IFwiY29weS1hbGxcIjtcbiAgICAgICAgICAgIG1vZGFsLiQoXCJidXR0b25cIikucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICAgICAgZGlhbG9nLl9zaG93QWpheEluZGljYXRvcigpO1xuICAgICAgICAgICAgaGlzdG9yeVxuICAgICAgICAgICAgICAgIC5jb3B5KHRydWUsIG5hbWUsIGNvcHlBbGxEYXRhc2V0cylcbiAgICAgICAgICAgICAgICAuZG9uZShyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oeGhyLCBzdGF0dXMsIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29weUFsbERhdGFzZXRzOiBjb3B5QWxsRGF0YXNldHNcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgRVJST1JfTU9EQUwuYWpheEVycm9yTW9kYWwoaGlzdG9yeSwgeGhyLCBvcHRpb25zLCBkaWFsb2cuZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0V2l0aChkZWZlcnJlZCwgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF1dG9DbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb3JpZ2luYWxDbG9zaW5nQ2FsbGJhY2sgPSBvcHRpb25zLmNsb3NpbmdfY2FsbGJhY2s7XG4gICAgICAgIG1vZGFsLnNob3coXG4gICAgICAgICAgICBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGUoeyBuYW1lOiBoaXN0b3J5LmdldChcIm5hbWVcIikgfSksXG4gICAgICAgICAgICAgICAgYm9keTogJChcbiAgICAgICAgICAgICAgICAgICAgZGlhbG9nLl90ZW1wbGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkZWZhdWx0Q29weU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0Fub246IEdhbGF4eS51c2VyLmlzQW5vbnltb3VzKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxvd0FsbDogYWxsb3dBbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3B5V2hhdDogZGVmYXVsdENvcHlXaGF0LFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlTGFiZWw6IHRoaXMuYWN0aXZlTGFiZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxMYWJlbDogdGhpcy5hbGxMYWJlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFub25XYXJuaW5nOiB0aGlzLmFub25XYXJuaW5nXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBidXR0b25zOiBfLm9iamVjdChbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sKFwiQ2FuY2VsXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgW3RoaXMuc3VibWl0TGFiZWwsIGNoZWNrTmFtZUFuZENvcHldXG4gICAgICAgICAgICAgICAgXSksXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBcImF1dG9cIixcbiAgICAgICAgICAgICAgICBjbG9zaW5nX2V2ZW50czogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjbG9zaW5nX2NhbGxiYWNrOiBmdW5jdGlvbiBfaGlzdG9yeUNvcHlDbG9zZShjYW5jZWxsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbmNlbGxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KHsgY2FuY2VsbGVkOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcmlnaW5hbENsb3NpbmdDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxDbG9zaW5nQ2FsbGJhY2soY2FuY2VsbGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gc2V0IHRoZSBkZWZhdWx0IGRhdGFzZXQgY29weSwgYXV0b2ZvY3VzIHRoZSB0aXRsZSwgYW5kIHNldCB1cCBmb3IgYSBzaW1wbGUgcmV0dXJuXG4gICAgICAgIG1vZGFsXG4gICAgICAgICAgICAuJChcIiNjb3B5LW1vZGFsLXRpdGxlXCIpXG4gICAgICAgICAgICAuZm9jdXMoKVxuICAgICAgICAgICAgLnNlbGVjdCgpO1xuICAgICAgICBtb2RhbC4kKFwiI2NvcHktbW9kYWwtdGl0bGVcIikub24oXCJrZXlkb3duXCIsIGV2ID0+IHtcbiAgICAgICAgICAgIGlmIChldi5rZXlDb2RlID09PSAxMykge1xuICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgY2hlY2tOYW1lQW5kQ29weSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZGVmZXJyZWQ7XG4gICAgfVxufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIG1haW50YWluIHRoZSAoc2xpZ2h0KSBkaXN0aW5jdGlvbiBiZXR3ZWVuIGNvcHkgYW5kIGltcG9ydFxuLyoqXG4gKiBTdWJjbGFzcyBDb3B5RGlhbG9nIHRvIHVzZSB0aGUgaW1wb3J0IGxhbmd1YWdlLlxuICovXG52YXIgSW1wb3J0RGlhbG9nID0gXy5leHRlbmQoe30sIENvcHlEaWFsb2csIHtcbiAgICBkZWZhdWx0TmFtZTogXy50ZW1wbGF0ZShcImltcG9ydGVkOiA8JS0gbmFtZSAlPlwiKSxcbiAgICB0aXRsZTogXy50ZW1wbGF0ZShgJHtfbChcIkltcG9ydGluZyBoaXN0b3J5XCIpfSBcIjwlLSBuYW1lICU+XCJgKSxcbiAgICBzdWJtaXRMYWJlbDogX2woXCJJbXBvcnRcIiksXG4gICAgZXJyb3JNZXNzYWdlOiBfbChcIkhpc3RvcnkgY291bGQgbm90IGJlIGltcG9ydGVkLlwiKSxcbiAgICBwcm9ncmVzc2l2ZTogX2woXCJJbXBvcnRpbmcgaGlzdG9yeVwiKSxcbiAgICBhY3RpdmVMYWJlbDogX2woXCJJbXBvcnQgb25seSB0aGUgYWN0aXZlLCBub24tZGVsZXRlZCBkYXRhc2V0c1wiKSxcbiAgICBhbGxMYWJlbDogX2woXCJJbXBvcnQgYWxsIGRhdGFzZXRzIGluY2x1ZGluZyBkZWxldGVkIG9uZXNcIiksXG4gICAgYW5vbldhcm5pbmc6XG4gICAgICAgIF9sKFwiQXMgYW4gYW5vbnltb3VzIHVzZXIsIHVubGVzcyB5b3UgbG9naW4gb3IgcmVnaXN0ZXIsIHlvdSB3aWxsIGxvc2UgeW91ciBjdXJyZW50IGhpc3RvcnkgXCIpICtcbiAgICAgICAgX2woXCJhZnRlciBpbXBvcnRpbmcgdGhpcyBoaXN0b3J5LiBcIilcbn0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqXG4gKiBNYWluIGludGVyZmFjZSBmb3IgYm90aCBoaXN0b3J5IGltcG9ydCBhbmQgaGlzdG9yeSBjb3B5IGRpYWxvZ3MuXG4gKiBAcGFyYW0gIHtCYWNrYm9uZS5Nb2RlbH0gaGlzdG9yeSAgICAgdGhlIGhpc3RvcnkgdG8gY29weVxuICogQHBhcmFtICB7T2JqZWN0fSAgICAgICAgIG9wdGlvbnMgICAgIGEgaGFzaFxuICogQHJldHVybiB7alF1ZXJ5LkRlZmVycmVkfSAgICAgICAgICAgIHByb21pc2UgdGhhdCBmYWlscyBvbiBjbG9zZSBhbmQgc3VjY2VlZHMgb24gY29weVxuICpcbiAqIG9wdGlvbnM6XG4gKiAgICAgKHRoaXMgb2JqZWN0IGlzIGFsc28gcGFzc2VkIHRvIHRoZSBtb2RhbCB1c2VkIHRvIGRpc3BsYXkgdGhlIGRpYWxvZyBhbmQgYWNjZXB0cyBtb2RhbCBvcHRpb25zKVxuICogICAgIHtGdW5jdGlvbn0gbmFtZUZuICAgIGlmIGRlZmluZWQsIHVzZSB0aGlzIHRvIGJ1aWxkIHRoZSBkZWZhdWx0IG5hbWUgc2hvd24gdG8gdGhlIHVzZXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAodGhlIGZuIGlzIHBhc3NlZDoge25hbWU6IDxvcmlnaW5hbCBoaXN0b3J5J3MgbmFtZT59KVxuICogICAgIHtib29sfSB1c2VJbXBvcnQgICAgIGlmIHRydWUsIHVzZSB0aGUgJ2ltcG9ydCcgbGFuZ3VhZ2UgKGluc3RlYWQgb2YgQ29weSlcbiAqICAgICB7Ym9vbH0gYWxsb3dBbGwgICAgICBpZiB0cnVlLCBhbGxvdyB0aGUgdXNlciB0byBjaG9vc2UgYmV0d2VlbiBjb3B5aW5nIGFsbCBkYXRhc2V0cyBhbmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBvbmx5IG5vbi1kZWxldGVkIGRhdGFzZXRzXG4gKiAgICAge1N0cmluZ30gYWxsRGF0YXNldHMgZGVmYXVsdCBpbml0aWFsIGNoZWNrZWQgcmFkaW8gYnV0dG9uOiAnY29weS1hbGwnIG9yICdjb3B5LW5vbi1kZWxldGVkJyxcbiAqL1xudmFyIGhpc3RvcnlDb3B5RGlhbG9nID0gKGhpc3RvcnksIG9wdGlvbnMpID0+IHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAvLyBjcmVhdGUgb3VyIG93biBtb2RhbCBpZiBHYWxheHkgZG9lc24ndCBoYXZlIG9uZSAobWFrbyB0YWIgd2l0aG91dCB1c2VfcGFuZWxzKVxuICAgIHZhciBtb2RhbCA9IHdpbmRvdy5wYXJlbnQuR2FsYXh5Lm1vZGFsIHx8IG5ldyBNT0RBTC5WaWV3KHt9KTtcbiAgICByZXR1cm4gb3B0aW9ucy51c2VJbXBvcnRcbiAgICAgICAgPyBJbXBvcnREaWFsb2cuZGlhbG9nKG1vZGFsLCBoaXN0b3J5LCBvcHRpb25zKVxuICAgICAgICA6IENvcHlEaWFsb2cuZGlhbG9nKG1vZGFsLCBoaXN0b3J5LCBvcHRpb25zKTtcbn07XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCBoaXN0b3J5Q29weURpYWxvZztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9jb3B5LWRpYWxvZy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBOzs7OztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBbUJBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFVQTtBQUlBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQS9CQTtBQUNBO0FBa0NBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqTEE7QUFDQTtBQW1MQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBQ0E7QUFZQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///55\n");

/***/ }),
/* 56 */
/*!****************************************************************!*\
  !*** ./galaxy/scripts/mvc/base/controlled-fetch-collection.js ***!
  \****************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _underscore = __webpack_require__(/*! libs/underscore */ 1);\n\nvar _ = _interopRequireWildcard(_underscore);\n\nvar _backbone = __webpack_require__(/*! libs/backbone */ 2);\n\nvar Backbone = _interopRequireWildcard(_backbone);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/* global Galaxy */\n/* global jQuery */\n\n//=============================================================================\n/**\n * A Collection that can be limited/offset/re-ordered/filtered.\n * @type {Backbone.Collection}\n */\nvar ControlledFetchCollection = Backbone.Collection.extend({\n    /** call setOrder on initialization to build the comparator based on options */\n    initialize: function initialize(models, options) {\n        Backbone.Collection.prototype.initialize.call(this, models, options);\n        this.setOrder(options.order || this.order, { silent: true });\n    },\n\n    /** set up to track order changes and re-sort when changed */\n    _setUpListeners: function _setUpListeners() {\n        return this.on({\n            \"changed-order\": this.sort\n        });\n    },\n\n    /** override to provide order and offsets based on instance vars, set limit if passed,\n     *  and set allFetched/fire 'all-fetched' when xhr returns\n     */\n    fetch: function fetch(options) {\n        options = this._buildFetchOptions(options);\n        Galaxy.debug(\"fetch options:\", options);\n        return Backbone.Collection.prototype.fetch.call(this, options);\n    },\n\n    /** build ajax data/parameters from options */\n    _buildFetchOptions: function _buildFetchOptions(options) {\n        // note: we normally want options passed in to override the defaults built here\n        // so most of these fns will generate defaults\n        options = _.clone(options) || {};\n\n        // jquery ajax option; allows multiple q/qv for filters (instead of 'q[]')\n        options.traditional = true;\n\n        // options.data\n        // we keep limit, offset, etc. in options *as well as move it into data* because:\n        // - it makes fetch calling convenient to add it to a single options map (instead of as mult. args)\n        // - it allows the std. event handlers (for fetch, etc.) to have access\n        //   to the pagination options too\n        //      (i.e. this.on( 'sync', function( options ){ if( options.limit ){ ... } }))\n        // however, when we send to xhr/jquery we copy them to data also so that they become API query params\n        options.data = options.data || this._buildFetchData(options);\n        Galaxy.debug(\"data:\", options.data);\n\n        // options.data.filters --> options.data.q, options.data.qv\n        var filters = this._buildFetchFilters(options);\n        Galaxy.debug(\"filters:\", filters);\n        if (!_.isEmpty(filters)) {\n            _.extend(options.data, this._fetchFiltersToAjaxData(filters));\n        }\n        Galaxy.debug(\"data:\", options.data);\n        return options;\n    },\n\n    /** Build the dictionary to send to fetch's XHR as data */\n    _buildFetchData: function _buildFetchData(options) {\n        var defaults = {};\n        if (this.order) {\n            defaults.order = this.order;\n        }\n        return _.defaults(_.pick(options, this._fetchParams), defaults);\n    },\n\n    /** These attribute keys are valid params to fetch/API-index */\n    _fetchParams: [\n    /** model dependent string to control the order of models returned */\n    \"order\",\n    /** limit the number of models returned from a fetch */\n    \"limit\",\n    /** skip this number of models when fetching */\n    \"offset\",\n    /** what series of attributes to return (model dependent) */\n    \"view\",\n    /** individual keys to return for the models (see api/histories.index) */\n    \"keys\"],\n\n    /** add any needed filters here based on collection state */\n    _buildFetchFilters: function _buildFetchFilters(options) {\n        // override\n        return _.clone(options.filters || {});\n    },\n\n    /** Convert dictionary filters to qqv style arrays */\n    _fetchFiltersToAjaxData: function _fetchFiltersToAjaxData(filters) {\n        // return as a map so ajax.data can extend from it\n        var filterMap = {\n            q: [],\n            qv: []\n        };\n        _.each(filters, function (v, k) {\n            // don't send if filter value is empty\n            if (v === undefined || v === \"\") {\n                return;\n            }\n            // json to python\n            if (v === true) {\n                v = \"True\";\n            }\n            if (v === false) {\n                v = \"False\";\n            }\n            if (v === null) {\n                v = \"None\";\n            }\n            // map to k/v arrays (q/qv)\n            filterMap.q.push(k);\n            filterMap.qv.push(v);\n        });\n        return filterMap;\n    },\n\n    /** override to reset allFetched flag to false */\n    reset: function reset(models, options) {\n        this.allFetched = false;\n        return Backbone.Collection.prototype.reset.call(this, models, options);\n    },\n\n    // ........................................................................ order\n    order: null,\n\n    /** @type {Object} map of collection available sorting orders containing comparator fns */\n    comparators: {\n        update_time: _baseMvc2.default.buildComparator(\"update_time\", {\n            ascending: false\n        }),\n        \"update_time-asc\": _baseMvc2.default.buildComparator(\"update_time\", {\n            ascending: true\n        }),\n        create_time: _baseMvc2.default.buildComparator(\"create_time\", {\n            ascending: false\n        }),\n        \"create_time-asc\": _baseMvc2.default.buildComparator(\"create_time\", {\n            ascending: true\n        })\n    },\n\n    /** set the order and comparator for this collection then sort with the new order\n     *  @event 'changed-order' passed the new order and the collection\n     */\n    setOrder: function setOrder(order, options) {\n        options = options || {};\n        var collection = this;\n        var comparator = collection.comparators[order];\n        if (_.isUndefined(comparator)) {\n            throw new Error(\"unknown order: \" + order);\n        }\n        // if( _.isUndefined( comparator ) ){ return; }\n        if (comparator === collection.comparator) {\n            return;\n        }\n\n        collection.order = order;\n        collection.comparator = comparator;\n\n        if (!options.silent) {\n            collection.trigger(\"changed-order\", options);\n        }\n        return collection;\n    }\n});\n\n//=============================================================================\n/**\n *\n */\nvar PaginatedCollection = ControlledFetchCollection.extend({\n    /** @type {Number} limit used for each page's fetch */\n    limitPerPage: 500,\n\n    initialize: function initialize(models, options) {\n        ControlledFetchCollection.prototype.initialize.call(this, models, options);\n        this.currentPage = options.currentPage || 0;\n    },\n\n    getTotalItemCount: function getTotalItemCount() {\n        return this.length;\n    },\n\n    shouldPaginate: function shouldPaginate() {\n        return this.getTotalItemCount() >= this.limitPerPage;\n    },\n\n    getLastPage: function getLastPage() {\n        return Math.floor(this.getTotalItemCount() / this.limitPerPage);\n    },\n\n    getPageCount: function getPageCount() {\n        return this.getLastPage() + 1;\n    },\n\n    getPageLimitOffset: function getPageLimitOffset(pageNum) {\n        pageNum = this.constrainPageNum(pageNum);\n        return {\n            limit: this.limitPerPage,\n            offset: pageNum * this.limitPerPage\n        };\n    },\n\n    constrainPageNum: function constrainPageNum(pageNum) {\n        return Math.max(0, Math.min(pageNum, this.getLastPage()));\n    },\n\n    /** fetch the next page of data */\n    fetchPage: function fetchPage(pageNum, options) {\n        var self = this;\n        pageNum = self.constrainPageNum(pageNum);\n        self.currentPage = pageNum;\n        options = _.defaults(options || {}, self.getPageLimitOffset(pageNum));\n\n        self.trigger(\"fetching-more\");\n        return self.fetch(options).always(function () {\n            self.trigger(\"fetching-more-done\");\n        });\n    },\n\n    fetchCurrentPage: function fetchCurrentPage(options) {\n        return this.fetchPage(this.currentPage, options);\n    },\n\n    fetchPrevPage: function fetchPrevPage(options) {\n        return this.fetchPage(this.currentPage - 1, options);\n    },\n\n    fetchNextPage: function fetchNextPage(options) {\n        return this.fetchPage(this.currentPage + 1, options);\n    }\n});\n\n//=============================================================================\n/**\n * A Collection that will load more elements without reseting.\n */\nvar InfinitelyScrollingCollection = ControlledFetchCollection.extend({\n    /** @type {Number} limit used for the first fetch (or a reset) */\n    limitOnFirstFetch: null,\n    /** @type {Number} limit used for each subsequent fetch */\n    limitPerFetch: 100,\n\n    initialize: function initialize(models, options) {\n        ControlledFetchCollection.prototype.initialize.call(this, models, options);\n        /** @type {Integer} number of contents to return from the first fetch */\n        this.limitOnFirstFetch = options.limitOnFirstFetch || this.limitOnFirstFetch;\n        /** @type {Integer} limit for every fetch after the first */\n        this.limitPerFetch = options.limitPerFetch || this.limitPerFetch;\n        /** @type {Boolean} are all contents fetched? */\n        this.allFetched = false;\n        /** @type {Integer} what was the offset of the last content returned */\n        this.lastFetched = options.lastFetched || 0;\n    },\n\n    /** build ajax data/parameters from options */\n    _buildFetchOptions: function _buildFetchOptions(options) {\n        // options (options for backbone.fetch and jquery.ajax generally)\n        // backbone option; false here to make fetching an addititive process\n        options.remove = options.remove || false;\n        return ControlledFetchCollection.prototype._buildFetchOptions.call(this, options);\n    },\n\n    /** fetch the first 'page' of data */\n    fetchFirst: function fetchFirst(options) {\n        Galaxy.debug(\"ControlledFetchCollection.fetchFirst:\", options);\n        options = options ? _.clone(options) : {};\n        this.allFetched = false;\n        this.lastFetched = 0;\n        return this.fetchMore(_.defaults(options, {\n            reset: true,\n            limit: this.limitOnFirstFetch\n        }));\n    },\n\n    /** fetch the next page of data */\n    fetchMore: function fetchMore(options) {\n        Galaxy.debug(\"ControlledFetchCollection.fetchMore:\", options);\n        options = _.clone(options || {});\n        var collection = this;\n\n        Galaxy.debug(\"fetchMore, options.reset:\", options.reset);\n        if (!options.reset && collection.allFetched) {\n            return jQuery.when();\n        }\n\n        // TODO: this fails in the edge case where\n        //  the first fetch offset === limit (limit 4, offset 4, collection.length 4)\n        if (options.reset) {\n            options.offset = 0;\n        } else if (options.offset === undefined) {\n            options.offset = collection.lastFetched;\n        }\n        var limit = options.limit = options.limit || collection.limitPerFetch || null;\n        Galaxy.debug(\"fetchMore, limit:\", limit, \"offset:\", options.offset);\n\n        collection.trigger(\"fetching-more\");\n        return collection.fetch(options).always(function () {\n            collection.trigger(\"fetching-more-done\");\n        })\n        // maintain allFetched flag and trigger if all were fetched this time\n        .done(function _postFetchMore(fetchedData) {\n            var numFetched = _.isArray(fetchedData) ? fetchedData.length : 0;\n            collection.lastFetched += numFetched;\n            Galaxy.debug(\"fetchMore, lastFetched:\", collection.lastFetched);\n            // anything less than a full page means we got all there is to get\n            if (!limit || numFetched < limit) {\n                collection.allFetched = true;\n                collection.trigger(\"all-fetched\", this);\n            }\n        });\n    },\n\n    /** fetch all the collection */\n    fetchAll: function fetchAll(options) {\n        // whitelist options to prevent allowing limit/offset/filters\n        // (use vanilla fetch instead)\n        options = options || {};\n        var self = this;\n        options = _.pick(options, \"silent\");\n        options.filters = {};\n        return self.fetch(options).done(function () {\n            self.allFetched = true;\n            self.trigger(\"all-fetched\", self);\n        });\n    }\n});\n\n//==============================================================================\nexports.default = {\n    ControlledFetchCollection: ControlledFetchCollection,\n    PaginatedCollection: PaginatedCollection,\n    InfinitelyScrollingCollection: InfinitelyScrollingCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2Jhc2UvY29udHJvbGxlZC1mZXRjaC1jb2xsZWN0aW9uLmpzPzdkZDQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgXyBmcm9tIFwibGlicy91bmRlcnNjb3JlXCI7XG5pbXBvcnQgKiBhcyBCYWNrYm9uZSBmcm9tIFwibGlicy9iYWNrYm9uZVwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcblxuLyogZ2xvYmFsIEdhbGF4eSAqL1xuLyogZ2xvYmFsIGpRdWVyeSAqL1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKipcbiAqIEEgQ29sbGVjdGlvbiB0aGF0IGNhbiBiZSBsaW1pdGVkL29mZnNldC9yZS1vcmRlcmVkL2ZpbHRlcmVkLlxuICogQHR5cGUge0JhY2tib25lLkNvbGxlY3Rpb259XG4gKi9cbnZhciBDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xuICAgIC8qKiBjYWxsIHNldE9yZGVyIG9uIGluaXRpYWxpemF0aW9uIHRvIGJ1aWxkIHRoZSBjb21wYXJhdG9yIGJhc2VkIG9uIG9wdGlvbnMgKi9cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihtb2RlbHMsIG9wdGlvbnMpIHtcbiAgICAgICAgQmFja2JvbmUuQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIG1vZGVscywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuc2V0T3JkZXIob3B0aW9ucy5vcmRlciB8fCB0aGlzLm9yZGVyLCB7IHNpbGVudDogdHJ1ZSB9KTtcbiAgICB9LFxuXG4gICAgLyoqIHNldCB1cCB0byB0cmFjayBvcmRlciBjaGFuZ2VzIGFuZCByZS1zb3J0IHdoZW4gY2hhbmdlZCAqL1xuICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9uKHtcbiAgICAgICAgICAgIFwiY2hhbmdlZC1vcmRlclwiOiB0aGlzLnNvcnRcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBvdmVycmlkZSB0byBwcm92aWRlIG9yZGVyIGFuZCBvZmZzZXRzIGJhc2VkIG9uIGluc3RhbmNlIHZhcnMsIHNldCBsaW1pdCBpZiBwYXNzZWQsXG4gICAgICogIGFuZCBzZXQgYWxsRmV0Y2hlZC9maXJlICdhbGwtZmV0Y2hlZCcgd2hlbiB4aHIgcmV0dXJuc1xuICAgICAqL1xuICAgIGZldGNoOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSB0aGlzLl9idWlsZEZldGNoT3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgR2FsYXh5LmRlYnVnKFwiZmV0Y2ggb3B0aW9uczpcIiwgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiBCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5mZXRjaC5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICAvKiogYnVpbGQgYWpheCBkYXRhL3BhcmFtZXRlcnMgZnJvbSBvcHRpb25zICovXG4gICAgX2J1aWxkRmV0Y2hPcHRpb25zOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIC8vIG5vdGU6IHdlIG5vcm1hbGx5IHdhbnQgb3B0aW9ucyBwYXNzZWQgaW4gdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRzIGJ1aWx0IGhlcmVcbiAgICAgICAgLy8gc28gbW9zdCBvZiB0aGVzZSBmbnMgd2lsbCBnZW5lcmF0ZSBkZWZhdWx0c1xuICAgICAgICBvcHRpb25zID0gXy5jbG9uZShvcHRpb25zKSB8fCB7fTtcblxuICAgICAgICAvLyBqcXVlcnkgYWpheCBvcHRpb247IGFsbG93cyBtdWx0aXBsZSBxL3F2IGZvciBmaWx0ZXJzIChpbnN0ZWFkIG9mICdxW10nKVxuICAgICAgICBvcHRpb25zLnRyYWRpdGlvbmFsID0gdHJ1ZTtcblxuICAgICAgICAvLyBvcHRpb25zLmRhdGFcbiAgICAgICAgLy8gd2Uga2VlcCBsaW1pdCwgb2Zmc2V0LCBldGMuIGluIG9wdGlvbnMgKmFzIHdlbGwgYXMgbW92ZSBpdCBpbnRvIGRhdGEqIGJlY2F1c2U6XG4gICAgICAgIC8vIC0gaXQgbWFrZXMgZmV0Y2ggY2FsbGluZyBjb252ZW5pZW50IHRvIGFkZCBpdCB0byBhIHNpbmdsZSBvcHRpb25zIG1hcCAoaW5zdGVhZCBvZiBhcyBtdWx0LiBhcmdzKVxuICAgICAgICAvLyAtIGl0IGFsbG93cyB0aGUgc3RkLiBldmVudCBoYW5kbGVycyAoZm9yIGZldGNoLCBldGMuKSB0byBoYXZlIGFjY2Vzc1xuICAgICAgICAvLyAgIHRvIHRoZSBwYWdpbmF0aW9uIG9wdGlvbnMgdG9vXG4gICAgICAgIC8vICAgICAgKGkuZS4gdGhpcy5vbiggJ3N5bmMnLCBmdW5jdGlvbiggb3B0aW9ucyApeyBpZiggb3B0aW9ucy5saW1pdCApeyAuLi4gfSB9KSlcbiAgICAgICAgLy8gaG93ZXZlciwgd2hlbiB3ZSBzZW5kIHRvIHhoci9qcXVlcnkgd2UgY29weSB0aGVtIHRvIGRhdGEgYWxzbyBzbyB0aGF0IHRoZXkgYmVjb21lIEFQSSBxdWVyeSBwYXJhbXNcbiAgICAgICAgb3B0aW9ucy5kYXRhID0gb3B0aW9ucy5kYXRhIHx8IHRoaXMuX2J1aWxkRmV0Y2hEYXRhKG9wdGlvbnMpO1xuICAgICAgICBHYWxheHkuZGVidWcoXCJkYXRhOlwiLCBvcHRpb25zLmRhdGEpO1xuXG4gICAgICAgIC8vIG9wdGlvbnMuZGF0YS5maWx0ZXJzIC0tPiBvcHRpb25zLmRhdGEucSwgb3B0aW9ucy5kYXRhLnF2XG4gICAgICAgIHZhciBmaWx0ZXJzID0gdGhpcy5fYnVpbGRGZXRjaEZpbHRlcnMob3B0aW9ucyk7XG4gICAgICAgIEdhbGF4eS5kZWJ1ZyhcImZpbHRlcnM6XCIsIGZpbHRlcnMpO1xuICAgICAgICBpZiAoIV8uaXNFbXB0eShmaWx0ZXJzKSkge1xuICAgICAgICAgICAgXy5leHRlbmQob3B0aW9ucy5kYXRhLCB0aGlzLl9mZXRjaEZpbHRlcnNUb0FqYXhEYXRhKGZpbHRlcnMpKTtcbiAgICAgICAgfVxuICAgICAgICBHYWxheHkuZGVidWcoXCJkYXRhOlwiLCBvcHRpb25zLmRhdGEpO1xuICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9LFxuXG4gICAgLyoqIEJ1aWxkIHRoZSBkaWN0aW9uYXJ5IHRvIHNlbmQgdG8gZmV0Y2gncyBYSFIgYXMgZGF0YSAqL1xuICAgIF9idWlsZEZldGNoRGF0YTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB2YXIgZGVmYXVsdHMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMub3JkZXIpIHtcbiAgICAgICAgICAgIGRlZmF1bHRzLm9yZGVyID0gdGhpcy5vcmRlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5kZWZhdWx0cyhfLnBpY2sob3B0aW9ucywgdGhpcy5fZmV0Y2hQYXJhbXMpLCBkZWZhdWx0cyk7XG4gICAgfSxcblxuICAgIC8qKiBUaGVzZSBhdHRyaWJ1dGUga2V5cyBhcmUgdmFsaWQgcGFyYW1zIHRvIGZldGNoL0FQSS1pbmRleCAqL1xuICAgIF9mZXRjaFBhcmFtczogW1xuICAgICAgICAvKiogbW9kZWwgZGVwZW5kZW50IHN0cmluZyB0byBjb250cm9sIHRoZSBvcmRlciBvZiBtb2RlbHMgcmV0dXJuZWQgKi9cbiAgICAgICAgXCJvcmRlclwiLFxuICAgICAgICAvKiogbGltaXQgdGhlIG51bWJlciBvZiBtb2RlbHMgcmV0dXJuZWQgZnJvbSBhIGZldGNoICovXG4gICAgICAgIFwibGltaXRcIixcbiAgICAgICAgLyoqIHNraXAgdGhpcyBudW1iZXIgb2YgbW9kZWxzIHdoZW4gZmV0Y2hpbmcgKi9cbiAgICAgICAgXCJvZmZzZXRcIixcbiAgICAgICAgLyoqIHdoYXQgc2VyaWVzIG9mIGF0dHJpYnV0ZXMgdG8gcmV0dXJuIChtb2RlbCBkZXBlbmRlbnQpICovXG4gICAgICAgIFwidmlld1wiLFxuICAgICAgICAvKiogaW5kaXZpZHVhbCBrZXlzIHRvIHJldHVybiBmb3IgdGhlIG1vZGVscyAoc2VlIGFwaS9oaXN0b3JpZXMuaW5kZXgpICovXG4gICAgICAgIFwia2V5c1wiXG4gICAgXSxcblxuICAgIC8qKiBhZGQgYW55IG5lZWRlZCBmaWx0ZXJzIGhlcmUgYmFzZWQgb24gY29sbGVjdGlvbiBzdGF0ZSAqL1xuICAgIF9idWlsZEZldGNoRmlsdGVyczogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAvLyBvdmVycmlkZVxuICAgICAgICByZXR1cm4gXy5jbG9uZShvcHRpb25zLmZpbHRlcnMgfHwge30pO1xuICAgIH0sXG5cbiAgICAvKiogQ29udmVydCBkaWN0aW9uYXJ5IGZpbHRlcnMgdG8gcXF2IHN0eWxlIGFycmF5cyAqL1xuICAgIF9mZXRjaEZpbHRlcnNUb0FqYXhEYXRhOiBmdW5jdGlvbihmaWx0ZXJzKSB7XG4gICAgICAgIC8vIHJldHVybiBhcyBhIG1hcCBzbyBhamF4LmRhdGEgY2FuIGV4dGVuZCBmcm9tIGl0XG4gICAgICAgIHZhciBmaWx0ZXJNYXAgPSB7XG4gICAgICAgICAgICBxOiBbXSxcbiAgICAgICAgICAgIHF2OiBbXVxuICAgICAgICB9O1xuICAgICAgICBfLmVhY2goZmlsdGVycywgKHYsIGspID0+IHtcbiAgICAgICAgICAgIC8vIGRvbid0IHNlbmQgaWYgZmlsdGVyIHZhbHVlIGlzIGVtcHR5XG4gICAgICAgICAgICBpZiAodiA9PT0gdW5kZWZpbmVkIHx8IHYgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBqc29uIHRvIHB5dGhvblxuICAgICAgICAgICAgaWYgKHYgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB2ID0gXCJUcnVlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodiA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2ID0gXCJGYWxzZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHYgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2ID0gXCJOb25lXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtYXAgdG8gay92IGFycmF5cyAocS9xdilcbiAgICAgICAgICAgIGZpbHRlck1hcC5xLnB1c2goayk7XG4gICAgICAgICAgICBmaWx0ZXJNYXAucXYucHVzaCh2KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmaWx0ZXJNYXA7XG4gICAgfSxcblxuICAgIC8qKiBvdmVycmlkZSB0byByZXNldCBhbGxGZXRjaGVkIGZsYWcgdG8gZmFsc2UgKi9cbiAgICByZXNldDogZnVuY3Rpb24obW9kZWxzLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuYWxsRmV0Y2hlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gQmFja2JvbmUuQ29sbGVjdGlvbi5wcm90b3R5cGUucmVzZXQuY2FsbCh0aGlzLCBtb2RlbHMsIG9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gb3JkZXJcbiAgICBvcmRlcjogbnVsbCxcblxuICAgIC8qKiBAdHlwZSB7T2JqZWN0fSBtYXAgb2YgY29sbGVjdGlvbiBhdmFpbGFibGUgc29ydGluZyBvcmRlcnMgY29udGFpbmluZyBjb21wYXJhdG9yIGZucyAqL1xuICAgIGNvbXBhcmF0b3JzOiB7XG4gICAgICAgIHVwZGF0ZV90aW1lOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJ1cGRhdGVfdGltZVwiLCB7XG4gICAgICAgICAgICBhc2NlbmRpbmc6IGZhbHNlXG4gICAgICAgIH0pLFxuICAgICAgICBcInVwZGF0ZV90aW1lLWFzY1wiOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJ1cGRhdGVfdGltZVwiLCB7XG4gICAgICAgICAgICBhc2NlbmRpbmc6IHRydWVcbiAgICAgICAgfSksXG4gICAgICAgIGNyZWF0ZV90aW1lOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJjcmVhdGVfdGltZVwiLCB7XG4gICAgICAgICAgICBhc2NlbmRpbmc6IGZhbHNlXG4gICAgICAgIH0pLFxuICAgICAgICBcImNyZWF0ZV90aW1lLWFzY1wiOiBCQVNFX01WQy5idWlsZENvbXBhcmF0b3IoXCJjcmVhdGVfdGltZVwiLCB7XG4gICAgICAgICAgICBhc2NlbmRpbmc6IHRydWVcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgLyoqIHNldCB0aGUgb3JkZXIgYW5kIGNvbXBhcmF0b3IgZm9yIHRoaXMgY29sbGVjdGlvbiB0aGVuIHNvcnQgd2l0aCB0aGUgbmV3IG9yZGVyXG4gICAgICogIEBldmVudCAnY2hhbmdlZC1vcmRlcicgcGFzc2VkIHRoZSBuZXcgb3JkZXIgYW5kIHRoZSBjb2xsZWN0aW9uXG4gICAgICovXG4gICAgc2V0T3JkZXI6IGZ1bmN0aW9uKG9yZGVyLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG4gICAgICAgIHZhciBjb21wYXJhdG9yID0gY29sbGVjdGlvbi5jb21wYXJhdG9yc1tvcmRlcl07XG4gICAgICAgIGlmIChfLmlzVW5kZWZpbmVkKGNvbXBhcmF0b3IpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gb3JkZXI6ICR7b3JkZXJ9YCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYoIF8uaXNVbmRlZmluZWQoIGNvbXBhcmF0b3IgKSApeyByZXR1cm47IH1cbiAgICAgICAgaWYgKGNvbXBhcmF0b3IgPT09IGNvbGxlY3Rpb24uY29tcGFyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29sbGVjdGlvbi5vcmRlciA9IG9yZGVyO1xuICAgICAgICBjb2xsZWN0aW9uLmNvbXBhcmF0b3IgPSBjb21wYXJhdG9yO1xuXG4gICAgICAgIGlmICghb3B0aW9ucy5zaWxlbnQpIHtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24udHJpZ2dlcihcImNoYW5nZWQtb3JkZXJcIiwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgfVxufSk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKlxuICpcbiAqL1xudmFyIFBhZ2luYXRlZENvbGxlY3Rpb24gPSBDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uLmV4dGVuZCh7XG4gICAgLyoqIEB0eXBlIHtOdW1iZXJ9IGxpbWl0IHVzZWQgZm9yIGVhY2ggcGFnZSdzIGZldGNoICovXG4gICAgbGltaXRQZXJQYWdlOiA1MDAsXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihtb2RlbHMsIG9wdGlvbnMpIHtcbiAgICAgICAgQ29udHJvbGxlZEZldGNoQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIG1vZGVscywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSBvcHRpb25zLmN1cnJlbnRQYWdlIHx8IDA7XG4gICAgfSxcblxuICAgIGdldFRvdGFsSXRlbUNvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoO1xuICAgIH0sXG5cbiAgICBzaG91bGRQYWdpbmF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRvdGFsSXRlbUNvdW50KCkgPj0gdGhpcy5saW1pdFBlclBhZ2U7XG4gICAgfSxcblxuICAgIGdldExhc3RQYWdlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy5nZXRUb3RhbEl0ZW1Db3VudCgpIC8gdGhpcy5saW1pdFBlclBhZ2UpO1xuICAgIH0sXG5cbiAgICBnZXRQYWdlQ291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRMYXN0UGFnZSgpICsgMTtcbiAgICB9LFxuXG4gICAgZ2V0UGFnZUxpbWl0T2Zmc2V0OiBmdW5jdGlvbihwYWdlTnVtKSB7XG4gICAgICAgIHBhZ2VOdW0gPSB0aGlzLmNvbnN0cmFpblBhZ2VOdW0ocGFnZU51bSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsaW1pdDogdGhpcy5saW1pdFBlclBhZ2UsXG4gICAgICAgICAgICBvZmZzZXQ6IHBhZ2VOdW0gKiB0aGlzLmxpbWl0UGVyUGFnZVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICBjb25zdHJhaW5QYWdlTnVtOiBmdW5jdGlvbihwYWdlTnVtKSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbihwYWdlTnVtLCB0aGlzLmdldExhc3RQYWdlKCkpKTtcbiAgICB9LFxuXG4gICAgLyoqIGZldGNoIHRoZSBuZXh0IHBhZ2Ugb2YgZGF0YSAqL1xuICAgIGZldGNoUGFnZTogZnVuY3Rpb24ocGFnZU51bSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHBhZ2VOdW0gPSBzZWxmLmNvbnN0cmFpblBhZ2VOdW0ocGFnZU51bSk7XG4gICAgICAgIHNlbGYuY3VycmVudFBhZ2UgPSBwYWdlTnVtO1xuICAgICAgICBvcHRpb25zID0gXy5kZWZhdWx0cyhvcHRpb25zIHx8IHt9LCBzZWxmLmdldFBhZ2VMaW1pdE9mZnNldChwYWdlTnVtKSk7XG5cbiAgICAgICAgc2VsZi50cmlnZ2VyKFwiZmV0Y2hpbmctbW9yZVwiKTtcbiAgICAgICAgcmV0dXJuIHNlbGYuZmV0Y2gob3B0aW9ucykuYWx3YXlzKCgpID0+IHtcbiAgICAgICAgICAgIHNlbGYudHJpZ2dlcihcImZldGNoaW5nLW1vcmUtZG9uZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIGZldGNoQ3VycmVudFBhZ2U6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hQYWdlKHRoaXMuY3VycmVudFBhZ2UsIG9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICBmZXRjaFByZXZQYWdlOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoUGFnZSh0aGlzLmN1cnJlbnRQYWdlIC0gMSwgb3B0aW9ucyk7XG4gICAgfSxcblxuICAgIGZldGNoTmV4dFBhZ2U6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hQYWdlKHRoaXMuY3VycmVudFBhZ2UgKyAxLCBvcHRpb25zKTtcbiAgICB9XG59KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqXG4gKiBBIENvbGxlY3Rpb24gdGhhdCB3aWxsIGxvYWQgbW9yZSBlbGVtZW50cyB3aXRob3V0IHJlc2V0aW5nLlxuICovXG52YXIgSW5maW5pdGVseVNjcm9sbGluZ0NvbGxlY3Rpb24gPSBDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uLmV4dGVuZCh7XG4gICAgLyoqIEB0eXBlIHtOdW1iZXJ9IGxpbWl0IHVzZWQgZm9yIHRoZSBmaXJzdCBmZXRjaCAob3IgYSByZXNldCkgKi9cbiAgICBsaW1pdE9uRmlyc3RGZXRjaDogbnVsbCxcbiAgICAvKiogQHR5cGUge051bWJlcn0gbGltaXQgdXNlZCBmb3IgZWFjaCBzdWJzZXF1ZW50IGZldGNoICovXG4gICAgbGltaXRQZXJGZXRjaDogMTAwLFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24obW9kZWxzLCBvcHRpb25zKSB7XG4gICAgICAgIENvbnRyb2xsZWRGZXRjaENvbGxlY3Rpb24ucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBtb2RlbHMsIG9wdGlvbnMpO1xuICAgICAgICAvKiogQHR5cGUge0ludGVnZXJ9IG51bWJlciBvZiBjb250ZW50cyB0byByZXR1cm4gZnJvbSB0aGUgZmlyc3QgZmV0Y2ggKi9cbiAgICAgICAgdGhpcy5saW1pdE9uRmlyc3RGZXRjaCA9IG9wdGlvbnMubGltaXRPbkZpcnN0RmV0Y2ggfHwgdGhpcy5saW1pdE9uRmlyc3RGZXRjaDtcbiAgICAgICAgLyoqIEB0eXBlIHtJbnRlZ2VyfSBsaW1pdCBmb3IgZXZlcnkgZmV0Y2ggYWZ0ZXIgdGhlIGZpcnN0ICovXG4gICAgICAgIHRoaXMubGltaXRQZXJGZXRjaCA9IG9wdGlvbnMubGltaXRQZXJGZXRjaCB8fCB0aGlzLmxpbWl0UGVyRmV0Y2g7XG4gICAgICAgIC8qKiBAdHlwZSB7Qm9vbGVhbn0gYXJlIGFsbCBjb250ZW50cyBmZXRjaGVkPyAqL1xuICAgICAgICB0aGlzLmFsbEZldGNoZWQgPSBmYWxzZTtcbiAgICAgICAgLyoqIEB0eXBlIHtJbnRlZ2VyfSB3aGF0IHdhcyB0aGUgb2Zmc2V0IG9mIHRoZSBsYXN0IGNvbnRlbnQgcmV0dXJuZWQgKi9cbiAgICAgICAgdGhpcy5sYXN0RmV0Y2hlZCA9IG9wdGlvbnMubGFzdEZldGNoZWQgfHwgMDtcbiAgICB9LFxuXG4gICAgLyoqIGJ1aWxkIGFqYXggZGF0YS9wYXJhbWV0ZXJzIGZyb20gb3B0aW9ucyAqL1xuICAgIF9idWlsZEZldGNoT3B0aW9uczogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAvLyBvcHRpb25zIChvcHRpb25zIGZvciBiYWNrYm9uZS5mZXRjaCBhbmQganF1ZXJ5LmFqYXggZ2VuZXJhbGx5KVxuICAgICAgICAvLyBiYWNrYm9uZSBvcHRpb247IGZhbHNlIGhlcmUgdG8gbWFrZSBmZXRjaGluZyBhbiBhZGRpdGl0aXZlIHByb2Nlc3NcbiAgICAgICAgb3B0aW9ucy5yZW1vdmUgPSBvcHRpb25zLnJlbW92ZSB8fCBmYWxzZTtcbiAgICAgICAgcmV0dXJuIENvbnRyb2xsZWRGZXRjaENvbGxlY3Rpb24ucHJvdG90eXBlLl9idWlsZEZldGNoT3B0aW9ucy5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIH0sXG5cbiAgICAvKiogZmV0Y2ggdGhlIGZpcnN0ICdwYWdlJyBvZiBkYXRhICovXG4gICAgZmV0Y2hGaXJzdDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBHYWxheHkuZGVidWcoXCJDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uLmZldGNoRmlyc3Q6XCIsIG9wdGlvbnMpO1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyA/IF8uY2xvbmUob3B0aW9ucykgOiB7fTtcbiAgICAgICAgdGhpcy5hbGxGZXRjaGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGFzdEZldGNoZWQgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaE1vcmUoXG4gICAgICAgICAgICBfLmRlZmF1bHRzKG9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICByZXNldDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBsaW1pdDogdGhpcy5saW1pdE9uRmlyc3RGZXRjaFxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9LFxuXG4gICAgLyoqIGZldGNoIHRoZSBuZXh0IHBhZ2Ugb2YgZGF0YSAqL1xuICAgIGZldGNoTW9yZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBHYWxheHkuZGVidWcoXCJDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uLmZldGNoTW9yZTpcIiwgb3B0aW9ucyk7XG4gICAgICAgIG9wdGlvbnMgPSBfLmNsb25lKG9wdGlvbnMgfHwge30pO1xuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IHRoaXM7XG5cbiAgICAgICAgR2FsYXh5LmRlYnVnKFwiZmV0Y2hNb3JlLCBvcHRpb25zLnJlc2V0OlwiLCBvcHRpb25zLnJlc2V0KTtcbiAgICAgICAgaWYgKCFvcHRpb25zLnJlc2V0ICYmIGNvbGxlY3Rpb24uYWxsRmV0Y2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPOiB0aGlzIGZhaWxzIGluIHRoZSBlZGdlIGNhc2Ugd2hlcmVcbiAgICAgICAgLy8gIHRoZSBmaXJzdCBmZXRjaCBvZmZzZXQgPT09IGxpbWl0IChsaW1pdCA0LCBvZmZzZXQgNCwgY29sbGVjdGlvbi5sZW5ndGggNClcbiAgICAgICAgaWYgKG9wdGlvbnMucmVzZXQpIHtcbiAgICAgICAgICAgIG9wdGlvbnMub2Zmc2V0ID0gMDtcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLm9mZnNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvcHRpb25zLm9mZnNldCA9IGNvbGxlY3Rpb24ubGFzdEZldGNoZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpbWl0ID0gKG9wdGlvbnMubGltaXQgPSBvcHRpb25zLmxpbWl0IHx8IGNvbGxlY3Rpb24ubGltaXRQZXJGZXRjaCB8fCBudWxsKTtcbiAgICAgICAgR2FsYXh5LmRlYnVnKFwiZmV0Y2hNb3JlLCBsaW1pdDpcIiwgbGltaXQsIFwib2Zmc2V0OlwiLCBvcHRpb25zLm9mZnNldCk7XG5cbiAgICAgICAgY29sbGVjdGlvbi50cmlnZ2VyKFwiZmV0Y2hpbmctbW9yZVwiKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIGNvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICAuZmV0Y2gob3B0aW9ucylcbiAgICAgICAgICAgICAgICAuYWx3YXlzKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi50cmlnZ2VyKFwiZmV0Y2hpbmctbW9yZS1kb25lXCIpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLy8gbWFpbnRhaW4gYWxsRmV0Y2hlZCBmbGFnIGFuZCB0cmlnZ2VyIGlmIGFsbCB3ZXJlIGZldGNoZWQgdGhpcyB0aW1lXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24gX3Bvc3RGZXRjaE1vcmUoZmV0Y2hlZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bUZldGNoZWQgPSBfLmlzQXJyYXkoZmV0Y2hlZERhdGEpID8gZmV0Y2hlZERhdGEubGVuZ3RoIDogMDtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5sYXN0RmV0Y2hlZCArPSBudW1GZXRjaGVkO1xuICAgICAgICAgICAgICAgICAgICBHYWxheHkuZGVidWcoXCJmZXRjaE1vcmUsIGxhc3RGZXRjaGVkOlwiLCBjb2xsZWN0aW9uLmxhc3RGZXRjaGVkKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYW55dGhpbmcgbGVzcyB0aGFuIGEgZnVsbCBwYWdlIG1lYW5zIHdlIGdvdCBhbGwgdGhlcmUgaXMgdG8gZ2V0XG4gICAgICAgICAgICAgICAgICAgIGlmICghbGltaXQgfHwgbnVtRmV0Y2hlZCA8IGxpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLmFsbEZldGNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi50cmlnZ2VyKFwiYWxsLWZldGNoZWRcIiwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH0sXG5cbiAgICAvKiogZmV0Y2ggYWxsIHRoZSBjb2xsZWN0aW9uICovXG4gICAgZmV0Y2hBbGw6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gd2hpdGVsaXN0IG9wdGlvbnMgdG8gcHJldmVudCBhbGxvd2luZyBsaW1pdC9vZmZzZXQvZmlsdGVyc1xuICAgICAgICAvLyAodXNlIHZhbmlsbGEgZmV0Y2ggaW5zdGVhZClcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgb3B0aW9ucyA9IF8ucGljayhvcHRpb25zLCBcInNpbGVudFwiKTtcbiAgICAgICAgb3B0aW9ucy5maWx0ZXJzID0ge307XG4gICAgICAgIHJldHVybiBzZWxmLmZldGNoKG9wdGlvbnMpLmRvbmUoKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5hbGxGZXRjaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHNlbGYudHJpZ2dlcihcImFsbC1mZXRjaGVkXCIsIHNlbGYpO1xuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uOiBDb250cm9sbGVkRmV0Y2hDb2xsZWN0aW9uLFxuICAgIFBhZ2luYXRlZENvbGxlY3Rpb246IFBhZ2luYXRlZENvbGxlY3Rpb24sXG4gICAgSW5maW5pdGVseVNjcm9sbGluZ0NvbGxlY3Rpb246IEluZmluaXRlbHlTY3JvbGxpbmdDb2xsZWN0aW9uXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9iYXNlL2NvbnRyb2xsZWQtZmV0Y2gtY29sbGVjdGlvbi5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQVZBO0FBQ0E7QUFjQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdKQTtBQUNBO0FBK0pBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNURBO0FBQ0E7QUE4REE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlGQTtBQUNBO0FBZ0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///56\n");

/***/ }),
/* 57 */
/*!***********************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-preferences.js ***!
  \***********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"history\";\n\n// ============================================================================\n/** session storage for individual history preferences */\nvar HistoryPrefs = _baseMvc2.default.SessionStorageModel.extend(\n/** @lends HistoryPrefs.prototype */{\n    //TODO:?? move to user prefs?\n    defaults: {\n        //TODO:?? expandedIds to array?\n        expandedIds: {},\n        show_deleted: false,\n        show_hidden: false\n    },\n\n    /** add an hda id to the hash of expanded hdas */\n    addExpanded: function addExpanded(model) {\n        //TODO: use type_id and not model\n        var current = this.get(\"expandedIds\");\n        current[model.id] = model.get(\"id\");\n        this.save(\"expandedIds\", current);\n    },\n\n    /** remove an hda id from the hash of expanded hdas */\n    removeExpanded: function removeExpanded(model) {\n        var current = this.get(\"expandedIds\");\n        delete current[model.id];\n        this.save(\"expandedIds\", current);\n    },\n\n    isExpanded: function isExpanded(contentId) {\n        return _.result(this.get(\"expandedIds\"), contentId, false);\n    },\n\n    allExpanded: function allExpanded() {\n        return _.values(this.get(\"expandedIds\"));\n    },\n\n    clearExpanded: function clearExpanded() {\n        this.set(\"expandedIds\", {});\n    },\n\n    includeDeleted: function includeDeleted(val) {\n        // moving the invocation here so other components don't need to know the key\n        // TODO: change this key later\n        if (!_.isUndefined(val)) {\n            this.set(\"show_deleted\", val);\n        }\n        return this.get(\"show_deleted\");\n    },\n\n    includeHidden: function includeHidden(val) {\n        // TODO: change this key later\n        if (!_.isUndefined(val)) {\n            this.set(\"show_hidden\", val);\n        }\n        return this.get(\"show_hidden\");\n    },\n\n    toString: function toString() {\n        return \"HistoryPrefs(\" + this.id + \")\";\n    }\n}, {\n    // ........................................................................ class vars\n    // class lvl for access w/o instantiation\n    storageKeyPrefix: \"history:\",\n\n    /** key string to store each histories settings under */\n    historyStorageKey: function historyStorageKey(historyId) {\n        if (!historyId) {\n            throw new Error(\"HistoryPrefs.historyStorageKey needs valid id: \" + historyId);\n        }\n        // single point of change\n        return HistoryPrefs.storageKeyPrefix + historyId;\n    },\n\n    /** return the existing storage for the history with the given id (or create one if it doesn't exist) */\n    get: function get(historyId) {\n        return new HistoryPrefs({\n            id: HistoryPrefs.historyStorageKey(historyId)\n        });\n    },\n\n    /** clear all history related items in sessionStorage */\n    clearAll: function clearAll(historyId) {\n        for (var key in sessionStorage) {\n            if (key.indexOf(HistoryPrefs.storageKeyPrefix) === 0) {\n                sessionStorage.removeItem(key);\n            }\n        }\n    }\n});\n\n//==============================================================================\nexports.default = {\n    HistoryPrefs: HistoryPrefs\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1wcmVmZXJlbmNlcy5qcz85YmIxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImhpc3RvcnlcIjtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIHNlc3Npb24gc3RvcmFnZSBmb3IgaW5kaXZpZHVhbCBoaXN0b3J5IHByZWZlcmVuY2VzICovXG52YXIgSGlzdG9yeVByZWZzID0gQkFTRV9NVkMuU2Vzc2lvblN0b3JhZ2VNb2RlbC5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBIaXN0b3J5UHJlZnMucHJvdG90eXBlICovIHtcbiAgICAgICAgLy9UT0RPOj8/IG1vdmUgdG8gdXNlciBwcmVmcz9cbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIC8vVE9ETzo/PyBleHBhbmRlZElkcyB0byBhcnJheT9cbiAgICAgICAgICAgIGV4cGFuZGVkSWRzOiB7fSxcbiAgICAgICAgICAgIHNob3dfZGVsZXRlZDogZmFsc2UsXG4gICAgICAgICAgICBzaG93X2hpZGRlbjogZmFsc2VcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogYWRkIGFuIGhkYSBpZCB0byB0aGUgaGFzaCBvZiBleHBhbmRlZCBoZGFzICovXG4gICAgICAgIGFkZEV4cGFuZGVkOiBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgLy9UT0RPOiB1c2UgdHlwZV9pZCBhbmQgbm90IG1vZGVsXG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuZ2V0KFwiZXhwYW5kZWRJZHNcIik7XG4gICAgICAgICAgICBjdXJyZW50W21vZGVsLmlkXSA9IG1vZGVsLmdldChcImlkXCIpO1xuICAgICAgICAgICAgdGhpcy5zYXZlKFwiZXhwYW5kZWRJZHNcIiwgY3VycmVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbW92ZSBhbiBoZGEgaWQgZnJvbSB0aGUgaGFzaCBvZiBleHBhbmRlZCBoZGFzICovXG4gICAgICAgIHJlbW92ZUV4cGFuZGVkOiBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLmdldChcImV4cGFuZGVkSWRzXCIpO1xuICAgICAgICAgICAgZGVsZXRlIGN1cnJlbnRbbW9kZWwuaWRdO1xuICAgICAgICAgICAgdGhpcy5zYXZlKFwiZXhwYW5kZWRJZHNcIiwgY3VycmVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNFeHBhbmRlZDogZnVuY3Rpb24oY29udGVudElkKSB7XG4gICAgICAgICAgICByZXR1cm4gXy5yZXN1bHQodGhpcy5nZXQoXCJleHBhbmRlZElkc1wiKSwgY29udGVudElkLCBmYWxzZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWxsRXhwYW5kZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIF8udmFsdWVzKHRoaXMuZ2V0KFwiZXhwYW5kZWRJZHNcIikpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNsZWFyRXhwYW5kZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5zZXQoXCJleHBhbmRlZElkc1wiLCB7fSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5jbHVkZURlbGV0ZWQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgLy8gbW92aW5nIHRoZSBpbnZvY2F0aW9uIGhlcmUgc28gb3RoZXIgY29tcG9uZW50cyBkb24ndCBuZWVkIHRvIGtub3cgdGhlIGtleVxuICAgICAgICAgICAgLy8gVE9ETzogY2hhbmdlIHRoaXMga2V5IGxhdGVyXG4gICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQodmFsKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwic2hvd19kZWxldGVkXCIsIHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoXCJzaG93X2RlbGV0ZWRcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5jbHVkZUhpZGRlbjogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBjaGFuZ2UgdGhpcyBrZXkgbGF0ZXJcbiAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWwpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJzaG93X2hpZGRlblwiLCB2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0KFwic2hvd19oaWRkZW5cIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGBIaXN0b3J5UHJlZnMoJHt0aGlzLmlkfSlgO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBjbGFzcyB2YXJzXG4gICAgICAgIC8vIGNsYXNzIGx2bCBmb3IgYWNjZXNzIHcvbyBpbnN0YW50aWF0aW9uXG4gICAgICAgIHN0b3JhZ2VLZXlQcmVmaXg6IFwiaGlzdG9yeTpcIixcblxuICAgICAgICAvKioga2V5IHN0cmluZyB0byBzdG9yZSBlYWNoIGhpc3RvcmllcyBzZXR0aW5ncyB1bmRlciAqL1xuICAgICAgICBoaXN0b3J5U3RvcmFnZUtleTogZnVuY3Rpb24gaGlzdG9yeVN0b3JhZ2VLZXkoaGlzdG9yeUlkKSB7XG4gICAgICAgICAgICBpZiAoIWhpc3RvcnlJZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSGlzdG9yeVByZWZzLmhpc3RvcnlTdG9yYWdlS2V5IG5lZWRzIHZhbGlkIGlkOiAke2hpc3RvcnlJZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHNpbmdsZSBwb2ludCBvZiBjaGFuZ2VcbiAgICAgICAgICAgIHJldHVybiBIaXN0b3J5UHJlZnMuc3RvcmFnZUtleVByZWZpeCArIGhpc3RvcnlJZDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmV0dXJuIHRoZSBleGlzdGluZyBzdG9yYWdlIGZvciB0aGUgaGlzdG9yeSB3aXRoIHRoZSBnaXZlbiBpZCAob3IgY3JlYXRlIG9uZSBpZiBpdCBkb2Vzbid0IGV4aXN0KSAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldChoaXN0b3J5SWQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSGlzdG9yeVByZWZzKHtcbiAgICAgICAgICAgICAgICBpZDogSGlzdG9yeVByZWZzLmhpc3RvcnlTdG9yYWdlS2V5KGhpc3RvcnlJZClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBjbGVhciBhbGwgaGlzdG9yeSByZWxhdGVkIGl0ZW1zIGluIHNlc3Npb25TdG9yYWdlICovXG4gICAgICAgIGNsZWFyQWxsOiBmdW5jdGlvbiBjbGVhckFsbChoaXN0b3J5SWQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzZXNzaW9uU3RvcmFnZSkge1xuICAgICAgICAgICAgICAgIGlmIChrZXkuaW5kZXhPZihIaXN0b3J5UHJlZnMuc3RvcmFnZUtleVByZWZpeCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSGlzdG9yeVByZWZzOiBIaXN0b3J5UHJlZnNcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1wcmVmZXJlbmNlcy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXZEQTtBQTBEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQUNBO0FBK0JBO0FBQ0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///57\n");

/***/ }),
/* 58 */
/*!****************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-view.js ***!
  \****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listView = __webpack_require__(/*! mvc/list/list-view */ 39);\n\nvar _listView2 = _interopRequireDefault(_listView);\n\nvar _historyModel = __webpack_require__(/*! mvc/history/history-model */ 31);\n\nvar _historyModel2 = _interopRequireDefault(_historyModel);\n\nvar _historyContents = __webpack_require__(/*! mvc/history/history-contents */ 16);\n\nvar _historyContents2 = _interopRequireDefault(_historyContents);\n\nvar _historyPreferences = __webpack_require__(/*! mvc/history/history-preferences */ 57);\n\nvar _historyPreferences2 = _interopRequireDefault(_historyPreferences);\n\nvar _hdaLi = __webpack_require__(/*! mvc/history/hda-li */ 41);\n\nvar _hdaLi2 = _interopRequireDefault(_hdaLi);\n\nvar _hdcaLi = __webpack_require__(/*! mvc/history/hdca-li */ 42);\n\nvar _hdcaLi2 = _interopRequireDefault(_hdcaLi);\n\nvar _userModel = __webpack_require__(/*! mvc/user/user-model */ 67);\n\nvar _userModel2 = _interopRequireDefault(_userModel);\n\nvar _errorModal = __webpack_require__(/*! mvc/ui/error-modal */ 37);\n\nvar _errorModal2 = _interopRequireDefault(_errorModal);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/search-input */ 40);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* =============================================================================\nTODO:\n\n============================================================================= */\n/** @class  non-editable, read-only View/Controller for a history model.\n *  Allows:\n *      changing the loaded history\n *      displaying data, info, and download\n *      tracking history attrs: size, tags, annotations, name, etc.\n *  Does not allow:\n *      changing the name\n */\nvar _super = _listView2.default.ModelListPanel;\nvar HistoryView = _super.extend(\n/** @lends HistoryView.prototype */{\n    _logNamespace: \"history\",\n\n    /** class to use for constructing the HDA views */\n    HDAViewClass: _hdaLi2.default.HDAListItemView,\n    /** class to use for constructing the HDCA views */\n    HDCAViewClass: _hdcaLi2.default.HDCAListItemView,\n    /** class to used for constructing collection of sub-view models */\n    collectionClass: _historyContents2.default.HistoryContents,\n    /** key of attribute in model to assign to this.collection */\n    modelCollectionKey: \"contents\",\n\n    tagName: \"div\",\n    className: _super.prototype.className + \" history-panel\",\n\n    /** string to display when the collection is empty */\n    emptyMsg: (0, _localization2.default)(\"This history is empty\"),\n    /** displayed when no items match the search terms */\n    noneFoundMsg: (0, _localization2.default)(\"No matching datasets found\"),\n    /** string used for search placeholder */\n    searchPlaceholder: (0, _localization2.default)(\"search datasets\"),\n\n    // ......................................................................... SET UP\n    /** Set up the view, bind listeners.\n     *  @param {Object} attributes optional settings for the panel\n     */\n    initialize: function initialize(attributes) {\n        _super.prototype.initialize.call(this, attributes);\n        // ---- instance vars\n        // control contents/behavior based on where (and in what context) the panel is being used\n        /** where should pages from links be displayed? (default to new tab/window) */\n        this.linkTarget = attributes.linkTarget || \"_blank\";\n    },\n\n    /** create and return a collection for when none is initially passed */\n    _createDefaultCollection: function _createDefaultCollection() {\n        // override\n        return new this.collectionClass([], {\n            history: this.model\n        });\n    },\n\n    /** In this override, clear the update timer on the model */\n    freeModel: function freeModel() {\n        _super.prototype.freeModel.call(this);\n        if (this.model) {\n            this.model.stopPolling();\n        }\n        return this;\n    },\n\n    /** create any event listeners for the panel\n     *  @fires: rendered:initial    on the first render\n     *  @fires: empty-history       when switching to a history with no contents or creating a new history\n     */\n    _setUpListeners: function _setUpListeners() {\n        _super.prototype._setUpListeners.call(this);\n        this.on({\n            error: function error(model, xhr, options, msg, details) {\n                this.errorHandler(model, xhr, options, msg, details);\n            },\n            \"views:ready view:attached view:removed\": function viewsReadyViewAttachedViewRemoved(view) {\n                this._renderSelectButton();\n            },\n            \"view:attached\": function viewAttached(view) {\n                this.scrollTo(0);\n            }\n        });\n        // this.on( 'all', function(){ console.debug( arguments ); });\n    },\n\n    // ------------------------------------------------------------------------ loading history/hda models\n    /** load the history with the given id then it's contents, sending ajax options to both */\n    loadHistory: function loadHistory(historyId, options, contentsOptions) {\n        var _this = this;\n\n        contentsOptions = _.extend(contentsOptions || { silent: true });\n        this.info(\"loadHistory:\", historyId, options, contentsOptions);\n        this.setModel(new _historyModel2.default.History({ id: historyId }));\n\n        contentsOptions.silent = true;\n        this.trigger(\"loading\");\n        return this.model.fetchWithContents(options, contentsOptions).always(function () {\n            _this.render();\n            _this.trigger(\"loading-done\");\n        });\n    },\n\n    /** convenience alias to the model. Updates the item list only (not the history) */\n    refreshContents: function refreshContents(options) {\n        if (this.model) {\n            return this.model.refresh(options);\n        }\n        // may have callbacks - so return an empty promise\n        return $.when();\n    },\n\n    /** Override to reset web storage when the id changes (since it needs the id) */\n    _setUpCollectionListeners: function _setUpCollectionListeners() {\n        _super.prototype._setUpCollectionListeners.call(this);\n        return this.listenTo(this.collection, {\n            // 'all' : function(){ console.log( this.collection + ':', arguments ); },\n            \"fetching-more\": function fetchingMore() {\n                this._toggleContentsLoadingIndicator(true);\n                this.$emptyMessage().hide();\n            },\n            \"fetching-more-done\": function fetchingMoreDone() {\n                this._toggleContentsLoadingIndicator(false);\n            }\n        });\n    },\n\n    // ------------------------------------------------------------------------ panel rendering\n    /** hide the $el and display a loading indicator (in the $el's parent) when loading new data */\n    _showLoadingIndicator: function _showLoadingIndicator(msg, speed, callback) {\n        var $indicator = $('<div class=\"loading-indicator\"/>');\n        this.$el.html($indicator.text(msg).slideDown(!_.isUndefined(speed) ? speed : this.fxSpeed));\n    },\n\n    /** hide the loading indicator */\n    _hideLoadingIndicator: function _hideLoadingIndicator(speed) {\n        // make speed a bit slower to compensate for slow rendering of up to 500 contents\n        this.$(\".loading-indicator\").slideUp(!_.isUndefined(speed) ? speed : this.fxSpeed + 200, function () {\n            $(this).remove();\n        });\n    },\n\n    /** In this override, add a btn to toggle the selectors */\n    _buildNewRender: function _buildNewRender() {\n        var $newRender = _super.prototype._buildNewRender.call(this);\n        this._renderSelectButton($newRender);\n        return $newRender;\n    },\n\n    /** button for starting select mode */\n    _renderSelectButton: function _renderSelectButton($where) {\n        $where = $where || this.$el;\n        // do not render selector option if no actions\n        if (!this.multiselectActions().length) {\n            return null;\n        }\n        // do not render (and remove even) if nothing to select\n        if (!this.views.length) {\n            this.hideSelectors();\n            $where.find(\".controls .actions .show-selectors-btn\").remove();\n            return null;\n        }\n        // don't bother rendering if there's one already\n        var $existing = $where.find(\".controls .actions .show-selectors-btn\");\n        if ($existing.length) {\n            return $existing;\n        }\n\n        return (0, _faIconButton2.default)({\n            title: (0, _localization2.default)(\"Operations on multiple datasets\"),\n            classes: \"show-selectors-btn\",\n            faIcon: \"fa-check-square-o\"\n        }).prependTo($where.find(\".controls .actions\"));\n    },\n\n    /** override to avoid showing intial empty message using contents_active */\n    _renderEmptyMessage: function _renderEmptyMessage($whereTo) {\n        var $emptyMsg = this.$emptyMessage($whereTo);\n        var empty = this.model.get(\"contents_active\").active <= 0;\n        if (empty) {\n            return $emptyMsg.empty().append(this.emptyMsg).show();\n        } else if (this.searchFor && this.model.contents.haveSearchDetails() && !this.views.length) {\n            return $emptyMsg.empty().append(this.noneFoundMsg).show();\n        }\n        $emptyMsg.hide();\n        return $();\n    },\n\n    /** the scroll container for this panel - can be $el, $el.parent(), or grandparent depending on context */\n    $scrollContainer: function $scrollContainer($where) {\n        // override or set via attributes.$scrollContainer\n        return this.$list($where);\n    },\n\n    // ------------------------------------------------------------------------ subviews\n    _toggleContentsLoadingIndicator: function _toggleContentsLoadingIndicator(show) {\n        if (!show) {\n            this.$list().find(\".contents-loading-indicator\").remove();\n        } else {\n            this.$list().html('<div class=\"contents-loading-indicator\">' + '<span class=\"fa fa-2x fa-spinner fa-spin\"/></div>');\n        }\n    },\n\n    /** override to render pagination also */\n    renderItems: function renderItems($whereTo) {\n        // console.log( this + '.renderItems-----------------', new Date() );\n        $whereTo = $whereTo || this.$el;\n        var $list = this.$list($whereTo);\n\n        // TODO: bootstrap hack to remove orphaned tooltips\n        $(\".tooltip\").remove();\n\n        $list.empty();\n        this.views = [];\n\n        var models = this._filterCollection();\n        if (models.length) {\n            this._renderPagination($whereTo);\n            this.views = this._renderSomeItems(models, $list);\n        } else {\n            // TODO: consolidate with _renderPagination above by (???) passing in models/length?\n            $whereTo.find(\"> .controls .list-pagination\").empty();\n        }\n        this._renderEmptyMessage($whereTo).toggle(!models.length);\n\n        this.trigger(\"views:ready\", this.views);\n        return this.views;\n    },\n\n    /** render pagination controls if not searching and contents says we're paginating */\n    _renderPagination: function _renderPagination($whereTo) {\n        var $paginationControls = $whereTo.find(\"> .controls .list-pagination\");\n        if (this.searchFor || !this.model.contents.shouldPaginate()) return $paginationControls.empty();\n\n        $paginationControls.html(this.templates.pagination({\n            // pagination is 1-based for the user\n            current: this.model.contents.currentPage + 1,\n            last: this.model.contents.getLastPage() + 1\n        }, this));\n        $paginationControls.find(\"select.pages\").tooltip();\n        return $paginationControls;\n    },\n\n    /** render a subset of the entire collection (client-side pagination) */\n    _renderSomeItems: function _renderSomeItems(models, $list) {\n        var _this2 = this;\n\n        var views = [];\n        $list.append(models.map(function (m) {\n            var view = _this2._createItemView(m);\n            views.push(view);\n            return _this2._renderItemView$el(view);\n        }));\n        return views;\n    },\n\n    // ------------------------------------------------------------------------ sub-views\n    /** in this override, check if the contents would also display based on includeDeleted/hidden */\n    _filterItem: function _filterItem(model) {\n        var contents = this.model.contents;\n        return (contents.includeHidden || !model.hidden()) && (contents.includeDeleted || !model.isDeletedOrPurged()) && _super.prototype._filterItem.call(this, model);\n    },\n\n    /** In this override, since history contents are mixed,\n     *      get the appropo view class based on history_content_type\n     */\n    _getItemViewClass: function _getItemViewClass(model) {\n        var contentType = model.get(\"history_content_type\");\n        switch (contentType) {\n            case \"dataset\":\n                return this.HDAViewClass;\n            case \"dataset_collection\":\n                return this.HDCAViewClass;\n        }\n        throw new TypeError(\"Unknown history_content_type: \" + contentType);\n    },\n\n    /** in this override, add a linktarget, and expand if id is in web storage */\n    _getItemViewOptions: function _getItemViewOptions(model) {\n        var options = _super.prototype._getItemViewOptions.call(this, model);\n        return _.extend(options, {\n            linkTarget: this.linkTarget,\n            expanded: this.model.contents.storage.isExpanded(model.id),\n            hasUser: this.model.ownedByCurrUser()\n        });\n    },\n\n    /** In this override, add/remove expanded/collapsed model ids to/from web storage */\n    _setUpItemViewListeners: function _setUpItemViewListeners(view) {\n        var panel = this;\n        _super.prototype._setUpItemViewListeners.call(panel, view);\n        //TODO: send from content view: this.model.collection.storage.addExpanded\n        // maintain a list of items whose bodies are expanded\n        return panel.listenTo(view, {\n            expanded: function expanded(v) {\n                panel.model.contents.storage.addExpanded(v.model);\n            },\n            collapsed: function collapsed(v) {\n                panel.model.contents.storage.removeExpanded(v.model);\n            }\n        });\n    },\n\n    /** override to remove expandedIds from webstorage */\n    collapseAll: function collapseAll() {\n        this.model.contents.storage.clearExpanded();\n        _super.prototype.collapseAll.call(this);\n    },\n\n    // ------------------------------------------------------------------------ selection\n    /** Override to correctly set the historyId of the new collection */\n    getSelectedModels: function getSelectedModels() {\n        var collection = _super.prototype.getSelectedModels.call(this);\n        collection.historyId = this.collection.historyId;\n        return collection;\n    },\n\n    // ------------------------------------------------------------------------ panel events\n    /** event map */\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .show-selectors-btn\": \"toggleSelectors\",\n        \"click > .controls .prev\": \"_clickPrevPage\",\n        \"click > .controls .next\": \"_clickNextPage\",\n        \"change > .controls .pages\": \"_changePageSelect\",\n        // allow (error) messages to be clicked away\n        \"click .messages [class$=message]\": \"clearMessages\"\n    }),\n\n    _clickPrevPage: function _clickPrevPage(ev) {\n        this.model.stopPolling();\n        this.model.contents.fetchPrevPage();\n    },\n\n    _clickNextPage: function _clickNextPage(ev) {\n        this.model.stopPolling();\n        this.model.contents.fetchNextPage();\n    },\n\n    _changePageSelect: function _changePageSelect(ev) {\n        this.model.stopPolling();\n        var page = $(ev.currentTarget).val();\n        this.model.contents.fetchPage(page);\n    },\n\n    /** Toggle and store the deleted visibility and re-render items\n     * @returns {Boolean} new setting\n     */\n    toggleShowDeleted: function toggleShowDeleted(show, options) {\n        show = show !== undefined ? show : !this.model.contents.includeDeleted;\n        var contents = this.model.contents;\n        contents.setIncludeDeleted(show, options);\n        this.trigger(\"show-deleted\", show);\n\n        contents.fetchCurrentPage({ renderAll: true });\n        return show;\n    },\n\n    /** Toggle and store whether to render explicity hidden contents\n     * @returns {Boolean} new setting\n     */\n    toggleShowHidden: function toggleShowHidden(show, store, options) {\n        // console.log( 'toggleShowHidden', show, store );\n        show = show !== undefined ? show : !this.model.contents.includeHidden;\n        var contents = this.model.contents;\n        contents.setIncludeHidden(show, options);\n        this.trigger(\"show-hidden\", show);\n\n        contents.fetchCurrentPage({ renderAll: true });\n        return show;\n    },\n\n    /** On the first search, if there are no details - load them, then search */\n    _firstSearch: function _firstSearch(searchFor) {\n        var _this3 = this;\n\n        var inputSelector = \"> .controls .search-input\";\n        this.log(\"onFirstSearch\", searchFor);\n\n        // if the contents already have enough details to search, search and return now\n        if (this.model.contents.haveSearchDetails()) {\n            this.searchItems(searchFor);\n            return;\n        }\n\n        // otherwise, load the details progressively here\n        this.$(inputSelector).searchInput(\"toggle-loading\");\n        // set this now so that only results will show during progress\n        this.searchFor = searchFor;\n        var xhr = this.model.contents.progressivelyFetchDetails({ silent: true }).progress(function (response, limit, offset) {\n            _this3.renderItems();\n            _this3.trigger(\"search:loading-progress\", limit, offset);\n        }).always(function () {\n            _this3.$el.find(inputSelector).searchInput(\"toggle-loading\");\n        }).done(function () {\n            _this3.searchItems(searchFor, \"force\");\n        });\n    },\n\n    /** clear the search filters and show all views that are normally shown */\n    clearSearch: function clearSearch(searchFor) {\n        var _this4 = this;\n\n        if (!this.searchFor) return this;\n        //this.log( 'onSearchClear', this );\n        this.searchFor = \"\";\n        this.trigger(\"search:clear\", this);\n        this.$(\"> .controls .search-query\").val(\"\");\n        // NOTE: silent + render prevents collection update event with merge only\n        // - which causes an empty page due to event handler above\n        this.model.contents.fetchCurrentPage({ silent: true }).done(function () {\n            _this4.renderItems();\n        });\n        return this;\n    },\n\n    // ........................................................................ error handling\n    /** Event handler for errors (from the panel, the history, or the history's contents)\n     *  Alternately use two strings for model and xhr to use custom message and title (respectively)\n     *  @param {Model or View} model    the (Backbone) source of the error\n     *  @param {XMLHTTPRequest} xhr     any ajax obj. assoc. with the error\n     *  @param {Object} options         the options map commonly used with bbone ajax\n     */\n    errorHandler: function errorHandler(model, xhr, options) {\n        //TODO: to mixin or base model\n        // interrupted ajax or no connection\n        if (xhr && xhr.status === 0 && xhr.readyState === 0) {\n            // return ERROR_MODAL.offlineErrorModal();\n            // fail silently\n            return;\n        }\n        // otherwise, leave something to report in the console\n        this.error(model, xhr, options);\n        // and feedback to a modal\n        // if sent two strings (and possibly details as 'options'), use those as message and title\n        if (_.isString(model) && _.isString(xhr)) {\n            var message = model;\n            var title = xhr;\n            return _errorModal2.default.errorModal(message, title, options);\n        }\n        // bad gateway\n        // TODO: possibly to global handler\n        if (xhr && xhr.status === 502) {\n            return _errorModal2.default.badGatewayErrorModal();\n        }\n        return _errorModal2.default.ajaxErrorModal(model, xhr, options);\n    },\n\n    /** Remove all messages from the panel. */\n    clearMessages: function clearMessages(ev) {\n        var $target = !_.isUndefined(ev) ? $(ev.currentTarget) : this.$messages().children('[class$=\"message\"]');\n        $target.fadeOut(this.fxSpeed, function () {\n            $(this).remove();\n        });\n        return this;\n    },\n\n    // ........................................................................ scrolling\n    /** Scrolls the panel to show the content sub-view with the given hid.\n     *  @param {Integer} hid    the hid of item to scroll into view\n     *  @returns {HistoryView} the panel\n     */\n    scrollToHid: function scrollToHid(hid) {\n        return this.scrollToItem(_.first(this.viewsWhereModel({ hid: hid })));\n    },\n\n    // ........................................................................ misc\n    /** utility for adding -st, -nd, -rd, -th to numbers */\n    ordinalIndicator: function ordinalIndicator(number) {\n        var numStr = \"\" + number;\n        switch (numStr.charAt(numStr.length - 1)) {\n            case \"1\":\n                return numStr + \"st\";\n            case \"2\":\n                return numStr + \"nd\";\n            case \"3\":\n                return numStr + \"rd\";\n            default:\n                return numStr + \"th\";\n        }\n    },\n\n    /** Return a string rep of the history */\n    toString: function toString() {\n        return \"HistoryView(\" + (this.model ? this.model.get(\"name\") : \"\") + \")\";\n    }\n});\n\n//------------------------------------------------------------------------------ TEMPLATES\nHistoryView.prototype.templates = function () {\n    var mainTemplate = function mainTemplate() {\n        return \"<div>\\n            <div class=\\\"controls\\\"></div>\\n            <ul class=\\\"list-items\\\"></ul>\\n            <div class=\\\"empty-message infomessagesmall\\\"></div>',\\n        </div>\";\n    };\n\n    var controlsTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"controls\">', '<div class=\"title\">', '<div class=\"name\"><%- history.name %></div>', \"</div>\", '<div class=\"subtitle\"></div>', '<div class=\"history-size\"><%- history.nice_size %></div>', '<div class=\"actions\"></div>', '<div class=\"messages\">', \"<% if( history.deleted && history.purged ){ %>\", '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This history has been purged and deleted\"), \"</div>\", \"<% } else if( history.deleted ){ %>\", '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This history has been deleted\"), \"</div>\", \"<% } else if( history.purged ){ %>\", '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This history has been purged\"), \"</div>\", \"<% } %>\", \"<% if( history.message ){ %>\",\n    // should already be localized\n    '<div class=\"<%= history.message.level || \"info\" %>messagesmall\">', \"<%= history.message.text %>\", \"</div>\", \"<% } %>\", \"</div>\",\n\n    // add tags and annotations\n    '<div class=\"tags-display\"></div>', '<div class=\"annotation-display\"></div>', '<div class=\"search\">', '<div class=\"search-input\"></div>', \"</div>\", '<div class=\"list-actions\">', '<div class=\"btn-group\">', '<button class=\"select-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"All\"), \"</button>\", '<button class=\"deselect-all btn btn-default\"', 'data-mode=\"select\">', (0, _localization2.default)(\"None\"), \"</button>\", \"</div>\", '<div class=\"list-action-menu btn-group\">', \"</div>\", \"</div>\", '<div class=\"list-pagination form-inline\"></div>', \"</div>\"], \"history\");\n\n    var paginationTemplate = _baseMvc2.default.wrapTemplate(['<button class=\"prev\" <%- pages.current === 1 ? \"disabled\" : \"\" %>>previous</button>', '<select class=\"pages form-control\" ', 'title=\"', (0, _localization2.default)(\"Click to open and select a page. Begin typing a page number to select it\"), '\">', \"<% _.range( 1, pages.last + 1 ).forEach( function( i ){ %>\", '<option value=\"<%- i - 1 %>\" <%- i === pages.current ? \"selected\" : \"\" %>>', \"<%- view.ordinalIndicator( i ) %> of <%- pages.last %> pages\", \"</option>\", \"<% }); %>\", \"</select>\", '<button class=\"next\" <%- pages.current === pages.last ? \"disabled\" : \"\" %>>next</button>'], \"pages\");\n\n    return _.extend(_.clone(_super.prototype.templates), {\n        el: mainTemplate,\n        controls: controlsTemplate,\n        pagination: paginationTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    HistoryView: HistoryView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS12aWV3LmpzPzJmYzQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExJU1RfVklFVyBmcm9tIFwibXZjL2xpc3QvbGlzdC12aWV3XCI7XG5pbXBvcnQgSElTVE9SWV9NT0RFTCBmcm9tIFwibXZjL2hpc3RvcnkvaGlzdG9yeS1tb2RlbFwiO1xuaW1wb3J0IEhJU1RPUllfQ09OVEVOVFMgZnJvbSBcIm12Yy9oaXN0b3J5L2hpc3RvcnktY29udGVudHNcIjtcbmltcG9ydCBISVNUT1JZX1BSRUZTIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LXByZWZlcmVuY2VzXCI7XG5pbXBvcnQgSERBX0xJIGZyb20gXCJtdmMvaGlzdG9yeS9oZGEtbGlcIjtcbmltcG9ydCBIRENBX0xJIGZyb20gXCJtdmMvaGlzdG9yeS9oZGNhLWxpXCI7XG5pbXBvcnQgVVNFUiBmcm9tIFwibXZjL3VzZXIvdXNlci1tb2RlbFwiO1xuaW1wb3J0IEVSUk9SX01PREFMIGZyb20gXCJtdmMvdWkvZXJyb3ItbW9kYWxcIjtcbmltcG9ydCBmYUljb25CdXR0b24gZnJvbSBcInVpL2ZhLWljb24tYnV0dG9uXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbmltcG9ydCBcInVpL3NlYXJjaC1pbnB1dFwiO1xuXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuVE9ETzpcblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbi8qKiBAY2xhc3MgIG5vbi1lZGl0YWJsZSwgcmVhZC1vbmx5IFZpZXcvQ29udHJvbGxlciBmb3IgYSBoaXN0b3J5IG1vZGVsLlxuICogIEFsbG93czpcbiAqICAgICAgY2hhbmdpbmcgdGhlIGxvYWRlZCBoaXN0b3J5XG4gKiAgICAgIGRpc3BsYXlpbmcgZGF0YSwgaW5mbywgYW5kIGRvd25sb2FkXG4gKiAgICAgIHRyYWNraW5nIGhpc3RvcnkgYXR0cnM6IHNpemUsIHRhZ3MsIGFubm90YXRpb25zLCBuYW1lLCBldGMuXG4gKiAgRG9lcyBub3QgYWxsb3c6XG4gKiAgICAgIGNoYW5naW5nIHRoZSBuYW1lXG4gKi9cbnZhciBfc3VwZXIgPSBMSVNUX1ZJRVcuTW9kZWxMaXN0UGFuZWw7XG52YXIgSGlzdG9yeVZpZXcgPSBfc3VwZXIuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgSGlzdG9yeVZpZXcucHJvdG90eXBlICovIHtcbiAgICAgICAgX2xvZ05hbWVzcGFjZTogXCJoaXN0b3J5XCIsXG5cbiAgICAgICAgLyoqIGNsYXNzIHRvIHVzZSBmb3IgY29uc3RydWN0aW5nIHRoZSBIREEgdmlld3MgKi9cbiAgICAgICAgSERBVmlld0NsYXNzOiBIREFfTEkuSERBTGlzdEl0ZW1WaWV3LFxuICAgICAgICAvKiogY2xhc3MgdG8gdXNlIGZvciBjb25zdHJ1Y3RpbmcgdGhlIEhEQ0Egdmlld3MgKi9cbiAgICAgICAgSERDQVZpZXdDbGFzczogSERDQV9MSS5IRENBTGlzdEl0ZW1WaWV3LFxuICAgICAgICAvKiogY2xhc3MgdG8gdXNlZCBmb3IgY29uc3RydWN0aW5nIGNvbGxlY3Rpb24gb2Ygc3ViLXZpZXcgbW9kZWxzICovXG4gICAgICAgIGNvbGxlY3Rpb25DbGFzczogSElTVE9SWV9DT05URU5UUy5IaXN0b3J5Q29udGVudHMsXG4gICAgICAgIC8qKiBrZXkgb2YgYXR0cmlidXRlIGluIG1vZGVsIHRvIGFzc2lnbiB0byB0aGlzLmNvbGxlY3Rpb24gKi9cbiAgICAgICAgbW9kZWxDb2xsZWN0aW9uS2V5OiBcImNvbnRlbnRzXCIsXG5cbiAgICAgICAgdGFnTmFtZTogXCJkaXZcIixcbiAgICAgICAgY2xhc3NOYW1lOiBgJHtfc3VwZXIucHJvdG90eXBlLmNsYXNzTmFtZX0gaGlzdG9yeS1wYW5lbGAsXG5cbiAgICAgICAgLyoqIHN0cmluZyB0byBkaXNwbGF5IHdoZW4gdGhlIGNvbGxlY3Rpb24gaXMgZW1wdHkgKi9cbiAgICAgICAgZW1wdHlNc2c6IF9sKFwiVGhpcyBoaXN0b3J5IGlzIGVtcHR5XCIpLFxuICAgICAgICAvKiogZGlzcGxheWVkIHdoZW4gbm8gaXRlbXMgbWF0Y2ggdGhlIHNlYXJjaCB0ZXJtcyAqL1xuICAgICAgICBub25lRm91bmRNc2c6IF9sKFwiTm8gbWF0Y2hpbmcgZGF0YXNldHMgZm91bmRcIiksXG4gICAgICAgIC8qKiBzdHJpbmcgdXNlZCBmb3Igc2VhcmNoIHBsYWNlaG9sZGVyICovXG4gICAgICAgIHNlYXJjaFBsYWNlaG9sZGVyOiBfbChcInNlYXJjaCBkYXRhc2V0c1wiKSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFNFVCBVUFxuICAgICAgICAvKiogU2V0IHVwIHRoZSB2aWV3LCBiaW5kIGxpc3RlbmVycy5cbiAgICAgICAgICogIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIG9wdGlvbmFsIHNldHRpbmdzIGZvciB0aGUgcGFuZWxcbiAgICAgICAgICovXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgLy8gLS0tLSBpbnN0YW5jZSB2YXJzXG4gICAgICAgICAgICAvLyBjb250cm9sIGNvbnRlbnRzL2JlaGF2aW9yIGJhc2VkIG9uIHdoZXJlIChhbmQgaW4gd2hhdCBjb250ZXh0KSB0aGUgcGFuZWwgaXMgYmVpbmcgdXNlZFxuICAgICAgICAgICAgLyoqIHdoZXJlIHNob3VsZCBwYWdlcyBmcm9tIGxpbmtzIGJlIGRpc3BsYXllZD8gKGRlZmF1bHQgdG8gbmV3IHRhYi93aW5kb3cpICovXG4gICAgICAgICAgICB0aGlzLmxpbmtUYXJnZXQgPSBhdHRyaWJ1dGVzLmxpbmtUYXJnZXQgfHwgXCJfYmxhbmtcIjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY3JlYXRlIGFuZCByZXR1cm4gYSBjb2xsZWN0aW9uIGZvciB3aGVuIG5vbmUgaXMgaW5pdGlhbGx5IHBhc3NlZCAqL1xuICAgICAgICBfY3JlYXRlRGVmYXVsdENvbGxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGVcbiAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5jb2xsZWN0aW9uQ2xhc3MoW10sIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5OiB0aGlzLm1vZGVsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgY2xlYXIgdGhlIHVwZGF0ZSB0aW1lciBvbiB0aGUgbW9kZWwgKi9cbiAgICAgICAgZnJlZU1vZGVsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuZnJlZU1vZGVsLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBjcmVhdGUgYW55IGV2ZW50IGxpc3RlbmVycyBmb3IgdGhlIHBhbmVsXG4gICAgICAgICAqICBAZmlyZXM6IHJlbmRlcmVkOmluaXRpYWwgICAgb24gdGhlIGZpcnN0IHJlbmRlclxuICAgICAgICAgKiAgQGZpcmVzOiBlbXB0eS1oaXN0b3J5ICAgICAgIHdoZW4gc3dpdGNoaW5nIHRvIGEgaGlzdG9yeSB3aXRoIG5vIGNvbnRlbnRzIG9yIGNyZWF0aW5nIGEgbmV3IGhpc3RvcnlcbiAgICAgICAgICovXG4gICAgICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcExpc3RlbmVycy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5vbih7XG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1vZGVsLCB4aHIsIG9wdGlvbnMsIG1zZywgZGV0YWlscykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9ySGFuZGxlcihtb2RlbCwgeGhyLCBvcHRpb25zLCBtc2csIGRldGFpbHMpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ2aWV3czpyZWFkeSB2aWV3OmF0dGFjaGVkIHZpZXc6cmVtb3ZlZFwiOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclNlbGVjdEJ1dHRvbigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ2aWV3OmF0dGFjaGVkXCI6IGZ1bmN0aW9uKHZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUbygwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHRoaXMub24oICdhbGwnLCBmdW5jdGlvbigpeyBjb25zb2xlLmRlYnVnKCBhcmd1bWVudHMgKTsgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGxvYWRpbmcgaGlzdG9yeS9oZGEgbW9kZWxzXG4gICAgICAgIC8qKiBsb2FkIHRoZSBoaXN0b3J5IHdpdGggdGhlIGdpdmVuIGlkIHRoZW4gaXQncyBjb250ZW50cywgc2VuZGluZyBhamF4IG9wdGlvbnMgdG8gYm90aCAqL1xuICAgICAgICBsb2FkSGlzdG9yeTogZnVuY3Rpb24oaGlzdG9yeUlkLCBvcHRpb25zLCBjb250ZW50c09wdGlvbnMpIHtcbiAgICAgICAgICAgIGNvbnRlbnRzT3B0aW9ucyA9IF8uZXh0ZW5kKGNvbnRlbnRzT3B0aW9ucyB8fCB7IHNpbGVudDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHRoaXMuaW5mbyhcImxvYWRIaXN0b3J5OlwiLCBoaXN0b3J5SWQsIG9wdGlvbnMsIGNvbnRlbnRzT3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLnNldE1vZGVsKG5ldyBISVNUT1JZX01PREVMLkhpc3RvcnkoeyBpZDogaGlzdG9yeUlkIH0pKTtcblxuICAgICAgICAgICAgY29udGVudHNPcHRpb25zLnNpbGVudCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJsb2FkaW5nXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuZmV0Y2hXaXRoQ29udGVudHMob3B0aW9ucywgY29udGVudHNPcHRpb25zKS5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwibG9hZGluZy1kb25lXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGNvbnZlbmllbmNlIGFsaWFzIHRvIHRoZSBtb2RlbC4gVXBkYXRlcyB0aGUgaXRlbSBsaXN0IG9ubHkgKG5vdCB0aGUgaGlzdG9yeSkgKi9cbiAgICAgICAgcmVmcmVzaENvbnRlbnRzOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1vZGVsLnJlZnJlc2gob3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBtYXkgaGF2ZSBjYWxsYmFja3MgLSBzbyByZXR1cm4gYW4gZW1wdHkgcHJvbWlzZVxuICAgICAgICAgICAgcmV0dXJuICQud2hlbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBPdmVycmlkZSB0byByZXNldCB3ZWIgc3RvcmFnZSB3aGVuIHRoZSBpZCBjaGFuZ2VzIChzaW5jZSBpdCBuZWVkcyB0aGUgaWQpICovXG4gICAgICAgIF9zZXRVcENvbGxlY3Rpb25MaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBDb2xsZWN0aW9uTGlzdGVuZXJzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIHtcbiAgICAgICAgICAgICAgICAvLyAnYWxsJyA6IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCB0aGlzLmNvbGxlY3Rpb24gKyAnOicsIGFyZ3VtZW50cyApOyB9LFxuICAgICAgICAgICAgICAgIFwiZmV0Y2hpbmctbW9yZVwiOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ29udGVudHNMb2FkaW5nSW5kaWNhdG9yKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbXB0eU1lc3NhZ2UoKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImZldGNoaW5nLW1vcmUtZG9uZVwiOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQ29udGVudHNMb2FkaW5nSW5kaWNhdG9yKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcGFuZWwgcmVuZGVyaW5nXG4gICAgICAgIC8qKiBoaWRlIHRoZSAkZWwgYW5kIGRpc3BsYXkgYSBsb2FkaW5nIGluZGljYXRvciAoaW4gdGhlICRlbCdzIHBhcmVudCkgd2hlbiBsb2FkaW5nIG5ldyBkYXRhICovXG4gICAgICAgIF9zaG93TG9hZGluZ0luZGljYXRvcjogZnVuY3Rpb24obXNnLCBzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciAkaW5kaWNhdG9yID0gJCgnPGRpdiBjbGFzcz1cImxvYWRpbmctaW5kaWNhdG9yXCIvPicpO1xuICAgICAgICAgICAgdGhpcy4kZWwuaHRtbCgkaW5kaWNhdG9yLnRleHQobXNnKS5zbGlkZURvd24oIV8uaXNVbmRlZmluZWQoc3BlZWQpID8gc3BlZWQgOiB0aGlzLmZ4U3BlZWQpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGlkZSB0aGUgbG9hZGluZyBpbmRpY2F0b3IgKi9cbiAgICAgICAgX2hpZGVMb2FkaW5nSW5kaWNhdG9yOiBmdW5jdGlvbihzcGVlZCkge1xuICAgICAgICAgICAgLy8gbWFrZSBzcGVlZCBhIGJpdCBzbG93ZXIgdG8gY29tcGVuc2F0ZSBmb3Igc2xvdyByZW5kZXJpbmcgb2YgdXAgdG8gNTAwIGNvbnRlbnRzXG4gICAgICAgICAgICB0aGlzLiQoXCIubG9hZGluZy1pbmRpY2F0b3JcIikuc2xpZGVVcCghXy5pc1VuZGVmaW5lZChzcGVlZCkgPyBzcGVlZCA6IHRoaXMuZnhTcGVlZCArIDIwMCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQgYSBidG4gdG8gdG9nZ2xlIHRoZSBzZWxlY3RvcnMgKi9cbiAgICAgICAgX2J1aWxkTmV3UmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkbmV3UmVuZGVyID0gX3N1cGVyLnByb3RvdHlwZS5fYnVpbGROZXdSZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclNlbGVjdEJ1dHRvbigkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgIHJldHVybiAkbmV3UmVuZGVyO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBidXR0b24gZm9yIHN0YXJ0aW5nIHNlbGVjdCBtb2RlICovXG4gICAgICAgIF9yZW5kZXJTZWxlY3RCdXR0b246IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICAgICAgLy8gZG8gbm90IHJlbmRlciBzZWxlY3RvciBvcHRpb24gaWYgbm8gYWN0aW9uc1xuICAgICAgICAgICAgaWYgKCF0aGlzLm11bHRpc2VsZWN0QWN0aW9ucygpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZG8gbm90IHJlbmRlciAoYW5kIHJlbW92ZSBldmVuKSBpZiBub3RoaW5nIHRvIHNlbGVjdFxuICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXdzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVNlbGVjdG9ycygpO1xuICAgICAgICAgICAgICAgICR3aGVyZS5maW5kKFwiLmNvbnRyb2xzIC5hY3Rpb25zIC5zaG93LXNlbGVjdG9ycy1idG5cIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBkb24ndCBib3RoZXIgcmVuZGVyaW5nIGlmIHRoZXJlJ3Mgb25lIGFscmVhZHlcbiAgICAgICAgICAgIHZhciAkZXhpc3RpbmcgPSAkd2hlcmUuZmluZChcIi5jb250cm9scyAuYWN0aW9ucyAuc2hvdy1zZWxlY3RvcnMtYnRuXCIpO1xuICAgICAgICAgICAgaWYgKCRleGlzdGluZy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJGV4aXN0aW5nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFJY29uQnV0dG9uKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJPcGVyYXRpb25zIG9uIG11bHRpcGxlIGRhdGFzZXRzXCIpLFxuICAgICAgICAgICAgICAgIGNsYXNzZXM6IFwic2hvdy1zZWxlY3RvcnMtYnRuXCIsXG4gICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLWNoZWNrLXNxdWFyZS1vXCJcbiAgICAgICAgICAgIH0pLnByZXBlbmRUbygkd2hlcmUuZmluZChcIi5jb250cm9scyAuYWN0aW9uc1wiKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIG92ZXJyaWRlIHRvIGF2b2lkIHNob3dpbmcgaW50aWFsIGVtcHR5IG1lc3NhZ2UgdXNpbmcgY29udGVudHNfYWN0aXZlICovXG4gICAgICAgIF9yZW5kZXJFbXB0eU1lc3NhZ2U6IGZ1bmN0aW9uKCR3aGVyZVRvKSB7XG4gICAgICAgICAgICB2YXIgJGVtcHR5TXNnID0gdGhpcy4kZW1wdHlNZXNzYWdlKCR3aGVyZVRvKTtcbiAgICAgICAgICAgIHZhciBlbXB0eSA9IHRoaXMubW9kZWwuZ2V0KFwiY29udGVudHNfYWN0aXZlXCIpLmFjdGl2ZSA8PSAwO1xuICAgICAgICAgICAgaWYgKGVtcHR5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRlbXB0eU1zZ1xuICAgICAgICAgICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMuZW1wdHlNc2cpXG4gICAgICAgICAgICAgICAgICAgIC5zaG93KCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2VhcmNoRm9yICYmIHRoaXMubW9kZWwuY29udGVudHMuaGF2ZVNlYXJjaERldGFpbHMoKSAmJiAhdGhpcy52aWV3cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJGVtcHR5TXNnXG4gICAgICAgICAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQodGhpcy5ub25lRm91bmRNc2cpXG4gICAgICAgICAgICAgICAgICAgIC5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkZW1wdHlNc2cuaGlkZSgpO1xuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogdGhlIHNjcm9sbCBjb250YWluZXIgZm9yIHRoaXMgcGFuZWwgLSBjYW4gYmUgJGVsLCAkZWwucGFyZW50KCksIG9yIGdyYW5kcGFyZW50IGRlcGVuZGluZyBvbiBjb250ZXh0ICovXG4gICAgICAgICRzY3JvbGxDb250YWluZXI6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgb3Igc2V0IHZpYSBhdHRyaWJ1dGVzLiRzY3JvbGxDb250YWluZXJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRsaXN0KCR3aGVyZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHN1YnZpZXdzXG4gICAgICAgIF90b2dnbGVDb250ZW50c0xvYWRpbmdJbmRpY2F0b3I6IGZ1bmN0aW9uKHNob3cpIHtcbiAgICAgICAgICAgIGlmICghc2hvdykge1xuICAgICAgICAgICAgICAgIHRoaXMuJGxpc3QoKVxuICAgICAgICAgICAgICAgICAgICAuZmluZChcIi5jb250ZW50cy1sb2FkaW5nLWluZGljYXRvclwiKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuJGxpc3QoKS5odG1sKFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbnRlbnRzLWxvYWRpbmctaW5kaWNhdG9yXCI+JyArICc8c3BhbiBjbGFzcz1cImZhIGZhLTJ4IGZhLXNwaW5uZXIgZmEtc3BpblwiLz48L2Rpdj4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogb3ZlcnJpZGUgdG8gcmVuZGVyIHBhZ2luYXRpb24gYWxzbyAqL1xuICAgICAgICByZW5kZXJJdGVtczogZnVuY3Rpb24oJHdoZXJlVG8pIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCB0aGlzICsgJy5yZW5kZXJJdGVtcy0tLS0tLS0tLS0tLS0tLS0tJywgbmV3IERhdGUoKSApO1xuICAgICAgICAgICAgJHdoZXJlVG8gPSAkd2hlcmVUbyB8fCB0aGlzLiRlbDtcbiAgICAgICAgICAgIHZhciAkbGlzdCA9IHRoaXMuJGxpc3QoJHdoZXJlVG8pO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiBib290c3RyYXAgaGFjayB0byByZW1vdmUgb3JwaGFuZWQgdG9vbHRpcHNcbiAgICAgICAgICAgICQoXCIudG9vbHRpcFwiKS5yZW1vdmUoKTtcblxuICAgICAgICAgICAgJGxpc3QuZW1wdHkoKTtcbiAgICAgICAgICAgIHRoaXMudmlld3MgPSBbXTtcblxuICAgICAgICAgICAgdmFyIG1vZGVscyA9IHRoaXMuX2ZpbHRlckNvbGxlY3Rpb24oKTtcbiAgICAgICAgICAgIGlmIChtb2RlbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyUGFnaW5hdGlvbigkd2hlcmVUbyk7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3cyA9IHRoaXMuX3JlbmRlclNvbWVJdGVtcyhtb2RlbHMsICRsaXN0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogY29uc29saWRhdGUgd2l0aCBfcmVuZGVyUGFnaW5hdGlvbiBhYm92ZSBieSAoPz8/KSBwYXNzaW5nIGluIG1vZGVscy9sZW5ndGg/XG4gICAgICAgICAgICAgICAgJHdoZXJlVG8uZmluZChcIj4gLmNvbnRyb2xzIC5saXN0LXBhZ2luYXRpb25cIikuZW1wdHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckVtcHR5TWVzc2FnZSgkd2hlcmVUbykudG9nZ2xlKCFtb2RlbHMubGVuZ3RoKTtcblxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwidmlld3M6cmVhZHlcIiwgdGhpcy52aWV3cyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3cztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmVuZGVyIHBhZ2luYXRpb24gY29udHJvbHMgaWYgbm90IHNlYXJjaGluZyBhbmQgY29udGVudHMgc2F5cyB3ZSdyZSBwYWdpbmF0aW5nICovXG4gICAgICAgIF9yZW5kZXJQYWdpbmF0aW9uOiBmdW5jdGlvbigkd2hlcmVUbykge1xuICAgICAgICAgICAgdmFyICRwYWdpbmF0aW9uQ29udHJvbHMgPSAkd2hlcmVUby5maW5kKFwiPiAuY29udHJvbHMgLmxpc3QtcGFnaW5hdGlvblwiKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlYXJjaEZvciB8fCAhdGhpcy5tb2RlbC5jb250ZW50cy5zaG91bGRQYWdpbmF0ZSgpKSByZXR1cm4gJHBhZ2luYXRpb25Db250cm9scy5lbXB0eSgpO1xuXG4gICAgICAgICAgICAkcGFnaW5hdGlvbkNvbnRyb2xzLmh0bWwoXG4gICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZXMucGFnaW5hdGlvbihcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGFnaW5hdGlvbiBpcyAxLWJhc2VkIGZvciB0aGUgdXNlclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudDogdGhpcy5tb2RlbC5jb250ZW50cy5jdXJyZW50UGFnZSArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0OiB0aGlzLm1vZGVsLmNvbnRlbnRzLmdldExhc3RQYWdlKCkgKyAxXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgJHBhZ2luYXRpb25Db250cm9scy5maW5kKFwic2VsZWN0LnBhZ2VzXCIpLnRvb2x0aXAoKTtcbiAgICAgICAgICAgIHJldHVybiAkcGFnaW5hdGlvbkNvbnRyb2xzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgYSBzdWJzZXQgb2YgdGhlIGVudGlyZSBjb2xsZWN0aW9uIChjbGllbnQtc2lkZSBwYWdpbmF0aW9uKSAqL1xuICAgICAgICBfcmVuZGVyU29tZUl0ZW1zOiBmdW5jdGlvbihtb2RlbHMsICRsaXN0KSB7XG4gICAgICAgICAgICB2YXIgdmlld3MgPSBbXTtcbiAgICAgICAgICAgICRsaXN0LmFwcGVuZChcbiAgICAgICAgICAgICAgICBtb2RlbHMubWFwKG0gPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMuX2NyZWF0ZUl0ZW1WaWV3KG0pO1xuICAgICAgICAgICAgICAgICAgICB2aWV3cy5wdXNoKHZpZXcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVySXRlbVZpZXckZWwodmlldyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICByZXR1cm4gdmlld3M7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHN1Yi12aWV3c1xuICAgICAgICAvKiogaW4gdGhpcyBvdmVycmlkZSwgY2hlY2sgaWYgdGhlIGNvbnRlbnRzIHdvdWxkIGFsc28gZGlzcGxheSBiYXNlZCBvbiBpbmNsdWRlRGVsZXRlZC9oaWRkZW4gKi9cbiAgICAgICAgX2ZpbHRlckl0ZW06IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgY29udGVudHMgPSB0aGlzLm1vZGVsLmNvbnRlbnRzO1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAoY29udGVudHMuaW5jbHVkZUhpZGRlbiB8fCAhbW9kZWwuaGlkZGVuKCkpICYmXG4gICAgICAgICAgICAgICAgKGNvbnRlbnRzLmluY2x1ZGVEZWxldGVkIHx8ICFtb2RlbC5pc0RlbGV0ZWRPclB1cmdlZCgpKSAmJlxuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2ZpbHRlckl0ZW0uY2FsbCh0aGlzLCBtb2RlbClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIHNpbmNlIGhpc3RvcnkgY29udGVudHMgYXJlIG1peGVkLFxuICAgICAgICAgKiAgICAgIGdldCB0aGUgYXBwcm9wbyB2aWV3IGNsYXNzIGJhc2VkIG9uIGhpc3RvcnlfY29udGVudF90eXBlXG4gICAgICAgICAqL1xuICAgICAgICBfZ2V0SXRlbVZpZXdDbGFzczogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50VHlwZSA9IG1vZGVsLmdldChcImhpc3RvcnlfY29udGVudF90eXBlXCIpO1xuICAgICAgICAgICAgc3dpdGNoIChjb250ZW50VHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJkYXRhc2V0XCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkhEQVZpZXdDbGFzcztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZGF0YXNldF9jb2xsZWN0aW9uXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkhEQ0FWaWV3Q2xhc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBVbmtub3duIGhpc3RvcnlfY29udGVudF90eXBlOiAke2NvbnRlbnRUeXBlfWApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBpbiB0aGlzIG92ZXJyaWRlLCBhZGQgYSBsaW5rdGFyZ2V0LCBhbmQgZXhwYW5kIGlmIGlkIGlzIGluIHdlYiBzdG9yYWdlICovXG4gICAgICAgIF9nZXRJdGVtVmlld09wdGlvbnM6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF9zdXBlci5wcm90b3R5cGUuX2dldEl0ZW1WaWV3T3B0aW9ucy5jYWxsKHRoaXMsIG1vZGVsKTtcbiAgICAgICAgICAgIHJldHVybiBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgbGlua1RhcmdldDogdGhpcy5saW5rVGFyZ2V0LFxuICAgICAgICAgICAgICAgIGV4cGFuZGVkOiB0aGlzLm1vZGVsLmNvbnRlbnRzLnN0b3JhZ2UuaXNFeHBhbmRlZChtb2RlbC5pZCksXG4gICAgICAgICAgICAgICAgaGFzVXNlcjogdGhpcy5tb2RlbC5vd25lZEJ5Q3VyclVzZXIoKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGFkZC9yZW1vdmUgZXhwYW5kZWQvY29sbGFwc2VkIG1vZGVsIGlkcyB0by9mcm9tIHdlYiBzdG9yYWdlICovXG4gICAgICAgIF9zZXRVcEl0ZW1WaWV3TGlzdGVuZXJzOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBJdGVtVmlld0xpc3RlbmVycy5jYWxsKHBhbmVsLCB2aWV3KTtcbiAgICAgICAgICAgIC8vVE9ETzogc2VuZCBmcm9tIGNvbnRlbnQgdmlldzogdGhpcy5tb2RlbC5jb2xsZWN0aW9uLnN0b3JhZ2UuYWRkRXhwYW5kZWRcbiAgICAgICAgICAgIC8vIG1haW50YWluIGEgbGlzdCBvZiBpdGVtcyB3aG9zZSBib2RpZXMgYXJlIGV4cGFuZGVkXG4gICAgICAgICAgICByZXR1cm4gcGFuZWwubGlzdGVuVG8odmlldywge1xuICAgICAgICAgICAgICAgIGV4cGFuZGVkOiBmdW5jdGlvbih2KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLm1vZGVsLmNvbnRlbnRzLnN0b3JhZ2UuYWRkRXhwYW5kZWQodi5tb2RlbCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb2xsYXBzZWQ6IGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwubW9kZWwuY29udGVudHMuc3RvcmFnZS5yZW1vdmVFeHBhbmRlZCh2Lm1vZGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogb3ZlcnJpZGUgdG8gcmVtb3ZlIGV4cGFuZGVkSWRzIGZyb20gd2Vic3RvcmFnZSAqL1xuICAgICAgICBjb2xsYXBzZUFsbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmNvbnRlbnRzLnN0b3JhZ2UuY2xlYXJFeHBhbmRlZCgpO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb2xsYXBzZUFsbC5jYWxsKHRoaXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzZWxlY3Rpb25cbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIGNvcnJlY3RseSBzZXQgdGhlIGhpc3RvcnlJZCBvZiB0aGUgbmV3IGNvbGxlY3Rpb24gKi9cbiAgICAgICAgZ2V0U2VsZWN0ZWRNb2RlbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBfc3VwZXIucHJvdG90eXBlLmdldFNlbGVjdGVkTW9kZWxzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBjb2xsZWN0aW9uLmhpc3RvcnlJZCA9IHRoaXMuY29sbGVjdGlvbi5oaXN0b3J5SWQ7XG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcGFuZWwgZXZlbnRzXG4gICAgICAgIC8qKiBldmVudCBtYXAgKi9cbiAgICAgICAgZXZlbnRzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUuZXZlbnRzKSwge1xuICAgICAgICAgICAgXCJjbGljayAuc2hvdy1zZWxlY3RvcnMtYnRuXCI6IFwidG9nZ2xlU2VsZWN0b3JzXCIsXG4gICAgICAgICAgICBcImNsaWNrID4gLmNvbnRyb2xzIC5wcmV2XCI6IFwiX2NsaWNrUHJldlBhZ2VcIixcbiAgICAgICAgICAgIFwiY2xpY2sgPiAuY29udHJvbHMgLm5leHRcIjogXCJfY2xpY2tOZXh0UGFnZVwiLFxuICAgICAgICAgICAgXCJjaGFuZ2UgPiAuY29udHJvbHMgLnBhZ2VzXCI6IFwiX2NoYW5nZVBhZ2VTZWxlY3RcIixcbiAgICAgICAgICAgIC8vIGFsbG93IChlcnJvcikgbWVzc2FnZXMgdG8gYmUgY2xpY2tlZCBhd2F5XG4gICAgICAgICAgICBcImNsaWNrIC5tZXNzYWdlcyBbY2xhc3MkPW1lc3NhZ2VdXCI6IFwiY2xlYXJNZXNzYWdlc1wiXG4gICAgICAgIH0pLFxuXG4gICAgICAgIF9jbGlja1ByZXZQYWdlOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5zdG9wUG9sbGluZygpO1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5jb250ZW50cy5mZXRjaFByZXZQYWdlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2NsaWNrTmV4dFBhZ2U6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLnN0b3BQb2xsaW5nKCk7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmNvbnRlbnRzLmZldGNoTmV4dFBhZ2UoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBfY2hhbmdlUGFnZVNlbGVjdDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuc3RvcFBvbGxpbmcoKTtcbiAgICAgICAgICAgIHZhciBwYWdlID0gJChldi5jdXJyZW50VGFyZ2V0KS52YWwoKTtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuY29udGVudHMuZmV0Y2hQYWdlKHBhZ2UpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBUb2dnbGUgYW5kIHN0b3JlIHRoZSBkZWxldGVkIHZpc2liaWxpdHkgYW5kIHJlLXJlbmRlciBpdGVtc1xuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gbmV3IHNldHRpbmdcbiAgICAgICAgICovXG4gICAgICAgIHRvZ2dsZVNob3dEZWxldGVkOiBmdW5jdGlvbihzaG93LCBvcHRpb25zKSB7XG4gICAgICAgICAgICBzaG93ID0gc2hvdyAhPT0gdW5kZWZpbmVkID8gc2hvdyA6ICF0aGlzLm1vZGVsLmNvbnRlbnRzLmluY2x1ZGVEZWxldGVkO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5tb2RlbC5jb250ZW50cztcbiAgICAgICAgICAgIGNvbnRlbnRzLnNldEluY2x1ZGVEZWxldGVkKHNob3csIG9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwic2hvdy1kZWxldGVkXCIsIHNob3cpO1xuXG4gICAgICAgICAgICBjb250ZW50cy5mZXRjaEN1cnJlbnRQYWdlKHsgcmVuZGVyQWxsOiB0cnVlIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHNob3c7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFRvZ2dsZSBhbmQgc3RvcmUgd2hldGhlciB0byByZW5kZXIgZXhwbGljaXR5IGhpZGRlbiBjb250ZW50c1xuICAgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gbmV3IHNldHRpbmdcbiAgICAgICAgICovXG4gICAgICAgIHRvZ2dsZVNob3dIaWRkZW46IGZ1bmN0aW9uKHNob3csIHN0b3JlLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyggJ3RvZ2dsZVNob3dIaWRkZW4nLCBzaG93LCBzdG9yZSApO1xuICAgICAgICAgICAgc2hvdyA9IHNob3cgIT09IHVuZGVmaW5lZCA/IHNob3cgOiAhdGhpcy5tb2RlbC5jb250ZW50cy5pbmNsdWRlSGlkZGVuO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5tb2RlbC5jb250ZW50cztcbiAgICAgICAgICAgIGNvbnRlbnRzLnNldEluY2x1ZGVIaWRkZW4oc2hvdywgb3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJzaG93LWhpZGRlblwiLCBzaG93KTtcblxuICAgICAgICAgICAgY29udGVudHMuZmV0Y2hDdXJyZW50UGFnZSh7IHJlbmRlckFsbDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHJldHVybiBzaG93O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBPbiB0aGUgZmlyc3Qgc2VhcmNoLCBpZiB0aGVyZSBhcmUgbm8gZGV0YWlscyAtIGxvYWQgdGhlbSwgdGhlbiBzZWFyY2ggKi9cbiAgICAgICAgX2ZpcnN0U2VhcmNoOiBmdW5jdGlvbihzZWFyY2hGb3IpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dFNlbGVjdG9yID0gXCI+IC5jb250cm9scyAuc2VhcmNoLWlucHV0XCI7XG4gICAgICAgICAgICB0aGlzLmxvZyhcIm9uRmlyc3RTZWFyY2hcIiwgc2VhcmNoRm9yKTtcblxuICAgICAgICAgICAgLy8gaWYgdGhlIGNvbnRlbnRzIGFscmVhZHkgaGF2ZSBlbm91Z2ggZGV0YWlscyB0byBzZWFyY2gsIHNlYXJjaCBhbmQgcmV0dXJuIG5vd1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuY29udGVudHMuaGF2ZVNlYXJjaERldGFpbHMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbXMoc2VhcmNoRm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgbG9hZCB0aGUgZGV0YWlscyBwcm9ncmVzc2l2ZWx5IGhlcmVcbiAgICAgICAgICAgIHRoaXMuJChpbnB1dFNlbGVjdG9yKS5zZWFyY2hJbnB1dChcInRvZ2dsZS1sb2FkaW5nXCIpO1xuICAgICAgICAgICAgLy8gc2V0IHRoaXMgbm93IHNvIHRoYXQgb25seSByZXN1bHRzIHdpbGwgc2hvdyBkdXJpbmcgcHJvZ3Jlc3NcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoRm9yID0gc2VhcmNoRm9yO1xuICAgICAgICAgICAgdmFyIHhociA9IHRoaXMubW9kZWwuY29udGVudHNcbiAgICAgICAgICAgICAgICAucHJvZ3Jlc3NpdmVseUZldGNoRGV0YWlscyh7IHNpbGVudDogdHJ1ZSB9KVxuICAgICAgICAgICAgICAgIC5wcm9ncmVzcygocmVzcG9uc2UsIGxpbWl0LCBvZmZzZXQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJJdGVtcygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJzZWFyY2g6bG9hZGluZy1wcm9ncmVzc1wiLCBsaW1pdCwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbC5maW5kKGlucHV0U2VsZWN0b3IpLnNlYXJjaElucHV0KFwidG9nZ2xlLWxvYWRpbmdcIik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZG9uZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoSXRlbXMoc2VhcmNoRm9yLCBcImZvcmNlXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBjbGVhciB0aGUgc2VhcmNoIGZpbHRlcnMgYW5kIHNob3cgYWxsIHZpZXdzIHRoYXQgYXJlIG5vcm1hbGx5IHNob3duICovXG4gICAgICAgIGNsZWFyU2VhcmNoOiBmdW5jdGlvbihzZWFyY2hGb3IpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWFyY2hGb3IpIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgLy90aGlzLmxvZyggJ29uU2VhcmNoQ2xlYXInLCB0aGlzICk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaEZvciA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJzZWFyY2g6Y2xlYXJcIiwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLiQoXCI+IC5jb250cm9scyAuc2VhcmNoLXF1ZXJ5XCIpLnZhbChcIlwiKTtcbiAgICAgICAgICAgIC8vIE5PVEU6IHNpbGVudCArIHJlbmRlciBwcmV2ZW50cyBjb2xsZWN0aW9uIHVwZGF0ZSBldmVudCB3aXRoIG1lcmdlIG9ubHlcbiAgICAgICAgICAgIC8vIC0gd2hpY2ggY2F1c2VzIGFuIGVtcHR5IHBhZ2UgZHVlIHRvIGV2ZW50IGhhbmRsZXIgYWJvdmVcbiAgICAgICAgICAgIHRoaXMubW9kZWwuY29udGVudHMuZmV0Y2hDdXJyZW50UGFnZSh7IHNpbGVudDogdHJ1ZSB9KS5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckl0ZW1zKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBlcnJvciBoYW5kbGluZ1xuICAgICAgICAvKiogRXZlbnQgaGFuZGxlciBmb3IgZXJyb3JzIChmcm9tIHRoZSBwYW5lbCwgdGhlIGhpc3RvcnksIG9yIHRoZSBoaXN0b3J5J3MgY29udGVudHMpXG4gICAgICAgICAqICBBbHRlcm5hdGVseSB1c2UgdHdvIHN0cmluZ3MgZm9yIG1vZGVsIGFuZCB4aHIgdG8gdXNlIGN1c3RvbSBtZXNzYWdlIGFuZCB0aXRsZSAocmVzcGVjdGl2ZWx5KVxuICAgICAgICAgKiAgQHBhcmFtIHtNb2RlbCBvciBWaWV3fSBtb2RlbCAgICB0aGUgKEJhY2tib25lKSBzb3VyY2Ugb2YgdGhlIGVycm9yXG4gICAgICAgICAqICBAcGFyYW0ge1hNTEhUVFBSZXF1ZXN0fSB4aHIgICAgIGFueSBhamF4IG9iai4gYXNzb2MuIHdpdGggdGhlIGVycm9yXG4gICAgICAgICAqICBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAgICAgICAgIHRoZSBvcHRpb25zIG1hcCBjb21tb25seSB1c2VkIHdpdGggYmJvbmUgYWpheFxuICAgICAgICAgKi9cbiAgICAgICAgZXJyb3JIYW5kbGVyOiBmdW5jdGlvbihtb2RlbCwgeGhyLCBvcHRpb25zKSB7XG4gICAgICAgICAgICAvL1RPRE86IHRvIG1peGluIG9yIGJhc2UgbW9kZWxcbiAgICAgICAgICAgIC8vIGludGVycnVwdGVkIGFqYXggb3Igbm8gY29ubmVjdGlvblxuICAgICAgICAgICAgaWYgKHhociAmJiB4aHIuc3RhdHVzID09PSAwICYmIHhoci5yZWFkeVN0YXRlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIEVSUk9SX01PREFMLm9mZmxpbmVFcnJvck1vZGFsKCk7XG4gICAgICAgICAgICAgICAgLy8gZmFpbCBzaWxlbnRseVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgbGVhdmUgc29tZXRoaW5nIHRvIHJlcG9ydCBpbiB0aGUgY29uc29sZVxuICAgICAgICAgICAgdGhpcy5lcnJvcihtb2RlbCwgeGhyLCBvcHRpb25zKTtcbiAgICAgICAgICAgIC8vIGFuZCBmZWVkYmFjayB0byBhIG1vZGFsXG4gICAgICAgICAgICAvLyBpZiBzZW50IHR3byBzdHJpbmdzIChhbmQgcG9zc2libHkgZGV0YWlscyBhcyAnb3B0aW9ucycpLCB1c2UgdGhvc2UgYXMgbWVzc2FnZSBhbmQgdGl0bGVcbiAgICAgICAgICAgIGlmIChfLmlzU3RyaW5nKG1vZGVsKSAmJiBfLmlzU3RyaW5nKHhocikpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IHhocjtcbiAgICAgICAgICAgICAgICByZXR1cm4gRVJST1JfTU9EQUwuZXJyb3JNb2RhbChtZXNzYWdlLCB0aXRsZSwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBiYWQgZ2F0ZXdheVxuICAgICAgICAgICAgLy8gVE9ETzogcG9zc2libHkgdG8gZ2xvYmFsIGhhbmRsZXJcbiAgICAgICAgICAgIGlmICh4aHIgJiYgeGhyLnN0YXR1cyA9PT0gNTAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEVSUk9SX01PREFMLmJhZEdhdGV3YXlFcnJvck1vZGFsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gRVJST1JfTU9EQUwuYWpheEVycm9yTW9kYWwobW9kZWwsIHhociwgb3B0aW9ucyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbW92ZSBhbGwgbWVzc2FnZXMgZnJvbSB0aGUgcGFuZWwuICovXG4gICAgICAgIGNsZWFyTWVzc2FnZXM6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICB2YXIgJHRhcmdldCA9ICFfLmlzVW5kZWZpbmVkKGV2KSA/ICQoZXYuY3VycmVudFRhcmdldCkgOiB0aGlzLiRtZXNzYWdlcygpLmNoaWxkcmVuKCdbY2xhc3MkPVwibWVzc2FnZVwiXScpO1xuICAgICAgICAgICAgJHRhcmdldC5mYWRlT3V0KHRoaXMuZnhTcGVlZCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIHNjcm9sbGluZ1xuICAgICAgICAvKiogU2Nyb2xscyB0aGUgcGFuZWwgdG8gc2hvdyB0aGUgY29udGVudCBzdWItdmlldyB3aXRoIHRoZSBnaXZlbiBoaWQuXG4gICAgICAgICAqICBAcGFyYW0ge0ludGVnZXJ9IGhpZCAgICB0aGUgaGlkIG9mIGl0ZW0gdG8gc2Nyb2xsIGludG8gdmlld1xuICAgICAgICAgKiAgQHJldHVybnMge0hpc3RvcnlWaWV3fSB0aGUgcGFuZWxcbiAgICAgICAgICovXG4gICAgICAgIHNjcm9sbFRvSGlkOiBmdW5jdGlvbihoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcm9sbFRvSXRlbShfLmZpcnN0KHRoaXMudmlld3NXaGVyZU1vZGVsKHsgaGlkOiBoaWQgfSkpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogdXRpbGl0eSBmb3IgYWRkaW5nIC1zdCwgLW5kLCAtcmQsIC10aCB0byBudW1iZXJzICovXG4gICAgICAgIG9yZGluYWxJbmRpY2F0b3I6IGZ1bmN0aW9uKG51bWJlcikge1xuICAgICAgICAgICAgdmFyIG51bVN0ciA9IGAke251bWJlcn1gO1xuICAgICAgICAgICAgc3dpdGNoIChudW1TdHIuY2hhckF0KG51bVN0ci5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIxXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtudW1TdHJ9c3RgO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIyXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtudW1TdHJ9bmRgO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIzXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtudW1TdHJ9cmRgO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtudW1TdHJ9dGhgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBSZXR1cm4gYSBzdHJpbmcgcmVwIG9mIHRoZSBoaXN0b3J5ICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBgSGlzdG9yeVZpZXcoJHt0aGlzLm1vZGVsID8gdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpIDogXCJcIn0pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFRFTVBMQVRFU1xuSGlzdG9yeVZpZXcucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIG1haW5UZW1wbGF0ZSA9ICgpID0+XG4gICAgICAgIGA8ZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+PC9kaXY+XG4gICAgICAgICAgICA8dWwgY2xhc3M9XCJsaXN0LWl0ZW1zXCI+PC91bD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJlbXB0eS1tZXNzYWdlIGluZm9tZXNzYWdlc21hbGxcIj48L2Rpdj4nLFxuICAgICAgICA8L2Rpdj5gO1xuXG4gICAgdmFyIGNvbnRyb2xzVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0aXRsZVwiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm5hbWVcIj48JS0gaGlzdG9yeS5uYW1lICU+PC9kaXY+JyxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInN1YnRpdGxlXCI+PC9kaXY+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlzdG9yeS1zaXplXCI+PCUtIGhpc3RvcnkubmljZV9zaXplICU+PC9kaXY+JyxcblxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PC9kaXY+JyxcblxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJtZXNzYWdlc1wiPicsXG4gICAgICAgICAgICBcIjwlIGlmKCBoaXN0b3J5LmRlbGV0ZWQgJiYgaGlzdG9yeS5wdXJnZWQgKXsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiZGVsZXRlZC1tc2cgd2FybmluZ21lc3NhZ2VzbWFsbFwiPicsXG4gICAgICAgICAgICBfbChcIlRoaXMgaGlzdG9yeSBoYXMgYmVlbiBwdXJnZWQgYW5kIGRlbGV0ZWRcIiksXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8JSB9IGVsc2UgaWYoIGhpc3RvcnkuZGVsZXRlZCApeyAlPlwiLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJkZWxldGVkLW1zZyB3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgIF9sKFwiVGhpcyBoaXN0b3J5IGhhcyBiZWVuIGRlbGV0ZWRcIiksXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8JSB9IGVsc2UgaWYoIGhpc3RvcnkucHVyZ2VkICl7ICU+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRlbGV0ZWQtbXNnIHdhcm5pbmdtZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgX2woXCJUaGlzIGhpc3RvcnkgaGFzIGJlZW4gcHVyZ2VkXCIpLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuXG4gICAgICAgICAgICBcIjwlIGlmKCBoaXN0b3J5Lm1lc3NhZ2UgKXsgJT5cIixcbiAgICAgICAgICAgIC8vIHNob3VsZCBhbHJlYWR5IGJlIGxvY2FsaXplZFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCI8JT0gaGlzdG9yeS5tZXNzYWdlLmxldmVsIHx8IFwiaW5mb1wiICU+bWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgIFwiPCU9IGhpc3RvcnkubWVzc2FnZS50ZXh0ICU+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuXG4gICAgICAgICAgICAvLyBhZGQgdGFncyBhbmQgYW5ub3RhdGlvbnNcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidGFncy1kaXNwbGF5XCI+PC9kaXY+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYW5ub3RhdGlvbi1kaXNwbGF5XCI+PC9kaXY+JyxcblxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzZWFyY2hcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzZWFyY2gtaW5wdXRcIj48L2Rpdj4nLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcblxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJsaXN0LWFjdGlvbnNcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJidG4tZ3JvdXBcIj4nLFxuICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJzZWxlY3QtYWxsIGJ0biBidG4tZGVmYXVsdFwiJyxcbiAgICAgICAgICAgICdkYXRhLW1vZGU9XCJzZWxlY3RcIj4nLFxuICAgICAgICAgICAgX2woXCJBbGxcIiksXG4gICAgICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJkZXNlbGVjdC1hbGwgYnRuIGJ0bi1kZWZhdWx0XCInLFxuICAgICAgICAgICAgJ2RhdGEtbW9kZT1cInNlbGVjdFwiPicsXG4gICAgICAgICAgICBfbChcIk5vbmVcIiksXG4gICAgICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibGlzdC1hY3Rpb24tbWVudSBidG4tZ3JvdXBcIj4nLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cImxpc3QtcGFnaW5hdGlvbiBmb3JtLWlubGluZVwiPjwvZGl2PicsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiaGlzdG9yeVwiXG4gICAgKTtcblxuICAgIHZhciBwYWdpbmF0aW9uVGVtcGxhdGUgPSBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwicHJldlwiIDwlLSBwYWdlcy5jdXJyZW50ID09PSAxID8gXCJkaXNhYmxlZFwiIDogXCJcIiAlPj5wcmV2aW91czwvYnV0dG9uPicsXG4gICAgICAgICAgICAnPHNlbGVjdCBjbGFzcz1cInBhZ2VzIGZvcm0tY29udHJvbFwiICcsXG4gICAgICAgICAgICAndGl0bGU9XCInLFxuICAgICAgICAgICAgX2woXCJDbGljayB0byBvcGVuIGFuZCBzZWxlY3QgYSBwYWdlLiBCZWdpbiB0eXBpbmcgYSBwYWdlIG51bWJlciB0byBzZWxlY3QgaXRcIiksXG4gICAgICAgICAgICAnXCI+JyxcbiAgICAgICAgICAgIFwiPCUgXy5yYW5nZSggMSwgcGFnZXMubGFzdCArIDEgKS5mb3JFYWNoKCBmdW5jdGlvbiggaSApeyAlPlwiLFxuICAgICAgICAgICAgJzxvcHRpb24gdmFsdWU9XCI8JS0gaSAtIDEgJT5cIiA8JS0gaSA9PT0gcGFnZXMuY3VycmVudCA/IFwic2VsZWN0ZWRcIiA6IFwiXCIgJT4+JyxcbiAgICAgICAgICAgIFwiPCUtIHZpZXcub3JkaW5hbEluZGljYXRvciggaSApICU+IG9mIDwlLSBwYWdlcy5sYXN0ICU+IHBhZ2VzXCIsXG4gICAgICAgICAgICBcIjwvb3B0aW9uPlwiLFxuICAgICAgICAgICAgXCI8JSB9KTsgJT5cIixcbiAgICAgICAgICAgIFwiPC9zZWxlY3Q+XCIsXG4gICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cIm5leHRcIiA8JS0gcGFnZXMuY3VycmVudCA9PT0gcGFnZXMubGFzdCA/IFwiZGlzYWJsZWRcIiA6IFwiXCIgJT4+bmV4dDwvYnV0dG9uPidcbiAgICAgICAgXSxcbiAgICAgICAgXCJwYWdlc1wiXG4gICAgKTtcblxuICAgIHJldHVybiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzKSwge1xuICAgICAgICBlbDogbWFpblRlbXBsYXRlLFxuICAgICAgICBjb250cm9sczogY29udHJvbHNUZW1wbGF0ZSxcbiAgICAgICAgcGFnaW5hdGlvbjogcGFnaW5hdGlvblRlbXBsYXRlXG4gICAgfSk7XG59KSgpO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIEhpc3RvcnlWaWV3OiBIaXN0b3J5Vmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9oaXN0b3J5LXZpZXcuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBOzs7O0FBSUE7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUhBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRlQTtBQUNBO0FBeWVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQU1BO0FBMkJBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQTBCQTtBQUNBO0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///58\n");

/***/ }),
/* 59 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-item-li.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nfunction _templateNametag(tag) {\n    return \"<span class=\\\"label label-info\\\">\" + _.escape(tag.slice(5)) + \"</span>\";\n}\n\nfunction nametagTemplate(historyItem) {\n    var uniqueNametags = _.filter(_.uniq(historyItem.tags), function (t) {\n        return t.indexOf(\"name:\") === 0;\n    });\n    var nametagsDisplay = _.sortBy(uniqueNametags).map(_templateNametag);\n    return \"\\n        <div class=\\\"nametags\\\" title=\\\"\" + uniqueNametags.length + \" nametags\\\">\\n            \" + nametagsDisplay.join(\"\") + \"\\n        </div>\";\n}\n\nexports.default = {\n    nametagTemplate: nametagTemplate\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS1pdGVtLWxpLmpzPzlkYmQiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gX3RlbXBsYXRlTmFtZXRhZyh0YWcpIHtcbiAgICByZXR1cm4gYDxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtaW5mb1wiPiR7Xy5lc2NhcGUodGFnLnNsaWNlKDUpKX08L3NwYW4+YDtcbn1cblxuZnVuY3Rpb24gbmFtZXRhZ1RlbXBsYXRlKGhpc3RvcnlJdGVtKSB7XG4gICAgbGV0IHVuaXF1ZU5hbWV0YWdzID0gXy5maWx0ZXIoXy51bmlxKGhpc3RvcnlJdGVtLnRhZ3MpLCB0ID0+IHQuaW5kZXhPZihcIm5hbWU6XCIpID09PSAwKTtcbiAgICBsZXQgbmFtZXRhZ3NEaXNwbGF5ID0gXy5zb3J0QnkodW5pcXVlTmFtZXRhZ3MpLm1hcChfdGVtcGxhdGVOYW1ldGFnKTtcbiAgICByZXR1cm4gYFxuICAgICAgICA8ZGl2IGNsYXNzPVwibmFtZXRhZ3NcIiB0aXRsZT1cIiR7dW5pcXVlTmFtZXRhZ3MubGVuZ3RofSBuYW1ldGFnc1wiPlxuICAgICAgICAgICAgJHtuYW1ldGFnc0Rpc3BsYXkuam9pbihcIlwiKX1cbiAgICAgICAgPC9kaXY+YDtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIG5hbWV0YWdUZW1wbGF0ZTogbmFtZXRhZ1RlbXBsYXRlXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L2hpc3RvcnktaXRlbS1saS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///59\n");

/***/ }),
/* 60 */
/*!**********************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/collection-view.js ***!
  \**********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listView = __webpack_require__(/*! mvc/list/list-view */ 39);\n\nvar _listView2 = _interopRequireDefault(_listView);\n\nvar _collectionModel = __webpack_require__(/*! mvc/collection/collection-model */ 30);\n\nvar _collectionModel2 = _interopRequireDefault(_collectionModel);\n\nvar _collectionLi = __webpack_require__(/*! mvc/collection/collection-li */ 32);\n\nvar _collectionLi2 = _interopRequireDefault(_collectionLi);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"collections\";\n/* =============================================================================\nTODO:\n\n============================================================================= */\n/** @class non-editable, read-only View/Controller for a dataset collection.\n */\nvar _super = _listView2.default.ModelListPanel;\nvar CollectionView = _super.extend(\n/** @lends CollectionView.prototype */{\n    //MODEL is either a DatasetCollection (or subclass) or a DatasetCollectionElement (list of pairs)\n    _logNamespace: logNamespace,\n\n    className: _super.prototype.className + \" dataset-collection-panel\",\n\n    /** sub view class used for datasets */\n    DatasetDCEViewClass: _collectionLi2.default.DatasetDCEListItemView,\n\n    /** key of attribute in model to assign to this.collection */\n    modelCollectionKey: \"elements\",\n\n    // ......................................................................... SET UP\n    /** Set up the view, set up storage, bind listeners to HistoryContents events\n     *  @param {Object} attributes optional settings for the panel\n     */\n    initialize: function initialize(attributes) {\n        _super.prototype.initialize.call(this, attributes);\n        this.linkTarget = attributes.linkTarget || \"_blank\";\n\n        this.hasUser = attributes.hasUser;\n        /** A stack of panels that currently cover or hide this panel */\n        this.panelStack = [];\n        /** The text of the link to go back to the panel containing this one */\n        this.parentName = attributes.parentName;\n        /** foldout or drilldown */\n        this.foldoutStyle = attributes.foldoutStyle || \"foldout\";\n        this.downloadUrl = Galaxy.root + \"api/dataset_collections/\" + this.model.attributes.id + \"/download\";\n    },\n\n    getNestedDCDCEViewClass: function getNestedDCDCEViewClass() {\n        return _collectionLi2.default.NestedDCDCEListItemView.extend({\n            foldoutPanelClass: CollectionView\n        });\n    },\n\n    _queueNewRender: function _queueNewRender($newRender, speed) {\n        speed = speed === undefined ? this.fxSpeed : speed;\n        var panel = this;\n        this.handleWarning($newRender);\n        panel.log(\"_queueNewRender:\", $newRender, speed);\n\n        // TODO: jquery@1.12 doesn't change display when the elem has display: flex\n        // this causes display: block for those elems after the use of show/hide animations\n        // animations are removed from this view for now until fixed\n        panel._swapNewRender($newRender);\n        panel.trigger(\"rendered\", panel);\n    },\n\n    handleWarning: function handleWarning($newRender) {\n        var viewLength = this.views.length;\n        var elementCount = this.model.get(\"element_count\");\n        if (elementCount && elementCount !== viewLength) {\n            var warning = (0, _localization2.default)(\"displaying only \" + viewLength + \" of \" + elementCount + \" items\");\n            var $warns = $newRender.find(\".elements-warning\");\n            $warns.html(\"<div class=\\\"warningmessagesmall\\\">\" + warning + \"</div>\");\n        }\n    },\n\n    // ------------------------------------------------------------------------ sub-views\n    /** In this override, use model.getVisibleContents */\n    _filterCollection: function _filterCollection() {\n        //TODO: should *not* be model.getVisibleContents - visibility is not model related\n        return this.model.getVisibleContents();\n    },\n\n    /** override to return proper view class based on element_type */\n    _getItemViewClass: function _getItemViewClass(model) {\n        //this.debug( this + '._getItemViewClass:', model );\n        //TODO: subclasses use DCEViewClass - but are currently unused - decide\n        switch (model.get(\"element_type\")) {\n            case \"hda\":\n                return this.DatasetDCEViewClass;\n            case \"dataset_collection\":\n                return this.getNestedDCDCEViewClass();\n        }\n        throw new TypeError(\"Unknown element type:\", model.get(\"element_type\"));\n    },\n\n    /** override to add link target and anon */\n    _getItemViewOptions: function _getItemViewOptions(model) {\n        var options = _super.prototype._getItemViewOptions.call(this, model);\n        return _.extend(options, {\n            linkTarget: this.linkTarget,\n            hasUser: this.hasUser,\n            //TODO: could move to only nested: list:paired\n            foldoutStyle: this.foldoutStyle\n        });\n    },\n\n    // ------------------------------------------------------------------------ collection sub-views\n    /** In this override, add/remove expanded/collapsed model ids to/from web storage */\n    _setUpItemViewListeners: function _setUpItemViewListeners(view) {\n        var panel = this;\n        _super.prototype._setUpItemViewListeners.call(panel, view);\n\n        // use pub-sub to: handle drilldown expansion and collapse\n        panel.listenTo(view, {\n            \"expanded:drilldown\": function expandedDrilldown(v, drilldown) {\n                this._expandDrilldownPanel(drilldown);\n            },\n            \"collapsed:drilldown\": function collapsedDrilldown(v, drilldown) {\n                this._collapseDrilldownPanel(drilldown);\n            }\n        });\n        return this;\n    },\n\n    /** Handle drill down by hiding this panels list and controls and showing the sub-panel */\n    _expandDrilldownPanel: function _expandDrilldownPanel(drilldown) {\n        this.panelStack.push(drilldown);\n        // hide this panel's controls and list, set the name for back navigation, and attach to the $el\n        this.$(\"> .controls\").add(this.$list()).hide();\n        drilldown.parentName = this.model.get(\"name\");\n        this.$el.append(drilldown.render().$el);\n    },\n\n    /** Handle drilldown close by freeing the panel and re-rendering this panel */\n    _collapseDrilldownPanel: function _collapseDrilldownPanel(drilldown) {\n        this.panelStack.pop();\n        this.render();\n    },\n\n    // ------------------------------------------------------------------------ panel events\n    /** event map */\n    events: {\n        \"click .navigation .back\": \"close\"\n    },\n\n    /** close/remove this collection panel */\n    close: function close(event) {\n        this.remove();\n        this.trigger(\"close\");\n    },\n\n    // ........................................................................ misc\n    /** string rep */\n    toString: function toString() {\n        return \"CollectionView(\" + (this.model ? this.model.get(\"name\") : \"\") + \")\";\n    }\n});\n\n//------------------------------------------------------------------------------ TEMPLATES\nCollectionView.prototype.templates = function () {\n    var controlsTemplate = function controlsTemplate(collection, view) {\n        var subtitle = collectionDescription(view.model);\n        return \"\\n        <div class=\\\"controls\\\">\\n            <div class=\\\"navigation\\\">\\n            <a class=\\\"back\\\" href=\\\"javascript:void(0)\\\">\\n                <span class=\\\"fa fa-icon fa-angle-left\\\"></span>\\n                \" + (0, _localization2.default)(\"Back to \") + \"\\n                \" + _.escape(view.parentName) + \"\\n            </a>\\n            </div>\\n            <div class=\\\"title\\\">\\n                <div class=\\\"name\\\">\" + (_.escape(collection.name) || _.escape(collection.element_identifier)) + \"</div>\\n                <div class=\\\"subtitle\\\">\\n                    \" + subtitle + \"\\n                </div>\\n            </div>\\n            <div class=\\\"elements-warning\\\">\\n            </div>\\n            <div class=\\\"tags-display\\\"></div>\\n            <div class=\\\"actions\\\">\\n                <a class=\\\"download-btn icon-btn\\\" href=\\\"\" + view.downloadUrl + \"\\\"\\n                   title=\\\"\\\" download=\\\"\\\" data-original-title=\\\"Download Collection\\\">\\n                   <span class=\\\"fa fa-floppy-o\\\"></span>\\n                </a>\\n            </div>\\n        </div>\";\n    };\n\n    return _.extend(_.clone(_super.prototype.templates), {\n        controls: controlsTemplate\n    });\n}();\n\nfunction collectionTypeDescription(collection) {\n    var collectionType = collection.get(\"collection_type\");\n    var collectionTypeDescription;\n    if (collectionType == \"list\") {\n        collectionTypeDescription = (0, _localization2.default)(\"list\");\n    } else if (collectionType == \"paired\") {\n        collectionTypeDescription = (0, _localization2.default)(\"dataset pair\");\n    } else if (collectionType == \"list:paired\") {\n        collectionTypeDescription = (0, _localization2.default)(\"list of pairs\");\n    } else {\n        collectionTypeDescription = (0, _localization2.default)(\"nested list\");\n    }\n    return collectionTypeDescription;\n}\n\nfunction collectionDescription(collection) {\n    var elementCount = collection.get(\"element_count\");\n\n    var itemsDescription = \"a \" + collectionTypeDescription(collection);\n    if (elementCount) {\n        var countDescription;\n        if (elementCount == 1) {\n            countDescription = \"with 1 item\";\n        } else if (elementCount) {\n            countDescription = \"with \" + elementCount + \" items\";\n        }\n        itemsDescription = itemsDescription + \" \" + (0, _localization2.default)(countDescription);\n    }\n    return itemsDescription;\n}\n\n//==============================================================================\nexports.default = {\n    collectionTypeDescription: collectionTypeDescription,\n    collectionDescription: collectionDescription,\n    CollectionView: CollectionView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi12aWV3LmpzP2FhOTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExJU1RfVklFVyBmcm9tIFwibXZjL2xpc3QvbGlzdC12aWV3XCI7XG5pbXBvcnQgRENfTU9ERUwgZnJvbSBcIm12Yy9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tbW9kZWxcIjtcbmltcG9ydCBEQ19MSSBmcm9tIFwibXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1saVwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImNvbGxlY3Rpb25zXCI7XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuVE9ETzpcblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbi8qKiBAY2xhc3Mgbm9uLWVkaXRhYmxlLCByZWFkLW9ubHkgVmlldy9Db250cm9sbGVyIGZvciBhIGRhdGFzZXQgY29sbGVjdGlvbi5cbiAqL1xudmFyIF9zdXBlciA9IExJU1RfVklFVy5Nb2RlbExpc3RQYW5lbDtcbnZhciBDb2xsZWN0aW9uVmlldyA9IF9zdXBlci5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBDb2xsZWN0aW9uVmlldy5wcm90b3R5cGUgKi8ge1xuICAgICAgICAvL01PREVMIGlzIGVpdGhlciBhIERhdGFzZXRDb2xsZWN0aW9uIChvciBzdWJjbGFzcykgb3IgYSBEYXRhc2V0Q29sbGVjdGlvbkVsZW1lbnQgKGxpc3Qgb2YgcGFpcnMpXG4gICAgICAgIF9sb2dOYW1lc3BhY2U6IGxvZ05hbWVzcGFjZSxcblxuICAgICAgICBjbGFzc05hbWU6IGAke19zdXBlci5wcm90b3R5cGUuY2xhc3NOYW1lfSBkYXRhc2V0LWNvbGxlY3Rpb24tcGFuZWxgLFxuXG4gICAgICAgIC8qKiBzdWIgdmlldyBjbGFzcyB1c2VkIGZvciBkYXRhc2V0cyAqL1xuICAgICAgICBEYXRhc2V0RENFVmlld0NsYXNzOiBEQ19MSS5EYXRhc2V0RENFTGlzdEl0ZW1WaWV3LFxuXG4gICAgICAgIC8qKiBrZXkgb2YgYXR0cmlidXRlIGluIG1vZGVsIHRvIGFzc2lnbiB0byB0aGlzLmNvbGxlY3Rpb24gKi9cbiAgICAgICAgbW9kZWxDb2xsZWN0aW9uS2V5OiBcImVsZW1lbnRzXCIsXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBTRVQgVVBcbiAgICAgICAgLyoqIFNldCB1cCB0aGUgdmlldywgc2V0IHVwIHN0b3JhZ2UsIGJpbmQgbGlzdGVuZXJzIHRvIEhpc3RvcnlDb250ZW50cyBldmVudHNcbiAgICAgICAgICogIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzIG9wdGlvbmFsIHNldHRpbmdzIGZvciB0aGUgcGFuZWxcbiAgICAgICAgICovXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgdGhpcy5saW5rVGFyZ2V0ID0gYXR0cmlidXRlcy5saW5rVGFyZ2V0IHx8IFwiX2JsYW5rXCI7XG5cbiAgICAgICAgICAgIHRoaXMuaGFzVXNlciA9IGF0dHJpYnV0ZXMuaGFzVXNlcjtcbiAgICAgICAgICAgIC8qKiBBIHN0YWNrIG9mIHBhbmVscyB0aGF0IGN1cnJlbnRseSBjb3ZlciBvciBoaWRlIHRoaXMgcGFuZWwgKi9cbiAgICAgICAgICAgIHRoaXMucGFuZWxTdGFjayA9IFtdO1xuICAgICAgICAgICAgLyoqIFRoZSB0ZXh0IG9mIHRoZSBsaW5rIHRvIGdvIGJhY2sgdG8gdGhlIHBhbmVsIGNvbnRhaW5pbmcgdGhpcyBvbmUgKi9cbiAgICAgICAgICAgIHRoaXMucGFyZW50TmFtZSA9IGF0dHJpYnV0ZXMucGFyZW50TmFtZTtcbiAgICAgICAgICAgIC8qKiBmb2xkb3V0IG9yIGRyaWxsZG93biAqL1xuICAgICAgICAgICAgdGhpcy5mb2xkb3V0U3R5bGUgPSBhdHRyaWJ1dGVzLmZvbGRvdXRTdHlsZSB8fCBcImZvbGRvdXRcIjtcbiAgICAgICAgICAgIHRoaXMuZG93bmxvYWRVcmwgPSBgJHtHYWxheHkucm9vdH1hcGkvZGF0YXNldF9jb2xsZWN0aW9ucy8ke3RoaXMubW9kZWwuYXR0cmlidXRlcy5pZH0vZG93bmxvYWRgO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldE5lc3RlZERDRENFVmlld0NsYXNzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBEQ19MSS5OZXN0ZWREQ0RDRUxpc3RJdGVtVmlldy5leHRlbmQoe1xuICAgICAgICAgICAgICAgIGZvbGRvdXRQYW5lbENsYXNzOiBDb2xsZWN0aW9uVmlld1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX3F1ZXVlTmV3UmVuZGVyOiBmdW5jdGlvbigkbmV3UmVuZGVyLCBzcGVlZCkge1xuICAgICAgICAgICAgc3BlZWQgPSBzcGVlZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5meFNwZWVkIDogc3BlZWQ7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVXYXJuaW5nKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgcGFuZWwubG9nKFwiX3F1ZXVlTmV3UmVuZGVyOlwiLCAkbmV3UmVuZGVyLCBzcGVlZCk7XG5cbiAgICAgICAgICAgIC8vIFRPRE86IGpxdWVyeUAxLjEyIGRvZXNuJ3QgY2hhbmdlIGRpc3BsYXkgd2hlbiB0aGUgZWxlbSBoYXMgZGlzcGxheTogZmxleFxuICAgICAgICAgICAgLy8gdGhpcyBjYXVzZXMgZGlzcGxheTogYmxvY2sgZm9yIHRob3NlIGVsZW1zIGFmdGVyIHRoZSB1c2Ugb2Ygc2hvdy9oaWRlIGFuaW1hdGlvbnNcbiAgICAgICAgICAgIC8vIGFuaW1hdGlvbnMgYXJlIHJlbW92ZWQgZnJvbSB0aGlzIHZpZXcgZm9yIG5vdyB1bnRpbCBmaXhlZFxuICAgICAgICAgICAgcGFuZWwuX3N3YXBOZXdSZW5kZXIoJG5ld1JlbmRlcik7XG4gICAgICAgICAgICBwYW5lbC50cmlnZ2VyKFwicmVuZGVyZWRcIiwgcGFuZWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhhbmRsZVdhcm5pbmc6IGZ1bmN0aW9uKCRuZXdSZW5kZXIpIHtcbiAgICAgICAgICAgIHZhciB2aWV3TGVuZ3RoID0gdGhpcy52aWV3cy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZWxlbWVudENvdW50ID0gdGhpcy5tb2RlbC5nZXQoXCJlbGVtZW50X2NvdW50XCIpO1xuICAgICAgICAgICAgaWYgKGVsZW1lbnRDb3VudCAmJiBlbGVtZW50Q291bnQgIT09IHZpZXdMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2FybmluZyA9IF9sKGBkaXNwbGF5aW5nIG9ubHkgJHt2aWV3TGVuZ3RofSBvZiAke2VsZW1lbnRDb3VudH0gaXRlbXNgKTtcbiAgICAgICAgICAgICAgICB2YXIgJHdhcm5zID0gJG5ld1JlbmRlci5maW5kKFwiLmVsZW1lbnRzLXdhcm5pbmdcIik7XG4gICAgICAgICAgICAgICAgJHdhcm5zLmh0bWwoYDxkaXYgY2xhc3M9XCJ3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JHt3YXJuaW5nfTwvZGl2PmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzdWItdmlld3NcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIHVzZSBtb2RlbC5nZXRWaXNpYmxlQ29udGVudHMgKi9cbiAgICAgICAgX2ZpbHRlckNvbGxlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy9UT0RPOiBzaG91bGQgKm5vdCogYmUgbW9kZWwuZ2V0VmlzaWJsZUNvbnRlbnRzIC0gdmlzaWJpbGl0eSBpcyBub3QgbW9kZWwgcmVsYXRlZFxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuZ2V0VmlzaWJsZUNvbnRlbnRzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIG92ZXJyaWRlIHRvIHJldHVybiBwcm9wZXIgdmlldyBjbGFzcyBiYXNlZCBvbiBlbGVtZW50X3R5cGUgKi9cbiAgICAgICAgX2dldEl0ZW1WaWV3Q2xhc3M6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoIHRoaXMgKyAnLl9nZXRJdGVtVmlld0NsYXNzOicsIG1vZGVsICk7XG4gICAgICAgICAgICAvL1RPRE86IHN1YmNsYXNzZXMgdXNlIERDRVZpZXdDbGFzcyAtIGJ1dCBhcmUgY3VycmVudGx5IHVudXNlZCAtIGRlY2lkZVxuICAgICAgICAgICAgc3dpdGNoIChtb2RlbC5nZXQoXCJlbGVtZW50X3R5cGVcIikpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiaGRhXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkRhdGFzZXREQ0VWaWV3Q2xhc3M7XG4gICAgICAgICAgICAgICAgY2FzZSBcImRhdGFzZXRfY29sbGVjdGlvblwiOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXROZXN0ZWREQ0RDRVZpZXdDbGFzcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlVua25vd24gZWxlbWVudCB0eXBlOlwiLCBtb2RlbC5nZXQoXCJlbGVtZW50X3R5cGVcIikpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBvdmVycmlkZSB0byBhZGQgbGluayB0YXJnZXQgYW5kIGFub24gKi9cbiAgICAgICAgX2dldEl0ZW1WaWV3T3B0aW9uczogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gX3N1cGVyLnByb3RvdHlwZS5fZ2V0SXRlbVZpZXdPcHRpb25zLmNhbGwodGhpcywgbW9kZWwpO1xuICAgICAgICAgICAgcmV0dXJuIF8uZXh0ZW5kKG9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICBsaW5rVGFyZ2V0OiB0aGlzLmxpbmtUYXJnZXQsXG4gICAgICAgICAgICAgICAgaGFzVXNlcjogdGhpcy5oYXNVc2VyLFxuICAgICAgICAgICAgICAgIC8vVE9ETzogY291bGQgbW92ZSB0byBvbmx5IG5lc3RlZDogbGlzdDpwYWlyZWRcbiAgICAgICAgICAgICAgICBmb2xkb3V0U3R5bGU6IHRoaXMuZm9sZG91dFN0eWxlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gY29sbGVjdGlvbiBzdWItdmlld3NcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGFkZC9yZW1vdmUgZXhwYW5kZWQvY29sbGFwc2VkIG1vZGVsIGlkcyB0by9mcm9tIHdlYiBzdG9yYWdlICovXG4gICAgICAgIF9zZXRVcEl0ZW1WaWV3TGlzdGVuZXJzOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBJdGVtVmlld0xpc3RlbmVycy5jYWxsKHBhbmVsLCB2aWV3KTtcblxuICAgICAgICAgICAgLy8gdXNlIHB1Yi1zdWIgdG86IGhhbmRsZSBkcmlsbGRvd24gZXhwYW5zaW9uIGFuZCBjb2xsYXBzZVxuICAgICAgICAgICAgcGFuZWwubGlzdGVuVG8odmlldywge1xuICAgICAgICAgICAgICAgIFwiZXhwYW5kZWQ6ZHJpbGxkb3duXCI6IGZ1bmN0aW9uKHYsIGRyaWxsZG93bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmREcmlsbGRvd25QYW5lbChkcmlsbGRvd24pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjb2xsYXBzZWQ6ZHJpbGxkb3duXCI6IGZ1bmN0aW9uKHYsIGRyaWxsZG93bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb2xsYXBzZURyaWxsZG93blBhbmVsKGRyaWxsZG93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSGFuZGxlIGRyaWxsIGRvd24gYnkgaGlkaW5nIHRoaXMgcGFuZWxzIGxpc3QgYW5kIGNvbnRyb2xzIGFuZCBzaG93aW5nIHRoZSBzdWItcGFuZWwgKi9cbiAgICAgICAgX2V4cGFuZERyaWxsZG93blBhbmVsOiBmdW5jdGlvbihkcmlsbGRvd24pIHtcbiAgICAgICAgICAgIHRoaXMucGFuZWxTdGFjay5wdXNoKGRyaWxsZG93bik7XG4gICAgICAgICAgICAvLyBoaWRlIHRoaXMgcGFuZWwncyBjb250cm9scyBhbmQgbGlzdCwgc2V0IHRoZSBuYW1lIGZvciBiYWNrIG5hdmlnYXRpb24sIGFuZCBhdHRhY2ggdG8gdGhlICRlbFxuICAgICAgICAgICAgdGhpcy4kKFwiPiAuY29udHJvbHNcIilcbiAgICAgICAgICAgICAgICAuYWRkKHRoaXMuJGxpc3QoKSlcbiAgICAgICAgICAgICAgICAuaGlkZSgpO1xuICAgICAgICAgICAgZHJpbGxkb3duLnBhcmVudE5hbWUgPSB0aGlzLm1vZGVsLmdldChcIm5hbWVcIik7XG4gICAgICAgICAgICB0aGlzLiRlbC5hcHBlbmQoZHJpbGxkb3duLnJlbmRlcigpLiRlbCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEhhbmRsZSBkcmlsbGRvd24gY2xvc2UgYnkgZnJlZWluZyB0aGUgcGFuZWwgYW5kIHJlLXJlbmRlcmluZyB0aGlzIHBhbmVsICovXG4gICAgICAgIF9jb2xsYXBzZURyaWxsZG93blBhbmVsOiBmdW5jdGlvbihkcmlsbGRvd24pIHtcbiAgICAgICAgICAgIHRoaXMucGFuZWxTdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBhbmVsIGV2ZW50c1xuICAgICAgICAvKiogZXZlbnQgbWFwICovXG4gICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgXCJjbGljayAubmF2aWdhdGlvbiAuYmFja1wiOiBcImNsb3NlXCJcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY2xvc2UvcmVtb3ZlIHRoaXMgY29sbGVjdGlvbiBwYW5lbCAqL1xuICAgICAgICBjbG9zZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJjbG9zZVwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gYENvbGxlY3Rpb25WaWV3KCR7dGhpcy5tb2RlbCA/IHRoaXMubW9kZWwuZ2V0KFwibmFtZVwiKSA6IFwiXCJ9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBURU1QTEFURVNcbkNvbGxlY3Rpb25WaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT4ge1xuICAgIHZhciBjb250cm9sc1RlbXBsYXRlID0gKGNvbGxlY3Rpb24sIHZpZXcpID0+IHtcbiAgICAgICAgdmFyIHN1YnRpdGxlID0gY29sbGVjdGlvbkRlc2NyaXB0aW9uKHZpZXcubW9kZWwpO1xuICAgICAgICByZXR1cm4gYFxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJuYXZpZ2F0aW9uXCI+XG4gICAgICAgICAgICA8YSBjbGFzcz1cImJhY2tcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJmYSBmYS1pY29uIGZhLWFuZ2xlLWxlZnRcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgJHtfbChcIkJhY2sgdG8gXCIpfVxuICAgICAgICAgICAgICAgICR7Xy5lc2NhcGUodmlldy5wYXJlbnROYW1lKX1cbiAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm5hbWVcIj4ke18uZXNjYXBlKGNvbGxlY3Rpb24ubmFtZSkgfHwgXy5lc2NhcGUoY29sbGVjdGlvbi5lbGVtZW50X2lkZW50aWZpZXIpfTwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdWJ0aXRsZVwiPlxuICAgICAgICAgICAgICAgICAgICAke3N1YnRpdGxlfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZWxlbWVudHMtd2FybmluZ1wiPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFncy1kaXNwbGF5XCI+PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWN0aW9uc1wiPlxuICAgICAgICAgICAgICAgIDxhIGNsYXNzPVwiZG93bmxvYWQtYnRuIGljb24tYnRuXCIgaHJlZj1cIiR7dmlldy5kb3dubG9hZFVybH1cIlxuICAgICAgICAgICAgICAgICAgIHRpdGxlPVwiXCIgZG93bmxvYWQ9XCJcIiBkYXRhLW9yaWdpbmFsLXRpdGxlPVwiRG93bmxvYWQgQ29sbGVjdGlvblwiPlxuICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiZmEgZmEtZmxvcHB5LW9cIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PmA7XG4gICAgfTtcblxuICAgIHJldHVybiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzKSwge1xuICAgICAgICBjb250cm9sczogY29udHJvbHNUZW1wbGF0ZVxuICAgIH0pO1xufSkoKTtcblxuZnVuY3Rpb24gY29sbGVjdGlvblR5cGVEZXNjcmlwdGlvbihjb2xsZWN0aW9uKSB7XG4gICAgdmFyIGNvbGxlY3Rpb25UeXBlID0gY29sbGVjdGlvbi5nZXQoXCJjb2xsZWN0aW9uX3R5cGVcIik7XG4gICAgdmFyIGNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb247XG4gICAgaWYgKGNvbGxlY3Rpb25UeXBlID09IFwibGlzdFwiKSB7XG4gICAgICAgIGNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24gPSBfbChcImxpc3RcIik7XG4gICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uVHlwZSA9PSBcInBhaXJlZFwiKSB7XG4gICAgICAgIGNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24gPSBfbChcImRhdGFzZXQgcGFpclwiKTtcbiAgICB9IGVsc2UgaWYgKGNvbGxlY3Rpb25UeXBlID09IFwibGlzdDpwYWlyZWRcIikge1xuICAgICAgICBjb2xsZWN0aW9uVHlwZURlc2NyaXB0aW9uID0gX2woXCJsaXN0IG9mIHBhaXJzXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24gPSBfbChcIm5lc3RlZCBsaXN0XCIpO1xuICAgIH1cbiAgICByZXR1cm4gY29sbGVjdGlvblR5cGVEZXNjcmlwdGlvbjtcbn1cblxuZnVuY3Rpb24gY29sbGVjdGlvbkRlc2NyaXB0aW9uKGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgZWxlbWVudENvdW50ID0gY29sbGVjdGlvbi5nZXQoXCJlbGVtZW50X2NvdW50XCIpO1xuXG4gICAgdmFyIGl0ZW1zRGVzY3JpcHRpb24gPSBgYSAke2NvbGxlY3Rpb25UeXBlRGVzY3JpcHRpb24oY29sbGVjdGlvbil9YDtcbiAgICBpZiAoZWxlbWVudENvdW50KSB7XG4gICAgICAgIHZhciBjb3VudERlc2NyaXB0aW9uO1xuICAgICAgICBpZiAoZWxlbWVudENvdW50ID09IDEpIHtcbiAgICAgICAgICAgIGNvdW50RGVzY3JpcHRpb24gPSBcIndpdGggMSBpdGVtXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudENvdW50KSB7XG4gICAgICAgICAgICBjb3VudERlc2NyaXB0aW9uID0gYHdpdGggJHtlbGVtZW50Q291bnR9IGl0ZW1zYDtcbiAgICAgICAgfVxuICAgICAgICBpdGVtc0Rlc2NyaXB0aW9uID0gYCR7aXRlbXNEZXNjcmlwdGlvbn0gJHtfbChjb3VudERlc2NyaXB0aW9uKX1gO1xuICAgIH1cbiAgICByZXR1cm4gaXRlbXNEZXNjcmlwdGlvbjtcbn1cblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBjb2xsZWN0aW9uVHlwZURlc2NyaXB0aW9uOiBjb2xsZWN0aW9uVHlwZURlc2NyaXB0aW9uLFxuICAgIGNvbGxlY3Rpb25EZXNjcmlwdGlvbjogY29sbGVjdGlvbkRlc2NyaXB0aW9uLFxuICAgIENvbGxlY3Rpb25WaWV3OiBDb2xsZWN0aW9uVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvY29sbGVjdGlvbi9jb2xsZWN0aW9uLXZpZXcuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTs7OztBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdJQTtBQUNBO0FBZ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///60\n");

/***/ }),
/* 61 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/dataset-li-edit.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _datasetLi = __webpack_require__(/*! mvc/dataset/dataset-li */ 17);\n\nvar _datasetLi2 = _interopRequireDefault(_datasetLi);\n\nvar _tag = __webpack_require__(/*! mvc/tag */ 23);\n\nvar _tag2 = _interopRequireDefault(_tag);\n\nvar _annotation = __webpack_require__(/*! mvc/annotation */ 62);\n\nvar _annotation2 = _interopRequireDefault(_annotation);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _datasetLi2.default.DatasetListItemView;\n/** @class Editing view for DatasetAssociation.\n */\nvar DatasetListItemEdit = _super.extend(\n/** @lends DatasetListItemEdit.prototype */{\n    /** set up: options */\n    initialize: function initialize(attributes) {\n        _super.prototype.initialize.call(this, attributes);\n        this.hasUser = attributes.hasUser;\n\n        /** allow user purge of dataset files? */\n        this.purgeAllowed = attributes.purgeAllowed || false;\n\n        //TODO: move to HiddenUntilActivatedViewMixin\n        /** should the tags editor be shown or hidden initially? */\n        this.tagsEditorShown = attributes.tagsEditorShown || false;\n        /** should the tags editor be shown or hidden initially? */\n        this.annotationEditorShown = attributes.annotationEditorShown || false;\n    },\n\n    // ......................................................................... titlebar actions\n    /** In this override, add the other two primary actions: edit and delete */\n    _renderPrimaryActions: function _renderPrimaryActions() {\n        var actions = _super.prototype._renderPrimaryActions.call(this);\n        if (this.model.get(\"state\") === _states2.default.NOT_VIEWABLE) {\n            return actions;\n        }\n        // render the display, edit attr and delete icon-buttons\n        return _super.prototype._renderPrimaryActions.call(this).concat([this._renderEditButton(), this._renderDeleteButton()]);\n    },\n\n    //TODO: move titleButtons into state renderers, remove state checks in the buttons\n\n    /** Render icon-button to edit the attributes (format, permissions, etc.) this dataset. */\n    _renderEditButton: function _renderEditButton() {\n        var self = this;\n        // don't show edit while uploading, in-accessible\n        // DO show if in error (ala previous history panel)\n        if (this.model.get(\"state\") === _states2.default.DISCARDED || !this.model.get(\"accessible\")) {\n            return null;\n        }\n        var purged = this.model.get(\"purged\");\n        var deleted = this.model.get(\"deleted\");\n\n        var editBtnData = {\n            title: (0, _localization2.default)(\"Edit attributes\"),\n            href: Galaxy.root + \"datasets/edit?dataset_id=\" + this.model.attributes.id,\n            faIcon: \"fa-pencil\",\n            classes: \"edit-btn\",\n            onclick: function onclick(ev) {\n                if (Galaxy.router) {\n                    ev.preventDefault();\n                    Galaxy.router.push(\"datasets/edit\", {\n                        dataset_id: self.model.attributes.id\n                    });\n                }\n            }\n        };\n\n        // disable if purged or deleted and explain why in the tooltip\n        if (deleted || purged) {\n            editBtnData.disabled = true;\n            if (purged) {\n                editBtnData.title = (0, _localization2.default)(\"Cannot edit attributes of datasets removed from disk\");\n            } else if (deleted) {\n                editBtnData.title = (0, _localization2.default)(\"Undelete dataset to edit attributes\");\n            }\n\n            // disable if still uploading or new\n        } else if (_.contains([_states2.default.UPLOAD, _states2.default.NEW], this.model.get(\"state\"))) {\n            editBtnData.disabled = true;\n            editBtnData.title = (0, _localization2.default)(\"This dataset is not yet editable\");\n        }\n        return (0, _faIconButton2.default)(editBtnData);\n    },\n\n    /** Render icon-button to delete this hda. */\n    _renderDeleteButton: function _renderDeleteButton() {\n        // don't show delete if...\n        if (!this.model.get(\"accessible\")) {\n            return null;\n        }\n\n        var self = this;\n        var deletedAlready = this.model.isDeletedOrPurged();\n        return (0, _faIconButton2.default)({\n            title: !deletedAlready ? (0, _localization2.default)(\"Delete\") : (0, _localization2.default)(\"Dataset is already deleted\"),\n            disabled: deletedAlready,\n            faIcon: \"fa-times\",\n            classes: \"delete-btn\",\n            onclick: function onclick() {\n                // ...bler... tooltips being left behind in DOM (hover out never called on deletion)\n                self.$el.find(\".icon-btn.delete-btn\").trigger(\"mouseout\");\n                self.model[\"delete\"]();\n            }\n        });\n    },\n\n    // ......................................................................... details\n    /** In this override, add tags and annotations controls, make the ? dbkey a link to editing page */\n    _renderDetails: function _renderDetails() {\n        //TODO: generalize to be allow different details for each state\n        var $details = _super.prototype._renderDetails.call(this);\n\n        var state = this.model.get(\"state\");\n\n        if (!this.model.isDeletedOrPurged() && _.contains([_states2.default.OK, _states2.default.FAILED_METADATA], state)) {\n            this._renderTags($details);\n            this._renderAnnotation($details);\n            this._makeDbkeyEditLink($details);\n        }\n\n        this._setUpBehaviors($details);\n        return $details;\n    },\n\n    /**************************************************************************\n     * Render help button to show tool help text without rerunning the tool.\n     * Issue #2100\n     */\n    _renderToolHelpButton: function _renderToolHelpButton() {\n        var datasetID = this.model.attributes.dataset_id;\n        var jobID = this.model.attributes.creating_job;\n        var self = this;\n\n        var parseToolBuild = function parseToolBuild(data) {\n            var helpString = \"<div id=\\\"thdiv-\" + datasetID + \"\\\" class=\\\"toolhelp\\\">\";\n            if (data.name && data.help) {\n                helpString += \"<strong>Tool help for \" + data.name + \"</strong><hr/>\";\n                helpString += data.help;\n            } else {\n                helpString += \"<strong>Tool help is unavailable for this dataset.</strong><hr/>\";\n            }\n            helpString += \"</div>\";\n            self.$el.find(\".details\").append($.parseHTML(helpString));\n        };\n        var parseToolID = function parseToolID(data) {\n            $.ajax({\n                url: Galaxy.root + \"api/tools/\" + data.tool_id + \"/build\"\n            }).done(function (data) {\n                parseToolBuild(data);\n            }).fail(function () {\n                parseToolBuild({});\n            });\n        };\n        if (Galaxy.user.id === null) {\n            return null;\n        }\n        return (0, _faIconButton2.default)({\n            title: (0, _localization2.default)(\"Tool Help\"),\n            classes: \"icon-btn\",\n            href: \"#\",\n            faIcon: \"fa-question\",\n            onclick: function onclick() {\n                var divString = \"thdiv-\" + datasetID;\n                if (self.$el.find(\".toolhelp\").length > 0) {\n                    self.$el.find(\".toolhelp\").toggle();\n                } else {\n                    $.ajax({\n                        url: Galaxy.root + \"api/jobs/\" + jobID\n                    }).done(function (data) {\n                        parseToolID(data);\n                    }).fail(function () {\n                        console.log(\"Failed at recovering job information from the  Galaxy API for job id \\\"\" + jobID + \"\\\".\");\n                    });\n                }\n            }\n        });\n    },\n    //*************************************************************************\n\n    /** Add less commonly used actions in the details section based on state */\n    _renderSecondaryActions: function _renderSecondaryActions() {\n        var actions = _super.prototype._renderSecondaryActions.call(this);\n        switch (this.model.get(\"state\")) {\n            case _states2.default.UPLOAD:\n            case _states2.default.NOT_VIEWABLE:\n                return actions;\n            case _states2.default.ERROR:\n                // error button comes first\n                actions.unshift(this._renderErrButton());\n                return actions.concat([this._renderRerunButton(), this._renderToolHelpButton()]);\n            case _states2.default.OK:\n            case _states2.default.FAILED_METADATA:\n                return actions.concat([this._renderRerunButton(), this._renderVisualizationsButton(), this._renderToolHelpButton()]);\n        }\n        return actions.concat([this._renderRerunButton(), this._renderToolHelpButton()]);\n    },\n\n    /** Render icon-button to report an error on this dataset to the galaxy admin. */\n    _renderErrButton: function _renderErrButton() {\n        var self = this;\n        return (0, _faIconButton2.default)({\n            title: (0, _localization2.default)(\"View or report this error\"),\n            href: Galaxy.root + \"datasets/error?dataset_id=\" + this.model.attributes.id,\n            classes: \"report-error-btn\",\n            faIcon: \"fa-bug\",\n            onclick: function onclick(ev) {\n                if (Galaxy.router) {\n                    ev.preventDefault();\n                    Galaxy.router.push(\"datasets/error\", {\n                        dataset_id: self.model.attributes.id\n                    });\n                }\n            }\n        });\n    },\n\n    /** Render icon-button to re-run the job that created this dataset. */\n    _renderRerunButton: function _renderRerunButton() {\n        var creating_job = this.model.get(\"creating_job\");\n        if (this.model.get(\"rerunnable\")) {\n            return (0, _faIconButton2.default)({\n                title: (0, _localization2.default)(\"Run this job again\"),\n                href: this.model.urls.rerun,\n                classes: \"rerun-btn\",\n                target: this.linkTarget,\n                faIcon: \"fa-refresh\",\n                onclick: function onclick(ev) {\n                    if (Galaxy.router) {\n                        ev.preventDefault();\n                        Galaxy.router.push(\"/\", {\n                            job_id: creating_job\n                        });\n                    }\n                }\n            });\n        }\n    },\n\n    /** Render an icon-button or popupmenu of links based on the applicable visualizations */\n    _renderVisualizationsButton: function _renderVisualizationsButton() {\n        //TODO: someday - lazyload visualizations\n        var visualizations = this.model.get(\"visualizations\");\n        if (this.model.isDeletedOrPurged() || !this.hasUser || !this.model.hasData() || _.isEmpty(visualizations)) {\n            return null;\n        }\n        if (!_.isObject(visualizations[0])) {\n            this.warn(\"Visualizations have been switched off\");\n            return null;\n        }\n\n        var $visualizations = $(this.templates.visualizations(visualizations, this));\n        //HACK: need to re-write those directed at galaxy_main with linkTarget\n        $visualizations.find('[target=\"galaxy_main\"]').attr(\"target\", this.linkTarget);\n        // use addBack here to include the root $visualizations elem (for the case of 1 visualization)\n        this._addScratchBookFn($visualizations.find(\".visualization-link\").addBack(\".visualization-link\"));\n        return $visualizations;\n    },\n\n    /** add scratchbook functionality to visualization links */\n    _addScratchBookFn: function _addScratchBookFn($links) {\n        var li = this;\n        $links.click(function (ev) {\n            if (Galaxy.frame && Galaxy.frame.active) {\n                Galaxy.frame.add({\n                    title: (0, _localization2.default)(\"Visualization\"),\n                    url: $(this).attr(\"href\")\n                });\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        });\n    },\n\n    //TODO: if possible move these to readonly view - but display the owner's tags/annotation (no edit)\n    /** Render the tags list/control */\n    _renderTags: function _renderTags($where) {\n        if (!this.hasUser) {\n            return;\n        }\n        var view = this;\n        this.tagsEditor = new _tag2.default.TagsEditor({\n            model: this.model,\n            el: $where.find(\".tags-display\"),\n            onshowFirstTime: function onshowFirstTime() {\n                this.render();\n            },\n            // persist state on the hda view (and not the editor) since these are currently re-created each time\n            onshow: function onshow() {\n                view.tagsEditorShown = true;\n            },\n            onhide: function onhide() {\n                view.tagsEditorShown = false;\n            },\n            $activator: (0, _faIconButton2.default)({\n                title: (0, _localization2.default)(\"Edit dataset tags\"),\n                classes: \"tag-btn\",\n                faIcon: \"fa-tags\"\n            }).appendTo($where.find(\".actions .right\"))\n        });\n        if (this.tagsEditorShown) {\n            this.tagsEditor.toggle(true);\n        }\n    },\n\n    /** Render the annotation display/control */\n    _renderAnnotation: function _renderAnnotation($where) {\n        if (!this.hasUser) {\n            return;\n        }\n        var view = this;\n        this.annotationEditor = new _annotation2.default.AnnotationEditor({\n            model: this.model,\n            el: $where.find(\".annotation-display\"),\n            onshowFirstTime: function onshowFirstTime() {\n                this.render();\n            },\n            // persist state on the hda view (and not the editor) since these are currently re-created each time\n            onshow: function onshow() {\n                view.annotationEditorShown = true;\n            },\n            onhide: function onhide() {\n                view.annotationEditorShown = false;\n            },\n            $activator: (0, _faIconButton2.default)({\n                title: (0, _localization2.default)(\"Edit dataset annotation\"),\n                classes: \"annotate-btn\",\n                faIcon: \"fa-comment\"\n            }).appendTo($where.find(\".actions .right\"))\n        });\n        if (this.annotationEditorShown) {\n            this.annotationEditor.toggle(true);\n        }\n    },\n\n    /** If the format/dbkey/genome_build isn't set, make the display a link to the edit page */\n    _makeDbkeyEditLink: function _makeDbkeyEditLink($details) {\n        // make the dbkey a link to editing\n        if (this.model.get(\"metadata_dbkey\") === \"?\" && !this.model.isDeletedOrPurged()) {\n            var editableDbkey = $('<a class=\"value\">?</a>').attr(\"href\", this.model.urls.edit).attr(\"target\", \"_top\");\n            $details.find(\".dbkey .value\").replaceWith(editableDbkey);\n        }\n    },\n\n    // ......................................................................... events\n    /** event map */\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .undelete-link\": \"_clickUndeleteLink\",\n        \"click .purge-link\": \"_clickPurgeLink\",\n\n        \"click .edit-btn\": function clickEditBtn(ev) {\n            this.trigger(\"edit\", this, ev);\n        },\n        \"click .delete-btn\": function clickDeleteBtn(ev) {\n            this.trigger(\"delete\", this, ev);\n        },\n        \"click .rerun-btn\": function clickRerunBtn(ev) {\n            this.trigger(\"rerun\", this, ev);\n        },\n        \"click .report-err-btn\": function clickReportErrBtn(ev) {\n            this.trigger(\"report-err\", this, ev);\n        },\n        \"click .visualization-btn\": function clickVisualizationBtn(ev) {\n            this.trigger(\"visualize\", this, ev);\n        },\n        \"click .dbkey a\": function clickDbkeyA(ev) {\n            this.trigger(\"edit\", this, ev);\n        }\n    }),\n\n    /** listener for item undelete (in the messages section) */\n    _clickUndeleteLink: function _clickUndeleteLink(ev) {\n        this.model.undelete();\n        return false;\n    },\n\n    /** listener for item purge (in the messages section) */\n    _clickPurgeLink: function _clickPurgeLink(ev) {\n        if (confirm((0, _localization2.default)(\"This will permanently remove the data in your dataset. Are you sure?\"))) {\n            this.model.purge();\n        }\n        return false;\n    },\n\n    // ......................................................................... misc\n    /** string rep */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"HDAEditView(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDatasetListItemEdit.prototype.templates = function () {\n    var warnings = _.extend({}, _super.prototype.templates.warnings, {\n        failed_metadata: _baseMvc2.default.wrapTemplate([\n        // in this override, provide a link to the edit page\n        '<% if( dataset.state === \"failed_metadata\" ){ %>', '<div class=\"failed_metadata-warning warningmessagesmall\">', (0, _localization2.default)(\"An error occurred setting the metadata for this dataset\"), '<br /><a href=\"<%- dataset.urls.edit %>\" target=\"_top\">', (0, _localization2.default)(\"Set it manually or retry auto-detection\"), \"</a>\", \"</div>\", \"<% } %>\"], \"dataset\"),\n\n        deleted: _baseMvc2.default.wrapTemplate([\n        // in this override, provide links to undelete or purge the dataset\n        \"<% if( dataset.deleted && !dataset.purged ){ %>\",\n        // deleted not purged\n        '<div class=\"deleted-msg warningmessagesmall\">', (0, _localization2.default)(\"This dataset has been deleted\"), '<br /><a class=\"undelete-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Undelete it\"), \"</a>\", \"<% if( view.purgeAllowed ){ %>\", '<br /><a class=\"purge-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Permanently remove it from disk\"), \"</a>\", \"<% } %>\", \"</div>\", \"<% } %>\"], \"dataset\")\n    });\n\n    var visualizationsTemplate = _baseMvc2.default.wrapTemplate([\"<% if( visualizations.length === 1 ){ %>\", '<a class=\"visualization-link icon-btn\" href=\"<%- visualizations[0].href %>\"', ' target=\"<%- visualizations[0].target %>\" title=\"', (0, _localization2.default)(\"Visualize in\"), ' <%- visualizations[0].html %>\">', '<span class=\"fa fa-bar-chart-o\"></span>', \"</a>\", \"<% } else { %>\", '<div class=\"visualizations-dropdown dropdown icon-btn\">', '<a data-toggle=\"dropdown\" title=\"', (0, _localization2.default)(\"Visualize\"), '\">', '<span class=\"fa fa-bar-chart-o\"></span>', \"</a>\", '<ul class=\"dropdown-menu\" role=\"menu\">', \"<% _.each( visualizations, function( visualization ){ %>\", '<li><a class=\"visualization-link\" href=\"<%- visualization.href %>\"', ' target=\"<%- visualization.target %>\">', \"<%- visualization.html %>\", \"</a></li>\", \"<% }); %>\", \"</ul>\", \"</div>\", \"<% } %>\"], \"visualizations\");\n\n    return _.extend({}, _super.prototype.templates, {\n        warnings: warnings,\n        visualizations: visualizationsTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    DatasetListItemEdit: DatasetListItemEdit\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1saS1lZGl0LmpzPzQxMTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNUQVRFUyBmcm9tIFwibXZjL2RhdGFzZXQvc3RhdGVzXCI7XG5pbXBvcnQgREFUQVNFVF9MSSBmcm9tIFwibXZjL2RhdGFzZXQvZGF0YXNldC1saVwiO1xuaW1wb3J0IFRBR1MgZnJvbSBcIm12Yy90YWdcIjtcbmltcG9ydCBBTk5PVEFUSU9OUyBmcm9tIFwibXZjL2Fubm90YXRpb25cIjtcbmltcG9ydCBmYUljb25CdXR0b24gZnJvbSBcInVpL2ZhLWljb24tYnV0dG9uXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnZhciBfc3VwZXIgPSBEQVRBU0VUX0xJLkRhdGFzZXRMaXN0SXRlbVZpZXc7XG4vKiogQGNsYXNzIEVkaXRpbmcgdmlldyBmb3IgRGF0YXNldEFzc29jaWF0aW9uLlxuICovXG52YXIgRGF0YXNldExpc3RJdGVtRWRpdCA9IF9zdXBlci5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBEYXRhc2V0TGlzdEl0ZW1FZGl0LnByb3RvdHlwZSAqLyB7XG4gICAgICAgIC8qKiBzZXQgdXA6IG9wdGlvbnMgKi9cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICB0aGlzLmhhc1VzZXIgPSBhdHRyaWJ1dGVzLmhhc1VzZXI7XG5cbiAgICAgICAgICAgIC8qKiBhbGxvdyB1c2VyIHB1cmdlIG9mIGRhdGFzZXQgZmlsZXM/ICovXG4gICAgICAgICAgICB0aGlzLnB1cmdlQWxsb3dlZCA9IGF0dHJpYnV0ZXMucHVyZ2VBbGxvd2VkIHx8IGZhbHNlO1xuXG4gICAgICAgICAgICAvL1RPRE86IG1vdmUgdG8gSGlkZGVuVW50aWxBY3RpdmF0ZWRWaWV3TWl4aW5cbiAgICAgICAgICAgIC8qKiBzaG91bGQgdGhlIHRhZ3MgZWRpdG9yIGJlIHNob3duIG9yIGhpZGRlbiBpbml0aWFsbHk/ICovXG4gICAgICAgICAgICB0aGlzLnRhZ3NFZGl0b3JTaG93biA9IGF0dHJpYnV0ZXMudGFnc0VkaXRvclNob3duIHx8IGZhbHNlO1xuICAgICAgICAgICAgLyoqIHNob3VsZCB0aGUgdGFncyBlZGl0b3IgYmUgc2hvd24gb3IgaGlkZGVuIGluaXRpYWxseT8gKi9cbiAgICAgICAgICAgIHRoaXMuYW5ub3RhdGlvbkVkaXRvclNob3duID0gYXR0cmlidXRlcy5hbm5vdGF0aW9uRWRpdG9yU2hvd24gfHwgZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiB0aXRsZWJhciBhY3Rpb25zXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQgdGhlIG90aGVyIHR3byBwcmltYXJ5IGFjdGlvbnM6IGVkaXQgYW5kIGRlbGV0ZSAqL1xuICAgICAgICBfcmVuZGVyUHJpbWFyeUFjdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGFjdGlvbnMgPSBfc3VwZXIucHJvdG90eXBlLl9yZW5kZXJQcmltYXJ5QWN0aW9ucy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIikgPT09IFNUQVRFUy5OT1RfVklFV0FCTEUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHJlbmRlciB0aGUgZGlzcGxheSwgZWRpdCBhdHRyIGFuZCBkZWxldGUgaWNvbi1idXR0b25zXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5fcmVuZGVyUHJpbWFyeUFjdGlvbnNcbiAgICAgICAgICAgICAgICAuY2FsbCh0aGlzKVxuICAgICAgICAgICAgICAgIC5jb25jYXQoW3RoaXMuX3JlbmRlckVkaXRCdXR0b24oKSwgdGhpcy5fcmVuZGVyRGVsZXRlQnV0dG9uKCldKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvL1RPRE86IG1vdmUgdGl0bGVCdXR0b25zIGludG8gc3RhdGUgcmVuZGVyZXJzLCByZW1vdmUgc3RhdGUgY2hlY2tzIGluIHRoZSBidXR0b25zXG5cbiAgICAgICAgLyoqIFJlbmRlciBpY29uLWJ1dHRvbiB0byBlZGl0IHRoZSBhdHRyaWJ1dGVzIChmb3JtYXQsIHBlcm1pc3Npb25zLCBldGMuKSB0aGlzIGRhdGFzZXQuICovXG4gICAgICAgIF9yZW5kZXJFZGl0QnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIC8vIGRvbid0IHNob3cgZWRpdCB3aGlsZSB1cGxvYWRpbmcsIGluLWFjY2Vzc2libGVcbiAgICAgICAgICAgIC8vIERPIHNob3cgaWYgaW4gZXJyb3IgKGFsYSBwcmV2aW91cyBoaXN0b3J5IHBhbmVsKVxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIikgPT09IFNUQVRFUy5ESVNDQVJERUQgfHwgIXRoaXMubW9kZWwuZ2V0KFwiYWNjZXNzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHB1cmdlZCA9IHRoaXMubW9kZWwuZ2V0KFwicHVyZ2VkXCIpO1xuICAgICAgICAgICAgdmFyIGRlbGV0ZWQgPSB0aGlzLm1vZGVsLmdldChcImRlbGV0ZWRcIik7XG5cbiAgICAgICAgICAgIHZhciBlZGl0QnRuRGF0YSA9IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJFZGl0IGF0dHJpYnV0ZXNcIiksXG4gICAgICAgICAgICAgICAgaHJlZjogYCR7R2FsYXh5LnJvb3R9ZGF0YXNldHMvZWRpdD9kYXRhc2V0X2lkPSR7dGhpcy5tb2RlbC5hdHRyaWJ1dGVzLmlkfWAsXG4gICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLXBlbmNpbFwiLFxuICAgICAgICAgICAgICAgIGNsYXNzZXM6IFwiZWRpdC1idG5cIixcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoR2FsYXh5LnJvdXRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIEdhbGF4eS5yb3V0ZXIucHVzaChcImRhdGFzZXRzL2VkaXRcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzZXRfaWQ6IHNlbGYubW9kZWwuYXR0cmlidXRlcy5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBkaXNhYmxlIGlmIHB1cmdlZCBvciBkZWxldGVkIGFuZCBleHBsYWluIHdoeSBpbiB0aGUgdG9vbHRpcFxuICAgICAgICAgICAgaWYgKGRlbGV0ZWQgfHwgcHVyZ2VkKSB7XG4gICAgICAgICAgICAgICAgZWRpdEJ0bkRhdGEuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChwdXJnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdEJ0bkRhdGEudGl0bGUgPSBfbChcIkNhbm5vdCBlZGl0IGF0dHJpYnV0ZXMgb2YgZGF0YXNldHMgcmVtb3ZlZCBmcm9tIGRpc2tcIik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRCdG5EYXRhLnRpdGxlID0gX2woXCJVbmRlbGV0ZSBkYXRhc2V0IHRvIGVkaXQgYXR0cmlidXRlc1wiKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIGlmIHN0aWxsIHVwbG9hZGluZyBvciBuZXdcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXy5jb250YWlucyhbU1RBVEVTLlVQTE9BRCwgU1RBVEVTLk5FV10sIHRoaXMubW9kZWwuZ2V0KFwic3RhdGVcIikpKSB7XG4gICAgICAgICAgICAgICAgZWRpdEJ0bkRhdGEuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGVkaXRCdG5EYXRhLnRpdGxlID0gX2woXCJUaGlzIGRhdGFzZXQgaXMgbm90IHlldCBlZGl0YWJsZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYUljb25CdXR0b24oZWRpdEJ0bkRhdGEpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBSZW5kZXIgaWNvbi1idXR0b24gdG8gZGVsZXRlIHRoaXMgaGRhLiAqL1xuICAgICAgICBfcmVuZGVyRGVsZXRlQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIGRvbid0IHNob3cgZGVsZXRlIGlmLi4uXG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwuZ2V0KFwiYWNjZXNzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGVsZXRlZEFscmVhZHkgPSB0aGlzLm1vZGVsLmlzRGVsZXRlZE9yUHVyZ2VkKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFJY29uQnV0dG9uKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogIWRlbGV0ZWRBbHJlYWR5ID8gX2woXCJEZWxldGVcIikgOiBfbChcIkRhdGFzZXQgaXMgYWxyZWFkeSBkZWxldGVkXCIpLFxuICAgICAgICAgICAgICAgIGRpc2FibGVkOiBkZWxldGVkQWxyZWFkeSxcbiAgICAgICAgICAgICAgICBmYUljb246IFwiZmEtdGltZXNcIixcbiAgICAgICAgICAgICAgICBjbGFzc2VzOiBcImRlbGV0ZS1idG5cIixcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gLi4uYmxlci4uLiB0b29sdGlwcyBiZWluZyBsZWZ0IGJlaGluZCBpbiBET00gKGhvdmVyIG91dCBuZXZlciBjYWxsZWQgb24gZGVsZXRpb24pXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJGVsLmZpbmQoXCIuaWNvbi1idG4uZGVsZXRlLWJ0blwiKS50cmlnZ2VyKFwibW91c2VvdXRcIik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubW9kZWxbXCJkZWxldGVcIl0oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGRldGFpbHNcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGFkZCB0YWdzIGFuZCBhbm5vdGF0aW9ucyBjb250cm9scywgbWFrZSB0aGUgPyBkYmtleSBhIGxpbmsgdG8gZWRpdGluZyBwYWdlICovXG4gICAgICAgIF9yZW5kZXJEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vVE9ETzogZ2VuZXJhbGl6ZSB0byBiZSBhbGxvdyBkaWZmZXJlbnQgZGV0YWlscyBmb3IgZWFjaCBzdGF0ZVxuICAgICAgICAgICAgdmFyICRkZXRhaWxzID0gX3N1cGVyLnByb3RvdHlwZS5fcmVuZGVyRGV0YWlscy5jYWxsKHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLm1vZGVsLmdldChcInN0YXRlXCIpO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwuaXNEZWxldGVkT3JQdXJnZWQoKSAmJiBfLmNvbnRhaW5zKFtTVEFURVMuT0ssIFNUQVRFUy5GQUlMRURfTUVUQURBVEFdLCBzdGF0ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJUYWdzKCRkZXRhaWxzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJBbm5vdGF0aW9uKCRkZXRhaWxzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tYWtlRGJrZXlFZGl0TGluaygkZGV0YWlscyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NldFVwQmVoYXZpb3JzKCRkZXRhaWxzKTtcbiAgICAgICAgICAgIHJldHVybiAkZGV0YWlscztcbiAgICAgICAgfSxcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogUmVuZGVyIGhlbHAgYnV0dG9uIHRvIHNob3cgdG9vbCBoZWxwIHRleHQgd2l0aG91dCByZXJ1bm5pbmcgdGhlIHRvb2wuXG4gICAgICAgICAqIElzc3VlICMyMTAwXG4gICAgICAgICAqL1xuICAgICAgICBfcmVuZGVyVG9vbEhlbHBCdXR0b246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGRhdGFzZXRJRCA9IHRoaXMubW9kZWwuYXR0cmlidXRlcy5kYXRhc2V0X2lkO1xuICAgICAgICAgICAgdmFyIGpvYklEID0gdGhpcy5tb2RlbC5hdHRyaWJ1dGVzLmNyZWF0aW5nX2pvYjtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIHBhcnNlVG9vbEJ1aWxkID0gZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGhlbHBTdHJpbmcgPSBgPGRpdiBpZD1cInRoZGl2LSR7ZGF0YXNldElEfVwiIGNsYXNzPVwidG9vbGhlbHBcIj5gO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLm5hbWUgJiYgZGF0YS5oZWxwKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBTdHJpbmcgKz0gYDxzdHJvbmc+VG9vbCBoZWxwIGZvciAke2RhdGEubmFtZX08L3N0cm9uZz48aHIvPmA7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBTdHJpbmcgKz0gZGF0YS5oZWxwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBTdHJpbmcgKz0gXCI8c3Ryb25nPlRvb2wgaGVscCBpcyB1bmF2YWlsYWJsZSBmb3IgdGhpcyBkYXRhc2V0Ljwvc3Ryb25nPjxoci8+XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlbHBTdHJpbmcgKz0gXCI8L2Rpdj5cIjtcbiAgICAgICAgICAgICAgICBzZWxmLiRlbC5maW5kKFwiLmRldGFpbHNcIikuYXBwZW5kKCQucGFyc2VIVE1MKGhlbHBTdHJpbmcpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgcGFyc2VUb29sSUQgPSBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWFwaS90b29scy8ke2RhdGEudG9vbF9pZH0vYnVpbGRgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmRvbmUoZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZVRvb2xCdWlsZChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmZhaWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VUb29sQnVpbGQoe30pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoR2FsYXh5LnVzZXIuaWQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYUljb25CdXR0b24oe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlRvb2wgSGVscFwiKSxcbiAgICAgICAgICAgICAgICBjbGFzc2VzOiBcImljb24tYnRuXCIsXG4gICAgICAgICAgICAgICAgaHJlZjogXCIjXCIsXG4gICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLXF1ZXN0aW9uXCIsXG4gICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXZTdHJpbmcgPSBgdGhkaXYtJHtkYXRhc2V0SUR9YDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuJGVsLmZpbmQoXCIudG9vbGhlbHBcIikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi4kZWwuZmluZChcIi50b29saGVscFwiKS50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgJHtHYWxheHkucm9vdH1hcGkvam9icy8ke2pvYklEfWBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlVG9vbElEKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZhaWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBGYWlsZWQgYXQgcmVjb3ZlcmluZyBqb2IgaW5mb3JtYXRpb24gZnJvbSB0aGUgIEdhbGF4eSBBUEkgZm9yIGpvYiBpZCBcIiR7am9iSUR9XCIuYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIC8qKiBBZGQgbGVzcyBjb21tb25seSB1c2VkIGFjdGlvbnMgaW4gdGhlIGRldGFpbHMgc2VjdGlvbiBiYXNlZCBvbiBzdGF0ZSAqL1xuICAgICAgICBfcmVuZGVyU2Vjb25kYXJ5QWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYWN0aW9ucyA9IF9zdXBlci5wcm90b3R5cGUuX3JlbmRlclNlY29uZGFyeUFjdGlvbnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5tb2RlbC5nZXQoXCJzdGF0ZVwiKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgU1RBVEVTLlVQTE9BRDpcbiAgICAgICAgICAgICAgICBjYXNlIFNUQVRFUy5OT1RfVklFV0FCTEU6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgICAgICAgICAgICAgIGNhc2UgU1RBVEVTLkVSUk9SOlxuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvciBidXR0b24gY29tZXMgZmlyc3RcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy51bnNoaWZ0KHRoaXMuX3JlbmRlckVyckJ1dHRvbigpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnMuY29uY2F0KFt0aGlzLl9yZW5kZXJSZXJ1bkJ1dHRvbigpLCB0aGlzLl9yZW5kZXJUb29sSGVscEJ1dHRvbigpXSk7XG4gICAgICAgICAgICAgICAgY2FzZSBTVEFURVMuT0s6XG4gICAgICAgICAgICAgICAgY2FzZSBTVEFURVMuRkFJTEVEX01FVEFEQVRBOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9ucy5jb25jYXQoW1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyUmVydW5CdXR0b24oKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclZpc3VhbGl6YXRpb25zQnV0dG9uKCksXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJUb29sSGVscEJ1dHRvbigpXG4gICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnMuY29uY2F0KFt0aGlzLl9yZW5kZXJSZXJ1bkJ1dHRvbigpLCB0aGlzLl9yZW5kZXJUb29sSGVscEJ1dHRvbigpXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJlbmRlciBpY29uLWJ1dHRvbiB0byByZXBvcnQgYW4gZXJyb3Igb24gdGhpcyBkYXRhc2V0IHRvIHRoZSBnYWxheHkgYWRtaW4uICovXG4gICAgICAgIF9yZW5kZXJFcnJCdXR0b246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGZhSWNvbkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiVmlldyBvciByZXBvcnQgdGhpcyBlcnJvclwiKSxcbiAgICAgICAgICAgICAgICBocmVmOiBgJHtHYWxheHkucm9vdH1kYXRhc2V0cy9lcnJvcj9kYXRhc2V0X2lkPSR7dGhpcy5tb2RlbC5hdHRyaWJ1dGVzLmlkfWAsXG4gICAgICAgICAgICAgICAgY2xhc3NlczogXCJyZXBvcnQtZXJyb3ItYnRuXCIsXG4gICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLWJ1Z1wiLFxuICAgICAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChHYWxheHkucm91dGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgR2FsYXh5LnJvdXRlci5wdXNoKFwiZGF0YXNldHMvZXJyb3JcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFzZXRfaWQ6IHNlbGYubW9kZWwuYXR0cmlidXRlcy5pZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIGljb24tYnV0dG9uIHRvIHJlLXJ1biB0aGUgam9iIHRoYXQgY3JlYXRlZCB0aGlzIGRhdGFzZXQuICovXG4gICAgICAgIF9yZW5kZXJSZXJ1bkJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgY3JlYXRpbmdfam9iID0gdGhpcy5tb2RlbC5nZXQoXCJjcmVhdGluZ19qb2JcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbC5nZXQoXCJyZXJ1bm5hYmxlXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhSWNvbkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlJ1biB0aGlzIGpvYiBhZ2FpblwiKSxcbiAgICAgICAgICAgICAgICAgICAgaHJlZjogdGhpcy5tb2RlbC51cmxzLnJlcnVuLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBcInJlcnVuLWJ0blwiLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMubGlua1RhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgZmFJY29uOiBcImZhLXJlZnJlc2hcIixcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChHYWxheHkucm91dGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYWxheHkucm91dGVyLnB1c2goXCIvXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgam9iX2lkOiBjcmVhdGluZ19qb2JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBSZW5kZXIgYW4gaWNvbi1idXR0b24gb3IgcG9wdXBtZW51IG9mIGxpbmtzIGJhc2VkIG9uIHRoZSBhcHBsaWNhYmxlIHZpc3VhbGl6YXRpb25zICovXG4gICAgICAgIF9yZW5kZXJWaXN1YWxpemF0aW9uc0J1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL1RPRE86IHNvbWVkYXkgLSBsYXp5bG9hZCB2aXN1YWxpemF0aW9uc1xuICAgICAgICAgICAgdmFyIHZpc3VhbGl6YXRpb25zID0gdGhpcy5tb2RlbC5nZXQoXCJ2aXN1YWxpemF0aW9uc1wiKTtcbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGVsLmlzRGVsZXRlZE9yUHVyZ2VkKCkgfHwgIXRoaXMuaGFzVXNlciB8fCAhdGhpcy5tb2RlbC5oYXNEYXRhKCkgfHwgXy5pc0VtcHR5KHZpc3VhbGl6YXRpb25zKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFfLmlzT2JqZWN0KHZpc3VhbGl6YXRpb25zWzBdKSkge1xuICAgICAgICAgICAgICAgIHRoaXMud2FybihcIlZpc3VhbGl6YXRpb25zIGhhdmUgYmVlbiBzd2l0Y2hlZCBvZmZcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciAkdmlzdWFsaXphdGlvbnMgPSAkKHRoaXMudGVtcGxhdGVzLnZpc3VhbGl6YXRpb25zKHZpc3VhbGl6YXRpb25zLCB0aGlzKSk7XG4gICAgICAgICAgICAvL0hBQ0s6IG5lZWQgdG8gcmUtd3JpdGUgdGhvc2UgZGlyZWN0ZWQgYXQgZ2FsYXh5X21haW4gd2l0aCBsaW5rVGFyZ2V0XG4gICAgICAgICAgICAkdmlzdWFsaXphdGlvbnMuZmluZCgnW3RhcmdldD1cImdhbGF4eV9tYWluXCJdJykuYXR0cihcInRhcmdldFwiLCB0aGlzLmxpbmtUYXJnZXQpO1xuICAgICAgICAgICAgLy8gdXNlIGFkZEJhY2sgaGVyZSB0byBpbmNsdWRlIHRoZSByb290ICR2aXN1YWxpemF0aW9ucyBlbGVtIChmb3IgdGhlIGNhc2Ugb2YgMSB2aXN1YWxpemF0aW9uKVxuICAgICAgICAgICAgdGhpcy5fYWRkU2NyYXRjaEJvb2tGbigkdmlzdWFsaXphdGlvbnMuZmluZChcIi52aXN1YWxpemF0aW9uLWxpbmtcIikuYWRkQmFjayhcIi52aXN1YWxpemF0aW9uLWxpbmtcIikpO1xuICAgICAgICAgICAgcmV0dXJuICR2aXN1YWxpemF0aW9ucztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogYWRkIHNjcmF0Y2hib29rIGZ1bmN0aW9uYWxpdHkgdG8gdmlzdWFsaXphdGlvbiBsaW5rcyAqL1xuICAgICAgICBfYWRkU2NyYXRjaEJvb2tGbjogZnVuY3Rpb24oJGxpbmtzKSB7XG4gICAgICAgICAgICB2YXIgbGkgPSB0aGlzO1xuICAgICAgICAgICAgJGxpbmtzLmNsaWNrKGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgaWYgKEdhbGF4eS5mcmFtZSAmJiBHYWxheHkuZnJhbWUuYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIEdhbGF4eS5mcmFtZS5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiVmlzdWFsaXphdGlvblwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJCh0aGlzKS5hdHRyKFwiaHJlZlwiKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy9UT0RPOiBpZiBwb3NzaWJsZSBtb3ZlIHRoZXNlIHRvIHJlYWRvbmx5IHZpZXcgLSBidXQgZGlzcGxheSB0aGUgb3duZXIncyB0YWdzL2Fubm90YXRpb24gKG5vIGVkaXQpXG4gICAgICAgIC8qKiBSZW5kZXIgdGhlIHRhZ3MgbGlzdC9jb250cm9sICovXG4gICAgICAgIF9yZW5kZXJUYWdzOiBmdW5jdGlvbigkd2hlcmUpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5oYXNVc2VyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy50YWdzRWRpdG9yID0gbmV3IFRBR1MuVGFnc0VkaXRvcih7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHRoaXMubW9kZWwsXG4gICAgICAgICAgICAgICAgZWw6ICR3aGVyZS5maW5kKFwiLnRhZ3MtZGlzcGxheVwiKSxcbiAgICAgICAgICAgICAgICBvbnNob3dGaXJzdFRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gcGVyc2lzdCBzdGF0ZSBvbiB0aGUgaGRhIHZpZXcgKGFuZCBub3QgdGhlIGVkaXRvcikgc2luY2UgdGhlc2UgYXJlIGN1cnJlbnRseSByZS1jcmVhdGVkIGVhY2ggdGltZVxuICAgICAgICAgICAgICAgIG9uc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcudGFnc0VkaXRvclNob3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcudGFnc0VkaXRvclNob3duID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAkYWN0aXZhdG9yOiBmYUljb25CdXR0b24oe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJFZGl0IGRhdGFzZXQgdGFnc1wiKSxcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogXCJ0YWctYnRuXCIsXG4gICAgICAgICAgICAgICAgICAgIGZhSWNvbjogXCJmYS10YWdzXCJcbiAgICAgICAgICAgICAgICB9KS5hcHBlbmRUbygkd2hlcmUuZmluZChcIi5hY3Rpb25zIC5yaWdodFwiKSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFnc0VkaXRvclNob3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50YWdzRWRpdG9yLnRvZ2dsZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogUmVuZGVyIHRoZSBhbm5vdGF0aW9uIGRpc3BsYXkvY29udHJvbCAqL1xuICAgICAgICBfcmVuZGVyQW5ub3RhdGlvbjogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaGFzVXNlcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuYW5ub3RhdGlvbkVkaXRvciA9IG5ldyBBTk5PVEFUSU9OUy5Bbm5vdGF0aW9uRWRpdG9yKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcbiAgICAgICAgICAgICAgICBlbDogJHdoZXJlLmZpbmQoXCIuYW5ub3RhdGlvbi1kaXNwbGF5XCIpLFxuICAgICAgICAgICAgICAgIG9uc2hvd0ZpcnN0VGltZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBwZXJzaXN0IHN0YXRlIG9uIHRoZSBoZGEgdmlldyAoYW5kIG5vdCB0aGUgZWRpdG9yKSBzaW5jZSB0aGVzZSBhcmUgY3VycmVudGx5IHJlLWNyZWF0ZWQgZWFjaCB0aW1lXG4gICAgICAgICAgICAgICAgb25zaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hbm5vdGF0aW9uRWRpdG9yU2hvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb25oaWRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hbm5vdGF0aW9uRWRpdG9yU2hvd24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICRhY3RpdmF0b3I6IGZhSWNvbkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkVkaXQgZGF0YXNldCBhbm5vdGF0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBcImFubm90YXRlLWJ0blwiLFxuICAgICAgICAgICAgICAgICAgICBmYUljb246IFwiZmEtY29tbWVudFwiXG4gICAgICAgICAgICAgICAgfSkuYXBwZW5kVG8oJHdoZXJlLmZpbmQoXCIuYWN0aW9ucyAucmlnaHRcIikpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFubm90YXRpb25FZGl0b3JTaG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5ub3RhdGlvbkVkaXRvci50b2dnbGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIElmIHRoZSBmb3JtYXQvZGJrZXkvZ2Vub21lX2J1aWxkIGlzbid0IHNldCwgbWFrZSB0aGUgZGlzcGxheSBhIGxpbmsgdG8gdGhlIGVkaXQgcGFnZSAqL1xuICAgICAgICBfbWFrZURia2V5RWRpdExpbms6IGZ1bmN0aW9uKCRkZXRhaWxzKSB7XG4gICAgICAgICAgICAvLyBtYWtlIHRoZSBkYmtleSBhIGxpbmsgdG8gZWRpdGluZ1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwibWV0YWRhdGFfZGJrZXlcIikgPT09IFwiP1wiICYmICF0aGlzLm1vZGVsLmlzRGVsZXRlZE9yUHVyZ2VkKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWRpdGFibGVEYmtleSA9ICQoJzxhIGNsYXNzPVwidmFsdWVcIj4/PC9hPicpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaHJlZlwiLCB0aGlzLm1vZGVsLnVybHMuZWRpdClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0YXJnZXRcIiwgXCJfdG9wXCIpO1xuICAgICAgICAgICAgICAgICRkZXRhaWxzLmZpbmQoXCIuZGJrZXkgLnZhbHVlXCIpLnJlcGxhY2VXaXRoKGVkaXRhYmxlRGJrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gZXZlbnRzXG4gICAgICAgIC8qKiBldmVudCBtYXAgKi9cbiAgICAgICAgZXZlbnRzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUuZXZlbnRzKSwge1xuICAgICAgICAgICAgXCJjbGljayAudW5kZWxldGUtbGlua1wiOiBcIl9jbGlja1VuZGVsZXRlTGlua1wiLFxuICAgICAgICAgICAgXCJjbGljayAucHVyZ2UtbGlua1wiOiBcIl9jbGlja1B1cmdlTGlua1wiLFxuXG4gICAgICAgICAgICBcImNsaWNrIC5lZGl0LWJ0blwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImVkaXRcIiwgdGhpcywgZXYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLmRlbGV0ZS1idG5cIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJkZWxldGVcIiwgdGhpcywgZXYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLnJlcnVuLWJ0blwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInJlcnVuXCIsIHRoaXMsIGV2KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImNsaWNrIC5yZXBvcnQtZXJyLWJ0blwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInJlcG9ydC1lcnJcIiwgdGhpcywgZXYpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLnZpc3VhbGl6YXRpb24tYnRuXCI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwidmlzdWFsaXplXCIsIHRoaXMsIGV2KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImNsaWNrIC5kYmtleSBhXCI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwiZWRpdFwiLCB0aGlzLCBldik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8qKiBsaXN0ZW5lciBmb3IgaXRlbSB1bmRlbGV0ZSAoaW4gdGhlIG1lc3NhZ2VzIHNlY3Rpb24pICovXG4gICAgICAgIF9jbGlja1VuZGVsZXRlTGluazogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwudW5kZWxldGUoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogbGlzdGVuZXIgZm9yIGl0ZW0gcHVyZ2UgKGluIHRoZSBtZXNzYWdlcyBzZWN0aW9uKSAqL1xuICAgICAgICBfY2xpY2tQdXJnZUxpbms6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICBpZiAoY29uZmlybShfbChcIlRoaXMgd2lsbCBwZXJtYW5lbnRseSByZW1vdmUgdGhlIGRhdGEgaW4geW91ciBkYXRhc2V0LiBBcmUgeW91IHN1cmU/XCIpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwucHVyZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIG1pc2NcbiAgICAgICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBIREFFZGl0Vmlldygke21vZGVsU3RyaW5nfSlgO1xuICAgICAgICB9XG4gICAgfVxuKTtcblxuLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBURU1QTEFURVNcbi8qKiB1bmRlcnNjb3JlIHRlbXBsYXRlcyAqL1xuRGF0YXNldExpc3RJdGVtRWRpdC5wcm90b3R5cGUudGVtcGxhdGVzID0gKCgpID0+IHtcbiAgICB2YXIgd2FybmluZ3MgPSBfLmV4dGVuZCh7fSwgX3N1cGVyLnByb3RvdHlwZS50ZW1wbGF0ZXMud2FybmluZ3MsIHtcbiAgICAgICAgZmFpbGVkX21ldGFkYXRhOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgLy8gaW4gdGhpcyBvdmVycmlkZSwgcHJvdmlkZSBhIGxpbmsgdG8gdGhlIGVkaXQgcGFnZVxuICAgICAgICAgICAgICAgICc8JSBpZiggZGF0YXNldC5zdGF0ZSA9PT0gXCJmYWlsZWRfbWV0YWRhdGFcIiApeyAlPicsXG4gICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmYWlsZWRfbWV0YWRhdGEtd2FybmluZyB3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIkFuIGVycm9yIG9jY3VycmVkIHNldHRpbmcgdGhlIG1ldGFkYXRhIGZvciB0aGlzIGRhdGFzZXRcIiksXG4gICAgICAgICAgICAgICAgJzxiciAvPjxhIGhyZWY9XCI8JS0gZGF0YXNldC51cmxzLmVkaXQgJT5cIiB0YXJnZXQ9XCJfdG9wXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlNldCBpdCBtYW51YWxseSBvciByZXRyeSBhdXRvLWRldGVjdGlvblwiKSxcbiAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJkYXRhc2V0XCJcbiAgICAgICAgKSxcblxuICAgICAgICBkZWxldGVkOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgLy8gaW4gdGhpcyBvdmVycmlkZSwgcHJvdmlkZSBsaW5rcyB0byB1bmRlbGV0ZSBvciBwdXJnZSB0aGUgZGF0YXNldFxuICAgICAgICAgICAgICAgIFwiPCUgaWYoIGRhdGFzZXQuZGVsZXRlZCAmJiAhZGF0YXNldC5wdXJnZWQgKXsgJT5cIixcbiAgICAgICAgICAgICAgICAvLyBkZWxldGVkIG5vdCBwdXJnZWRcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImRlbGV0ZWQtbXNnIHdhcm5pbmdtZXNzYWdlc21hbGxcIj4nLFxuICAgICAgICAgICAgICAgIF9sKFwiVGhpcyBkYXRhc2V0IGhhcyBiZWVuIGRlbGV0ZWRcIiksXG4gICAgICAgICAgICAgICAgJzxiciAvPjxhIGNsYXNzPVwidW5kZWxldGUtbGlua1wiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlVuZGVsZXRlIGl0XCIpLFxuICAgICAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgICAgIFwiPCUgaWYoIHZpZXcucHVyZ2VBbGxvd2VkICl7ICU+XCIsXG4gICAgICAgICAgICAgICAgJzxiciAvPjxhIGNsYXNzPVwicHVyZ2UtbGlua1wiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlBlcm1hbmVudGx5IHJlbW92ZSBpdCBmcm9tIGRpc2tcIiksXG4gICAgICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIFwiZGF0YXNldFwiXG4gICAgICAgIClcbiAgICB9KTtcblxuICAgIHZhciB2aXN1YWxpemF0aW9uc1RlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICBcIjwlIGlmKCB2aXN1YWxpemF0aW9ucy5sZW5ndGggPT09IDEgKXsgJT5cIixcbiAgICAgICAgICAgICc8YSBjbGFzcz1cInZpc3VhbGl6YXRpb24tbGluayBpY29uLWJ0blwiIGhyZWY9XCI8JS0gdmlzdWFsaXphdGlvbnNbMF0uaHJlZiAlPlwiJyxcbiAgICAgICAgICAgICcgdGFyZ2V0PVwiPCUtIHZpc3VhbGl6YXRpb25zWzBdLnRhcmdldCAlPlwiIHRpdGxlPVwiJyxcbiAgICAgICAgICAgIF9sKFwiVmlzdWFsaXplIGluXCIpLFxuICAgICAgICAgICAgJyA8JS0gdmlzdWFsaXphdGlvbnNbMF0uaHRtbCAlPlwiPicsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJmYSBmYS1iYXItY2hhcnQtb1wiPjwvc3Bhbj4nLFxuICAgICAgICAgICAgXCI8L2E+XCIsXG5cbiAgICAgICAgICAgIFwiPCUgfSBlbHNlIHsgJT5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidmlzdWFsaXphdGlvbnMtZHJvcGRvd24gZHJvcGRvd24gaWNvbi1idG5cIj4nLFxuICAgICAgICAgICAgJzxhIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIiB0aXRsZT1cIicsXG4gICAgICAgICAgICBfbChcIlZpc3VhbGl6ZVwiKSxcbiAgICAgICAgICAgICdcIj4nLFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiZmEgZmEtYmFyLWNoYXJ0LW9cIj48L3NwYW4+JyxcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiByb2xlPVwibWVudVwiPicsXG4gICAgICAgICAgICBcIjwlIF8uZWFjaCggdmlzdWFsaXphdGlvbnMsIGZ1bmN0aW9uKCB2aXN1YWxpemF0aW9uICl7ICU+XCIsXG4gICAgICAgICAgICAnPGxpPjxhIGNsYXNzPVwidmlzdWFsaXphdGlvbi1saW5rXCIgaHJlZj1cIjwlLSB2aXN1YWxpemF0aW9uLmhyZWYgJT5cIicsXG4gICAgICAgICAgICAnIHRhcmdldD1cIjwlLSB2aXN1YWxpemF0aW9uLnRhcmdldCAlPlwiPicsXG4gICAgICAgICAgICBcIjwlLSB2aXN1YWxpemF0aW9uLmh0bWwgJT5cIixcbiAgICAgICAgICAgIFwiPC9hPjwvbGk+XCIsXG4gICAgICAgICAgICBcIjwlIH0pOyAlPlwiLFxuICAgICAgICAgICAgXCI8L3VsPlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwidmlzdWFsaXphdGlvbnNcIlxuICAgICk7XG5cbiAgICByZXR1cm4gXy5leHRlbmQoe30sIF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzLCB7XG4gICAgICAgIHdhcm5pbmdzOiB3YXJuaW5ncyxcbiAgICAgICAgdmlzdWFsaXphdGlvbnM6IHZpc3VhbGl6YXRpb25zVGVtcGxhdGVcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgRGF0YXNldExpc3RJdGVtRWRpdDogRGF0YXNldExpc3RJdGVtRWRpdFxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvZGF0YXNldC9kYXRhc2V0LWxpLWVkaXQuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQVpBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUF0QkE7QUF3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBZ0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBWkE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFiQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBYkE7QUFtQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXJCQTtBQUNBO0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0WUE7QUFDQTtBQXlZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBV0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQXJCQTtBQUNBO0FBcUNBO0FBQ0E7QUE4QkE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///61\n");

/***/ }),
/* 62 */
/*!******************************************!*\
  !*** ./galaxy/scripts/mvc/annotation.js ***!
  \******************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/editable-text */ 15);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// =============================================================================\n/** A view on any model that has a 'annotation' attribute\n */\nvar AnnotationEditor = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend(_baseMvc2.default.HiddenUntilActivatedViewMixin).extend({\n    tagName: \"div\",\n    className: \"annotation-display\",\n\n    /** Set up listeners, parse options */\n    initialize: function initialize(options) {\n        options = options || {};\n        this.tooltipConfig = options.tooltipConfig || {\n            placement: \"bottom\"\n        };\n        //console.debug( this, options );\n        // only listen to the model only for changes to annotations\n        this.listenTo(this.model, \"change:annotation\", function () {\n            this.render();\n        });\n        this.hiddenUntilActivated(options.$activator, options);\n    },\n\n    /** Build the DOM elements, call select to on the created input, and set up behaviors */\n    render: function render() {\n        var view = this;\n        this.$el.html(this._template());\n\n        //TODO: handle empties better\n        this.$annotation().make_text_editable({\n            use_textarea: true,\n            on_finish: function on_finish(newAnnotation) {\n                view.$annotation().text(newAnnotation);\n                view.model.save({ annotation: newAnnotation }, { silent: true }).fail(function () {\n                    view.$annotation().text(view.model.previous(\"annotation\"));\n                });\n            }\n        });\n        return this;\n    },\n\n    /** @returns {String} the html text used to build the view's DOM */\n    _template: function _template() {\n        var annotation = this.model.get(\"annotation\");\n        return [\n        //TODO: make prompt optional\n        '<label class=\"prompt\">', (0, _localization2.default)(\"Annotation\"), \"</label>\",\n        // set up initial tags by adding as CSV to input vals (necc. to init select2)\n        '<div class=\"annotation\">', _.escape(annotation), \"</div>\"].join(\"\");\n    },\n\n    /** @returns {jQuery} the main element for this view */\n    $annotation: function $annotation() {\n        return this.$el.find(\".annotation\");\n    },\n\n    /** shut down event listeners and remove this view's DOM */\n    remove: function remove() {\n        this.$annotation.off();\n        this.stopListening(this.model);\n        Backbone.View.prototype.remove.call(this);\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return [\"AnnotationEditor(\", \"\" + this.model, \")\"].join(\"\");\n    }\n});\n// =============================================================================\nexports.default = {\n    AnnotationEditor: AnnotationEditor\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2Fubm90YXRpb24uanM/Y2Q0MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYmFzZU1WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuaW1wb3J0IFwidWkvZWRpdGFibGUtdGV4dFwiO1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBBIHZpZXcgb24gYW55IG1vZGVsIHRoYXQgaGFzIGEgJ2Fubm90YXRpb24nIGF0dHJpYnV0ZVxuICovXG52YXIgQW5ub3RhdGlvbkVkaXRvciA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKGJhc2VNVkMuTG9nZ2FibGVNaXhpbilcbiAgICAuZXh0ZW5kKGJhc2VNVkMuSGlkZGVuVW50aWxBY3RpdmF0ZWRWaWV3TWl4aW4pXG4gICAgLmV4dGVuZCh7XG4gICAgICAgIHRhZ05hbWU6IFwiZGl2XCIsXG4gICAgICAgIGNsYXNzTmFtZTogXCJhbm5vdGF0aW9uLWRpc3BsYXlcIixcblxuICAgICAgICAvKiogU2V0IHVwIGxpc3RlbmVycywgcGFyc2Ugb3B0aW9ucyAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIHRoaXMudG9vbHRpcENvbmZpZyA9IG9wdGlvbnMudG9vbHRpcENvbmZpZyB8fCB7XG4gICAgICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCB0aGlzLCBvcHRpb25zICk7XG4gICAgICAgICAgICAvLyBvbmx5IGxpc3RlbiB0byB0aGUgbW9kZWwgb25seSBmb3IgY2hhbmdlcyB0byBhbm5vdGF0aW9uc1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTphbm5vdGF0aW9uXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuVW50aWxBY3RpdmF0ZWQob3B0aW9ucy4kYWN0aXZhdG9yLCBvcHRpb25zKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQnVpbGQgdGhlIERPTSBlbGVtZW50cywgY2FsbCBzZWxlY3QgdG8gb24gdGhlIGNyZWF0ZWQgaW5wdXQsIGFuZCBzZXQgdXAgYmVoYXZpb3JzICovXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMuX3RlbXBsYXRlKCkpO1xuXG4gICAgICAgICAgICAvL1RPRE86IGhhbmRsZSBlbXB0aWVzIGJldHRlclxuICAgICAgICAgICAgdGhpcy4kYW5ub3RhdGlvbigpLm1ha2VfdGV4dF9lZGl0YWJsZSh7XG4gICAgICAgICAgICAgICAgdXNlX3RleHRhcmVhOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uX2ZpbmlzaDogZnVuY3Rpb24obmV3QW5ub3RhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LiRhbm5vdGF0aW9uKCkudGV4dChuZXdBbm5vdGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5tb2RlbC5zYXZlKHsgYW5ub3RhdGlvbjogbmV3QW5ub3RhdGlvbiB9LCB7IHNpbGVudDogdHJ1ZSB9KS5mYWlsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuJGFubm90YXRpb24oKS50ZXh0KHZpZXcubW9kZWwucHJldmlvdXMoXCJhbm5vdGF0aW9uXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQHJldHVybnMge1N0cmluZ30gdGhlIGh0bWwgdGV4dCB1c2VkIHRvIGJ1aWxkIHRoZSB2aWV3J3MgRE9NICovXG4gICAgICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgYW5ub3RhdGlvbiA9IHRoaXMubW9kZWwuZ2V0KFwiYW5ub3RhdGlvblwiKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgLy9UT0RPOiBtYWtlIHByb21wdCBvcHRpb25hbFxuICAgICAgICAgICAgICAgICc8bGFiZWwgY2xhc3M9XCJwcm9tcHRcIj4nLFxuICAgICAgICAgICAgICAgIF9sKFwiQW5ub3RhdGlvblwiKSxcbiAgICAgICAgICAgICAgICBcIjwvbGFiZWw+XCIsXG4gICAgICAgICAgICAgICAgLy8gc2V0IHVwIGluaXRpYWwgdGFncyBieSBhZGRpbmcgYXMgQ1NWIHRvIGlucHV0IHZhbHMgKG5lY2MuIHRvIGluaXQgc2VsZWN0MilcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFubm90YXRpb25cIj4nLFxuICAgICAgICAgICAgICAgIF8uZXNjYXBlKGFubm90YXRpb24pLFxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgICAgIF0uam9pbihcIlwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogQHJldHVybnMge2pRdWVyeX0gdGhlIG1haW4gZWxlbWVudCBmb3IgdGhpcyB2aWV3ICovXG4gICAgICAgICRhbm5vdGF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRlbC5maW5kKFwiLmFubm90YXRpb25cIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNodXQgZG93biBldmVudCBsaXN0ZW5lcnMgYW5kIHJlbW92ZSB0aGlzIHZpZXcncyBET00gKi9cbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuJGFubm90YXRpb24ub2ZmKCk7XG4gICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCk7XG4gICAgICAgICAgICBCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gW1wiQW5ub3RhdGlvbkVkaXRvcihcIiwgYCR7dGhpcy5tb2RlbH1gLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBBbm5vdGF0aW9uRWRpdG9yOiBBbm5vdGF0aW9uRWRpdG9yXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9hbm5vdGF0aW9uLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOztBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsRUE7QUFvRUE7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///62\n");

/***/ }),
/* 63 */,
/* 64 */,
/* 65 */,
/* 66 */,
/* 67 */,
/* 68 */,
/* 69 */,
/* 70 */,
/* 71 */
/*!********************************************************!*\
  !*** ./galaxy/scripts/mvc/history/job-states-model.js ***!
  \********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _backbone = __webpack_require__(/*! libs/backbone */ 2);\n\nvar Backbone = _interopRequireWildcard(_backbone);\n\nvar _ajaxQueue = __webpack_require__(/*! utils/ajax-queue */ 21);\n\nvar _ajaxQueue2 = _interopRequireDefault(_ajaxQueue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/** ms between fetches when checking running jobs/datasets for updates */\nvar UPDATE_DELAY = 2000;\nvar NON_TERMINAL_STATES = [\"new\", \"queued\", \"running\"];\nvar ERROR_STATES = [\"error\", \"deleted\"];\n/** Fetch state on add or just wait for polling to start. */\nvar FETCH_STATE_ON_ADD = false;\nvar BATCH_FETCH_STATE = true;\n\nvar JobStatesSummary = Backbone.Model.extend({\n    url: function url() {\n        return Galaxy.root + \"api/histories/\" + this.attributes.history_id + \"/contents/dataset_collections/\" + this.attributes.collection_id + \"/jobs_summary\";\n    },\n\n    hasDetails: function hasDetails() {\n        return this.has(\"populated_state\");\n    },\n\n    new: function _new() {\n        return !this.hasDetails() || this.get(\"populated_state\") == \"new\";\n    },\n\n    errored: function errored() {\n        return this.get(\"populated_state\") === \"error\" || this.anyWithStates(ERROR_STATES);\n    },\n\n    states: function states() {\n        return this.get(\"states\") || {};\n    },\n\n    anyWithState: function anyWithState(queryState) {\n        return (this.states()[queryState] || 0) > 0;\n    },\n\n    anyWithStates: function anyWithStates(queryStates) {\n        var states = this.states();\n        for (var index in queryStates) {\n            if ((states[queryStates[index]] || 0) > 0) {\n                return true;\n            }\n        }\n        return false;\n    },\n\n    numWithStates: function numWithStates(queryStates) {\n        var states = this.states();\n        var count = 0;\n        for (var index in queryStates) {\n            count += states[queryStates[index]] || 0;\n        }\n        return count;\n    },\n\n    numInError: function numInError() {\n        return this.numWithStates(ERROR_STATES);\n    },\n\n    running: function running() {\n        return this.anyWithState(\"running\");\n    },\n\n    terminal: function terminal() {\n        if (this.new()) {\n            return false;\n        } else {\n            var anyNonTerminal = this.anyWithStates(NON_TERMINAL_STATES);\n            return !anyNonTerminal;\n        }\n    },\n\n    jobCount: function jobCount() {\n        var states = this.states();\n        var count = 0;\n        for (var index in states) {\n            count += states[index];\n        }\n        return count;\n    },\n\n    toString: function toString() {\n        return \"JobStatesSummary(id=\" + this.get(\"id\") + \")\";\n    }\n});\n\nvar JobStatesSummaryCollection = Backbone.Collection.extend({\n    model: JobStatesSummary,\n\n    initialize: function initialize() {\n        if (FETCH_STATE_ON_ADD) {\n            this.on({\n                add: function add(model) {\n                    return model.fetch();\n                }\n            });\n        }\n\n        /** cached timeout id for the dataset updater */\n        this.updateTimeoutId = null;\n        // this.checkForUpdates();\n        this.active = true;\n    },\n\n    url: function url() {\n        var nonTerminalModels = this.models.filter(function (model) {\n            return !model.terminal();\n        });\n        var ids = nonTerminalModels.map(function (summary) {\n            return summary.get(\"id\");\n        }).join(\",\");\n        var types = nonTerminalModels.map(function (summary) {\n            return summary.get(\"model\");\n        }).join(\",\");\n        return Galaxy.root + \"api/histories/\" + this.historyId + \"/jobs_summary?ids=\" + ids + \"&types=\" + types;\n    },\n\n    monitor: function monitor() {\n        var _this = this;\n\n        this.clearUpdateTimeout();\n        if (!this.active) {\n            return;\n        }\n\n        var _delayThenMonitorAgain = function _delayThenMonitorAgain() {\n            _this.updateTimeoutId = setTimeout(function () {\n                _this.monitor();\n            }, UPDATE_DELAY);\n        };\n\n        var nonTerminalModels = this.models.filter(function (model) {\n            return !model.terminal();\n        });\n\n        if (nonTerminalModels.length > 0 && !BATCH_FETCH_STATE) {\n            // Allow models to fetch their own details.\n            var updateFunctions = nonTerminalModels.map(function (summary) {\n                return function () {\n                    return summary.fetch();\n                };\n            });\n\n            return new _ajaxQueue2.default.AjaxQueue(updateFunctions).done(_delayThenMonitorAgain);\n        } else if (nonTerminalModels.length > 0) {\n            // Batch fetch updated state...\n            this.fetch({ remove: false }).done(_delayThenMonitorAgain);\n        } else {\n            _delayThenMonitorAgain();\n        }\n    },\n\n    /** clear the timeout and the cached timeout id */\n    clearUpdateTimeout: function clearUpdateTimeout() {\n        if (this.updateTimeoutId) {\n            clearTimeout(this.updateTimeoutId);\n            this.updateTimeoutId = null;\n        }\n    },\n\n    toString: function toString() {\n        return \"JobStatesSummaryCollection()\";\n    }\n});\n\nexports.default = { JobStatesSummary: JobStatesSummary, JobStatesSummaryCollection: JobStatesSummaryCollection, FETCH_STATE_ON_ADD: FETCH_STATE_ON_ADD };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3Rvcnkvam9iLXN0YXRlcy1tb2RlbC5qcz82MzM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJhY2tib25lIGZyb20gXCJsaWJzL2JhY2tib25lXCI7XG5pbXBvcnQgQUpBWF9RVUVVRSBmcm9tIFwidXRpbHMvYWpheC1xdWV1ZVwiO1xuXG4vKiogbXMgYmV0d2VlbiBmZXRjaGVzIHdoZW4gY2hlY2tpbmcgcnVubmluZyBqb2JzL2RhdGFzZXRzIGZvciB1cGRhdGVzICovXG52YXIgVVBEQVRFX0RFTEFZID0gMjAwMDtcbnZhciBOT05fVEVSTUlOQUxfU1RBVEVTID0gW1wibmV3XCIsIFwicXVldWVkXCIsIFwicnVubmluZ1wiXTtcbnZhciBFUlJPUl9TVEFURVMgPSBbXCJlcnJvclwiLCBcImRlbGV0ZWRcIl07XG4vKiogRmV0Y2ggc3RhdGUgb24gYWRkIG9yIGp1c3Qgd2FpdCBmb3IgcG9sbGluZyB0byBzdGFydC4gKi9cbnZhciBGRVRDSF9TVEFURV9PTl9BREQgPSBmYWxzZTtcbnZhciBCQVRDSF9GRVRDSF9TVEFURSA9IHRydWU7XG5cbnZhciBKb2JTdGF0ZXNTdW1tYXJ5ID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kKHtcbiAgICB1cmw6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllcy8ke3RoaXMuYXR0cmlidXRlcy5oaXN0b3J5X2lkfS9jb250ZW50cy9kYXRhc2V0X2NvbGxlY3Rpb25zLyR7XG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuY29sbGVjdGlvbl9pZFxuICAgICAgICB9L2pvYnNfc3VtbWFyeWA7XG4gICAgfSxcblxuICAgIGhhc0RldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXMoXCJwb3B1bGF0ZWRfc3RhdGVcIik7XG4gICAgfSxcblxuICAgIG5ldzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5oYXNEZXRhaWxzKCkgfHwgdGhpcy5nZXQoXCJwb3B1bGF0ZWRfc3RhdGVcIikgPT0gXCJuZXdcIjtcbiAgICB9LFxuXG4gICAgZXJyb3JlZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldChcInBvcHVsYXRlZF9zdGF0ZVwiKSA9PT0gXCJlcnJvclwiIHx8IHRoaXMuYW55V2l0aFN0YXRlcyhFUlJPUl9TVEFURVMpO1xuICAgIH0sXG5cbiAgICBzdGF0ZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQoXCJzdGF0ZXNcIikgfHwge307XG4gICAgfSxcblxuICAgIGFueVdpdGhTdGF0ZTogZnVuY3Rpb24ocXVlcnlTdGF0ZSkge1xuICAgICAgICByZXR1cm4gKHRoaXMuc3RhdGVzKClbcXVlcnlTdGF0ZV0gfHwgMCkgPiAwO1xuICAgIH0sXG5cbiAgICBhbnlXaXRoU3RhdGVzOiBmdW5jdGlvbihxdWVyeVN0YXRlcykge1xuICAgICAgICB2YXIgc3RhdGVzID0gdGhpcy5zdGF0ZXMoKTtcbiAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gcXVlcnlTdGF0ZXMpIHtcbiAgICAgICAgICAgIGlmICgoc3RhdGVzW3F1ZXJ5U3RhdGVzW2luZGV4XV0gfHwgMCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG5cbiAgICBudW1XaXRoU3RhdGVzOiBmdW5jdGlvbihxdWVyeVN0YXRlcykge1xuICAgICAgICB2YXIgc3RhdGVzID0gdGhpcy5zdGF0ZXMoKTtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gcXVlcnlTdGF0ZXMpIHtcbiAgICAgICAgICAgIGNvdW50ICs9IHN0YXRlc1txdWVyeVN0YXRlc1tpbmRleF1dIHx8IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH0sXG5cbiAgICBudW1JbkVycm9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubnVtV2l0aFN0YXRlcyhFUlJPUl9TVEFURVMpO1xuICAgIH0sXG5cbiAgICBydW5uaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW55V2l0aFN0YXRlKFwicnVubmluZ1wiKTtcbiAgICB9LFxuXG4gICAgdGVybWluYWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5uZXcoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGFueU5vblRlcm1pbmFsID0gdGhpcy5hbnlXaXRoU3RhdGVzKE5PTl9URVJNSU5BTF9TVEFURVMpO1xuICAgICAgICAgICAgcmV0dXJuICFhbnlOb25UZXJtaW5hbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBqb2JDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGF0ZXMgPSB0aGlzLnN0YXRlcygpO1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpbmRleCBpbiBzdGF0ZXMpIHtcbiAgICAgICAgICAgIGNvdW50ICs9IHN0YXRlc1tpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH0sXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBgSm9iU3RhdGVzU3VtbWFyeShpZD0ke3RoaXMuZ2V0KFwiaWRcIil9KWA7XG4gICAgfVxufSk7XG5cbnZhciBKb2JTdGF0ZXNTdW1tYXJ5Q29sbGVjdGlvbiA9IEJhY2tib25lLkNvbGxlY3Rpb24uZXh0ZW5kKHtcbiAgICBtb2RlbDogSm9iU3RhdGVzU3VtbWFyeSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoRkVUQ0hfU1RBVEVfT05fQUREKSB7XG4gICAgICAgICAgICB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICBhZGQ6IG1vZGVsID0+IG1vZGVsLmZldGNoKClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqIGNhY2hlZCB0aW1lb3V0IGlkIGZvciB0aGUgZGF0YXNldCB1cGRhdGVyICovXG4gICAgICAgIHRoaXMudXBkYXRlVGltZW91dElkID0gbnVsbDtcbiAgICAgICAgLy8gdGhpcy5jaGVja0ZvclVwZGF0ZXMoKTtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgIH0sXG5cbiAgICB1cmw6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbm9uVGVybWluYWxNb2RlbHMgPSB0aGlzLm1vZGVscy5maWx0ZXIobW9kZWwgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICFtb2RlbC50ZXJtaW5hbCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGlkcyA9IG5vblRlcm1pbmFsTW9kZWxzXG4gICAgICAgICAgICAubWFwKHN1bW1hcnkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdW1tYXJ5LmdldChcImlkXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKFwiLFwiKTtcbiAgICAgICAgdmFyIHR5cGVzID0gbm9uVGVybWluYWxNb2RlbHNcbiAgICAgICAgICAgIC5tYXAoc3VtbWFyeSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1bW1hcnkuZ2V0KFwibW9kZWxcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xuICAgICAgICByZXR1cm4gYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllcy8ke3RoaXMuaGlzdG9yeUlkfS9qb2JzX3N1bW1hcnk/aWRzPSR7aWRzfSZ0eXBlcz0ke3R5cGVzfWA7XG4gICAgfSxcblxuICAgIG1vbml0b3I6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmNsZWFyVXBkYXRlVGltZW91dCgpO1xuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX2RlbGF5VGhlbk1vbml0b3JBZ2FpbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb25pdG9yKCk7XG4gICAgICAgICAgICB9LCBVUERBVEVfREVMQVkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBub25UZXJtaW5hbE1vZGVscyA9IHRoaXMubW9kZWxzLmZpbHRlcihtb2RlbCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIW1vZGVsLnRlcm1pbmFsKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChub25UZXJtaW5hbE1vZGVscy5sZW5ndGggPiAwICYmICFCQVRDSF9GRVRDSF9TVEFURSkge1xuICAgICAgICAgICAgLy8gQWxsb3cgbW9kZWxzIHRvIGZldGNoIHRoZWlyIG93biBkZXRhaWxzLlxuICAgICAgICAgICAgdmFyIHVwZGF0ZUZ1bmN0aW9ucyA9IG5vblRlcm1pbmFsTW9kZWxzLm1hcChzdW1tYXJ5ID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VtbWFyeS5mZXRjaCgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBBSkFYX1FVRVVFLkFqYXhRdWV1ZSh1cGRhdGVGdW5jdGlvbnMpLmRvbmUoX2RlbGF5VGhlbk1vbml0b3JBZ2Fpbik7XG4gICAgICAgIH0gZWxzZSBpZiAobm9uVGVybWluYWxNb2RlbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gQmF0Y2ggZmV0Y2ggdXBkYXRlZCBzdGF0ZS4uLlxuICAgICAgICAgICAgdGhpcy5mZXRjaCh7IHJlbW92ZTogZmFsc2UgfSkuZG9uZShfZGVsYXlUaGVuTW9uaXRvckFnYWluKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9kZWxheVRoZW5Nb25pdG9yQWdhaW4oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogY2xlYXIgdGhlIHRpbWVvdXQgYW5kIHRoZSBjYWNoZWQgdGltZW91dCBpZCAqL1xuICAgIGNsZWFyVXBkYXRlVGltZW91dDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZVRpbWVvdXRJZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudXBkYXRlVGltZW91dElkKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGltZW91dElkID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBgSm9iU3RhdGVzU3VtbWFyeUNvbGxlY3Rpb24oKWA7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHsgSm9iU3RhdGVzU3VtbWFyeSwgSm9iU3RhdGVzU3VtbWFyeUNvbGxlY3Rpb24sIEZFVENIX1NUQVRFX09OX0FERCB9O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L2pvYi1zdGF0ZXMtbW9kZWwuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTFFQTtBQUNBO0FBNEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE1RUE7QUFDQTtBQThFQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///71\n");

/***/ }),
/* 72 */
/*!*********************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-view-edit.js ***!
  \*********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _historyView = __webpack_require__(/*! mvc/history/history-view */ 58);\n\nvar _historyView2 = _interopRequireDefault(_historyView);\n\nvar _historyContents = __webpack_require__(/*! mvc/history/history-contents */ 16);\n\nvar _historyContents2 = _interopRequireDefault(_historyContents);\n\nvar _states = __webpack_require__(/*! mvc/dataset/states */ 8);\n\nvar _states2 = _interopRequireDefault(_states);\n\nvar _hdaModel = __webpack_require__(/*! mvc/history/hda-model */ 38);\n\nvar _hdaModel2 = _interopRequireDefault(_hdaModel);\n\nvar _hdaLiEdit = __webpack_require__(/*! mvc/history/hda-li-edit */ 73);\n\nvar _hdaLiEdit2 = _interopRequireDefault(_hdaLiEdit);\n\nvar _hdcaLiEdit = __webpack_require__(/*! mvc/history/hdca-li-edit */ 97);\n\nvar _hdcaLiEdit2 = _interopRequireDefault(_hdcaLiEdit);\n\nvar _tag = __webpack_require__(/*! mvc/tag */ 23);\n\nvar _tag2 = _interopRequireDefault(_tag);\n\nvar _annotation = __webpack_require__(/*! mvc/annotation */ 62);\n\nvar _annotation2 = _interopRequireDefault(_annotation);\n\nvar _listCollectionCreator = __webpack_require__(/*! mvc/collection/list-collection-creator */ 29);\n\nvar _listCollectionCreator2 = _interopRequireDefault(_listCollectionCreator);\n\nvar _pairCollectionCreator = __webpack_require__(/*! mvc/collection/pair-collection-creator */ 74);\n\nvar _pairCollectionCreator2 = _interopRequireDefault(_pairCollectionCreator);\n\nvar _listOfPairsCollectionCreator = __webpack_require__(/*! mvc/collection/list-of-pairs-collection-creator */ 75);\n\nvar _listOfPairsCollectionCreator2 = _interopRequireDefault(_listOfPairsCollectionCreator);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _popupMenu = __webpack_require__(/*! mvc/ui/popup-menu */ 47);\n\nvar _popupMenu2 = _interopRequireDefault(_popupMenu);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/editable-text */ 15);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* =============================================================================\nTODO:\n\n============================================================================= */\nvar _super = _historyView2.default.HistoryView;\n// base class for history-view-edit-current and used as-is in history/view.mako\n/** @class Editable View/Controller for the history model.\n *\n *  Allows:\n *      (everything HistoryView allows)\n *      changing the name\n *      displaying and editing tags and annotations\n *      multi-selection and operations on mulitple content items\n */\nvar HistoryViewEdit = _super.extend(\n/** @lends HistoryViewEdit.prototype */{\n    /** class to use for constructing the HistoryDatasetAssociation views */\n    HDAViewClass: _hdaLiEdit2.default.HDAListItemEdit,\n    /** class to use for constructing the HistoryDatasetCollectionAssociation views */\n    HDCAViewClass: _hdcaLiEdit2.default.HDCAListItemEdit,\n\n    // ......................................................................... SET UP\n    /** Set up the view, set up storage, bind listeners to HistoryContents events\n     *  @param {Object} attributes\n     */\n    initialize: function initialize(attributes) {\n        attributes = attributes || {};\n        _super.prototype.initialize.call(this, attributes);\n\n        // ---- set up instance vars\n        /** editor for tags - sub-view */\n        this.tagsEditor = null;\n\n        /** enable drag and drop - sub-view */\n        this.dragItems = true;\n\n        /** editor for annotations - sub-view */\n        this.annotationEditor = null;\n\n        /** allow user purge of dataset files? */\n        this.purgeAllowed = attributes.purgeAllowed || false;\n\n        // states/modes the panel can be in\n        /** is the panel currently showing the dataset selection controls? */\n        this.annotationEditorShown = attributes.annotationEditorShown || false;\n        this.tagsEditorShown = attributes.tagsEditorShown || false;\n    },\n\n    /** Override to handle history as drag-drop target */\n    _setUpListeners: function _setUpListeners() {\n        _super.prototype._setUpListeners.call(this);\n        return this.on({\n            \"droptarget:drop\": function droptargetDrop(ev, data) {\n                // process whatever was dropped and re-hide the drop target\n                this.dataDropped(data);\n                this.dropTargetOff();\n            },\n            \"view:attached view:removed\": function viewAttachedViewRemoved() {\n                this._renderCounts();\n            },\n            \"search:loading-progress\": this._renderSearchProgress,\n            \"search:searching\": this._renderSearchFindings\n        });\n    },\n\n    // ------------------------------------------------------------------------ listeners\n    /** listening for history and HDA events */\n    _setUpModelListeners: function _setUpModelListeners() {\n        _super.prototype._setUpModelListeners.call(this);\n        this.listenTo(this.model, \"change:size\", this.updateHistoryDiskSize);\n        return this;\n    },\n\n    /** listening for collection events */\n    _setUpCollectionListeners: function _setUpCollectionListeners() {\n        _super.prototype._setUpCollectionListeners.call(this);\n        this.listenTo(this.collection, {\n            \"change:deleted\": this._handleItemDeletedChange,\n            \"change:visible\": this._handleItemVisibleChange,\n            \"change:purged\": function changePurged(model) {\n                // hafta get the new nice-size w/o the purged model\n                this.model.fetch();\n            },\n            // loading indicators for deleted/hidden\n            \"fetching-deleted\": function fetchingDeleted(collection) {\n                this.$(\"> .controls .deleted-count\").html(\"<i>\" + (0, _localization2.default)(\"loading...\") + \"</i>\");\n            },\n            \"fetching-hidden\": function fetchingHidden(collection) {\n                this.$(\"> .controls .hidden-count\").html(\"<i>\" + (0, _localization2.default)(\"loading...\") + \"</i>\");\n            },\n            \"fetching-deleted-done fetching-hidden-done\": this._renderCounts\n        });\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ panel rendering\n    /** In this override, add tag and annotation editors and a btn to toggle the selectors */\n    _buildNewRender: function _buildNewRender() {\n        // create a new render using a skeleton template, render title buttons, render body, and set up events, etc.\n        var $newRender = _super.prototype._buildNewRender.call(this);\n        if (!this.model) {\n            return $newRender;\n        }\n\n        if (Galaxy && Galaxy.user && Galaxy.user.id && Galaxy.user.id === this.model.get(\"user_id\")) {\n            this._renderTags($newRender);\n            this._renderAnnotation($newRender);\n        }\n        return $newRender;\n    },\n\n    /** Update the history size display (curr. upper right of panel). */\n    updateHistoryDiskSize: function updateHistoryDiskSize() {\n        this.$(\".history-size\").text(this.model.get(\"nice_size\"));\n    },\n\n    /** override to render counts when the items are rendered */\n    renderItems: function renderItems($whereTo) {\n        var views = _super.prototype.renderItems.call(this, $whereTo);\n        if (!this.searchFor) {\n            this._renderCounts($whereTo);\n        } else {\n            this._renderSearchFindings($whereTo);\n        }\n        return views;\n    },\n\n    /** override to show counts, what's deleted/hidden, and links to toggle those */\n    _renderCounts: function _renderCounts($whereTo) {\n        $whereTo = $whereTo instanceof jQuery ? $whereTo : this.$el;\n        var html = this.templates.counts(this.model.toJSON(), this);\n        return $whereTo.find(\"> .controls .subtitle\").html(html);\n    },\n\n    /** render the tags sub-view controller */\n    _renderTags: function _renderTags($where) {\n        var panel = this;\n        this.tagsEditor = new _tag2.default.TagsEditor({\n            model: this.model,\n            el: $where.find(\".controls .tags-display\"),\n            onshowFirstTime: function onshowFirstTime() {\n                this.render();\n            },\n            // show hide sub-view tag editors when this is shown/hidden\n            onshow: function onshow() {\n                panel.toggleHDATagEditors(true, panel.fxSpeed);\n            },\n            onhide: function onhide() {\n                panel.toggleHDATagEditors(false, panel.fxSpeed);\n            },\n            $activator: (0, _faIconButton2.default)({\n                title: (0, _localization2.default)(\"Edit history tags\"),\n                classes: \"history-tag-btn\",\n                faIcon: \"fa-tags\"\n            }).appendTo($where.find(\".controls .actions\"))\n        });\n    },\n    /** render the annotation sub-view controller */\n    _renderAnnotation: function _renderAnnotation($where) {\n        var panel = this;\n        this.annotationEditor = new _annotation2.default.AnnotationEditor({\n            model: this.model,\n            el: $where.find(\".controls .annotation-display\"),\n            onshowFirstTime: function onshowFirstTime() {\n                this.render();\n            },\n            // show hide sub-view view annotation editors when this is shown/hidden\n            onshow: function onshow() {\n                panel.toggleHDAAnnotationEditors(true, panel.fxSpeed);\n            },\n            onhide: function onhide() {\n                panel.toggleHDAAnnotationEditors(false, panel.fxSpeed);\n            },\n            $activator: (0, _faIconButton2.default)({\n                title: (0, _localization2.default)(\"Edit history annotation\"),\n                classes: \"history-annotate-btn\",\n                faIcon: \"fa-comment\"\n            }).appendTo($where.find(\".controls .actions\"))\n        });\n    },\n\n    /** Set up HistoryViewEdit js/widget behaviours\n     *  In this override, make the name editable\n     */\n    _setUpBehaviors: function _setUpBehaviors($where) {\n        $where = $where || this.$el;\n        _super.prototype._setUpBehaviors.call(this, $where);\n        if (!this.model) {\n            return;\n        }\n\n        // anon users shouldn't have access to any of the following\n        if (!Galaxy.user || Galaxy.user.isAnonymous() || Galaxy.user.id !== this.model.get(\"user_id\")) {\n            return;\n        }\n\n        var panel = this;\n        var nameSelector = \"> .controls .name\";\n        $where.find(nameSelector).attr(\"title\", (0, _localization2.default)(\"Click to rename history\")).tooltip({ placement: \"bottom\" }).make_text_editable({\n            on_finish: function on_finish(newName) {\n                var previousName = panel.model.get(\"name\");\n                if (newName && newName !== previousName) {\n                    panel.$el.find(nameSelector).text(newName);\n                    panel.model.save({ name: newName }).fail(function () {\n                        panel.$el.find(nameSelector).text(panel.model.previous(\"name\"));\n                    });\n                } else {\n                    panel.$el.find(nameSelector).text(previousName);\n                }\n            }\n        });\n    },\n\n    /** return a new popup menu for choosing a multi selection action\n     *  ajax calls made for multiple datasets are queued\n     */\n    multiselectActions: function multiselectActions() {\n        var panel = this;\n\n        var actions = [{\n            html: (0, _localization2.default)(\"Hide datasets\"),\n            func: function func() {\n                var action = _hdaModel2.default.HistoryDatasetAssociation.prototype.hide;\n                panel.getSelectedModels().ajaxQueue(action);\n            }\n        }, {\n            html: (0, _localization2.default)(\"Unhide datasets\"),\n            func: function func() {\n                var action = _hdaModel2.default.HistoryDatasetAssociation.prototype.unhide;\n                panel.getSelectedModels().ajaxQueue(action);\n            }\n        }, {\n            html: (0, _localization2.default)(\"Delete datasets\"),\n            func: function func() {\n                var action = _hdaModel2.default.HistoryDatasetAssociation.prototype[\"delete\"];\n                panel.getSelectedModels().ajaxQueue(action);\n            }\n        }, {\n            html: (0, _localization2.default)(\"Undelete datasets\"),\n            func: function func() {\n                var action = _hdaModel2.default.HistoryDatasetAssociation.prototype.undelete;\n                panel.getSelectedModels().ajaxQueue(action);\n            }\n        }];\n\n        if (panel.purgeAllowed) {\n            actions.push({\n                html: (0, _localization2.default)(\"Permanently delete datasets\"),\n                func: function func() {\n                    if (confirm((0, _localization2.default)(\"This will permanently remove the data in your datasets. Are you sure?\"))) {\n                        var action = _hdaModel2.default.HistoryDatasetAssociation.prototype.purge;\n                        var historyContents = panel.getSelectedModels();\n                        var selectedDatasets = historyContents.filter(function (c) {\n                            return c.get(\"history_content_type\") == \"dataset\";\n                        });\n                        historyContents.ajaxQueue(action, {}, selectedDatasets);\n                    }\n                }\n            });\n        }\n        actions = actions.concat(panel._collectionActions());\n        return actions;\n    },\n\n    /**   */\n    _collectionActions: function _collectionActions() {\n        var panel = this;\n        return [{\n            html: (0, _localization2.default)(\"Build Dataset List\"),\n            func: function func() {\n                panel.buildCollection(\"list\");\n            }\n        },\n        // TODO: Only show quick pair if two things selected.\n        {\n            html: (0, _localization2.default)(\"Build Dataset Pair\"),\n            func: function func() {\n                panel.buildCollection(\"paired\");\n            }\n        }, {\n            html: (0, _localization2.default)(\"Build List of Dataset Pairs\"),\n            func: function func() {\n                panel.buildCollection(\"list:paired\");\n            }\n        }];\n    },\n\n    buildCollection: function buildCollection(collectionType, selection, hideSourceItems) {\n        var panel = this;\n        var selection = selection || panel.getSelectedModels();\n        var hideSourceItems = hideSourceItems || false;\n        var createFunc;\n        if (collectionType == \"list\") {\n            createFunc = _listCollectionCreator2.default.createListCollection;\n        } else if (collectionType == \"paired\") {\n            createFunc = _pairCollectionCreator2.default.createPairCollection;\n        } else if (collectionType == \"list:paired\") {\n            createFunc = _listOfPairsCollectionCreator2.default.createListOfPairsCollection;\n        } else {\n            console.warn(\"Unknown collectionType encountered \" + collectionType);\n        }\n        createFunc(selection, hideSourceItems).done(function () {\n            panel.model.refresh();\n        });\n    },\n\n    // ------------------------------------------------------------------------ sub-views\n    /** In this override, add purgeAllowed and whether tags/annotation editors should be shown */\n    _getItemViewOptions: function _getItemViewOptions(model) {\n        var options = _super.prototype._getItemViewOptions.call(this, model);\n        _.extend(options, {\n            purgeAllowed: this.purgeAllowed,\n            tagsEditorShown: this.tagsEditor && !this.tagsEditor.hidden,\n            annotationEditorShown: this.annotationEditor && !this.annotationEditor.hidden\n        });\n        return options;\n    },\n\n    /** If this item is deleted and we're not showing deleted items, remove the view\n     *  @param {Model} the item model to check\n     */\n    _handleItemDeletedChange: function _handleItemDeletedChange(itemModel) {\n        if (itemModel.get(\"deleted\")) {\n            this._handleItemDeletion(itemModel);\n        } else {\n            this._handleItemUndeletion(itemModel);\n        }\n        this._renderCounts();\n    },\n\n    _handleItemDeletion: function _handleItemDeletion(itemModel) {\n        var contentsShown = this.model.get(\"contents_active\");\n        contentsShown.deleted += 1;\n        contentsShown.active -= 1;\n        if (!this.model.contents.includeDeleted) {\n            this.removeItemView(itemModel);\n        }\n        this.model.set(\"contents_active\", contentsShown);\n    },\n\n    _handleItemUndeletion: function _handleItemUndeletion(itemModel) {\n        var contentsShown = this.model.get(\"contents_active\");\n        contentsShown.deleted -= 1;\n        if (!this.model.contents.includeDeleted) {\n            contentsShown.active -= 1;\n        }\n        this.model.set(\"contents_active\", contentsShown);\n    },\n\n    /** If this item is hidden and we're not showing hidden items, remove the view\n     *  @param {Model} the item model to check\n     */\n    _handleItemVisibleChange: function _handleItemVisibleChange(itemModel) {\n        if (itemModel.hidden()) {\n            this._handleItemHidden(itemModel);\n        } else {\n            this._handleItemUnhidden(itemModel);\n        }\n        this._renderCounts();\n    },\n\n    _handleItemHidden: function _handleItemHidden(itemModel) {\n        var contentsShown = this.model.get(\"contents_active\");\n        contentsShown.hidden += 1;\n        contentsShown.active -= 1;\n        if (!this.model.contents.includeHidden) {\n            this.removeItemView(itemModel);\n        }\n        this.model.set(\"contents_active\", contentsShown);\n    },\n\n    _handleItemUnhidden: function _handleItemUnhidden(itemModel) {\n        var contentsShown = this.model.get(\"contents_active\");\n        contentsShown.hidden -= 1;\n        if (!this.model.contents.includeHidden) {\n            contentsShown.active -= 1;\n        }\n        this.model.set(\"contents_active\", contentsShown);\n    },\n\n    /** toggle the visibility of each content's tagsEditor applying all the args sent to this function */\n    toggleHDATagEditors: function toggleHDATagEditors(showOrHide, speed) {\n        _.each(this.views, function (view) {\n            if (view.tagsEditor) {\n                view.tagsEditor.toggle(showOrHide, speed);\n            }\n        });\n    },\n\n    /** toggle the visibility of each content's annotationEditor applying all the args sent to this function */\n    toggleHDAAnnotationEditors: function toggleHDAAnnotationEditors(showOrHide, speed) {\n        _.each(this.views, function (view) {\n            if (view.annotationEditor) {\n                view.annotationEditor.toggle(showOrHide, speed);\n            }\n        });\n    },\n\n    // ------------------------------------------------------------------------ panel events\n    /** event map */\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .show-selectors-btn\": \"toggleSelectors\",\n        \"click .toggle-deleted-link\": function clickToggleDeletedLink(ev) {\n            this.toggleShowDeleted();\n        },\n        \"click .toggle-hidden-link\": function clickToggleHiddenLink(ev) {\n            this.toggleShowHidden();\n        }\n    }),\n\n    // ------------------------------------------------------------------------ search\n    _renderSearchProgress: function _renderSearchProgress(limit, offset) {\n        var stop = limit + offset;\n        return this.$(\"> .controls .subtitle\").html([\"<i>\", (0, _localization2.default)(\"Searching \"), stop, \"/\", this.model.contentsShown(), \"</i>\"].join(\"\"));\n    },\n\n    /** override to display number found in subtitle */\n    _renderSearchFindings: function _renderSearchFindings($whereTo) {\n        $whereTo = $whereTo instanceof jQuery ? $whereTo : this.$el;\n        var html = this.templates.found(this.model.toJSON(), this);\n        $whereTo.find(\"> .controls .subtitle\").html(html);\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ as drop target\n    /** turn all the drag and drop handlers on and add some help text above the drop area */\n    dropTargetOn: function dropTargetOn() {\n        if (this.dropTarget) {\n            return this;\n        }\n        this.dropTarget = true;\n\n        //TODO: to init\n        var dropHandlers = {\n            dragenter: _.bind(this.dragenter, this),\n            dragover: _.bind(this.dragover, this),\n            dragleave: _.bind(this.dragleave, this),\n            drop: _.bind(this.drop, this)\n        };\n\n        var $dropTarget = this._renderDropTarget();\n        this.$list().before([this._renderDropTargetHelp(), $dropTarget]);\n        for (var evName in dropHandlers) {\n            if (dropHandlers.hasOwnProperty(evName)) {\n                //console.debug( evName, dropHandlers[ evName ] );\n                $dropTarget.on(evName, dropHandlers[evName]);\n            }\n        }\n        return this;\n    },\n\n    /** render a box to serve as a 'drop here' area on the history */\n    _renderDropTarget: function _renderDropTarget() {\n        this.$(\".history-drop-target\").remove();\n        return $(\"<div/>\").addClass(\"history-drop-target\");\n    },\n\n    /** tell the user how it works  */\n    _renderDropTargetHelp: function _renderDropTargetHelp() {\n        this.$(\".history-drop-target-help\").remove();\n        return $(\"<div/>\").addClass(\"history-drop-target-help\").text((0, _localization2.default)(\"Drag datasets here to copy them to the current history\"));\n    },\n\n    /** shut down drag and drop event handlers and remove drop target */\n    dropTargetOff: function dropTargetOff() {\n        if (!this.dropTarget) {\n            return this;\n        }\n        //this.log( 'dropTargetOff' );\n        this.dropTarget = false;\n        var dropTarget = this.$(\".history-drop-target\").get(0);\n        for (var evName in this._dropHandlers) {\n            if (this._dropHandlers.hasOwnProperty(evName)) {\n                dropTarget.off(evName, this._dropHandlers[evName]);\n            }\n        }\n        this.$(\".history-drop-target\").remove();\n        this.$(\".history-drop-target-help\").remove();\n        return this;\n    },\n    /** toggle the target on/off */\n    dropTargetToggle: function dropTargetToggle() {\n        if (this.dropTarget) {\n            this.dropTargetOff();\n        } else {\n            this.dropTargetOn();\n        }\n        return this;\n    },\n\n    dragenter: function dragenter(ev) {\n        //console.debug( 'dragenter:', this, ev );\n        ev.preventDefault();\n        ev.stopPropagation();\n        this.$(\".history-drop-target\").css(\"border\", \"2px solid black\");\n    },\n    dragover: function dragover(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n    },\n    dragleave: function dragleave(ev) {\n        //console.debug( 'dragleave:', this, ev );\n        ev.preventDefault();\n        ev.stopPropagation();\n        this.$(\".history-drop-target\").css(\"border\", \"1px dashed black\");\n    },\n    /** when (text) is dropped try to parse as json and trigger an event */\n    drop: function drop(ev) {\n        ev.preventDefault();\n        //ev.stopPropagation();\n\n        var self = this;\n        var dataTransfer = ev.originalEvent.dataTransfer;\n        var data = dataTransfer.getData(\"text\");\n\n        dataTransfer.dropEffect = \"move\";\n        try {\n            data = JSON.parse(data);\n        } catch (err) {\n            self.warn(\"error parsing JSON from drop:\", data);\n        }\n\n        self.trigger(\"droptarget:drop\", ev, data, self);\n        return false;\n    },\n\n    /** handler that copies data into the contents */\n    dataDropped: function dataDropped(data) {\n        var self = this;\n        // HDA: dropping will copy it to the history\n        if (_.isObject(data) && data.model_class === \"HistoryDatasetAssociation\" && data.id) {\n            if (self.contents.currentPage !== 0) {\n                return self.contents.fetchPage(0).then(function () {\n                    return self.model.contents.copy(data.id);\n                });\n            }\n            return self.model.contents.copy(data.id);\n        }\n        return jQuery.when();\n    },\n\n    // ........................................................................ misc\n    /** Return a string rep of the history */\n    toString: function toString() {\n        return \"HistoryViewEdit(\" + (this.model ? this.model.get(\"name\") : \"\") + \")\";\n    }\n});\n\n//------------------------------------------------------------------------------ TEMPLATES\nHistoryViewEdit.prototype.templates = function () {\n    var countsTemplate = _baseMvc2.default.wrapTemplate([\"<% var shown = Math.max( view.views.length, history.contents_active.active ) %>\", \"<% if( shown ){ %>\", '<span class=\"shown-count\">', \"<%- shown %> \", (0, _localization2.default)(\"shown\"), \"</span>\", \"<% } %>\", \"<% if( history.contents_active.deleted ){ %>\", '<span class=\"deleted-count\">', \"<% if( view.model.contents.includeDeleted ){ %>\", '<a class=\"toggle-deleted-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"hide deleted\"), \"</a>\", \"<% } else { %>\", \"<%- history.contents_active.deleted %> \", '<a class=\"toggle-deleted-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"deleted\"), \"</a>\", \"<% } %>\", \"</span>\", \"<% } %>\", \"<% if( history.contents_active.hidden ){ %>\", '<span class=\"hidden-count\">', \"<% if( view.model.contents.includeHidden ){ %>\", '<a class=\"toggle-hidden-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"hide hidden\"), \"</a>\", \"<% } else { %>\", \"<%- history.contents_active.hidden %> \", '<a class=\"toggle-hidden-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"hidden\"), \"</a>\", \"<% } %>\", \"</span>\", \"<% } %>\"], \"history\");\n\n    var foundTemplate = _baseMvc2.default.wrapTemplate([(0, _localization2.default)(\"Found\"), \" <%- view.views.length %>, \", \"<% if( history.contents_active.deleted ){ %>\", \"<% if( view.model.contents.includeDeleted ){ %>\", '<a class=\"toggle-deleted-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"hide deleted\"), \"</a>, \", \"<% } else { %>\", '<a class=\"toggle-deleted-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"show deleted\"), \"</a>, \", \"<% } %>\", \"<% } %>\", \"<% if( history.contents_active.hidden ){ %>\", \"<% if( view.model.contents.includeHidden ){ %>\", '<a class=\"toggle-hidden-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"hide hidden\"), \"</a>\", \"<% } else { %>\", '<a class=\"toggle-hidden-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"show hidden\"), \"</a>\", \"<% } %>\", \"<% } %>\"], \"history\");\n\n    return _.extend(_.clone(_super.prototype.templates), {\n        counts: countsTemplate,\n        found: foundTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    HistoryViewEdit: HistoryViewEdit\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS12aWV3LWVkaXQuanM/ZWIyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSElTVE9SWV9WSUVXIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LXZpZXdcIjtcbmltcG9ydCBISVNUT1JZX0NPTlRFTlRTIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LWNvbnRlbnRzXCI7XG5pbXBvcnQgU1RBVEVTIGZyb20gXCJtdmMvZGF0YXNldC9zdGF0ZXNcIjtcbmltcG9ydCBIREFfTU9ERUwgZnJvbSBcIm12Yy9oaXN0b3J5L2hkYS1tb2RlbFwiO1xuaW1wb3J0IEhEQV9MSV9FRElUIGZyb20gXCJtdmMvaGlzdG9yeS9oZGEtbGktZWRpdFwiO1xuaW1wb3J0IEhEQ0FfTElfRURJVCBmcm9tIFwibXZjL2hpc3RvcnkvaGRjYS1saS1lZGl0XCI7XG5pbXBvcnQgVEFHUyBmcm9tIFwibXZjL3RhZ1wiO1xuaW1wb3J0IEFOTk9UQVRJT05TIGZyb20gXCJtdmMvYW5ub3RhdGlvblwiO1xuaW1wb3J0IExJU1RfQ09MTEVDVElPTl9DUkVBVE9SIGZyb20gXCJtdmMvY29sbGVjdGlvbi9saXN0LWNvbGxlY3Rpb24tY3JlYXRvclwiO1xuaW1wb3J0IFBBSVJfQ09MTEVDVElPTl9DUkVBVE9SIGZyb20gXCJtdmMvY29sbGVjdGlvbi9wYWlyLWNvbGxlY3Rpb24tY3JlYXRvclwiO1xuaW1wb3J0IExJU1RfT0ZfUEFJUlNfQ09MTEVDVElPTl9DUkVBVE9SIGZyb20gXCJtdmMvY29sbGVjdGlvbi9saXN0LW9mLXBhaXJzLWNvbGxlY3Rpb24tY3JlYXRvclwiO1xuaW1wb3J0IGZhSWNvbkJ1dHRvbiBmcm9tIFwidWkvZmEtaWNvbi1idXR0b25cIjtcbmltcG9ydCBQb3B1cE1lbnUgZnJvbSBcIm12Yy91aS9wb3B1cC1tZW51XCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbmltcG9ydCBcInVpL2VkaXRhYmxlLXRleHRcIjtcblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblRPRE86XG5cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG52YXIgX3N1cGVyID0gSElTVE9SWV9WSUVXLkhpc3RvcnlWaWV3O1xuLy8gYmFzZSBjbGFzcyBmb3IgaGlzdG9yeS12aWV3LWVkaXQtY3VycmVudCBhbmQgdXNlZCBhcy1pcyBpbiBoaXN0b3J5L3ZpZXcubWFrb1xuLyoqIEBjbGFzcyBFZGl0YWJsZSBWaWV3L0NvbnRyb2xsZXIgZm9yIHRoZSBoaXN0b3J5IG1vZGVsLlxuICpcbiAqICBBbGxvd3M6XG4gKiAgICAgIChldmVyeXRoaW5nIEhpc3RvcnlWaWV3IGFsbG93cylcbiAqICAgICAgY2hhbmdpbmcgdGhlIG5hbWVcbiAqICAgICAgZGlzcGxheWluZyBhbmQgZWRpdGluZyB0YWdzIGFuZCBhbm5vdGF0aW9uc1xuICogICAgICBtdWx0aS1zZWxlY3Rpb24gYW5kIG9wZXJhdGlvbnMgb24gbXVsaXRwbGUgY29udGVudCBpdGVtc1xuICovXG52YXIgSGlzdG9yeVZpZXdFZGl0ID0gX3N1cGVyLmV4dGVuZChcbiAgICAvKiogQGxlbmRzIEhpc3RvcnlWaWV3RWRpdC5wcm90b3R5cGUgKi8ge1xuICAgICAgICAvKiogY2xhc3MgdG8gdXNlIGZvciBjb25zdHJ1Y3RpbmcgdGhlIEhpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb24gdmlld3MgKi9cbiAgICAgICAgSERBVmlld0NsYXNzOiBIREFfTElfRURJVC5IREFMaXN0SXRlbUVkaXQsXG4gICAgICAgIC8qKiBjbGFzcyB0byB1c2UgZm9yIGNvbnN0cnVjdGluZyB0aGUgSGlzdG9yeURhdGFzZXRDb2xsZWN0aW9uQXNzb2NpYXRpb24gdmlld3MgKi9cbiAgICAgICAgSERDQVZpZXdDbGFzczogSERDQV9MSV9FRElULkhEQ0FMaXN0SXRlbUVkaXQsXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBTRVQgVVBcbiAgICAgICAgLyoqIFNldCB1cCB0aGUgdmlldywgc2V0IHVwIHN0b3JhZ2UsIGJpbmQgbGlzdGVuZXJzIHRvIEhpc3RvcnlDb250ZW50cyBldmVudHNcbiAgICAgICAgICogIEBwYXJhbSB7T2JqZWN0fSBhdHRyaWJ1dGVzXG4gICAgICAgICAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzID0gYXR0cmlidXRlcyB8fCB7fTtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuXG4gICAgICAgICAgICAvLyAtLS0tIHNldCB1cCBpbnN0YW5jZSB2YXJzXG4gICAgICAgICAgICAvKiogZWRpdG9yIGZvciB0YWdzIC0gc3ViLXZpZXcgKi9cbiAgICAgICAgICAgIHRoaXMudGFnc0VkaXRvciA9IG51bGw7XG5cbiAgICAgICAgICAgIC8qKiBlbmFibGUgZHJhZyBhbmQgZHJvcCAtIHN1Yi12aWV3ICovXG4gICAgICAgICAgICB0aGlzLmRyYWdJdGVtcyA9IHRydWU7XG5cbiAgICAgICAgICAgIC8qKiBlZGl0b3IgZm9yIGFubm90YXRpb25zIC0gc3ViLXZpZXcgKi9cbiAgICAgICAgICAgIHRoaXMuYW5ub3RhdGlvbkVkaXRvciA9IG51bGw7XG5cbiAgICAgICAgICAgIC8qKiBhbGxvdyB1c2VyIHB1cmdlIG9mIGRhdGFzZXQgZmlsZXM/ICovXG4gICAgICAgICAgICB0aGlzLnB1cmdlQWxsb3dlZCA9IGF0dHJpYnV0ZXMucHVyZ2VBbGxvd2VkIHx8IGZhbHNlO1xuXG4gICAgICAgICAgICAvLyBzdGF0ZXMvbW9kZXMgdGhlIHBhbmVsIGNhbiBiZSBpblxuICAgICAgICAgICAgLyoqIGlzIHRoZSBwYW5lbCBjdXJyZW50bHkgc2hvd2luZyB0aGUgZGF0YXNldCBzZWxlY3Rpb24gY29udHJvbHM/ICovXG4gICAgICAgICAgICB0aGlzLmFubm90YXRpb25FZGl0b3JTaG93biA9IGF0dHJpYnV0ZXMuYW5ub3RhdGlvbkVkaXRvclNob3duIHx8IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy50YWdzRWRpdG9yU2hvd24gPSBhdHRyaWJ1dGVzLnRhZ3NFZGl0b3JTaG93biB8fCBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogT3ZlcnJpZGUgdG8gaGFuZGxlIGhpc3RvcnkgYXMgZHJhZy1kcm9wIHRhcmdldCAqL1xuICAgICAgICBfc2V0VXBMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBMaXN0ZW5lcnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9uKHtcbiAgICAgICAgICAgICAgICBcImRyb3B0YXJnZXQ6ZHJvcFwiOiBmdW5jdGlvbihldiwgZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZXNzIHdoYXRldmVyIHdhcyBkcm9wcGVkIGFuZCByZS1oaWRlIHRoZSBkcm9wIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFEcm9wcGVkKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3BUYXJnZXRPZmYoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidmlldzphdHRhY2hlZCB2aWV3OnJlbW92ZWRcIjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckNvdW50cygpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJzZWFyY2g6bG9hZGluZy1wcm9ncmVzc1wiOiB0aGlzLl9yZW5kZXJTZWFyY2hQcm9ncmVzcyxcbiAgICAgICAgICAgICAgICBcInNlYXJjaDpzZWFyY2hpbmdcIjogdGhpcy5fcmVuZGVyU2VhcmNoRmluZGluZ3NcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBsaXN0ZW5lcnNcbiAgICAgICAgLyoqIGxpc3RlbmluZyBmb3IgaGlzdG9yeSBhbmQgSERBIGV2ZW50cyAqL1xuICAgICAgICBfc2V0VXBNb2RlbExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcE1vZGVsTGlzdGVuZXJzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOnNpemVcIiwgdGhpcy51cGRhdGVIaXN0b3J5RGlza1NpemUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGxpc3RlbmluZyBmb3IgY29sbGVjdGlvbiBldmVudHMgKi9cbiAgICAgICAgX3NldFVwQ29sbGVjdGlvbkxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcENvbGxlY3Rpb25MaXN0ZW5lcnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCB7XG4gICAgICAgICAgICAgICAgXCJjaGFuZ2U6ZGVsZXRlZFwiOiB0aGlzLl9oYW5kbGVJdGVtRGVsZXRlZENoYW5nZSxcbiAgICAgICAgICAgICAgICBcImNoYW5nZTp2aXNpYmxlXCI6IHRoaXMuX2hhbmRsZUl0ZW1WaXNpYmxlQ2hhbmdlLFxuICAgICAgICAgICAgICAgIFwiY2hhbmdlOnB1cmdlZFwiOiBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBoYWZ0YSBnZXQgdGhlIG5ldyBuaWNlLXNpemUgdy9vIHRoZSBwdXJnZWQgbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5mZXRjaCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gbG9hZGluZyBpbmRpY2F0b3JzIGZvciBkZWxldGVkL2hpZGRlblxuICAgICAgICAgICAgICAgIFwiZmV0Y2hpbmctZGVsZXRlZFwiOiBmdW5jdGlvbihjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJChcIj4gLmNvbnRyb2xzIC5kZWxldGVkLWNvdW50XCIpLmh0bWwoYDxpPiR7X2woXCJsb2FkaW5nLi4uXCIpfTwvaT5gKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiZmV0Y2hpbmctaGlkZGVuXCI6IGZ1bmN0aW9uKGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kKFwiPiAuY29udHJvbHMgLmhpZGRlbi1jb3VudFwiKS5odG1sKGA8aT4ke19sKFwibG9hZGluZy4uLlwiKX08L2k+YCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImZldGNoaW5nLWRlbGV0ZWQtZG9uZSBmZXRjaGluZy1oaWRkZW4tZG9uZVwiOiB0aGlzLl9yZW5kZXJDb3VudHNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBhbmVsIHJlbmRlcmluZ1xuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgYWRkIHRhZyBhbmQgYW5ub3RhdGlvbiBlZGl0b3JzIGFuZCBhIGJ0biB0byB0b2dnbGUgdGhlIHNlbGVjdG9ycyAqL1xuICAgICAgICBfYnVpbGROZXdSZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gY3JlYXRlIGEgbmV3IHJlbmRlciB1c2luZyBhIHNrZWxldG9uIHRlbXBsYXRlLCByZW5kZXIgdGl0bGUgYnV0dG9ucywgcmVuZGVyIGJvZHksIGFuZCBzZXQgdXAgZXZlbnRzLCBldGMuXG4gICAgICAgICAgICB2YXIgJG5ld1JlbmRlciA9IF9zdXBlci5wcm90b3R5cGUuX2J1aWxkTmV3UmVuZGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJG5ld1JlbmRlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKEdhbGF4eSAmJiBHYWxheHkudXNlciAmJiBHYWxheHkudXNlci5pZCAmJiBHYWxheHkudXNlci5pZCA9PT0gdGhpcy5tb2RlbC5nZXQoXCJ1c2VyX2lkXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyVGFncygkbmV3UmVuZGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJBbm5vdGF0aW9uKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRuZXdSZW5kZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFVwZGF0ZSB0aGUgaGlzdG9yeSBzaXplIGRpc3BsYXkgKGN1cnIuIHVwcGVyIHJpZ2h0IG9mIHBhbmVsKS4gKi9cbiAgICAgICAgdXBkYXRlSGlzdG9yeURpc2tTaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuJChcIi5oaXN0b3J5LXNpemVcIikudGV4dCh0aGlzLm1vZGVsLmdldChcIm5pY2Vfc2l6ZVwiKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIG92ZXJyaWRlIHRvIHJlbmRlciBjb3VudHMgd2hlbiB0aGUgaXRlbXMgYXJlIHJlbmRlcmVkICovXG4gICAgICAgIHJlbmRlckl0ZW1zOiBmdW5jdGlvbigkd2hlcmVUbykge1xuICAgICAgICAgICAgdmFyIHZpZXdzID0gX3N1cGVyLnByb3RvdHlwZS5yZW5kZXJJdGVtcy5jYWxsKHRoaXMsICR3aGVyZVRvKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWFyY2hGb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJDb3VudHMoJHdoZXJlVG8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJTZWFyY2hGaW5kaW5ncygkd2hlcmVUbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmlld3M7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIG92ZXJyaWRlIHRvIHNob3cgY291bnRzLCB3aGF0J3MgZGVsZXRlZC9oaWRkZW4sIGFuZCBsaW5rcyB0byB0b2dnbGUgdGhvc2UgKi9cbiAgICAgICAgX3JlbmRlckNvdW50czogZnVuY3Rpb24oJHdoZXJlVG8pIHtcbiAgICAgICAgICAgICR3aGVyZVRvID0gJHdoZXJlVG8gaW5zdGFuY2VvZiBqUXVlcnkgPyAkd2hlcmVUbyA6IHRoaXMuJGVsO1xuICAgICAgICAgICAgdmFyIGh0bWwgPSB0aGlzLnRlbXBsYXRlcy5jb3VudHModGhpcy5tb2RlbC50b0pTT04oKSwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gJHdoZXJlVG8uZmluZChcIj4gLmNvbnRyb2xzIC5zdWJ0aXRsZVwiKS5odG1sKGh0bWwpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgdGhlIHRhZ3Mgc3ViLXZpZXcgY29udHJvbGxlciAqL1xuICAgICAgICBfcmVuZGVyVGFnczogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy50YWdzRWRpdG9yID0gbmV3IFRBR1MuVGFnc0VkaXRvcih7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHRoaXMubW9kZWwsXG4gICAgICAgICAgICAgICAgZWw6ICR3aGVyZS5maW5kKFwiLmNvbnRyb2xzIC50YWdzLWRpc3BsYXlcIiksXG4gICAgICAgICAgICAgICAgb25zaG93Rmlyc3RUaW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIHNob3cgaGlkZSBzdWItdmlldyB0YWcgZWRpdG9ycyB3aGVuIHRoaXMgaXMgc2hvd24vaGlkZGVuXG4gICAgICAgICAgICAgICAgb25zaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFuZWwudG9nZ2xlSERBVGFnRWRpdG9ycyh0cnVlLCBwYW5lbC5meFNwZWVkKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLnRvZ2dsZUhEQVRhZ0VkaXRvcnMoZmFsc2UsIHBhbmVsLmZ4U3BlZWQpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJGFjdGl2YXRvcjogZmFJY29uQnV0dG9uKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiRWRpdCBoaXN0b3J5IHRhZ3NcIiksXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IFwiaGlzdG9yeS10YWctYnRuXCIsXG4gICAgICAgICAgICAgICAgICAgIGZhSWNvbjogXCJmYS10YWdzXCJcbiAgICAgICAgICAgICAgICB9KS5hcHBlbmRUbygkd2hlcmUuZmluZChcIi5jb250cm9scyAuYWN0aW9uc1wiKSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICAvKiogcmVuZGVyIHRoZSBhbm5vdGF0aW9uIHN1Yi12aWV3IGNvbnRyb2xsZXIgKi9cbiAgICAgICAgX3JlbmRlckFubm90YXRpb246IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuYW5ub3RhdGlvbkVkaXRvciA9IG5ldyBBTk5PVEFUSU9OUy5Bbm5vdGF0aW9uRWRpdG9yKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcbiAgICAgICAgICAgICAgICBlbDogJHdoZXJlLmZpbmQoXCIuY29udHJvbHMgLmFubm90YXRpb24tZGlzcGxheVwiKSxcbiAgICAgICAgICAgICAgICBvbnNob3dGaXJzdFRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgLy8gc2hvdyBoaWRlIHN1Yi12aWV3IHZpZXcgYW5ub3RhdGlvbiBlZGl0b3JzIHdoZW4gdGhpcyBpcyBzaG93bi9oaWRkZW5cbiAgICAgICAgICAgICAgICBvbnNob3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBwYW5lbC50b2dnbGVIREFBbm5vdGF0aW9uRWRpdG9ycyh0cnVlLCBwYW5lbC5meFNwZWVkKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9uaGlkZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLnRvZ2dsZUhEQUFubm90YXRpb25FZGl0b3JzKGZhbHNlLCBwYW5lbC5meFNwZWVkKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICRhY3RpdmF0b3I6IGZhSWNvbkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkVkaXQgaGlzdG9yeSBhbm5vdGF0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBcImhpc3RvcnktYW5ub3RhdGUtYnRuXCIsXG4gICAgICAgICAgICAgICAgICAgIGZhSWNvbjogXCJmYS1jb21tZW50XCJcbiAgICAgICAgICAgICAgICB9KS5hcHBlbmRUbygkd2hlcmUuZmluZChcIi5jb250cm9scyAuYWN0aW9uc1wiKSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBTZXQgdXAgSGlzdG9yeVZpZXdFZGl0IGpzL3dpZGdldCBiZWhhdmlvdXJzXG4gICAgICAgICAqICBJbiB0aGlzIG92ZXJyaWRlLCBtYWtlIHRoZSBuYW1lIGVkaXRhYmxlXG4gICAgICAgICAqL1xuICAgICAgICBfc2V0VXBCZWhhdmlvcnM6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBCZWhhdmlvcnMuY2FsbCh0aGlzLCAkd2hlcmUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1vZGVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhbm9uIHVzZXJzIHNob3VsZG4ndCBoYXZlIGFjY2VzcyB0byBhbnkgb2YgdGhlIGZvbGxvd2luZ1xuICAgICAgICAgICAgaWYgKCFHYWxheHkudXNlciB8fCBHYWxheHkudXNlci5pc0Fub255bW91cygpIHx8IEdhbGF4eS51c2VyLmlkICE9PSB0aGlzLm1vZGVsLmdldChcInVzZXJfaWRcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbmFtZVNlbGVjdG9yID0gXCI+IC5jb250cm9scyAubmFtZVwiO1xuICAgICAgICAgICAgJHdoZXJlXG4gICAgICAgICAgICAgICAgLmZpbmQobmFtZVNlbGVjdG9yKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidGl0bGVcIiwgX2woXCJDbGljayB0byByZW5hbWUgaGlzdG9yeVwiKSlcbiAgICAgICAgICAgICAgICAudG9vbHRpcCh7IHBsYWNlbWVudDogXCJib3R0b21cIiB9KVxuICAgICAgICAgICAgICAgIC5tYWtlX3RleHRfZWRpdGFibGUoe1xuICAgICAgICAgICAgICAgICAgICBvbl9maW5pc2g6IGZ1bmN0aW9uKG5ld05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmV2aW91c05hbWUgPSBwYW5lbC5tb2RlbC5nZXQoXCJuYW1lXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld05hbWUgJiYgbmV3TmFtZSAhPT0gcHJldmlvdXNOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuJGVsLmZpbmQobmFtZVNlbGVjdG9yKS50ZXh0KG5ld05hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLm1vZGVsLnNhdmUoeyBuYW1lOiBuZXdOYW1lIH0pLmZhaWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbC4kZWwuZmluZChuYW1lU2VsZWN0b3IpLnRleHQocGFuZWwubW9kZWwucHJldmlvdXMoXCJuYW1lXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuJGVsLmZpbmQobmFtZVNlbGVjdG9yKS50ZXh0KHByZXZpb3VzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmV0dXJuIGEgbmV3IHBvcHVwIG1lbnUgZm9yIGNob29zaW5nIGEgbXVsdGkgc2VsZWN0aW9uIGFjdGlvblxuICAgICAgICAgKiAgYWpheCBjYWxscyBtYWRlIGZvciBtdWx0aXBsZSBkYXRhc2V0cyBhcmUgcXVldWVkXG4gICAgICAgICAqL1xuICAgICAgICBtdWx0aXNlbGVjdEFjdGlvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGFjdGlvbnMgPSBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBodG1sOiBfbChcIkhpZGUgZGF0YXNldHNcIiksXG4gICAgICAgICAgICAgICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IEhEQV9NT0RFTC5IaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uLnByb3RvdHlwZS5oaWRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuZ2V0U2VsZWN0ZWRNb2RlbHMoKS5hamF4UXVldWUoYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBodG1sOiBfbChcIlVuaGlkZSBkYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gSERBX01PREVMLkhpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb24ucHJvdG90eXBlLnVuaGlkZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLmdldFNlbGVjdGVkTW9kZWxzKCkuYWpheFF1ZXVlKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbDogX2woXCJEZWxldGUgZGF0YXNldHNcIiksXG4gICAgICAgICAgICAgICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IEhEQV9NT0RFTC5IaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uLnByb3RvdHlwZVtcImRlbGV0ZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLmdldFNlbGVjdGVkTW9kZWxzKCkuYWpheFF1ZXVlKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbDogX2woXCJVbmRlbGV0ZSBkYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gSERBX01PREVMLkhpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb24ucHJvdG90eXBlLnVuZGVsZXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuZ2V0U2VsZWN0ZWRNb2RlbHMoKS5hamF4UXVldWUoYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGlmIChwYW5lbC5wdXJnZUFsbG93ZWQpIHtcbiAgICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBodG1sOiBfbChcIlBlcm1hbmVudGx5IGRlbGV0ZSBkYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybShfbChcIlRoaXMgd2lsbCBwZXJtYW5lbnRseSByZW1vdmUgdGhlIGRhdGEgaW4geW91ciBkYXRhc2V0cy4gQXJlIHlvdSBzdXJlP1wiKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gSERBX01PREVMLkhpc3RvcnlEYXRhc2V0QXNzb2NpYXRpb24ucHJvdG90eXBlLnB1cmdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpc3RvcnlDb250ZW50cyA9IHBhbmVsLmdldFNlbGVjdGVkTW9kZWxzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWREYXRhc2V0cyA9IGhpc3RvcnlDb250ZW50cy5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZ2V0KFwiaGlzdG9yeV9jb250ZW50X3R5cGVcIikgPT0gXCJkYXRhc2V0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeUNvbnRlbnRzLmFqYXhRdWV1ZShhY3Rpb24sIHt9LCBzZWxlY3RlZERhdGFzZXRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWN0aW9ucyA9IGFjdGlvbnMuY29uY2F0KHBhbmVsLl9jb2xsZWN0aW9uQWN0aW9ucygpKTtcbiAgICAgICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiAgICovXG4gICAgICAgIF9jb2xsZWN0aW9uQWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGh0bWw6IF9sKFwiQnVpbGQgRGF0YXNldCBMaXN0XCIpLFxuICAgICAgICAgICAgICAgICAgICBmdW5jOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLmJ1aWxkQ29sbGVjdGlvbihcImxpc3RcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIFRPRE86IE9ubHkgc2hvdyBxdWljayBwYWlyIGlmIHR3byB0aGluZ3Mgc2VsZWN0ZWQuXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBodG1sOiBfbChcIkJ1aWxkIERhdGFzZXQgUGFpclwiKSxcbiAgICAgICAgICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbC5idWlsZENvbGxlY3Rpb24oXCJwYWlyZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaHRtbDogX2woXCJCdWlsZCBMaXN0IG9mIERhdGFzZXQgUGFpcnNcIiksXG4gICAgICAgICAgICAgICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuYnVpbGRDb2xsZWN0aW9uKFwibGlzdDpwYWlyZWRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuICAgICAgICB9LFxuXG4gICAgICAgIGJ1aWxkQ29sbGVjdGlvbjogZnVuY3Rpb24oY29sbGVjdGlvblR5cGUsIHNlbGVjdGlvbiwgaGlkZVNvdXJjZUl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IHNlbGVjdGlvbiB8fCBwYW5lbC5nZXRTZWxlY3RlZE1vZGVscygpO1xuICAgICAgICAgICAgdmFyIGhpZGVTb3VyY2VJdGVtcyA9IGhpZGVTb3VyY2VJdGVtcyB8fCBmYWxzZTtcbiAgICAgICAgICAgIHZhciBjcmVhdGVGdW5jO1xuICAgICAgICAgICAgaWYgKGNvbGxlY3Rpb25UeXBlID09IFwibGlzdFwiKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlRnVuYyA9IExJU1RfQ09MTEVDVElPTl9DUkVBVE9SLmNyZWF0ZUxpc3RDb2xsZWN0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uVHlwZSA9PSBcInBhaXJlZFwiKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlRnVuYyA9IFBBSVJfQ09MTEVDVElPTl9DUkVBVE9SLmNyZWF0ZVBhaXJDb2xsZWN0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uVHlwZSA9PSBcImxpc3Q6cGFpcmVkXCIpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVGdW5jID0gTElTVF9PRl9QQUlSU19DT0xMRUNUSU9OX0NSRUFUT1IuY3JlYXRlTGlzdE9mUGFpcnNDb2xsZWN0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVua25vd24gY29sbGVjdGlvblR5cGUgZW5jb3VudGVyZWQgJHtjb2xsZWN0aW9uVHlwZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNyZWF0ZUZ1bmMoc2VsZWN0aW9uLCBoaWRlU291cmNlSXRlbXMpLmRvbmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHBhbmVsLm1vZGVsLnJlZnJlc2goKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzdWItdmlld3NcbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGFkZCBwdXJnZUFsbG93ZWQgYW5kIHdoZXRoZXIgdGFncy9hbm5vdGF0aW9uIGVkaXRvcnMgc2hvdWxkIGJlIHNob3duICovXG4gICAgICAgIF9nZXRJdGVtVmlld09wdGlvbnM6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IF9zdXBlci5wcm90b3R5cGUuX2dldEl0ZW1WaWV3T3B0aW9ucy5jYWxsKHRoaXMsIG1vZGVsKTtcbiAgICAgICAgICAgIF8uZXh0ZW5kKG9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICBwdXJnZUFsbG93ZWQ6IHRoaXMucHVyZ2VBbGxvd2VkLFxuICAgICAgICAgICAgICAgIHRhZ3NFZGl0b3JTaG93bjogdGhpcy50YWdzRWRpdG9yICYmICF0aGlzLnRhZ3NFZGl0b3IuaGlkZGVuLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb25FZGl0b3JTaG93bjogdGhpcy5hbm5vdGF0aW9uRWRpdG9yICYmICF0aGlzLmFubm90YXRpb25FZGl0b3IuaGlkZGVuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBJZiB0aGlzIGl0ZW0gaXMgZGVsZXRlZCBhbmQgd2UncmUgbm90IHNob3dpbmcgZGVsZXRlZCBpdGVtcywgcmVtb3ZlIHRoZSB2aWV3XG4gICAgICAgICAqICBAcGFyYW0ge01vZGVsfSB0aGUgaXRlbSBtb2RlbCB0byBjaGVja1xuICAgICAgICAgKi9cbiAgICAgICAgX2hhbmRsZUl0ZW1EZWxldGVkQ2hhbmdlOiBmdW5jdGlvbihpdGVtTW9kZWwpIHtcbiAgICAgICAgICAgIGlmIChpdGVtTW9kZWwuZ2V0KFwiZGVsZXRlZFwiKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUl0ZW1EZWxldGlvbihpdGVtTW9kZWwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVJdGVtVW5kZWxldGlvbihpdGVtTW9kZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyQ291bnRzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2hhbmRsZUl0ZW1EZWxldGlvbjogZnVuY3Rpb24oaXRlbU1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgY29udGVudHNTaG93biA9IHRoaXMubW9kZWwuZ2V0KFwiY29udGVudHNfYWN0aXZlXCIpO1xuICAgICAgICAgICAgY29udGVudHNTaG93bi5kZWxldGVkICs9IDE7XG4gICAgICAgICAgICBjb250ZW50c1Nob3duLmFjdGl2ZSAtPSAxO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1vZGVsLmNvbnRlbnRzLmluY2x1ZGVEZWxldGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVJdGVtVmlldyhpdGVtTW9kZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tb2RlbC5zZXQoXCJjb250ZW50c19hY3RpdmVcIiwgY29udGVudHNTaG93bik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2hhbmRsZUl0ZW1VbmRlbGV0aW9uOiBmdW5jdGlvbihpdGVtTW9kZWwpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50c1Nob3duID0gdGhpcy5tb2RlbC5nZXQoXCJjb250ZW50c19hY3RpdmVcIik7XG4gICAgICAgICAgICBjb250ZW50c1Nob3duLmRlbGV0ZWQgLT0gMTtcbiAgICAgICAgICAgIGlmICghdGhpcy5tb2RlbC5jb250ZW50cy5pbmNsdWRlRGVsZXRlZCkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnRzU2hvd24uYWN0aXZlIC09IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1vZGVsLnNldChcImNvbnRlbnRzX2FjdGl2ZVwiLCBjb250ZW50c1Nob3duKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSWYgdGhpcyBpdGVtIGlzIGhpZGRlbiBhbmQgd2UncmUgbm90IHNob3dpbmcgaGlkZGVuIGl0ZW1zLCByZW1vdmUgdGhlIHZpZXdcbiAgICAgICAgICogIEBwYXJhbSB7TW9kZWx9IHRoZSBpdGVtIG1vZGVsIHRvIGNoZWNrXG4gICAgICAgICAqL1xuICAgICAgICBfaGFuZGxlSXRlbVZpc2libGVDaGFuZ2U6IGZ1bmN0aW9uKGl0ZW1Nb2RlbCkge1xuICAgICAgICAgICAgaWYgKGl0ZW1Nb2RlbC5oaWRkZW4oKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUl0ZW1IaWRkZW4oaXRlbU1vZGVsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlSXRlbVVuaGlkZGVuKGl0ZW1Nb2RlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJDb3VudHMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBfaGFuZGxlSXRlbUhpZGRlbjogZnVuY3Rpb24oaXRlbU1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgY29udGVudHNTaG93biA9IHRoaXMubW9kZWwuZ2V0KFwiY29udGVudHNfYWN0aXZlXCIpO1xuICAgICAgICAgICAgY29udGVudHNTaG93bi5oaWRkZW4gKz0gMTtcbiAgICAgICAgICAgIGNvbnRlbnRzU2hvd24uYWN0aXZlIC09IDE7XG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwuY29udGVudHMuaW5jbHVkZUhpZGRlbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbVZpZXcoaXRlbU1vZGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubW9kZWwuc2V0KFwiY29udGVudHNfYWN0aXZlXCIsIGNvbnRlbnRzU2hvd24pO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9oYW5kbGVJdGVtVW5oaWRkZW46IGZ1bmN0aW9uKGl0ZW1Nb2RlbCkge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRzU2hvd24gPSB0aGlzLm1vZGVsLmdldChcImNvbnRlbnRzX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgIGNvbnRlbnRzU2hvd24uaGlkZGVuIC09IDE7XG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwuY29udGVudHMuaW5jbHVkZUhpZGRlbikge1xuICAgICAgICAgICAgICAgIGNvbnRlbnRzU2hvd24uYWN0aXZlIC09IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1vZGVsLnNldChcImNvbnRlbnRzX2FjdGl2ZVwiLCBjb250ZW50c1Nob3duKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogdG9nZ2xlIHRoZSB2aXNpYmlsaXR5IG9mIGVhY2ggY29udGVudCdzIHRhZ3NFZGl0b3IgYXBwbHlpbmcgYWxsIHRoZSBhcmdzIHNlbnQgdG8gdGhpcyBmdW5jdGlvbiAqL1xuICAgICAgICB0b2dnbGVIREFUYWdFZGl0b3JzOiBmdW5jdGlvbihzaG93T3JIaWRlLCBzcGVlZCkge1xuICAgICAgICAgICAgXy5lYWNoKHRoaXMudmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2aWV3LnRhZ3NFZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy50YWdzRWRpdG9yLnRvZ2dsZShzaG93T3JIaWRlLCBzcGVlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHRvZ2dsZSB0aGUgdmlzaWJpbGl0eSBvZiBlYWNoIGNvbnRlbnQncyBhbm5vdGF0aW9uRWRpdG9yIGFwcGx5aW5nIGFsbCB0aGUgYXJncyBzZW50IHRvIHRoaXMgZnVuY3Rpb24gKi9cbiAgICAgICAgdG9nZ2xlSERBQW5ub3RhdGlvbkVkaXRvcnM6IGZ1bmN0aW9uKHNob3dPckhpZGUsIHNwZWVkKSB7XG4gICAgICAgICAgICBfLmVhY2godGhpcy52aWV3cywgdmlldyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZpZXcuYW5ub3RhdGlvbkVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmFubm90YXRpb25FZGl0b3IudG9nZ2xlKHNob3dPckhpZGUsIHNwZWVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcGFuZWwgZXZlbnRzXG4gICAgICAgIC8qKiBldmVudCBtYXAgKi9cbiAgICAgICAgZXZlbnRzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUuZXZlbnRzKSwge1xuICAgICAgICAgICAgXCJjbGljayAuc2hvdy1zZWxlY3RvcnMtYnRuXCI6IFwidG9nZ2xlU2VsZWN0b3JzXCIsXG4gICAgICAgICAgICBcImNsaWNrIC50b2dnbGUtZGVsZXRlZC1saW5rXCI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVTaG93RGVsZXRlZCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLnRvZ2dsZS1oaWRkZW4tbGlua1wiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlU2hvd0hpZGRlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gc2VhcmNoXG4gICAgICAgIF9yZW5kZXJTZWFyY2hQcm9ncmVzczogZnVuY3Rpb24obGltaXQsIG9mZnNldCkge1xuICAgICAgICAgICAgdmFyIHN0b3AgPSBsaW1pdCArIG9mZnNldDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiQoXCI+IC5jb250cm9scyAuc3VidGl0bGVcIikuaHRtbChcbiAgICAgICAgICAgICAgICBbXCI8aT5cIiwgX2woXCJTZWFyY2hpbmcgXCIpLCBzdG9wLCBcIi9cIiwgdGhpcy5tb2RlbC5jb250ZW50c1Nob3duKCksIFwiPC9pPlwiXS5qb2luKFwiXCIpXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBvdmVycmlkZSB0byBkaXNwbGF5IG51bWJlciBmb3VuZCBpbiBzdWJ0aXRsZSAqL1xuICAgICAgICBfcmVuZGVyU2VhcmNoRmluZGluZ3M6IGZ1bmN0aW9uKCR3aGVyZVRvKSB7XG4gICAgICAgICAgICAkd2hlcmVUbyA9ICR3aGVyZVRvIGluc3RhbmNlb2YgalF1ZXJ5ID8gJHdoZXJlVG8gOiB0aGlzLiRlbDtcbiAgICAgICAgICAgIHZhciBodG1sID0gdGhpcy50ZW1wbGF0ZXMuZm91bmQodGhpcy5tb2RlbC50b0pTT04oKSwgdGhpcyk7XG4gICAgICAgICAgICAkd2hlcmVUby5maW5kKFwiPiAuY29udHJvbHMgLnN1YnRpdGxlXCIpLmh0bWwoaHRtbCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYXMgZHJvcCB0YXJnZXRcbiAgICAgICAgLyoqIHR1cm4gYWxsIHRoZSBkcmFnIGFuZCBkcm9wIGhhbmRsZXJzIG9uIGFuZCBhZGQgc29tZSBoZWxwIHRleHQgYWJvdmUgdGhlIGRyb3AgYXJlYSAqL1xuICAgICAgICBkcm9wVGFyZ2V0T246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJvcFRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kcm9wVGFyZ2V0ID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy9UT0RPOiB0byBpbml0XG4gICAgICAgICAgICB2YXIgZHJvcEhhbmRsZXJzID0ge1xuICAgICAgICAgICAgICAgIGRyYWdlbnRlcjogXy5iaW5kKHRoaXMuZHJhZ2VudGVyLCB0aGlzKSxcbiAgICAgICAgICAgICAgICBkcmFnb3ZlcjogXy5iaW5kKHRoaXMuZHJhZ292ZXIsIHRoaXMpLFxuICAgICAgICAgICAgICAgIGRyYWdsZWF2ZTogXy5iaW5kKHRoaXMuZHJhZ2xlYXZlLCB0aGlzKSxcbiAgICAgICAgICAgICAgICBkcm9wOiBfLmJpbmQodGhpcy5kcm9wLCB0aGlzKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyICRkcm9wVGFyZ2V0ID0gdGhpcy5fcmVuZGVyRHJvcFRhcmdldCgpO1xuICAgICAgICAgICAgdGhpcy4kbGlzdCgpLmJlZm9yZShbdGhpcy5fcmVuZGVyRHJvcFRhcmdldEhlbHAoKSwgJGRyb3BUYXJnZXRdKTtcbiAgICAgICAgICAgIGZvciAodmFyIGV2TmFtZSBpbiBkcm9wSGFuZGxlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZHJvcEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmRlYnVnKCBldk5hbWUsIGRyb3BIYW5kbGVyc1sgZXZOYW1lIF0gKTtcbiAgICAgICAgICAgICAgICAgICAgJGRyb3BUYXJnZXQub24oZXZOYW1lLCBkcm9wSGFuZGxlcnNbZXZOYW1lXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciBhIGJveCB0byBzZXJ2ZSBhcyBhICdkcm9wIGhlcmUnIGFyZWEgb24gdGhlIGhpc3RvcnkgKi9cbiAgICAgICAgX3JlbmRlckRyb3BUYXJnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy4kKFwiLmhpc3RvcnktZHJvcC10YXJnZXRcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICByZXR1cm4gJChcIjxkaXYvPlwiKS5hZGRDbGFzcyhcImhpc3RvcnktZHJvcC10YXJnZXRcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHRlbGwgdGhlIHVzZXIgaG93IGl0IHdvcmtzICAqL1xuICAgICAgICBfcmVuZGVyRHJvcFRhcmdldEhlbHA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy4kKFwiLmhpc3RvcnktZHJvcC10YXJnZXQtaGVscFwiKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHJldHVybiAkKFwiPGRpdi8+XCIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiaGlzdG9yeS1kcm9wLXRhcmdldC1oZWxwXCIpXG4gICAgICAgICAgICAgICAgLnRleHQoX2woXCJEcmFnIGRhdGFzZXRzIGhlcmUgdG8gY29weSB0aGVtIHRvIHRoZSBjdXJyZW50IGhpc3RvcnlcIikpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBzaHV0IGRvd24gZHJhZyBhbmQgZHJvcCBldmVudCBoYW5kbGVycyBhbmQgcmVtb3ZlIGRyb3AgdGFyZ2V0ICovXG4gICAgICAgIGRyb3BUYXJnZXRPZmY6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmRyb3BUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vdGhpcy5sb2coICdkcm9wVGFyZ2V0T2ZmJyApO1xuICAgICAgICAgICAgdGhpcy5kcm9wVGFyZ2V0ID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgZHJvcFRhcmdldCA9IHRoaXMuJChcIi5oaXN0b3J5LWRyb3AtdGFyZ2V0XCIpLmdldCgwKTtcbiAgICAgICAgICAgIGZvciAodmFyIGV2TmFtZSBpbiB0aGlzLl9kcm9wSGFuZGxlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZHJvcEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcFRhcmdldC5vZmYoZXZOYW1lLCB0aGlzLl9kcm9wSGFuZGxlcnNbZXZOYW1lXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy4kKFwiLmhpc3RvcnktZHJvcC10YXJnZXRcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLiQoXCIuaGlzdG9yeS1kcm9wLXRhcmdldC1oZWxwXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiB0b2dnbGUgdGhlIHRhcmdldCBvbi9vZmYgKi9cbiAgICAgICAgZHJvcFRhcmdldFRvZ2dsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5kcm9wVGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcm9wVGFyZ2V0T2ZmKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJvcFRhcmdldE9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICBkcmFnZW50ZXI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUuZGVidWcoICdkcmFnZW50ZXI6JywgdGhpcywgZXYgKTtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5oaXN0b3J5LWRyb3AtdGFyZ2V0XCIpLmNzcyhcImJvcmRlclwiLCBcIjJweCBzb2xpZCBibGFja1wiKTtcbiAgICAgICAgfSxcbiAgICAgICAgZHJhZ292ZXI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGRyYWdsZWF2ZTogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZyggJ2RyYWdsZWF2ZTonLCB0aGlzLCBldiApO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdGhpcy4kKFwiLmhpc3RvcnktZHJvcC10YXJnZXRcIikuY3NzKFwiYm9yZGVyXCIsIFwiMXB4IGRhc2hlZCBibGFja1wiKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIHdoZW4gKHRleHQpIGlzIGRyb3BwZWQgdHJ5IHRvIHBhcnNlIGFzIGpzb24gYW5kIHRyaWdnZXIgYW4gZXZlbnQgKi9cbiAgICAgICAgZHJvcDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAvL2V2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZGF0YVRyYW5zZmVyID0gZXYub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXI7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGRhdGFUcmFuc2Zlci5nZXREYXRhKFwidGV4dFwiKTtcblxuICAgICAgICAgICAgZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSBcIm1vdmVcIjtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLndhcm4oXCJlcnJvciBwYXJzaW5nIEpTT04gZnJvbSBkcm9wOlwiLCBkYXRhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VsZi50cmlnZ2VyKFwiZHJvcHRhcmdldDpkcm9wXCIsIGV2LCBkYXRhLCBzZWxmKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGFuZGxlciB0aGF0IGNvcGllcyBkYXRhIGludG8gdGhlIGNvbnRlbnRzICovXG4gICAgICAgIGRhdGFEcm9wcGVkOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAvLyBIREE6IGRyb3BwaW5nIHdpbGwgY29weSBpdCB0byB0aGUgaGlzdG9yeVxuICAgICAgICAgICAgaWYgKF8uaXNPYmplY3QoZGF0YSkgJiYgZGF0YS5tb2RlbF9jbGFzcyA9PT0gXCJIaXN0b3J5RGF0YXNldEFzc29jaWF0aW9uXCIgJiYgZGF0YS5pZCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbnRlbnRzLmN1cnJlbnRQYWdlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmNvbnRlbnRzLmZldGNoUGFnZSgwKS50aGVuKCgpID0+IHNlbGYubW9kZWwuY29udGVudHMuY29weShkYXRhLmlkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLm1vZGVsLmNvbnRlbnRzLmNvcHkoZGF0YS5pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogUmV0dXJuIGEgc3RyaW5nIHJlcCBvZiB0aGUgaGlzdG9yeSAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gYEhpc3RvcnlWaWV3RWRpdCgke3RoaXMubW9kZWwgPyB0aGlzLm1vZGVsLmdldChcIm5hbWVcIikgOiBcIlwifSlgO1xuICAgICAgICB9XG4gICAgfVxuKTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gVEVNUExBVEVTXG5IaXN0b3J5Vmlld0VkaXQucHJvdG90eXBlLnRlbXBsYXRlcyA9ICgoKSA9PiB7XG4gICAgdmFyIGNvdW50c1RlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICBcIjwlIHZhciBzaG93biA9IE1hdGgubWF4KCB2aWV3LnZpZXdzLmxlbmd0aCwgaGlzdG9yeS5jb250ZW50c19hY3RpdmUuYWN0aXZlICkgJT5cIixcbiAgICAgICAgICAgIFwiPCUgaWYoIHNob3duICl7ICU+XCIsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJzaG93bi1jb3VudFwiPicsXG4gICAgICAgICAgICBcIjwlLSBzaG93biAlPiBcIixcbiAgICAgICAgICAgIF9sKFwic2hvd25cIiksXG4gICAgICAgICAgICBcIjwvc3Bhbj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuXG4gICAgICAgICAgICBcIjwlIGlmKCBoaXN0b3J5LmNvbnRlbnRzX2FjdGl2ZS5kZWxldGVkICl7ICU+XCIsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJkZWxldGVkLWNvdW50XCI+JyxcbiAgICAgICAgICAgIFwiPCUgaWYoIHZpZXcubW9kZWwuY29udGVudHMuaW5jbHVkZURlbGV0ZWQgKXsgJT5cIixcbiAgICAgICAgICAgICc8YSBjbGFzcz1cInRvZ2dsZS1kZWxldGVkLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICBfbChcImhpZGUgZGVsZXRlZFwiKSxcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgXCI8JSB9IGVsc2UgeyAlPlwiLFxuICAgICAgICAgICAgXCI8JS0gaGlzdG9yeS5jb250ZW50c19hY3RpdmUuZGVsZXRlZCAlPiBcIixcbiAgICAgICAgICAgICc8YSBjbGFzcz1cInRvZ2dsZS1kZWxldGVkLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICBfbChcImRlbGV0ZWRcIiksXG4gICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuICAgICAgICAgICAgXCI8L3NwYW4+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIixcblxuICAgICAgICAgICAgXCI8JSBpZiggaGlzdG9yeS5jb250ZW50c19hY3RpdmUuaGlkZGVuICl7ICU+XCIsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJoaWRkZW4tY291bnRcIj4nLFxuICAgICAgICAgICAgXCI8JSBpZiggdmlldy5tb2RlbC5jb250ZW50cy5pbmNsdWRlSGlkZGVuICl7ICU+XCIsXG4gICAgICAgICAgICAnPGEgY2xhc3M9XCJ0b2dnbGUtaGlkZGVuLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICBfbChcImhpZGUgaGlkZGVuXCIpLFxuICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICBcIjwlIH0gZWxzZSB7ICU+XCIsXG4gICAgICAgICAgICBcIjwlLSBoaXN0b3J5LmNvbnRlbnRzX2FjdGl2ZS5oaWRkZW4gJT4gXCIsXG4gICAgICAgICAgICAnPGEgY2xhc3M9XCJ0b2dnbGUtaGlkZGVuLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICBfbChcImhpZGRlblwiKSxcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICBcIjwvc3Bhbj5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgIF0sXG4gICAgICAgIFwiaGlzdG9yeVwiXG4gICAgKTtcblxuICAgIHZhciBmb3VuZFRlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICBfbChcIkZvdW5kXCIpLFxuICAgICAgICAgICAgXCIgPCUtIHZpZXcudmlld3MubGVuZ3RoICU+LCBcIixcblxuICAgICAgICAgICAgXCI8JSBpZiggaGlzdG9yeS5jb250ZW50c19hY3RpdmUuZGVsZXRlZCApeyAlPlwiLFxuICAgICAgICAgICAgXCI8JSBpZiggdmlldy5tb2RlbC5jb250ZW50cy5pbmNsdWRlRGVsZXRlZCApeyAlPlwiLFxuICAgICAgICAgICAgJzxhIGNsYXNzPVwidG9nZ2xlLWRlbGV0ZWQtbGlua1wiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgIF9sKFwiaGlkZSBkZWxldGVkXCIpLFxuICAgICAgICAgICAgXCI8L2E+LCBcIixcbiAgICAgICAgICAgIFwiPCUgfSBlbHNlIHsgJT5cIixcbiAgICAgICAgICAgICc8YSBjbGFzcz1cInRvZ2dsZS1kZWxldGVkLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICBfbChcInNob3cgZGVsZXRlZFwiKSxcbiAgICAgICAgICAgIFwiPC9hPiwgXCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIixcbiAgICAgICAgICAgIFwiPCUgfSAlPlwiLFxuXG4gICAgICAgICAgICBcIjwlIGlmKCBoaXN0b3J5LmNvbnRlbnRzX2FjdGl2ZS5oaWRkZW4gKXsgJT5cIixcbiAgICAgICAgICAgIFwiPCUgaWYoIHZpZXcubW9kZWwuY29udGVudHMuaW5jbHVkZUhpZGRlbiApeyAlPlwiLFxuICAgICAgICAgICAgJzxhIGNsYXNzPVwidG9nZ2xlLWhpZGRlbi1saW5rXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4nLFxuICAgICAgICAgICAgX2woXCJoaWRlIGhpZGRlblwiKSxcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgXCI8JSB9IGVsc2UgeyAlPlwiLFxuICAgICAgICAgICAgJzxhIGNsYXNzPVwidG9nZ2xlLWhpZGRlbi1saW5rXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4nLFxuICAgICAgICAgICAgX2woXCJzaG93IGhpZGRlblwiKSxcbiAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICBcIjwlIH0gJT5cIlxuICAgICAgICBdLFxuICAgICAgICBcImhpc3RvcnlcIlxuICAgICk7XG5cbiAgICByZXR1cm4gXy5leHRlbmQoXy5jbG9uZShfc3VwZXIucHJvdG90eXBlLnRlbXBsYXRlcyksIHtcbiAgICAgICAgY291bnRzOiBjb3VudHNUZW1wbGF0ZSxcbiAgICAgICAgZm91bmQ6IGZvdW5kVGVtcGxhdGVcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSGlzdG9yeVZpZXdFZGl0OiBIaXN0b3J5Vmlld0VkaXRcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGlzdG9yeS12aWV3LWVkaXQuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZEE7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBYkE7QUFtQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFiQTtBQW1CQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQWFBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBWkE7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFqaUJBO0FBQ0E7QUFvaUJBO0FBQ0E7QUFDQTtBQUNBO0FBMENBO0FBQ0E7QUErQkE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///72\n");

/***/ }),
/* 73 */
/*!***************************************************!*\
  !*** ./galaxy/scripts/mvc/history/hda-li-edit.js ***!
  \***************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _datasetLiEdit = __webpack_require__(/*! mvc/dataset/dataset-li-edit */ 61);\n\nvar _datasetLiEdit2 = _interopRequireDefault(_datasetLiEdit);\n\nvar _hdaLi = __webpack_require__(/*! mvc/history/hda-li */ 41);\n\nvar _hdaLi2 = _interopRequireDefault(_hdaLi);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _datasetLiEdit2.default.DatasetListItemEdit;\n/** @class Editing view for HistoryDatasetAssociation.\n */\nvar HDAListItemEdit = _super.extend(\n/** @lends HDAListItemEdit.prototype */{\n    className: _super.prototype.className + \" history-content\",\n\n    /** In this override, only get details if in the ready state, get rerunnable if in other states.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails: function _fetchModelDetails() {\n        var view = this;\n        if (view.model.inReadyState() && !view.model.hasDetails()) {\n            return view.model.fetch({ silent: true });\n\n            // special case the need for the rerunnable and creating_job attributes\n            // needed for rendering re-run button on queued, running datasets\n        } else if (!view.model.has(\"rerunnable\")) {\n            return view.model.fetch({\n                silent: true,\n                data: {\n                    // only fetch rerunnable and creating_job to keep overhead down\n                    keys: [\"rerunnable\", \"creating_job\"].join(\",\")\n                }\n            });\n        }\n        return jQuery.when();\n    },\n\n    /** event map */\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .unhide-link\": function clickUnhideLink(ev) {\n            this.model.unhide();\n            return false;\n        }\n    }),\n\n    /** string rep */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"HDAListItemEdit(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nHDAListItemEdit.prototype.templates = function () {\n    var warnings = _.extend({}, _super.prototype.templates.warnings, {\n        hidden: _baseMvc2.default.wrapTemplate([\"<% if( !dataset.visible ){ %>\",\n        // add a link to unhide a dataset\n        '<div class=\"hidden-msg warningmessagesmall\">', (0, _localization2.default)(\"This dataset has been hidden\"), '<br /><a class=\"unhide-link\" a href=\"javascript:void(0);\">', (0, _localization2.default)(\"Unhide it\"), \"</a>\", \"</div>\", \"<% } %>\"], \"dataset\")\n    });\n\n    return _.extend({}, _super.prototype.templates, {\n        //NOTE: *steal* the HDAListItemView titleBar\n        titleBar: _hdaLi2.default.HDAListItemView.prototype.templates.titleBar,\n        warnings: warnings\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    HDAListItemEdit: HDAListItemEdit\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRhLWxpLWVkaXQuanM/ZmJjOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgREFUQVNFVF9MSV9FRElUIGZyb20gXCJtdmMvZGF0YXNldC9kYXRhc2V0LWxpLWVkaXRcIjtcbmltcG9ydCBIREFfTEkgZnJvbSBcIm12Yy9oaXN0b3J5L2hkYS1saVwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgX3N1cGVyID0gREFUQVNFVF9MSV9FRElULkRhdGFzZXRMaXN0SXRlbUVkaXQ7XG4vKiogQGNsYXNzIEVkaXRpbmcgdmlldyBmb3IgSGlzdG9yeURhdGFzZXRBc3NvY2lhdGlvbi5cbiAqL1xudmFyIEhEQUxpc3RJdGVtRWRpdCA9IF9zdXBlci5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBIREFMaXN0SXRlbUVkaXQucHJvdG90eXBlICovIHtcbiAgICAgICAgY2xhc3NOYW1lOiBgJHtfc3VwZXIucHJvdG90eXBlLmNsYXNzTmFtZX0gaGlzdG9yeS1jb250ZW50YCxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgb25seSBnZXQgZGV0YWlscyBpZiBpbiB0aGUgcmVhZHkgc3RhdGUsIGdldCByZXJ1bm5hYmxlIGlmIGluIG90aGVyIHN0YXRlcy5cbiAgICAgICAgICogIE5vdGU6IGZldGNoIHdpdGggbm8gJ2NoYW5nZScgZXZlbnQgdHJpZ2dlcmluZyB0byBwcmV2ZW50IGF1dG9tYXRpYyByZW5kZXJpbmcuXG4gICAgICAgICAqL1xuICAgICAgICBfZmV0Y2hNb2RlbERldGFpbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHZpZXcubW9kZWwuaW5SZWFkeVN0YXRlKCkgJiYgIXZpZXcubW9kZWwuaGFzRGV0YWlscygpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcubW9kZWwuZmV0Y2goeyBzaWxlbnQ6IHRydWUgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2UgdGhlIG5lZWQgZm9yIHRoZSByZXJ1bm5hYmxlIGFuZCBjcmVhdGluZ19qb2IgYXR0cmlidXRlc1xuICAgICAgICAgICAgICAgIC8vIG5lZWRlZCBmb3IgcmVuZGVyaW5nIHJlLXJ1biBidXR0b24gb24gcXVldWVkLCBydW5uaW5nIGRhdGFzZXRzXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCF2aWV3Lm1vZGVsLmhhcyhcInJlcnVubmFibGVcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlldy5tb2RlbC5mZXRjaCh7XG4gICAgICAgICAgICAgICAgICAgIHNpbGVudDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25seSBmZXRjaCByZXJ1bm5hYmxlIGFuZCBjcmVhdGluZ19qb2IgdG8ga2VlcCBvdmVyaGVhZCBkb3duXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlzOiBbXCJyZXJ1bm5hYmxlXCIsIFwiY3JlYXRpbmdfam9iXCJdLmpvaW4oXCIsXCIpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBqUXVlcnkud2hlbigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBldmVudCBtYXAgKi9cbiAgICAgICAgZXZlbnRzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUuZXZlbnRzKSwge1xuICAgICAgICAgICAgXCJjbGljayAudW5oaWRlLWxpbmtcIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLnVuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksXG5cbiAgICAgICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBIREFMaXN0SXRlbUVkaXQoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gVEVNUExBVEVTXG4vKiogdW5kZXJzY29yZSB0ZW1wbGF0ZXMgKi9cbkhEQUxpc3RJdGVtRWRpdC5wcm90b3R5cGUudGVtcGxhdGVzID0gKCgpID0+IHtcbiAgICB2YXIgd2FybmluZ3MgPSBfLmV4dGVuZCh7fSwgX3N1cGVyLnByb3RvdHlwZS50ZW1wbGF0ZXMud2FybmluZ3MsIHtcbiAgICAgICAgaGlkZGVuOiBCQVNFX01WQy53cmFwVGVtcGxhdGUoXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgXCI8JSBpZiggIWRhdGFzZXQudmlzaWJsZSApeyAlPlwiLFxuICAgICAgICAgICAgICAgIC8vIGFkZCBhIGxpbmsgdG8gdW5oaWRlIGEgZGF0YXNldFxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGlkZGVuLW1zZyB3YXJuaW5nbWVzc2FnZXNtYWxsXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlRoaXMgZGF0YXNldCBoYXMgYmVlbiBoaWRkZW5cIiksXG4gICAgICAgICAgICAgICAgJzxiciAvPjxhIGNsYXNzPVwidW5oaWRlLWxpbmtcIiBhIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlVuaGlkZSBpdFwiKSxcbiAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgIFwiPCUgfSAlPlwiXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgXCJkYXRhc2V0XCJcbiAgICAgICAgKVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIF8uZXh0ZW5kKHt9LCBfc3VwZXIucHJvdG90eXBlLnRlbXBsYXRlcywge1xuICAgICAgICAvL05PVEU6ICpzdGVhbCogdGhlIEhEQUxpc3RJdGVtVmlldyB0aXRsZUJhclxuICAgICAgICB0aXRsZUJhcjogSERBX0xJLkhEQUxpc3RJdGVtVmlldy5wcm90b3R5cGUudGVtcGxhdGVzLnRpdGxlQmFyLFxuICAgICAgICB3YXJuaW5nczogd2FybmluZ3NcbiAgICB9KTtcbn0pKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSERBTGlzdEl0ZW1FZGl0OiBIREFMaXN0SXRlbUVkaXRcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRhLWxpLWVkaXQuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFGQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQ0E7QUFDQTtBQXdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUxBO0FBQ0E7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///73\n");

/***/ }),
/* 74 */
/*!******************************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/pair-collection-creator.js ***!
  \******************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _listCollectionCreator = __webpack_require__(/*! mvc/collection/list-collection-creator */ 29);\n\nvar _listCollectionCreator2 = _interopRequireDefault(_listCollectionCreator);\n\nvar _hdcaModel = __webpack_require__(/*! mvc/history/hdca-model */ 20);\n\nvar _hdcaModel2 = _interopRequireDefault(_hdcaModel);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"collections\";\n/*==============================================================================\nTODO:\n    the paired creator doesn't really mesh with the list creator as parent\n        it may be better to make an abstract super class for both\n    composites may inherit from this (or vis-versa)\n    PairedDatasetCollectionElementView doesn't make a lot of sense\n\n==============================================================================*/\n/**  */\nvar PairedDatasetCollectionElementView = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: logNamespace,\n\n    //TODO: use proper class (DatasetDCE or NestedDCDCE (or the union of both))\n    tagName: \"li\",\n    className: \"collection-element\",\n\n    initialize: function initialize(attributes) {\n        this.element = attributes.element || {};\n        this.identifier = attributes.identifier;\n    },\n\n    render: function render() {\n        this.$el.attr(\"data-element-id\", this.element.id).html(this.template({\n            identifier: this.identifier,\n            element: this.element\n        }));\n        return this;\n    },\n\n    //TODO: lots of unused space in the element - possibly load details and display them horiz.\n    template: _.template(['<span class=\"identifier\"><%- identifier %></span>', '<span class=\"name\"><%- element.name %></span>'].join(\"\")),\n\n    /** remove the DOM and any listeners */\n    destroy: function destroy() {\n        this.off();\n        this.$el.remove();\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return \"DatasetCollectionElementView()\";\n    }\n});\n\n// ============================================================================\nvar _super = _listCollectionCreator2.default.ListCollectionCreator;\n\n/** An interface for building collections.\n */\nvar PairCollectionCreator = _super.extend({\n    /** the class used to display individual elements */\n    elementViewClass: PairedDatasetCollectionElementView,\n    /** the class this creator will create and save */\n    collectionClass: _hdcaModel2.default.HistoryDatasetCollection,\n    className: \"pair-collection-creator collection-creator flex-row-container\",\n\n    /** override to no-op */\n    _mangleDuplicateNames: function _mangleDuplicateNames() {},\n\n    // TODO: this whole pattern sucks. There needs to be two classes of problem area:\n    //      bad inital choices and\n    //      when the user has painted his/her self into a corner during creation/use-of-the-creator\n    /** render the entire interface */\n    render: function render(speed, callback) {\n        if (this.workingElements.length === 2) {\n            return _super.prototype.render.call(this, speed, callback);\n        }\n        return this._renderInvalid(speed, callback);\n    },\n\n    // ------------------------------------------------------------------------ rendering elements\n    /** render forward/reverse */\n    _renderList: function _renderList(speed, callback) {\n        //this.debug( '-- _renderList' );\n        //precondition: there are two valid elements in workingElements\n        var creator = this;\n\n        var $tmp = jQuery(\"<div/>\");\n        var $list = creator.$list();\n\n        // lose the original views, create the new, append all at once, then call their renders\n        _.each(this.elementViews, function (view) {\n            view.destroy();\n            creator.removeElementView(view);\n        });\n        $tmp.append(creator._createForwardElementView().$el);\n        $tmp.append(creator._createReverseElementView().$el);\n        $list.empty().append($tmp.children());\n        _.invoke(creator.elementViews, \"render\");\n    },\n\n    /** create the forward element view */\n    _createForwardElementView: function _createForwardElementView() {\n        return this._createElementView(this.workingElements[0], {\n            identifier: \"forward\"\n        });\n    },\n\n    /** create the forward element view */\n    _createReverseElementView: function _createReverseElementView() {\n        return this._createElementView(this.workingElements[1], {\n            identifier: \"reverse\"\n        });\n    },\n\n    /** create an element view, cache in elementViews, and return */\n    _createElementView: function _createElementView(element, options) {\n        var elementView = new this.elementViewClass(_.extend(options, {\n            element: element\n        }));\n        this.elementViews.push(elementView);\n        return elementView;\n    },\n\n    /** swap the forward, reverse elements and re-render */\n    swap: function swap() {\n        this.workingElements = [this.workingElements[1], this.workingElements[0]];\n        this._renderList();\n    },\n\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .swap\": \"swap\"\n    }),\n\n    // ------------------------------------------------------------------------ templates\n    //TODO: move to require text plugin and load these as text\n    //TODO: underscore currently unnecc. bc no vars are used\n    //TODO: better way of localizing text-nodes in long strings\n    /** underscore template fns attached to class */\n    templates: _.extend(_.clone(_super.prototype.templates), {\n        /** the middle: element list */\n        middle: _.template(['<div class=\"collection-elements-controls\">', '<a class=\"swap\" href=\"javascript:void(0);\" title=\"', (0, _localization2.default)(\"Swap forward and reverse datasets\"), '\">', (0, _localization2.default)(\"Swap\"), \"</a>\", \"</div>\", '<div class=\"collection-elements scroll-container flex-row\">', \"</div>\"].join(\"\")),\n\n        /** help content */\n        helpContent: _.template([\"<p>\", (0, _localization2.default)([\"Pair collections are permanent collections containing two datasets: one forward and one reverse. \", \"Often these are forward and reverse reads. The pair collections can be passed to tools and \", \"workflows in order to have analyses done on both datasets. This interface allows \", \"you to create a pair, name it, and swap which is forward and which reverse.\"].join(\"\")), \"</p>\", \"<ul>\", \"<li>\", (0, _localization2.default)(['Click the <i data-target=\".swap\">\"Swap\"</i> link to make your forward dataset the reverse ', \"and the reverse dataset forward.\"].join(\"\")), \"</li>\", \"<li>\", (0, _localization2.default)(['Click the <i data-target=\".cancel-create\">\"Cancel\"</i> button to exit the interface.'].join(\"\")), \"</li>\", \"</ul><br />\", \"<p>\", (0, _localization2.default)(['Once your collection is complete, enter a <i data-target=\".collection-name\">name</i> and ', 'click <i data-target=\".create-collection\">\"Create list\"</i>.'].join(\"\")), \"</p>\"].join(\"\")),\n\n        /** a simplified page communicating what went wrong and why the user needs to reselect something else */\n        invalidInitial: _.template(['<div class=\"header flex-row no-flex\">', '<div class=\"alert alert-warning\" style=\"display: block\">', '<span class=\"alert-message\">', \"<% if( _.size( problems ) ){ %>\", (0, _localization2.default)(\"The following selections could not be included due to problems\"), \"<ul><% _.each( problems, function( problem ){ %>\", \"<li><b><%- problem.element.name %></b>: <%- problem.text %></li>\", \"<% }); %></ul>\", \"<% } else if( _.size( elements ) === 0 ){ %>\", (0, _localization2.default)(\"No datasets were selected\"), \".\", \"<% } else if( _.size( elements ) === 1 ){ %>\", (0, _localization2.default)(\"Only one dataset was selected\"), \": <%- elements[0].name %>\", \"<% } else if( _.size( elements ) > 2 ){ %>\", (0, _localization2.default)(\"Too many datasets were selected\"), ': <%- _.pluck( elements, \"name\" ).join( \", \") %>', \"<% } %>\", \"<br />\", (0, _localization2.default)(\"Two (and only two) elements are needed for the pair\"), \". \", (0, _localization2.default)(\"You may need to \"), '<a class=\"cancel-create\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"cancel\"), \"</a> \", (0, _localization2.default)(\"and reselect new elements\"), \".\", \"</span>\", \"</div>\", \"</div>\", '<div class=\"footer flex-row no-flex\">', '<div class=\"actions clear vertically-spaced\">', '<div class=\"other-options pull-left\">', '<button class=\"cancel-create btn\" tabindex=\"-1\">', (0, _localization2.default)(\"Cancel\"), \"</button>\",\n        // _l( 'Create a different kind of collection' ),\n        \"</div>\", \"</div>\", \"</div>\"].join(\"\"))\n    }),\n\n    // ------------------------------------------------------------------------ misc\n    /** string rep */\n    toString: function toString() {\n        return \"PairCollectionCreator\";\n    }\n});\n\n//==============================================================================\n/** List collection flavor of collectionCreatorModal. */\nvar pairCollectionCreatorModal = function _pairCollectionCreatorModal(elements, options) {\n    options = options || {};\n    options.title = (0, _localization2.default)(\"Create a collection from a pair of datasets\");\n    return _listCollectionCreator2.default.collectionCreatorModal(elements, options, PairCollectionCreator);\n};\n\n//==============================================================================\n/** Use a modal to create a pair collection, then add it to the given history contents.\n *  @returns {Deferred} resolved when the collection is added to the history.\n */\nfunction createPairCollection(contents, defaultHideSourceItems) {\n    var elements = contents.toJSON();\n\n    var promise = pairCollectionCreatorModal(elements, {\n        defaultHideSourceItems: defaultHideSourceItems,\n        creationFn: function creationFn(elements, name, hideSourceItems) {\n            elements = [{ name: \"forward\", src: \"hda\", id: elements[0].id }, { name: \"reverse\", src: \"hda\", id: elements[1].id }];\n            return contents.createHDCA(elements, \"paired\", name, hideSourceItems);\n        }\n    });\n\n    return promise;\n}\n\n//==============================================================================\nexports.default = {\n    PairCollectionCreator: PairCollectionCreator,\n    pairCollectionCreatorModal: pairCollectionCreatorModal,\n    createPairCollection: createPairCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vcGFpci1jb2xsZWN0aW9uLWNyZWF0b3IuanM/MDdhYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTElTVF9DUkVBVE9SIGZyb20gXCJtdmMvY29sbGVjdGlvbi9saXN0LWNvbGxlY3Rpb24tY3JlYXRvclwiO1xuaW1wb3J0IEhEQ0EgZnJvbSBcIm12Yy9oaXN0b3J5L2hkY2EtbW9kZWxcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuXG52YXIgbG9nTmFtZXNwYWNlID0gXCJjb2xsZWN0aW9uc1wiO1xuLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblRPRE86XG4gICAgdGhlIHBhaXJlZCBjcmVhdG9yIGRvZXNuJ3QgcmVhbGx5IG1lc2ggd2l0aCB0aGUgbGlzdCBjcmVhdG9yIGFzIHBhcmVudFxuICAgICAgICBpdCBtYXkgYmUgYmV0dGVyIHRvIG1ha2UgYW4gYWJzdHJhY3Qgc3VwZXIgY2xhc3MgZm9yIGJvdGhcbiAgICBjb21wb3NpdGVzIG1heSBpbmhlcml0IGZyb20gdGhpcyAob3IgdmlzLXZlcnNhKVxuICAgIFBhaXJlZERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudFZpZXcgZG9lc24ndCBtYWtlIGEgbG90IG9mIHNlbnNlXG5cbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG4vKiogICovXG52YXIgUGFpcmVkRGF0YXNldENvbGxlY3Rpb25FbGVtZW50VmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKEJBU0VfTVZDLkxvZ2dhYmxlTWl4aW4pLmV4dGVuZCh7XG4gICAgX2xvZ05hbWVzcGFjZTogbG9nTmFtZXNwYWNlLFxuXG4gICAgLy9UT0RPOiB1c2UgcHJvcGVyIGNsYXNzIChEYXRhc2V0RENFIG9yIE5lc3RlZERDRENFIChvciB0aGUgdW5pb24gb2YgYm90aCkpXG4gICAgdGFnTmFtZTogXCJsaVwiLFxuICAgIGNsYXNzTmFtZTogXCJjb2xsZWN0aW9uLWVsZW1lbnRcIixcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gYXR0cmlidXRlcy5lbGVtZW50IHx8IHt9O1xuICAgICAgICB0aGlzLmlkZW50aWZpZXIgPSBhdHRyaWJ1dGVzLmlkZW50aWZpZXI7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLmF0dHIoXCJkYXRhLWVsZW1lbnQtaWRcIiwgdGhpcy5lbGVtZW50LmlkKS5odG1sKFxuICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZSh7XG4gICAgICAgICAgICAgICAgaWRlbnRpZmllcjogdGhpcy5pZGVudGlmaWVyLFxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuZWxlbWVudFxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8vVE9ETzogbG90cyBvZiB1bnVzZWQgc3BhY2UgaW4gdGhlIGVsZW1lbnQgLSBwb3NzaWJseSBsb2FkIGRldGFpbHMgYW5kIGRpc3BsYXkgdGhlbSBob3Jpei5cbiAgICB0ZW1wbGF0ZTogXy50ZW1wbGF0ZShcbiAgICAgICAgWyc8c3BhbiBjbGFzcz1cImlkZW50aWZpZXJcIj48JS0gaWRlbnRpZmllciAlPjwvc3Bhbj4nLCAnPHNwYW4gY2xhc3M9XCJuYW1lXCI+PCUtIGVsZW1lbnQubmFtZSAlPjwvc3Bhbj4nXS5qb2luKFwiXCIpXG4gICAgKSxcblxuICAgIC8qKiByZW1vdmUgdGhlIERPTSBhbmQgYW55IGxpc3RlbmVycyAqL1xuICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm9mZigpO1xuICAgICAgICB0aGlzLiRlbC5yZW1vdmUoKTtcbiAgICB9LFxuXG4gICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBcIkRhdGFzZXRDb2xsZWN0aW9uRWxlbWVudFZpZXcoKVwiO1xuICAgIH1cbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgX3N1cGVyID0gTElTVF9DUkVBVE9SLkxpc3RDb2xsZWN0aW9uQ3JlYXRvcjtcblxuLyoqIEFuIGludGVyZmFjZSBmb3IgYnVpbGRpbmcgY29sbGVjdGlvbnMuXG4gKi9cbnZhciBQYWlyQ29sbGVjdGlvbkNyZWF0b3IgPSBfc3VwZXIuZXh0ZW5kKHtcbiAgICAvKiogdGhlIGNsYXNzIHVzZWQgdG8gZGlzcGxheSBpbmRpdmlkdWFsIGVsZW1lbnRzICovXG4gICAgZWxlbWVudFZpZXdDbGFzczogUGFpcmVkRGF0YXNldENvbGxlY3Rpb25FbGVtZW50VmlldyxcbiAgICAvKiogdGhlIGNsYXNzIHRoaXMgY3JlYXRvciB3aWxsIGNyZWF0ZSBhbmQgc2F2ZSAqL1xuICAgIGNvbGxlY3Rpb25DbGFzczogSERDQS5IaXN0b3J5RGF0YXNldENvbGxlY3Rpb24sXG4gICAgY2xhc3NOYW1lOiBcInBhaXItY29sbGVjdGlvbi1jcmVhdG9yIGNvbGxlY3Rpb24tY3JlYXRvciBmbGV4LXJvdy1jb250YWluZXJcIixcblxuICAgIC8qKiBvdmVycmlkZSB0byBuby1vcCAqL1xuICAgIF9tYW5nbGVEdXBsaWNhdGVOYW1lczogZnVuY3Rpb24oKSB7fSxcblxuICAgIC8vIFRPRE86IHRoaXMgd2hvbGUgcGF0dGVybiBzdWNrcy4gVGhlcmUgbmVlZHMgdG8gYmUgdHdvIGNsYXNzZXMgb2YgcHJvYmxlbSBhcmVhOlxuICAgIC8vICAgICAgYmFkIGluaXRhbCBjaG9pY2VzIGFuZFxuICAgIC8vICAgICAgd2hlbiB0aGUgdXNlciBoYXMgcGFpbnRlZCBoaXMvaGVyIHNlbGYgaW50byBhIGNvcm5lciBkdXJpbmcgY3JlYXRpb24vdXNlLW9mLXRoZS1jcmVhdG9yXG4gICAgLyoqIHJlbmRlciB0aGUgZW50aXJlIGludGVyZmFjZSAqL1xuICAgIHJlbmRlcjogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLndvcmtpbmdFbGVtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMsIHNwZWVkLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlckludmFsaWQoc3BlZWQsIGNhbGxiYWNrKTtcbiAgICB9LFxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHJlbmRlcmluZyBlbGVtZW50c1xuICAgIC8qKiByZW5kZXIgZm9yd2FyZC9yZXZlcnNlICovXG4gICAgX3JlbmRlckxpc3Q6IGZ1bmN0aW9uKHNwZWVkLCBjYWxsYmFjaykge1xuICAgICAgICAvL3RoaXMuZGVidWcoICctLSBfcmVuZGVyTGlzdCcgKTtcbiAgICAgICAgLy9wcmVjb25kaXRpb246IHRoZXJlIGFyZSB0d28gdmFsaWQgZWxlbWVudHMgaW4gd29ya2luZ0VsZW1lbnRzXG4gICAgICAgIHZhciBjcmVhdG9yID0gdGhpcztcblxuICAgICAgICB2YXIgJHRtcCA9IGpRdWVyeShcIjxkaXYvPlwiKTtcbiAgICAgICAgdmFyICRsaXN0ID0gY3JlYXRvci4kbGlzdCgpO1xuXG4gICAgICAgIC8vIGxvc2UgdGhlIG9yaWdpbmFsIHZpZXdzLCBjcmVhdGUgdGhlIG5ldywgYXBwZW5kIGFsbCBhdCBvbmNlLCB0aGVuIGNhbGwgdGhlaXIgcmVuZGVyc1xuICAgICAgICBfLmVhY2godGhpcy5lbGVtZW50Vmlld3MsIHZpZXcgPT4ge1xuICAgICAgICAgICAgdmlldy5kZXN0cm95KCk7XG4gICAgICAgICAgICBjcmVhdG9yLnJlbW92ZUVsZW1lbnRWaWV3KHZpZXcpO1xuICAgICAgICB9KTtcbiAgICAgICAgJHRtcC5hcHBlbmQoY3JlYXRvci5fY3JlYXRlRm9yd2FyZEVsZW1lbnRWaWV3KCkuJGVsKTtcbiAgICAgICAgJHRtcC5hcHBlbmQoY3JlYXRvci5fY3JlYXRlUmV2ZXJzZUVsZW1lbnRWaWV3KCkuJGVsKTtcbiAgICAgICAgJGxpc3QuZW1wdHkoKS5hcHBlbmQoJHRtcC5jaGlsZHJlbigpKTtcbiAgICAgICAgXy5pbnZva2UoY3JlYXRvci5lbGVtZW50Vmlld3MsIFwicmVuZGVyXCIpO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIHRoZSBmb3J3YXJkIGVsZW1lbnQgdmlldyAqL1xuICAgIF9jcmVhdGVGb3J3YXJkRWxlbWVudFZpZXc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlRWxlbWVudFZpZXcodGhpcy53b3JraW5nRWxlbWVudHNbMF0sIHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IFwiZm9yd2FyZFwiXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIHRoZSBmb3J3YXJkIGVsZW1lbnQgdmlldyAqL1xuICAgIF9jcmVhdGVSZXZlcnNlRWxlbWVudFZpZXc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlRWxlbWVudFZpZXcodGhpcy53b3JraW5nRWxlbWVudHNbMV0sIHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IFwicmV2ZXJzZVwiXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogY3JlYXRlIGFuIGVsZW1lbnQgdmlldywgY2FjaGUgaW4gZWxlbWVudFZpZXdzLCBhbmQgcmV0dXJuICovXG4gICAgX2NyZWF0ZUVsZW1lbnRWaWV3OiBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBlbGVtZW50VmlldyA9IG5ldyB0aGlzLmVsZW1lbnRWaWV3Q2xhc3MoXG4gICAgICAgICAgICBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudFxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5lbGVtZW50Vmlld3MucHVzaChlbGVtZW50Vmlldyk7XG4gICAgICAgIHJldHVybiBlbGVtZW50VmlldztcbiAgICB9LFxuXG4gICAgLyoqIHN3YXAgdGhlIGZvcndhcmQsIHJldmVyc2UgZWxlbWVudHMgYW5kIHJlLXJlbmRlciAqL1xuICAgIHN3YXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLndvcmtpbmdFbGVtZW50cyA9IFt0aGlzLndvcmtpbmdFbGVtZW50c1sxXSwgdGhpcy53b3JraW5nRWxlbWVudHNbMF1dO1xuICAgICAgICB0aGlzLl9yZW5kZXJMaXN0KCk7XG4gICAgfSxcblxuICAgIGV2ZW50czogXy5leHRlbmQoXy5jbG9uZShfc3VwZXIucHJvdG90eXBlLmV2ZW50cyksIHtcbiAgICAgICAgXCJjbGljayAuc3dhcFwiOiBcInN3YXBcIlxuICAgIH0pLFxuXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHRlbXBsYXRlc1xuICAgIC8vVE9ETzogbW92ZSB0byByZXF1aXJlIHRleHQgcGx1Z2luIGFuZCBsb2FkIHRoZXNlIGFzIHRleHRcbiAgICAvL1RPRE86IHVuZGVyc2NvcmUgY3VycmVudGx5IHVubmVjYy4gYmMgbm8gdmFycyBhcmUgdXNlZFxuICAgIC8vVE9ETzogYmV0dGVyIHdheSBvZiBsb2NhbGl6aW5nIHRleHQtbm9kZXMgaW4gbG9uZyBzdHJpbmdzXG4gICAgLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGUgZm5zIGF0dGFjaGVkIHRvIGNsYXNzICovXG4gICAgdGVtcGxhdGVzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzKSwge1xuICAgICAgICAvKiogdGhlIG1pZGRsZTogZWxlbWVudCBsaXN0ICovXG4gICAgICAgIG1pZGRsZTogXy50ZW1wbGF0ZShcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tZWxlbWVudHMtY29udHJvbHNcIj4nLFxuICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cInN3YXBcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiIHRpdGxlPVwiJyxcbiAgICAgICAgICAgICAgICBfbChcIlN3YXAgZm9yd2FyZCBhbmQgcmV2ZXJzZSBkYXRhc2V0c1wiKSxcbiAgICAgICAgICAgICAgICAnXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIlN3YXBcIiksXG4gICAgICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tZWxlbWVudHMgc2Nyb2xsLWNvbnRhaW5lciBmbGV4LXJvd1wiPicsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICksXG5cbiAgICAgICAgLyoqIGhlbHAgY29udGVudCAqL1xuICAgICAgICBoZWxwQ29udGVudDogXy50ZW1wbGF0ZShcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICBcIjxwPlwiLFxuICAgICAgICAgICAgICAgIF9sKFxuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlBhaXIgY29sbGVjdGlvbnMgYXJlIHBlcm1hbmVudCBjb2xsZWN0aW9ucyBjb250YWluaW5nIHR3byBkYXRhc2V0czogb25lIGZvcndhcmQgYW5kIG9uZSByZXZlcnNlLiBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiT2Z0ZW4gdGhlc2UgYXJlIGZvcndhcmQgYW5kIHJldmVyc2UgcmVhZHMuIFRoZSBwYWlyIGNvbGxlY3Rpb25zIGNhbiBiZSBwYXNzZWQgdG8gdG9vbHMgYW5kIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3b3JrZmxvd3MgaW4gb3JkZXIgdG8gaGF2ZSBhbmFseXNlcyBkb25lIG9uIGJvdGggZGF0YXNldHMuIFRoaXMgaW50ZXJmYWNlIGFsbG93cyBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwieW91IHRvIGNyZWF0ZSBhIHBhaXIsIG5hbWUgaXQsIGFuZCBzd2FwIHdoaWNoIGlzIGZvcndhcmQgYW5kIHdoaWNoIHJldmVyc2UuXCJcbiAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBcIjwvcD5cIixcbiAgICAgICAgICAgICAgICBcIjx1bD5cIixcbiAgICAgICAgICAgICAgICBcIjxsaT5cIixcbiAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NsaWNrIHRoZSA8aSBkYXRhLXRhcmdldD1cIi5zd2FwXCI+XCJTd2FwXCI8L2k+IGxpbmsgdG8gbWFrZSB5b3VyIGZvcndhcmQgZGF0YXNldCB0aGUgcmV2ZXJzZSAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhbmQgdGhlIHJldmVyc2UgZGF0YXNldCBmb3J3YXJkLlwiXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgIFwiPGxpPlwiLFxuICAgICAgICAgICAgICAgIF9sKFsnQ2xpY2sgdGhlIDxpIGRhdGEtdGFyZ2V0PVwiLmNhbmNlbC1jcmVhdGVcIj5cIkNhbmNlbFwiPC9pPiBidXR0b24gdG8gZXhpdCB0aGUgaW50ZXJmYWNlLiddLmpvaW4oXCJcIikpLFxuICAgICAgICAgICAgICAgIFwiPC9saT5cIixcbiAgICAgICAgICAgICAgICBcIjwvdWw+PGJyIC8+XCIsXG4gICAgICAgICAgICAgICAgXCI8cD5cIixcbiAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgJ09uY2UgeW91ciBjb2xsZWN0aW9uIGlzIGNvbXBsZXRlLCBlbnRlciBhIDxpIGRhdGEtdGFyZ2V0PVwiLmNvbGxlY3Rpb24tbmFtZVwiPm5hbWU8L2k+IGFuZCAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2NsaWNrIDxpIGRhdGEtdGFyZ2V0PVwiLmNyZWF0ZS1jb2xsZWN0aW9uXCI+XCJDcmVhdGUgbGlzdFwiPC9pPi4nXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgXCI8L3A+XCJcbiAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICApLFxuXG4gICAgICAgIC8qKiBhIHNpbXBsaWZpZWQgcGFnZSBjb21tdW5pY2F0aW5nIHdoYXQgd2VudCB3cm9uZyBhbmQgd2h5IHRoZSB1c2VyIG5lZWRzIHRvIHJlc2VsZWN0IHNvbWV0aGluZyBlbHNlICovXG4gICAgICAgIGludmFsaWRJbml0aWFsOiBfLnRlbXBsYXRlKFxuICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGVhZGVyIGZsZXgtcm93IG5vLWZsZXhcIj4nLFxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiYWxlcnQgYWxlcnQtd2FybmluZ1wiIHN0eWxlPVwiZGlzcGxheTogYmxvY2tcIj4nLFxuICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImFsZXJ0LW1lc3NhZ2VcIj4nLFxuICAgICAgICAgICAgICAgIFwiPCUgaWYoIF8uc2l6ZSggcHJvYmxlbXMgKSApeyAlPlwiLFxuICAgICAgICAgICAgICAgIF9sKFwiVGhlIGZvbGxvd2luZyBzZWxlY3Rpb25zIGNvdWxkIG5vdCBiZSBpbmNsdWRlZCBkdWUgdG8gcHJvYmxlbXNcIiksXG4gICAgICAgICAgICAgICAgXCI8dWw+PCUgXy5lYWNoKCBwcm9ibGVtcywgZnVuY3Rpb24oIHByb2JsZW0gKXsgJT5cIixcbiAgICAgICAgICAgICAgICBcIjxsaT48Yj48JS0gcHJvYmxlbS5lbGVtZW50Lm5hbWUgJT48L2I+OiA8JS0gcHJvYmxlbS50ZXh0ICU+PC9saT5cIixcbiAgICAgICAgICAgICAgICBcIjwlIH0pOyAlPjwvdWw+XCIsXG4gICAgICAgICAgICAgICAgXCI8JSB9IGVsc2UgaWYoIF8uc2l6ZSggZWxlbWVudHMgKSA9PT0gMCApeyAlPlwiLFxuICAgICAgICAgICAgICAgIF9sKFwiTm8gZGF0YXNldHMgd2VyZSBzZWxlY3RlZFwiKSxcbiAgICAgICAgICAgICAgICBcIi5cIixcbiAgICAgICAgICAgICAgICBcIjwlIH0gZWxzZSBpZiggXy5zaXplKCBlbGVtZW50cyApID09PSAxICl7ICU+XCIsXG4gICAgICAgICAgICAgICAgX2woXCJPbmx5IG9uZSBkYXRhc2V0IHdhcyBzZWxlY3RlZFwiKSxcbiAgICAgICAgICAgICAgICBcIjogPCUtIGVsZW1lbnRzWzBdLm5hbWUgJT5cIixcbiAgICAgICAgICAgICAgICBcIjwlIH0gZWxzZSBpZiggXy5zaXplKCBlbGVtZW50cyApID4gMiApeyAlPlwiLFxuICAgICAgICAgICAgICAgIF9sKFwiVG9vIG1hbnkgZGF0YXNldHMgd2VyZSBzZWxlY3RlZFwiKSxcbiAgICAgICAgICAgICAgICAnOiA8JS0gXy5wbHVjayggZWxlbWVudHMsIFwibmFtZVwiICkuam9pbiggXCIsIFwiKSAlPicsXG4gICAgICAgICAgICAgICAgXCI8JSB9ICU+XCIsXG4gICAgICAgICAgICAgICAgXCI8YnIgLz5cIixcbiAgICAgICAgICAgICAgICBfbChcIlR3byAoYW5kIG9ubHkgdHdvKSBlbGVtZW50cyBhcmUgbmVlZGVkIGZvciB0aGUgcGFpclwiKSxcbiAgICAgICAgICAgICAgICBcIi4gXCIsXG4gICAgICAgICAgICAgICAgX2woXCJZb3UgbWF5IG5lZWQgdG8gXCIpLFxuICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cImNhbmNlbC1jcmVhdGVcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcImNhbmNlbFwiKSxcbiAgICAgICAgICAgICAgICBcIjwvYT4gXCIsXG4gICAgICAgICAgICAgICAgX2woXCJhbmQgcmVzZWxlY3QgbmV3IGVsZW1lbnRzXCIpLFxuICAgICAgICAgICAgICAgIFwiLlwiLFxuICAgICAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvb3RlciBmbGV4LXJvdyBuby1mbGV4XCI+JyxcbiAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFjdGlvbnMgY2xlYXIgdmVydGljYWxseS1zcGFjZWRcIj4nLFxuICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwib3RoZXItb3B0aW9ucyBwdWxsLWxlZnRcIj4nLFxuICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiY2FuY2VsLWNyZWF0ZSBidG5cIiB0YWJpbmRleD1cIi0xXCI+JyxcbiAgICAgICAgICAgICAgICBfbChcIkNhbmNlbFwiKSxcbiAgICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgICAgIC8vIF9sKCAnQ3JlYXRlIGEgZGlmZmVyZW50IGtpbmQgb2YgY29sbGVjdGlvbicgKSxcbiAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgIClcbiAgICB9KSxcblxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBtaXNjXG4gICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBcIlBhaXJDb2xsZWN0aW9uQ3JlYXRvclwiO1xuICAgIH1cbn0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIExpc3QgY29sbGVjdGlvbiBmbGF2b3Igb2YgY29sbGVjdGlvbkNyZWF0b3JNb2RhbC4gKi9cbnZhciBwYWlyQ29sbGVjdGlvbkNyZWF0b3JNb2RhbCA9IGZ1bmN0aW9uIF9wYWlyQ29sbGVjdGlvbkNyZWF0b3JNb2RhbChlbGVtZW50cywgb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIG9wdGlvbnMudGl0bGUgPSBfbChcIkNyZWF0ZSBhIGNvbGxlY3Rpb24gZnJvbSBhIHBhaXIgb2YgZGF0YXNldHNcIik7XG4gICAgcmV0dXJuIExJU1RfQ1JFQVRPUi5jb2xsZWN0aW9uQ3JlYXRvck1vZGFsKGVsZW1lbnRzLCBvcHRpb25zLCBQYWlyQ29sbGVjdGlvbkNyZWF0b3IpO1xufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBVc2UgYSBtb2RhbCB0byBjcmVhdGUgYSBwYWlyIGNvbGxlY3Rpb24sIHRoZW4gYWRkIGl0IHRvIHRoZSBnaXZlbiBoaXN0b3J5IGNvbnRlbnRzLlxuICogIEByZXR1cm5zIHtEZWZlcnJlZH0gcmVzb2x2ZWQgd2hlbiB0aGUgY29sbGVjdGlvbiBpcyBhZGRlZCB0byB0aGUgaGlzdG9yeS5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlUGFpckNvbGxlY3Rpb24oY29udGVudHMsIGRlZmF1bHRIaWRlU291cmNlSXRlbXMpIHtcbiAgICB2YXIgZWxlbWVudHMgPSBjb250ZW50cy50b0pTT04oKTtcblxuICAgIHZhciBwcm9taXNlID0gcGFpckNvbGxlY3Rpb25DcmVhdG9yTW9kYWwoZWxlbWVudHMsIHtcbiAgICAgICAgZGVmYXVsdEhpZGVTb3VyY2VJdGVtczogZGVmYXVsdEhpZGVTb3VyY2VJdGVtcyxcbiAgICAgICAgY3JlYXRpb25GbjogZnVuY3Rpb24oZWxlbWVudHMsIG5hbWUsIGhpZGVTb3VyY2VJdGVtcykge1xuICAgICAgICAgICAgZWxlbWVudHMgPSBbXG4gICAgICAgICAgICAgICAgeyBuYW1lOiBcImZvcndhcmRcIiwgc3JjOiBcImhkYVwiLCBpZDogZWxlbWVudHNbMF0uaWQgfSxcbiAgICAgICAgICAgICAgICB7IG5hbWU6IFwicmV2ZXJzZVwiLCBzcmM6IFwiaGRhXCIsIGlkOiBlbGVtZW50c1sxXS5pZCB9XG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnRzLmNyZWF0ZUhEQ0EoZWxlbWVudHMsIFwicGFpcmVkXCIsIG5hbWUsIGhpZGVTb3VyY2VJdGVtcyk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBwcm9taXNlO1xufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZXhwb3J0IGRlZmF1bHQge1xuICAgIFBhaXJDb2xsZWN0aW9uQ3JlYXRvcjogUGFpckNvbGxlY3Rpb25DcmVhdG9yLFxuICAgIHBhaXJDb2xsZWN0aW9uQ3JlYXRvck1vZGFsOiBwYWlyQ29sbGVjdGlvbkNyZWF0b3JNb2RhbCxcbiAgICBjcmVhdGVQYWlyQ29sbGVjdGlvbjogY3JlYXRlUGFpckNvbGxlY3Rpb25cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vcGFpci1jb2xsZWN0aW9uLWNyZWF0b3IuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXBDQTtBQUNBO0FBc0NBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBO0FBQ0E7QUFDQTtBQW1DQTtBQUNBO0FBc0NBO0FBQ0E7QUE3RkE7QUFDQTtBQW1HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBMUxBO0FBQ0E7QUE0TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQVJBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///74\n");

/***/ }),
/* 75 */
/*!***************************************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/list-of-pairs-collection-creator.js ***!
  \***************************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, jQuery, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _levenshtein = __webpack_require__(/*! utils/levenshtein */ 100);\n\nvar _levenshtein2 = _interopRequireDefault(_levenshtein);\n\nvar _naturalSort = __webpack_require__(/*! utils/natural-sort */ 53);\n\nvar _naturalSort2 = _interopRequireDefault(_naturalSort);\n\nvar _baseCreator = __webpack_require__(/*! mvc/collection/base-creator */ 52);\n\nvar _baseCreator2 = _interopRequireDefault(_baseCreator);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/hoverhighlight */ 54);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar logNamespace = \"collections\";\n/* ============================================================================\nTODO:\n\n\nPROGRAMMATICALLY:\ncurrPanel.once( 'rendered', function(){\n    currPanel.showSelectors();\n    currPanel.selectAll();\n    _.last( currPanel.actionsPopup.options ).func();\n});\n\n============================================================================ */\n/** A view for paired datasets in the collections creator.\n */\nvar PairView = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: logNamespace,\n\n    tagName: \"li\",\n    className: \"dataset paired\",\n\n    initialize: function initialize(attributes) {\n        this.pair = attributes.pair || {};\n    },\n\n    template: _.template(['<span class=\"forward-dataset-name flex-column\"><%- pair.forward.name %></span>', '<span class=\"pair-name-column flex-column\">', '<span class=\"pair-name\"><%- pair.name %></span>', \"</span>\", '<span class=\"reverse-dataset-name flex-column\"><%- pair.reverse.name %></span>'].join(\"\")),\n\n    render: function render() {\n        this.dragStartHandler = _.bind(this._dragstart, this);\n        this.dragEndHandler = _.bind(this._dragend, this);\n        var handle = this.$el.attr(\"draggable\", true).data(\"pair\", this.pair).html(this.template({ pair: this.pair })).addClass(\"flex-column-container\").get(0);\n        handle.addEventListener(\"dragstart\", this.dragStartHandler, false);\n        handle.addEventListener(\"dragend\", this.dragEndHandler, false);\n        return this;\n    },\n\n    events: {\n        dragover: \"_sendToParent\",\n        drop: \"_sendToParent\"\n    },\n\n    /** dragging pairs for re-ordering */\n    _dragstart: function _dragstart(ev) {\n        ev.currentTarget.style.opacity = \"0.4\";\n        if (ev.originalEvent) {\n            ev = ev.originalEvent;\n        }\n\n        ev.dataTransfer.effectAllowed = \"move\";\n        ev.dataTransfer.setData(\"text/plain\", JSON.stringify(this.pair));\n\n        this.$el.parent().trigger(\"pair.dragstart\", [this]);\n    },\n\n    /** dragging pairs for re-ordering */\n    _dragend: function _dragend(ev) {\n        ev.currentTarget.style.opacity = \"1.0\";\n        this.$el.parent().trigger(\"pair.dragend\", [this]);\n    },\n\n    /** manually bubble up an event to the parent/container */\n    _sendToParent: function _sendToParent(ev) {\n        this.$el.parent().trigger(ev);\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return \"PairView(\" + this.pair.name + \")\";\n    }\n});\n\n// ============================================================================\n/** returns an autopair function that uses the provided options.match function */\nfunction autoPairFnBuilder(options) {\n    options = options || {};\n    options.createPair = options.createPair || function _defaultCreatePair(params) {\n        params = params || {};\n        var a = params.listA.splice(params.indexA, 1)[0];\n        var b = params.listB.splice(params.indexB, 1)[0];\n        var aInBIndex = params.listB.indexOf(a);\n        var bInAIndex = params.listA.indexOf(b);\n        if (aInBIndex !== -1) {\n            params.listB.splice(aInBIndex, 1);\n        }\n        if (bInAIndex !== -1) {\n            params.listA.splice(bInAIndex, 1);\n        }\n        return this._pair(a, b, { silent: true });\n    };\n    // compile these here outside of the loop\n    var _regexps = [];\n    function getRegExps() {\n        if (!_regexps.length) {\n            _regexps = [new RegExp(this.filters[0]), new RegExp(this.filters[1])];\n        }\n        return _regexps;\n    }\n    // mangle params as needed\n    options.preprocessMatch = options.preprocessMatch || function _defaultPreprocessMatch(params) {\n        var regexps = getRegExps.call(this);\n        return _.extend(params, {\n            matchTo: params.matchTo.name.replace(regexps[0], \"\"),\n            possible: params.possible.name.replace(regexps[1], \"\")\n        });\n    };\n\n    return function _strategy(params) {\n        this.debug(\"autopair _strategy ---------------------------\");\n        params = params || {};\n        var listA = params.listA;\n        var listB = params.listB;\n        var indexA = 0;\n        var indexB;\n\n        var bestMatch = {\n            score: 0.0,\n            index: null\n        };\n\n        var paired = [];\n        //console.debug( 'params:', JSON.stringify( params, null, '  ' ) );\n        this.debug(\"starting list lens:\", listA.length, listB.length);\n        this.debug(\"bestMatch (starting):\", JSON.stringify(bestMatch, null, \"  \"));\n\n        while (indexA < listA.length) {\n            var matchTo = listA[indexA];\n            bestMatch.score = 0.0;\n\n            for (indexB = 0; indexB < listB.length; indexB++) {\n                var possible = listB[indexB];\n                this.debug(indexA + \":\" + matchTo.name);\n                this.debug(indexB + \":\" + possible.name);\n\n                // no matching with self\n                if (listA[indexA] !== listB[indexB]) {\n                    bestMatch = options.match.call(this, options.preprocessMatch.call(this, {\n                        matchTo: matchTo,\n                        possible: possible,\n                        index: indexB,\n                        bestMatch: bestMatch\n                    }));\n                    this.debug(\"bestMatch:\", JSON.stringify(bestMatch, null, \"  \"));\n                    if (bestMatch.score === 1.0) {\n                        this.debug(\"breaking early due to perfect match\");\n                        break;\n                    }\n                }\n            }\n            var scoreThreshold = options.scoreThreshold.call(this);\n            this.debug(\"scoreThreshold:\", scoreThreshold);\n            this.debug(\"bestMatch.score:\", bestMatch.score);\n\n            if (bestMatch.score >= scoreThreshold) {\n                //console.debug( 'autoPairFnBuilder.strategy', listA[ indexA ].name, listB[ bestMatch.index ].name );\n                paired.push(options.createPair.call(this, {\n                    listA: listA,\n                    indexA: indexA,\n                    listB: listB,\n                    indexB: bestMatch.index\n                }));\n                //console.debug( 'list lens now:', listA.length, listB.length );\n            } else {\n                indexA += 1;\n            }\n            if (!listA.length || !listB.length) {\n                return paired;\n            }\n        }\n        this.debug(\"paired:\", JSON.stringify(paired, null, \"  \"));\n        this.debug(\"autopair _strategy ---------------------------\");\n        return paired;\n    };\n}\n\n// ============================================================================\n/** An interface for building collections of paired datasets.\n */\nvar PairedCollectionCreator = Backbone.View.extend(_baseMvc2.default.LoggableMixin).extend(_baseCreator2.default.CollectionCreatorMixin).extend({\n    _logNamespace: logNamespace,\n\n    className: \"list-of-pairs-collection-creator collection-creator flex-row-container\",\n\n    /** set up initial options, instance vars, behaviors, and autopair (if set to do so) */\n    initialize: function initialize(attributes) {\n        this.metric(\"PairedCollectionCreator.initialize\", attributes);\n        //this.debug( '-- PairedCollectionCreator:', attributes );\n\n        attributes = _.defaults(attributes, {\n            datasets: [],\n            filters: this.DEFAULT_FILTERS,\n            automaticallyPair: true,\n            strategy: \"lcs\",\n            matchPercentage: 0.9,\n            twoPassAutopairing: true\n        });\n\n        /** unordered, original list */\n        this.initialList = attributes.datasets;\n\n        /** is this from a history? if so, what's its id? */\n        this.historyId = attributes.historyId;\n\n        /** which filters should be used initially? (String[2] or name in commonFilters) */\n        this.filters = this.commonFilters[attributes.filters] || this.commonFilters[this.DEFAULT_FILTERS];\n        if (_.isArray(attributes.filters)) {\n            this.filters = attributes.filters;\n        }\n\n        /** try to auto pair the unpaired datasets on load? */\n        this.automaticallyPair = attributes.automaticallyPair;\n\n        /** what method to use for auto pairing (will be passed aggression level) */\n        this.strategy = this.strategies[attributes.strategy] || this.strategies[this.DEFAULT_STRATEGY];\n        if (_.isFunction(attributes.strategy)) {\n            this.strategy = attributes.strategy;\n        }\n\n        /** distance/mismatch level allowed for autopairing */\n        this.matchPercentage = attributes.matchPercentage;\n\n        /** try to autopair using simple first, then this.strategy on the remainder */\n        this.twoPassAutopairing = attributes.twoPassAutopairing;\n\n        /** remove file extensions (\\.*) from created pair names? */\n        this.removeExtensions = true;\n        //this.removeExtensions = false;\n\n        /** fn to call when the cancel button is clicked (scoped to this) - if falsy, no btn is displayed */\n        this.oncancel = attributes.oncancel;\n        /** fn to call when the collection is created (scoped to this) */\n        this.oncreate = attributes.oncreate;\n\n        /** fn to call when the cancel button is clicked (scoped to this) - if falsy, no btn is displayed */\n        this.autoscrollDist = attributes.autoscrollDist || 24;\n\n        /** is the unpaired panel shown? */\n        this.unpairedPanelHidden = false;\n        /** is the paired panel shown? */\n        this.pairedPanelHidden = false;\n\n        /** DOM elements currently being dragged */\n        this.$dragging = null;\n\n        /** Used for blocking UI events during ajax/operations (don't post twice) */\n        this.blocking = false;\n\n        this._setUpCommonSettings(attributes);\n        this._setUpBehaviors();\n        this._dataSetUp();\n    },\n\n    /** map of common filter pairs by name */\n    commonFilters: {\n        illumina: [\"_1\", \"_2\"],\n        Rs: [\"_R1\", \"_R2\"]\n    },\n    /** which commonFilter to use by default */\n    DEFAULT_FILTERS: \"illumina\",\n\n    /** map of name->fn for autopairing */\n    strategies: {\n        simple: \"autopairSimple\",\n        lcs: \"autopairLCS\",\n        levenshtein: \"autopairLevenshtein\"\n    },\n    /** default autopair strategy name */\n    DEFAULT_STRATEGY: \"lcs\",\n\n    // ------------------------------------------------------------------------ process raw list\n    /** set up main data: cache initialList, sort, and autopair */\n    _dataSetUp: function _dataSetUp() {\n        //this.debug( '-- _dataSetUp' );\n\n        this.paired = [];\n        this.unpaired = [];\n\n        this.selectedIds = [];\n\n        // sort initial list, add ids if needed, and save new working copy to unpaired\n        this._sortInitialList();\n        this._ensureIds();\n        this.unpaired = this.initialList.slice(0);\n\n        if (this.automaticallyPair) {\n            this.autoPair();\n            this.once(\"rendered:initial\", function () {\n                this.trigger(\"autopair\");\n            });\n        }\n    },\n\n    /** sort initial list */\n    _sortInitialList: function _sortInitialList() {\n        //this.debug( '-- _sortInitialList' );\n        this._sortDatasetList(this.initialList);\n    },\n\n    /** sort a list of datasets */\n    _sortDatasetList: function _sortDatasetList(list) {\n        // currently only natural sort by name\n        list.sort(function (a, b) {\n            return (0, _naturalSort2.default)(a.name, b.name);\n        });\n        return list;\n    },\n\n    /** add ids to dataset objs in initial list if none */\n    _ensureIds: function _ensureIds() {\n        this.initialList.forEach(function (dataset) {\n            if (!dataset.hasOwnProperty(\"id\")) {\n                dataset.id = _.uniqueId();\n            }\n        });\n        return this.initialList;\n    },\n\n    /** split initial list into two lists, those that pass forward filters & those passing reverse */\n    _splitByFilters: function _splitByFilters() {\n        var regexFilters = this.filters.map(function (stringFilter) {\n            return new RegExp(stringFilter);\n        });\n\n        var split = [[], []];\n\n        function _filter(unpaired, filter) {\n            return filter.test(unpaired.name);\n            //return dataset.name.indexOf( filter ) >= 0;\n        }\n        this.unpaired.forEach(function _filterEach(unpaired) {\n            // 90% of the time this seems to work, but:\n            //TODO: this treats *all* strings as regex which may confuse people - possibly check for // surrounding?\n            //  would need explanation in help as well\n            regexFilters.forEach(function (filter, i) {\n                if (_filter(unpaired, filter)) {\n                    split[i].push(unpaired);\n                }\n            });\n        });\n        return split;\n    },\n\n    /** add a dataset to the unpaired list in it's proper order */\n    _addToUnpaired: function _addToUnpaired(dataset) {\n        var _this = this;\n\n        // currently, unpaired is natural sorted by name, use binary search to find insertion point\n        var binSearchSortedIndex = function binSearchSortedIndex(low, hi) {\n            if (low === hi) {\n                return low;\n            }\n\n            var mid = Math.floor((hi - low) / 2) + low;\n\n            var compared = (0, _naturalSort2.default)(dataset.name, _this.unpaired[mid].name);\n\n            if (compared < 0) {\n                return binSearchSortedIndex(low, mid);\n            } else if (compared > 0) {\n                return binSearchSortedIndex(mid + 1, hi);\n            }\n            // walk the equal to find the last\n            while (_this.unpaired[mid] && _this.unpaired[mid].name === dataset.name) {\n                mid++;\n            }\n            return mid;\n        };\n\n        this.unpaired.splice(binSearchSortedIndex(0, this.unpaired.length), 0, dataset);\n    },\n\n    // ------------------------------------------------------------------------ auto pairing\n    /** two passes to automatically create pairs:\n     *  use both simpleAutoPair, then the fn mentioned in strategy\n     */\n    autoPair: function autoPair(strategy) {\n        // split first using exact matching\n        var split = this._splitByFilters();\n\n        var paired = [];\n        if (this.twoPassAutopairing) {\n            paired = this.autopairSimple({\n                listA: split[0],\n                listB: split[1]\n            });\n            split = this._splitByFilters();\n        }\n\n        // uncomment to see printlns while running tests\n        //this.debug = function(){ console.log.apply( console, arguments ); };\n\n        // then try the remainder with something less strict\n        strategy = strategy || this.strategy;\n        split = this._splitByFilters();\n        paired = paired.concat(this[strategy].call(this, {\n            listA: split[0],\n            listB: split[1]\n        }));\n        return paired;\n    },\n\n    /** autopair by exact match */\n    autopairSimple: autoPairFnBuilder({\n        scoreThreshold: function scoreThreshold() {\n            return 0.6;\n        },\n        match: function _match(params) {\n            params = params || {};\n            if (params.matchTo === params.possible) {\n                return {\n                    index: params.index,\n                    score: 1.0\n                };\n            }\n            return params.bestMatch;\n        }\n    }),\n\n    /** autopair by levenshtein edit distance scoring */\n    autopairLevenshtein: autoPairFnBuilder({\n        scoreThreshold: function scoreThreshold() {\n            return this.matchPercentage;\n        },\n        match: function _matches(params) {\n            params = params || {};\n\n            var distance = (0, _levenshtein2.default)(params.matchTo, params.possible);\n\n            var score = 1.0 - distance / Math.max(params.matchTo.length, params.possible.length);\n\n            if (score > params.bestMatch.score) {\n                return {\n                    index: params.index,\n                    score: score\n                };\n            }\n            return params.bestMatch;\n        }\n    }),\n\n    /** autopair by longest common substrings scoring */\n    autopairLCS: autoPairFnBuilder({\n        scoreThreshold: function scoreThreshold() {\n            return this.matchPercentage;\n        },\n        match: function _matches(params) {\n            params = params || {};\n\n            var match = this._naiveStartingAndEndingLCS(params.matchTo, params.possible).length;\n\n            var score = match / Math.max(params.matchTo.length, params.possible.length);\n\n            if (score > params.bestMatch.score) {\n                return {\n                    index: params.index,\n                    score: score\n                };\n            }\n            return params.bestMatch;\n        }\n    }),\n\n    /** return the concat'd longest common prefix and suffix from two strings */\n    _naiveStartingAndEndingLCS: function _naiveStartingAndEndingLCS(s1, s2) {\n        var fwdLCS = \"\";\n        var revLCS = \"\";\n        var i = 0;\n        var j = 0;\n        while (i < s1.length && i < s2.length) {\n            if (s1[i] !== s2[i]) {\n                break;\n            }\n            fwdLCS += s1[i];\n            i += 1;\n        }\n        if (i === s1.length) {\n            return s1;\n        }\n        if (i === s2.length) {\n            return s2;\n        }\n\n        i = s1.length - 1;\n        j = s2.length - 1;\n        while (i >= 0 && j >= 0) {\n            if (s1[i] !== s2[j]) {\n                break;\n            }\n            revLCS = [s1[i], revLCS].join(\"\");\n            i -= 1;\n            j -= 1;\n        }\n        return fwdLCS + revLCS;\n    },\n\n    // ------------------------------------------------------------------------ pairing / unpairing\n    /** create a pair from fwd and rev, removing them from unpaired, and placing the new pair in paired */\n    _pair: function _pair(fwd, rev, options) {\n        options = options || {};\n        this.debug(\"_pair:\", fwd, rev);\n        var pair = this._createPair(fwd, rev, options.name);\n        this.paired.push(pair);\n        this.unpaired = _.without(this.unpaired, fwd, rev);\n        if (!options.silent) {\n            this.trigger(\"pair:new\", pair);\n        }\n        return pair;\n    },\n\n    /** create a pair Object from fwd and rev, adding the name attribute (will guess if not given) */\n    _createPair: function _createPair(fwd, rev, name) {\n        // ensure existance and don't pair something with itself\n        if (!(fwd && rev) || fwd === rev) {\n            throw new Error(\"Bad pairing: \" + [JSON.stringify(fwd), JSON.stringify(rev)]);\n        }\n        name = name || this._guessNameForPair(fwd, rev);\n        return { forward: fwd, name: name, reverse: rev };\n    },\n\n    /** try to find a good pair name for the given fwd and rev datasets */\n    _guessNameForPair: function _guessNameForPair(fwd, rev, removeExtensions) {\n        removeExtensions = removeExtensions !== undefined ? removeExtensions : this.removeExtensions;\n        var fwdName = fwd.name;\n        var revName = rev.name;\n\n        var lcs = this._naiveStartingAndEndingLCS(fwdName.replace(new RegExp(this.filters[0]), \"\"), revName.replace(new RegExp(this.filters[1]), \"\"));\n\n        if (removeExtensions) {\n            var lastDotIndex = lcs.lastIndexOf(\".\");\n            if (lastDotIndex > 0) {\n                var extension = lcs.slice(lastDotIndex, lcs.length);\n                lcs = lcs.replace(extension, \"\");\n                fwdName = fwdName.replace(extension, \"\");\n                revName = revName.replace(extension, \"\");\n            }\n        }\n        return lcs || fwdName + \" & \" + revName;\n    },\n\n    /** unpair a pair, removing it from paired, and adding the fwd,rev datasets back into unpaired */\n    _unpair: function _unpair(pair, options) {\n        options = options || {};\n        if (!pair) {\n            throw new Error(\"Bad pair: \" + JSON.stringify(pair));\n        }\n        this.paired = _.without(this.paired, pair);\n        this._addToUnpaired(pair.forward);\n        this._addToUnpaired(pair.reverse);\n\n        if (!options.silent) {\n            this.trigger(\"pair:unpair\", [pair]);\n        }\n        return pair;\n    },\n\n    /** unpair all paired datasets */\n    unpairAll: function unpairAll() {\n        var pairs = [];\n        while (this.paired.length) {\n            pairs.push(this._unpair(this.paired[0], { silent: true }));\n        }\n        this.trigger(\"pair:unpair\", pairs);\n    },\n\n    // ------------------------------------------------------------------------ API\n    /** convert a pair into JSON compatible with the collections API */\n    _pairToJSON: function _pairToJSON(pair, src) {\n        src = src || \"hda\";\n        //TODO: consider making this the pair structure when created instead\n        return {\n            collection_type: \"paired\",\n            src: \"new_collection\",\n            name: pair.name,\n            element_identifiers: [{\n                name: \"forward\",\n                id: pair.forward.id,\n                src: src\n            }, {\n                name: \"reverse\",\n                id: pair.reverse.id,\n                src: src\n            }]\n        };\n    },\n\n    /** create the collection via the API\n     *  @returns {jQuery.xhr Object}    the jquery ajax request\n     */\n    createList: function createList(name) {\n        var self = this;\n\n        var url = Galaxy.root + \"api/histories/\" + this.historyId + \"/contents/dataset_collections\";\n\n        var ajaxData = {\n            type: \"dataset_collection\",\n            collection_type: \"list:paired\",\n            hide_source_items: self.hideOriginals || false,\n            name: _.escape(name || self.$(\".collection-name\").val()),\n            element_identifiers: self.paired.map(function (pair) {\n                return self._pairToJSON(pair);\n            })\n        };\n        //this.debug( JSON.stringify( ajaxData ) );\n        self.blocking = true;\n        return jQuery.ajax(url, {\n            type: \"POST\",\n            contentType: \"application/json\",\n            dataType: \"json\",\n            data: JSON.stringify(ajaxData)\n        }).always(function () {\n            self.blocking = false;\n        }).fail(function (xhr, status, message) {\n            self._ajaxErrHandler(xhr, status, message);\n        }).done(function (response, message, xhr) {\n            //this.info( 'ok', response, message, xhr );\n            self.trigger(\"collection:created\", response, message, xhr);\n            self.metric(\"collection:created\", response);\n            if (typeof self.oncreate === \"function\") {\n                self.oncreate.call(this, response, message, xhr);\n            }\n        });\n    },\n\n    /** handle ajax errors with feedback and details to the user (if available) */\n    _ajaxErrHandler: function _ajaxErrHandler(xhr, status, message) {\n        this.error(xhr, status, message);\n        var self = this;\n        var content = (0, _localization2.default)(\"An error occurred while creating this collection\");\n        if (xhr) {\n            if (xhr.readyState === 0 && xhr.status === 0) {\n                content += \": \" + (0, _localization2.default)(\"Galaxy could not be reached and may be updating.\") + (0, _localization2.default)(\" Try again in a few minutes.\");\n            } else if (xhr.responseJSON) {\n                content += \"<br /><pre>\" + JSON.stringify(xhr.responseJSON) + \"</pre>\";\n            } else {\n                content += \": \" + message;\n            }\n        }\n        self._showAlert(content, \"alert-danger\");\n    },\n\n    // ------------------------------------------------------------------------ rendering\n    /** render the entire interface */\n    render: function render(speed, callback) {\n        //this.debug( '-- _render' );\n        //this.$el.empty().html( this.templates.main() );\n        this.$el.empty().html(this.templates.main());\n        this._renderHeader(speed);\n        this._renderMiddle(speed);\n        this._renderFooter(speed);\n        this._addPluginComponents();\n        this.trigger(\"rendered\", this);\n        return this;\n    },\n\n    /** render the header section */\n    _renderHeader: function _renderHeader(speed, callback) {\n        //this.debug( '-- _renderHeader' );\n        var $header = this.$(\".header\").empty().html(this.templates.header()).find(\".help-content\").prepend($(this.templates.helpContent()));\n\n        this._renderFilters();\n        return $header;\n    },\n    /** fill the filter inputs with the filter values */\n    _renderFilters: function _renderFilters() {\n        return this.$(\".forward-column .column-header input\").val(this.filters[0]).add(this.$(\".reverse-column .column-header input\").val(this.filters[1]));\n    },\n\n    /** render the middle including unpaired and paired sections (which may be hidden) */\n    _renderMiddle: function _renderMiddle(speed, callback) {\n        var $middle = this.$(\".middle\").empty().html(this.templates.middle());\n\n        // (re-) hide the un/paired panels based on instance vars\n        if (this.unpairedPanelHidden) {\n            this.$(\".unpaired-columns\").hide();\n        } else if (this.pairedPanelHidden) {\n            this.$(\".paired-columns\").hide();\n        }\n\n        this._renderUnpaired();\n        this._renderPaired();\n        return $middle;\n    },\n    /** render the unpaired section, showing datasets accrd. to filters, update the unpaired counts */\n    _renderUnpaired: function _renderUnpaired(speed, callback) {\n        //this.debug( '-- _renderUnpaired' );\n        var self = this;\n\n        var $fwd;\n        var $rev;\n        var $prd = [];\n        var split = this._splitByFilters();\n        // update unpaired counts\n        this.$(\".forward-column .title\").text([split[0].length, (0, _localization2.default)(\"unpaired forward\")].join(\" \"));\n        this.$(\".forward-column .unpaired-info\").text(this._renderUnpairedDisplayStr(this.unpaired.length - split[0].length));\n        this.$(\".reverse-column .title\").text([split[1].length, (0, _localization2.default)(\"unpaired reverse\")].join(\" \"));\n        this.$(\".reverse-column .unpaired-info\").text(this._renderUnpairedDisplayStr(this.unpaired.length - split[1].length));\n\n        this.$(\".unpaired-columns .column-datasets\").empty();\n\n        // show/hide the auto pair button if any unpaired are left\n        this.$(\".autopair-link\").toggle(this.unpaired.length !== 0);\n        if (this.unpaired.length === 0) {\n            this._renderUnpairedEmpty();\n            return;\n        }\n\n        // create the dataset dom arrays\n        $rev = split[1].map(function (dataset, i) {\n            // if there'll be a fwd dataset across the way, add a button to pair the row\n            if (split[0][i] !== undefined && split[0][i] !== dataset) {\n                $prd.push(self._renderPairButton());\n            }\n            return self._renderUnpairedDataset(dataset);\n        });\n        $fwd = split[0].map(function (dataset) {\n            return self._renderUnpairedDataset(dataset);\n        });\n\n        if (!$fwd.length && !$rev.length) {\n            this._renderUnpairedNotShown();\n            return;\n        }\n        // add to appropo cols\n        //TODO: not the best way to render - consider rendering the entire unpaired-columns section in a fragment\n        //  and swapping out that\n        this.$(\".unpaired-columns .forward-column .column-datasets\").append($fwd).add(this.$(\".unpaired-columns .paired-column .column-datasets\").append($prd)).add(this.$(\".unpaired-columns .reverse-column .column-datasets\").append($rev));\n        this._adjUnpairedOnScrollbar();\n    },\n    /** return a string to display the count of filtered out datasets */\n    _renderUnpairedDisplayStr: function _renderUnpairedDisplayStr(numFiltered) {\n        return [\"(\", numFiltered, \" \", (0, _localization2.default)(\"filtered out\"), \")\"].join(\"\");\n    },\n    /** return an unattached jQuery DOM element to represent an unpaired dataset */\n    _renderUnpairedDataset: function _renderUnpairedDataset(dataset) {\n        //TODO: to underscore template\n        return $(\"<li/>\").attr(\"id\", \"dataset-\" + dataset.id).addClass(\"dataset unpaired\").attr(\"draggable\", true).addClass(dataset.selected ? \"selected\" : \"\").append($(\"<span/>\").addClass(\"dataset-name\").text(dataset.name))\n        //??\n        .data(\"dataset\", dataset);\n    },\n    /** render the button that may go between unpaired datasets, allowing the user to pair a row */\n    _renderPairButton: function _renderPairButton() {\n        //TODO: *not* a dataset - don't pretend like it is\n        return $(\"<li/>\").addClass(\"dataset unpaired\").append($(\"<span/>\").addClass(\"dataset-name\").text((0, _localization2.default)(\"Pair these datasets\")));\n    },\n    /** a message to display when no unpaired left */\n    _renderUnpairedEmpty: function _renderUnpairedEmpty() {\n        //this.debug( '-- renderUnpairedEmpty' );\n        var $msg = $('<div class=\"empty-message\"></div>').text(\"(\" + (0, _localization2.default)(\"no remaining unpaired datasets\") + \")\");\n        this.$(\".unpaired-columns .paired-column .column-datasets\").empty().prepend($msg);\n        return $msg;\n    },\n    /** a message to display when no unpaired can be shown with the current filters */\n    _renderUnpairedNotShown: function _renderUnpairedNotShown() {\n        //this.debug( '-- renderUnpairedEmpty' );\n        var $msg = $('<div class=\"empty-message\"></div>').text(\"(\" + (0, _localization2.default)(\"no datasets were found matching the current filters\") + \")\");\n        this.$(\".unpaired-columns .paired-column .column-datasets\").empty().prepend($msg);\n        return $msg;\n    },\n    /** try to detect if the unpaired section has a scrollbar and adjust left column for better centering of all */\n    _adjUnpairedOnScrollbar: function _adjUnpairedOnScrollbar() {\n        var $unpairedColumns = this.$(\".unpaired-columns\").last();\n\n        var $firstDataset = this.$(\".unpaired-columns .reverse-column .dataset\").first();\n\n        if (!$firstDataset.length) {\n            return;\n        }\n\n        var ucRight = $unpairedColumns.offset().left + $unpairedColumns.outerWidth();\n\n        var dsRight = $firstDataset.offset().left + $firstDataset.outerWidth();\n\n        var rightDiff = Math.floor(ucRight) - Math.floor(dsRight);\n        //this.debug( 'rightDiff:', ucRight, '-', dsRight, '=', rightDiff );\n        this.$(\".unpaired-columns .forward-column\").css(\"margin-left\", rightDiff > 0 ? rightDiff : 0);\n    },\n\n    /** render the paired section and update counts of paired datasets */\n    _renderPaired: function _renderPaired(speed, callback) {\n        //this.debug( '-- _renderPaired' );\n        this.$(\".paired-column-title .title\").text([this.paired.length, (0, _localization2.default)(\"paired\")].join(\" \"));\n        // show/hide the unpair all link\n        this.$(\".unpair-all-link\").toggle(this.paired.length !== 0);\n        if (this.paired.length === 0) {\n            this._renderPairedEmpty();\n            return;\n            //TODO: would be best to return here (the $columns)\n        } else {\n            // show/hide 'remove extensions link' when any paired and they seem to have extensions\n            this.$(\".remove-extensions-link\").show();\n        }\n\n        this.$(\".paired-columns .column-datasets\").empty();\n        var self = this;\n        this.paired.forEach(function (pair, i) {\n            //TODO: cache these?\n            var pairView = new PairView({ pair: pair });\n            self.$(\".paired-columns .column-datasets\").append(pairView.render().$el).append(['<button class=\"unpair-btn\">', '<span class=\"fa fa-unlink\" title=\"', (0, _localization2.default)(\"Unpair\"), '\"></span>', \"</button>\"].join(\"\"));\n        });\n    },\n    /** a message to display when none paired */\n    _renderPairedEmpty: function _renderPairedEmpty() {\n        var $msg = $('<div class=\"empty-message\"></div>').text(\"(\" + (0, _localization2.default)(\"no paired datasets yet\") + \")\");\n        this.$(\".paired-columns .column-datasets\").empty().prepend($msg);\n        return $msg;\n    },\n\n    footerSettings: {\n        \".hide-originals\": \"hideOriginals\",\n        \".remove-extensions\": \"removeExtensions\"\n    },\n\n    /** add any jQuery/bootstrap/custom plugins to elements rendered */\n    _addPluginComponents: function _addPluginComponents() {\n        this._chooseFiltersPopover(\".choose-filters-link\");\n        this.$(\".help-content i\").hoverhighlight(\".collection-creator\", \"rgba( 64, 255, 255, 1.0 )\");\n    },\n\n    /** build a filter selection popover allowing selection of common filter pairs */\n    _chooseFiltersPopover: function _chooseFiltersPopover(selector) {\n        function filterChoice(val1, val2) {\n            return ['<button class=\"filter-choice btn\" ', 'data-forward=\"', val1, '\" data-reverse=\"', val2, '\">', (0, _localization2.default)(\"Forward\"), \": \", val1, \", \", (0, _localization2.default)(\"Reverse\"), \": \", val2, \"</button>\"].join(\"\");\n        }\n        var $popoverContent = $(_.template(['<div class=\"choose-filters\">', '<div class=\"help\">', (0, _localization2.default)(\"Choose from the following filters to change which unpaired reads are shown in the display\"), \":</div>\", _.values(this.commonFilters).map(function (filterSet) {\n            return filterChoice(filterSet[0], filterSet[1]);\n        }).join(\"\"), \"</div>\"].join(\"\"))({}));\n\n        return this.$(selector).popover({\n            container: \".collection-creator\",\n            placement: \"bottom\",\n            html: true,\n            //animation   : false,\n            content: $popoverContent\n        });\n    },\n\n    /** add (or clear if clear is truthy) a validation warning to what */\n    _validationWarning: function _validationWarning(what, clear) {\n        var VALIDATION_CLASS = \"validation-warning\";\n        if (what === \"name\") {\n            what = this.$(\".collection-name\").add(this.$(\".collection-name-prompt\"));\n            this.$(\".collection-name\").focus().select();\n        }\n        if (clear) {\n            what = what || this.$(\".\" + VALIDATION_CLASS);\n            what.removeClass(VALIDATION_CLASS);\n        } else {\n            what.addClass(VALIDATION_CLASS);\n        }\n    },\n\n    // ------------------------------------------------------------------------ events\n    /** set up event handlers on self */\n    _setUpBehaviors: function _setUpBehaviors() {\n        this.once(\"rendered\", function () {\n            this.trigger(\"rendered:initial\", this);\n        });\n\n        this.on(\"pair:new\", function () {\n            //TODO: ideally only re-render the columns (or even elements) involved\n            this._renderUnpaired();\n            this._renderPaired();\n\n            // scroll to bottom where new pairs are added\n            //TODO: this doesn't seem to work - innerHeight sticks at 133...\n            //  may have to do with improper flex columns\n            //var $pairedView = this.$( '.paired-columns' );\n            //$pairedView.scrollTop( $pairedView.innerHeight() );\n            //this.debug( $pairedView.height() )\n            this.$(\".paired-columns\").scrollTop(8000000);\n        });\n        this.on(\"pair:unpair\", function (pairs) {\n            //TODO: ideally only re-render the columns (or even elements) involved\n            this._renderUnpaired();\n            this._renderPaired();\n            this.splitView();\n        });\n\n        this.on(\"filter-change\", function () {\n            this.filters = [this.$(\".forward-unpaired-filter input\").val(), this.$(\".reverse-unpaired-filter input\").val()];\n            this.metric(\"filter-change\", this.filters);\n            this._renderFilters();\n            this._renderUnpaired();\n        });\n\n        this.on(\"autopair\", function () {\n            this._renderUnpaired();\n            this._renderPaired();\n\n            var message;\n            var msgClass = null;\n            if (this.paired.length) {\n                msgClass = \"alert-success\";\n                message = this.paired.length + \" \" + (0, _localization2.default)(\"pairs created\");\n                if (!this.unpaired.length) {\n                    message += \": \" + (0, _localization2.default)(\"all datasets have been successfully paired\");\n                    this.hideUnpaired();\n                    this.$(\".collection-name\").focus();\n                }\n            } else {\n                message = (0, _localization2.default)([\"Could not automatically create any pairs from the given dataset names.\", \"You may want to choose or enter different filters and try auto-pairing again.\", \"Close this message using the X on the right to view more help.\"].join(\" \"));\n            }\n            this._showAlert(message, msgClass);\n        });\n\n        //this.on( 'all', function(){\n        //    this.info( arguments );\n        //});\n        return this;\n    },\n\n    events: {\n        // header\n        \"click .more-help\": \"_clickMoreHelp\",\n        \"click .less-help\": \"_clickLessHelp\",\n        \"click .main-help\": \"_toggleHelp\",\n        \"click .header .alert button\": \"_hideAlert\",\n        \"click .forward-column .column-title\": \"_clickShowOnlyUnpaired\",\n        \"click .reverse-column .column-title\": \"_clickShowOnlyUnpaired\",\n        \"click .unpair-all-link\": \"_clickUnpairAll\",\n        //TODO: this seems kinda backasswards - re-sending jq event as a backbone event, can we listen directly?\n        \"change .forward-unpaired-filter input\": function changeForwardUnpairedFilterInput(ev) {\n            this.trigger(\"filter-change\");\n        },\n        \"focus .forward-unpaired-filter input\": function focusForwardUnpairedFilterInput(ev) {\n            $(ev.currentTarget).select();\n        },\n        \"click .autopair-link\": \"_clickAutopair\",\n        \"click .choose-filters .filter-choice\": \"_clickFilterChoice\",\n        \"click .clear-filters-link\": \"_clearFilters\",\n        \"change .reverse-unpaired-filter input\": function changeReverseUnpairedFilterInput(ev) {\n            this.trigger(\"filter-change\");\n        },\n        \"focus .reverse-unpaired-filter input\": function focusReverseUnpairedFilterInput(ev) {\n            $(ev.currentTarget).select();\n        },\n        // unpaired\n        \"click .forward-column .dataset.unpaired\": \"_clickUnpairedDataset\",\n        \"click .reverse-column .dataset.unpaired\": \"_clickUnpairedDataset\",\n        \"click .paired-column .dataset.unpaired\": \"_clickPairRow\",\n        \"click .unpaired-columns\": \"clearSelectedUnpaired\",\n        \"mousedown .unpaired-columns .dataset\": \"_mousedownUnpaired\",\n        // divider\n        \"click .paired-column-title\": \"_clickShowOnlyPaired\",\n        \"mousedown .flexible-partition-drag\": \"_startPartitionDrag\",\n        // paired\n        \"click .paired-columns .dataset.paired\": \"selectPair\",\n        \"click .paired-columns\": \"clearSelectedPaired\",\n        \"click .paired-columns .pair-name\": \"_clickPairName\",\n        \"click .unpair-btn\": \"_clickUnpair\",\n        // paired - drop target\n        //'dragenter .paired-columns'                 : '_dragenterPairedColumns',\n        //'dragleave .paired-columns .column-datasets': '_dragleavePairedColumns',\n        \"dragover .paired-columns .column-datasets\": \"_dragoverPairedColumns\",\n        \"drop .paired-columns .column-datasets\": \"_dropPairedColumns\",\n\n        \"pair.dragstart .paired-columns .column-datasets\": \"_pairDragstart\",\n        \"pair.dragend   .paired-columns .column-datasets\": \"_pairDragend\",\n\n        // footer\n        \"change .remove-extensions\": function changeRemoveExtensions(ev) {\n            this.toggleExtensions();\n        },\n        \"change .collection-name\": \"_changeName\",\n        \"keydown .collection-name\": \"_nameCheckForEnter\",\n        \"change .hide-originals\": \"_changeHideOriginals\",\n        \"click .cancel-create\": \"_cancelCreate\",\n        \"click .create-collection\": \"_clickCreate\" //,\n    },\n\n    /** toggle between showing only unpaired and split view */\n    _clickShowOnlyUnpaired: function _clickShowOnlyUnpaired(ev) {\n        //this.debug( 'click unpaired', ev.currentTarget );\n        if (this.$(\".paired-columns\").is(\":visible\")) {\n            this.hidePaired();\n        } else {\n            this.splitView();\n        }\n    },\n    /** toggle between showing only paired and split view */\n    _clickShowOnlyPaired: function _clickShowOnlyPaired(ev) {\n        //this.debug( 'click paired' );\n        if (this.$(\".unpaired-columns\").is(\":visible\")) {\n            this.hideUnpaired();\n        } else {\n            this.splitView();\n        }\n    },\n\n    /** hide unpaired, show paired */\n    hideUnpaired: function hideUnpaired(speed, callback) {\n        this.unpairedPanelHidden = true;\n        this.pairedPanelHidden = false;\n        this._renderMiddle(speed, callback);\n    },\n    /** hide paired, show unpaired */\n    hidePaired: function hidePaired(speed, callback) {\n        this.unpairedPanelHidden = false;\n        this.pairedPanelHidden = true;\n        this._renderMiddle(speed, callback);\n    },\n    /** show both paired and unpaired (splitting evenly) */\n    splitView: function splitView(speed, callback) {\n        this.unpairedPanelHidden = this.pairedPanelHidden = false;\n        this._renderMiddle(speed, callback);\n        return this;\n    },\n\n    /** unpair all paired and do other super neat stuff which I'm not really sure about yet... */\n    _clickUnpairAll: function _clickUnpairAll(ev) {\n        this.metric(\"unpairAll\");\n        this.unpairAll();\n    },\n\n    /** attempt to autopair */\n    _clickAutopair: function _clickAutopair(ev) {\n        var paired = this.autoPair();\n        this.metric(\"autopair\", paired.length, this.unpaired.length);\n        this.trigger(\"autopair\");\n    },\n\n    /** set the filters based on the data attributes of the button click target */\n    _clickFilterChoice: function _clickFilterChoice(ev) {\n        var $selected = $(ev.currentTarget);\n        this.$(\".forward-unpaired-filter input\").val($selected.data(\"forward\"));\n        this.$(\".reverse-unpaired-filter input\").val($selected.data(\"reverse\"));\n        this._hideChooseFilters();\n        this.trigger(\"filter-change\");\n    },\n\n    /** hide the choose filters popover */\n    _hideChooseFilters: function _hideChooseFilters() {\n        //TODO: update bootstrap and remove the following hack\n        //  see also: https://github.com/twbs/bootstrap/issues/10260\n        this.$(\".choose-filters-link\").popover(\"hide\");\n        this.$(\".popover\").css(\"display\", \"none\");\n    },\n\n    /** clear both filters */\n    _clearFilters: function _clearFilters(ev) {\n        this.$(\".forward-unpaired-filter input\").val(\"\");\n        this.$(\".reverse-unpaired-filter input\").val(\"\");\n        this.trigger(\"filter-change\");\n    },\n\n    // ........................................................................ unpaired\n    /** select an unpaired dataset */\n    _clickUnpairedDataset: function _clickUnpairedDataset(ev) {\n        ev.stopPropagation();\n        return this.toggleSelectUnpaired($(ev.currentTarget));\n    },\n\n    /** Toggle the selection of an unpaired dataset representation.\n     *  @param [jQuery] $dataset        the unpaired dataset dom rep to select\n     *  @param [Boolean] options.force  if defined, force selection based on T/F; otherwise, toggle\n     */\n    toggleSelectUnpaired: function toggleSelectUnpaired($dataset, options) {\n        options = options || {};\n        var dataset = $dataset.data(\"dataset\");\n\n        var select = options.force !== undefined ? options.force : !$dataset.hasClass(\"selected\");\n\n        //this.debug( id, options.force, $dataset, dataset );\n        if (!$dataset.length || dataset === undefined) {\n            return $dataset;\n        }\n\n        if (select) {\n            $dataset.addClass(\"selected\");\n            if (!options.waitToPair) {\n                this.pairAllSelected();\n            }\n        } else {\n            $dataset.removeClass(\"selected\");\n            //delete dataset.selected;\n        }\n        return $dataset;\n    },\n\n    /** pair all the currently selected unpaired datasets */\n    pairAllSelected: function pairAllSelected(options) {\n        options = options || {};\n        var self = this;\n        var fwds = [];\n        var revs = [];\n        var pairs = [];\n        self.$(\".unpaired-columns .forward-column .dataset.selected\").each(function () {\n            fwds.push($(this).data(\"dataset\"));\n        });\n        self.$(\".unpaired-columns .reverse-column .dataset.selected\").each(function () {\n            revs.push($(this).data(\"dataset\"));\n        });\n        fwds.length = revs.length = Math.min(fwds.length, revs.length);\n        //this.debug( fwds );\n        //this.debug( revs );\n        fwds.forEach(function (fwd, i) {\n            try {\n                pairs.push(self._pair(fwd, revs[i], { silent: true }));\n            } catch (err) {\n                //TODO: preserve selected state of those that couldn't be paired\n                //TODO: warn that some could not be paired\n                self.error(err);\n            }\n        });\n        if (pairs.length && !options.silent) {\n            this.trigger(\"pair:new\", pairs);\n        }\n        return pairs;\n    },\n\n    /** clear the selection on all unpaired datasets */\n    clearSelectedUnpaired: function clearSelectedUnpaired() {\n        this.$(\".unpaired-columns .dataset.selected\").removeClass(\"selected\");\n    },\n\n    /** when holding down the shift key on a click, 'paint' the moused over datasets as selected */\n    _mousedownUnpaired: function _mousedownUnpaired(ev) {\n        if (ev.shiftKey) {\n            var self = this;\n            var $startTarget = $(ev.target).addClass(\"selected\");\n\n            var moveListener = function moveListener(ev) {\n                self.$(ev.target).filter(\".dataset\").addClass(\"selected\");\n            };\n\n            $startTarget.parent().on(\"mousemove\", moveListener);\n\n            // on any mouseup, stop listening to the move and try to pair any selected\n            $(document).one(\"mouseup\", function (ev) {\n                $startTarget.parent().off(\"mousemove\", moveListener);\n                self.pairAllSelected();\n            });\n        }\n    },\n\n    /** attempt to pair two datasets directly across from one another */\n    _clickPairRow: function _clickPairRow(ev) {\n        //if( !ev.currentTarget ){ return true; }\n        var rowIndex = $(ev.currentTarget).index();\n\n        var fwd = $(\".unpaired-columns .forward-column .dataset\").eq(rowIndex).data(\"dataset\");\n\n        var rev = $(\".unpaired-columns .reverse-column .dataset\").eq(rowIndex).data(\"dataset\");\n\n        //this.debug( 'row:', rowIndex, fwd, rev );\n        this._pair(fwd, rev);\n    },\n\n    // ........................................................................ divider/partition\n    /** start dragging the visible divider/partition between unpaired and paired panes */\n    _startPartitionDrag: function _startPartitionDrag(ev) {\n        var self = this;\n        var startingY = ev.pageY;\n        //this.debug( 'partition drag START:', ev );\n        $(\"body\").css(\"cursor\", \"ns-resize\");\n        self.$(\".flexible-partition-drag\").css(\"color\", \"black\");\n\n        function endDrag(ev) {\n            self.$(\".flexible-partition-drag\").css(\"color\", \"\");\n            $(\"body\").css(\"cursor\", \"\").unbind(\"mousemove\", trackMouse);\n        }\n        function trackMouse(ev) {\n            var offset = ev.pageY - startingY;\n            if (!self.adjPartition(offset)) {\n                $(\"body\").trigger(\"mouseup\");\n            }\n            self._adjUnpairedOnScrollbar();\n            startingY += offset;\n        }\n        $(\"body\").mousemove(trackMouse);\n        $(\"body\").one(\"mouseup\", endDrag);\n    },\n\n    /** adjust the parition up/down +/-adj pixels */\n    adjPartition: function adjPartition(adj) {\n        var $unpaired = this.$(\".unpaired-columns\");\n        var $paired = this.$(\".paired-columns\");\n        var unpairedHi = parseInt($unpaired.css(\"height\"), 10);\n        var pairedHi = parseInt($paired.css(\"height\"), 10);\n        //this.debug( adj, 'hi\\'s:', unpairedHi, pairedHi, unpairedHi + adj, pairedHi - adj );\n\n        unpairedHi = Math.max(10, unpairedHi + adj);\n        pairedHi = pairedHi - adj;\n\n        var movingUpwards = adj < 0;\n        // when the divider gets close to the top - lock into hiding the unpaired section\n        if (movingUpwards) {\n            if (this.unpairedPanelHidden) {\n                return false;\n            } else if (unpairedHi <= 10) {\n                this.hideUnpaired();\n                return false;\n            }\n        } else {\n            if (this.unpairedPanelHidden) {\n                $unpaired.show();\n                this.unpairedPanelHidden = false;\n            }\n        }\n\n        // when the divider gets close to the bottom - lock into hiding the paired section\n        if (!movingUpwards) {\n            if (this.pairedPanelHidden) {\n                return false;\n            } else if (pairedHi <= 15) {\n                this.hidePaired();\n                return false;\n            }\n        } else {\n            if (this.pairedPanelHidden) {\n                $paired.show();\n                this.pairedPanelHidden = false;\n            }\n        }\n\n        $unpaired.css({\n            height: unpairedHi + \"px\",\n            flex: \"0 0 auto\"\n        });\n        return true;\n    },\n\n    // ........................................................................ paired\n    /** select a pair when clicked */\n    selectPair: function selectPair(ev) {\n        ev.stopPropagation();\n        $(ev.currentTarget).toggleClass(\"selected\");\n    },\n\n    /** deselect all pairs */\n    clearSelectedPaired: function clearSelectedPaired(ev) {\n        this.$(\".paired-columns .dataset.selected\").removeClass(\"selected\");\n    },\n\n    /** rename a pair when the pair name is clicked */\n    _clickPairName: function _clickPairName(ev) {\n        ev.stopPropagation();\n        var $name = $(ev.currentTarget);\n        var $pair = $name.parent().parent();\n        var index = $pair.index(\".dataset.paired\");\n        var pair = this.paired[index];\n        var response = prompt(\"Enter a new name for the pair:\", pair.name);\n        if (response) {\n            pair.name = response;\n            // set a flag (which won't be passed in json creation) for manual naming so we don't overwrite these\n            //  when adding/removing extensions\n            //hackish\n            pair.customizedName = true;\n            $name.text(pair.name);\n        }\n    },\n\n    /** unpair this pair */\n    _clickUnpair: function _clickUnpair(ev) {\n        //if( !ev.currentTarget ){ return true; }\n        var pairIndex = Math.floor($(ev.currentTarget).index(\".unpair-btn\"));\n        //this.debug( 'pair:', pairIndex );\n        this._unpair(this.paired[pairIndex]);\n    },\n\n    // ........................................................................ paired - drag and drop re-ordering\n    //_dragenterPairedColumns : function( ev ){\n    //    this.debug( '_dragenterPairedColumns:', ev );\n    //},\n    //_dragleavePairedColumns : function( ev ){\n    //    //this.debug( '_dragleavePairedColumns:', ev );\n    //},\n    /** track the mouse drag over the paired list adding a placeholder to show where the drop would occur */\n    _dragoverPairedColumns: function _dragoverPairedColumns(ev) {\n        //this.debug( '_dragoverPairedColumns:', ev );\n        ev.preventDefault();\n\n        var $list = this.$(\".paired-columns .column-datasets\");\n        this._checkForAutoscroll($list, ev.originalEvent.clientY);\n        //this.debug( ev.originalEvent.clientX, ev.originalEvent.clientY );\n        var $nearest = this._getNearestPairedDatasetLi(ev.originalEvent.clientY);\n\n        $(\".element-drop-placeholder\").remove();\n        var $placeholder = $('<div class=\"element-drop-placeholder\"></div>');\n        if (!$nearest.length) {\n            $list.append($placeholder);\n        } else {\n            $nearest.before($placeholder);\n        }\n    },\n\n    /** If the mouse is near enough to the list's top or bottom, scroll the list */\n    _checkForAutoscroll: function _checkForAutoscroll($element, y) {\n        var AUTOSCROLL_SPEED = 2;\n        var offset = $element.offset();\n        var scrollTop = $element.scrollTop();\n        var upperDist = y - offset.top;\n        var lowerDist = offset.top + $element.outerHeight() - y;\n        //this.debug( '_checkForAutoscroll:', scrollTop, upperDist, lowerDist );\n        if (upperDist >= 0 && upperDist < this.autoscrollDist) {\n            $element.scrollTop(scrollTop - AUTOSCROLL_SPEED);\n        } else if (lowerDist >= 0 && lowerDist < this.autoscrollDist) {\n            $element.scrollTop(scrollTop + AUTOSCROLL_SPEED);\n        }\n    },\n\n    /** get the nearest *previous* paired dataset PairView based on the mouse's Y coordinate.\n     *      If the y is at the end of the list, return an empty jQuery object.\n     */\n    _getNearestPairedDatasetLi: function _getNearestPairedDatasetLi(y) {\n        var WIGGLE = 4;\n        var lis = this.$(\".paired-columns .column-datasets li\").toArray();\n        for (var i = 0; i < lis.length; i++) {\n            var $li = $(lis[i]);\n            var top = $li.offset().top;\n            var halfHeight = Math.floor($li.outerHeight() / 2) + WIGGLE;\n            if (top + halfHeight > y && top - halfHeight < y) {\n                //this.debug( y, top + halfHeight, top - halfHeight )\n                return $li;\n            }\n        }\n        return $();\n    },\n    /** drop (dragged/selected PairViews) onto the list, re-ordering both the DOM and the internal array of pairs */\n    _dropPairedColumns: function _dropPairedColumns(ev) {\n        // both required for firefox\n        ev.preventDefault();\n        ev.dataTransfer.dropEffect = \"move\";\n\n        var $nearest = this._getNearestPairedDatasetLi(ev.originalEvent.clientY);\n        if ($nearest.length) {\n            this.$dragging.insertBefore($nearest);\n        } else {\n            // no nearest before - insert after last element (unpair button)\n            this.$dragging.insertAfter(this.$(\".paired-columns .unpair-btn\").last());\n        }\n        // resync the creator's list of paired based on the new DOM order\n        this._syncPairsToDom();\n        return false;\n    },\n    /** resync the creator's list of paired based on the DOM order of pairs */\n    _syncPairsToDom: function _syncPairsToDom() {\n        var newPaired = [];\n        //TODO: doesn't seem wise to use the dom to store these - can't we sync another way?\n        this.$(\".paired-columns .dataset.paired\").each(function () {\n            newPaired.push($(this).data(\"pair\"));\n        });\n        //this.debug( newPaired );\n        this.paired = newPaired;\n        this._renderPaired();\n    },\n    /** drag communication with pair sub-views: dragstart */\n    _pairDragstart: function _pairDragstart(ev, pair) {\n        //this.debug( '_pairDragstart', ev, pair )\n        // auto select the pair causing the event and move all selected\n        pair.$el.addClass(\"selected\");\n        var $selected = this.$(\".paired-columns .dataset.selected\");\n        this.$dragging = $selected;\n    },\n    /** drag communication with pair sub-views: dragend - remove the placeholder */\n    _pairDragend: function _pairDragend(ev, pair) {\n        //this.debug( '_pairDragend', ev, pair )\n        $(\".element-drop-placeholder\").remove();\n        this.$dragging = null;\n    },\n\n    // ........................................................................ footer\n    toggleExtensions: function toggleExtensions(force) {\n        var self = this;\n        self.removeExtensions = force !== undefined ? force : !self.removeExtensions;\n\n        _.each(self.paired, function (pair) {\n            // don't overwrite custom names\n            if (pair.customizedName) {\n                return;\n            }\n            pair.name = self._guessNameForPair(pair.forward, pair.reverse);\n        });\n\n        self._renderPaired();\n        self._renderFooter();\n    },\n\n    // ------------------------------------------------------------------------ misc\n    /** debug a dataset list */\n    _printList: function _printList(list) {\n        var self = this;\n        _.each(list, function (e) {\n            if (list === self.paired) {\n                self._printPair(e);\n            } else {\n                self.debug(e);\n            }\n        });\n    },\n\n    /** print a pair Object */\n    _printPair: function _printPair(pair) {\n        this.debug(pair.forward.name, pair.reverse.name, \": ->\", pair.name);\n    },\n\n    /** string rep */\n    toString: function toString() {\n        return \"PairedCollectionCreator\";\n    },\n\n    templates: _.extend({}, _baseCreator2.default.CollectionCreatorMixin._creatorTemplates, {\n        /** the header (not including help text) */\n        header: _.template(['<div class=\"main-help well clear\">', '<a class=\"more-help\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"More help\"), \"</a>\", '<div class=\"help-content\">', '<a class=\"less-help\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Less\"), \"</a>\", \"</div>\", \"</div>\", '<div class=\"alert alert-dismissable\">', '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-hidden=\"true\">&times;</button>', '<span class=\"alert-message\"></span>', \"</div>\", '<div class=\"column-headers vertically-spaced flex-column-container\">', '<div class=\"forward-column flex-column column\">', '<div class=\"column-header\">', '<div class=\"column-title\">', '<span class=\"title\">', (0, _localization2.default)(\"Unpaired forward\"), \"</span>\", '<span class=\"title-info unpaired-info\"></span>', \"</div>\", '<div class=\"unpaired-filter forward-unpaired-filter pull-left\">', '<input class=\"search-query\" placeholder=\"', (0, _localization2.default)(\"Filter this list\"), '\" />', \"</div>\", \"</div>\", \"</div>\", '<div class=\"paired-column flex-column no-flex column\">', '<div class=\"column-header\">', '<a class=\"choose-filters-link\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"Choose filters\"), \"</a>\", '<a class=\"clear-filters-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Clear filters\"), \"</a><br />\", '<a class=\"autopair-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Auto-pair\"), \"</a>\", \"</div>\", \"</div>\", '<div class=\"reverse-column flex-column column\">', '<div class=\"column-header\">', '<div class=\"column-title\">', '<span class=\"title\">', (0, _localization2.default)(\"Unpaired reverse\"), \"</span>\", '<span class=\"title-info unpaired-info\"></span>', \"</div>\", '<div class=\"unpaired-filter reverse-unpaired-filter pull-left\">', '<input class=\"search-query\" placeholder=\"', (0, _localization2.default)(\"Filter this list\"), '\" />', \"</div>\", \"</div>\", \"</div>\", \"</div>\"].join(\"\")),\n\n        /** the middle: unpaired, divider, and paired */\n        middle: _.template([\n        // contains two flex rows (rows that fill available space) and a divider btwn\n        '<div class=\"unpaired-columns flex-column-container scroll-container flex-row\">', '<div class=\"forward-column flex-column column\">', '<ol class=\"column-datasets\"></ol>', \"</div>\", '<div class=\"paired-column flex-column no-flex column\">', '<ol class=\"column-datasets\"></ol>', \"</div>\", '<div class=\"reverse-column flex-column column\">', '<ol class=\"column-datasets\"></ol>', \"</div>\", \"</div>\", '<div class=\"flexible-partition\">', '<div class=\"flexible-partition-drag\" title=\"', (0, _localization2.default)(\"Drag to change\"), '\"></div>', '<div class=\"column-header\">', '<div class=\"column-title paired-column-title\">', '<span class=\"title\"></span>', \"</div>\", '<a class=\"unpair-all-link\" href=\"javascript:void(0);\">', (0, _localization2.default)(\"Unpair all\"), \"</a>\", \"</div>\", \"</div>\", '<div class=\"paired-columns flex-column-container scroll-container flex-row\">', '<ol class=\"column-datasets\"></ol>', \"</div>\"].join(\"\")),\n\n        /** creation and cancel controls */\n        footer: _.template(['<div class=\"attributes clear\">', '<div class=\"clear\">', '<label class=\"setting-prompt pull-right\">', (0, _localization2.default)(\"Hide original elements\"), \"?\", '<input class=\"hide-originals pull-right\" type=\"checkbox\" />', \"</label>\", '<label class=\"setting-prompt pull-right\">', (0, _localization2.default)(\"Remove file extensions from pair names\"), \"?\", '<input class=\"remove-extensions pull-right\" type=\"checkbox\" />', \"</label>\", \"</div>\", '<div class=\"clear\">', '<input class=\"collection-name form-control pull-right\" ', 'placeholder=\"', (0, _localization2.default)(\"Enter a name for your new list\"), '\" />', '<div class=\"collection-name-prompt pull-right\">', (0, _localization2.default)(\"Name\"), \":</div>\", \"</div>\", \"</div>\", '<div class=\"actions clear vertically-spaced\">', '<div class=\"other-options pull-left\">', '<button class=\"cancel-create btn\" tabindex=\"-1\">', (0, _localization2.default)(\"Cancel\"), \"</button>\", '<div class=\"create-other btn-group dropup\">', '<button class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">', (0, _localization2.default)(\"Create a different kind of collection\"), ' <span class=\"caret\"></span>', \"</button>\", '<ul class=\"dropdown-menu\" role=\"menu\">', '<li><a href=\"#\">', (0, _localization2.default)(\"Create a <i>single</i> pair\"), \"</a></li>\", '<li><a href=\"#\">', (0, _localization2.default)(\"Create a list of <i>unpaired</i> datasets\"), \"</a></li>\", \"</ul>\", \"</div>\", \"</div>\", '<div class=\"main-options pull-right\">', '<button class=\"create-collection btn btn-primary\">', (0, _localization2.default)(\"Create list\"), \"</button>\", \"</div>\", \"</div>\"].join(\"\")),\n\n        /** help content */\n        helpContent: _.template([\"<p>\", (0, _localization2.default)([\"Collections of paired datasets are ordered lists of dataset pairs (often forward and reverse reads). \", \"These collections can be passed to tools and workflows in order to have analyses done on each member of \", \"the entire group. This interface allows you to create a collection, choose which datasets are paired, \", \"and re-order the final collection.\"].join(\"\")), \"</p>\", \"<p>\", (0, _localization2.default)(['Unpaired datasets are shown in the <i data-target=\".unpaired-columns\">unpaired section</i> ', \"(hover over the underlined words to highlight below). \", 'Paired datasets are shown in the <i data-target=\".paired-columns\">paired section</i>.', \"<ul>To pair datasets, you can:\", \"<li>Click a dataset in the \", '<i data-target=\".unpaired-columns .forward-column .column-datasets,', '.unpaired-columns .forward-column\">forward column</i> ', \"to select it then click a dataset in the \", '<i data-target=\".unpaired-columns .reverse-column .column-datasets,', '.unpaired-columns .reverse-column\">reverse column</i>.', \"</li>\", '<li>Click one of the \"Pair these datasets\" buttons in the ', '<i data-target=\".unpaired-columns .paired-column .column-datasets,', '.unpaired-columns .paired-column\">middle column</i> ', \"to pair the datasets in a particular row.\", \"</li>\", '<li>Click <i data-target=\".autopair-link\">\"Auto-pair\"</i> ', \"to have your datasets automatically paired based on name.\", \"</li>\", \"</ul>\"].join(\"\")), \"</p>\", \"<p>\", (0, _localization2.default)([\"<ul>You can filter what is shown in the unpaired sections by:\", \"<li>Entering partial dataset names in either the \", '<i data-target=\".forward-unpaired-filter input\">forward filter</i> or ', '<i data-target=\".reverse-unpaired-filter input\">reverse filter</i>.', \"</li>\", \"<li>Choosing from a list of preset filters by clicking the \", '<i data-target=\".choose-filters-link\">\"Choose filters\" link</i>.', \"</li>\", \"<li>Entering regular expressions to match dataset names. See: \", '<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions\"', ' target=\"_blank\">MDN\\'s JavaScript Regular Expression Tutorial</a>. ', \"Note: forward slashes (\\\\) are not needed.\", \"</li>\", \"<li>Clearing the filters by clicking the \", '<i data-target=\".clear-filters-link\">\"Clear filters\" link</i>.', \"</li>\", \"</ul>\"].join(\"\")), \"</p>\", \"<p>\", (0, _localization2.default)([\"To unpair individual dataset pairs, click the \", '<i data-target=\".unpair-btn\">unpair buttons ( <span class=\"fa fa-unlink\"></span> )</i>. ', 'Click the <i data-target=\".unpair-all-link\">\"Unpair all\" link</i> to unpair all pairs.'].join(\"\")), \"</p>\", \"<p>\", (0, _localization2.default)(['You can include or remove the file extensions (e.g. \".fastq\") from your pair names by toggling the ', '<i data-target=\".remove-extensions-prompt\">\"Remove file extensions from pair names?\"</i> control.'].join(\"\")), \"</p>\", \"<p>\", (0, _localization2.default)(['Once your collection is complete, enter a <i data-target=\".collection-name\">name</i> and ', 'click <i data-target=\".create-collection\">\"Create list\"</i>. ', \"(Note: you do not have to pair all unpaired datasets to finish.)\"].join(\"\")), \"</p>\"].join(\"\"))\n    })\n});\n\n//=============================================================================\n/** a modal version of the paired collection creator */\nvar pairedCollectionCreatorModal = function _pairedCollectionCreatorModal(datasets, options) {\n    var deferred = jQuery.Deferred();\n    var creator;\n\n    options = _.defaults(options || {}, {\n        datasets: datasets,\n        oncancel: function oncancel() {\n            Galaxy.modal.hide();\n            deferred.reject(\"cancelled\");\n        },\n        oncreate: function oncreate(creator, response) {\n            Galaxy.modal.hide();\n            deferred.resolve(response);\n        },\n        title: (0, _localization2.default)(\"Create a collection of paired datasets\")\n    });\n\n    if (!window.Galaxy || !Galaxy.modal) {\n        throw new Error(\"Galaxy or Galaxy.modal not found\");\n    }\n\n    creator = new PairedCollectionCreator(options);\n    Galaxy.modal.show({\n        title: options.title,\n        body: creator.$el,\n        width: \"80%\",\n        height: \"800px\",\n        closing_events: true\n    });\n    creator.render();\n    window.creator = creator;\n\n    //TODO: remove modal header\n    return deferred;\n};\n\n//=============================================================================\nfunction createListOfPairsCollection(collection, defaultHideSourceItems) {\n    var elements = collection.toJSON();\n    //TODO: validate elements\n    return pairedCollectionCreatorModal(elements, {\n        historyId: collection.historyId,\n        defaultHideSourceItems: defaultHideSourceItems\n    });\n}\n\n//=============================================================================\nexports.default = {\n    PairedCollectionCreator: PairedCollectionCreator,\n    pairedCollectionCreatorModal: pairedCollectionCreatorModal,\n    createListOfPairsCollection: createListOfPairsCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vbGlzdC1vZi1wYWlycy1jb2xsZWN0aW9uLWNyZWF0b3IuanM/M2E1OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbGV2ZW5zaHRlaW5EaXN0YW5jZSBmcm9tIFwidXRpbHMvbGV2ZW5zaHRlaW5cIjtcbmltcG9ydCBuYXR1cmFsU29ydCBmcm9tIFwidXRpbHMvbmF0dXJhbC1zb3J0XCI7XG5pbXBvcnQgYmFzZUNyZWF0b3IgZnJvbSBcIm12Yy9jb2xsZWN0aW9uL2Jhc2UtY3JlYXRvclwiO1xuaW1wb3J0IGJhc2VNVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbmltcG9ydCBcInVpL2hvdmVyaGlnaGxpZ2h0XCI7XG5cbnZhciBsb2dOYW1lc3BhY2UgPSBcImNvbGxlY3Rpb25zXCI7XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5UT0RPOlxuXG5cblBST0dSQU1NQVRJQ0FMTFk6XG5jdXJyUGFuZWwub25jZSggJ3JlbmRlcmVkJywgZnVuY3Rpb24oKXtcbiAgICBjdXJyUGFuZWwuc2hvd1NlbGVjdG9ycygpO1xuICAgIGN1cnJQYW5lbC5zZWxlY3RBbGwoKTtcbiAgICBfLmxhc3QoIGN1cnJQYW5lbC5hY3Rpb25zUG9wdXAub3B0aW9ucyApLmZ1bmMoKTtcbn0pO1xuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG4vKiogQSB2aWV3IGZvciBwYWlyZWQgZGF0YXNldHMgaW4gdGhlIGNvbGxlY3Rpb25zIGNyZWF0b3IuXG4gKi9cbnZhciBQYWlyVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKGJhc2VNVkMuTG9nZ2FibGVNaXhpbikuZXh0ZW5kKHtcbiAgICBfbG9nTmFtZXNwYWNlOiBsb2dOYW1lc3BhY2UsXG5cbiAgICB0YWdOYW1lOiBcImxpXCIsXG4gICAgY2xhc3NOYW1lOiBcImRhdGFzZXQgcGFpcmVkXCIsXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHRoaXMucGFpciA9IGF0dHJpYnV0ZXMucGFpciB8fCB7fTtcbiAgICB9LFxuXG4gICAgdGVtcGxhdGU6IF8udGVtcGxhdGUoXG4gICAgICAgIFtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cImZvcndhcmQtZGF0YXNldC1uYW1lIGZsZXgtY29sdW1uXCI+PCUtIHBhaXIuZm9yd2FyZC5uYW1lICU+PC9zcGFuPicsXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJwYWlyLW5hbWUtY29sdW1uIGZsZXgtY29sdW1uXCI+JyxcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInBhaXItbmFtZVwiPjwlLSBwYWlyLm5hbWUgJT48L3NwYW4+JyxcbiAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwicmV2ZXJzZS1kYXRhc2V0LW5hbWUgZmxleC1jb2x1bW5cIj48JS0gcGFpci5yZXZlcnNlLm5hbWUgJT48L3NwYW4+J1xuICAgICAgICBdLmpvaW4oXCJcIilcbiAgICApLFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5kcmFnU3RhcnRIYW5kbGVyID0gXy5iaW5kKHRoaXMuX2RyYWdzdGFydCwgdGhpcyk7XG4gICAgICAgIHRoaXMuZHJhZ0VuZEhhbmRsZXIgPSBfLmJpbmQodGhpcy5fZHJhZ2VuZCwgdGhpcyk7XG4gICAgICAgIHZhciBoYW5kbGUgPSB0aGlzLiRlbFxuICAgICAgICAgICAgLmF0dHIoXCJkcmFnZ2FibGVcIiwgdHJ1ZSlcbiAgICAgICAgICAgIC5kYXRhKFwicGFpclwiLCB0aGlzLnBhaXIpXG4gICAgICAgICAgICAuaHRtbCh0aGlzLnRlbXBsYXRlKHsgcGFpcjogdGhpcy5wYWlyIH0pKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwiZmxleC1jb2x1bW4tY29udGFpbmVyXCIpXG4gICAgICAgICAgICAuZ2V0KDApO1xuICAgICAgICBoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgaGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW5kXCIsIHRoaXMuZHJhZ0VuZEhhbmRsZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGV2ZW50czoge1xuICAgICAgICBkcmFnb3ZlcjogXCJfc2VuZFRvUGFyZW50XCIsXG4gICAgICAgIGRyb3A6IFwiX3NlbmRUb1BhcmVudFwiXG4gICAgfSxcblxuICAgIC8qKiBkcmFnZ2luZyBwYWlycyBmb3IgcmUtb3JkZXJpbmcgKi9cbiAgICBfZHJhZ3N0YXJ0OiBmdW5jdGlvbihldikge1xuICAgICAgICBldi5jdXJyZW50VGFyZ2V0LnN0eWxlLm9wYWNpdHkgPSBcIjAuNFwiO1xuICAgICAgICBpZiAoZXYub3JpZ2luYWxFdmVudCkge1xuICAgICAgICAgICAgZXYgPSBldi5vcmlnaW5hbEV2ZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgZXYuZGF0YVRyYW5zZmVyLmVmZmVjdEFsbG93ZWQgPSBcIm1vdmVcIjtcbiAgICAgICAgZXYuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIEpTT04uc3RyaW5naWZ5KHRoaXMucGFpcikpO1xuXG4gICAgICAgIHRoaXMuJGVsLnBhcmVudCgpLnRyaWdnZXIoXCJwYWlyLmRyYWdzdGFydFwiLCBbdGhpc10pO1xuICAgIH0sXG5cbiAgICAvKiogZHJhZ2dpbmcgcGFpcnMgZm9yIHJlLW9yZGVyaW5nICovXG4gICAgX2RyYWdlbmQ6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGV2LmN1cnJlbnRUYXJnZXQuc3R5bGUub3BhY2l0eSA9IFwiMS4wXCI7XG4gICAgICAgIHRoaXMuJGVsLnBhcmVudCgpLnRyaWdnZXIoXCJwYWlyLmRyYWdlbmRcIiwgW3RoaXNdKTtcbiAgICB9LFxuXG4gICAgLyoqIG1hbnVhbGx5IGJ1YmJsZSB1cCBhbiBldmVudCB0byB0aGUgcGFyZW50L2NvbnRhaW5lciAqL1xuICAgIF9zZW5kVG9QYXJlbnQ6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIHRoaXMuJGVsLnBhcmVudCgpLnRyaWdnZXIoZXYpO1xuICAgIH0sXG5cbiAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGBQYWlyVmlldygke3RoaXMucGFpci5uYW1lfSlgO1xuICAgIH1cbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogcmV0dXJucyBhbiBhdXRvcGFpciBmdW5jdGlvbiB0aGF0IHVzZXMgdGhlIHByb3ZpZGVkIG9wdGlvbnMubWF0Y2ggZnVuY3Rpb24gKi9cbmZ1bmN0aW9uIGF1dG9QYWlyRm5CdWlsZGVyKG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBvcHRpb25zLmNyZWF0ZVBhaXIgPVxuICAgICAgICBvcHRpb25zLmNyZWF0ZVBhaXIgfHxcbiAgICAgICAgZnVuY3Rpb24gX2RlZmF1bHRDcmVhdGVQYWlyKHBhcmFtcykge1xuICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xuICAgICAgICAgICAgdmFyIGEgPSBwYXJhbXMubGlzdEEuc3BsaWNlKHBhcmFtcy5pbmRleEEsIDEpWzBdO1xuICAgICAgICAgICAgdmFyIGIgPSBwYXJhbXMubGlzdEIuc3BsaWNlKHBhcmFtcy5pbmRleEIsIDEpWzBdO1xuICAgICAgICAgICAgdmFyIGFJbkJJbmRleCA9IHBhcmFtcy5saXN0Qi5pbmRleE9mKGEpO1xuICAgICAgICAgICAgdmFyIGJJbkFJbmRleCA9IHBhcmFtcy5saXN0QS5pbmRleE9mKGIpO1xuICAgICAgICAgICAgaWYgKGFJbkJJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMubGlzdEIuc3BsaWNlKGFJbkJJbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYkluQUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHBhcmFtcy5saXN0QS5zcGxpY2UoYkluQUluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYWlyKGEsIGIsIHsgc2lsZW50OiB0cnVlIH0pO1xuICAgICAgICB9O1xuICAgIC8vIGNvbXBpbGUgdGhlc2UgaGVyZSBvdXRzaWRlIG9mIHRoZSBsb29wXG4gICAgdmFyIF9yZWdleHBzID0gW107XG4gICAgZnVuY3Rpb24gZ2V0UmVnRXhwcygpIHtcbiAgICAgICAgaWYgKCFfcmVnZXhwcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIF9yZWdleHBzID0gW25ldyBSZWdFeHAodGhpcy5maWx0ZXJzWzBdKSwgbmV3IFJlZ0V4cCh0aGlzLmZpbHRlcnNbMV0pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3JlZ2V4cHM7XG4gICAgfVxuICAgIC8vIG1hbmdsZSBwYXJhbXMgYXMgbmVlZGVkXG4gICAgb3B0aW9ucy5wcmVwcm9jZXNzTWF0Y2ggPVxuICAgICAgICBvcHRpb25zLnByZXByb2Nlc3NNYXRjaCB8fFxuICAgICAgICBmdW5jdGlvbiBfZGVmYXVsdFByZXByb2Nlc3NNYXRjaChwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciByZWdleHBzID0gZ2V0UmVnRXhwcy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIF8uZXh0ZW5kKHBhcmFtcywge1xuICAgICAgICAgICAgICAgIG1hdGNoVG86IHBhcmFtcy5tYXRjaFRvLm5hbWUucmVwbGFjZShyZWdleHBzWzBdLCBcIlwiKSxcbiAgICAgICAgICAgICAgICBwb3NzaWJsZTogcGFyYW1zLnBvc3NpYmxlLm5hbWUucmVwbGFjZShyZWdleHBzWzFdLCBcIlwiKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gX3N0cmF0ZWd5KHBhcmFtcykge1xuICAgICAgICB0aGlzLmRlYnVnKFwiYXV0b3BhaXIgX3N0cmF0ZWd5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xuICAgICAgICB2YXIgbGlzdEEgPSBwYXJhbXMubGlzdEE7XG4gICAgICAgIHZhciBsaXN0QiA9IHBhcmFtcy5saXN0QjtcbiAgICAgICAgdmFyIGluZGV4QSA9IDA7XG4gICAgICAgIHZhciBpbmRleEI7XG5cbiAgICAgICAgdmFyIGJlc3RNYXRjaCA9IHtcbiAgICAgICAgICAgIHNjb3JlOiAwLjAsXG4gICAgICAgICAgICBpbmRleDogbnVsbFxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBwYWlyZWQgPSBbXTtcbiAgICAgICAgLy9jb25zb2xlLmRlYnVnKCAncGFyYW1zOicsIEpTT04uc3RyaW5naWZ5KCBwYXJhbXMsIG51bGwsICcgICcgKSApO1xuICAgICAgICB0aGlzLmRlYnVnKFwic3RhcnRpbmcgbGlzdCBsZW5zOlwiLCBsaXN0QS5sZW5ndGgsIGxpc3RCLmxlbmd0aCk7XG4gICAgICAgIHRoaXMuZGVidWcoXCJiZXN0TWF0Y2ggKHN0YXJ0aW5nKTpcIiwgSlNPTi5zdHJpbmdpZnkoYmVzdE1hdGNoLCBudWxsLCBcIiAgXCIpKTtcblxuICAgICAgICB3aGlsZSAoaW5kZXhBIDwgbGlzdEEubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgbWF0Y2hUbyA9IGxpc3RBW2luZGV4QV07XG4gICAgICAgICAgICBiZXN0TWF0Y2guc2NvcmUgPSAwLjA7XG5cbiAgICAgICAgICAgIGZvciAoaW5kZXhCID0gMDsgaW5kZXhCIDwgbGlzdEIubGVuZ3RoOyBpbmRleEIrKykge1xuICAgICAgICAgICAgICAgIHZhciBwb3NzaWJsZSA9IGxpc3RCW2luZGV4Ql07XG4gICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhgJHtpbmRleEF9OiR7bWF0Y2hUby5uYW1lfWApO1xuICAgICAgICAgICAgICAgIHRoaXMuZGVidWcoYCR7aW5kZXhCfToke3Bvc3NpYmxlLm5hbWV9YCk7XG5cbiAgICAgICAgICAgICAgICAvLyBubyBtYXRjaGluZyB3aXRoIHNlbGZcbiAgICAgICAgICAgICAgICBpZiAobGlzdEFbaW5kZXhBXSAhPT0gbGlzdEJbaW5kZXhCXSkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0TWF0Y2ggPSBvcHRpb25zLm1hdGNoLmNhbGwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5wcmVwcm9jZXNzTWF0Y2guY2FsbCh0aGlzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hUbzogbWF0Y2hUbyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZTogcG9zc2libGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4QixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0TWF0Y2g6IGJlc3RNYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcImJlc3RNYXRjaDpcIiwgSlNPTi5zdHJpbmdpZnkoYmVzdE1hdGNoLCBudWxsLCBcIiAgXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJlc3RNYXRjaC5zY29yZSA9PT0gMS4wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlYnVnKFwiYnJlYWtpbmcgZWFybHkgZHVlIHRvIHBlcmZlY3QgbWF0Y2hcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzY29yZVRocmVzaG9sZCA9IG9wdGlvbnMuc2NvcmVUaHJlc2hvbGQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoXCJzY29yZVRocmVzaG9sZDpcIiwgc2NvcmVUaHJlc2hvbGQpO1xuICAgICAgICAgICAgdGhpcy5kZWJ1ZyhcImJlc3RNYXRjaC5zY29yZTpcIiwgYmVzdE1hdGNoLnNjb3JlKTtcblxuICAgICAgICAgICAgaWYgKGJlc3RNYXRjaC5zY29yZSA+PSBzY29yZVRocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZyggJ2F1dG9QYWlyRm5CdWlsZGVyLnN0cmF0ZWd5JywgbGlzdEFbIGluZGV4QSBdLm5hbWUsIGxpc3RCWyBiZXN0TWF0Y2guaW5kZXggXS5uYW1lICk7XG4gICAgICAgICAgICAgICAgcGFpcmVkLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY3JlYXRlUGFpci5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RBOiBsaXN0QSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4QTogaW5kZXhBLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdEI6IGxpc3RCLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhCOiBiZXN0TWF0Y2guaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5kZWJ1ZyggJ2xpc3QgbGVucyBub3c6JywgbGlzdEEubGVuZ3RoLCBsaXN0Qi5sZW5ndGggKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5kZXhBICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWxpc3RBLmxlbmd0aCB8fCAhbGlzdEIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhaXJlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRlYnVnKFwicGFpcmVkOlwiLCBKU09OLnN0cmluZ2lmeShwYWlyZWQsIG51bGwsIFwiICBcIikpO1xuICAgICAgICB0aGlzLmRlYnVnKFwiYXV0b3BhaXIgX3N0cmF0ZWd5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgcmV0dXJuIHBhaXJlZDtcbiAgICB9O1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQW4gaW50ZXJmYWNlIGZvciBidWlsZGluZyBjb2xsZWN0aW9ucyBvZiBwYWlyZWQgZGF0YXNldHMuXG4gKi9cbnZhciBQYWlyZWRDb2xsZWN0aW9uQ3JlYXRvciA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKGJhc2VNVkMuTG9nZ2FibGVNaXhpbilcbiAgICAuZXh0ZW5kKGJhc2VDcmVhdG9yLkNvbGxlY3Rpb25DcmVhdG9yTWl4aW4pXG4gICAgLmV4dGVuZCh7XG4gICAgICAgIF9sb2dOYW1lc3BhY2U6IGxvZ05hbWVzcGFjZSxcblxuICAgICAgICBjbGFzc05hbWU6IFwibGlzdC1vZi1wYWlycy1jb2xsZWN0aW9uLWNyZWF0b3IgY29sbGVjdGlvbi1jcmVhdG9yIGZsZXgtcm93LWNvbnRhaW5lclwiLFxuXG4gICAgICAgIC8qKiBzZXQgdXAgaW5pdGlhbCBvcHRpb25zLCBpbnN0YW5jZSB2YXJzLCBiZWhhdmlvcnMsIGFuZCBhdXRvcGFpciAoaWYgc2V0IHRvIGRvIHNvKSAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICB0aGlzLm1ldHJpYyhcIlBhaXJlZENvbGxlY3Rpb25DcmVhdG9yLmluaXRpYWxpemVcIiwgYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSBQYWlyZWRDb2xsZWN0aW9uQ3JlYXRvcjonLCBhdHRyaWJ1dGVzICk7XG5cbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBfLmRlZmF1bHRzKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgICBkYXRhc2V0czogW10sXG4gICAgICAgICAgICAgICAgZmlsdGVyczogdGhpcy5ERUZBVUxUX0ZJTFRFUlMsXG4gICAgICAgICAgICAgICAgYXV0b21hdGljYWxseVBhaXI6IHRydWUsXG4gICAgICAgICAgICAgICAgc3RyYXRlZ3k6IFwibGNzXCIsXG4gICAgICAgICAgICAgICAgbWF0Y2hQZXJjZW50YWdlOiAwLjksXG4gICAgICAgICAgICAgICAgdHdvUGFzc0F1dG9wYWlyaW5nOiB0cnVlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyoqIHVub3JkZXJlZCwgb3JpZ2luYWwgbGlzdCAqL1xuICAgICAgICAgICAgdGhpcy5pbml0aWFsTGlzdCA9IGF0dHJpYnV0ZXMuZGF0YXNldHM7XG5cbiAgICAgICAgICAgIC8qKiBpcyB0aGlzIGZyb20gYSBoaXN0b3J5PyBpZiBzbywgd2hhdCdzIGl0cyBpZD8gKi9cbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeUlkID0gYXR0cmlidXRlcy5oaXN0b3J5SWQ7XG5cbiAgICAgICAgICAgIC8qKiB3aGljaCBmaWx0ZXJzIHNob3VsZCBiZSB1c2VkIGluaXRpYWxseT8gKFN0cmluZ1syXSBvciBuYW1lIGluIGNvbW1vbkZpbHRlcnMpICovXG4gICAgICAgICAgICB0aGlzLmZpbHRlcnMgPSB0aGlzLmNvbW1vbkZpbHRlcnNbYXR0cmlidXRlcy5maWx0ZXJzXSB8fCB0aGlzLmNvbW1vbkZpbHRlcnNbdGhpcy5ERUZBVUxUX0ZJTFRFUlNdO1xuICAgICAgICAgICAgaWYgKF8uaXNBcnJheShhdHRyaWJ1dGVzLmZpbHRlcnMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJzID0gYXR0cmlidXRlcy5maWx0ZXJzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiogdHJ5IHRvIGF1dG8gcGFpciB0aGUgdW5wYWlyZWQgZGF0YXNldHMgb24gbG9hZD8gKi9cbiAgICAgICAgICAgIHRoaXMuYXV0b21hdGljYWxseVBhaXIgPSBhdHRyaWJ1dGVzLmF1dG9tYXRpY2FsbHlQYWlyO1xuXG4gICAgICAgICAgICAvKiogd2hhdCBtZXRob2QgdG8gdXNlIGZvciBhdXRvIHBhaXJpbmcgKHdpbGwgYmUgcGFzc2VkIGFnZ3Jlc3Npb24gbGV2ZWwpICovXG4gICAgICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gdGhpcy5zdHJhdGVnaWVzW2F0dHJpYnV0ZXMuc3RyYXRlZ3ldIHx8IHRoaXMuc3RyYXRlZ2llc1t0aGlzLkRFRkFVTFRfU1RSQVRFR1ldO1xuICAgICAgICAgICAgaWYgKF8uaXNGdW5jdGlvbihhdHRyaWJ1dGVzLnN0cmF0ZWd5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RyYXRlZ3kgPSBhdHRyaWJ1dGVzLnN0cmF0ZWd5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiogZGlzdGFuY2UvbWlzbWF0Y2ggbGV2ZWwgYWxsb3dlZCBmb3IgYXV0b3BhaXJpbmcgKi9cbiAgICAgICAgICAgIHRoaXMubWF0Y2hQZXJjZW50YWdlID0gYXR0cmlidXRlcy5tYXRjaFBlcmNlbnRhZ2U7XG5cbiAgICAgICAgICAgIC8qKiB0cnkgdG8gYXV0b3BhaXIgdXNpbmcgc2ltcGxlIGZpcnN0LCB0aGVuIHRoaXMuc3RyYXRlZ3kgb24gdGhlIHJlbWFpbmRlciAqL1xuICAgICAgICAgICAgdGhpcy50d29QYXNzQXV0b3BhaXJpbmcgPSBhdHRyaWJ1dGVzLnR3b1Bhc3NBdXRvcGFpcmluZztcblxuICAgICAgICAgICAgLyoqIHJlbW92ZSBmaWxlIGV4dGVuc2lvbnMgKFxcLiopIGZyb20gY3JlYXRlZCBwYWlyIG5hbWVzPyAqL1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVFeHRlbnNpb25zID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vdGhpcy5yZW1vdmVFeHRlbnNpb25zID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8qKiBmbiB0byBjYWxsIHdoZW4gdGhlIGNhbmNlbCBidXR0b24gaXMgY2xpY2tlZCAoc2NvcGVkIHRvIHRoaXMpIC0gaWYgZmFsc3ksIG5vIGJ0biBpcyBkaXNwbGF5ZWQgKi9cbiAgICAgICAgICAgIHRoaXMub25jYW5jZWwgPSBhdHRyaWJ1dGVzLm9uY2FuY2VsO1xuICAgICAgICAgICAgLyoqIGZuIHRvIGNhbGwgd2hlbiB0aGUgY29sbGVjdGlvbiBpcyBjcmVhdGVkIChzY29wZWQgdG8gdGhpcykgKi9cbiAgICAgICAgICAgIHRoaXMub25jcmVhdGUgPSBhdHRyaWJ1dGVzLm9uY3JlYXRlO1xuXG4gICAgICAgICAgICAvKiogZm4gdG8gY2FsbCB3aGVuIHRoZSBjYW5jZWwgYnV0dG9uIGlzIGNsaWNrZWQgKHNjb3BlZCB0byB0aGlzKSAtIGlmIGZhbHN5LCBubyBidG4gaXMgZGlzcGxheWVkICovXG4gICAgICAgICAgICB0aGlzLmF1dG9zY3JvbGxEaXN0ID0gYXR0cmlidXRlcy5hdXRvc2Nyb2xsRGlzdCB8fCAyNDtcblxuICAgICAgICAgICAgLyoqIGlzIHRoZSB1bnBhaXJlZCBwYW5lbCBzaG93bj8gKi9cbiAgICAgICAgICAgIHRoaXMudW5wYWlyZWRQYW5lbEhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgLyoqIGlzIHRoZSBwYWlyZWQgcGFuZWwgc2hvd24/ICovXG4gICAgICAgICAgICB0aGlzLnBhaXJlZFBhbmVsSGlkZGVuID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8qKiBET00gZWxlbWVudHMgY3VycmVudGx5IGJlaW5nIGRyYWdnZWQgKi9cbiAgICAgICAgICAgIHRoaXMuJGRyYWdnaW5nID0gbnVsbDtcblxuICAgICAgICAgICAgLyoqIFVzZWQgZm9yIGJsb2NraW5nIFVJIGV2ZW50cyBkdXJpbmcgYWpheC9vcGVyYXRpb25zIChkb24ndCBwb3N0IHR3aWNlKSAqL1xuICAgICAgICAgICAgdGhpcy5ibG9ja2luZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLl9zZXRVcENvbW1vblNldHRpbmdzKGF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgdGhpcy5fc2V0VXBCZWhhdmlvcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2RhdGFTZXRVcCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBtYXAgb2YgY29tbW9uIGZpbHRlciBwYWlycyBieSBuYW1lICovXG4gICAgICAgIGNvbW1vbkZpbHRlcnM6IHtcbiAgICAgICAgICAgIGlsbHVtaW5hOiBbXCJfMVwiLCBcIl8yXCJdLFxuICAgICAgICAgICAgUnM6IFtcIl9SMVwiLCBcIl9SMlwiXVxuICAgICAgICB9LFxuICAgICAgICAvKiogd2hpY2ggY29tbW9uRmlsdGVyIHRvIHVzZSBieSBkZWZhdWx0ICovXG4gICAgICAgIERFRkFVTFRfRklMVEVSUzogXCJpbGx1bWluYVwiLFxuXG4gICAgICAgIC8qKiBtYXAgb2YgbmFtZS0+Zm4gZm9yIGF1dG9wYWlyaW5nICovXG4gICAgICAgIHN0cmF0ZWdpZXM6IHtcbiAgICAgICAgICAgIHNpbXBsZTogXCJhdXRvcGFpclNpbXBsZVwiLFxuICAgICAgICAgICAgbGNzOiBcImF1dG9wYWlyTENTXCIsXG4gICAgICAgICAgICBsZXZlbnNodGVpbjogXCJhdXRvcGFpckxldmVuc2h0ZWluXCJcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGRlZmF1bHQgYXV0b3BhaXIgc3RyYXRlZ3kgbmFtZSAqL1xuICAgICAgICBERUZBVUxUX1NUUkFURUdZOiBcImxjc1wiLFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBwcm9jZXNzIHJhdyBsaXN0XG4gICAgICAgIC8qKiBzZXQgdXAgbWFpbiBkYXRhOiBjYWNoZSBpbml0aWFsTGlzdCwgc29ydCwgYW5kIGF1dG9wYWlyICovXG4gICAgICAgIF9kYXRhU2V0VXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnLS0gX2RhdGFTZXRVcCcgKTtcblxuICAgICAgICAgICAgdGhpcy5wYWlyZWQgPSBbXTtcbiAgICAgICAgICAgIHRoaXMudW5wYWlyZWQgPSBbXTtcblxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZElkcyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBzb3J0IGluaXRpYWwgbGlzdCwgYWRkIGlkcyBpZiBuZWVkZWQsIGFuZCBzYXZlIG5ldyB3b3JraW5nIGNvcHkgdG8gdW5wYWlyZWRcbiAgICAgICAgICAgIHRoaXMuX3NvcnRJbml0aWFsTGlzdCgpO1xuICAgICAgICAgICAgdGhpcy5fZW5zdXJlSWRzKCk7XG4gICAgICAgICAgICB0aGlzLnVucGFpcmVkID0gdGhpcy5pbml0aWFsTGlzdC5zbGljZSgwKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b21hdGljYWxseVBhaXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dG9QYWlyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwicmVuZGVyZWQ6aW5pdGlhbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwiYXV0b3BhaXJcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNvcnQgaW5pdGlhbCBsaXN0ICovXG4gICAgICAgIF9zb3J0SW5pdGlhbExpc3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnLS0gX3NvcnRJbml0aWFsTGlzdCcgKTtcbiAgICAgICAgICAgIHRoaXMuX3NvcnREYXRhc2V0TGlzdCh0aGlzLmluaXRpYWxMaXN0KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc29ydCBhIGxpc3Qgb2YgZGF0YXNldHMgKi9cbiAgICAgICAgX3NvcnREYXRhc2V0TGlzdDogZnVuY3Rpb24obGlzdCkge1xuICAgICAgICAgICAgLy8gY3VycmVudGx5IG9ubHkgbmF0dXJhbCBzb3J0IGJ5IG5hbWVcbiAgICAgICAgICAgIGxpc3Quc29ydCgoYSwgYikgPT4gbmF0dXJhbFNvcnQoYS5uYW1lLCBiLm5hbWUpKTtcbiAgICAgICAgICAgIHJldHVybiBsaXN0O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhZGQgaWRzIHRvIGRhdGFzZXQgb2JqcyBpbiBpbml0aWFsIGxpc3QgaWYgbm9uZSAqL1xuICAgICAgICBfZW5zdXJlSWRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbExpc3QuZm9yRWFjaChkYXRhc2V0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGFzZXQuaGFzT3duUHJvcGVydHkoXCJpZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhc2V0LmlkID0gXy51bmlxdWVJZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5pdGlhbExpc3Q7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHNwbGl0IGluaXRpYWwgbGlzdCBpbnRvIHR3byBsaXN0cywgdGhvc2UgdGhhdCBwYXNzIGZvcndhcmQgZmlsdGVycyAmIHRob3NlIHBhc3NpbmcgcmV2ZXJzZSAqL1xuICAgICAgICBfc3BsaXRCeUZpbHRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHJlZ2V4RmlsdGVycyA9IHRoaXMuZmlsdGVycy5tYXAoc3RyaW5nRmlsdGVyID0+IG5ldyBSZWdFeHAoc3RyaW5nRmlsdGVyKSk7XG5cbiAgICAgICAgICAgIHZhciBzcGxpdCA9IFtbXSwgW11dO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBfZmlsdGVyKHVucGFpcmVkLCBmaWx0ZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyLnRlc3QodW5wYWlyZWQubmFtZSk7XG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gZGF0YXNldC5uYW1lLmluZGV4T2YoIGZpbHRlciApID49IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVucGFpcmVkLmZvckVhY2goZnVuY3Rpb24gX2ZpbHRlckVhY2godW5wYWlyZWQpIHtcbiAgICAgICAgICAgICAgICAvLyA5MCUgb2YgdGhlIHRpbWUgdGhpcyBzZWVtcyB0byB3b3JrLCBidXQ6XG4gICAgICAgICAgICAgICAgLy9UT0RPOiB0aGlzIHRyZWF0cyAqYWxsKiBzdHJpbmdzIGFzIHJlZ2V4IHdoaWNoIG1heSBjb25mdXNlIHBlb3BsZSAtIHBvc3NpYmx5IGNoZWNrIGZvciAvLyBzdXJyb3VuZGluZz9cbiAgICAgICAgICAgICAgICAvLyAgd291bGQgbmVlZCBleHBsYW5hdGlvbiBpbiBoZWxwIGFzIHdlbGxcbiAgICAgICAgICAgICAgICByZWdleEZpbHRlcnMuZm9yRWFjaCgoZmlsdGVyLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfZmlsdGVyKHVucGFpcmVkLCBmaWx0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcGxpdFtpXS5wdXNoKHVucGFpcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gc3BsaXQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGFkZCBhIGRhdGFzZXQgdG8gdGhlIHVucGFpcmVkIGxpc3QgaW4gaXQncyBwcm9wZXIgb3JkZXIgKi9cbiAgICAgICAgX2FkZFRvVW5wYWlyZWQ6IGZ1bmN0aW9uKGRhdGFzZXQpIHtcbiAgICAgICAgICAgIC8vIGN1cnJlbnRseSwgdW5wYWlyZWQgaXMgbmF0dXJhbCBzb3J0ZWQgYnkgbmFtZSwgdXNlIGJpbmFyeSBzZWFyY2ggdG8gZmluZCBpbnNlcnRpb24gcG9pbnRcbiAgICAgICAgICAgIHZhciBiaW5TZWFyY2hTb3J0ZWRJbmRleCA9IChsb3csIGhpKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGxvdyA9PT0gaGkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvdztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWlkID0gTWF0aC5mbG9vcigoaGkgLSBsb3cpIC8gMikgKyBsb3c7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29tcGFyZWQgPSBuYXR1cmFsU29ydChkYXRhc2V0Lm5hbWUsIHRoaXMudW5wYWlyZWRbbWlkXS5uYW1lKTtcblxuICAgICAgICAgICAgICAgIGlmIChjb21wYXJlZCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJpblNlYXJjaFNvcnRlZEluZGV4KGxvdywgbWlkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbXBhcmVkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmluU2VhcmNoU29ydGVkSW5kZXgobWlkICsgMSwgaGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyB3YWxrIHRoZSBlcXVhbCB0byBmaW5kIHRoZSBsYXN0XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMudW5wYWlyZWRbbWlkXSAmJiB0aGlzLnVucGFpcmVkW21pZF0ubmFtZSA9PT0gZGF0YXNldC5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIG1pZCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbWlkO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy51bnBhaXJlZC5zcGxpY2UoYmluU2VhcmNoU29ydGVkSW5kZXgoMCwgdGhpcy51bnBhaXJlZC5sZW5ndGgpLCAwLCBkYXRhc2V0KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gYXV0byBwYWlyaW5nXG4gICAgICAgIC8qKiB0d28gcGFzc2VzIHRvIGF1dG9tYXRpY2FsbHkgY3JlYXRlIHBhaXJzOlxuICAgICAgICAgKiAgdXNlIGJvdGggc2ltcGxlQXV0b1BhaXIsIHRoZW4gdGhlIGZuIG1lbnRpb25lZCBpbiBzdHJhdGVneVxuICAgICAgICAgKi9cbiAgICAgICAgYXV0b1BhaXI6IGZ1bmN0aW9uKHN0cmF0ZWd5KSB7XG4gICAgICAgICAgICAvLyBzcGxpdCBmaXJzdCB1c2luZyBleGFjdCBtYXRjaGluZ1xuICAgICAgICAgICAgdmFyIHNwbGl0ID0gdGhpcy5fc3BsaXRCeUZpbHRlcnMoKTtcblxuICAgICAgICAgICAgdmFyIHBhaXJlZCA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMudHdvUGFzc0F1dG9wYWlyaW5nKSB7XG4gICAgICAgICAgICAgICAgcGFpcmVkID0gdGhpcy5hdXRvcGFpclNpbXBsZSh7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RBOiBzcGxpdFswXSxcbiAgICAgICAgICAgICAgICAgICAgbGlzdEI6IHNwbGl0WzFdXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc3BsaXQgPSB0aGlzLl9zcGxpdEJ5RmlsdGVycygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB1bmNvbW1lbnQgdG8gc2VlIHByaW50bG5zIHdoaWxlIHJ1bm5pbmcgdGVzdHNcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nLmFwcGx5KCBjb25zb2xlLCBhcmd1bWVudHMgKTsgfTtcblxuICAgICAgICAgICAgLy8gdGhlbiB0cnkgdGhlIHJlbWFpbmRlciB3aXRoIHNvbWV0aGluZyBsZXNzIHN0cmljdFxuICAgICAgICAgICAgc3RyYXRlZ3kgPSBzdHJhdGVneSB8fCB0aGlzLnN0cmF0ZWd5O1xuICAgICAgICAgICAgc3BsaXQgPSB0aGlzLl9zcGxpdEJ5RmlsdGVycygpO1xuICAgICAgICAgICAgcGFpcmVkID0gcGFpcmVkLmNvbmNhdChcbiAgICAgICAgICAgICAgICB0aGlzW3N0cmF0ZWd5XS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdEE6IHNwbGl0WzBdLFxuICAgICAgICAgICAgICAgICAgICBsaXN0Qjogc3BsaXRbMV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiBwYWlyZWQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGF1dG9wYWlyIGJ5IGV4YWN0IG1hdGNoICovXG4gICAgICAgIGF1dG9wYWlyU2ltcGxlOiBhdXRvUGFpckZuQnVpbGRlcih7XG4gICAgICAgICAgICBzY29yZVRocmVzaG9sZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDAuNjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXRjaDogZnVuY3Rpb24gX21hdGNoKHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHBhcmFtcyB8fCB7fTtcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1zLm1hdGNoVG8gPT09IHBhcmFtcy5wb3NzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IHBhcmFtcy5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiAxLjBcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5iZXN0TWF0Y2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8qKiBhdXRvcGFpciBieSBsZXZlbnNodGVpbiBlZGl0IGRpc3RhbmNlIHNjb3JpbmcgKi9cbiAgICAgICAgYXV0b3BhaXJMZXZlbnNodGVpbjogYXV0b1BhaXJGbkJ1aWxkZXIoe1xuICAgICAgICAgICAgc2NvcmVUaHJlc2hvbGQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoUGVyY2VudGFnZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXRjaDogZnVuY3Rpb24gX21hdGNoZXMocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IHt9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gbGV2ZW5zaHRlaW5EaXN0YW5jZShwYXJhbXMubWF0Y2hUbywgcGFyYW1zLnBvc3NpYmxlKTtcblxuICAgICAgICAgICAgICAgIHZhciBzY29yZSA9IDEuMCAtIGRpc3RhbmNlIC8gTWF0aC5tYXgocGFyYW1zLm1hdGNoVG8ubGVuZ3RoLCBwYXJhbXMucG9zc2libGUubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgIGlmIChzY29yZSA+IHBhcmFtcy5iZXN0TWF0Y2guc2NvcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBwYXJhbXMuaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29yZTogc2NvcmVcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5iZXN0TWF0Y2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8qKiBhdXRvcGFpciBieSBsb25nZXN0IGNvbW1vbiBzdWJzdHJpbmdzIHNjb3JpbmcgKi9cbiAgICAgICAgYXV0b3BhaXJMQ1M6IGF1dG9QYWlyRm5CdWlsZGVyKHtcbiAgICAgICAgICAgIHNjb3JlVGhyZXNob2xkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXRjaFBlcmNlbnRhZ2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWF0Y2g6IGZ1bmN0aW9uIF9tYXRjaGVzKHBhcmFtcykge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHBhcmFtcyB8fCB7fTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IHRoaXMuX25haXZlU3RhcnRpbmdBbmRFbmRpbmdMQ1MocGFyYW1zLm1hdGNoVG8sIHBhcmFtcy5wb3NzaWJsZSkubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNjb3JlID0gbWF0Y2ggLyBNYXRoLm1heChwYXJhbXMubWF0Y2hUby5sZW5ndGgsIHBhcmFtcy5wb3NzaWJsZS5sZW5ndGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNjb3JlID4gcGFyYW1zLmJlc3RNYXRjaC5zY29yZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IHBhcmFtcy5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiBzY29yZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLmJlc3RNYXRjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksXG5cbiAgICAgICAgLyoqIHJldHVybiB0aGUgY29uY2F0J2QgbG9uZ2VzdCBjb21tb24gcHJlZml4IGFuZCBzdWZmaXggZnJvbSB0d28gc3RyaW5ncyAqL1xuICAgICAgICBfbmFpdmVTdGFydGluZ0FuZEVuZGluZ0xDUzogZnVuY3Rpb24oczEsIHMyKSB7XG4gICAgICAgICAgICB2YXIgZndkTENTID0gXCJcIjtcbiAgICAgICAgICAgIHZhciByZXZMQ1MgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGkgPCBzMS5sZW5ndGggJiYgaSA8IHMyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmIChzMVtpXSAhPT0gczJbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZ3ZExDUyArPSBzMVtpXTtcbiAgICAgICAgICAgICAgICBpICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaSA9PT0gczEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHMxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgPT09IHMyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaSA9IHMxLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBqID0gczIubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHdoaWxlIChpID49IDAgJiYgaiA+PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMxW2ldICE9PSBzMltqXSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV2TENTID0gW3MxW2ldLCByZXZMQ1NdLmpvaW4oXCJcIik7XG4gICAgICAgICAgICAgICAgaSAtPSAxO1xuICAgICAgICAgICAgICAgIGogLT0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmd2RMQ1MgKyByZXZMQ1M7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIHBhaXJpbmcgLyB1bnBhaXJpbmdcbiAgICAgICAgLyoqIGNyZWF0ZSBhIHBhaXIgZnJvbSBmd2QgYW5kIHJldiwgcmVtb3ZpbmcgdGhlbSBmcm9tIHVucGFpcmVkLCBhbmQgcGxhY2luZyB0aGUgbmV3IHBhaXIgaW4gcGFpcmVkICovXG4gICAgICAgIF9wYWlyOiBmdW5jdGlvbihmd2QsIHJldiwgb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgICB0aGlzLmRlYnVnKFwiX3BhaXI6XCIsIGZ3ZCwgcmV2KTtcbiAgICAgICAgICAgIHZhciBwYWlyID0gdGhpcy5fY3JlYXRlUGFpcihmd2QsIHJldiwgb3B0aW9ucy5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMucGFpcmVkLnB1c2gocGFpcik7XG4gICAgICAgICAgICB0aGlzLnVucGFpcmVkID0gXy53aXRob3V0KHRoaXMudW5wYWlyZWQsIGZ3ZCwgcmV2KTtcbiAgICAgICAgICAgIGlmICghb3B0aW9ucy5zaWxlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJwYWlyOm5ld1wiLCBwYWlyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYWlyO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBjcmVhdGUgYSBwYWlyIE9iamVjdCBmcm9tIGZ3ZCBhbmQgcmV2LCBhZGRpbmcgdGhlIG5hbWUgYXR0cmlidXRlICh3aWxsIGd1ZXNzIGlmIG5vdCBnaXZlbikgKi9cbiAgICAgICAgX2NyZWF0ZVBhaXI6IGZ1bmN0aW9uKGZ3ZCwgcmV2LCBuYW1lKSB7XG4gICAgICAgICAgICAvLyBlbnN1cmUgZXhpc3RhbmNlIGFuZCBkb24ndCBwYWlyIHNvbWV0aGluZyB3aXRoIGl0c2VsZlxuICAgICAgICAgICAgaWYgKCEoZndkICYmIHJldikgfHwgZndkID09PSByZXYpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhZCBwYWlyaW5nOiAke1tKU09OLnN0cmluZ2lmeShmd2QpLCBKU09OLnN0cmluZ2lmeShyZXYpXX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hbWUgPSBuYW1lIHx8IHRoaXMuX2d1ZXNzTmFtZUZvclBhaXIoZndkLCByZXYpO1xuICAgICAgICAgICAgcmV0dXJuIHsgZm9yd2FyZDogZndkLCBuYW1lOiBuYW1lLCByZXZlcnNlOiByZXYgfTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogdHJ5IHRvIGZpbmQgYSBnb29kIHBhaXIgbmFtZSBmb3IgdGhlIGdpdmVuIGZ3ZCBhbmQgcmV2IGRhdGFzZXRzICovXG4gICAgICAgIF9ndWVzc05hbWVGb3JQYWlyOiBmdW5jdGlvbihmd2QsIHJldiwgcmVtb3ZlRXh0ZW5zaW9ucykge1xuICAgICAgICAgICAgcmVtb3ZlRXh0ZW5zaW9ucyA9IHJlbW92ZUV4dGVuc2lvbnMgIT09IHVuZGVmaW5lZCA/IHJlbW92ZUV4dGVuc2lvbnMgOiB0aGlzLnJlbW92ZUV4dGVuc2lvbnM7XG4gICAgICAgICAgICB2YXIgZndkTmFtZSA9IGZ3ZC5uYW1lO1xuICAgICAgICAgICAgdmFyIHJldk5hbWUgPSByZXYubmFtZTtcblxuICAgICAgICAgICAgdmFyIGxjcyA9IHRoaXMuX25haXZlU3RhcnRpbmdBbmRFbmRpbmdMQ1MoXG4gICAgICAgICAgICAgICAgZndkTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAodGhpcy5maWx0ZXJzWzBdKSwgXCJcIiksXG4gICAgICAgICAgICAgICAgcmV2TmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAodGhpcy5maWx0ZXJzWzFdKSwgXCJcIilcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChyZW1vdmVFeHRlbnNpb25zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxhc3REb3RJbmRleCA9IGxjcy5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3REb3RJbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4dGVuc2lvbiA9IGxjcy5zbGljZShsYXN0RG90SW5kZXgsIGxjcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBsY3MgPSBsY3MucmVwbGFjZShleHRlbnNpb24sIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICBmd2ROYW1lID0gZndkTmFtZS5yZXBsYWNlKGV4dGVuc2lvbiwgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldk5hbWUgPSByZXZOYW1lLnJlcGxhY2UoZXh0ZW5zaW9uLCBcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbGNzIHx8IGAke2Z3ZE5hbWV9ICYgJHtyZXZOYW1lfWA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHVucGFpciBhIHBhaXIsIHJlbW92aW5nIGl0IGZyb20gcGFpcmVkLCBhbmQgYWRkaW5nIHRoZSBmd2QscmV2IGRhdGFzZXRzIGJhY2sgaW50byB1bnBhaXJlZCAqL1xuICAgICAgICBfdW5wYWlyOiBmdW5jdGlvbihwYWlyLCBvcHRpb25zKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIGlmICghcGFpcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQmFkIHBhaXI6ICR7SlNPTi5zdHJpbmdpZnkocGFpcil9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhaXJlZCA9IF8ud2l0aG91dCh0aGlzLnBhaXJlZCwgcGFpcik7XG4gICAgICAgICAgICB0aGlzLl9hZGRUb1VucGFpcmVkKHBhaXIuZm9yd2FyZCk7XG4gICAgICAgICAgICB0aGlzLl9hZGRUb1VucGFpcmVkKHBhaXIucmV2ZXJzZSk7XG5cbiAgICAgICAgICAgIGlmICghb3B0aW9ucy5zaWxlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJwYWlyOnVucGFpclwiLCBbcGFpcl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhaXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHVucGFpciBhbGwgcGFpcmVkIGRhdGFzZXRzICovXG4gICAgICAgIHVucGFpckFsbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcGFpcnMgPSBbXTtcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLnBhaXJlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwYWlycy5wdXNoKHRoaXMuX3VucGFpcih0aGlzLnBhaXJlZFswXSwgeyBzaWxlbnQ6IHRydWUgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwicGFpcjp1bnBhaXJcIiwgcGFpcnMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBBUElcbiAgICAgICAgLyoqIGNvbnZlcnQgYSBwYWlyIGludG8gSlNPTiBjb21wYXRpYmxlIHdpdGggdGhlIGNvbGxlY3Rpb25zIEFQSSAqL1xuICAgICAgICBfcGFpclRvSlNPTjogZnVuY3Rpb24ocGFpciwgc3JjKSB7XG4gICAgICAgICAgICBzcmMgPSBzcmMgfHwgXCJoZGFcIjtcbiAgICAgICAgICAgIC8vVE9ETzogY29uc2lkZXIgbWFraW5nIHRoaXMgdGhlIHBhaXIgc3RydWN0dXJlIHdoZW4gY3JlYXRlZCBpbnN0ZWFkXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25fdHlwZTogXCJwYWlyZWRcIixcbiAgICAgICAgICAgICAgICBzcmM6IFwibmV3X2NvbGxlY3Rpb25cIixcbiAgICAgICAgICAgICAgICBuYW1lOiBwYWlyLm5hbWUsXG4gICAgICAgICAgICAgICAgZWxlbWVudF9pZGVudGlmaWVyczogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcImZvcndhcmRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYWlyLmZvcndhcmQuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHNyY1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInJldmVyc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwYWlyLnJldmVyc2UuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHNyY1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY3JlYXRlIHRoZSBjb2xsZWN0aW9uIHZpYSB0aGUgQVBJXG4gICAgICAgICAqICBAcmV0dXJucyB7alF1ZXJ5LnhociBPYmplY3R9ICAgIHRoZSBqcXVlcnkgYWpheCByZXF1ZXN0XG4gICAgICAgICAqL1xuICAgICAgICBjcmVhdGVMaXN0OiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciB1cmwgPSBgJHtHYWxheHkucm9vdH1hcGkvaGlzdG9yaWVzLyR7dGhpcy5oaXN0b3J5SWR9L2NvbnRlbnRzL2RhdGFzZXRfY29sbGVjdGlvbnNgO1xuXG4gICAgICAgICAgICB2YXIgYWpheERhdGEgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJkYXRhc2V0X2NvbGxlY3Rpb25cIixcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uX3R5cGU6IFwibGlzdDpwYWlyZWRcIixcbiAgICAgICAgICAgICAgICBoaWRlX3NvdXJjZV9pdGVtczogc2VsZi5oaWRlT3JpZ2luYWxzIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5hbWU6IF8uZXNjYXBlKG5hbWUgfHwgc2VsZi4kKFwiLmNvbGxlY3Rpb24tbmFtZVwiKS52YWwoKSksXG4gICAgICAgICAgICAgICAgZWxlbWVudF9pZGVudGlmaWVyczogc2VsZi5wYWlyZWQubWFwKHBhaXIgPT4gc2VsZi5fcGFpclRvSlNPTihwYWlyKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoIEpTT04uc3RyaW5naWZ5KCBhamF4RGF0YSApICk7XG4gICAgICAgICAgICBzZWxmLmJsb2NraW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBqUXVlcnlcbiAgICAgICAgICAgICAgICAuYWpheCh1cmwsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShhamF4RGF0YSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hbHdheXMoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmJsb2NraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmFpbCgoeGhyLCBzdGF0dXMsIG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYWpheEVyckhhbmRsZXIoeGhyLCBzdGF0dXMsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2UsIG1lc3NhZ2UsIHhocikge1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuaW5mbyggJ29rJywgcmVzcG9uc2UsIG1lc3NhZ2UsIHhociApO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRyaWdnZXIoXCJjb2xsZWN0aW9uOmNyZWF0ZWRcIiwgcmVzcG9uc2UsIG1lc3NhZ2UsIHhocik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubWV0cmljKFwiY29sbGVjdGlvbjpjcmVhdGVkXCIsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLm9uY3JlYXRlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYub25jcmVhdGUuY2FsbCh0aGlzLCByZXNwb25zZSwgbWVzc2FnZSwgeGhyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBoYW5kbGUgYWpheCBlcnJvcnMgd2l0aCBmZWVkYmFjayBhbmQgZGV0YWlscyB0byB0aGUgdXNlciAoaWYgYXZhaWxhYmxlKSAqL1xuICAgICAgICBfYWpheEVyckhhbmRsZXI6IGZ1bmN0aW9uKHhociwgc3RhdHVzLCBtZXNzYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmVycm9yKHhociwgc3RhdHVzLCBtZXNzYWdlKTtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gX2woXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBjcmVhdGluZyB0aGlzIGNvbGxlY3Rpb25cIik7XG4gICAgICAgICAgICBpZiAoeGhyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSAwICYmIHhoci5zdGF0dXMgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgOiAke19sKFwiR2FsYXh5IGNvdWxkIG5vdCBiZSByZWFjaGVkIGFuZCBtYXkgYmUgdXBkYXRpbmcuXCIpfSR7X2woXG4gICAgICAgICAgICAgICAgICAgICAgICBcIiBUcnkgYWdhaW4gaW4gYSBmZXcgbWludXRlcy5cIlxuICAgICAgICAgICAgICAgICAgICApfWA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVzcG9uc2VKU09OKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxiciAvPjxwcmU+JHtKU09OLnN0cmluZ2lmeSh4aHIucmVzcG9uc2VKU09OKX08L3ByZT5gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDogJHttZXNzYWdlfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5fc2hvd0FsZXJ0KGNvbnRlbnQsIFwiYWxlcnQtZGFuZ2VyXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSByZW5kZXJpbmdcbiAgICAgICAgLyoqIHJlbmRlciB0aGUgZW50aXJlIGludGVyZmFjZSAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKHNwZWVkLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAnLS0gX3JlbmRlcicgKTtcbiAgICAgICAgICAgIC8vdGhpcy4kZWwuZW1wdHkoKS5odG1sKCB0aGlzLnRlbXBsYXRlcy5tYWluKCkgKTtcbiAgICAgICAgICAgIHRoaXMuJGVsLmVtcHR5KCkuaHRtbCh0aGlzLnRlbXBsYXRlcy5tYWluKCkpO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVySGVhZGVyKHNwZWVkKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlck1pZGRsZShzcGVlZCk7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJGb290ZXIoc3BlZWQpO1xuICAgICAgICAgICAgdGhpcy5fYWRkUGx1Z2luQ29tcG9uZW50cygpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwicmVuZGVyZWRcIiwgdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmVuZGVyIHRoZSBoZWFkZXIgc2VjdGlvbiAqL1xuICAgICAgICBfcmVuZGVySGVhZGVyOiBmdW5jdGlvbihzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJy0tIF9yZW5kZXJIZWFkZXInICk7XG4gICAgICAgICAgICB2YXIgJGhlYWRlciA9IHRoaXMuJChcIi5oZWFkZXJcIilcbiAgICAgICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgICAgIC5odG1sKHRoaXMudGVtcGxhdGVzLmhlYWRlcigpKVxuICAgICAgICAgICAgICAgIC5maW5kKFwiLmhlbHAtY29udGVudFwiKVxuICAgICAgICAgICAgICAgIC5wcmVwZW5kKCQodGhpcy50ZW1wbGF0ZXMuaGVscENvbnRlbnQoKSkpO1xuXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJGaWx0ZXJzKCk7XG4gICAgICAgICAgICByZXR1cm4gJGhlYWRlcjtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGZpbGwgdGhlIGZpbHRlciBpbnB1dHMgd2l0aCB0aGUgZmlsdGVyIHZhbHVlcyAqL1xuICAgICAgICBfcmVuZGVyRmlsdGVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kKFwiLmZvcndhcmQtY29sdW1uIC5jb2x1bW4taGVhZGVyIGlucHV0XCIpXG4gICAgICAgICAgICAgICAgLnZhbCh0aGlzLmZpbHRlcnNbMF0pXG4gICAgICAgICAgICAgICAgLmFkZCh0aGlzLiQoXCIucmV2ZXJzZS1jb2x1bW4gLmNvbHVtbi1oZWFkZXIgaW5wdXRcIikudmFsKHRoaXMuZmlsdGVyc1sxXSkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5kZXIgdGhlIG1pZGRsZSBpbmNsdWRpbmcgdW5wYWlyZWQgYW5kIHBhaXJlZCBzZWN0aW9ucyAod2hpY2ggbWF5IGJlIGhpZGRlbikgKi9cbiAgICAgICAgX3JlbmRlck1pZGRsZTogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgJG1pZGRsZSA9IHRoaXMuJChcIi5taWRkbGVcIilcbiAgICAgICAgICAgICAgICAuZW1wdHkoKVxuICAgICAgICAgICAgICAgIC5odG1sKHRoaXMudGVtcGxhdGVzLm1pZGRsZSgpKTtcblxuICAgICAgICAgICAgLy8gKHJlLSkgaGlkZSB0aGUgdW4vcGFpcmVkIHBhbmVscyBiYXNlZCBvbiBpbnN0YW5jZSB2YXJzXG4gICAgICAgICAgICBpZiAodGhpcy51bnBhaXJlZFBhbmVsSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnNcIikuaGlkZSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBhaXJlZFBhbmVsSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLnBhaXJlZC1jb2x1bW5zXCIpLmhpZGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyVW5wYWlyZWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhaXJlZCgpO1xuICAgICAgICAgICAgcmV0dXJuICRtaWRkbGU7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiByZW5kZXIgdGhlIHVucGFpcmVkIHNlY3Rpb24sIHNob3dpbmcgZGF0YXNldHMgYWNjcmQuIHRvIGZpbHRlcnMsIHVwZGF0ZSB0aGUgdW5wYWlyZWQgY291bnRzICovXG4gICAgICAgIF9yZW5kZXJVbnBhaXJlZDogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSBfcmVuZGVyVW5wYWlyZWQnICk7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciAkZndkO1xuICAgICAgICAgICAgdmFyICRyZXY7XG4gICAgICAgICAgICB2YXIgJHByZCA9IFtdO1xuICAgICAgICAgICAgdmFyIHNwbGl0ID0gdGhpcy5fc3BsaXRCeUZpbHRlcnMoKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZSB1bnBhaXJlZCBjb3VudHNcbiAgICAgICAgICAgIHRoaXMuJChcIi5mb3J3YXJkLWNvbHVtbiAudGl0bGVcIikudGV4dChbc3BsaXRbMF0ubGVuZ3RoLCBfbChcInVucGFpcmVkIGZvcndhcmRcIildLmpvaW4oXCIgXCIpKTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5mb3J3YXJkLWNvbHVtbiAudW5wYWlyZWQtaW5mb1wiKS50ZXh0KFxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclVucGFpcmVkRGlzcGxheVN0cih0aGlzLnVucGFpcmVkLmxlbmd0aCAtIHNwbGl0WzBdLmxlbmd0aClcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLiQoXCIucmV2ZXJzZS1jb2x1bW4gLnRpdGxlXCIpLnRleHQoW3NwbGl0WzFdLmxlbmd0aCwgX2woXCJ1bnBhaXJlZCByZXZlcnNlXCIpXS5qb2luKFwiIFwiKSk7XG4gICAgICAgICAgICB0aGlzLiQoXCIucmV2ZXJzZS1jb2x1bW4gLnVucGFpcmVkLWluZm9cIikudGV4dChcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJVbnBhaXJlZERpc3BsYXlTdHIodGhpcy51bnBhaXJlZC5sZW5ndGggLSBzcGxpdFsxXS5sZW5ndGgpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLiQoXCIudW5wYWlyZWQtY29sdW1ucyAuY29sdW1uLWRhdGFzZXRzXCIpLmVtcHR5KCk7XG5cbiAgICAgICAgICAgIC8vIHNob3cvaGlkZSB0aGUgYXV0byBwYWlyIGJ1dHRvbiBpZiBhbnkgdW5wYWlyZWQgYXJlIGxlZnRcbiAgICAgICAgICAgIHRoaXMuJChcIi5hdXRvcGFpci1saW5rXCIpLnRvZ2dsZSh0aGlzLnVucGFpcmVkLmxlbmd0aCAhPT0gMCk7XG4gICAgICAgICAgICBpZiAodGhpcy51bnBhaXJlZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJVbnBhaXJlZEVtcHR5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGRhdGFzZXQgZG9tIGFycmF5c1xuICAgICAgICAgICAgJHJldiA9IHNwbGl0WzFdLm1hcCgoZGF0YXNldCwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlJ2xsIGJlIGEgZndkIGRhdGFzZXQgYWNyb3NzIHRoZSB3YXksIGFkZCBhIGJ1dHRvbiB0byBwYWlyIHRoZSByb3dcbiAgICAgICAgICAgICAgICBpZiAoc3BsaXRbMF1baV0gIT09IHVuZGVmaW5lZCAmJiBzcGxpdFswXVtpXSAhPT0gZGF0YXNldCkge1xuICAgICAgICAgICAgICAgICAgICAkcHJkLnB1c2goc2VsZi5fcmVuZGVyUGFpckJ1dHRvbigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX3JlbmRlclVucGFpcmVkRGF0YXNldChkYXRhc2V0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJGZ3ZCA9IHNwbGl0WzBdLm1hcChkYXRhc2V0ID0+IHNlbGYuX3JlbmRlclVucGFpcmVkRGF0YXNldChkYXRhc2V0KSk7XG5cbiAgICAgICAgICAgIGlmICghJGZ3ZC5sZW5ndGggJiYgISRyZXYubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyVW5wYWlyZWROb3RTaG93bigpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGFkZCB0byBhcHByb3BvIGNvbHNcbiAgICAgICAgICAgIC8vVE9ETzogbm90IHRoZSBiZXN0IHdheSB0byByZW5kZXIgLSBjb25zaWRlciByZW5kZXJpbmcgdGhlIGVudGlyZSB1bnBhaXJlZC1jb2x1bW5zIHNlY3Rpb24gaW4gYSBmcmFnbWVudFxuICAgICAgICAgICAgLy8gIGFuZCBzd2FwcGluZyBvdXQgdGhhdFxuICAgICAgICAgICAgdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnMgLmZvcndhcmQtY29sdW1uIC5jb2x1bW4tZGF0YXNldHNcIilcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCRmd2QpXG4gICAgICAgICAgICAgICAgLmFkZCh0aGlzLiQoXCIudW5wYWlyZWQtY29sdW1ucyAucGFpcmVkLWNvbHVtbiAuY29sdW1uLWRhdGFzZXRzXCIpLmFwcGVuZCgkcHJkKSlcbiAgICAgICAgICAgICAgICAuYWRkKHRoaXMuJChcIi51bnBhaXJlZC1jb2x1bW5zIC5yZXZlcnNlLWNvbHVtbiAuY29sdW1uLWRhdGFzZXRzXCIpLmFwcGVuZCgkcmV2KSk7XG4gICAgICAgICAgICB0aGlzLl9hZGpVbnBhaXJlZE9uU2Nyb2xsYmFyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiByZXR1cm4gYSBzdHJpbmcgdG8gZGlzcGxheSB0aGUgY291bnQgb2YgZmlsdGVyZWQgb3V0IGRhdGFzZXRzICovXG4gICAgICAgIF9yZW5kZXJVbnBhaXJlZERpc3BsYXlTdHI6IGZ1bmN0aW9uKG51bUZpbHRlcmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gW1wiKFwiLCBudW1GaWx0ZXJlZCwgXCIgXCIsIF9sKFwiZmlsdGVyZWQgb3V0XCIpLCBcIilcIl0uam9pbihcIlwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIHJldHVybiBhbiB1bmF0dGFjaGVkIGpRdWVyeSBET00gZWxlbWVudCB0byByZXByZXNlbnQgYW4gdW5wYWlyZWQgZGF0YXNldCAqL1xuICAgICAgICBfcmVuZGVyVW5wYWlyZWREYXRhc2V0OiBmdW5jdGlvbihkYXRhc2V0KSB7XG4gICAgICAgICAgICAvL1RPRE86IHRvIHVuZGVyc2NvcmUgdGVtcGxhdGVcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgJChcIjxsaS8+XCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiaWRcIiwgYGRhdGFzZXQtJHtkYXRhc2V0LmlkfWApXG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcImRhdGFzZXQgdW5wYWlyZWRcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkcmFnZ2FibGVcIiwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKGRhdGFzZXQuc2VsZWN0ZWQgPyBcInNlbGVjdGVkXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIjxzcGFuLz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJkYXRhc2V0LW5hbWVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dChkYXRhc2V0Lm5hbWUpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgLy8/P1xuICAgICAgICAgICAgICAgICAgICAuZGF0YShcImRhdGFzZXRcIiwgZGF0YXNldClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG4gICAgICAgIC8qKiByZW5kZXIgdGhlIGJ1dHRvbiB0aGF0IG1heSBnbyBiZXR3ZWVuIHVucGFpcmVkIGRhdGFzZXRzLCBhbGxvd2luZyB0aGUgdXNlciB0byBwYWlyIGEgcm93ICovXG4gICAgICAgIF9yZW5kZXJQYWlyQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vVE9ETzogKm5vdCogYSBkYXRhc2V0IC0gZG9uJ3QgcHJldGVuZCBsaWtlIGl0IGlzXG4gICAgICAgICAgICByZXR1cm4gJChcIjxsaS8+XCIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiZGF0YXNldCB1bnBhaXJlZFwiKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICQoXCI8c3Bhbi8+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJkYXRhc2V0LW5hbWVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KF9sKFwiUGFpciB0aGVzZSBkYXRhc2V0c1wiKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICB9LFxuICAgICAgICAvKiogYSBtZXNzYWdlIHRvIGRpc3BsYXkgd2hlbiBubyB1bnBhaXJlZCBsZWZ0ICovXG4gICAgICAgIF9yZW5kZXJVbnBhaXJlZEVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJy0tIHJlbmRlclVucGFpcmVkRW1wdHknICk7XG4gICAgICAgICAgICB2YXIgJG1zZyA9ICQoJzxkaXYgY2xhc3M9XCJlbXB0eS1tZXNzYWdlXCI+PC9kaXY+JykudGV4dChgKCR7X2woXCJubyByZW1haW5pbmcgdW5wYWlyZWQgZGF0YXNldHNcIil9KWApO1xuICAgICAgICAgICAgdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnMgLnBhaXJlZC1jb2x1bW4gLmNvbHVtbi1kYXRhc2V0c1wiKVxuICAgICAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAgICAgLnByZXBlbmQoJG1zZyk7XG4gICAgICAgICAgICByZXR1cm4gJG1zZztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGEgbWVzc2FnZSB0byBkaXNwbGF5IHdoZW4gbm8gdW5wYWlyZWQgY2FuIGJlIHNob3duIHdpdGggdGhlIGN1cnJlbnQgZmlsdGVycyAqL1xuICAgICAgICBfcmVuZGVyVW5wYWlyZWROb3RTaG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSByZW5kZXJVbnBhaXJlZEVtcHR5JyApO1xuICAgICAgICAgICAgdmFyICRtc2cgPSAkKCc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPjwvZGl2PicpLnRleHQoXG4gICAgICAgICAgICAgICAgYCgke19sKFwibm8gZGF0YXNldHMgd2VyZSBmb3VuZCBtYXRjaGluZyB0aGUgY3VycmVudCBmaWx0ZXJzXCIpfSlgXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnMgLnBhaXJlZC1jb2x1bW4gLmNvbHVtbi1kYXRhc2V0c1wiKVxuICAgICAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAgICAgLnByZXBlbmQoJG1zZyk7XG4gICAgICAgICAgICByZXR1cm4gJG1zZztcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIHRyeSB0byBkZXRlY3QgaWYgdGhlIHVucGFpcmVkIHNlY3Rpb24gaGFzIGEgc2Nyb2xsYmFyIGFuZCBhZGp1c3QgbGVmdCBjb2x1bW4gZm9yIGJldHRlciBjZW50ZXJpbmcgb2YgYWxsICovXG4gICAgICAgIF9hZGpVbnBhaXJlZE9uU2Nyb2xsYmFyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkdW5wYWlyZWRDb2x1bW5zID0gdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnNcIikubGFzdCgpO1xuXG4gICAgICAgICAgICB2YXIgJGZpcnN0RGF0YXNldCA9IHRoaXMuJChcIi51bnBhaXJlZC1jb2x1bW5zIC5yZXZlcnNlLWNvbHVtbiAuZGF0YXNldFwiKS5maXJzdCgpO1xuXG4gICAgICAgICAgICBpZiAoISRmaXJzdERhdGFzZXQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdWNSaWdodCA9ICR1bnBhaXJlZENvbHVtbnMub2Zmc2V0KCkubGVmdCArICR1bnBhaXJlZENvbHVtbnMub3V0ZXJXaWR0aCgpO1xuXG4gICAgICAgICAgICB2YXIgZHNSaWdodCA9ICRmaXJzdERhdGFzZXQub2Zmc2V0KCkubGVmdCArICRmaXJzdERhdGFzZXQub3V0ZXJXaWR0aCgpO1xuXG4gICAgICAgICAgICB2YXIgcmlnaHREaWZmID0gTWF0aC5mbG9vcih1Y1JpZ2h0KSAtIE1hdGguZmxvb3IoZHNSaWdodCk7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICdyaWdodERpZmY6JywgdWNSaWdodCwgJy0nLCBkc1JpZ2h0LCAnPScsIHJpZ2h0RGlmZiApO1xuICAgICAgICAgICAgdGhpcy4kKFwiLnVucGFpcmVkLWNvbHVtbnMgLmZvcndhcmQtY29sdW1uXCIpLmNzcyhcIm1hcmdpbi1sZWZ0XCIsIHJpZ2h0RGlmZiA+IDAgPyByaWdodERpZmYgOiAwKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmVuZGVyIHRoZSBwYWlyZWQgc2VjdGlvbiBhbmQgdXBkYXRlIGNvdW50cyBvZiBwYWlyZWQgZGF0YXNldHMgKi9cbiAgICAgICAgX3JlbmRlclBhaXJlZDogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICctLSBfcmVuZGVyUGFpcmVkJyApO1xuICAgICAgICAgICAgdGhpcy4kKFwiLnBhaXJlZC1jb2x1bW4tdGl0bGUgLnRpdGxlXCIpLnRleHQoW3RoaXMucGFpcmVkLmxlbmd0aCwgX2woXCJwYWlyZWRcIildLmpvaW4oXCIgXCIpKTtcbiAgICAgICAgICAgIC8vIHNob3cvaGlkZSB0aGUgdW5wYWlyIGFsbCBsaW5rXG4gICAgICAgICAgICB0aGlzLiQoXCIudW5wYWlyLWFsbC1saW5rXCIpLnRvZ2dsZSh0aGlzLnBhaXJlZC5sZW5ndGggIT09IDApO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFpcmVkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhaXJlZEVtcHR5KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIC8vVE9ETzogd291bGQgYmUgYmVzdCB0byByZXR1cm4gaGVyZSAodGhlICRjb2x1bW5zKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBzaG93L2hpZGUgJ3JlbW92ZSBleHRlbnNpb25zIGxpbmsnIHdoZW4gYW55IHBhaXJlZCBhbmQgdGhleSBzZWVtIHRvIGhhdmUgZXh0ZW5zaW9uc1xuICAgICAgICAgICAgICAgIHRoaXMuJChcIi5yZW1vdmUtZXh0ZW5zaW9ucy1saW5rXCIpLnNob3coKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy4kKFwiLnBhaXJlZC1jb2x1bW5zIC5jb2x1bW4tZGF0YXNldHNcIikuZW1wdHkoKTtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucGFpcmVkLmZvckVhY2goKHBhaXIsIGkpID0+IHtcbiAgICAgICAgICAgICAgICAvL1RPRE86IGNhY2hlIHRoZXNlP1xuICAgICAgICAgICAgICAgIHZhciBwYWlyVmlldyA9IG5ldyBQYWlyVmlldyh7IHBhaXI6IHBhaXIgfSk7XG4gICAgICAgICAgICAgICAgc2VsZlxuICAgICAgICAgICAgICAgICAgICAuJChcIi5wYWlyZWQtY29sdW1ucyAuY29sdW1uLWRhdGFzZXRzXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmQocGFpclZpZXcucmVuZGVyKCkuJGVsKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwidW5wYWlyLWJ0blwiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiZmEgZmEtdW5saW5rXCIgdGl0bGU9XCInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sKFwiVW5wYWlyXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcIj48L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICAvKiogYSBtZXNzYWdlIHRvIGRpc3BsYXkgd2hlbiBub25lIHBhaXJlZCAqL1xuICAgICAgICBfcmVuZGVyUGFpcmVkRW1wdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyICRtc2cgPSAkKCc8ZGl2IGNsYXNzPVwiZW1wdHktbWVzc2FnZVwiPjwvZGl2PicpLnRleHQoYCgke19sKFwibm8gcGFpcmVkIGRhdGFzZXRzIHlldFwiKX0pYCk7XG4gICAgICAgICAgICB0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnMgLmNvbHVtbi1kYXRhc2V0c1wiKVxuICAgICAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAgICAgLnByZXBlbmQoJG1zZyk7XG4gICAgICAgICAgICByZXR1cm4gJG1zZztcbiAgICAgICAgfSxcblxuICAgICAgICBmb290ZXJTZXR0aW5nczoge1xuICAgICAgICAgICAgXCIuaGlkZS1vcmlnaW5hbHNcIjogXCJoaWRlT3JpZ2luYWxzXCIsXG4gICAgICAgICAgICBcIi5yZW1vdmUtZXh0ZW5zaW9uc1wiOiBcInJlbW92ZUV4dGVuc2lvbnNcIlxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhZGQgYW55IGpRdWVyeS9ib290c3RyYXAvY3VzdG9tIHBsdWdpbnMgdG8gZWxlbWVudHMgcmVuZGVyZWQgKi9cbiAgICAgICAgX2FkZFBsdWdpbkNvbXBvbmVudHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fY2hvb3NlRmlsdGVyc1BvcG92ZXIoXCIuY2hvb3NlLWZpbHRlcnMtbGlua1wiKTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5oZWxwLWNvbnRlbnQgaVwiKS5ob3ZlcmhpZ2hsaWdodChcIi5jb2xsZWN0aW9uLWNyZWF0b3JcIiwgXCJyZ2JhKCA2NCwgMjU1LCAyNTUsIDEuMCApXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBidWlsZCBhIGZpbHRlciBzZWxlY3Rpb24gcG9wb3ZlciBhbGxvd2luZyBzZWxlY3Rpb24gb2YgY29tbW9uIGZpbHRlciBwYWlycyAqL1xuICAgICAgICBfY2hvb3NlRmlsdGVyc1BvcG92ZXI6IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBmaWx0ZXJDaG9pY2UodmFsMSwgdmFsMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiZmlsdGVyLWNob2ljZSBidG5cIiAnLFxuICAgICAgICAgICAgICAgICAgICAnZGF0YS1mb3J3YXJkPVwiJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsMSxcbiAgICAgICAgICAgICAgICAgICAgJ1wiIGRhdGEtcmV2ZXJzZT1cIicsXG4gICAgICAgICAgICAgICAgICAgIHZhbDIsXG4gICAgICAgICAgICAgICAgICAgICdcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkZvcndhcmRcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiOiBcIixcbiAgICAgICAgICAgICAgICAgICAgdmFsMSxcbiAgICAgICAgICAgICAgICAgICAgXCIsIFwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcIlJldmVyc2VcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiOiBcIixcbiAgICAgICAgICAgICAgICAgICAgdmFsMixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2J1dHRvbj5cIlxuICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciAkcG9wb3ZlckNvbnRlbnQgPSAkKFxuICAgICAgICAgICAgICAgIF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY2hvb3NlLWZpbHRlcnNcIj4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJoZWxwXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sKFwiQ2hvb3NlIGZyb20gdGhlIGZvbGxvd2luZyBmaWx0ZXJzIHRvIGNoYW5nZSB3aGljaCB1bnBhaXJlZCByZWFkcyBhcmUgc2hvd24gaW4gdGhlIGRpc3BsYXlcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBcIjo8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIF8udmFsdWVzKHRoaXMuY29tbW9uRmlsdGVycylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZpbHRlclNldCA9PiBmaWx0ZXJDaG9pY2UoZmlsdGVyU2V0WzBdLCBmaWx0ZXJTZXRbMV0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICApKHt9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJChzZWxlY3RvcikucG9wb3Zlcih7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBcIi5jb2xsZWN0aW9uLWNyZWF0b3JcIixcbiAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tXCIsXG4gICAgICAgICAgICAgICAgaHRtbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAvL2FuaW1hdGlvbiAgIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgY29udGVudDogJHBvcG92ZXJDb250ZW50XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogYWRkIChvciBjbGVhciBpZiBjbGVhciBpcyB0cnV0aHkpIGEgdmFsaWRhdGlvbiB3YXJuaW5nIHRvIHdoYXQgKi9cbiAgICAgICAgX3ZhbGlkYXRpb25XYXJuaW5nOiBmdW5jdGlvbih3aGF0LCBjbGVhcikge1xuICAgICAgICAgICAgdmFyIFZBTElEQVRJT05fQ0xBU1MgPSBcInZhbGlkYXRpb24td2FybmluZ1wiO1xuICAgICAgICAgICAgaWYgKHdoYXQgPT09IFwibmFtZVwiKSB7XG4gICAgICAgICAgICAgICAgd2hhdCA9IHRoaXMuJChcIi5jb2xsZWN0aW9uLW5hbWVcIikuYWRkKHRoaXMuJChcIi5jb2xsZWN0aW9uLW5hbWUtcHJvbXB0XCIpKTtcbiAgICAgICAgICAgICAgICB0aGlzLiQoXCIuY29sbGVjdGlvbi1uYW1lXCIpXG4gICAgICAgICAgICAgICAgICAgIC5mb2N1cygpXG4gICAgICAgICAgICAgICAgICAgIC5zZWxlY3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjbGVhcikge1xuICAgICAgICAgICAgICAgIHdoYXQgPSB3aGF0IHx8IHRoaXMuJChgLiR7VkFMSURBVElPTl9DTEFTU31gKTtcbiAgICAgICAgICAgICAgICB3aGF0LnJlbW92ZUNsYXNzKFZBTElEQVRJT05fQ0xBU1MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aGF0LmFkZENsYXNzKFZBTElEQVRJT05fQ0xBU1MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBldmVudHNcbiAgICAgICAgLyoqIHNldCB1cCBldmVudCBoYW5kbGVycyBvbiBzZWxmICovXG4gICAgICAgIF9zZXRVcEJlaGF2aW9yczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLm9uY2UoXCJyZW5kZXJlZFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJyZW5kZXJlZDppbml0aWFsXCIsIHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMub24oXCJwYWlyOm5ld1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvL1RPRE86IGlkZWFsbHkgb25seSByZS1yZW5kZXIgdGhlIGNvbHVtbnMgKG9yIGV2ZW4gZWxlbWVudHMpIGludm9sdmVkXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyVW5wYWlyZWQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJQYWlyZWQoKTtcblxuICAgICAgICAgICAgICAgIC8vIHNjcm9sbCB0byBib3R0b20gd2hlcmUgbmV3IHBhaXJzIGFyZSBhZGRlZFxuICAgICAgICAgICAgICAgIC8vVE9ETzogdGhpcyBkb2Vzbid0IHNlZW0gdG8gd29yayAtIGlubmVySGVpZ2h0IHN0aWNrcyBhdCAxMzMuLi5cbiAgICAgICAgICAgICAgICAvLyAgbWF5IGhhdmUgdG8gZG8gd2l0aCBpbXByb3BlciBmbGV4IGNvbHVtbnNcbiAgICAgICAgICAgICAgICAvL3ZhciAkcGFpcmVkVmlldyA9IHRoaXMuJCggJy5wYWlyZWQtY29sdW1ucycgKTtcbiAgICAgICAgICAgICAgICAvLyRwYWlyZWRWaWV3LnNjcm9sbFRvcCggJHBhaXJlZFZpZXcuaW5uZXJIZWlnaHQoKSApO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJHBhaXJlZFZpZXcuaGVpZ2h0KCkgKVxuICAgICAgICAgICAgICAgIHRoaXMuJChcIi5wYWlyZWQtY29sdW1uc1wiKS5zY3JvbGxUb3AoODAwMDAwMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub24oXCJwYWlyOnVucGFpclwiLCBmdW5jdGlvbihwYWlycykge1xuICAgICAgICAgICAgICAgIC8vVE9ETzogaWRlYWxseSBvbmx5IHJlLXJlbmRlciB0aGUgY29sdW1ucyAob3IgZXZlbiBlbGVtZW50cykgaW52b2x2ZWRcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJVbnBhaXJlZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhaXJlZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRWaWV3KCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5vbihcImZpbHRlci1jaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJzID0gW1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiQoXCIuZm9yd2FyZC11bnBhaXJlZC1maWx0ZXIgaW5wdXRcIikudmFsKCksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJChcIi5yZXZlcnNlLXVucGFpcmVkLWZpbHRlciBpbnB1dFwiKS52YWwoKVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgdGhpcy5tZXRyaWMoXCJmaWx0ZXItY2hhbmdlXCIsIHRoaXMuZmlsdGVycyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyRmlsdGVycygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclVucGFpcmVkKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5vbihcImF1dG9wYWlyXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclVucGFpcmVkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyUGFpcmVkKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgICAgICAgICB2YXIgbXNnQ2xhc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhaXJlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbXNnQ2xhc3MgPSBcImFsZXJ0LXN1Y2Nlc3NcIjtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IGAke3RoaXMucGFpcmVkLmxlbmd0aH0gJHtfbChcInBhaXJzIGNyZWF0ZWRcIil9YDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVucGFpcmVkLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSArPSBgOiAke19sKFwiYWxsIGRhdGFzZXRzIGhhdmUgYmVlbiBzdWNjZXNzZnVsbHkgcGFpcmVkXCIpfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVVbnBhaXJlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kKFwiLmNvbGxlY3Rpb24tbmFtZVwiKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IF9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ291bGQgbm90IGF1dG9tYXRpY2FsbHkgY3JlYXRlIGFueSBwYWlycyBmcm9tIHRoZSBnaXZlbiBkYXRhc2V0IG5hbWVzLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiWW91IG1heSB3YW50IHRvIGNob29zZSBvciBlbnRlciBkaWZmZXJlbnQgZmlsdGVycyBhbmQgdHJ5IGF1dG8tcGFpcmluZyBhZ2Fpbi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNsb3NlIHRoaXMgbWVzc2FnZSB1c2luZyB0aGUgWCBvbiB0aGUgcmlnaHQgdG8gdmlldyBtb3JlIGhlbHAuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIiBcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0FsZXJ0KG1lc3NhZ2UsIG1zZ0NsYXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvL3RoaXMub24oICdhbGwnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy8gICAgdGhpcy5pbmZvKCBhcmd1bWVudHMgKTtcbiAgICAgICAgICAgIC8vfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgIC8vIGhlYWRlclxuICAgICAgICAgICAgXCJjbGljayAubW9yZS1oZWxwXCI6IFwiX2NsaWNrTW9yZUhlbHBcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLmxlc3MtaGVscFwiOiBcIl9jbGlja0xlc3NIZWxwXCIsXG4gICAgICAgICAgICBcImNsaWNrIC5tYWluLWhlbHBcIjogXCJfdG9nZ2xlSGVscFwiLFxuICAgICAgICAgICAgXCJjbGljayAuaGVhZGVyIC5hbGVydCBidXR0b25cIjogXCJfaGlkZUFsZXJ0XCIsXG4gICAgICAgICAgICBcImNsaWNrIC5mb3J3YXJkLWNvbHVtbiAuY29sdW1uLXRpdGxlXCI6IFwiX2NsaWNrU2hvd09ubHlVbnBhaXJlZFwiLFxuICAgICAgICAgICAgXCJjbGljayAucmV2ZXJzZS1jb2x1bW4gLmNvbHVtbi10aXRsZVwiOiBcIl9jbGlja1Nob3dPbmx5VW5wYWlyZWRcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLnVucGFpci1hbGwtbGlua1wiOiBcIl9jbGlja1VucGFpckFsbFwiLFxuICAgICAgICAgICAgLy9UT0RPOiB0aGlzIHNlZW1zIGtpbmRhIGJhY2thc3N3YXJkcyAtIHJlLXNlbmRpbmcganEgZXZlbnQgYXMgYSBiYWNrYm9uZSBldmVudCwgY2FuIHdlIGxpc3RlbiBkaXJlY3RseT9cbiAgICAgICAgICAgIFwiY2hhbmdlIC5mb3J3YXJkLXVucGFpcmVkLWZpbHRlciBpbnB1dFwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImZpbHRlci1jaGFuZ2VcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJmb2N1cyAuZm9yd2FyZC11bnBhaXJlZC1maWx0ZXIgaW5wdXRcIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICAkKGV2LmN1cnJlbnRUYXJnZXQpLnNlbGVjdCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLmF1dG9wYWlyLWxpbmtcIjogXCJfY2xpY2tBdXRvcGFpclwiLFxuICAgICAgICAgICAgXCJjbGljayAuY2hvb3NlLWZpbHRlcnMgLmZpbHRlci1jaG9pY2VcIjogXCJfY2xpY2tGaWx0ZXJDaG9pY2VcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLmNsZWFyLWZpbHRlcnMtbGlua1wiOiBcIl9jbGVhckZpbHRlcnNcIixcbiAgICAgICAgICAgIFwiY2hhbmdlIC5yZXZlcnNlLXVucGFpcmVkLWZpbHRlciBpbnB1dFwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcImZpbHRlci1jaGFuZ2VcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJmb2N1cyAucmV2ZXJzZS11bnBhaXJlZC1maWx0ZXIgaW5wdXRcIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICAkKGV2LmN1cnJlbnRUYXJnZXQpLnNlbGVjdCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIHVucGFpcmVkXG4gICAgICAgICAgICBcImNsaWNrIC5mb3J3YXJkLWNvbHVtbiAuZGF0YXNldC51bnBhaXJlZFwiOiBcIl9jbGlja1VucGFpcmVkRGF0YXNldFwiLFxuICAgICAgICAgICAgXCJjbGljayAucmV2ZXJzZS1jb2x1bW4gLmRhdGFzZXQudW5wYWlyZWRcIjogXCJfY2xpY2tVbnBhaXJlZERhdGFzZXRcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLnBhaXJlZC1jb2x1bW4gLmRhdGFzZXQudW5wYWlyZWRcIjogXCJfY2xpY2tQYWlyUm93XCIsXG4gICAgICAgICAgICBcImNsaWNrIC51bnBhaXJlZC1jb2x1bW5zXCI6IFwiY2xlYXJTZWxlY3RlZFVucGFpcmVkXCIsXG4gICAgICAgICAgICBcIm1vdXNlZG93biAudW5wYWlyZWQtY29sdW1ucyAuZGF0YXNldFwiOiBcIl9tb3VzZWRvd25VbnBhaXJlZFwiLFxuICAgICAgICAgICAgLy8gZGl2aWRlclxuICAgICAgICAgICAgXCJjbGljayAucGFpcmVkLWNvbHVtbi10aXRsZVwiOiBcIl9jbGlja1Nob3dPbmx5UGFpcmVkXCIsXG4gICAgICAgICAgICBcIm1vdXNlZG93biAuZmxleGlibGUtcGFydGl0aW9uLWRyYWdcIjogXCJfc3RhcnRQYXJ0aXRpb25EcmFnXCIsXG4gICAgICAgICAgICAvLyBwYWlyZWRcbiAgICAgICAgICAgIFwiY2xpY2sgLnBhaXJlZC1jb2x1bW5zIC5kYXRhc2V0LnBhaXJlZFwiOiBcInNlbGVjdFBhaXJcIixcbiAgICAgICAgICAgIFwiY2xpY2sgLnBhaXJlZC1jb2x1bW5zXCI6IFwiY2xlYXJTZWxlY3RlZFBhaXJlZFwiLFxuICAgICAgICAgICAgXCJjbGljayAucGFpcmVkLWNvbHVtbnMgLnBhaXItbmFtZVwiOiBcIl9jbGlja1BhaXJOYW1lXCIsXG4gICAgICAgICAgICBcImNsaWNrIC51bnBhaXItYnRuXCI6IFwiX2NsaWNrVW5wYWlyXCIsXG4gICAgICAgICAgICAvLyBwYWlyZWQgLSBkcm9wIHRhcmdldFxuICAgICAgICAgICAgLy8nZHJhZ2VudGVyIC5wYWlyZWQtY29sdW1ucycgICAgICAgICAgICAgICAgIDogJ19kcmFnZW50ZXJQYWlyZWRDb2x1bW5zJyxcbiAgICAgICAgICAgIC8vJ2RyYWdsZWF2ZSAucGFpcmVkLWNvbHVtbnMgLmNvbHVtbi1kYXRhc2V0cyc6ICdfZHJhZ2xlYXZlUGFpcmVkQ29sdW1ucycsXG4gICAgICAgICAgICBcImRyYWdvdmVyIC5wYWlyZWQtY29sdW1ucyAuY29sdW1uLWRhdGFzZXRzXCI6IFwiX2RyYWdvdmVyUGFpcmVkQ29sdW1uc1wiLFxuICAgICAgICAgICAgXCJkcm9wIC5wYWlyZWQtY29sdW1ucyAuY29sdW1uLWRhdGFzZXRzXCI6IFwiX2Ryb3BQYWlyZWRDb2x1bW5zXCIsXG5cbiAgICAgICAgICAgIFwicGFpci5kcmFnc3RhcnQgLnBhaXJlZC1jb2x1bW5zIC5jb2x1bW4tZGF0YXNldHNcIjogXCJfcGFpckRyYWdzdGFydFwiLFxuICAgICAgICAgICAgXCJwYWlyLmRyYWdlbmQgICAucGFpcmVkLWNvbHVtbnMgLmNvbHVtbi1kYXRhc2V0c1wiOiBcIl9wYWlyRHJhZ2VuZFwiLFxuXG4gICAgICAgICAgICAvLyBmb290ZXJcbiAgICAgICAgICAgIFwiY2hhbmdlIC5yZW1vdmUtZXh0ZW5zaW9uc1wiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRXh0ZW5zaW9ucygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2hhbmdlIC5jb2xsZWN0aW9uLW5hbWVcIjogXCJfY2hhbmdlTmFtZVwiLFxuICAgICAgICAgICAgXCJrZXlkb3duIC5jb2xsZWN0aW9uLW5hbWVcIjogXCJfbmFtZUNoZWNrRm9yRW50ZXJcIixcbiAgICAgICAgICAgIFwiY2hhbmdlIC5oaWRlLW9yaWdpbmFsc1wiOiBcIl9jaGFuZ2VIaWRlT3JpZ2luYWxzXCIsXG4gICAgICAgICAgICBcImNsaWNrIC5jYW5jZWwtY3JlYXRlXCI6IFwiX2NhbmNlbENyZWF0ZVwiLFxuICAgICAgICAgICAgXCJjbGljayAuY3JlYXRlLWNvbGxlY3Rpb25cIjogXCJfY2xpY2tDcmVhdGVcIiAvLyxcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogdG9nZ2xlIGJldHdlZW4gc2hvd2luZyBvbmx5IHVucGFpcmVkIGFuZCBzcGxpdCB2aWV3ICovXG4gICAgICAgIF9jbGlja1Nob3dPbmx5VW5wYWlyZWQ6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICdjbGljayB1bnBhaXJlZCcsIGV2LmN1cnJlbnRUYXJnZXQgKTtcbiAgICAgICAgICAgIGlmICh0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnNcIikuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBhaXJlZCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGl0VmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvKiogdG9nZ2xlIGJldHdlZW4gc2hvd2luZyBvbmx5IHBhaXJlZCBhbmQgc3BsaXQgdmlldyAqL1xuICAgICAgICBfY2xpY2tTaG93T25seVBhaXJlZDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJ2NsaWNrIHBhaXJlZCcgKTtcbiAgICAgICAgICAgIGlmICh0aGlzLiQoXCIudW5wYWlyZWQtY29sdW1uc1wiKS5pcyhcIjp2aXNpYmxlXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlVW5wYWlyZWQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpdFZpZXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGlkZSB1bnBhaXJlZCwgc2hvdyBwYWlyZWQgKi9cbiAgICAgICAgaGlkZVVucGFpcmVkOiBmdW5jdGlvbihzcGVlZCwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMudW5wYWlyZWRQYW5lbEhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnBhaXJlZFBhbmVsSGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJNaWRkbGUoc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGhpZGUgcGFpcmVkLCBzaG93IHVucGFpcmVkICovXG4gICAgICAgIGhpZGVQYWlyZWQ6IGZ1bmN0aW9uKHNwZWVkLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy51bnBhaXJlZFBhbmVsSGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnBhaXJlZFBhbmVsSGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlck1pZGRsZShzcGVlZCwgY2FsbGJhY2spO1xuICAgICAgICB9LFxuICAgICAgICAvKiogc2hvdyBib3RoIHBhaXJlZCBhbmQgdW5wYWlyZWQgKHNwbGl0dGluZyBldmVubHkpICovXG4gICAgICAgIHNwbGl0VmlldzogZnVuY3Rpb24oc3BlZWQsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLnVucGFpcmVkUGFuZWxIaWRkZW4gPSB0aGlzLnBhaXJlZFBhbmVsSGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJNaWRkbGUoc3BlZWQsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiB1bnBhaXIgYWxsIHBhaXJlZCBhbmQgZG8gb3RoZXIgc3VwZXIgbmVhdCBzdHVmZiB3aGljaCBJJ20gbm90IHJlYWxseSBzdXJlIGFib3V0IHlldC4uLiAqL1xuICAgICAgICBfY2xpY2tVbnBhaXJBbGw6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICB0aGlzLm1ldHJpYyhcInVucGFpckFsbFwiKTtcbiAgICAgICAgICAgIHRoaXMudW5wYWlyQWxsKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGF0dGVtcHQgdG8gYXV0b3BhaXIgKi9cbiAgICAgICAgX2NsaWNrQXV0b3BhaXI6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICB2YXIgcGFpcmVkID0gdGhpcy5hdXRvUGFpcigpO1xuICAgICAgICAgICAgdGhpcy5tZXRyaWMoXCJhdXRvcGFpclwiLCBwYWlyZWQubGVuZ3RoLCB0aGlzLnVucGFpcmVkLmxlbmd0aCk7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJhdXRvcGFpclwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogc2V0IHRoZSBmaWx0ZXJzIGJhc2VkIG9uIHRoZSBkYXRhIGF0dHJpYnV0ZXMgb2YgdGhlIGJ1dHRvbiBjbGljayB0YXJnZXQgKi9cbiAgICAgICAgX2NsaWNrRmlsdGVyQ2hvaWNlOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgdmFyICRzZWxlY3RlZCA9ICQoZXYuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICB0aGlzLiQoXCIuZm9yd2FyZC11bnBhaXJlZC1maWx0ZXIgaW5wdXRcIikudmFsKCRzZWxlY3RlZC5kYXRhKFwiZm9yd2FyZFwiKSk7XG4gICAgICAgICAgICB0aGlzLiQoXCIucmV2ZXJzZS11bnBhaXJlZC1maWx0ZXIgaW5wdXRcIikudmFsKCRzZWxlY3RlZC5kYXRhKFwicmV2ZXJzZVwiKSk7XG4gICAgICAgICAgICB0aGlzLl9oaWRlQ2hvb3NlRmlsdGVycygpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwiZmlsdGVyLWNoYW5nZVwiKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogaGlkZSB0aGUgY2hvb3NlIGZpbHRlcnMgcG9wb3ZlciAqL1xuICAgICAgICBfaGlkZUNob29zZUZpbHRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy9UT0RPOiB1cGRhdGUgYm9vdHN0cmFwIGFuZCByZW1vdmUgdGhlIGZvbGxvd2luZyBoYWNrXG4gICAgICAgICAgICAvLyAgc2VlIGFsc286IGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9pc3N1ZXMvMTAyNjBcbiAgICAgICAgICAgIHRoaXMuJChcIi5jaG9vc2UtZmlsdGVycy1saW5rXCIpLnBvcG92ZXIoXCJoaWRlXCIpO1xuICAgICAgICAgICAgdGhpcy4kKFwiLnBvcG92ZXJcIikuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGNsZWFyIGJvdGggZmlsdGVycyAqL1xuICAgICAgICBfY2xlYXJGaWx0ZXJzOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgdGhpcy4kKFwiLmZvcndhcmQtdW5wYWlyZWQtZmlsdGVyIGlucHV0XCIpLnZhbChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMuJChcIi5yZXZlcnNlLXVucGFpcmVkLWZpbHRlciBpbnB1dFwiKS52YWwoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJmaWx0ZXItY2hhbmdlXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiB1bnBhaXJlZFxuICAgICAgICAvKiogc2VsZWN0IGFuIHVucGFpcmVkIGRhdGFzZXQgKi9cbiAgICAgICAgX2NsaWNrVW5wYWlyZWREYXRhc2V0OiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50b2dnbGVTZWxlY3RVbnBhaXJlZCgkKGV2LmN1cnJlbnRUYXJnZXQpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogVG9nZ2xlIHRoZSBzZWxlY3Rpb24gb2YgYW4gdW5wYWlyZWQgZGF0YXNldCByZXByZXNlbnRhdGlvbi5cbiAgICAgICAgICogIEBwYXJhbSBbalF1ZXJ5XSAkZGF0YXNldCAgICAgICAgdGhlIHVucGFpcmVkIGRhdGFzZXQgZG9tIHJlcCB0byBzZWxlY3RcbiAgICAgICAgICogIEBwYXJhbSBbQm9vbGVhbl0gb3B0aW9ucy5mb3JjZSAgaWYgZGVmaW5lZCwgZm9yY2Ugc2VsZWN0aW9uIGJhc2VkIG9uIFQvRjsgb3RoZXJ3aXNlLCB0b2dnbGVcbiAgICAgICAgICovXG4gICAgICAgIHRvZ2dsZVNlbGVjdFVucGFpcmVkOiBmdW5jdGlvbigkZGF0YXNldCwgb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgICB2YXIgZGF0YXNldCA9ICRkYXRhc2V0LmRhdGEoXCJkYXRhc2V0XCIpO1xuXG4gICAgICAgICAgICB2YXIgc2VsZWN0ID0gb3B0aW9ucy5mb3JjZSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5mb3JjZSA6ICEkZGF0YXNldC5oYXNDbGFzcyhcInNlbGVjdGVkXCIpO1xuXG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoIGlkLCBvcHRpb25zLmZvcmNlLCAkZGF0YXNldCwgZGF0YXNldCApO1xuICAgICAgICAgICAgaWYgKCEkZGF0YXNldC5sZW5ndGggfHwgZGF0YXNldCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRkYXRhc2V0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgJGRhdGFzZXQuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMud2FpdFRvUGFpcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhaXJBbGxTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGRhdGFzZXQucmVtb3ZlQ2xhc3MoXCJzZWxlY3RlZFwiKTtcbiAgICAgICAgICAgICAgICAvL2RlbGV0ZSBkYXRhc2V0LnNlbGVjdGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRkYXRhc2V0O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBwYWlyIGFsbCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHVucGFpcmVkIGRhdGFzZXRzICovXG4gICAgICAgIHBhaXJBbGxTZWxlY3RlZDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgZndkcyA9IFtdO1xuICAgICAgICAgICAgdmFyIHJldnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBwYWlycyA9IFtdO1xuICAgICAgICAgICAgc2VsZi4kKFwiLnVucGFpcmVkLWNvbHVtbnMgLmZvcndhcmQtY29sdW1uIC5kYXRhc2V0LnNlbGVjdGVkXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZndkcy5wdXNoKCQodGhpcykuZGF0YShcImRhdGFzZXRcIikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLiQoXCIudW5wYWlyZWQtY29sdW1ucyAucmV2ZXJzZS1jb2x1bW4gLmRhdGFzZXQuc2VsZWN0ZWRcIikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXZzLnB1c2goJCh0aGlzKS5kYXRhKFwiZGF0YXNldFwiKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZ3ZHMubGVuZ3RoID0gcmV2cy5sZW5ndGggPSBNYXRoLm1pbihmd2RzLmxlbmd0aCwgcmV2cy5sZW5ndGgpO1xuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCBmd2RzICk7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoIHJldnMgKTtcbiAgICAgICAgICAgIGZ3ZHMuZm9yRWFjaCgoZndkLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGFpcnMucHVzaChzZWxmLl9wYWlyKGZ3ZCwgcmV2c1tpXSwgeyBzaWxlbnQ6IHRydWUgfSkpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvL1RPRE86IHByZXNlcnZlIHNlbGVjdGVkIHN0YXRlIG9mIHRob3NlIHRoYXQgY291bGRuJ3QgYmUgcGFpcmVkXG4gICAgICAgICAgICAgICAgICAgIC8vVE9ETzogd2FybiB0aGF0IHNvbWUgY291bGQgbm90IGJlIHBhaXJlZFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocGFpcnMubGVuZ3RoICYmICFvcHRpb25zLnNpbGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcihcInBhaXI6bmV3XCIsIHBhaXJzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYWlycztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogY2xlYXIgdGhlIHNlbGVjdGlvbiBvbiBhbGwgdW5wYWlyZWQgZGF0YXNldHMgKi9cbiAgICAgICAgY2xlYXJTZWxlY3RlZFVucGFpcmVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuJChcIi51bnBhaXJlZC1jb2x1bW5zIC5kYXRhc2V0LnNlbGVjdGVkXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHdoZW4gaG9sZGluZyBkb3duIHRoZSBzaGlmdCBrZXkgb24gYSBjbGljaywgJ3BhaW50JyB0aGUgbW91c2VkIG92ZXIgZGF0YXNldHMgYXMgc2VsZWN0ZWQgKi9cbiAgICAgICAgX21vdXNlZG93blVucGFpcmVkOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgaWYgKGV2LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciAkc3RhcnRUYXJnZXQgPSAkKGV2LnRhcmdldCkuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcblxuICAgICAgICAgICAgICAgIHZhciBtb3ZlTGlzdGVuZXIgPSBldiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGZcbiAgICAgICAgICAgICAgICAgICAgICAgIC4kKGV2LnRhcmdldClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoXCIuZGF0YXNldFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICRzdGFydFRhcmdldC5wYXJlbnQoKS5vbihcIm1vdXNlbW92ZVwiLCBtb3ZlTGlzdGVuZXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gb24gYW55IG1vdXNldXAsIHN0b3AgbGlzdGVuaW5nIHRvIHRoZSBtb3ZlIGFuZCB0cnkgdG8gcGFpciBhbnkgc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbmUoXCJtb3VzZXVwXCIsIGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXJ0VGFyZ2V0LnBhcmVudCgpLm9mZihcIm1vdXNlbW92ZVwiLCBtb3ZlTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnBhaXJBbGxTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhdHRlbXB0IHRvIHBhaXIgdHdvIGRhdGFzZXRzIGRpcmVjdGx5IGFjcm9zcyBmcm9tIG9uZSBhbm90aGVyICovXG4gICAgICAgIF9jbGlja1BhaXJSb3c6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvL2lmKCAhZXYuY3VycmVudFRhcmdldCApeyByZXR1cm4gdHJ1ZTsgfVxuICAgICAgICAgICAgdmFyIHJvd0luZGV4ID0gJChldi5jdXJyZW50VGFyZ2V0KS5pbmRleCgpO1xuXG4gICAgICAgICAgICB2YXIgZndkID0gJChcIi51bnBhaXJlZC1jb2x1bW5zIC5mb3J3YXJkLWNvbHVtbiAuZGF0YXNldFwiKVxuICAgICAgICAgICAgICAgIC5lcShyb3dJbmRleClcbiAgICAgICAgICAgICAgICAuZGF0YShcImRhdGFzZXRcIik7XG5cbiAgICAgICAgICAgIHZhciByZXYgPSAkKFwiLnVucGFpcmVkLWNvbHVtbnMgLnJldmVyc2UtY29sdW1uIC5kYXRhc2V0XCIpXG4gICAgICAgICAgICAgICAgLmVxKHJvd0luZGV4KVxuICAgICAgICAgICAgICAgIC5kYXRhKFwiZGF0YXNldFwiKTtcblxuICAgICAgICAgICAgLy90aGlzLmRlYnVnKCAncm93OicsIHJvd0luZGV4LCBmd2QsIHJldiApO1xuICAgICAgICAgICAgdGhpcy5fcGFpcihmd2QsIHJldik7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGRpdmlkZXIvcGFydGl0aW9uXG4gICAgICAgIC8qKiBzdGFydCBkcmFnZ2luZyB0aGUgdmlzaWJsZSBkaXZpZGVyL3BhcnRpdGlvbiBiZXR3ZWVuIHVucGFpcmVkIGFuZCBwYWlyZWQgcGFuZXMgKi9cbiAgICAgICAgX3N0YXJ0UGFydGl0aW9uRHJhZzogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBzdGFydGluZ1kgPSBldi5wYWdlWTtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJ3BhcnRpdGlvbiBkcmFnIFNUQVJUOicsIGV2ICk7XG4gICAgICAgICAgICAkKFwiYm9keVwiKS5jc3MoXCJjdXJzb3JcIiwgXCJucy1yZXNpemVcIik7XG4gICAgICAgICAgICBzZWxmLiQoXCIuZmxleGlibGUtcGFydGl0aW9uLWRyYWdcIikuY3NzKFwiY29sb3JcIiwgXCJibGFja1wiKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZW5kRHJhZyhldikge1xuICAgICAgICAgICAgICAgIHNlbGYuJChcIi5mbGV4aWJsZS1wYXJ0aXRpb24tZHJhZ1wiKS5jc3MoXCJjb2xvclwiLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAkKFwiYm9keVwiKVxuICAgICAgICAgICAgICAgICAgICAuY3NzKFwiY3Vyc29yXCIsIFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIC51bmJpbmQoXCJtb3VzZW1vdmVcIiwgdHJhY2tNb3VzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiB0cmFja01vdXNlKGV2KSB7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IGV2LnBhZ2VZIC0gc3RhcnRpbmdZO1xuICAgICAgICAgICAgICAgIGlmICghc2VsZi5hZGpQYXJ0aXRpb24ob2Zmc2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAkKFwiYm9keVwiKS50cmlnZ2VyKFwibW91c2V1cFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5fYWRqVW5wYWlyZWRPblNjcm9sbGJhcigpO1xuICAgICAgICAgICAgICAgIHN0YXJ0aW5nWSArPSBvZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKFwiYm9keVwiKS5tb3VzZW1vdmUodHJhY2tNb3VzZSk7XG4gICAgICAgICAgICAkKFwiYm9keVwiKS5vbmUoXCJtb3VzZXVwXCIsIGVuZERyYWcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBhZGp1c3QgdGhlIHBhcml0aW9uIHVwL2Rvd24gKy8tYWRqIHBpeGVscyAqL1xuICAgICAgICBhZGpQYXJ0aXRpb246IGZ1bmN0aW9uKGFkaikge1xuICAgICAgICAgICAgdmFyICR1bnBhaXJlZCA9IHRoaXMuJChcIi51bnBhaXJlZC1jb2x1bW5zXCIpO1xuICAgICAgICAgICAgdmFyICRwYWlyZWQgPSB0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnNcIik7XG4gICAgICAgICAgICB2YXIgdW5wYWlyZWRIaSA9IHBhcnNlSW50KCR1bnBhaXJlZC5jc3MoXCJoZWlnaHRcIiksIDEwKTtcbiAgICAgICAgICAgIHZhciBwYWlyZWRIaSA9IHBhcnNlSW50KCRwYWlyZWQuY3NzKFwiaGVpZ2h0XCIpLCAxMCk7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoIGFkaiwgJ2hpXFwnczonLCB1bnBhaXJlZEhpLCBwYWlyZWRIaSwgdW5wYWlyZWRIaSArIGFkaiwgcGFpcmVkSGkgLSBhZGogKTtcblxuICAgICAgICAgICAgdW5wYWlyZWRIaSA9IE1hdGgubWF4KDEwLCB1bnBhaXJlZEhpICsgYWRqKTtcbiAgICAgICAgICAgIHBhaXJlZEhpID0gcGFpcmVkSGkgLSBhZGo7XG5cbiAgICAgICAgICAgIHZhciBtb3ZpbmdVcHdhcmRzID0gYWRqIDwgMDtcbiAgICAgICAgICAgIC8vIHdoZW4gdGhlIGRpdmlkZXIgZ2V0cyBjbG9zZSB0byB0aGUgdG9wIC0gbG9jayBpbnRvIGhpZGluZyB0aGUgdW5wYWlyZWQgc2VjdGlvblxuICAgICAgICAgICAgaWYgKG1vdmluZ1Vwd2FyZHMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy51bnBhaXJlZFBhbmVsSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVucGFpcmVkSGkgPD0gMTApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlVW5wYWlyZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudW5wYWlyZWRQYW5lbEhpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAkdW5wYWlyZWQuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVucGFpcmVkUGFuZWxIaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHdoZW4gdGhlIGRpdmlkZXIgZ2V0cyBjbG9zZSB0byB0aGUgYm90dG9tIC0gbG9jayBpbnRvIGhpZGluZyB0aGUgcGFpcmVkIHNlY3Rpb25cbiAgICAgICAgICAgIGlmICghbW92aW5nVXB3YXJkcykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhaXJlZFBhbmVsSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhaXJlZEhpIDw9IDE1KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBhaXJlZCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYWlyZWRQYW5lbEhpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAkcGFpcmVkLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWlyZWRQYW5lbEhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHVucGFpcmVkLmNzcyh7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBgJHt1bnBhaXJlZEhpfXB4YCxcbiAgICAgICAgICAgICAgICBmbGV4OiBcIjAgMCBhdXRvXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIHBhaXJlZFxuICAgICAgICAvKiogc2VsZWN0IGEgcGFpciB3aGVuIGNsaWNrZWQgKi9cbiAgICAgICAgc2VsZWN0UGFpcjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgJChldi5jdXJyZW50VGFyZ2V0KS50b2dnbGVDbGFzcyhcInNlbGVjdGVkXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBkZXNlbGVjdCBhbGwgcGFpcnMgKi9cbiAgICAgICAgY2xlYXJTZWxlY3RlZFBhaXJlZDogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgIHRoaXMuJChcIi5wYWlyZWQtY29sdW1ucyAuZGF0YXNldC5zZWxlY3RlZFwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiByZW5hbWUgYSBwYWlyIHdoZW4gdGhlIHBhaXIgbmFtZSBpcyBjbGlja2VkICovXG4gICAgICAgIF9jbGlja1BhaXJOYW1lOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB2YXIgJG5hbWUgPSAkKGV2LmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICAgICAgdmFyICRwYWlyID0gJG5hbWUucGFyZW50KCkucGFyZW50KCk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkcGFpci5pbmRleChcIi5kYXRhc2V0LnBhaXJlZFwiKTtcbiAgICAgICAgICAgIHZhciBwYWlyID0gdGhpcy5wYWlyZWRbaW5kZXhdO1xuICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gcHJvbXB0KFwiRW50ZXIgYSBuZXcgbmFtZSBmb3IgdGhlIHBhaXI6XCIsIHBhaXIubmFtZSk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBwYWlyLm5hbWUgPSByZXNwb25zZTtcbiAgICAgICAgICAgICAgICAvLyBzZXQgYSBmbGFnICh3aGljaCB3b24ndCBiZSBwYXNzZWQgaW4ganNvbiBjcmVhdGlvbikgZm9yIG1hbnVhbCBuYW1pbmcgc28gd2UgZG9uJ3Qgb3ZlcndyaXRlIHRoZXNlXG4gICAgICAgICAgICAgICAgLy8gIHdoZW4gYWRkaW5nL3JlbW92aW5nIGV4dGVuc2lvbnNcbiAgICAgICAgICAgICAgICAvL2hhY2tpc2hcbiAgICAgICAgICAgICAgICBwYWlyLmN1c3RvbWl6ZWROYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkbmFtZS50ZXh0KHBhaXIubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHVucGFpciB0aGlzIHBhaXIgKi9cbiAgICAgICAgX2NsaWNrVW5wYWlyOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgLy9pZiggIWV2LmN1cnJlbnRUYXJnZXQgKXsgcmV0dXJuIHRydWU7IH1cbiAgICAgICAgICAgIHZhciBwYWlySW5kZXggPSBNYXRoLmZsb29yKCQoZXYuY3VycmVudFRhcmdldCkuaW5kZXgoXCIudW5wYWlyLWJ0blwiKSk7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICdwYWlyOicsIHBhaXJJbmRleCApO1xuICAgICAgICAgICAgdGhpcy5fdW5wYWlyKHRoaXMucGFpcmVkW3BhaXJJbmRleF0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBwYWlyZWQgLSBkcmFnIGFuZCBkcm9wIHJlLW9yZGVyaW5nXG4gICAgICAgIC8vX2RyYWdlbnRlclBhaXJlZENvbHVtbnMgOiBmdW5jdGlvbiggZXYgKXtcbiAgICAgICAgLy8gICAgdGhpcy5kZWJ1ZyggJ19kcmFnZW50ZXJQYWlyZWRDb2x1bW5zOicsIGV2ICk7XG4gICAgICAgIC8vfSxcbiAgICAgICAgLy9fZHJhZ2xlYXZlUGFpcmVkQ29sdW1ucyA6IGZ1bmN0aW9uKCBldiApe1xuICAgICAgICAvLyAgICAvL3RoaXMuZGVidWcoICdfZHJhZ2xlYXZlUGFpcmVkQ29sdW1uczonLCBldiApO1xuICAgICAgICAvL30sXG4gICAgICAgIC8qKiB0cmFjayB0aGUgbW91c2UgZHJhZyBvdmVyIHRoZSBwYWlyZWQgbGlzdCBhZGRpbmcgYSBwbGFjZWhvbGRlciB0byBzaG93IHdoZXJlIHRoZSBkcm9wIHdvdWxkIG9jY3VyICovXG4gICAgICAgIF9kcmFnb3ZlclBhaXJlZENvbHVtbnM6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvL3RoaXMuZGVidWcoICdfZHJhZ292ZXJQYWlyZWRDb2x1bW5zOicsIGV2ICk7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICB2YXIgJGxpc3QgPSB0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnMgLmNvbHVtbi1kYXRhc2V0c1wiKTtcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrRm9yQXV0b3Njcm9sbCgkbGlzdCwgZXYub3JpZ2luYWxFdmVudC5jbGllbnRZKTtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggZXYub3JpZ2luYWxFdmVudC5jbGllbnRYLCBldi5vcmlnaW5hbEV2ZW50LmNsaWVudFkgKTtcbiAgICAgICAgICAgIHZhciAkbmVhcmVzdCA9IHRoaXMuX2dldE5lYXJlc3RQYWlyZWREYXRhc2V0TGkoZXYub3JpZ2luYWxFdmVudC5jbGllbnRZKTtcblxuICAgICAgICAgICAgJChcIi5lbGVtZW50LWRyb3AtcGxhY2Vob2xkZXJcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICB2YXIgJHBsYWNlaG9sZGVyID0gJCgnPGRpdiBjbGFzcz1cImVsZW1lbnQtZHJvcC1wbGFjZWhvbGRlclwiPjwvZGl2PicpO1xuICAgICAgICAgICAgaWYgKCEkbmVhcmVzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAkbGlzdC5hcHBlbmQoJHBsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJG5lYXJlc3QuYmVmb3JlKCRwbGFjZWhvbGRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIElmIHRoZSBtb3VzZSBpcyBuZWFyIGVub3VnaCB0byB0aGUgbGlzdCdzIHRvcCBvciBib3R0b20sIHNjcm9sbCB0aGUgbGlzdCAqL1xuICAgICAgICBfY2hlY2tGb3JBdXRvc2Nyb2xsOiBmdW5jdGlvbigkZWxlbWVudCwgeSkge1xuICAgICAgICAgICAgdmFyIEFVVE9TQ1JPTExfU1BFRUQgPSAyO1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9ICRlbGVtZW50Lm9mZnNldCgpO1xuICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9ICRlbGVtZW50LnNjcm9sbFRvcCgpO1xuICAgICAgICAgICAgdmFyIHVwcGVyRGlzdCA9IHkgLSBvZmZzZXQudG9wO1xuICAgICAgICAgICAgdmFyIGxvd2VyRGlzdCA9IG9mZnNldC50b3AgKyAkZWxlbWVudC5vdXRlckhlaWdodCgpIC0geTtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJ19jaGVja0ZvckF1dG9zY3JvbGw6Jywgc2Nyb2xsVG9wLCB1cHBlckRpc3QsIGxvd2VyRGlzdCApO1xuICAgICAgICAgICAgaWYgKHVwcGVyRGlzdCA+PSAwICYmIHVwcGVyRGlzdCA8IHRoaXMuYXV0b3Njcm9sbERpc3QpIHtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5zY3JvbGxUb3Aoc2Nyb2xsVG9wIC0gQVVUT1NDUk9MTF9TUEVFRCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGxvd2VyRGlzdCA+PSAwICYmIGxvd2VyRGlzdCA8IHRoaXMuYXV0b3Njcm9sbERpc3QpIHtcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5zY3JvbGxUb3Aoc2Nyb2xsVG9wICsgQVVUT1NDUk9MTF9TUEVFRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGdldCB0aGUgbmVhcmVzdCAqcHJldmlvdXMqIHBhaXJlZCBkYXRhc2V0IFBhaXJWaWV3IGJhc2VkIG9uIHRoZSBtb3VzZSdzIFkgY29vcmRpbmF0ZS5cbiAgICAgICAgICogICAgICBJZiB0aGUgeSBpcyBhdCB0aGUgZW5kIG9mIHRoZSBsaXN0LCByZXR1cm4gYW4gZW1wdHkgalF1ZXJ5IG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIF9nZXROZWFyZXN0UGFpcmVkRGF0YXNldExpOiBmdW5jdGlvbih5KSB7XG4gICAgICAgICAgICB2YXIgV0lHR0xFID0gNDtcbiAgICAgICAgICAgIHZhciBsaXMgPSB0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnMgLmNvbHVtbi1kYXRhc2V0cyBsaVwiKS50b0FycmF5KCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciAkbGkgPSAkKGxpc1tpXSk7XG4gICAgICAgICAgICAgICAgdmFyIHRvcCA9ICRsaS5vZmZzZXQoKS50b3A7XG4gICAgICAgICAgICAgICAgdmFyIGhhbGZIZWlnaHQgPSBNYXRoLmZsb29yKCRsaS5vdXRlckhlaWdodCgpIC8gMikgKyBXSUdHTEU7XG4gICAgICAgICAgICAgICAgaWYgKHRvcCArIGhhbGZIZWlnaHQgPiB5ICYmIHRvcCAtIGhhbGZIZWlnaHQgPCB5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggeSwgdG9wICsgaGFsZkhlaWdodCwgdG9wIC0gaGFsZkhlaWdodCApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkbGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgLyoqIGRyb3AgKGRyYWdnZWQvc2VsZWN0ZWQgUGFpclZpZXdzKSBvbnRvIHRoZSBsaXN0LCByZS1vcmRlcmluZyBib3RoIHRoZSBET00gYW5kIHRoZSBpbnRlcm5hbCBhcnJheSBvZiBwYWlycyAqL1xuICAgICAgICBfZHJvcFBhaXJlZENvbHVtbnM6IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgICAgICAvLyBib3RoIHJlcXVpcmVkIGZvciBmaXJlZm94XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXYuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSBcIm1vdmVcIjtcblxuICAgICAgICAgICAgdmFyICRuZWFyZXN0ID0gdGhpcy5fZ2V0TmVhcmVzdFBhaXJlZERhdGFzZXRMaShldi5vcmlnaW5hbEV2ZW50LmNsaWVudFkpO1xuICAgICAgICAgICAgaWYgKCRuZWFyZXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuJGRyYWdnaW5nLmluc2VydEJlZm9yZSgkbmVhcmVzdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIG5vIG5lYXJlc3QgYmVmb3JlIC0gaW5zZXJ0IGFmdGVyIGxhc3QgZWxlbWVudCAodW5wYWlyIGJ1dHRvbilcbiAgICAgICAgICAgICAgICB0aGlzLiRkcmFnZ2luZy5pbnNlcnRBZnRlcih0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnMgLnVucGFpci1idG5cIikubGFzdCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHJlc3luYyB0aGUgY3JlYXRvcidzIGxpc3Qgb2YgcGFpcmVkIGJhc2VkIG9uIHRoZSBuZXcgRE9NIG9yZGVyXG4gICAgICAgICAgICB0aGlzLl9zeW5jUGFpcnNUb0RvbSgpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICAvKiogcmVzeW5jIHRoZSBjcmVhdG9yJ3MgbGlzdCBvZiBwYWlyZWQgYmFzZWQgb24gdGhlIERPTSBvcmRlciBvZiBwYWlycyAqL1xuICAgICAgICBfc3luY1BhaXJzVG9Eb206IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG5ld1BhaXJlZCA9IFtdO1xuICAgICAgICAgICAgLy9UT0RPOiBkb2Vzbid0IHNlZW0gd2lzZSB0byB1c2UgdGhlIGRvbSB0byBzdG9yZSB0aGVzZSAtIGNhbid0IHdlIHN5bmMgYW5vdGhlciB3YXk/XG4gICAgICAgICAgICB0aGlzLiQoXCIucGFpcmVkLWNvbHVtbnMgLmRhdGFzZXQucGFpcmVkXCIpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgbmV3UGFpcmVkLnB1c2goJCh0aGlzKS5kYXRhKFwicGFpclwiKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggbmV3UGFpcmVkICk7XG4gICAgICAgICAgICB0aGlzLnBhaXJlZCA9IG5ld1BhaXJlZDtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhaXJlZCgpO1xuICAgICAgICB9LFxuICAgICAgICAvKiogZHJhZyBjb21tdW5pY2F0aW9uIHdpdGggcGFpciBzdWItdmlld3M6IGRyYWdzdGFydCAqL1xuICAgICAgICBfcGFpckRyYWdzdGFydDogZnVuY3Rpb24oZXYsIHBhaXIpIHtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJ19wYWlyRHJhZ3N0YXJ0JywgZXYsIHBhaXIgKVxuICAgICAgICAgICAgLy8gYXV0byBzZWxlY3QgdGhlIHBhaXIgY2F1c2luZyB0aGUgZXZlbnQgYW5kIG1vdmUgYWxsIHNlbGVjdGVkXG4gICAgICAgICAgICBwYWlyLiRlbC5hZGRDbGFzcyhcInNlbGVjdGVkXCIpO1xuICAgICAgICAgICAgdmFyICRzZWxlY3RlZCA9IHRoaXMuJChcIi5wYWlyZWQtY29sdW1ucyAuZGF0YXNldC5zZWxlY3RlZFwiKTtcbiAgICAgICAgICAgIHRoaXMuJGRyYWdnaW5nID0gJHNlbGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICAvKiogZHJhZyBjb21tdW5pY2F0aW9uIHdpdGggcGFpciBzdWItdmlld3M6IGRyYWdlbmQgLSByZW1vdmUgdGhlIHBsYWNlaG9sZGVyICovXG4gICAgICAgIF9wYWlyRHJhZ2VuZDogZnVuY3Rpb24oZXYsIHBhaXIpIHtcbiAgICAgICAgICAgIC8vdGhpcy5kZWJ1ZyggJ19wYWlyRHJhZ2VuZCcsIGV2LCBwYWlyIClcbiAgICAgICAgICAgICQoXCIuZWxlbWVudC1kcm9wLXBsYWNlaG9sZGVyXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy4kZHJhZ2dpbmcgPSBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBmb290ZXJcbiAgICAgICAgdG9nZ2xlRXh0ZW5zaW9uczogZnVuY3Rpb24oZm9yY2UpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHNlbGYucmVtb3ZlRXh0ZW5zaW9ucyA9IGZvcmNlICE9PSB1bmRlZmluZWQgPyBmb3JjZSA6ICFzZWxmLnJlbW92ZUV4dGVuc2lvbnM7XG5cbiAgICAgICAgICAgIF8uZWFjaChzZWxmLnBhaXJlZCwgcGFpciA9PiB7XG4gICAgICAgICAgICAgICAgLy8gZG9uJ3Qgb3ZlcndyaXRlIGN1c3RvbSBuYW1lc1xuICAgICAgICAgICAgICAgIGlmIChwYWlyLmN1c3RvbWl6ZWROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGFpci5uYW1lID0gc2VsZi5fZ3Vlc3NOYW1lRm9yUGFpcihwYWlyLmZvcndhcmQsIHBhaXIucmV2ZXJzZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2VsZi5fcmVuZGVyUGFpcmVkKCk7XG4gICAgICAgICAgICBzZWxmLl9yZW5kZXJGb290ZXIoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gbWlzY1xuICAgICAgICAvKiogZGVidWcgYSBkYXRhc2V0IGxpc3QgKi9cbiAgICAgICAgX3ByaW50TGlzdDogZnVuY3Rpb24obGlzdCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgXy5lYWNoKGxpc3QsIGUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0ID09PSBzZWxmLnBhaXJlZCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLl9wcmludFBhaXIoZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5kZWJ1ZyhlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcHJpbnQgYSBwYWlyIE9iamVjdCAqL1xuICAgICAgICBfcHJpbnRQYWlyOiBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgICAgICB0aGlzLmRlYnVnKHBhaXIuZm9yd2FyZC5uYW1lLCBwYWlyLnJldmVyc2UubmFtZSwgXCI6IC0+XCIsIHBhaXIubmFtZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiUGFpcmVkQ29sbGVjdGlvbkNyZWF0b3JcIjtcbiAgICAgICAgfSxcblxuICAgICAgICB0ZW1wbGF0ZXM6IF8uZXh0ZW5kKHt9LCBiYXNlQ3JlYXRvci5Db2xsZWN0aW9uQ3JlYXRvck1peGluLl9jcmVhdG9yVGVtcGxhdGVzLCB7XG4gICAgICAgICAgICAvKiogdGhlIGhlYWRlciAobm90IGluY2x1ZGluZyBoZWxwIHRleHQpICovXG4gICAgICAgICAgICBoZWFkZXI6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1haW4taGVscCB3ZWxsIGNsZWFyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwibW9yZS1oZWxwXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIk1vcmUgaGVscFwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiaGVscC1jb250ZW50XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxhIGNsYXNzPVwibGVzcy1oZWxwXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKTtcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkxlc3NcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImFsZXJ0IGFsZXJ0LWRpc21pc3NhYmxlXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJhbGVydFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L2J1dHRvbj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJhbGVydC1tZXNzYWdlXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG5cbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb2x1bW4taGVhZGVycyB2ZXJ0aWNhbGx5LXNwYWNlZCBmbGV4LWNvbHVtbi1jb250YWluZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvcndhcmQtY29sdW1uIGZsZXgtY29sdW1uIGNvbHVtblwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29sdW1uLWhlYWRlclwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY29sdW1uLXRpdGxlXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidGl0bGVcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIlVucGFpcmVkIGZvcndhcmRcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9zcGFuPlwiLFxuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ0aXRsZS1pbmZvIHVucGFpcmVkLWluZm9cIj48L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1bnBhaXJlZC1maWx0ZXIgZm9yd2FyZC11bnBhaXJlZC1maWx0ZXIgcHVsbC1sZWZ0XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCBjbGFzcz1cInNlYXJjaC1xdWVyeVwiIHBsYWNlaG9sZGVyPVwiJyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJGaWx0ZXIgdGhpcyBsaXN0XCIpLFxuICAgICAgICAgICAgICAgICAgICAnXCIgLz4nLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInBhaXJlZC1jb2x1bW4gZmxleC1jb2x1bW4gbm8tZmxleCBjb2x1bW5cIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbHVtbi1oZWFkZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJjaG9vc2UtZmlsdGVycy1saW5rXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQ2hvb3NlIGZpbHRlcnNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGEgY2xhc3M9XCJjbGVhci1maWx0ZXJzLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQ2xlYXIgZmlsdGVyc1wiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2E+PGJyIC8+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cImF1dG9wYWlyLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApO1wiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQXV0by1wYWlyXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJyZXZlcnNlLWNvbHVtbiBmbGV4LWNvbHVtbiBjb2x1bW5cIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbHVtbi1oZWFkZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbHVtbi10aXRsZVwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInRpdGxlXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJVbnBhaXJlZCByZXZlcnNlXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvc3Bhbj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidGl0bGUtaW5mbyB1bnBhaXJlZC1pbmZvXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidW5wYWlyZWQtZmlsdGVyIHJldmVyc2UtdW5wYWlyZWQtZmlsdGVyIHB1bGwtbGVmdFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8aW5wdXQgY2xhc3M9XCJzZWFyY2gtcXVlcnlcIiBwbGFjZWhvbGRlcj1cIicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiRmlsdGVyIHRoaXMgbGlzdFwiKSxcbiAgICAgICAgICAgICAgICAgICAgJ1wiIC8+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgKSxcblxuICAgICAgICAgICAgLyoqIHRoZSBtaWRkbGU6IHVucGFpcmVkLCBkaXZpZGVyLCBhbmQgcGFpcmVkICovXG4gICAgICAgICAgICBtaWRkbGU6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAvLyBjb250YWlucyB0d28gZmxleCByb3dzIChyb3dzIHRoYXQgZmlsbCBhdmFpbGFibGUgc3BhY2UpIGFuZCBhIGRpdmlkZXIgYnR3blxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVucGFpcmVkLWNvbHVtbnMgZmxleC1jb2x1bW4tY29udGFpbmVyIHNjcm9sbC1jb250YWluZXIgZmxleC1yb3dcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZvcndhcmQtY29sdW1uIGZsZXgtY29sdW1uIGNvbHVtblwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8b2wgY2xhc3M9XCJjb2x1bW4tZGF0YXNldHNcIj48L29sPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicGFpcmVkLWNvbHVtbiBmbGV4LWNvbHVtbiBuby1mbGV4IGNvbHVtblwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8b2wgY2xhc3M9XCJjb2x1bW4tZGF0YXNldHNcIj48L29sPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicmV2ZXJzZS1jb2x1bW4gZmxleC1jb2x1bW4gY29sdW1uXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxvbCBjbGFzcz1cImNvbHVtbi1kYXRhc2V0c1wiPjwvb2w+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJmbGV4aWJsZS1wYXJ0aXRpb25cIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImZsZXhpYmxlLXBhcnRpdGlvbi1kcmFnXCIgdGl0bGU9XCInLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkRyYWcgdG8gY2hhbmdlXCIpLFxuICAgICAgICAgICAgICAgICAgICAnXCI+PC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb2x1bW4taGVhZGVyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJjb2x1bW4tdGl0bGUgcGFpcmVkLWNvbHVtbi10aXRsZVwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInRpdGxlXCI+PC9zcGFuPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8YSBjbGFzcz1cInVucGFpci1hbGwtbGlua1wiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMCk7XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJVbnBhaXIgYWxsXCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJwYWlyZWQtY29sdW1ucyBmbGV4LWNvbHVtbi1jb250YWluZXIgc2Nyb2xsLWNvbnRhaW5lciBmbGV4LXJvd1wiPicsXG4gICAgICAgICAgICAgICAgICAgICc8b2wgY2xhc3M9XCJjb2x1bW4tZGF0YXNldHNcIj48L29sPicsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICksXG5cbiAgICAgICAgICAgIC8qKiBjcmVhdGlvbiBhbmQgY2FuY2VsIGNvbnRyb2xzICovXG4gICAgICAgICAgICBmb290ZXI6IF8udGVtcGxhdGUoXG4gICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImF0dHJpYnV0ZXMgY2xlYXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxsYWJlbCBjbGFzcz1cInNldHRpbmctcHJvbXB0IHB1bGwtcmlnaHRcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkhpZGUgb3JpZ2luYWwgZWxlbWVudHNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiP1wiLFxuICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGNsYXNzPVwiaGlkZS1vcmlnaW5hbHMgcHVsbC1yaWdodFwiIHR5cGU9XCJjaGVja2JveFwiIC8+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xhYmVsPlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGxhYmVsIGNsYXNzPVwic2V0dGluZy1wcm9tcHQgcHVsbC1yaWdodFwiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiUmVtb3ZlIGZpbGUgZXh0ZW5zaW9ucyBmcm9tIHBhaXIgbmFtZXNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiP1wiLFxuICAgICAgICAgICAgICAgICAgICAnPGlucHV0IGNsYXNzPVwicmVtb3ZlLWV4dGVuc2lvbnMgcHVsbC1yaWdodFwiIHR5cGU9XCJjaGVja2JveFwiIC8+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2xhYmVsPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNsZWFyXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxpbnB1dCBjbGFzcz1cImNvbGxlY3Rpb24tbmFtZSBmb3JtLWNvbnRyb2wgcHVsbC1yaWdodFwiICcsXG4gICAgICAgICAgICAgICAgICAgICdwbGFjZWhvbGRlcj1cIicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiRW50ZXIgYSBuYW1lIGZvciB5b3VyIG5ldyBsaXN0XCIpLFxuICAgICAgICAgICAgICAgICAgICAnXCIgLz4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tbmFtZS1wcm9tcHQgcHVsbC1yaWdodFwiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiTmFtZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI6PC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC9kaXY+XCIsXG5cbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJhY3Rpb25zIGNsZWFyIHZlcnRpY2FsbHktc3BhY2VkXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJvdGhlci1vcHRpb25zIHB1bGwtbGVmdFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8YnV0dG9uIGNsYXNzPVwiY2FuY2VsLWNyZWF0ZSBidG5cIiB0YWJpbmRleD1cIi0xXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJDYW5jZWxcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9idXR0b24+XCIsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwiY3JlYXRlLW90aGVyIGJ0bi1ncm91cCBkcm9wdXBcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tZGVmYXVsdCBkcm9wZG93bi10b2dnbGVcIiBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgX2woXCJDcmVhdGUgYSBkaWZmZXJlbnQga2luZCBvZiBjb2xsZWN0aW9uXCIpLFxuICAgICAgICAgICAgICAgICAgICAnIDxzcGFuIGNsYXNzPVwiY2FyZXRcIj48L3NwYW4+JyxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2J1dHRvbj5cIixcbiAgICAgICAgICAgICAgICAgICAgJzx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnVcIiByb2xlPVwibWVudVwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8bGk+PGEgaHJlZj1cIiNcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkNyZWF0ZSBhIDxpPnNpbmdsZTwvaT4gcGFpclwiKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L2E+PC9saT5cIixcbiAgICAgICAgICAgICAgICAgICAgJzxsaT48YSBocmVmPVwiI1wiPicsXG4gICAgICAgICAgICAgICAgICAgIF9sKFwiQ3JlYXRlIGEgbGlzdCBvZiA8aT51bnBhaXJlZDwvaT4gZGF0YXNldHNcIiksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9hPjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPC91bD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8L2Rpdj5cIixcblxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1haW4tb3B0aW9ucyBwdWxsLXJpZ2h0XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gY2xhc3M9XCJjcmVhdGUtY29sbGVjdGlvbiBidG4gYnRuLXByaW1hcnlcIj4nLFxuICAgICAgICAgICAgICAgICAgICBfbChcIkNyZWF0ZSBsaXN0XCIpLFxuICAgICAgICAgICAgICAgICAgICBcIjwvYnV0dG9uPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICApLFxuXG4gICAgICAgICAgICAvKiogaGVscCBjb250ZW50ICovXG4gICAgICAgICAgICBoZWxwQ29udGVudDogXy50ZW1wbGF0ZShcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIFwiPHA+XCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ29sbGVjdGlvbnMgb2YgcGFpcmVkIGRhdGFzZXRzIGFyZSBvcmRlcmVkIGxpc3RzIG9mIGRhdGFzZXQgcGFpcnMgKG9mdGVuIGZvcndhcmQgYW5kIHJldmVyc2UgcmVhZHMpLiBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlRoZXNlIGNvbGxlY3Rpb25zIGNhbiBiZSBwYXNzZWQgdG8gdG9vbHMgYW5kIHdvcmtmbG93cyBpbiBvcmRlciB0byBoYXZlIGFuYWx5c2VzIGRvbmUgb24gZWFjaCBtZW1iZXIgb2YgXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aGUgZW50aXJlIGdyb3VwLiBUaGlzIGludGVyZmFjZSBhbGxvd3MgeW91IHRvIGNyZWF0ZSBhIGNvbGxlY3Rpb24sIGNob29zZSB3aGljaCBkYXRhc2V0cyBhcmUgcGFpcmVkLCBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFuZCByZS1vcmRlciB0aGUgZmluYWwgY29sbGVjdGlvbi5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgXS5qb2luKFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIFwiPC9wPlwiLFxuICAgICAgICAgICAgICAgICAgICBcIjxwPlwiLFxuICAgICAgICAgICAgICAgICAgICBfbChcbiAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVW5wYWlyZWQgZGF0YXNldHMgYXJlIHNob3duIGluIHRoZSA8aSBkYXRhLXRhcmdldD1cIi51bnBhaXJlZC1jb2x1bW5zXCI+dW5wYWlyZWQgc2VjdGlvbjwvaT4gJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIihob3ZlciBvdmVyIHRoZSB1bmRlcmxpbmVkIHdvcmRzIHRvIGhpZ2hsaWdodCBiZWxvdykuIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQYWlyZWQgZGF0YXNldHMgYXJlIHNob3duIGluIHRoZSA8aSBkYXRhLXRhcmdldD1cIi5wYWlyZWQtY29sdW1uc1wiPnBhaXJlZCBzZWN0aW9uPC9pPi4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPHVsPlRvIHBhaXIgZGF0YXNldHMsIHlvdSBjYW46XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8bGk+Q2xpY2sgYSBkYXRhc2V0IGluIHRoZSBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIudW5wYWlyZWQtY29sdW1ucyAuZm9yd2FyZC1jb2x1bW4gLmNvbHVtbi1kYXRhc2V0cywnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcudW5wYWlyZWQtY29sdW1ucyAuZm9yd2FyZC1jb2x1bW5cIj5mb3J3YXJkIGNvbHVtbjwvaT4gJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvIHNlbGVjdCBpdCB0aGVuIGNsaWNrIGEgZGF0YXNldCBpbiB0aGUgXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpIGRhdGEtdGFyZ2V0PVwiLnVucGFpcmVkLWNvbHVtbnMgLnJldmVyc2UtY29sdW1uIC5jb2x1bW4tZGF0YXNldHMsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLnVucGFpcmVkLWNvbHVtbnMgLnJldmVyc2UtY29sdW1uXCI+cmV2ZXJzZSBjb2x1bW48L2k+LicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8bGk+Q2xpY2sgb25lIG9mIHRoZSBcIlBhaXIgdGhlc2UgZGF0YXNldHNcIiBidXR0b25zIGluIHRoZSAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aSBkYXRhLXRhcmdldD1cIi51bnBhaXJlZC1jb2x1bW5zIC5wYWlyZWQtY29sdW1uIC5jb2x1bW4tZGF0YXNldHMsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLnVucGFpcmVkLWNvbHVtbnMgLnBhaXJlZC1jb2x1bW5cIj5taWRkbGUgY29sdW1uPC9pPiAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG8gcGFpciB0aGUgZGF0YXNldHMgaW4gYSBwYXJ0aWN1bGFyIHJvdy5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxsaT5DbGljayA8aSBkYXRhLXRhcmdldD1cIi5hdXRvcGFpci1saW5rXCI+XCJBdXRvLXBhaXJcIjwvaT4gJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvIGhhdmUgeW91ciBkYXRhc2V0cyBhdXRvbWF0aWNhbGx5IHBhaXJlZCBiYXNlZCBvbiBuYW1lLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9saT5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvdWw+XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvcD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8cD5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8dWw+WW91IGNhbiBmaWx0ZXIgd2hhdCBpcyBzaG93biBpbiB0aGUgdW5wYWlyZWQgc2VjdGlvbnMgYnk6XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8bGk+RW50ZXJpbmcgcGFydGlhbCBkYXRhc2V0IG5hbWVzIGluIGVpdGhlciB0aGUgXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpIGRhdGEtdGFyZ2V0PVwiLmZvcndhcmQtdW5wYWlyZWQtZmlsdGVyIGlucHV0XCI+Zm9yd2FyZCBmaWx0ZXI8L2k+IG9yICcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpIGRhdGEtdGFyZ2V0PVwiLnJldmVyc2UtdW5wYWlyZWQtZmlsdGVyIGlucHV0XCI+cmV2ZXJzZSBmaWx0ZXI8L2k+LicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGxpPkNob29zaW5nIGZyb20gYSBsaXN0IG9mIHByZXNldCBmaWx0ZXJzIGJ5IGNsaWNraW5nIHRoZSBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIuY2hvb3NlLWZpbHRlcnMtbGlua1wiPlwiQ2hvb3NlIGZpbHRlcnNcIiBsaW5rPC9pPi4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPC9saT5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjxsaT5FbnRlcmluZyByZWd1bGFyIGV4cHJlc3Npb25zIHRvIG1hdGNoIGRhdGFzZXQgbmFtZXMuIFNlZTogXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9XCJodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL1JlZ3VsYXJfRXhwcmVzc2lvbnNcIicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyB0YXJnZXQ9XCJfYmxhbmtcIj5NRE5cXCdzIEphdmFTY3JpcHQgUmVndWxhciBFeHByZXNzaW9uIFR1dG9yaWFsPC9hPi4gJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIk5vdGU6IGZvcndhcmQgc2xhc2hlcyAoXFxcXCkgYXJlIG5vdCBuZWVkZWQuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L2xpPlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGxpPkNsZWFyaW5nIHRoZSBmaWx0ZXJzIGJ5IGNsaWNraW5nIHRoZSBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIuY2xlYXItZmlsdGVycy1saW5rXCI+XCJDbGVhciBmaWx0ZXJzXCIgbGluazwvaT4uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIjwvbGk+XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI8L3VsPlwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L3A+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPHA+XCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVG8gdW5wYWlyIGluZGl2aWR1YWwgZGF0YXNldCBwYWlycywgY2xpY2sgdGhlIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8aSBkYXRhLXRhcmdldD1cIi51bnBhaXItYnRuXCI+dW5wYWlyIGJ1dHRvbnMgKCA8c3BhbiBjbGFzcz1cImZhIGZhLXVubGlua1wiPjwvc3Bhbj4gKTwvaT4uICcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0NsaWNrIHRoZSA8aSBkYXRhLXRhcmdldD1cIi51bnBhaXItYWxsLWxpbmtcIj5cIlVucGFpciBhbGxcIiBsaW5rPC9pPiB0byB1bnBhaXIgYWxsIHBhaXJzLidcbiAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBcIjwvcD5cIixcbiAgICAgICAgICAgICAgICAgICAgXCI8cD5cIixcbiAgICAgICAgICAgICAgICAgICAgX2woXG4gICAgICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1lvdSBjYW4gaW5jbHVkZSBvciByZW1vdmUgdGhlIGZpbGUgZXh0ZW5zaW9ucyAoZS5nLiBcIi5mYXN0cVwiKSBmcm9tIHlvdXIgcGFpciBuYW1lcyBieSB0b2dnbGluZyB0aGUgJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGkgZGF0YS10YXJnZXQ9XCIucmVtb3ZlLWV4dGVuc2lvbnMtcHJvbXB0XCI+XCJSZW1vdmUgZmlsZSBleHRlbnNpb25zIGZyb20gcGFpciBuYW1lcz9cIjwvaT4gY29udHJvbC4nXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L3A+XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiPHA+XCIsXG4gICAgICAgICAgICAgICAgICAgIF9sKFxuICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdPbmNlIHlvdXIgY29sbGVjdGlvbiBpcyBjb21wbGV0ZSwgZW50ZXIgYSA8aSBkYXRhLXRhcmdldD1cIi5jb2xsZWN0aW9uLW5hbWVcIj5uYW1lPC9pPiBhbmQgJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xpY2sgPGkgZGF0YS10YXJnZXQ9XCIuY3JlYXRlLWNvbGxlY3Rpb25cIj5cIkNyZWF0ZSBsaXN0XCI8L2k+LiAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiKE5vdGU6IHlvdSBkbyBub3QgaGF2ZSB0byBwYWlyIGFsbCB1bnBhaXJlZCBkYXRhc2V0cyB0byBmaW5pc2guKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgXCI8L3A+XCJcbiAgICAgICAgICAgICAgICBdLmpvaW4oXCJcIilcbiAgICAgICAgICAgIClcbiAgICAgICAgfSlcbiAgICB9KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIGEgbW9kYWwgdmVyc2lvbiBvZiB0aGUgcGFpcmVkIGNvbGxlY3Rpb24gY3JlYXRvciAqL1xudmFyIHBhaXJlZENvbGxlY3Rpb25DcmVhdG9yTW9kYWwgPSBmdW5jdGlvbiBfcGFpcmVkQ29sbGVjdGlvbkNyZWF0b3JNb2RhbChkYXRhc2V0cywgb3B0aW9ucykge1xuICAgIHZhciBkZWZlcnJlZCA9IGpRdWVyeS5EZWZlcnJlZCgpO1xuICAgIHZhciBjcmVhdG9yO1xuXG4gICAgb3B0aW9ucyA9IF8uZGVmYXVsdHMob3B0aW9ucyB8fCB7fSwge1xuICAgICAgICBkYXRhc2V0czogZGF0YXNldHMsXG4gICAgICAgIG9uY2FuY2VsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIEdhbGF4eS5tb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoXCJjYW5jZWxsZWRcIik7XG4gICAgICAgIH0sXG4gICAgICAgIG9uY3JlYXRlOiBmdW5jdGlvbihjcmVhdG9yLCByZXNwb25zZSkge1xuICAgICAgICAgICAgR2FsYXh5Lm1vZGFsLmhpZGUoKTtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICB9LFxuICAgICAgICB0aXRsZTogX2woXCJDcmVhdGUgYSBjb2xsZWN0aW9uIG9mIHBhaXJlZCBkYXRhc2V0c1wiKVxuICAgIH0pO1xuXG4gICAgaWYgKCF3aW5kb3cuR2FsYXh5IHx8ICFHYWxheHkubW9kYWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2FsYXh5IG9yIEdhbGF4eS5tb2RhbCBub3QgZm91bmRcIik7XG4gICAgfVxuXG4gICAgY3JlYXRvciA9IG5ldyBQYWlyZWRDb2xsZWN0aW9uQ3JlYXRvcihvcHRpb25zKTtcbiAgICBHYWxheHkubW9kYWwuc2hvdyh7XG4gICAgICAgIHRpdGxlOiBvcHRpb25zLnRpdGxlLFxuICAgICAgICBib2R5OiBjcmVhdG9yLiRlbCxcbiAgICAgICAgd2lkdGg6IFwiODAlXCIsXG4gICAgICAgIGhlaWdodDogXCI4MDBweFwiLFxuICAgICAgICBjbG9zaW5nX2V2ZW50czogdHJ1ZVxuICAgIH0pO1xuICAgIGNyZWF0b3IucmVuZGVyKCk7XG4gICAgd2luZG93LmNyZWF0b3IgPSBjcmVhdG9yO1xuXG4gICAgLy9UT0RPOiByZW1vdmUgbW9kYWwgaGVhZGVyXG4gICAgcmV0dXJuIGRlZmVycmVkO1xufTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuZnVuY3Rpb24gY3JlYXRlTGlzdE9mUGFpcnNDb2xsZWN0aW9uKGNvbGxlY3Rpb24sIGRlZmF1bHRIaWRlU291cmNlSXRlbXMpIHtcbiAgICB2YXIgZWxlbWVudHMgPSBjb2xsZWN0aW9uLnRvSlNPTigpO1xuICAgIC8vVE9ETzogdmFsaWRhdGUgZWxlbWVudHNcbiAgICByZXR1cm4gcGFpcmVkQ29sbGVjdGlvbkNyZWF0b3JNb2RhbChlbGVtZW50cywge1xuICAgICAgICBoaXN0b3J5SWQ6IGNvbGxlY3Rpb24uaGlzdG9yeUlkLFxuICAgICAgICBkZWZhdWx0SGlkZVNvdXJjZUl0ZW1zOiBkZWZhdWx0SGlkZVNvdXJjZUl0ZW1zXG4gICAgfSk7XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBQYWlyZWRDb2xsZWN0aW9uQ3JlYXRvcjogUGFpcmVkQ29sbGVjdGlvbkNyZWF0b3IsXG4gICAgcGFpcmVkQ29sbGVjdGlvbkNyZWF0b3JNb2RhbDogcGFpcmVkQ29sbGVjdGlvbkNyZWF0b3JNb2RhbCxcbiAgICBjcmVhdGVMaXN0T2ZQYWlyc0NvbGxlY3Rpb246IGNyZWF0ZUxpc3RPZlBhaXJzQ29sbGVjdGlvblxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvY29sbGVjdGlvbi9saXN0LW9mLXBhaXJzLWNvbGxlY3Rpb24tY3JlYXRvci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FBWUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEVBO0FBQ0E7QUFvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQWJBO0FBQ0E7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBbEJBO0FBQ0E7QUFvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQWxCQTtBQUNBO0FBb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQVZBO0FBaUJBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQVZBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0JBO0FBQ0E7QUFRQTtBQUFBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4REE7QUFDQTtBQTBEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0VBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUE2QkE7QUFDQTtBQUNBO0FBdURBO0FBQ0E7QUEvSkE7QUE1eUNBO0FBQ0E7QUFzaURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQUNBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///75\n");

/***/ }),
/* 76 */,
/* 77 */,
/* 78 */,
/* 79 */,
/* 80 */,
/* 81 */,
/* 82 */,
/* 83 */,
/* 84 */,
/* 85 */,
/* 86 */,
/* 87 */,
/* 88 */,
/* 89 */,
/* 90 */,
/* 91 */
/*!*****************************************!*\
  !*** ./galaxy/scripts/layout/router.js ***!
  \*****************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _jquery = __webpack_require__(/*! jquery */ 0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _queryStringParsing = __webpack_require__(/*! utils/query-string-parsing */ 27);\n\nvar _queryStringParsing2 = _interopRequireDefault(_queryStringParsing);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar $ = _jquery2.default;\n\n\nvar Router = Backbone.Router.extend({\n    // TODO: not many client routes at this point - fill and remove from server.\n    // since we're at root here, this may be the last to be routed entirely on the client.\n    initialize: function initialize(page, options) {\n        this.page = page;\n        this.options = options;\n    },\n\n    /** helper to push a new navigation state */\n    push: function push(url, data) {\n        data = data || {};\n        data.__identifer = Math.random().toString(36).substr(2);\n        url += url.indexOf(\"?\") == -1 ? \"?\" : \"&\";\n        url += $.param(data, true);\n        Galaxy.params = data;\n        this.navigate(url, { trigger: true });\n    },\n\n    /** override to parse query string into obj and send to each route */\n    execute: function execute(callback, args, name) {\n        Galaxy.debug(\"router execute:\", callback, args, name);\n        var queryObj = _queryStringParsing2.default.parse(args.pop());\n        args.push(queryObj);\n        if (callback) {\n            if (this.authenticate(args, name)) {\n                callback.apply(this, args);\n            } else {\n                this.access_denied();\n            }\n        }\n    },\n\n    authenticate: function authenticate(args, name) {\n        return true;\n    },\n\n    access_denied: function access_denied() {\n        this.page.display(new _uiMisc2.default.Message({\n            status: \"danger\",\n            message: \"You must be logged in with proper credentials to make this request.\",\n            persistent: true\n        }));\n    }\n});\n\nexports.default = Router;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbGF5b3V0L3JvdXRlci5qcz8yNmNhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqUXVlcnkgZnJvbSBcImpxdWVyeVwiO1xudmFyICQgPSBqUXVlcnk7XG5pbXBvcnQgUVVFUllfU1RSSU5HIGZyb20gXCJ1dGlscy9xdWVyeS1zdHJpbmctcGFyc2luZ1wiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xuXG52YXIgUm91dGVyID0gQmFja2JvbmUuUm91dGVyLmV4dGVuZCh7XG4gICAgLy8gVE9ETzogbm90IG1hbnkgY2xpZW50IHJvdXRlcyBhdCB0aGlzIHBvaW50IC0gZmlsbCBhbmQgcmVtb3ZlIGZyb20gc2VydmVyLlxuICAgIC8vIHNpbmNlIHdlJ3JlIGF0IHJvb3QgaGVyZSwgdGhpcyBtYXkgYmUgdGhlIGxhc3QgdG8gYmUgcm91dGVkIGVudGlyZWx5IG9uIHRoZSBjbGllbnQuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocGFnZSwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLnBhZ2UgPSBwYWdlO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIH0sXG5cbiAgICAvKiogaGVscGVyIHRvIHB1c2ggYSBuZXcgbmF2aWdhdGlvbiBzdGF0ZSAqL1xuICAgIHB1c2g6IGZ1bmN0aW9uKHVybCwgZGF0YSkge1xuICAgICAgICBkYXRhID0gZGF0YSB8fCB7fTtcbiAgICAgICAgZGF0YS5fX2lkZW50aWZlciA9IE1hdGgucmFuZG9tKClcbiAgICAgICAgICAgIC50b1N0cmluZygzNilcbiAgICAgICAgICAgIC5zdWJzdHIoMik7XG4gICAgICAgIHVybCArPSB1cmwuaW5kZXhPZihcIj9cIikgPT0gLTEgPyBcIj9cIiA6IFwiJlwiO1xuICAgICAgICB1cmwgKz0gJC5wYXJhbShkYXRhLCB0cnVlKTtcbiAgICAgICAgR2FsYXh5LnBhcmFtcyA9IGRhdGE7XG4gICAgICAgIHRoaXMubmF2aWdhdGUodXJsLCB7IHRyaWdnZXI6IHRydWUgfSk7XG4gICAgfSxcblxuICAgIC8qKiBvdmVycmlkZSB0byBwYXJzZSBxdWVyeSBzdHJpbmcgaW50byBvYmogYW5kIHNlbmQgdG8gZWFjaCByb3V0ZSAqL1xuICAgIGV4ZWN1dGU6IGZ1bmN0aW9uKGNhbGxiYWNrLCBhcmdzLCBuYW1lKSB7XG4gICAgICAgIEdhbGF4eS5kZWJ1ZyhcInJvdXRlciBleGVjdXRlOlwiLCBjYWxsYmFjaywgYXJncywgbmFtZSk7XG4gICAgICAgIHZhciBxdWVyeU9iaiA9IFFVRVJZX1NUUklORy5wYXJzZShhcmdzLnBvcCgpKTtcbiAgICAgICAgYXJncy5wdXNoKHF1ZXJ5T2JqKTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRoZW50aWNhdGUoYXJncywgbmFtZSkpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2Nlc3NfZGVuaWVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYXV0aGVudGljYXRlOiBmdW5jdGlvbihhcmdzLCBuYW1lKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG5cbiAgICBhY2Nlc3NfZGVuaWVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkoXG4gICAgICAgICAgICBuZXcgVWkuTWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBcImRhbmdlclwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiWW91IG11c3QgYmUgbG9nZ2VkIGluIHdpdGggcHJvcGVyIGNyZWRlbnRpYWxzIHRvIG1ha2UgdGhpcyByZXF1ZXN0LlwiLFxuICAgICAgICAgICAgICAgIHBlcnNpc3RlbnQ6IHRydWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IFJvdXRlcjtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9sYXlvdXQvcm91dGVyLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUhBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBOUNBO0FBQ0E7QUFnREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///91\n");

/***/ }),
/* 92 */
/*!******************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-settings.js ***!
  \******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    options: {\n        class_check: \"fa-check-square-o\",\n        class_uncheck: \"fa-square-o\",\n        parameters: [{\n            id: \"space_to_tab\",\n            title: \"Convert spaces to tabs\"\n        }, {\n            id: \"to_posix_lines\",\n            title: \"Use POSIX standard\"\n        }]\n    },\n\n    initialize: function initialize(options) {\n        var self = this;\n        this.model = options.model;\n        this.setElement($(\"<div/>\").addClass(\"upload-settings\"));\n        this.$el.append($(\"<div/>\").addClass(\"upload-settings-cover\"));\n        this.$el.append($(\"<table/>\").addClass(\"upload-settings-table ui-table-striped\").append(\"<tbody/>\"));\n        this.$cover = this.$(\".upload-settings-cover\");\n        this.$table = this.$(\".upload-settings-table > tbody\");\n        this.listenTo(this.model, \"change\", this.render, this);\n        this.model.trigger(\"change\");\n    },\n\n    render: function render() {\n        var self = this;\n        this.$table.empty();\n        _.each(this.options.parameters, function (parameter) {\n            var $checkbox = $(\"<div/>\").addClass(\"upload-\" + parameter.id + \" upload-icon-button fa\").addClass(self.model.get(parameter.id) && self.options.class_check || self.options.class_uncheck).on(\"click\", function () {\n                self.model.get(\"enabled\") && self.model.set(parameter.id, !self.model.get(parameter.id));\n            });\n            self.$table.append($(\"<tr/>\").append($(\"<td/>\").append($checkbox)).append($(\"<td/>\").append(parameter.title)));\n        });\n        this.$cover[this.model.get(\"enabled\") && \"hide\" || \"show\"]();\n    }\n}); /** This renders the content of the settings popup, allowing users to specify flags i.e. for space-to-tab conversion **/\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtc2V0dGluZ3MuanM/YTc3OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogVGhpcyByZW5kZXJzIHRoZSBjb250ZW50IG9mIHRoZSBzZXR0aW5ncyBwb3B1cCwgYWxsb3dpbmcgdXNlcnMgdG8gc3BlY2lmeSBmbGFncyBpLmUuIGZvciBzcGFjZS10by10YWIgY29udmVyc2lvbiAqKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmV4cG9ydCBkZWZhdWx0IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBvcHRpb25zOiB7XG4gICAgICAgIGNsYXNzX2NoZWNrOiBcImZhLWNoZWNrLXNxdWFyZS1vXCIsXG4gICAgICAgIGNsYXNzX3VuY2hlY2s6IFwiZmEtc3F1YXJlLW9cIixcbiAgICAgICAgcGFyYW1ldGVyczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiBcInNwYWNlX3RvX3RhYlwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBcIkNvbnZlcnQgc3BhY2VzIHRvIHRhYnNcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogXCJ0b19wb3NpeF9saW5lc1wiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBcIlVzZSBQT1NJWCBzdGFuZGFyZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubW9kZWwgPSBvcHRpb25zLm1vZGVsO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQoJChcIjxkaXYvPlwiKS5hZGRDbGFzcyhcInVwbG9hZC1zZXR0aW5nc1wiKSk7XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCgkKFwiPGRpdi8+XCIpLmFkZENsYXNzKFwidXBsb2FkLXNldHRpbmdzLWNvdmVyXCIpKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKFxuICAgICAgICAgICAgJChcIjx0YWJsZS8+XCIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidXBsb2FkLXNldHRpbmdzLXRhYmxlIHVpLXRhYmxlLXN0cmlwZWRcIilcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFwiPHRib2R5Lz5cIilcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy4kY292ZXIgPSB0aGlzLiQoXCIudXBsb2FkLXNldHRpbmdzLWNvdmVyXCIpO1xuICAgICAgICB0aGlzLiR0YWJsZSA9IHRoaXMuJChcIi51cGxvYWQtc2V0dGluZ3MtdGFibGUgPiB0Ym9keVwiKTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZVwiLCB0aGlzLnJlbmRlciwgdGhpcyk7XG4gICAgICAgIHRoaXMubW9kZWwudHJpZ2dlcihcImNoYW5nZVwiKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLiR0YWJsZS5lbXB0eSgpO1xuICAgICAgICBfLmVhY2godGhpcy5vcHRpb25zLnBhcmFtZXRlcnMsIHBhcmFtZXRlciA9PiB7XG4gICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhgdXBsb2FkLSR7cGFyYW1ldGVyLmlkfSB1cGxvYWQtaWNvbi1idXR0b24gZmFgKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcygoc2VsZi5tb2RlbC5nZXQocGFyYW1ldGVyLmlkKSAmJiBzZWxmLm9wdGlvbnMuY2xhc3NfY2hlY2spIHx8IHNlbGYub3B0aW9ucy5jbGFzc191bmNoZWNrKVxuICAgICAgICAgICAgICAgIC5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5nZXQoXCJlbmFibGVkXCIpICYmIHNlbGYubW9kZWwuc2V0KHBhcmFtZXRlci5pZCwgIXNlbGYubW9kZWwuZ2V0KHBhcmFtZXRlci5pZCkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi4kdGFibGUuYXBwZW5kKFxuICAgICAgICAgICAgICAgICQoXCI8dHIvPlwiKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoXCI8dGQvPlwiKS5hcHBlbmQoJGNoZWNrYm94KSlcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKFwiPHRkLz5cIikuYXBwZW5kKHBhcmFtZXRlci50aXRsZSkpXG4gICAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4kY292ZXJbKHRoaXMubW9kZWwuZ2V0KFwiZW5hYmxlZFwiKSAmJiBcImhpZGVcIikgfHwgXCJzaG93XCJdKCk7XG4gICAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtc2V0dGluZ3MuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBO0FBQ0E7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQVJBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBakRBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///92\n");

/***/ }),
/* 93 */
/*!*************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-ftp.js ***!
  \*************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        this.model = new Backbone.Model({\n            cls: \"upload-ftp\",\n            class_add: \"upload-icon-button fa fa-square-o\",\n            class_remove: \"upload-icon-button fa fa-check-square-o\",\n            class_partial: \"upload-icon-button fa fa-minus-square-o\",\n            help_enabled: true,\n            help_text: \"This Galaxy server allows you to upload files via FTP. To upload some files, log in to the FTP server at <strong>\" + options.ftp_upload_site + \"</strong> using your Galaxy credentials.\",\n            collection: null,\n            onchange: function onchange() {},\n            onadd: function onadd() {},\n            onremove: function onremove() {}\n        }).set(options);\n        this.collection = this.model.get(\"collection\");\n        this.setElement(this._template());\n        this.$content = this.$(\".upload-ftp-content\");\n        this.$wait = this.$(\".upload-ftp-wait\");\n        this.$help = this.$(\".upload-ftp-help\");\n        this.$number = this.$(\".upload-ftp-number\");\n        this.$disk = this.$(\".upload-ftp-disk\");\n        this.$body = this.$(\".upload-ftp-body\");\n        this.$warning = this.$(\".upload-ftp-warning\");\n        this.$select = this.$(\".upload-ftp-select-all\");\n        this.render();\n    },\n\n    render: function render() {\n        var self = this;\n        this.$wait.show();\n        this.$content.hide();\n        this.$warning.hide();\n        this.$help.hide();\n        $.ajax({\n            url: Galaxy.root + \"api/remote_files\",\n            method: \"GET\",\n            success: function success(ftp_files) {\n                self.model.set(\"ftp_files\", ftp_files);\n                self._index();\n                self._renderTable();\n            },\n            error: function error() {\n                self._renderTable();\n            }\n        });\n    },\n\n    /** Fill table with ftp entries */\n    _renderTable: function _renderTable() {\n        var self = this;\n        var ftp_files = this.model.get(\"ftp_files\");\n        this.rows = [];\n        if (ftp_files && ftp_files.length > 0) {\n            this.$body.empty();\n            var size = 0;\n            _.each(ftp_files, function (ftp_file) {\n                self.rows.push(self._renderRow(ftp_file));\n                size += ftp_file.size;\n            });\n            this.$number.html(ftp_files.length + \" files\");\n            this.$disk.html(_utils2.default.bytesToString(size, true));\n            if (this.collection) {\n                this.$(\"._has_collection\").show();\n                this.$select.addClass(this.model.get(\"class_add\")).off().on(\"click\", function () {\n                    self._all();\n                });\n                this._refresh();\n            }\n            this.$content.show();\n        } else {\n            this.$warning.show();\n        }\n        this.model.get(\"help_enabled\") && this.$help.show();\n        this.$wait.hide();\n    },\n\n    /** Add row */\n    _renderRow: function _renderRow(ftp_file) {\n        var self = this;\n        var options = this.model.attributes;\n        var $it = $(this._templateRow(ftp_file));\n        var $icon = $it.find(\".icon\");\n        this.$body.append($it);\n        if (this.collection) {\n            var model_index = this.ftp_index[ftp_file.path];\n            $icon.addClass(model_index === undefined ? options.class_add : options.class_remove);\n            $it.on(\"click\", function () {\n                self._switch($icon, ftp_file);\n                self._refresh();\n            });\n        } else {\n            $it.on(\"click\", function () {\n                options.onchange(ftp_file);\n            });\n        }\n        return $icon;\n    },\n\n    /** Create ftp index */\n    _index: function _index() {\n        var self = this;\n        this.ftp_index = {};\n        this.collection && this.collection.each(function (model) {\n            if (model.get(\"file_mode\") == \"ftp\") {\n                self.ftp_index[model.get(\"file_path\")] = model.id;\n            }\n        });\n    },\n\n    /** Select all event handler */\n    _all: function _all() {\n        var options = this.model.attributes;\n        var ftp_files = this.model.get(\"ftp_files\");\n        var add = this.$select.hasClass(options.class_add);\n        for (var index in ftp_files) {\n            var ftp_file = ftp_files[index];\n            var model_index = this.ftp_index[ftp_file.path];\n            if (model_index === undefined && add || model_index !== undefined && !add) {\n                this._switch(this.rows[index], ftp_file);\n            }\n        }\n        this._refresh();\n    },\n\n    /** Handle collection changes */\n    _switch: function _switch($icon, ftp_file) {\n        $icon.removeClass();\n        var options = this.model.attributes;\n        var model_index = this.ftp_index[ftp_file.path];\n        if (model_index === undefined) {\n            var new_index = options.onadd(ftp_file);\n            $icon.addClass(options.class_remove);\n            this.ftp_index[ftp_file.path] = new_index;\n        } else {\n            options.onremove(model_index);\n            $icon.addClass(options.class_add);\n            this.ftp_index[ftp_file.path] = undefined;\n        }\n    },\n\n    /** Refresh select all button state */\n    _refresh: function _refresh() {\n        var counts = _.reduce(this.ftp_index, function (memo, element) {\n            element !== undefined && memo++;\n            return memo;\n        }, 0);\n        this.$select.removeClass();\n        if (counts == 0) {\n            this.$select.addClass(this.model.get(\"class_add\"));\n        } else {\n            this.$select.addClass(counts == this.rows.length ? this.model.get(\"class_remove\") : this.model.get(\"class_partial\"));\n        }\n    },\n\n    /** Template of row */\n    _templateRow: function _templateRow(options) {\n        return \"<tr class=\\\"upload-ftp-row\\\"><td class=\\\"_has_collection\\\" style=\\\"display: none;\\\"><div class=\\\"icon\\\"/></td><td class=\\\"ftp-name\\\">\" + _.escape(options.path) + \"</td><td class=\\\"ftp-size\\\">\" + _utils2.default.bytesToString(options.size) + \"</td><td class=\\\"ftp-time\\\">\" + options.ctime + \"</td></tr>\";\n    },\n\n    /** Template of main view */\n    _template: function _template() {\n        return \"<div class=\\\"\" + this.model.get(\"cls\") + \"\\\"><div class=\\\"upload-ftp-wait fa fa-spinner fa-spin\\\"/><div class=\\\"upload-ftp-help\\\">\" + this.model.get(\"help_text\") + \"</div><div class=\\\"upload-ftp-content\\\"><span style=\\\"whitespace: nowrap; float: left;\\\">Available files: </span><span style=\\\"whitespace: nowrap; float: right;\\\"><span class=\\\"upload-icon fa fa-file-text-o\\\"/><span class=\\\"upload-ftp-number\\\"/>&nbsp;&nbsp;<span class=\\\"upload-icon fa fa-hdd-o\\\"/><span class=\\\"upload-ftp-disk\\\"/></span><table class=\\\"grid\\\" style=\\\"float: left;\\\"><thead><tr><th class=\\\"_has_collection\\\" style=\\\"display: none;\\\"><div class=\\\"upload-ftp-select-all\\\"></th><th>Name</th><th>Size</th><th>Created</th></tr></thead><tbody class=\\\"upload-ftp-body\\\"/></table></div><div class=\\\"upload-ftp-warning warningmessage\\\">Your FTP directory does not contain any files.</div>\";\n        \"<div>\";\n    }\n}); /** This renders the content of the ftp popup **/\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtZnRwLmpzP2FhMzkiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIFRoaXMgcmVuZGVycyB0aGUgY29udGVudCBvZiB0aGUgZnRwIHBvcHVwICoqL1xuaW1wb3J0IFV0aWxzIGZyb20gXCJ1dGlscy91dGlsc1wiO1xuZXhwb3J0IGRlZmF1bHQgQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEJhY2tib25lLk1vZGVsKHtcbiAgICAgICAgICAgIGNsczogXCJ1cGxvYWQtZnRwXCIsXG4gICAgICAgICAgICBjbGFzc19hZGQ6IFwidXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLXNxdWFyZS1vXCIsXG4gICAgICAgICAgICBjbGFzc19yZW1vdmU6IFwidXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLWNoZWNrLXNxdWFyZS1vXCIsXG4gICAgICAgICAgICBjbGFzc19wYXJ0aWFsOiBcInVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1taW51cy1zcXVhcmUtb1wiLFxuICAgICAgICAgICAgaGVscF9lbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgaGVscF90ZXh0OiBgVGhpcyBHYWxheHkgc2VydmVyIGFsbG93cyB5b3UgdG8gdXBsb2FkIGZpbGVzIHZpYSBGVFAuIFRvIHVwbG9hZCBzb21lIGZpbGVzLCBsb2cgaW4gdG8gdGhlIEZUUCBzZXJ2ZXIgYXQgPHN0cm9uZz4ke1xuICAgICAgICAgICAgICAgIG9wdGlvbnMuZnRwX3VwbG9hZF9zaXRlXG4gICAgICAgICAgICB9PC9zdHJvbmc+IHVzaW5nIHlvdXIgR2FsYXh5IGNyZWRlbnRpYWxzLmAsXG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBudWxsLFxuICAgICAgICAgICAgb25jaGFuZ2U6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICBvbmFkZDogZnVuY3Rpb24oKSB7fSxcbiAgICAgICAgICAgIG9ucmVtb3ZlOiBmdW5jdGlvbigpIHt9XG4gICAgICAgIH0pLnNldChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUoKSk7XG4gICAgICAgIHRoaXMuJGNvbnRlbnQgPSB0aGlzLiQoXCIudXBsb2FkLWZ0cC1jb250ZW50XCIpO1xuICAgICAgICB0aGlzLiR3YWl0ID0gdGhpcy4kKFwiLnVwbG9hZC1mdHAtd2FpdFwiKTtcbiAgICAgICAgdGhpcy4kaGVscCA9IHRoaXMuJChcIi51cGxvYWQtZnRwLWhlbHBcIik7XG4gICAgICAgIHRoaXMuJG51bWJlciA9IHRoaXMuJChcIi51cGxvYWQtZnRwLW51bWJlclwiKTtcbiAgICAgICAgdGhpcy4kZGlzayA9IHRoaXMuJChcIi51cGxvYWQtZnRwLWRpc2tcIik7XG4gICAgICAgIHRoaXMuJGJvZHkgPSB0aGlzLiQoXCIudXBsb2FkLWZ0cC1ib2R5XCIpO1xuICAgICAgICB0aGlzLiR3YXJuaW5nID0gdGhpcy4kKFwiLnVwbG9hZC1mdHAtd2FybmluZ1wiKTtcbiAgICAgICAgdGhpcy4kc2VsZWN0ID0gdGhpcy4kKFwiLnVwbG9hZC1mdHAtc2VsZWN0LWFsbFwiKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLiR3YWl0LnNob3coKTtcbiAgICAgICAgdGhpcy4kY29udGVudC5oaWRlKCk7XG4gICAgICAgIHRoaXMuJHdhcm5pbmcuaGlkZSgpO1xuICAgICAgICB0aGlzLiRoZWxwLmhpZGUoKTtcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3R9YXBpL3JlbW90ZV9maWxlc2AsXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihmdHBfZmlsZXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vZGVsLnNldChcImZ0cF9maWxlc1wiLCBmdHBfZmlsZXMpO1xuICAgICAgICAgICAgICAgIHNlbGYuX2luZGV4KCk7XG4gICAgICAgICAgICAgICAgc2VsZi5fcmVuZGVyVGFibGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fcmVuZGVyVGFibGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBGaWxsIHRhYmxlIHdpdGggZnRwIGVudHJpZXMgKi9cbiAgICBfcmVuZGVyVGFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBmdHBfZmlsZXMgPSB0aGlzLm1vZGVsLmdldChcImZ0cF9maWxlc1wiKTtcbiAgICAgICAgdGhpcy5yb3dzID0gW107XG4gICAgICAgIGlmIChmdHBfZmlsZXMgJiYgZnRwX2ZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuJGJvZHkuZW1wdHkoKTtcbiAgICAgICAgICAgIHZhciBzaXplID0gMDtcbiAgICAgICAgICAgIF8uZWFjaChmdHBfZmlsZXMsIGZ0cF9maWxlID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLnJvd3MucHVzaChzZWxmLl9yZW5kZXJSb3coZnRwX2ZpbGUpKTtcbiAgICAgICAgICAgICAgICBzaXplICs9IGZ0cF9maWxlLnNpemU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuJG51bWJlci5odG1sKGAke2Z0cF9maWxlcy5sZW5ndGh9IGZpbGVzYCk7XG4gICAgICAgICAgICB0aGlzLiRkaXNrLmh0bWwoVXRpbHMuYnl0ZXNUb1N0cmluZyhzaXplLCB0cnVlKSk7XG4gICAgICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kKFwiLl9oYXNfY29sbGVjdGlvblwiKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgdGhpcy4kc2VsZWN0XG4gICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyh0aGlzLm1vZGVsLmdldChcImNsYXNzX2FkZFwiKSlcbiAgICAgICAgICAgICAgICAgICAgLm9mZigpXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FsbCgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLiRjb250ZW50LnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJHdhcm5pbmcuc2hvdygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubW9kZWwuZ2V0KFwiaGVscF9lbmFibGVkXCIpICYmIHRoaXMuJGhlbHAuc2hvdygpO1xuICAgICAgICB0aGlzLiR3YWl0LmhpZGUoKTtcbiAgICB9LFxuXG4gICAgLyoqIEFkZCByb3cgKi9cbiAgICBfcmVuZGVyUm93OiBmdW5jdGlvbihmdHBfZmlsZSkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5tb2RlbC5hdHRyaWJ1dGVzO1xuICAgICAgICB2YXIgJGl0ID0gJCh0aGlzLl90ZW1wbGF0ZVJvdyhmdHBfZmlsZSkpO1xuICAgICAgICB2YXIgJGljb24gPSAkaXQuZmluZChcIi5pY29uXCIpO1xuICAgICAgICB0aGlzLiRib2R5LmFwcGVuZCgkaXQpO1xuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWxfaW5kZXggPSB0aGlzLmZ0cF9pbmRleFtmdHBfZmlsZS5wYXRoXTtcbiAgICAgICAgICAgICRpY29uLmFkZENsYXNzKG1vZGVsX2luZGV4ID09PSB1bmRlZmluZWQgPyBvcHRpb25zLmNsYXNzX2FkZCA6IG9wdGlvbnMuY2xhc3NfcmVtb3ZlKTtcbiAgICAgICAgICAgICRpdC5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLl9zd2l0Y2goJGljb24sIGZ0cF9maWxlKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9yZWZyZXNoKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRpdC5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm9uY2hhbmdlKGZ0cF9maWxlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkaWNvbjtcbiAgICB9LFxuXG4gICAgLyoqIENyZWF0ZSBmdHAgaW5kZXggKi9cbiAgICBfaW5kZXg6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZnRwX2luZGV4ID0ge307XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbiAmJlxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5nZXQoXCJmaWxlX21vZGVcIikgPT0gXCJmdHBcIikge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmZ0cF9pbmRleFttb2RlbC5nZXQoXCJmaWxlX3BhdGhcIildID0gbW9kZWwuaWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBTZWxlY3QgYWxsIGV2ZW50IGhhbmRsZXIgKi9cbiAgICBfYWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm1vZGVsLmF0dHJpYnV0ZXM7XG4gICAgICAgIHZhciBmdHBfZmlsZXMgPSB0aGlzLm1vZGVsLmdldChcImZ0cF9maWxlc1wiKTtcbiAgICAgICAgdmFyIGFkZCA9IHRoaXMuJHNlbGVjdC5oYXNDbGFzcyhvcHRpb25zLmNsYXNzX2FkZCk7XG4gICAgICAgIGZvciAodmFyIGluZGV4IGluIGZ0cF9maWxlcykge1xuICAgICAgICAgICAgdmFyIGZ0cF9maWxlID0gZnRwX2ZpbGVzW2luZGV4XTtcbiAgICAgICAgICAgIHZhciBtb2RlbF9pbmRleCA9IHRoaXMuZnRwX2luZGV4W2Z0cF9maWxlLnBhdGhdO1xuICAgICAgICAgICAgaWYgKChtb2RlbF9pbmRleCA9PT0gdW5kZWZpbmVkICYmIGFkZCkgfHwgKG1vZGVsX2luZGV4ICE9PSB1bmRlZmluZWQgJiYgIWFkZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zd2l0Y2godGhpcy5yb3dzW2luZGV4XSwgZnRwX2ZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlZnJlc2goKTtcbiAgICB9LFxuXG4gICAgLyoqIEhhbmRsZSBjb2xsZWN0aW9uIGNoYW5nZXMgKi9cbiAgICBfc3dpdGNoOiBmdW5jdGlvbigkaWNvbiwgZnRwX2ZpbGUpIHtcbiAgICAgICAgJGljb24ucmVtb3ZlQ2xhc3MoKTtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm1vZGVsLmF0dHJpYnV0ZXM7XG4gICAgICAgIHZhciBtb2RlbF9pbmRleCA9IHRoaXMuZnRwX2luZGV4W2Z0cF9maWxlLnBhdGhdO1xuICAgICAgICBpZiAobW9kZWxfaW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIG5ld19pbmRleCA9IG9wdGlvbnMub25hZGQoZnRwX2ZpbGUpO1xuICAgICAgICAgICAgJGljb24uYWRkQ2xhc3Mob3B0aW9ucy5jbGFzc19yZW1vdmUpO1xuICAgICAgICAgICAgdGhpcy5mdHBfaW5kZXhbZnRwX2ZpbGUucGF0aF0gPSBuZXdfaW5kZXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zLm9ucmVtb3ZlKG1vZGVsX2luZGV4KTtcbiAgICAgICAgICAgICRpY29uLmFkZENsYXNzKG9wdGlvbnMuY2xhc3NfYWRkKTtcbiAgICAgICAgICAgIHRoaXMuZnRwX2luZGV4W2Z0cF9maWxlLnBhdGhdID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIHNlbGVjdCBhbGwgYnV0dG9uIHN0YXRlICovXG4gICAgX3JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgY291bnRzID0gXy5yZWR1Y2UoXG4gICAgICAgICAgICB0aGlzLmZ0cF9pbmRleCxcbiAgICAgICAgICAgIChtZW1vLCBlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCAhPT0gdW5kZWZpbmVkICYmIG1lbW8rKztcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAwXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuJHNlbGVjdC5yZW1vdmVDbGFzcygpO1xuICAgICAgICBpZiAoY291bnRzID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuJHNlbGVjdC5hZGRDbGFzcyh0aGlzLm1vZGVsLmdldChcImNsYXNzX2FkZFwiKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiRzZWxlY3QuYWRkQ2xhc3MoXG4gICAgICAgICAgICAgICAgY291bnRzID09IHRoaXMucm93cy5sZW5ndGggPyB0aGlzLm1vZGVsLmdldChcImNsYXNzX3JlbW92ZVwiKSA6IHRoaXMubW9kZWwuZ2V0KFwiY2xhc3NfcGFydGlhbFwiKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgb2Ygcm93ICovXG4gICAgX3RlbXBsYXRlUm93OiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBgPHRyIGNsYXNzPVwidXBsb2FkLWZ0cC1yb3dcIj48dGQgY2xhc3M9XCJfaGFzX2NvbGxlY3Rpb25cIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+PGRpdiBjbGFzcz1cImljb25cIi8+PC90ZD48dGQgY2xhc3M9XCJmdHAtbmFtZVwiPiR7Xy5lc2NhcGUoXG4gICAgICAgICAgICBvcHRpb25zLnBhdGhcbiAgICAgICAgKX08L3RkPjx0ZCBjbGFzcz1cImZ0cC1zaXplXCI+JHtVdGlscy5ieXRlc1RvU3RyaW5nKG9wdGlvbnMuc2l6ZSl9PC90ZD48dGQgY2xhc3M9XCJmdHAtdGltZVwiPiR7XG4gICAgICAgICAgICBvcHRpb25zLmN0aW1lXG4gICAgICAgIH08L3RkPjwvdHI+YDtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlIG9mIG1haW4gdmlldyAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBgPGRpdiBjbGFzcz1cIiR7dGhpcy5tb2RlbC5nZXQoXG4gICAgICAgICAgICBcImNsc1wiXG4gICAgICAgICl9XCI+PGRpdiBjbGFzcz1cInVwbG9hZC1mdHAtd2FpdCBmYSBmYS1zcGlubmVyIGZhLXNwaW5cIi8+PGRpdiBjbGFzcz1cInVwbG9hZC1mdHAtaGVscFwiPiR7dGhpcy5tb2RlbC5nZXQoXG4gICAgICAgICAgICBcImhlbHBfdGV4dFwiXG4gICAgICAgICl9PC9kaXY+PGRpdiBjbGFzcz1cInVwbG9hZC1mdHAtY29udGVudFwiPjxzcGFuIHN0eWxlPVwid2hpdGVzcGFjZTogbm93cmFwOyBmbG9hdDogbGVmdDtcIj5BdmFpbGFibGUgZmlsZXM6IDwvc3Bhbj48c3BhbiBzdHlsZT1cIndoaXRlc3BhY2U6IG5vd3JhcDsgZmxvYXQ6IHJpZ2h0O1wiPjxzcGFuIGNsYXNzPVwidXBsb2FkLWljb24gZmEgZmEtZmlsZS10ZXh0LW9cIi8+PHNwYW4gY2xhc3M9XCJ1cGxvYWQtZnRwLW51bWJlclwiLz4mbmJzcDsmbmJzcDs8c3BhbiBjbGFzcz1cInVwbG9hZC1pY29uIGZhIGZhLWhkZC1vXCIvPjxzcGFuIGNsYXNzPVwidXBsb2FkLWZ0cC1kaXNrXCIvPjwvc3Bhbj48dGFibGUgY2xhc3M9XCJncmlkXCIgc3R5bGU9XCJmbG9hdDogbGVmdDtcIj48dGhlYWQ+PHRyPjx0aCBjbGFzcz1cIl9oYXNfY29sbGVjdGlvblwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj48ZGl2IGNsYXNzPVwidXBsb2FkLWZ0cC1zZWxlY3QtYWxsXCI+PC90aD48dGg+TmFtZTwvdGg+PHRoPlNpemU8L3RoPjx0aD5DcmVhdGVkPC90aD48L3RyPjwvdGhlYWQ+PHRib2R5IGNsYXNzPVwidXBsb2FkLWZ0cC1ib2R5XCIvPjwvdGFibGU+PC9kaXY+PGRpdiBjbGFzcz1cInVwbG9hZC1mdHAtd2FybmluZyB3YXJuaW5nbWVzc2FnZVwiPllvdXIgRlRQIGRpcmVjdG9yeSBkb2VzIG5vdCBjb250YWluIGFueSBmaWxlcy48L2Rpdj5gO1xuICAgICAgICAoXCI8ZGl2PlwiKTtcbiAgICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdXBsb2FkL3VwbG9hZC1mdHAuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBO0FBQ0E7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBY0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBeExBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///93\n");

/***/ }),
/* 94 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-extension.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** This renders a popover with extension details **/\nexports.default = Backbone.View.extend({\n    initialize: function initialize(options) {\n        this.model = new Backbone.Model(options);\n        this.setElement(\"<div/>\");\n        this.render();\n    },\n\n    render: function render() {\n        var self = this;\n        var options = this.model.attributes;\n        var description = _.findWhere(options.list, {\n            id: options.extension\n        });\n        this.extension_popup && this.extension_popup.remove();\n        this.extension_popup = new _uiPopover2.default.View({\n            placement: options.placement || \"bottom\",\n            container: options.$el\n        });\n        this.extension_popup.title(options.title);\n        this.extension_popup.empty();\n        this.extension_popup.append(this._templateDescription(description));\n        this.extension_popup.show();\n    },\n\n    /** Template for extensions description */\n    _templateDescription: function _templateDescription(options) {\n        if (options.description) {\n            var tmpl = options.description;\n            if (options.description_url) {\n                tmpl += \"&nbsp;(<a href=\\\"\" + options.description_url + \"\\\" target=\\\"_blank\\\">read more</a>)\";\n            }\n            return tmpl;\n        } else {\n            return \"There is no description available for this file extension.\";\n        }\n    }\n});\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtZXh0ZW5zaW9uLmpzPzdjZmIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIFRoaXMgcmVuZGVycyBhIHBvcG92ZXIgd2l0aCBleHRlbnNpb24gZGV0YWlscyAqKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBQb3BvdmVyIGZyb20gXCJtdmMvdWkvdWktcG9wb3ZlclwiO1xuZXhwb3J0IGRlZmF1bHQgQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG5ldyBCYWNrYm9uZS5Nb2RlbChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KFwiPGRpdi8+XCIpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5tb2RlbC5hdHRyaWJ1dGVzO1xuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBfLmZpbmRXaGVyZShvcHRpb25zLmxpc3QsIHtcbiAgICAgICAgICAgIGlkOiBvcHRpb25zLmV4dGVuc2lvblxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25fcG9wdXAgJiYgdGhpcy5leHRlbnNpb25fcG9wdXAucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuZXh0ZW5zaW9uX3BvcHVwID0gbmV3IFBvcG92ZXIuVmlldyh7XG4gICAgICAgICAgICBwbGFjZW1lbnQ6IG9wdGlvbnMucGxhY2VtZW50IHx8IFwiYm90dG9tXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IG9wdGlvbnMuJGVsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmV4dGVuc2lvbl9wb3B1cC50aXRsZShvcHRpb25zLnRpdGxlKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25fcG9wdXAuZW1wdHkoKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25fcG9wdXAuYXBwZW5kKHRoaXMuX3RlbXBsYXRlRGVzY3JpcHRpb24oZGVzY3JpcHRpb24pKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb25fcG9wdXAuc2hvdygpO1xuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgZm9yIGV4dGVuc2lvbnMgZGVzY3JpcHRpb24gKi9cbiAgICBfdGVtcGxhdGVEZXNjcmlwdGlvbjogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucy5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgdmFyIHRtcGwgPSBvcHRpb25zLmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGVzY3JpcHRpb25fdXJsKSB7XG4gICAgICAgICAgICAgICAgdG1wbCArPSBgJm5ic3A7KDxhIGhyZWY9XCIke29wdGlvbnMuZGVzY3JpcHRpb25fdXJsfVwiIHRhcmdldD1cIl9ibGFua1wiPnJlYWQgbW9yZTwvYT4pYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0bXBsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFwiVGhlcmUgaXMgbm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlIGZvciB0aGlzIGZpbGUgZXh0ZW5zaW9uLlwiO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC91cGxvYWQtZXh0ZW5zaW9uLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUhBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkNBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///94\n");

/***/ }),
/* 95 */
/*!*******************************************!*\
  !*** ./galaxy/scripts/utils/uploadbox.js ***!
  \*******************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery, _) {\n\n/*\n    galaxy upload plugins - requires FormData and XMLHttpRequest\n*/\n(function ($) {\n    // add event properties\n    jQuery.event.props.push(\"dataTransfer\");\n\n    /**\n        Posts file data to the API\n    */\n    $.uploadpost = function (config) {\n        // parse options\n        var cnf = $.extend({}, {\n            data: {},\n            success: function success() {},\n            error: function error() {},\n            progress: function progress() {},\n            url: null,\n            maxfilesize: 2048,\n            error_filesize: \"File exceeds 2GB. Please use a FTP client.\",\n            error_default: \"Please make sure the file is available.\",\n            error_server: \"Upload request failed.\",\n            error_login: \"Uploads require you to log in.\"\n        }, config);\n\n        // link data\n        var data = cnf.data;\n\n        // check errors\n        if (data.error_message) {\n            cnf.error(data.error_message);\n            return;\n        }\n\n        // construct form data\n        var form = new FormData();\n        for (var key in data.payload) {\n            form.append(key, data.payload[key]);\n        }\n\n        // add files to submission\n        var sizes = 0;\n        for (var key in data.files) {\n            var d = data.files[key];\n            form.append(d.name, d.file, d.file.name);\n            sizes += d.file.size;\n        }\n\n        // check file size, unless it's an ftp file\n        if (sizes > 1048576 * cnf.maxfilesize) {\n            cnf.error(cnf.error_filesize);\n            return;\n        }\n\n        // prepare request\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", cnf.url, true);\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n        xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n        xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n        // captures state changes\n        xhr.onreadystatechange = function () {\n            // check for request completed, server connection closed\n            if (xhr.readyState == xhr.DONE) {\n                // parse response\n                var response = null;\n                var extra_info = \"\";\n                if (xhr.responseText) {\n                    try {\n                        response = jQuery.parseJSON(xhr.responseText);\n                        extra_info = response.err_msg;\n                    } catch (e) {\n                        response = xhr.responseText;\n                        extra_info = response;\n                    }\n                }\n                // pass any error to the error option\n                if (xhr.status < 200 || xhr.status > 299) {\n                    var text = xhr.statusText;\n                    if (xhr.status == 403) {\n                        text = cnf.error_login;\n                    } else if (xhr.status == 0) {\n                        text = cnf.error_server;\n                    } else if (!text) {\n                        text = cnf.error_default;\n                    }\n                    cnf.error(text + \" (\" + xhr.status + \"). \" + extra_info);\n                } else {\n                    cnf.success(response);\n                }\n            }\n        };\n\n        // prepare upload progress\n        xhr.upload.addEventListener(\"progress\", function (e) {\n            if (e.lengthComputable) {\n                cnf.progress(Math.round(e.loaded * 100 / e.total));\n            }\n        }, false);\n\n        // send request\n        Galaxy.emit.debug(\"uploadbox::uploadpost()\", \"Posting following data.\", cnf);\n        xhr.send(form);\n    };\n\n    /**\n        Handles the upload events drag/drop etc.\n    */\n    $.fn.uploadinput = function (options) {\n        // initialize\n        var el = this;\n        var opts = $.extend({}, {\n            ondragover: function ondragover() {},\n            ondragleave: function ondragleave() {},\n            onchange: function onchange() {},\n            multiple: false\n        }, options);\n\n        // append hidden upload field\n        var $input = $(\"<input type=\\\"file\\\" style=\\\"display: none\\\" \" + (opts.multiple && \"multiple\" || \"\") + \"/>\");\n        el.append($input.change(function (e) {\n            opts.onchange(e.target.files);\n            $(this).val(\"\");\n        }));\n\n        // drag/drop events\n        el.on(\"drop\", function (e) {\n            opts.ondragleave(e);\n            if (e.dataTransfer) {\n                opts.onchange(e.dataTransfer.files);\n                e.preventDefault();\n            }\n        });\n        el.on(\"dragover\", function (e) {\n            e.preventDefault();\n            opts.ondragover(e);\n        });\n        el.on(\"dragleave\", function (e) {\n            e.stopPropagation();\n            opts.ondragleave(e);\n        });\n\n        // exports\n        return {\n            dialog: function dialog() {\n                $input.trigger(\"click\");\n            }\n        };\n    };\n\n    /**\n        Handles the upload queue and events such as drag/drop etc.\n    */\n    $.fn.uploadbox = function (options) {\n        // parse options\n        var opts = $.extend({}, {\n            dragover: function dragover() {},\n            dragleave: function dragleave() {},\n            announce: function announce(d) {},\n            initialize: function initialize(d) {},\n            progress: function progress(d, m) {},\n            success: function success(d, m) {},\n            error: function error(d, m) {\n                alert(m);\n            },\n            complete: function complete() {}\n        }, options);\n\n        // file queue\n        var queue = {};\n\n        // queue index/length counter\n        var queue_index = 0;\n        var queue_length = 0;\n\n        // indicates if queue is currently running\n        var queue_running = false;\n        var queue_stop = false;\n\n        // element\n        var uploadinput = $(this).uploadinput({\n            multiple: true,\n            onchange: function onchange(files) {\n                add(files);\n            },\n            ondragover: options.ondragover,\n            ondragleave: options.ondragleave\n        });\n\n        // add new files to upload queue\n        function add(files) {\n            if (files && files.length && !queue_running) {\n                var index = undefined;\n                _.each(files, function (file, key) {\n                    if (file.mode !== \"new\" && _.filter(queue, function (f) {\n                        return f.name === file.name && f.size === file.size;\n                    }).length) {\n                        file.duplicate = true;\n                    }\n                });\n                _.each(files, function (file) {\n                    if (!file.duplicate) {\n                        index = String(queue_index++);\n                        queue[index] = file;\n                        opts.announce(index, queue[index]);\n                        queue_length++;\n                    }\n                });\n                return index;\n            }\n        }\n\n        // remove file from queue\n        function remove(index) {\n            if (queue[index]) {\n                delete queue[index];\n                queue_length--;\n            }\n        }\n\n        // process an upload, recursive\n        function process() {\n            // validate\n            if (queue_length == 0 || queue_stop) {\n                queue_stop = false;\n                queue_running = false;\n                opts.complete();\n                return;\n            } else {\n                queue_running = true;\n            }\n\n            // get an identifier from the queue\n            var index = -1;\n            for (var key in queue) {\n                index = key;\n                break;\n            }\n\n            // get current file from queue\n            var file = queue[index];\n\n            // remove from queue\n            remove(index);\n\n            // create and submit data\n            $.uploadpost({\n                url: opts.url,\n                data: opts.initialize(index),\n                success: function success(message) {\n                    opts.success(index, message);\n                    process();\n                },\n                error: function error(message) {\n                    opts.error(index, message);\n                    process();\n                },\n                progress: function progress(percentage) {\n                    opts.progress(index, percentage);\n                }\n            });\n        }\n\n        /*\n            public interface\n        */\n\n        // open file browser for selection\n        function select() {\n            uploadinput.dialog();\n        }\n\n        // remove all entries from queue\n        function reset(index) {\n            for (index in queue) {\n                remove(index);\n            }\n        }\n\n        // initiate upload process\n        function start() {\n            if (!queue_running) {\n                queue_running = true;\n                process();\n            }\n        }\n\n        // stop upload process\n        function stop() {\n            queue_stop = true;\n        }\n\n        // set options\n        function configure(options) {\n            opts = $.extend({}, opts, options);\n            return opts;\n        }\n\n        // verify browser compatibility\n        function compatible() {\n            return window.File && window.FormData && window.XMLHttpRequest && window.FileList;\n        }\n\n        // export functions\n        return {\n            select: select,\n            add: add,\n            remove: remove,\n            start: start,\n            stop: stop,\n            reset: reset,\n            configure: configure,\n            compatible: compatible\n        };\n    };\n})(jQuery);\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvdXRpbHMvdXBsb2FkYm94LmpzPzUyZDgiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAgICBnYWxheHkgdXBsb2FkIHBsdWdpbnMgLSByZXF1aXJlcyBGb3JtRGF0YSBhbmQgWE1MSHR0cFJlcXVlc3RcbiovXG4oJCA9PiB7XG4gICAgLy8gYWRkIGV2ZW50IHByb3BlcnRpZXNcbiAgICBqUXVlcnkuZXZlbnQucHJvcHMucHVzaChcImRhdGFUcmFuc2ZlclwiKTtcblxuICAgIC8qKlxuICAgICAgICBQb3N0cyBmaWxlIGRhdGEgdG8gdGhlIEFQSVxuICAgICovXG4gICAgJC51cGxvYWRwb3N0ID0gY29uZmlnID0+IHtcbiAgICAgICAgLy8gcGFyc2Ugb3B0aW9uc1xuICAgICAgICB2YXIgY25mID0gJC5leHRlbmQoXG4gICAgICAgICAgICB7fSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7fSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIHByb2dyZXNzOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIHVybDogbnVsbCxcbiAgICAgICAgICAgICAgICBtYXhmaWxlc2l6ZTogMjA0OCxcbiAgICAgICAgICAgICAgICBlcnJvcl9maWxlc2l6ZTogXCJGaWxlIGV4Y2VlZHMgMkdCLiBQbGVhc2UgdXNlIGEgRlRQIGNsaWVudC5cIixcbiAgICAgICAgICAgICAgICBlcnJvcl9kZWZhdWx0OiBcIlBsZWFzZSBtYWtlIHN1cmUgdGhlIGZpbGUgaXMgYXZhaWxhYmxlLlwiLFxuICAgICAgICAgICAgICAgIGVycm9yX3NlcnZlcjogXCJVcGxvYWQgcmVxdWVzdCBmYWlsZWQuXCIsXG4gICAgICAgICAgICAgICAgZXJyb3JfbG9naW46IFwiVXBsb2FkcyByZXF1aXJlIHlvdSB0byBsb2cgaW4uXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb25maWdcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBsaW5rIGRhdGFcbiAgICAgICAgdmFyIGRhdGEgPSBjbmYuZGF0YTtcblxuICAgICAgICAvLyBjaGVjayBlcnJvcnNcbiAgICAgICAgaWYgKGRhdGEuZXJyb3JfbWVzc2FnZSkge1xuICAgICAgICAgICAgY25mLmVycm9yKGRhdGEuZXJyb3JfbWVzc2FnZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjb25zdHJ1Y3QgZm9ybSBkYXRhXG4gICAgICAgIHZhciBmb3JtID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhLnBheWxvYWQpIHtcbiAgICAgICAgICAgIGZvcm0uYXBwZW5kKGtleSwgZGF0YS5wYXlsb2FkW2tleV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIGZpbGVzIHRvIHN1Ym1pc3Npb25cbiAgICAgICAgdmFyIHNpemVzID0gMDtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEuZmlsZXMpIHtcbiAgICAgICAgICAgIHZhciBkID0gZGF0YS5maWxlc1trZXldO1xuICAgICAgICAgICAgZm9ybS5hcHBlbmQoZC5uYW1lLCBkLmZpbGUsIGQuZmlsZS5uYW1lKTtcbiAgICAgICAgICAgIHNpemVzICs9IGQuZmlsZS5zaXplO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgZmlsZSBzaXplLCB1bmxlc3MgaXQncyBhbiBmdHAgZmlsZVxuICAgICAgICBpZiAoc2l6ZXMgPiAxMDQ4NTc2ICogY25mLm1heGZpbGVzaXplKSB7XG4gICAgICAgICAgICBjbmYuZXJyb3IoY25mLmVycm9yX2ZpbGVzaXplKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByZXBhcmUgcmVxdWVzdFxuICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci5vcGVuKFwiUE9TVFwiLCBjbmYudXJsLCB0cnVlKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkNhY2hlLUNvbnRyb2xcIiwgXCJuby1jYWNoZVwiKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XG5cbiAgICAgICAgLy8gY2FwdHVyZXMgc3RhdGUgY2hhbmdlc1xuICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gY2hlY2sgZm9yIHJlcXVlc3QgY29tcGxldGVkLCBzZXJ2ZXIgY29ubmVjdGlvbiBjbG9zZWRcbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PSB4aHIuRE9ORSkge1xuICAgICAgICAgICAgICAgIC8vIHBhcnNlIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgZXh0cmFfaW5mbyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0galF1ZXJ5LnBhcnNlSlNPTih4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhX2luZm8gPSByZXNwb25zZS5lcnJfbXNnO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHRyYV9pbmZvID0gcmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gcGFzcyBhbnkgZXJyb3IgdG8gdGhlIGVycm9yIG9wdGlvblxuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzIDwgMjAwIHx8IHhoci5zdGF0dXMgPiAyOTkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSB4aHIuc3RhdHVzVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT0gNDAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gY25mLmVycm9yX2xvZ2luO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHhoci5zdGF0dXMgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IGNuZi5lcnJvcl9zZXJ2ZXI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBjbmYuZXJyb3JfZGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjbmYuZXJyb3IoYCR7dGV4dH0gKCR7eGhyLnN0YXR1c30pLiAke2V4dHJhX2luZm99YCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY25mLnN1Y2Nlc3MocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBwcmVwYXJlIHVwbG9hZCBwcm9ncmVzc1xuICAgICAgICB4aHIudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICBcInByb2dyZXNzXCIsXG4gICAgICAgICAgICBlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZS5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNuZi5wcm9ncmVzcyhNYXRoLnJvdW5kKGUubG9hZGVkICogMTAwIC8gZS50b3RhbCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIHNlbmQgcmVxdWVzdFxuICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInVwbG9hZGJveDo6dXBsb2FkcG9zdCgpXCIsIFwiUG9zdGluZyBmb2xsb3dpbmcgZGF0YS5cIiwgY25mKTtcbiAgICAgICAgeGhyLnNlbmQoZm9ybSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAgICBIYW5kbGVzIHRoZSB1cGxvYWQgZXZlbnRzIGRyYWcvZHJvcCBldGMuXG4gICAgKi9cbiAgICAkLmZuLnVwbG9hZGlucHV0ID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICAvLyBpbml0aWFsaXplXG4gICAgICAgIHZhciBlbCA9IHRoaXM7XG4gICAgICAgIHZhciBvcHRzID0gJC5leHRlbmQoXG4gICAgICAgICAgICB7fSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBvbmRyYWdvdmVyOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIG9uZHJhZ2xlYXZlOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIG11bHRpcGxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBhcHBlbmQgaGlkZGVuIHVwbG9hZCBmaWVsZFxuICAgICAgICB2YXIgJGlucHV0ID0gJChgPGlucHV0IHR5cGU9XCJmaWxlXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lXCIgJHsob3B0cy5tdWx0aXBsZSAmJiBcIm11bHRpcGxlXCIpIHx8IFwiXCJ9Lz5gKTtcbiAgICAgICAgZWwuYXBwZW5kKFxuICAgICAgICAgICAgJGlucHV0LmNoYW5nZShmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgb3B0cy5vbmNoYW5nZShlLnRhcmdldC5maWxlcyk7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS52YWwoXCJcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIGRyYWcvZHJvcCBldmVudHNcbiAgICAgICAgZWwub24oXCJkcm9wXCIsIGUgPT4ge1xuICAgICAgICAgICAgb3B0cy5vbmRyYWdsZWF2ZShlKTtcbiAgICAgICAgICAgIGlmIChlLmRhdGFUcmFuc2Zlcikge1xuICAgICAgICAgICAgICAgIG9wdHMub25jaGFuZ2UoZS5kYXRhVHJhbnNmZXIuZmlsZXMpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGVsLm9uKFwiZHJhZ292ZXJcIiwgZSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBvcHRzLm9uZHJhZ292ZXIoZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBlbC5vbihcImRyYWdsZWF2ZVwiLCBlID0+IHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBvcHRzLm9uZHJhZ2xlYXZlKGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBleHBvcnRzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkaWFsb2c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRpbnB1dC50cmlnZ2VyKFwiY2xpY2tcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAgICBIYW5kbGVzIHRoZSB1cGxvYWQgcXVldWUgYW5kIGV2ZW50cyBzdWNoIGFzIGRyYWcvZHJvcCBldGMuXG4gICAgKi9cbiAgICAkLmZuLnVwbG9hZGJveCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgLy8gcGFyc2Ugb3B0aW9uc1xuICAgICAgICB2YXIgb3B0cyA9ICQuZXh0ZW5kKFxuICAgICAgICAgICAge30sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZHJhZ292ZXI6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICAgICAgZHJhZ2xlYXZlOiBmdW5jdGlvbigpIHt9LFxuICAgICAgICAgICAgICAgIGFubm91bmNlOiBmdW5jdGlvbihkKSB7fSxcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihkKSB7fSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogZnVuY3Rpb24oZCwgbSkge30sXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZCwgbSkge30sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGQsIG0pIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQobSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7fVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9wdGlvbnNcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBmaWxlIHF1ZXVlXG4gICAgICAgIHZhciBxdWV1ZSA9IHt9O1xuXG4gICAgICAgIC8vIHF1ZXVlIGluZGV4L2xlbmd0aCBjb3VudGVyXG4gICAgICAgIHZhciBxdWV1ZV9pbmRleCA9IDA7XG4gICAgICAgIHZhciBxdWV1ZV9sZW5ndGggPSAwO1xuXG4gICAgICAgIC8vIGluZGljYXRlcyBpZiBxdWV1ZSBpcyBjdXJyZW50bHkgcnVubmluZ1xuICAgICAgICB2YXIgcXVldWVfcnVubmluZyA9IGZhbHNlO1xuICAgICAgICB2YXIgcXVldWVfc3RvcCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIGVsZW1lbnRcbiAgICAgICAgdmFyIHVwbG9hZGlucHV0ID0gJCh0aGlzKS51cGxvYWRpbnB1dCh7XG4gICAgICAgICAgICBtdWx0aXBsZTogdHJ1ZSxcbiAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbihmaWxlcykge1xuICAgICAgICAgICAgICAgIGFkZChmaWxlcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25kcmFnb3Zlcjogb3B0aW9ucy5vbmRyYWdvdmVyLFxuICAgICAgICAgICAgb25kcmFnbGVhdmU6IG9wdGlvbnMub25kcmFnbGVhdmVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gYWRkIG5ldyBmaWxlcyB0byB1cGxvYWQgcXVldWVcbiAgICAgICAgZnVuY3Rpb24gYWRkKGZpbGVzKSB7XG4gICAgICAgICAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoICYmICFxdWV1ZV9ydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIF8uZWFjaChmaWxlcywgKGZpbGUsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLm1vZGUgIT09IFwibmV3XCIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZmlsdGVyKHF1ZXVlLCBmID0+IGYubmFtZSA9PT0gZmlsZS5uYW1lICYmIGYuc2l6ZSA9PT0gZmlsZS5zaXplKS5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmR1cGxpY2F0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfLmVhY2goZmlsZXMsIGZpbGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbGUuZHVwbGljYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IFN0cmluZyhxdWV1ZV9pbmRleCsrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlW2luZGV4XSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRzLmFubm91bmNlKGluZGV4LCBxdWV1ZVtpbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWVfbGVuZ3RoKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZW1vdmUgZmlsZSBmcm9tIHF1ZXVlXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZShpbmRleCkge1xuICAgICAgICAgICAgaWYgKHF1ZXVlW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBxdWV1ZVtpbmRleF07XG4gICAgICAgICAgICAgICAgcXVldWVfbGVuZ3RoLS07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm9jZXNzIGFuIHVwbG9hZCwgcmVjdXJzaXZlXG4gICAgICAgIGZ1bmN0aW9uIHByb2Nlc3MoKSB7XG4gICAgICAgICAgICAvLyB2YWxpZGF0ZVxuICAgICAgICAgICAgaWYgKHF1ZXVlX2xlbmd0aCA9PSAwIHx8IHF1ZXVlX3N0b3ApIHtcbiAgICAgICAgICAgICAgICBxdWV1ZV9zdG9wID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcXVldWVfcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIG9wdHMuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHF1ZXVlX3J1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBnZXQgYW4gaWRlbnRpZmllciBmcm9tIHRoZSBxdWV1ZVxuICAgICAgICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcXVldWUpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGtleTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgZmlsZSBmcm9tIHF1ZXVlXG4gICAgICAgICAgICB2YXIgZmlsZSA9IHF1ZXVlW2luZGV4XTtcblxuICAgICAgICAgICAgLy8gcmVtb3ZlIGZyb20gcXVldWVcbiAgICAgICAgICAgIHJlbW92ZShpbmRleCk7XG5cbiAgICAgICAgICAgIC8vIGNyZWF0ZSBhbmQgc3VibWl0IGRhdGFcbiAgICAgICAgICAgICQudXBsb2FkcG9zdCh7XG4gICAgICAgICAgICAgICAgdXJsOiBvcHRzLnVybCxcbiAgICAgICAgICAgICAgICBkYXRhOiBvcHRzLmluaXRpYWxpemUoaW5kZXgpLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5zdWNjZXNzKGluZGV4LCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgcHJvY2VzcygpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5lcnJvcihpbmRleCwgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHByb2dyZXNzOiBmdW5jdGlvbihwZXJjZW50YWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMucHJvZ3Jlc3MoaW5kZXgsIHBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICAgIHB1YmxpYyBpbnRlcmZhY2VcbiAgICAgICAgKi9cblxuICAgICAgICAvLyBvcGVuIGZpbGUgYnJvd3NlciBmb3Igc2VsZWN0aW9uXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdCgpIHtcbiAgICAgICAgICAgIHVwbG9hZGlucHV0LmRpYWxvZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVtb3ZlIGFsbCBlbnRyaWVzIGZyb20gcXVldWVcbiAgICAgICAgZnVuY3Rpb24gcmVzZXQoaW5kZXgpIHtcbiAgICAgICAgICAgIGZvciAoaW5kZXggaW4gcXVldWUpIHtcbiAgICAgICAgICAgICAgICByZW1vdmUoaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5pdGlhdGUgdXBsb2FkIHByb2Nlc3NcbiAgICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoIXF1ZXVlX3J1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBxdWV1ZV9ydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzdG9wIHVwbG9hZCBwcm9jZXNzXG4gICAgICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgICAgICBxdWV1ZV9zdG9wID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNldCBvcHRpb25zXG4gICAgICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZShvcHRpb25zKSB7XG4gICAgICAgICAgICBvcHRzID0gJC5leHRlbmQoe30sIG9wdHMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgcmV0dXJuIG9wdHM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB2ZXJpZnkgYnJvd3NlciBjb21wYXRpYmlsaXR5XG4gICAgICAgIGZ1bmN0aW9uIGNvbXBhdGlibGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LkZpbGUgJiYgd2luZG93LkZvcm1EYXRhICYmIHdpbmRvdy5YTUxIdHRwUmVxdWVzdCAmJiB3aW5kb3cuRmlsZUxpc3Q7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBleHBvcnQgZnVuY3Rpb25zXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHNlbGVjdCxcbiAgICAgICAgICAgIGFkZDogYWRkLFxuICAgICAgICAgICAgcmVtb3ZlOiByZW1vdmUsXG4gICAgICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgICAgICBzdG9wOiBzdG9wLFxuICAgICAgICAgICAgcmVzZXQ6IHJlc2V0LFxuICAgICAgICAgICAgY29uZmlndXJlOiBjb25maWd1cmUsXG4gICAgICAgICAgICBjb21wYXRpYmxlOiBjb21wYXRpYmxlXG4gICAgICAgIH07XG4gICAgfTtcbn0pKGpRdWVyeSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvdXRpbHMvdXBsb2FkYm94LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBQ0E7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFiQTtBQWVBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTtBQUNBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///95\n");

/***/ }),
/* 96 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/workflow/workflow-icons.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = {\n    tool: \"fa-wrench\",\n    data_input: \"fa-file-o\",\n    data_collection_input: \"fa-folder-o\",\n    subworkflow: \"fa-sitemap fa-rotate-270\",\n    pause: \"fa-pause\"\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL3dvcmtmbG93L3dvcmtmbG93LWljb25zLmpzPzVlZGQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQge1xuICAgIHRvb2w6IFwiZmEtd3JlbmNoXCIsXG4gICAgZGF0YV9pbnB1dDogXCJmYS1maWxlLW9cIixcbiAgICBkYXRhX2NvbGxlY3Rpb25faW5wdXQ6IFwiZmEtZm9sZGVyLW9cIixcbiAgICBzdWJ3b3JrZmxvdzogXCJmYS1zaXRlbWFwIGZhLXJvdGF0ZS0yNzBcIixcbiAgICBwYXVzZTogXCJmYS1wYXVzZVwiXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy93b3JrZmxvdy93b3JrZmxvdy1pY29ucy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///96\n");

/***/ }),
/* 97 */
/*!****************************************************!*\
  !*** ./galaxy/scripts/mvc/history/hdca-li-edit.js ***!
  \****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _hdcaLi = __webpack_require__(/*! mvc/history/hdca-li */ 42);\n\nvar _hdcaLi2 = _interopRequireDefault(_hdcaLi);\n\nvar _collectionViewEdit = __webpack_require__(/*! mvc/collection/collection-view-edit */ 98);\n\nvar _collectionViewEdit2 = _interopRequireDefault(_collectionViewEdit);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar _super = _hdcaLi2.default.HDCAListItemView;\n/** @class Editing view for HistoryDatasetCollectionAssociation.\n */\nvar HDCAListItemEdit = _super.extend(\n/** @lends HDCAListItemEdit.prototype */{\n    /** logger used to record this.log messages, commonly set to console */\n    //logger              : console,\n    /** set up: options */\n    initialize: function initialize(attributes) {\n        _super.prototype.initialize.call(this, attributes);\n\n        /** allow user purge of dataset files? */\n        this.purgeAllowed = attributes.purgeAllowed || false;\n    },\n\n    /** Override to return editable versions of the collection panels */\n    _getFoldoutPanelClass: function _getFoldoutPanelClass() {\n        return _collectionViewEdit2.default.CollectionViewEdit;\n    },\n\n    // ......................................................................... delete\n    /** In this override, add the delete button. */\n    _renderPrimaryActions: function _renderPrimaryActions() {\n        this.log(this + \"._renderPrimaryActions\");\n        // render the display, edit attr and delete icon-buttons\n        return _super.prototype._renderPrimaryActions.call(this).concat([this._renderDeleteButton()]);\n    },\n\n    _renderDeleteButton: function _renderDeleteButton() {\n        return $(\"\\n                <div class=\\\"dropdown\\\">\\n                    <a class=\\\"delete-btn icon-btn\\\" title=\\\"\" + (0, _localization2.default)(\"Delete\") + \"\\\" data-toggle=\\\"dropdown\\\">\\n                        <span class=\\\"fa fa-times\\\"></span>\\n                    </a>\\n                    <ul class=\\\"dropdown-menu pull-right\\\" role=\\\"menu\\\">\\n                        <li>\\n                            <a href=\\\"#\\\" class=\\\"delete-collection\\\">\\n                                \" + (0, _localization2.default)(\"Collection Only\") + \"\\n                            </a>\\n                        </li>\\n                        <li>\\n                            <a href=\\\"#\\\" class=\\\"delete-collection-and-datasets\\\">\\n                                \" + (0, _localization2.default)(\"Delete Datasets\") + \"\\n                            </a>\\n                        </li>\\n                        <li style=\\\"display: \" + (this.purgeAllowed ? \"inherit\" : \"none\") + \"\\\">\\n                            <a href=\\\"#\\\" class=\\\"delete-collection-and-purge-datasets\\\">\\n                                \" + (0, _localization2.default)(\"Permanently Delete Datasets\") + \"\\n                            </a>\\n                        </li>\\n                    </ul>\\n                </div>\");\n    },\n\n    // ......................................................................... misc\n    events: _.extend(_.clone(_super.prototype.events), {\n        \"click .delete-collection\": function clickDeleteCollection(ev) {\n            this.model[\"delete\"]();\n        },\n        \"click .delete-collection-and-datasets\": function clickDeleteCollectionAndDatasets(ev) {\n            this.model[\"delete\"](true);\n        },\n        \"click .delete-collection-and-purge-datasets\": function clickDeleteCollectionAndPurgeDatasets(ev) {\n            this.model[\"delete\"](true, true);\n        }\n    }),\n\n    // ......................................................................... misc\n    /** string rep */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"HDCAListItemEdit(\" + modelString + \")\";\n    }\n});\n\n//==============================================================================\nexports.default = {\n    HDCAListItemEdit: HDCAListItemEdit\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3RvcnkvaGRjYS1saS1lZGl0LmpzPzliYmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEhEQ0FfTEkgZnJvbSBcIm12Yy9oaXN0b3J5L2hkY2EtbGlcIjtcbmltcG9ydCBEQ19WSUVXX0VESVQgZnJvbSBcIm12Yy9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tdmlldy1lZGl0XCI7XG5pbXBvcnQgZmFJY29uQnV0dG9uIGZyb20gXCJ1aS9mYS1pY29uLWJ1dHRvblwiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnZhciBfc3VwZXIgPSBIRENBX0xJLkhEQ0FMaXN0SXRlbVZpZXc7XG4vKiogQGNsYXNzIEVkaXRpbmcgdmlldyBmb3IgSGlzdG9yeURhdGFzZXRDb2xsZWN0aW9uQXNzb2NpYXRpb24uXG4gKi9cbnZhciBIRENBTGlzdEl0ZW1FZGl0ID0gX3N1cGVyLmV4dGVuZChcbiAgICAvKiogQGxlbmRzIEhEQ0FMaXN0SXRlbUVkaXQucHJvdG90eXBlICovIHtcbiAgICAgICAgLyoqIGxvZ2dlciB1c2VkIHRvIHJlY29yZCB0aGlzLmxvZyBtZXNzYWdlcywgY29tbW9ubHkgc2V0IHRvIGNvbnNvbGUgKi9cbiAgICAgICAgLy9sb2dnZXIgICAgICAgICAgICAgIDogY29uc29sZSxcbiAgICAgICAgLyoqIHNldCB1cDogb3B0aW9ucyAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcblxuICAgICAgICAgICAgLyoqIGFsbG93IHVzZXIgcHVyZ2Ugb2YgZGF0YXNldCBmaWxlcz8gKi9cbiAgICAgICAgICAgIHRoaXMucHVyZ2VBbGxvd2VkID0gYXR0cmlidXRlcy5wdXJnZUFsbG93ZWQgfHwgZmFsc2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIHJldHVybiBlZGl0YWJsZSB2ZXJzaW9ucyBvZiB0aGUgY29sbGVjdGlvbiBwYW5lbHMgKi9cbiAgICAgICAgX2dldEZvbGRvdXRQYW5lbENsYXNzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBEQ19WSUVXX0VESVQuQ29sbGVjdGlvblZpZXdFZGl0O1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gZGVsZXRlXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQgdGhlIGRlbGV0ZSBidXR0b24uICovXG4gICAgICAgIF9yZW5kZXJQcmltYXJ5QWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmxvZyhgJHt0aGlzfS5fcmVuZGVyUHJpbWFyeUFjdGlvbnNgKTtcbiAgICAgICAgICAgIC8vIHJlbmRlciB0aGUgZGlzcGxheSwgZWRpdCBhdHRyIGFuZCBkZWxldGUgaWNvbi1idXR0b25zXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5fcmVuZGVyUHJpbWFyeUFjdGlvbnMuY2FsbCh0aGlzKS5jb25jYXQoW3RoaXMuX3JlbmRlckRlbGV0ZUJ1dHRvbigpXSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX3JlbmRlckRlbGV0ZUJ1dHRvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJChgXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRyb3Bkb3duXCI+XG4gICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPVwiZGVsZXRlLWJ0biBpY29uLWJ0blwiIHRpdGxlPVwiJHtfbChcIkRlbGV0ZVwiKX1cIiBkYXRhLXRvZ2dsZT1cImRyb3Bkb3duXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImZhIGZhLXRpbWVzXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgIDx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnUgcHVsbC1yaWdodFwiIHJvbGU9XCJtZW51XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cImRlbGV0ZS1jb2xsZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7X2woXCJDb2xsZWN0aW9uIE9ubHlcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwiZGVsZXRlLWNvbGxlY3Rpb24tYW5kLWRhdGFzZXRzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7X2woXCJEZWxldGUgRGF0YXNldHNcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBzdHlsZT1cImRpc3BsYXk6ICR7dGhpcy5wdXJnZUFsbG93ZWQgPyBcImluaGVyaXRcIiA6IFwibm9uZVwifVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJkZWxldGUtY29sbGVjdGlvbi1hbmQtcHVyZ2UtZGF0YXNldHNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtfbChcIlBlcm1hbmVudGx5IERlbGV0ZSBEYXRhc2V0c1wiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgIDwvZGl2PmApO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICBldmVudHM6IF8uZXh0ZW5kKF8uY2xvbmUoX3N1cGVyLnByb3RvdHlwZS5ldmVudHMpLCB7XG4gICAgICAgICAgICBcImNsaWNrIC5kZWxldGUtY29sbGVjdGlvblwiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWxbXCJkZWxldGVcIl0oKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImNsaWNrIC5kZWxldGUtY29sbGVjdGlvbi1hbmQtZGF0YXNldHNcIjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsW1wiZGVsZXRlXCJdKHRydWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiY2xpY2sgLmRlbGV0ZS1jb2xsZWN0aW9uLWFuZC1wdXJnZS1kYXRhc2V0c1wiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWxbXCJkZWxldGVcIl0odHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogc3RyaW5nIHJlcCAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWxTdHJpbmcgPSB0aGlzLm1vZGVsID8gYCR7dGhpcy5tb2RlbH1gIDogXCIobm8gbW9kZWwpXCI7XG4gICAgICAgICAgICByZXR1cm4gYEhEQ0FMaXN0SXRlbUVkaXQoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgSERDQUxpc3RJdGVtRWRpdDogSERDQUxpc3RJdGVtRWRpdFxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9oZGNhLWxpLWVkaXQuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwRUE7QUFDQTtBQXVFQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///97\n");

/***/ }),
/* 98 */
/*!***************************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/collection-view-edit.js ***!
  \***************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _collectionView = __webpack_require__(/*! mvc/collection/collection-view */ 60);\n\nvar _collectionView2 = _interopRequireDefault(_collectionView);\n\nvar _collectionModel = __webpack_require__(/*! mvc/collection/collection-model */ 30);\n\nvar _collectionModel2 = _interopRequireDefault(_collectionModel);\n\nvar _collectionLiEdit = __webpack_require__(/*! mvc/collection/collection-li-edit */ 99);\n\nvar _collectionLiEdit2 = _interopRequireDefault(_collectionLiEdit);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _tag = __webpack_require__(/*! mvc/tag */ 23);\n\nvar _tag2 = _interopRequireDefault(_tag);\n\nvar _faIconButton = __webpack_require__(/*! ui/fa-icon-button */ 10);\n\nvar _faIconButton2 = _interopRequireDefault(_faIconButton);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\n__webpack_require__(/*! ui/editable-text */ 15);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* =============================================================================\nTODO:\n\n============================================================================= */\n/** @class editable View/Controller for a dataset collection.\n */\nvar _super = _collectionView2.default.CollectionView;\nvar CollectionViewEdit = _super.extend(\n/** @lends CollectionView.prototype */{\n    //MODEL is either a DatasetCollection (or subclass) or a DatasetCollectionElement (list of pairs)\n\n    /** logger used to record this.log messages, commonly set to console */\n    //logger              : console,\n\n    /** sub view class used for datasets */\n    DatasetDCEViewClass: _collectionLiEdit2.default.DatasetDCEListItemEdit,\n    /** sub view class used for nested collections */\n    NestedDCDCEViewClass: _collectionLiEdit2.default.NestedDCDCEListItemEdit,\n\n    getNestedDCDCEViewClass: function getNestedDCDCEViewClass() {\n        return _collectionLiEdit2.default.NestedDCDCEListItemEdit.extend({\n            foldoutPanelClass: CollectionViewEdit\n        });\n    },\n\n    // ......................................................................... SET UP\n    /** Set up the view, set up storage, bind listeners to HistoryContents events\n     *  @param {Object} attributes optional settings for the panel\n     */\n    initialize: function initialize(attributes) {\n        _super.prototype.initialize.call(this, attributes);\n    },\n\n    /** In this override, make the collection name editable\n     */\n    _setUpBehaviors: function _setUpBehaviors($where) {\n        $where = $where || this.$el;\n        _super.prototype._setUpBehaviors.call(this, $where);\n        if (!this.model) {\n            return;\n        }\n\n        // anon users shouldn't have access to any of the following\n        if (!Galaxy.user || Galaxy.user.isAnonymous()) {\n            return;\n        }\n\n        this.tagsEditorShown = true;\n\n        //TODO: extract\n        var panel = this;\n\n        var nameSelector = \"> .controls .name\";\n        $where.find(nameSelector).attr(\"title\", (0, _localization2.default)(\"Click to rename collection\")).tooltip({ placement: \"bottom\" }).make_text_editable({\n            on_finish: function on_finish(newName) {\n                var previousName = panel.model.get(\"name\");\n                if (newName && newName !== previousName) {\n                    panel.$el.find(nameSelector).text(newName);\n                    panel.model.save({ name: newName }).fail(function () {\n                        panel.$el.find(nameSelector).text(panel.model.previous(\"name\"));\n                    });\n                } else {\n                    panel.$el.find(nameSelector).text(previousName);\n                }\n            }\n        });\n        this.tagsEditor = new _tag2.default.TagsEditor({\n            model: this.model,\n            el: $where.find(\".tags-display\"),\n            onshowFirstTime: function onshowFirstTime() {\n                this.render();\n            },\n            usePrompt: false\n        });\n        this.tagsEditor.toggle(true);\n    },\n\n    // ........................................................................ misc\n    /** string rep */\n    toString: function toString() {\n        return \"CollectionViewEdit(\" + (this.model ? this.model.get(\"name\") : \"\") + \")\";\n    }\n});\n\n//==============================================================================\nexports.default = {\n    CollectionViewEdit: CollectionViewEdit\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi12aWV3LWVkaXQuanM/OTBjNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRENfVklFVyBmcm9tIFwibXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi12aWV3XCI7XG5pbXBvcnQgRENfTU9ERUwgZnJvbSBcIm12Yy9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tbW9kZWxcIjtcbmltcG9ydCBEQ19FRElUIGZyb20gXCJtdmMvY29sbGVjdGlvbi9jb2xsZWN0aW9uLWxpLWVkaXRcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgVEFHUyBmcm9tIFwibXZjL3RhZ1wiO1xuaW1wb3J0IGZhSWNvbkJ1dHRvbiBmcm9tIFwidWkvZmEtaWNvbi1idXR0b25cIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5pbXBvcnQgXCJ1aS9lZGl0YWJsZS10ZXh0XCI7XG5cbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5UT0RPOlxuXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuLyoqIEBjbGFzcyBlZGl0YWJsZSBWaWV3L0NvbnRyb2xsZXIgZm9yIGEgZGF0YXNldCBjb2xsZWN0aW9uLlxuICovXG52YXIgX3N1cGVyID0gRENfVklFVy5Db2xsZWN0aW9uVmlldztcbnZhciBDb2xsZWN0aW9uVmlld0VkaXQgPSBfc3VwZXIuZXh0ZW5kKFxuICAgIC8qKiBAbGVuZHMgQ29sbGVjdGlvblZpZXcucHJvdG90eXBlICovIHtcbiAgICAgICAgLy9NT0RFTCBpcyBlaXRoZXIgYSBEYXRhc2V0Q29sbGVjdGlvbiAob3Igc3ViY2xhc3MpIG9yIGEgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50IChsaXN0IG9mIHBhaXJzKVxuXG4gICAgICAgIC8qKiBsb2dnZXIgdXNlZCB0byByZWNvcmQgdGhpcy5sb2cgbWVzc2FnZXMsIGNvbW1vbmx5IHNldCB0byBjb25zb2xlICovXG4gICAgICAgIC8vbG9nZ2VyICAgICAgICAgICAgICA6IGNvbnNvbGUsXG5cbiAgICAgICAgLyoqIHN1YiB2aWV3IGNsYXNzIHVzZWQgZm9yIGRhdGFzZXRzICovXG4gICAgICAgIERhdGFzZXREQ0VWaWV3Q2xhc3M6IERDX0VESVQuRGF0YXNldERDRUxpc3RJdGVtRWRpdCxcbiAgICAgICAgLyoqIHN1YiB2aWV3IGNsYXNzIHVzZWQgZm9yIG5lc3RlZCBjb2xsZWN0aW9ucyAqL1xuICAgICAgICBOZXN0ZWREQ0RDRVZpZXdDbGFzczogRENfRURJVC5OZXN0ZWREQ0RDRUxpc3RJdGVtRWRpdCxcblxuICAgICAgICBnZXROZXN0ZWREQ0RDRVZpZXdDbGFzczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gRENfRURJVC5OZXN0ZWREQ0RDRUxpc3RJdGVtRWRpdC5leHRlbmQoe1xuICAgICAgICAgICAgICAgIGZvbGRvdXRQYW5lbENsYXNzOiBDb2xsZWN0aW9uVmlld0VkaXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gU0VUIFVQXG4gICAgICAgIC8qKiBTZXQgdXAgdGhlIHZpZXcsIHNldCB1cCBzdG9yYWdlLCBiaW5kIGxpc3RlbmVycyB0byBIaXN0b3J5Q29udGVudHMgZXZlbnRzXG4gICAgICAgICAqICBAcGFyYW0ge09iamVjdH0gYXR0cmlidXRlcyBvcHRpb25hbCBzZXR0aW5ncyBmb3IgdGhlIHBhbmVsXG4gICAgICAgICAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgbWFrZSB0aGUgY29sbGVjdGlvbiBuYW1lIGVkaXRhYmxlXG4gICAgICAgICAqL1xuICAgICAgICBfc2V0VXBCZWhhdmlvcnM6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0VXBCZWhhdmlvcnMuY2FsbCh0aGlzLCAkd2hlcmUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1vZGVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhbm9uIHVzZXJzIHNob3VsZG4ndCBoYXZlIGFjY2VzcyB0byBhbnkgb2YgdGhlIGZvbGxvd2luZ1xuICAgICAgICAgICAgaWYgKCFHYWxheHkudXNlciB8fCBHYWxheHkudXNlci5pc0Fub255bW91cygpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRhZ3NFZGl0b3JTaG93biA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vVE9ETzogZXh0cmFjdFxuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIG5hbWVTZWxlY3RvciA9IFwiPiAuY29udHJvbHMgLm5hbWVcIjtcbiAgICAgICAgICAgICR3aGVyZVxuICAgICAgICAgICAgICAgIC5maW5kKG5hbWVTZWxlY3RvcilcbiAgICAgICAgICAgICAgICAuYXR0cihcInRpdGxlXCIsIF9sKFwiQ2xpY2sgdG8gcmVuYW1lIGNvbGxlY3Rpb25cIikpXG4gICAgICAgICAgICAgICAgLnRvb2x0aXAoeyBwbGFjZW1lbnQ6IFwiYm90dG9tXCIgfSlcbiAgICAgICAgICAgICAgICAubWFrZV90ZXh0X2VkaXRhYmxlKHtcbiAgICAgICAgICAgICAgICAgICAgb25fZmluaXNoOiBmdW5jdGlvbihuZXdOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlvdXNOYW1lID0gcGFuZWwubW9kZWwuZ2V0KFwibmFtZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXdOYW1lICYmIG5ld05hbWUgIT09IHByZXZpb3VzTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLiRlbC5maW5kKG5hbWVTZWxlY3RvcikudGV4dChuZXdOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYW5lbC5tb2RlbC5zYXZlKHsgbmFtZTogbmV3TmFtZSB9KS5mYWlsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWwuJGVsLmZpbmQobmFtZVNlbGVjdG9yKS50ZXh0KHBhbmVsLm1vZGVsLnByZXZpb3VzKFwibmFtZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsLiRlbC5maW5kKG5hbWVTZWxlY3RvcikudGV4dChwcmV2aW91c05hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnRhZ3NFZGl0b3IgPSBuZXcgVEFHUy5UYWdzRWRpdG9yKHtcbiAgICAgICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcbiAgICAgICAgICAgICAgICBlbDogJHdoZXJlLmZpbmQoXCIudGFncy1kaXNwbGF5XCIpLFxuICAgICAgICAgICAgICAgIG9uc2hvd0ZpcnN0VGltZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB1c2VQcm9tcHQ6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudGFnc0VkaXRvci50b2dnbGUodHJ1ZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIG1pc2NcbiAgICAgICAgLyoqIHN0cmluZyByZXAgKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGBDb2xsZWN0aW9uVmlld0VkaXQoJHt0aGlzLm1vZGVsID8gdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpIDogXCJcIn0pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgQ29sbGVjdGlvblZpZXdFZGl0OiBDb2xsZWN0aW9uVmlld0VkaXRcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi12aWV3LWVkaXQuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBOzs7O0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE3RUE7QUFDQTtBQWdGQTtBQUNBO0FBQ0E7QUFEQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///98\n");

/***/ }),
/* 99 */
/*!*************************************************************!*\
  !*** ./galaxy/scripts/mvc/collection/collection-li-edit.js ***!
  \*************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(jQuery, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _collectionLi = __webpack_require__(/*! mvc/collection/collection-li */ 32);\n\nvar _collectionLi2 = _interopRequireDefault(_collectionLi);\n\nvar _datasetLiEdit = __webpack_require__(/*! mvc/dataset/dataset-li-edit */ 61);\n\nvar _datasetLiEdit2 = _interopRequireDefault(_datasetLiEdit);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//==============================================================================\nvar DCListItemView = _collectionLi2.default.DCListItemView;\n/** @class Edit view for DatasetCollection.\n */\nvar DCListItemEdit = DCListItemView.extend(\n/** @lends DCListItemEdit.prototype */{\n    /** override to add linkTarget */\n    initialize: function initialize(attributes) {\n        DCListItemView.prototype.initialize.call(this, attributes);\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DCListItemEdit(\" + modelString + \")\";\n    }\n});\n\n//==============================================================================\nvar DCEListItemView = _collectionLi2.default.DCEListItemView;\n/** @class Read only view for DatasetCollectionElement.\n */\nvar DCEListItemEdit = DCEListItemView.extend(\n/** @lends DCEListItemEdit.prototype */{\n    //TODO: this might be expendable - compacted with HDAListItemView\n\n    /** set up */\n    initialize: function initialize(attributes) {\n        DCEListItemView.prototype.initialize.call(this, attributes);\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DCEListItemEdit(\" + modelString + \")\";\n    }\n});\n\n//==============================================================================\n// NOTE: this does not inherit from DatasetDCEListItemView as you would expect\n//TODO: but should - if we can find something simpler than using diamond\n/** @class Editable view for a DatasetCollectionElement that is also an DatasetAssociation\n *      (a dataset contained in a dataset collection).\n */\nvar DatasetDCEListItemEdit = _datasetLiEdit2.default.DatasetListItemEdit.extend(\n/** @lends DatasetDCEListItemEdit.prototype */{\n    /** set up */\n    initialize: function initialize(attributes) {\n        _datasetLiEdit2.default.DatasetListItemEdit.prototype.initialize.call(this, attributes);\n    },\n\n    // NOTE: this does not inherit from DatasetDCEListItemView - so we duplicate this here\n    //TODO: fix\n    /** In this override, only get details if in the ready state.\n     *  Note: fetch with no 'change' event triggering to prevent automatic rendering.\n     */\n    _fetchModelDetails: function _fetchModelDetails() {\n        var view = this;\n        if (view.model.inReadyState() && !view.model.hasDetails()) {\n            return view.model.fetch({ silent: true });\n        }\n        return jQuery.when();\n    },\n\n    /** Override to remove delete button */\n    _renderDeleteButton: function _renderDeleteButton() {\n        return null;\n    },\n\n    // ......................................................................... misc\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"DatasetDCEListItemEdit(\" + modelString + \")\";\n    }\n});\n\n// ............................................................................ TEMPLATES\n/** underscore templates */\nDatasetDCEListItemEdit.prototype.templates = function () {\n    return _.extend({}, _datasetLiEdit2.default.DatasetListItemEdit.prototype.templates, {\n        titleBar: _collectionLi2.default.DatasetDCEListItemView.prototype.templates.titleBar\n    });\n}();\n\n//==============================================================================\n/** @class Read only view for a DatasetCollectionElement that is also a DatasetCollection\n *      (a nested DC).\n */\nvar NestedDCDCEListItemEdit = _collectionLi2.default.NestedDCDCEListItemView.extend(\n/** @lends NestedDCDCEListItemEdit.prototype */{\n    /** String representation */\n    toString: function toString() {\n        var modelString = this.model ? \"\" + this.model : \"(no model)\";\n        return \"NestedDCDCEListItemEdit(\" + modelString + \")\";\n    }\n});\n\n//==============================================================================\nexports.default = {\n    DCListItemEdit: DCListItemEdit,\n    DCEListItemEdit: DCEListItemEdit,\n    DatasetDCEListItemEdit: DatasetDCEListItemEdit,\n    NestedDCDCEListItemEdit: NestedDCDCEListItemEdit\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ2FsYXh5L3NjcmlwdHMvbXZjL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1saS1lZGl0LmpzPzdmZDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERDX0xJIGZyb20gXCJtdmMvY29sbGVjdGlvbi9jb2xsZWN0aW9uLWxpXCI7XG5pbXBvcnQgREFUQVNFVF9MSV9FRElUIGZyb20gXCJtdmMvZGF0YXNldC9kYXRhc2V0LWxpLWVkaXRcIjtcbmltcG9ydCBCQVNFX01WQyBmcm9tIFwibXZjL2Jhc2UtbXZjXCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxudmFyIERDTGlzdEl0ZW1WaWV3ID0gRENfTEkuRENMaXN0SXRlbVZpZXc7XG4vKiogQGNsYXNzIEVkaXQgdmlldyBmb3IgRGF0YXNldENvbGxlY3Rpb24uXG4gKi9cbnZhciBEQ0xpc3RJdGVtRWRpdCA9IERDTGlzdEl0ZW1WaWV3LmV4dGVuZChcbiAgICAvKiogQGxlbmRzIERDTGlzdEl0ZW1FZGl0LnByb3RvdHlwZSAqLyB7XG4gICAgICAgIC8qKiBvdmVycmlkZSB0byBhZGQgbGlua1RhcmdldCAqL1xuICAgICAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBEQ0xpc3RJdGVtVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMsIGF0dHJpYnV0ZXMpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gbWlzY1xuICAgICAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbFN0cmluZyA9IHRoaXMubW9kZWwgPyBgJHt0aGlzLm1vZGVsfWAgOiBcIihubyBtb2RlbClcIjtcbiAgICAgICAgICAgIHJldHVybiBgRENMaXN0SXRlbUVkaXQoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG52YXIgRENFTGlzdEl0ZW1WaWV3ID0gRENfTEkuRENFTGlzdEl0ZW1WaWV3O1xuLyoqIEBjbGFzcyBSZWFkIG9ubHkgdmlldyBmb3IgRGF0YXNldENvbGxlY3Rpb25FbGVtZW50LlxuICovXG52YXIgRENFTGlzdEl0ZW1FZGl0ID0gRENFTGlzdEl0ZW1WaWV3LmV4dGVuZChcbiAgICAvKiogQGxlbmRzIERDRUxpc3RJdGVtRWRpdC5wcm90b3R5cGUgKi8ge1xuICAgICAgICAvL1RPRE86IHRoaXMgbWlnaHQgYmUgZXhwZW5kYWJsZSAtIGNvbXBhY3RlZCB3aXRoIEhEQUxpc3RJdGVtVmlld1xuXG4gICAgICAgIC8qKiBzZXQgdXAgKi9cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICAgICAgRENFTGlzdEl0ZW1WaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBEQ0VMaXN0SXRlbUVkaXQoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBOT1RFOiB0aGlzIGRvZXMgbm90IGluaGVyaXQgZnJvbSBEYXRhc2V0RENFTGlzdEl0ZW1WaWV3IGFzIHlvdSB3b3VsZCBleHBlY3Rcbi8vVE9ETzogYnV0IHNob3VsZCAtIGlmIHdlIGNhbiBmaW5kIHNvbWV0aGluZyBzaW1wbGVyIHRoYW4gdXNpbmcgZGlhbW9uZFxuLyoqIEBjbGFzcyBFZGl0YWJsZSB2aWV3IGZvciBhIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudCB0aGF0IGlzIGFsc28gYW4gRGF0YXNldEFzc29jaWF0aW9uXG4gKiAgICAgIChhIGRhdGFzZXQgY29udGFpbmVkIGluIGEgZGF0YXNldCBjb2xsZWN0aW9uKS5cbiAqL1xudmFyIERhdGFzZXREQ0VMaXN0SXRlbUVkaXQgPSBEQVRBU0VUX0xJX0VESVQuRGF0YXNldExpc3RJdGVtRWRpdC5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBEYXRhc2V0RENFTGlzdEl0ZW1FZGl0LnByb3RvdHlwZSAqLyB7XG4gICAgICAgIC8qKiBzZXQgdXAgKi9cbiAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cmlidXRlcykge1xuICAgICAgICAgICAgREFUQVNFVF9MSV9FRElULkRhdGFzZXRMaXN0SXRlbUVkaXQucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBOT1RFOiB0aGlzIGRvZXMgbm90IGluaGVyaXQgZnJvbSBEYXRhc2V0RENFTGlzdEl0ZW1WaWV3IC0gc28gd2UgZHVwbGljYXRlIHRoaXMgaGVyZVxuICAgICAgICAvL1RPRE86IGZpeFxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgb25seSBnZXQgZGV0YWlscyBpZiBpbiB0aGUgcmVhZHkgc3RhdGUuXG4gICAgICAgICAqICBOb3RlOiBmZXRjaCB3aXRoIG5vICdjaGFuZ2UnIGV2ZW50IHRyaWdnZXJpbmcgdG8gcHJldmVudCBhdXRvbWF0aWMgcmVuZGVyaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgX2ZldGNoTW9kZWxEZXRhaWxzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgICAgIGlmICh2aWV3Lm1vZGVsLmluUmVhZHlTdGF0ZSgpICYmICF2aWV3Lm1vZGVsLmhhc0RldGFpbHMoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3Lm1vZGVsLmZldGNoKHsgc2lsZW50OiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIHJlbW92ZSBkZWxldGUgYnV0dG9uICovXG4gICAgICAgIF9yZW5kZXJEZWxldGVCdXR0b246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBtaXNjXG4gICAgICAgIC8qKiBTdHJpbmcgcmVwcmVzZW50YXRpb24gKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsU3RyaW5nID0gdGhpcy5tb2RlbCA/IGAke3RoaXMubW9kZWx9YCA6IFwiKG5vIG1vZGVsKVwiO1xuICAgICAgICAgICAgcmV0dXJuIGBEYXRhc2V0RENFTGlzdEl0ZW1FZGl0KCR7bW9kZWxTdHJpbmd9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIFRFTVBMQVRFU1xuLyoqIHVuZGVyc2NvcmUgdGVtcGxhdGVzICovXG5EYXRhc2V0RENFTGlzdEl0ZW1FZGl0LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT5cbiAgICBfLmV4dGVuZCh7fSwgREFUQVNFVF9MSV9FRElULkRhdGFzZXRMaXN0SXRlbUVkaXQucHJvdG90eXBlLnRlbXBsYXRlcywge1xuICAgICAgICB0aXRsZUJhcjogRENfTEkuRGF0YXNldERDRUxpc3RJdGVtVmlldy5wcm90b3R5cGUudGVtcGxhdGVzLnRpdGxlQmFyXG4gICAgfSkpKCk7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIFJlYWQgb25seSB2aWV3IGZvciBhIERhdGFzZXRDb2xsZWN0aW9uRWxlbWVudCB0aGF0IGlzIGFsc28gYSBEYXRhc2V0Q29sbGVjdGlvblxuICogICAgICAoYSBuZXN0ZWQgREMpLlxuICovXG52YXIgTmVzdGVkRENEQ0VMaXN0SXRlbUVkaXQgPSBEQ19MSS5OZXN0ZWREQ0RDRUxpc3RJdGVtVmlldy5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBOZXN0ZWREQ0RDRUxpc3RJdGVtRWRpdC5wcm90b3R5cGUgKi8ge1xuICAgICAgICAvKiogU3RyaW5nIHJlcHJlc2VudGF0aW9uICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtb2RlbFN0cmluZyA9IHRoaXMubW9kZWwgPyBgJHt0aGlzLm1vZGVsfWAgOiBcIihubyBtb2RlbClcIjtcbiAgICAgICAgICAgIHJldHVybiBgTmVzdGVkRENEQ0VMaXN0SXRlbUVkaXQoJHttb2RlbFN0cmluZ30pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgRENMaXN0SXRlbUVkaXQ6IERDTGlzdEl0ZW1FZGl0LFxuICAgIERDRUxpc3RJdGVtRWRpdDogRENFTGlzdEl0ZW1FZGl0LFxuICAgIERhdGFzZXREQ0VMaXN0SXRlbUVkaXQ6IERhdGFzZXREQ0VMaXN0SXRlbUVkaXQsXG4gICAgTmVzdGVkRENEQ0VMaXN0SXRlbUVkaXQ6IE5lc3RlZERDRENFTGlzdEl0ZW1FZGl0XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tbGktZWRpdC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNBO0FBY0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBQ0E7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdCQTtBQUNBO0FBZ0NBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFEQTtBQURBO0FBQ0E7QUFJQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///99\n");

/***/ }),
/* 100 */
/*!*********************************************!*\
  !*** ./galaxy/scripts/utils/levenshtein.js ***!
  \*********************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n//=============================================================================\n/**\n(Imported for edit distance algorith. From: https://gist.github.com/andrei-m/982927)\nCopyright (c) 2011 Andrei Mackenzie\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\ndocumentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the\nrights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit\npersons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the\nSoftware.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE\nWARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\nOTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n// Compute the edit distance between the two given strings\n//exports.getEditDistance = function(a, b){\nfunction levenshteinDistance(a, b) {\n    if (a.length === 0) {\n        return b.length;\n    }\n    if (b.length === 0) {\n        return a.length;\n    }\n\n    var matrix = [];\n\n    // increment along the first column of each row\n    var i;\n    for (i = 0; i <= b.length; i++) {\n        matrix[i] = [i];\n    }\n\n    // increment each column in the first row\n    var j;\n    for (j = 0; j <= a.length; j++) {\n        matrix[0][j] = j;\n    }\n\n    // Fill in the rest of the matrix\n    for (i = 1; i <= b.length; i++) {\n        for (j = 1; j <= a.length; j++) {\n            if (b.charAt(i - 1) === a.charAt(j - 1)) {\n                matrix[i][j] = matrix[i - 1][j - 1];\n            } else {\n                matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, // substitution\n                Math.min(matrix[i][j - 1] + 1, // insertion\n                matrix[i - 1][j] + 1)); // deletion\n            }\n        }\n    }\n\n    //console.debug( '\\t\\t levenshteinDistance', a, b, matrix[b.length][a.length] );\n    return matrix[b.length][a.length];\n}\n\n//=============================================================================\nexports.default = levenshteinDistance;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL3V0aWxzL2xldmVuc2h0ZWluLmpzP2Q5MjMiXSwic291cmNlc0NvbnRlbnQiOlsiLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqXG4oSW1wb3J0ZWQgZm9yIGVkaXQgZGlzdGFuY2UgYWxnb3JpdGguIEZyb206IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2FuZHJlaS1tLzk4MjkyNylcbkNvcHlyaWdodCAoYykgMjAxMSBBbmRyZWkgTWFja2VuemllXG5cblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlXG5yaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG5wZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlXG5Tb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRVxuV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SXG5DT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG5PVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG4qL1xuLy8gQ29tcHV0ZSB0aGUgZWRpdCBkaXN0YW5jZSBiZXR3ZWVuIHRoZSB0d28gZ2l2ZW4gc3RyaW5nc1xuLy9leHBvcnRzLmdldEVkaXREaXN0YW5jZSA9IGZ1bmN0aW9uKGEsIGIpe1xuZnVuY3Rpb24gbGV2ZW5zaHRlaW5EaXN0YW5jZShhLCBiKSB7XG4gICAgaWYgKGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBiLmxlbmd0aDtcbiAgICB9XG4gICAgaWYgKGIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBhLmxlbmd0aDtcbiAgICB9XG5cbiAgICB2YXIgbWF0cml4ID0gW107XG5cbiAgICAvLyBpbmNyZW1lbnQgYWxvbmcgdGhlIGZpcnN0IGNvbHVtbiBvZiBlYWNoIHJvd1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPD0gYi5sZW5ndGg7IGkrKykge1xuICAgICAgICBtYXRyaXhbaV0gPSBbaV07XG4gICAgfVxuXG4gICAgLy8gaW5jcmVtZW50IGVhY2ggY29sdW1uIGluIHRoZSBmaXJzdCByb3dcbiAgICB2YXIgajtcbiAgICBmb3IgKGogPSAwOyBqIDw9IGEubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgbWF0cml4WzBdW2pdID0gajtcbiAgICB9XG5cbiAgICAvLyBGaWxsIGluIHRoZSByZXN0IG9mIHRoZSBtYXRyaXhcbiAgICBmb3IgKGkgPSAxOyBpIDw9IGIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChqID0gMTsgaiA8PSBhLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBpZiAoYi5jaGFyQXQoaSAtIDEpID09PSBhLmNoYXJBdChqIC0gMSkpIHtcbiAgICAgICAgICAgICAgICBtYXRyaXhbaV1bal0gPSBtYXRyaXhbaSAtIDFdW2ogLSAxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWF0cml4W2ldW2pdID0gTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgICAgIG1hdHJpeFtpIC0gMV1baiAtIDFdICsgMSwgLy8gc3Vic3RpdHV0aW9uXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4W2ldW2ogLSAxXSArIDEsIC8vIGluc2VydGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4W2kgLSAxXVtqXSArIDFcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7IC8vIGRlbGV0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvL2NvbnNvbGUuZGVidWcoICdcXHRcXHQgbGV2ZW5zaHRlaW5EaXN0YW5jZScsIGEsIGIsIG1hdHJpeFtiLmxlbmd0aF1bYS5sZW5ndGhdICk7XG4gICAgcmV0dXJuIG1hdHJpeFtiLmxlbmd0aF1bYS5sZW5ndGhdO1xufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCBsZXZlbnNodGVpbkRpc3RhbmNlO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL3V0aWxzL2xldmVuc2h0ZWluLmpzIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///100\n");

/***/ }),
/* 101 */
/*!*************************************************!*\
  !*** ./galaxy/scripts/mvc/form/form-wrapper.js ***!
  \*************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Generic form view */\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        this.model = new Backbone.Model(options);\n        this.url = this.model.get(\"url\");\n        this.redirect = this.model.get(\"redirect\");\n        this.setElement(\"<div/>\");\n        this.render();\n    },\n\n    render: function render() {\n        var self = this;\n        $.ajax({\n            url: Galaxy.root + this.url,\n            type: \"GET\"\n        }).done(function (response) {\n            var options = $.extend({}, self.model.attributes, response);\n            var form = new _formView2.default({\n                title: options.title,\n                message: options.message,\n                status: options.status || \"warning\",\n                icon: options.icon,\n                initial_errors: true,\n                errors: options.errors,\n                inputs: options.inputs,\n                buttons: {\n                    submit: new _uiMisc2.default.Button({\n                        tooltip: options.submit_tooltip,\n                        title: options.submit_title || \"Save\",\n                        icon: options.submit_icon || \"fa-save\",\n                        cls: \"btn btn-primary ui-clear-float\",\n                        onclick: function onclick() {\n                            self._submit(form);\n                        }\n                    })\n                }\n            });\n            self.$el.empty().append(form.$el);\n        }).fail(function (response) {\n            self.$el.empty().append(new _uiMisc2.default.Message({\n                message: \"Failed to load resource \" + self.url + \".\",\n                status: \"danger\",\n                persistent: true\n            }).$el);\n        });\n    },\n\n    _submit: function _submit(form) {\n        var self = this;\n        $.ajax({\n            url: Galaxy.root + self.url,\n            data: JSON.stringify(form.data.create()),\n            type: \"PUT\",\n            contentType: \"application/json\"\n        }).done(function (response) {\n            var params = {};\n            if (response.id) {\n                params.id = response.id;\n            } else {\n                params = {\n                    message: response.message,\n                    status: \"success\",\n                    persistent: false\n                };\n            }\n            if (self.redirect) {\n                window.location = Galaxy.root + self.redirect + \"?\" + $.param(params);\n            } else {\n                form.data.matchModel(response, function (input, input_id) {\n                    form.field_list[input_id].value(input.value);\n                });\n                self._showMessage(form, success_message);\n            }\n        }).fail(function (response) {\n            self._showMessage(form, {\n                message: response.responseJSON.err_msg,\n                status: \"danger\",\n                persistent: false\n            });\n        });\n    },\n\n    _showMessage: function _showMessage(form, options) {\n        var $panel = form.$el.parents().filter(function () {\n            return [\"auto\", \"scroll\"].indexOf($(this).css(\"overflow\")) != -1;\n        }).first();\n        $panel.animate({ scrollTop: 0 }, 500);\n        form.message.update(options);\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9mb3JtL2Zvcm0td3JhcHBlci5qcz81ZjdiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBHZW5lcmljIGZvcm0gdmlldyAqL1xuaW1wb3J0IEZvcm0gZnJvbSBcIm12Yy9mb3JtL2Zvcm0tdmlld1wiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEJhY2tib25lLk1vZGVsKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnVybCA9IHRoaXMubW9kZWwuZ2V0KFwidXJsXCIpO1xuICAgICAgICB0aGlzLnJlZGlyZWN0ID0gdGhpcy5tb2RlbC5nZXQoXCJyZWRpcmVjdFwiKTtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KFwiPGRpdi8+XCIpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IEdhbGF4eS5yb290ICsgdGhpcy51cmwsXG4gICAgICAgICAgICB0eXBlOiBcIkdFVFwiXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuZG9uZShyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgc2VsZi5tb2RlbC5hdHRyaWJ1dGVzLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBuZXcgRm9ybSh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBvcHRpb25zLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBvcHRpb25zLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogb3B0aW9ucy5zdGF0dXMgfHwgXCJ3YXJuaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGljb246IG9wdGlvbnMuaWNvbixcbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbF9lcnJvcnM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yczogb3B0aW9ucy5lcnJvcnMsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0czogb3B0aW9ucy5pbnB1dHMsXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdDogbmV3IFVpLkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcDogb3B0aW9ucy5zdWJtaXRfdG9vbHRpcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogb3B0aW9ucy5zdWJtaXRfdGl0bGUgfHwgXCJTYXZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbjogb3B0aW9ucy5zdWJtaXRfaWNvbiB8fCBcImZhLXNhdmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHM6IFwiYnRuIGJ0bi1wcmltYXJ5IHVpLWNsZWFyLWZsb2F0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3N1Ym1pdChmb3JtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2VsZi4kZWwuZW1wdHkoKS5hcHBlbmQoZm9ybS4kZWwpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5mYWlsKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLiRlbC5lbXB0eSgpLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgbmV3IFVpLk1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYEZhaWxlZCB0byBsb2FkIHJlc291cmNlICR7c2VsZi51cmx9LmAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwiZGFuZ2VyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pLiRlbFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3N1Ym1pdDogZnVuY3Rpb24oZm9ybSkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IEdhbGF4eS5yb290ICsgc2VsZi51cmwsXG4gICAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShmb3JtLmRhdGEuY3JlYXRlKCkpLFxuICAgICAgICAgICAgdHlwZTogXCJQVVRcIixcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICB9KVxuICAgICAgICAgICAgLmRvbmUocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmlkID0gcmVzcG9uc2UuaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5yZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBgJHtHYWxheHkucm9vdCArIHNlbGYucmVkaXJlY3R9PyR7JC5wYXJhbShwYXJhbXMpfWA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybS5kYXRhLm1hdGNoTW9kZWwocmVzcG9uc2UsIChpbnB1dCwgaW5wdXRfaWQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uZmllbGRfbGlzdFtpbnB1dF9pZF0udmFsdWUoaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc2hvd01lc3NhZ2UoZm9ybSwgc3VjY2Vzc19tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZhaWwocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYuX3Nob3dNZXNzYWdlKGZvcm0sIHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UucmVzcG9uc2VKU09OLmVycl9tc2csXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJkYW5nZXJcIixcbiAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVudDogZmFsc2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBfc2hvd01lc3NhZ2U6IGZ1bmN0aW9uKGZvcm0sIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyICRwYW5lbCA9IGZvcm0uJGVsXG4gICAgICAgICAgICAucGFyZW50cygpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXCJhdXRvXCIsIFwic2Nyb2xsXCJdLmluZGV4T2YoJCh0aGlzKS5jc3MoXCJvdmVyZmxvd1wiKSkgIT0gLTE7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpcnN0KCk7XG4gICAgICAgICRwYW5lbC5hbmltYXRlKHsgc2Nyb2xsVG9wOiAwIH0sIDUwMCk7XG4gICAgICAgIGZvcm0ubWVzc2FnZS51cGRhdGUob3B0aW9ucyk7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9mb3JtL2Zvcm0td3JhcHBlci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFIQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBREE7QUFSQTtBQW9CQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQWhHQTtBQUNBO0FBa0dBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///101\n");

/***/ }),
/* 102 */,
/* 103 */,
/* 104 */,
/* 105 */,
/* 106 */,
/* 107 */,
/* 108 */,
/* 109 */,
/* 110 */,
/* 111 */,
/* 112 */,
/* 113 */,
/* 114 */,
/* 115 */,
/* 116 */,
/* 117 */,
/* 118 */,
/* 119 */,
/* 120 */,
/* 121 */,
/* 122 */,
/* 123 */,
/* 124 */,
/* 125 */,
/* 126 */,
/* 127 */,
/* 128 */,
/* 129 */,
/* 130 */,
/* 131 */,
/* 132 */,
/* 133 */,
/* 134 */,
/* 135 */,
/* 136 */,
/* 137 */
/*!********************************************************!*\
  !*** ./galaxy/scripts/mvc/tool/tool-form-composite.js ***!
  \********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _deferred = __webpack_require__(/*! utils/deferred */ 120);\n\nvar _deferred2 = _interopRequireDefault(_deferred);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nvar _formData = __webpack_require__(/*! mvc/form/form-data */ 122);\n\nvar _formData2 = _interopRequireDefault(_formData);\n\nvar _toolFormBase = __webpack_require__(/*! mvc/tool/tool-form-base */ 83);\n\nvar _toolFormBase2 = _interopRequireDefault(_toolFormBase);\n\nvar _uiModal = __webpack_require__(/*! mvc/ui/ui-modal */ 9);\n\nvar _uiModal2 = _interopRequireDefault(_uiModal);\n\nvar _webhooks = __webpack_require__(/*! mvc/webhooks */ 35);\n\nvar _webhooks2 = _interopRequireDefault(_webhooks);\n\nvar _workflowIcons = __webpack_require__(/*! mvc/workflow/workflow-icons */ 96);\n\nvar _workflowIcons2 = _interopRequireDefault(_workflowIcons);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        this.modal = parent.Galaxy.modal || new _uiModal2.default.View();\n        this.model = options && options.model || new Backbone.Model(options);\n        this.deferred = new _deferred2.default();\n        this.setElement($(\"<div/>\").addClass(\"ui-form-composite\").append(this.$message = $(\"<div/>\")).append(this.$header = $(\"<div/>\")).append(this.$steps = $(\"<div/>\")));\n        $(\"body\").append(this.$el);\n        this._configure();\n        this.render();\n        $(window).resize(function () {\n            self._refresh();\n        });\n    },\n\n    /** Refresh height of scrollable div below header, handle scrolling by lazy loading steps */\n    _refresh: function _refresh(step_index) {\n        var margin = _.reduce(this.$el.children(), function (memo, child) {\n            return memo + $(child).outerHeight();\n        }, 0) - this.$steps.height() + 90;\n        this.$steps.css(\"height\", $(window).height() - margin);\n    },\n\n    /** Configures form/step options for each workflow step */\n    _configure: function _configure() {\n        var self = this;\n        this.forms = [];\n        this.steps = [];\n        this.links = [];\n        this.parms = [];\n        _.each(this.model.get(\"steps\"), function (step, i) {\n            Galaxy.emit.debug(\"tool-form-composite::initialize()\", i + \" : Preparing workflow step.\");\n            var icon = _workflowIcons2.default[step.step_type];\n            var title = parseInt(i + 1) + \": \" + (step.step_label || step.step_name);\n            if (step.annotation) {\n                title += \" - \" + step.annotation;\n            }\n            if (step.step_version) {\n                title += \" (Galaxy Version \" + step.step_version + \")\";\n            }\n            step = _utils2.default.merge({\n                index: i,\n                fixed_title: _.escape(title),\n                icon: icon || \"\",\n                help: null,\n                citations: null,\n                collapsible: true,\n                collapsed: i > 0 && !self._isDataStep(step),\n                sustain_version: true,\n                sustain_repeats: true,\n                sustain_conditionals: true,\n                narrow: true,\n                text_enable: \"Edit\",\n                text_disable: \"Undo\",\n                cls_enable: \"fa fa-edit\",\n                cls_disable: \"fa fa-undo\",\n                errors: step.messages,\n                initial_errors: true,\n                cls: \"ui-portlet-narrow\",\n                hide_operations: true,\n                needs_refresh: false,\n                always_refresh: step.step_type != \"tool\"\n            }, step);\n            self.steps[i] = step;\n            self.links[i] = [];\n            self.parms[i] = {};\n        });\n\n        // build linear index of step input pairs\n        _.each(this.steps, function (step, i) {\n            _formData2.default.visitInputs(step.inputs, function (input, name) {\n                self.parms[i][name] = input;\n            });\n        });\n\n        // iterate through data input modules and collect linked sub steps\n        _.each(this.steps, function (step, i) {\n            _.each(step.output_connections, function (output_connection) {\n                _.each(self.steps, function (sub_step, j) {\n                    sub_step.step_index === output_connection.input_step_index && self.links[i].push(sub_step);\n                });\n            });\n        });\n\n        // convert all connected data inputs to hidden fields with proper labels,\n        // and track the linked source step\n        _.each(this.steps, function (step, i) {\n            _.each(self.steps, function (sub_step, j) {\n                var connections_by_name = {};\n                _.each(step.output_connections, function (connection) {\n                    sub_step.step_index === connection.input_step_index && (connections_by_name[connection.input_name] = connection);\n                });\n                _.each(self.parms[j], function (input, name) {\n                    var connection = connections_by_name[name];\n                    if (connection) {\n                        input.type = \"hidden\";\n                        input.help = input.step_linked ? input.help + \", \" : \"\";\n                        input.help += \"Output dataset '\" + connection.output_name + \"' from step \" + (parseInt(i) + 1);\n                        input.step_linked = input.step_linked || [];\n                        input.step_linked.push({ index: step.index, step_type: step.step_type });\n                    }\n                });\n            });\n        });\n\n        // identify and configure workflow parameters\n        var wp_count = 0;\n        this.wp_inputs = {};\n        function _handleWorkflowParameter(value, callback) {\n            var re = /\\$\\{(.+?)\\}/g;\n            var match;\n            while (match = re.exec(String(value))) {\n                var wp_name = match[1];\n                callback(self.wp_inputs[wp_name] = self.wp_inputs[wp_name] || {\n                    label: wp_name,\n                    name: wp_name,\n                    type: \"text\",\n                    color: \"hsl( \" + ++wp_count * 100 + \", 70%, 30% )\",\n                    style: \"ui-form-wp-source\",\n                    links: []\n                });\n            }\n        }\n        _.each(this.steps, function (step, i) {\n            _.each(self.parms[i], function (input, name) {\n                _handleWorkflowParameter(input.value, function (wp_input) {\n                    wp_input.links.push(step);\n                    input.wp_linked = true;\n                    input.type = \"text\";\n                    input.backdrop = true;\n                    input.style = \"ui-form-wp-target\";\n                });\n            });\n            _.each(step.post_job_actions, function (pja) {\n                _.each(pja.action_arguments, function (arg) {\n                    _handleWorkflowParameter(arg, function () {});\n                });\n            });\n        });\n\n        // select fields are shown for dynamic fields if all putative data inputs are available,\n        // or if an explicit reference is specified as data_ref and available\n        _.each(this.steps, function (step, i) {\n            if (step.step_type == \"tool\") {\n                var data_resolved = true;\n                _formData2.default.visitInputs(step.inputs, function (input, name, context) {\n                    var is_runtime_value = input.value && input.value.__class__ == \"RuntimeValue\";\n                    var is_data_input = [\"data\", \"data_collection\"].indexOf(input.type) != -1;\n                    var data_ref = context[input.data_ref];\n                    input.step_linked && !self._isDataStep(input.step_linked) && (data_resolved = false);\n                    input.options && (input.options.length == 0 && !data_resolved || input.wp_linked) && (input.is_workflow = true);\n                    data_ref && (input.is_workflow = data_ref.step_linked && !self._isDataStep(data_ref.step_linked) || input.wp_linked);\n                    (is_data_input || input.value && input.value.__class__ == \"RuntimeValue\" && !input.step_linked) && (step.collapsed = false);\n                    is_runtime_value && (input.value = input.default_value);\n                    input.flavor = \"workflow\";\n                    if (!is_runtime_value && !is_data_input && input.type !== \"hidden\" && !input.wp_linked) {\n                        if (input.optional || !_utils2.default.isEmpty(input.value) && input.value !== \"\") {\n                            input.collapsible_value = input.value;\n                            input.collapsible_preview = true;\n                        }\n                    }\n                });\n            }\n        });\n    },\n\n    render: function render() {\n        var self = this;\n        this.deferred.reset();\n        this._renderHeader();\n        this._renderMessage();\n        this._renderParameters();\n        this._renderHistory();\n        this._renderUseCachedJob();\n        _.each(this.steps, function (step) {\n            self._renderStep(step);\n        });\n    },\n\n    /** Render header */\n    _renderHeader: function _renderHeader() {\n        var self = this;\n        this.execute_btn = new _uiMisc2.default.Button({\n            icon: \"fa-check\",\n            title: (0, _localization2.default)(\"Run workflow\"),\n            cls: \"btn btn-primary\",\n            onclick: function onclick() {\n                self._execute();\n            }\n        });\n        this.$header.addClass(\"ui-form-header\").empty().append(new _uiMisc2.default.Label({\n            title: \"Workflow: \" + this.model.get(\"name\")\n        }).$el).append(this.execute_btn.$el);\n    },\n\n    /** Render message */\n    _renderMessage: function _renderMessage() {\n        this.$message.empty();\n        if (this.model.get(\"has_upgrade_messages\")) {\n            this.$message.append(new _uiMisc2.default.Message({\n                message: \"Some tools in this workflow may have changed since it was last saved or some errors were found. The workflow may still run, but any new options will have default values. Please review the messages below to make a decision about whether the changes will affect your analysis.\",\n                status: \"warning\",\n                persistent: true,\n                fade: false\n            }).$el);\n        }\n        var step_version_changes = this.model.get(\"step_version_changes\");\n        if (step_version_changes && step_version_changes.length > 0) {\n            this.$message.append(new _uiMisc2.default.Message({\n                message: \"Some tools are being executed with different versions compared to those available when this workflow was last saved because the other versions are not or no longer available on this Galaxy instance. To upgrade your workflow and dismiss this message simply edit the workflow and re-save it.\",\n                status: \"warning\",\n                persistent: true,\n                fade: false\n            }).$el);\n        }\n    },\n\n    /** Render workflow parameters */\n    _renderParameters: function _renderParameters() {\n        var self = this;\n        this.wp_form = null;\n        if (!_.isEmpty(this.wp_inputs)) {\n            this.wp_form = new _formView2.default({\n                title: \"<b>Workflow Parameters</b>\",\n                inputs: this.wp_inputs,\n                cls: \"ui-portlet-narrow\",\n                onchange: function onchange() {\n                    _.each(self.wp_form.input_list, function (input_def, i) {\n                        _.each(input_def.links, function (step) {\n                            self._refreshStep(step);\n                        });\n                    });\n                }\n            });\n            this._append(this.$steps.empty(), this.wp_form.$el);\n        }\n    },\n\n    /** Render workflow parameters */\n    _renderHistory: function _renderHistory() {\n        this.history_form = new _formView2.default({\n            cls: \"ui-portlet-narrow\",\n            title: \"<b>History Options</b>\",\n            inputs: [{\n                type: \"conditional\",\n                name: \"new_history\",\n                test_param: {\n                    name: \"check\",\n                    label: \"Send results to a new history\",\n                    type: \"boolean\",\n                    value: \"false\",\n                    help: \"\"\n                },\n                cases: [{\n                    value: \"true\",\n                    inputs: [{\n                        name: \"name\",\n                        label: \"History name\",\n                        type: \"text\",\n                        value: this.model.get(\"name\")\n                    }]\n                }]\n            }]\n        });\n        this._append(this.$steps, this.history_form.$el);\n    },\n\n    /** Render job caching option */\n    _renderUseCachedJob: function _renderUseCachedJob() {\n        var extra_user_preferences = {};\n        if (Galaxy.user.attributes.preferences && \"extra_user_preferences\" in Galaxy.user.attributes.preferences) {\n            extra_user_preferences = JSON.parse(Galaxy.user.attributes.preferences.extra_user_preferences);\n        }\n        var display_use_cached_job_checkbox = \"use_cached_job|use_cached_job_checkbox\" in extra_user_preferences ? extra_user_preferences[\"use_cached_job|use_cached_job_checkbox\"] : false;\n        this.display_use_cached_job_checkbox = display_use_cached_job_checkbox === \"true\";\n        if (this.display_use_cached_job_checkbox) {\n            this.job_options_form = new _formView2.default({\n                cls: \"ui-portlet-narrow\",\n                title: \"<b>Job re-use Options</b>\",\n                inputs: [{\n                    type: \"conditional\",\n                    name: \"use_cached_job\",\n                    test_param: {\n                        name: \"check\",\n                        label: \"BETA: Attempt to reuse jobs with identical parameters?\",\n                        type: \"boolean\",\n                        value: \"false\",\n                        help: \"This may skip executing jobs that you have already run.\"\n                    }\n                }]\n            });\n            this._append(this.$steps, this.job_options_form.$el);\n        }\n    },\n\n    /** Render step */\n    _renderStep: function _renderStep(step) {\n        var self = this;\n        var form = null;\n        this.deferred.execute(function (promise) {\n            self.$steps.addClass(\"ui-steps\");\n            if (step.step_type == \"tool\") {\n                step.postchange = function (process, form) {\n                    var self = this;\n                    var current_state = {\n                        tool_id: step.id,\n                        tool_version: step.version,\n                        inputs: $.extend(true, {}, form.data.create())\n                    };\n                    form.wait(true);\n                    Galaxy.emit.debug(\"tool-form-composite::postchange()\", \"Sending current state.\", current_state);\n                    _utils2.default.request({\n                        type: \"POST\",\n                        url: Galaxy.root + \"api/tools/\" + step.id + \"/build\",\n                        data: current_state,\n                        success: function success(data) {\n                            form.update(data);\n                            form.wait(false);\n                            Galaxy.emit.debug(\"tool-form-composite::postchange()\", \"Received new model.\", data);\n                            process.resolve();\n                        },\n                        error: function error(response) {\n                            Galaxy.emit.debug(\"tool-form-composite::postchange()\", \"Refresh request failed.\", response);\n                            process.reject();\n                        }\n                    });\n                };\n                form = new _toolFormBase2.default(step);\n                if (step.post_job_actions && step.post_job_actions.length) {\n                    form.portlet.append($(\"<div/>\").addClass(\"ui-form-element-disabled\").append($(\"<div/>\").addClass(\"ui-form-title\").html(\"<b>Job Post Actions</b>\")).append($(\"<div/>\").addClass(\"ui-form-preview\").html(_.reduce(step.post_job_actions, function (memo, value) {\n                        return memo + \" \" + value.short_str;\n                    }, \"\"))));\n                }\n            } else {\n                var is_simple_input = [\"data_input\", \"data_collection_input\"].indexOf(step.step_type) != -1;\n                _.each(step.inputs, function (input) {\n                    input.flavor = \"module\";\n                    input.hide_label = is_simple_input;\n                });\n                form = new _formView2.default(_utils2.default.merge({\n                    title: step.fixed_title,\n                    onchange: function onchange() {\n                        _.each(self.links[step.index], function (link) {\n                            self._refreshStep(link);\n                        });\n                    },\n                    inputs: step.inputs && step.inputs.length > 0 ? step.inputs : [{\n                        type: \"hidden\",\n                        name: \"No options available.\",\n                        ignore: null\n                    }]\n                }, step));\n            }\n            self.forms[step.index] = form;\n            self._append(self.$steps, form.$el);\n            self._refresh();\n            step.needs_refresh && self._refreshStep(step);\n            form.portlet[!self.show_progress ? \"enable\" : \"disable\"]();\n            self.show_progress && self.execute_btn.model.set({\n                wait: true,\n                wait_text: \"Preparing...\",\n                percentage: (step.index + 1) * 100.0 / self.steps.length\n            });\n            Galaxy.emit.debug(\"tool-form-composite::initialize()\", step.index + \" : Workflow step state ready.\", step);\n            setTimeout(function () {\n                promise.resolve();\n            }, 0);\n        });\n    },\n\n    /** Refreshes step values from source step values */\n    _refreshStep: function _refreshStep(step) {\n        var self = this;\n        var form = this.forms[step.index];\n        if (form) {\n            _.each(self.parms[step.index], function (input, name) {\n                if (input.step_linked || input.wp_linked) {\n                    var field = form.field_list[form.data.match(name)];\n                    if (field) {\n                        var new_value = undefined;\n                        if (input.step_linked) {\n                            new_value = { values: [] };\n                            _.each(input.step_linked, function (source_step) {\n                                if (self._isDataStep(source_step)) {\n                                    var value = self.forms[source_step.index].data.create().input;\n                                    value && _.each(value.values, function (v) {\n                                        new_value.values.push(v);\n                                    });\n                                }\n                            });\n                            if (!input.multiple && new_value.values.length > 0) {\n                                new_value = {\n                                    values: [new_value.values[0]]\n                                };\n                            }\n                        } else if (input.wp_linked) {\n                            new_value = input.value;\n                            var re = /\\$\\{(.+?)\\}/g;\n                            var match;\n                            while (match = re.exec(input.value)) {\n                                var wp_field = self.wp_form.field_list[self.wp_form.data.match(match[1])];\n                                var wp_value = wp_field && wp_field.value();\n                                if (wp_value) {\n                                    new_value = new_value.split(match[0]).join(wp_value);\n                                }\n                            }\n                        }\n                        if (new_value !== undefined) {\n                            field.value(new_value);\n                        }\n                    }\n                }\n            });\n            form.trigger(\"change\");\n        } else {\n            step.needs_refresh = true;\n        }\n    },\n\n    /** Refresh the history after job submission while form is shown */\n    _refreshHistory: function _refreshHistory() {\n        var self = this;\n        var history = parent.Galaxy && parent.Galaxy.currHistoryPanel && parent.Galaxy.currHistoryPanel.model;\n        this._refresh_history && clearTimeout(this._refresh_history);\n        if (history) {\n            history.refresh().success(function () {\n                if (history.numOfUnfinishedShownContents() === 0) {\n                    self._refresh_history = setTimeout(function () {\n                        self._refreshHistory();\n                    }, history.UPDATE_DELAY);\n                }\n            });\n        }\n    },\n\n    /** Build remaining steps */\n    _execute: function _execute() {\n        var self = this;\n        this.show_progress = true;\n        this._enabled(false);\n        this.deferred.execute(function (promise) {\n            setTimeout(function () {\n                promise.resolve();\n                self._submit();\n            }, 0);\n        });\n    },\n\n    /** Validate and submit workflow */\n    _submit: function _submit() {\n        var self = this;\n        var history_form_data = this.history_form.data.create();\n        var job_def = {\n            new_history_name: history_form_data[\"new_history|name\"] ? history_form_data[\"new_history|name\"] : null,\n            history_id: !history_form_data[\"new_history|name\"] ? this.model.get(\"history_id\") : null,\n            replacement_params: this.wp_form ? this.wp_form.data.create() : {},\n            parameters: {},\n            // Tool form will submit flat maps for each parameter\n            // (e.g. \"repeat_0|cond|param\": \"foo\" instead of nested\n            // data structures).\n            parameters_normalized: true,\n            // Tool form always wants a list of invocations back\n            // so that inputs can be batched.\n            batch: true\n        };\n        if (this.display_use_cached_job_checkbox) {\n            job_def[\"use_cached_job\"] = this.job_options_form.data.create()[\"use_cached_job|check\"] === \"true\";\n        }\n        var validated = true;\n        for (var i in this.forms) {\n            var form = this.forms[i];\n            var job_inputs = form.data.create();\n            var step = self.steps[i];\n            var step_index = step.step_index;\n            form.trigger(\"reset\");\n            for (var job_input_id in job_inputs) {\n                var input_value = job_inputs[job_input_id];\n                var input_id = form.data.match(job_input_id);\n                var input_field = form.field_list[input_id];\n                var input_def = form.input_list[input_id];\n                if (!input_def.step_linked) {\n                    if (this._isDataStep(step)) {\n                        validated = input_value && input_value.values && input_value.values.length > 0;\n                    } else {\n                        validated = input_def.optional || input_def.is_workflow && input_value !== \"\" || !input_def.is_workflow && input_value !== null;\n                    }\n                    if (!validated) {\n                        form.highlight(input_id);\n                        break;\n                    }\n                    job_def.parameters[step_index] = job_def.parameters[step_index] || {};\n                    job_def.parameters[step_index][job_input_id] = job_inputs[job_input_id];\n                }\n            }\n            if (!validated) {\n                break;\n            }\n        }\n        if (!validated) {\n            self._enabled(true);\n            Galaxy.emit.debug(\"tool-form-composite::submit()\", \"Validation failed.\", job_def);\n        } else {\n            Galaxy.emit.debug(\"tool-form-composite::submit()\", \"Validation complete.\", job_def);\n            _utils2.default.request({\n                type: \"POST\",\n                url: Galaxy.root + \"api/workflows/\" + this.model.id + \"/invocations\",\n                data: job_def,\n                success: function success(response) {\n                    Galaxy.emit.debug(\"tool-form-composite::submit\", \"Submission successful.\", response);\n                    self.$el.children().hide();\n                    self.$el.append(self._templateSuccess(response));\n\n                    // Show Webhook if job is running\n                    if ($.isArray(response) && response.length > 0) {\n                        self.$el.append($(\"<div/>\", { id: \"webhook-view\" }));\n                        var WebhookApp = new _webhooks2.default.WebhookView({\n                            type: \"workflow\",\n                            toolId: job_def.tool_id,\n                            toolVersion: job_def.tool_version\n                        });\n                    }\n\n                    self._refreshHistory();\n                },\n                error: function error(response) {\n                    Galaxy.emit.debug(\"tool-form-composite::submit\", \"Submission failed.\", response);\n                    var input_found = false;\n                    if (response && response.err_data) {\n                        for (var i in self.forms) {\n                            var form = self.forms[i];\n                            var step_related_errors = response.err_data[form.model.get(\"step_index\")];\n                            if (step_related_errors) {\n                                var error_messages = form.data.matchResponse(step_related_errors);\n                                for (var input_id in error_messages) {\n                                    form.highlight(input_id, error_messages[input_id]);\n                                    input_found = true;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (!input_found) {\n                        self.modal.show({\n                            title: (0, _localization2.default)(\"Workflow submission failed\"),\n                            body: self._templateError(job_def, response && response.err_msg),\n                            buttons: {\n                                Close: function Close() {\n                                    self.modal.hide();\n                                }\n                            }\n                        });\n                    }\n                },\n                complete: function complete() {\n                    self._enabled(true);\n                }\n            });\n        }\n    },\n\n    /** Append new dom to body */\n    _append: function _append($container, $el) {\n        $container.append(\"<p/>\").append($el);\n    },\n\n    /** Set enabled/disabled state */\n    _enabled: function _enabled(enabled) {\n        this.execute_btn.model.set({\n            wait: !enabled,\n            wait_text: \"Sending...\",\n            percentage: -1\n        });\n        this.wp_form && this.wp_form.portlet[enabled ? \"enable\" : \"disable\"]();\n        this.history_form && this.history_form.portlet[enabled ? \"enable\" : \"disable\"]();\n        _.each(this.forms, function (form) {\n            form && form.portlet[enabled ? \"enable\" : \"disable\"]();\n        });\n    },\n\n    /** Is data input module/step */\n    _isDataStep: function _isDataStep(steps) {\n        var lst = $.isArray(steps) ? steps : [steps];\n        for (var i = 0; i < lst.length; i++) {\n            var step = lst[i];\n            if (!step || !step.step_type || !step.step_type.startsWith(\"data\")) {\n                return false;\n            }\n        }\n        return true;\n    },\n\n    /** Templates */\n    _templateSuccess: function _templateSuccess(response) {\n        if ($.isArray(response) && response.length > 0) {\n            return $(\"<div/>\").addClass(\"donemessagelarge\").append($(\"<p/>\").html(\"Successfully invoked workflow <b>\" + _utils2.default.sanitize(this.model.get(\"name\")) + \"</b>\" + (response.length > 1 ? \" <b>\" + response.length + \" times</b>\" : \"\") + \".\")).append($(\"<p/>\").append(\"<b/>\").text(\"You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.\"));\n        } else {\n            return this._templateError(response, \"Invalid success response. No invocations found.\");\n        }\n    },\n\n    _templateError: function _templateError(response, err_msg) {\n        return $(\"<div/>\").addClass(\"errormessagelarge\").append($(\"<p/>\").text(\"The server could not complete the request. Please contact the Galaxy Team if this error persists. \" + (JSON.stringify(err_msg) || \"\"))).append($(\"<pre/>\").text(JSON.stringify(response, null, 4)));\n    }\n});\n/** This is the run workflow tool form view. */\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTM3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy90b29sL3Rvb2wtZm9ybS1jb21wb3NpdGUuanM/OWRiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFRoaXMgaXMgdGhlIHJ1biB3b3JrZmxvdyB0b29sIGZvcm0gdmlldy4gKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBEZWZlcnJlZCBmcm9tIFwidXRpbHMvZGVmZXJyZWRcIjtcbmltcG9ydCBVaSBmcm9tIFwibXZjL3VpL3VpLW1pc2NcIjtcbmltcG9ydCBGb3JtIGZyb20gXCJtdmMvZm9ybS9mb3JtLXZpZXdcIjtcbmltcG9ydCBGb3JtRGF0YSBmcm9tIFwibXZjL2Zvcm0vZm9ybS1kYXRhXCI7XG5pbXBvcnQgVG9vbEZvcm1CYXNlIGZyb20gXCJtdmMvdG9vbC90b29sLWZvcm0tYmFzZVwiO1xuaW1wb3J0IE1vZGFsIGZyb20gXCJtdmMvdWkvdWktbW9kYWxcIjtcbmltcG9ydCBXZWJob29rcyBmcm9tIFwibXZjL3dlYmhvb2tzXCI7XG5pbXBvcnQgV29ya2Zsb3dJY29ucyBmcm9tIFwibXZjL3dvcmtmbG93L3dvcmtmbG93LWljb25zXCI7XG52YXIgVmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5tb2RhbCA9IHBhcmVudC5HYWxheHkubW9kYWwgfHwgbmV3IE1vZGFsLlZpZXcoKTtcbiAgICAgICAgdGhpcy5tb2RlbCA9IChvcHRpb25zICYmIG9wdGlvbnMubW9kZWwpIHx8IG5ldyBCYWNrYm9uZS5Nb2RlbChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQoXG4gICAgICAgICAgICAkKFwiPGRpdi8+XCIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwidWktZm9ybS1jb21wb3NpdGVcIilcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCh0aGlzLiRtZXNzYWdlID0gJChcIjxkaXYvPlwiKSkpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgodGhpcy4kaGVhZGVyID0gJChcIjxkaXYvPlwiKSkpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgodGhpcy4kc3RlcHMgPSAkKFwiPGRpdi8+XCIpKSlcbiAgICAgICAgKTtcbiAgICAgICAgJChcImJvZHlcIikuYXBwZW5kKHRoaXMuJGVsKTtcbiAgICAgICAgdGhpcy5fY29uZmlndXJlKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICQod2luZG93KS5yZXNpemUoKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaCgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggaGVpZ2h0IG9mIHNjcm9sbGFibGUgZGl2IGJlbG93IGhlYWRlciwgaGFuZGxlIHNjcm9sbGluZyBieSBsYXp5IGxvYWRpbmcgc3RlcHMgKi9cbiAgICBfcmVmcmVzaDogZnVuY3Rpb24oc3RlcF9pbmRleCkge1xuICAgICAgICB2YXIgbWFyZ2luID1cbiAgICAgICAgICAgIF8ucmVkdWNlKHRoaXMuJGVsLmNoaWxkcmVuKCksIChtZW1vLCBjaGlsZCkgPT4gbWVtbyArICQoY2hpbGQpLm91dGVySGVpZ2h0KCksIDApIC1cbiAgICAgICAgICAgIHRoaXMuJHN0ZXBzLmhlaWdodCgpICtcbiAgICAgICAgICAgIDkwO1xuICAgICAgICB0aGlzLiRzdGVwcy5jc3MoXCJoZWlnaHRcIiwgJCh3aW5kb3cpLmhlaWdodCgpIC0gbWFyZ2luKTtcbiAgICB9LFxuXG4gICAgLyoqIENvbmZpZ3VyZXMgZm9ybS9zdGVwIG9wdGlvbnMgZm9yIGVhY2ggd29ya2Zsb3cgc3RlcCAqL1xuICAgIF9jb25maWd1cmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZm9ybXMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGVwcyA9IFtdO1xuICAgICAgICB0aGlzLmxpbmtzID0gW107XG4gICAgICAgIHRoaXMucGFybXMgPSBbXTtcbiAgICAgICAgXy5lYWNoKHRoaXMubW9kZWwuZ2V0KFwic3RlcHNcIiksIChzdGVwLCBpKSA9PiB7XG4gICAgICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInRvb2wtZm9ybS1jb21wb3NpdGU6OmluaXRpYWxpemUoKVwiLCBgJHtpfSA6IFByZXBhcmluZyB3b3JrZmxvdyBzdGVwLmApO1xuICAgICAgICAgICAgdmFyIGljb24gPSBXb3JrZmxvd0ljb25zW3N0ZXAuc3RlcF90eXBlXTtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IGAke3BhcnNlSW50KGkgKyAxKX06ICR7c3RlcC5zdGVwX2xhYmVsIHx8IHN0ZXAuc3RlcF9uYW1lfWA7XG4gICAgICAgICAgICBpZiAoc3RlcC5hbm5vdGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGl0bGUgKz0gYCAtICR7c3RlcC5hbm5vdGF0aW9ufWA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RlcC5zdGVwX3ZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aXRsZSArPSBgIChHYWxheHkgVmVyc2lvbiAke3N0ZXAuc3RlcF92ZXJzaW9ufSlgO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RlcCA9IFV0aWxzLm1lcmdlKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgIGZpeGVkX3RpdGxlOiBfLmVzY2FwZSh0aXRsZSksXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb24gfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgaGVscDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgY2l0YXRpb25zOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29sbGFwc2VkOiBpID4gMCAmJiAhc2VsZi5faXNEYXRhU3RlcChzdGVwKSxcbiAgICAgICAgICAgICAgICAgICAgc3VzdGFpbl92ZXJzaW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdXN0YWluX3JlcGVhdHM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHN1c3RhaW5fY29uZGl0aW9uYWxzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBuYXJyb3c6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHRleHRfZW5hYmxlOiBcIkVkaXRcIixcbiAgICAgICAgICAgICAgICAgICAgdGV4dF9kaXNhYmxlOiBcIlVuZG9cIixcbiAgICAgICAgICAgICAgICAgICAgY2xzX2VuYWJsZTogXCJmYSBmYS1lZGl0XCIsXG4gICAgICAgICAgICAgICAgICAgIGNsc19kaXNhYmxlOiBcImZhIGZhLXVuZG9cIixcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzOiBzdGVwLm1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICBpbml0aWFsX2Vycm9yczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY2xzOiBcInVpLXBvcnRsZXQtbmFycm93XCIsXG4gICAgICAgICAgICAgICAgICAgIGhpZGVfb3BlcmF0aW9uczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgbmVlZHNfcmVmcmVzaDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGFsd2F5c19yZWZyZXNoOiBzdGVwLnN0ZXBfdHlwZSAhPSBcInRvb2xcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3RlcFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNlbGYuc3RlcHNbaV0gPSBzdGVwO1xuICAgICAgICAgICAgc2VsZi5saW5rc1tpXSA9IFtdO1xuICAgICAgICAgICAgc2VsZi5wYXJtc1tpXSA9IHt9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBidWlsZCBsaW5lYXIgaW5kZXggb2Ygc3RlcCBpbnB1dCBwYWlyc1xuICAgICAgICBfLmVhY2godGhpcy5zdGVwcywgKHN0ZXAsIGkpID0+IHtcbiAgICAgICAgICAgIEZvcm1EYXRhLnZpc2l0SW5wdXRzKHN0ZXAuaW5wdXRzLCAoaW5wdXQsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLnBhcm1zW2ldW25hbWVdID0gaW5wdXQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaXRlcmF0ZSB0aHJvdWdoIGRhdGEgaW5wdXQgbW9kdWxlcyBhbmQgY29sbGVjdCBsaW5rZWQgc3ViIHN0ZXBzXG4gICAgICAgIF8uZWFjaCh0aGlzLnN0ZXBzLCAoc3RlcCwgaSkgPT4ge1xuICAgICAgICAgICAgXy5lYWNoKHN0ZXAub3V0cHV0X2Nvbm5lY3Rpb25zLCBvdXRwdXRfY29ubmVjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgXy5lYWNoKHNlbGYuc3RlcHMsIChzdWJfc3RlcCwgaikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzdWJfc3RlcC5zdGVwX2luZGV4ID09PSBvdXRwdXRfY29ubmVjdGlvbi5pbnB1dF9zdGVwX2luZGV4ICYmIHNlbGYubGlua3NbaV0ucHVzaChzdWJfc3RlcCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gY29udmVydCBhbGwgY29ubmVjdGVkIGRhdGEgaW5wdXRzIHRvIGhpZGRlbiBmaWVsZHMgd2l0aCBwcm9wZXIgbGFiZWxzLFxuICAgICAgICAvLyBhbmQgdHJhY2sgdGhlIGxpbmtlZCBzb3VyY2Ugc3RlcFxuICAgICAgICBfLmVhY2godGhpcy5zdGVwcywgKHN0ZXAsIGkpID0+IHtcbiAgICAgICAgICAgIF8uZWFjaChzZWxmLnN0ZXBzLCAoc3ViX3N0ZXAsIGopID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgY29ubmVjdGlvbnNfYnlfbmFtZSA9IHt9O1xuICAgICAgICAgICAgICAgIF8uZWFjaChzdGVwLm91dHB1dF9jb25uZWN0aW9ucywgY29ubmVjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Yl9zdGVwLnN0ZXBfaW5kZXggPT09IGNvbm5lY3Rpb24uaW5wdXRfc3RlcF9pbmRleCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKGNvbm5lY3Rpb25zX2J5X25hbWVbY29ubmVjdGlvbi5pbnB1dF9uYW1lXSA9IGNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8uZWFjaChzZWxmLnBhcm1zW2pdLCAoaW5wdXQsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBjb25uZWN0aW9uc19ieV9uYW1lW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQudHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5oZWxwID0gaW5wdXQuc3RlcF9saW5rZWQgPyBgJHtpbnB1dC5oZWxwfSwgYCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5oZWxwICs9IGBPdXRwdXQgZGF0YXNldCAnJHtjb25uZWN0aW9uLm91dHB1dF9uYW1lfScgZnJvbSBzdGVwICR7cGFyc2VJbnQoaSkgKyAxfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5zdGVwX2xpbmtlZCA9IGlucHV0LnN0ZXBfbGlua2VkIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuc3RlcF9saW5rZWQucHVzaCh7IGluZGV4OiBzdGVwLmluZGV4LCBzdGVwX3R5cGU6IHN0ZXAuc3RlcF90eXBlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaWRlbnRpZnkgYW5kIGNvbmZpZ3VyZSB3b3JrZmxvdyBwYXJhbWV0ZXJzXG4gICAgICAgIHZhciB3cF9jb3VudCA9IDA7XG4gICAgICAgIHRoaXMud3BfaW5wdXRzID0ge307XG4gICAgICAgIGZ1bmN0aW9uIF9oYW5kbGVXb3JrZmxvd1BhcmFtZXRlcih2YWx1ZSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciByZSA9IC9cXCRcXHsoLis/KVxcfS9nO1xuICAgICAgICAgICAgdmFyIG1hdGNoO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlLmV4ZWMoU3RyaW5nKHZhbHVlKSkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdwX25hbWUgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhcbiAgICAgICAgICAgICAgICAgICAgKHNlbGYud3BfaW5wdXRzW3dwX25hbWVdID0gc2VsZi53cF9pbnB1dHNbd3BfbmFtZV0gfHwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHdwX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB3cF9uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogYGhzbCggJHsrK3dwX2NvdW50ICogMTAwfSwgNzAlLCAzMCUgKWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogXCJ1aS1mb3JtLXdwLXNvdXJjZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGlua3M6IFtdXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBfLmVhY2godGhpcy5zdGVwcywgKHN0ZXAsIGkpID0+IHtcbiAgICAgICAgICAgIF8uZWFjaChzZWxmLnBhcm1zW2ldLCAoaW5wdXQsIG5hbWUpID0+IHtcbiAgICAgICAgICAgICAgICBfaGFuZGxlV29ya2Zsb3dQYXJhbWV0ZXIoaW5wdXQudmFsdWUsIHdwX2lucHV0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd3BfaW5wdXQubGlua3MucHVzaChzdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQud3BfbGlua2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5iYWNrZHJvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LnN0eWxlID0gXCJ1aS1mb3JtLXdwLXRhcmdldFwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfLmVhY2goc3RlcC5wb3N0X2pvYl9hY3Rpb25zLCBwamEgPT4ge1xuICAgICAgICAgICAgICAgIF8uZWFjaChwamEuYWN0aW9uX2FyZ3VtZW50cywgYXJnID0+IHtcbiAgICAgICAgICAgICAgICAgICAgX2hhbmRsZVdvcmtmbG93UGFyYW1ldGVyKGFyZywgKCkgPT4ge30pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHNlbGVjdCBmaWVsZHMgYXJlIHNob3duIGZvciBkeW5hbWljIGZpZWxkcyBpZiBhbGwgcHV0YXRpdmUgZGF0YSBpbnB1dHMgYXJlIGF2YWlsYWJsZSxcbiAgICAgICAgLy8gb3IgaWYgYW4gZXhwbGljaXQgcmVmZXJlbmNlIGlzIHNwZWNpZmllZCBhcyBkYXRhX3JlZiBhbmQgYXZhaWxhYmxlXG4gICAgICAgIF8uZWFjaCh0aGlzLnN0ZXBzLCAoc3RlcCwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKHN0ZXAuc3RlcF90eXBlID09IFwidG9vbFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFfcmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIEZvcm1EYXRhLnZpc2l0SW5wdXRzKHN0ZXAuaW5wdXRzLCAoaW5wdXQsIG5hbWUsIGNvbnRleHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX3J1bnRpbWVfdmFsdWUgPSBpbnB1dC52YWx1ZSAmJiBpbnB1dC52YWx1ZS5fX2NsYXNzX18gPT0gXCJSdW50aW1lVmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX2RhdGFfaW5wdXQgPSBbXCJkYXRhXCIsIFwiZGF0YV9jb2xsZWN0aW9uXCJdLmluZGV4T2YoaW5wdXQudHlwZSkgIT0gLTE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhX3JlZiA9IGNvbnRleHRbaW5wdXQuZGF0YV9yZWZdO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5zdGVwX2xpbmtlZCAmJiAhc2VsZi5faXNEYXRhU3RlcChpbnB1dC5zdGVwX2xpbmtlZCkgJiYgKGRhdGFfcmVzb2x2ZWQgPSBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0Lm9wdGlvbnMgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICgoaW5wdXQub3B0aW9ucy5sZW5ndGggPT0gMCAmJiAhZGF0YV9yZXNvbHZlZCkgfHwgaW5wdXQud3BfbGlua2VkKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKGlucHV0LmlzX3dvcmtmbG93ID0gdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfcmVmICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAoaW5wdXQuaXNfd29ya2Zsb3cgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkYXRhX3JlZi5zdGVwX2xpbmtlZCAmJiAhc2VsZi5faXNEYXRhU3RlcChkYXRhX3JlZi5zdGVwX2xpbmtlZCkpIHx8IGlucHV0LndwX2xpbmtlZCk7XG4gICAgICAgICAgICAgICAgICAgIChpc19kYXRhX2lucHV0IHx8IChpbnB1dC52YWx1ZSAmJiBpbnB1dC52YWx1ZS5fX2NsYXNzX18gPT0gXCJSdW50aW1lVmFsdWVcIiAmJiAhaW5wdXQuc3RlcF9saW5rZWQpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKHN0ZXAuY29sbGFwc2VkID0gZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBpc19ydW50aW1lX3ZhbHVlICYmIChpbnB1dC52YWx1ZSA9IGlucHV0LmRlZmF1bHRfdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5mbGF2b3IgPSBcIndvcmtmbG93XCI7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNfcnVudGltZV92YWx1ZSAmJiAhaXNfZGF0YV9pbnB1dCAmJiBpbnB1dC50eXBlICE9PSBcImhpZGRlblwiICYmICFpbnB1dC53cF9saW5rZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5vcHRpb25hbCB8fCAoIVV0aWxzLmlzRW1wdHkoaW5wdXQudmFsdWUpICYmIGlucHV0LnZhbHVlICE9PSBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmNvbGxhcHNpYmxlX3ZhbHVlID0gaW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuY29sbGFwc2libGVfcHJldmlldyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5kZWZlcnJlZC5yZXNldCgpO1xuICAgICAgICB0aGlzLl9yZW5kZXJIZWFkZXIoKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyTWVzc2FnZSgpO1xuICAgICAgICB0aGlzLl9yZW5kZXJQYXJhbWV0ZXJzKCk7XG4gICAgICAgIHRoaXMuX3JlbmRlckhpc3RvcnkoKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyVXNlQ2FjaGVkSm9iKCk7XG4gICAgICAgIF8uZWFjaCh0aGlzLnN0ZXBzLCBzdGVwID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlbmRlclN0ZXAoc3RlcCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogUmVuZGVyIGhlYWRlciAqL1xuICAgIF9yZW5kZXJIZWFkZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZXhlY3V0ZV9idG4gPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGljb246IFwiZmEtY2hlY2tcIixcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIlJ1biB3b3JrZmxvd1wiKSxcbiAgICAgICAgICAgIGNsczogXCJidG4gYnRuLXByaW1hcnlcIixcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V4ZWN1dGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuJGhlYWRlclxuICAgICAgICAgICAgLmFkZENsYXNzKFwidWktZm9ybS1oZWFkZXJcIilcbiAgICAgICAgICAgIC5lbXB0eSgpXG4gICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgIG5ldyBVaS5MYWJlbCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBgV29ya2Zsb3c6ICR7dGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpfWBcbiAgICAgICAgICAgICAgICB9KS4kZWxcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hcHBlbmQodGhpcy5leGVjdXRlX2J0bi4kZWwpO1xuICAgIH0sXG5cbiAgICAvKiogUmVuZGVyIG1lc3NhZ2UgKi9cbiAgICBfcmVuZGVyTWVzc2FnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJG1lc3NhZ2UuZW1wdHkoKTtcbiAgICAgICAgaWYgKHRoaXMubW9kZWwuZ2V0KFwiaGFzX3VwZ3JhZGVfbWVzc2FnZXNcIikpIHtcbiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuYXBwZW5kKFxuICAgICAgICAgICAgICAgIG5ldyBVaS5NZXNzYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiU29tZSB0b29scyBpbiB0aGlzIHdvcmtmbG93IG1heSBoYXZlIGNoYW5nZWQgc2luY2UgaXQgd2FzIGxhc3Qgc2F2ZWQgb3Igc29tZSBlcnJvcnMgd2VyZSBmb3VuZC4gVGhlIHdvcmtmbG93IG1heSBzdGlsbCBydW4sIGJ1dCBhbnkgbmV3IG9wdGlvbnMgd2lsbCBoYXZlIGRlZmF1bHQgdmFsdWVzLiBQbGVhc2UgcmV2aWV3IHRoZSBtZXNzYWdlcyBiZWxvdyB0byBtYWtlIGEgZGVjaXNpb24gYWJvdXQgd2hldGhlciB0aGUgY2hhbmdlcyB3aWxsIGFmZmVjdCB5b3VyIGFuYWx5c2lzLlwiLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwid2FybmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmYWRlOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pLiRlbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RlcF92ZXJzaW9uX2NoYW5nZXMgPSB0aGlzLm1vZGVsLmdldChcInN0ZXBfdmVyc2lvbl9jaGFuZ2VzXCIpO1xuICAgICAgICBpZiAoc3RlcF92ZXJzaW9uX2NoYW5nZXMgJiYgc3RlcF92ZXJzaW9uX2NoYW5nZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5hcHBlbmQoXG4gICAgICAgICAgICAgICAgbmV3IFVpLk1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOlxuICAgICAgICAgICAgICAgICAgICAgICAgXCJTb21lIHRvb2xzIGFyZSBiZWluZyBleGVjdXRlZCB3aXRoIGRpZmZlcmVudCB2ZXJzaW9ucyBjb21wYXJlZCB0byB0aG9zZSBhdmFpbGFibGUgd2hlbiB0aGlzIHdvcmtmbG93IHdhcyBsYXN0IHNhdmVkIGJlY2F1c2UgdGhlIG90aGVyIHZlcnNpb25zIGFyZSBub3Qgb3Igbm8gbG9uZ2VyIGF2YWlsYWJsZSBvbiB0aGlzIEdhbGF4eSBpbnN0YW5jZS4gVG8gdXBncmFkZSB5b3VyIHdvcmtmbG93IGFuZCBkaXNtaXNzIHRoaXMgbWVzc2FnZSBzaW1wbHkgZWRpdCB0aGUgd29ya2Zsb3cgYW5kIHJlLXNhdmUgaXQuXCIsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJ3YXJuaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlbnQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZhZGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSkuJGVsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgd29ya2Zsb3cgcGFyYW1ldGVycyAqL1xuICAgIF9yZW5kZXJQYXJhbWV0ZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLndwX2Zvcm0gPSBudWxsO1xuICAgICAgICBpZiAoIV8uaXNFbXB0eSh0aGlzLndwX2lucHV0cykpIHtcbiAgICAgICAgICAgIHRoaXMud3BfZm9ybSA9IG5ldyBGb3JtKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogXCI8Yj5Xb3JrZmxvdyBQYXJhbWV0ZXJzPC9iPlwiLFxuICAgICAgICAgICAgICAgIGlucHV0czogdGhpcy53cF9pbnB1dHMsXG4gICAgICAgICAgICAgICAgY2xzOiBcInVpLXBvcnRsZXQtbmFycm93XCIsXG4gICAgICAgICAgICAgICAgb25jaGFuZ2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBfLmVhY2goc2VsZi53cF9mb3JtLmlucHV0X2xpc3QsIChpbnB1dF9kZWYsIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChpbnB1dF9kZWYubGlua3MsIHN0ZXAgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hTdGVwKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fYXBwZW5kKHRoaXMuJHN0ZXBzLmVtcHR5KCksIHRoaXMud3BfZm9ybS4kZWwpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgd29ya2Zsb3cgcGFyYW1ldGVycyAqL1xuICAgIF9yZW5kZXJIaXN0b3J5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5oaXN0b3J5X2Zvcm0gPSBuZXcgRm9ybSh7XG4gICAgICAgICAgICBjbHM6IFwidWktcG9ydGxldC1uYXJyb3dcIixcbiAgICAgICAgICAgIHRpdGxlOiBcIjxiPkhpc3RvcnkgT3B0aW9uczwvYj5cIixcbiAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJjb25kaXRpb25hbFwiLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIm5ld19oaXN0b3J5XCIsXG4gICAgICAgICAgICAgICAgICAgIHRlc3RfcGFyYW06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiY2hlY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIlNlbmQgcmVzdWx0cyB0byBhIG5ldyBoaXN0b3J5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcImZhbHNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNhc2VzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwidHJ1ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIm5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkhpc3RvcnkgbmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hcHBlbmQodGhpcy4kc3RlcHMsIHRoaXMuaGlzdG9yeV9mb3JtLiRlbCk7XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgam9iIGNhY2hpbmcgb3B0aW9uICovXG4gICAgX3JlbmRlclVzZUNhY2hlZEpvYjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBleHRyYV91c2VyX3ByZWZlcmVuY2VzID0ge307XG4gICAgICAgIGlmIChHYWxheHkudXNlci5hdHRyaWJ1dGVzLnByZWZlcmVuY2VzICYmIFwiZXh0cmFfdXNlcl9wcmVmZXJlbmNlc1wiIGluIEdhbGF4eS51c2VyLmF0dHJpYnV0ZXMucHJlZmVyZW5jZXMpIHtcbiAgICAgICAgICAgIGV4dHJhX3VzZXJfcHJlZmVyZW5jZXMgPSBKU09OLnBhcnNlKEdhbGF4eS51c2VyLmF0dHJpYnV0ZXMucHJlZmVyZW5jZXMuZXh0cmFfdXNlcl9wcmVmZXJlbmNlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRpc3BsYXlfdXNlX2NhY2hlZF9qb2JfY2hlY2tib3ggPVxuICAgICAgICAgICAgXCJ1c2VfY2FjaGVkX2pvYnx1c2VfY2FjaGVkX2pvYl9jaGVja2JveFwiIGluIGV4dHJhX3VzZXJfcHJlZmVyZW5jZXNcbiAgICAgICAgICAgICAgICA/IGV4dHJhX3VzZXJfcHJlZmVyZW5jZXNbXCJ1c2VfY2FjaGVkX2pvYnx1c2VfY2FjaGVkX2pvYl9jaGVja2JveFwiXVxuICAgICAgICAgICAgICAgIDogZmFsc2U7XG4gICAgICAgIHRoaXMuZGlzcGxheV91c2VfY2FjaGVkX2pvYl9jaGVja2JveCA9IGRpc3BsYXlfdXNlX2NhY2hlZF9qb2JfY2hlY2tib3ggPT09IFwidHJ1ZVwiO1xuICAgICAgICBpZiAodGhpcy5kaXNwbGF5X3VzZV9jYWNoZWRfam9iX2NoZWNrYm94KSB7XG4gICAgICAgICAgICB0aGlzLmpvYl9vcHRpb25zX2Zvcm0gPSBuZXcgRm9ybSh7XG4gICAgICAgICAgICAgICAgY2xzOiBcInVpLXBvcnRsZXQtbmFycm93XCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiPGI+Sm9iIHJlLXVzZSBPcHRpb25zPC9iPlwiLFxuICAgICAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImNvbmRpdGlvbmFsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInVzZV9jYWNoZWRfam9iXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXN0X3BhcmFtOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJjaGVja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkJFVEE6IEF0dGVtcHQgdG8gcmV1c2Ugam9icyB3aXRoIGlkZW50aWNhbCBwYXJhbWV0ZXJzP1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcImZhbHNlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscDogXCJUaGlzIG1heSBza2lwIGV4ZWN1dGluZyBqb2JzIHRoYXQgeW91IGhhdmUgYWxyZWFkeSBydW4uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fYXBwZW5kKHRoaXMuJHN0ZXBzLCB0aGlzLmpvYl9vcHRpb25zX2Zvcm0uJGVsKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogUmVuZGVyIHN0ZXAgKi9cbiAgICBfcmVuZGVyU3RlcDogZnVuY3Rpb24oc3RlcCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JtID0gbnVsbDtcbiAgICAgICAgdGhpcy5kZWZlcnJlZC5leGVjdXRlKHByb21pc2UgPT4ge1xuICAgICAgICAgICAgc2VsZi4kc3RlcHMuYWRkQ2xhc3MoXCJ1aS1zdGVwc1wiKTtcbiAgICAgICAgICAgIGlmIChzdGVwLnN0ZXBfdHlwZSA9PSBcInRvb2xcIikge1xuICAgICAgICAgICAgICAgIHN0ZXAucG9zdGNoYW5nZSA9IGZ1bmN0aW9uKHByb2Nlc3MsIGZvcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudF9zdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvb2xfaWQ6IHN0ZXAuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b29sX3ZlcnNpb246IHN0ZXAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0czogJC5leHRlbmQodHJ1ZSwge30sIGZvcm0uZGF0YS5jcmVhdGUoKSlcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybS53YWl0KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInRvb2wtZm9ybS1jb21wb3NpdGU6OnBvc3RjaGFuZ2UoKVwiLCBcIlNlbmRpbmcgY3VycmVudCBzdGF0ZS5cIiwgY3VycmVudF9zdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIFV0aWxzLnJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWFwaS90b29scy8ke3N0ZXAuaWR9L2J1aWxkYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGN1cnJlbnRfc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS51cGRhdGUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS53YWl0KGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInRvb2wtZm9ybS1jb21wb3NpdGU6OnBvc3RjaGFuZ2UoKVwiLCBcIlJlY2VpdmVkIG5ldyBtb2RlbC5cIiwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FsYXh5LmVtaXQuZGVidWcoXCJ0b29sLWZvcm0tY29tcG9zaXRlOjpwb3N0Y2hhbmdlKClcIiwgXCJSZWZyZXNoIHJlcXVlc3QgZmFpbGVkLlwiLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5yZWplY3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmb3JtID0gbmV3IFRvb2xGb3JtQmFzZShzdGVwKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RlcC5wb3N0X2pvYl9hY3Rpb25zICYmIHN0ZXAucG9zdF9qb2JfYWN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybS5wb3J0bGV0LmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCI8ZGl2Lz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1mb3JtLWVsZW1lbnQtZGlzYWJsZWRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiPGRpdi8+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1mb3JtLXRpdGxlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHRtbChcIjxiPkpvYiBQb3N0IEFjdGlvbnM8L2I+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCI8ZGl2Lz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInVpLWZvcm0tcHJldmlld1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXy5yZWR1Y2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAucG9zdF9qb2JfYWN0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG1lbW8sIHZhbHVlKSA9PiBgJHttZW1vfSAke3ZhbHVlLnNob3J0X3N0cn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBpc19zaW1wbGVfaW5wdXQgPSBbXCJkYXRhX2lucHV0XCIsIFwiZGF0YV9jb2xsZWN0aW9uX2lucHV0XCJdLmluZGV4T2Yoc3RlcC5zdGVwX3R5cGUpICE9IC0xO1xuICAgICAgICAgICAgICAgIF8uZWFjaChzdGVwLmlucHV0cywgaW5wdXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5mbGF2b3IgPSBcIm1vZHVsZVwiO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5oaWRlX2xhYmVsID0gaXNfc2ltcGxlX2lucHV0O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvcm0gPSBuZXcgRm9ybShcbiAgICAgICAgICAgICAgICAgICAgVXRpbHMubWVyZ2UoXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHN0ZXAuZml4ZWRfdGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmVhY2goc2VsZi5saW5rc1tzdGVwLmluZGV4XSwgbGluayA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9yZWZyZXNoU3RlcChsaW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAuaW5wdXRzICYmIHN0ZXAuaW5wdXRzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gc3RlcC5pbnB1dHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaGlkZGVuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJObyBvcHRpb25zIGF2YWlsYWJsZS5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZ25vcmU6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmZvcm1zW3N0ZXAuaW5kZXhdID0gZm9ybTtcbiAgICAgICAgICAgIHNlbGYuX2FwcGVuZChzZWxmLiRzdGVwcywgZm9ybS4kZWwpO1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaCgpO1xuICAgICAgICAgICAgc3RlcC5uZWVkc19yZWZyZXNoICYmIHNlbGYuX3JlZnJlc2hTdGVwKHN0ZXApO1xuICAgICAgICAgICAgZm9ybS5wb3J0bGV0WyFzZWxmLnNob3dfcHJvZ3Jlc3MgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgICAgICBzZWxmLnNob3dfcHJvZ3Jlc3MgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmV4ZWN1dGVfYnRuLm1vZGVsLnNldCh7XG4gICAgICAgICAgICAgICAgICAgIHdhaXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHdhaXRfdGV4dDogXCJQcmVwYXJpbmcuLi5cIixcbiAgICAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogKHN0ZXAuaW5kZXggKyAxKSAqIDEwMC4wIC8gc2VsZi5zdGVwcy5sZW5ndGhcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIEdhbGF4eS5lbWl0LmRlYnVnKFwidG9vbC1mb3JtLWNvbXBvc2l0ZTo6aW5pdGlhbGl6ZSgpXCIsIGAke3N0ZXAuaW5kZXh9IDogV29ya2Zsb3cgc3RlcCBzdGF0ZSByZWFkeS5gLCBzdGVwKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogUmVmcmVzaGVzIHN0ZXAgdmFsdWVzIGZyb20gc291cmNlIHN0ZXAgdmFsdWVzICovXG4gICAgX3JlZnJlc2hTdGVwOiBmdW5jdGlvbihzdGVwKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGZvcm0gPSB0aGlzLmZvcm1zW3N0ZXAuaW5kZXhdO1xuICAgICAgICBpZiAoZm9ybSkge1xuICAgICAgICAgICAgXy5lYWNoKHNlbGYucGFybXNbc3RlcC5pbmRleF0sIChpbnB1dCwgbmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dC5zdGVwX2xpbmtlZCB8fCBpbnB1dC53cF9saW5rZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gZm9ybS5maWVsZF9saXN0W2Zvcm0uZGF0YS5tYXRjaChuYW1lKV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld192YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5zdGVwX2xpbmtlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld192YWx1ZSA9IHsgdmFsdWVzOiBbXSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaChpbnB1dC5zdGVwX2xpbmtlZCwgc291cmNlX3N0ZXAgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5faXNEYXRhU3RlcChzb3VyY2Vfc3RlcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNlbGYuZm9ybXNbc291cmNlX3N0ZXAuaW5kZXhdLmRhdGEuY3JlYXRlKCkuaW5wdXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF8uZWFjaCh2YWx1ZS52YWx1ZXMsIHYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfdmFsdWUudmFsdWVzLnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlucHV0Lm11bHRpcGxlICYmIG5ld192YWx1ZS52YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IFtuZXdfdmFsdWUudmFsdWVzWzBdXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXQud3BfbGlua2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3ZhbHVlID0gaW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlID0gL1xcJFxceyguKz8pXFx9L2c7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgobWF0Y2ggPSByZS5leGVjKGlucHV0LnZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdwX2ZpZWxkID0gc2VsZi53cF9mb3JtLmZpZWxkX2xpc3Rbc2VsZi53cF9mb3JtLmRhdGEubWF0Y2gobWF0Y2hbMV0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdwX3ZhbHVlID0gd3BfZmllbGQgJiYgd3BfZmllbGQudmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdwX3ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfdmFsdWUgPSBuZXdfdmFsdWUuc3BsaXQobWF0Y2hbMF0pLmpvaW4od3BfdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld192YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQudmFsdWUobmV3X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9ybS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RlcC5uZWVkc19yZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogUmVmcmVzaCB0aGUgaGlzdG9yeSBhZnRlciBqb2Igc3VibWlzc2lvbiB3aGlsZSBmb3JtIGlzIHNob3duICovXG4gICAgX3JlZnJlc2hIaXN0b3J5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaGlzdG9yeSA9IHBhcmVudC5HYWxheHkgJiYgcGFyZW50LkdhbGF4eS5jdXJySGlzdG9yeVBhbmVsICYmIHBhcmVudC5HYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5tb2RlbDtcbiAgICAgICAgdGhpcy5fcmVmcmVzaF9oaXN0b3J5ICYmIGNsZWFyVGltZW91dCh0aGlzLl9yZWZyZXNoX2hpc3RvcnkpO1xuICAgICAgICBpZiAoaGlzdG9yeSkge1xuICAgICAgICAgICAgaGlzdG9yeS5yZWZyZXNoKCkuc3VjY2VzcygoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGhpc3RvcnkubnVtT2ZVbmZpbmlzaGVkU2hvd25Db250ZW50cygpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hfaGlzdG9yeSA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcmVmcmVzaEhpc3RvcnkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgaGlzdG9yeS5VUERBVEVfREVMQVkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBCdWlsZCByZW1haW5pbmcgc3RlcHMgKi9cbiAgICBfZXhlY3V0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zaG93X3Byb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fZW5hYmxlZChmYWxzZSk7XG4gICAgICAgIHRoaXMuZGVmZXJyZWQuZXhlY3V0ZShwcm9taXNlID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgIHNlbGYuX3N1Ym1pdCgpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogVmFsaWRhdGUgYW5kIHN1Ym1pdCB3b3JrZmxvdyAqL1xuICAgIF9zdWJtaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBoaXN0b3J5X2Zvcm1fZGF0YSA9IHRoaXMuaGlzdG9yeV9mb3JtLmRhdGEuY3JlYXRlKCk7XG4gICAgICAgIHZhciBqb2JfZGVmID0ge1xuICAgICAgICAgICAgbmV3X2hpc3RvcnlfbmFtZTogaGlzdG9yeV9mb3JtX2RhdGFbXCJuZXdfaGlzdG9yeXxuYW1lXCJdID8gaGlzdG9yeV9mb3JtX2RhdGFbXCJuZXdfaGlzdG9yeXxuYW1lXCJdIDogbnVsbCxcbiAgICAgICAgICAgIGhpc3RvcnlfaWQ6ICFoaXN0b3J5X2Zvcm1fZGF0YVtcIm5ld19oaXN0b3J5fG5hbWVcIl0gPyB0aGlzLm1vZGVsLmdldChcImhpc3RvcnlfaWRcIikgOiBudWxsLFxuICAgICAgICAgICAgcmVwbGFjZW1lbnRfcGFyYW1zOiB0aGlzLndwX2Zvcm0gPyB0aGlzLndwX2Zvcm0uZGF0YS5jcmVhdGUoKSA6IHt9LFxuICAgICAgICAgICAgcGFyYW1ldGVyczoge30sXG4gICAgICAgICAgICAvLyBUb29sIGZvcm0gd2lsbCBzdWJtaXQgZmxhdCBtYXBzIGZvciBlYWNoIHBhcmFtZXRlclxuICAgICAgICAgICAgLy8gKGUuZy4gXCJyZXBlYXRfMHxjb25kfHBhcmFtXCI6IFwiZm9vXCIgaW5zdGVhZCBvZiBuZXN0ZWRcbiAgICAgICAgICAgIC8vIGRhdGEgc3RydWN0dXJlcykuXG4gICAgICAgICAgICBwYXJhbWV0ZXJzX25vcm1hbGl6ZWQ6IHRydWUsXG4gICAgICAgICAgICAvLyBUb29sIGZvcm0gYWx3YXlzIHdhbnRzIGEgbGlzdCBvZiBpbnZvY2F0aW9ucyBiYWNrXG4gICAgICAgICAgICAvLyBzbyB0aGF0IGlucHV0cyBjYW4gYmUgYmF0Y2hlZC5cbiAgICAgICAgICAgIGJhdGNoOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlfdXNlX2NhY2hlZF9qb2JfY2hlY2tib3gpIHtcbiAgICAgICAgICAgIGpvYl9kZWZbXCJ1c2VfY2FjaGVkX2pvYlwiXSA9IHRoaXMuam9iX29wdGlvbnNfZm9ybS5kYXRhLmNyZWF0ZSgpW1widXNlX2NhY2hlZF9qb2J8Y2hlY2tcIl0gPT09IFwidHJ1ZVwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWxpZGF0ZWQgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBpIGluIHRoaXMuZm9ybXMpIHtcbiAgICAgICAgICAgIHZhciBmb3JtID0gdGhpcy5mb3Jtc1tpXTtcbiAgICAgICAgICAgIHZhciBqb2JfaW5wdXRzID0gZm9ybS5kYXRhLmNyZWF0ZSgpO1xuICAgICAgICAgICAgdmFyIHN0ZXAgPSBzZWxmLnN0ZXBzW2ldO1xuICAgICAgICAgICAgdmFyIHN0ZXBfaW5kZXggPSBzdGVwLnN0ZXBfaW5kZXg7XG4gICAgICAgICAgICBmb3JtLnRyaWdnZXIoXCJyZXNldFwiKTtcbiAgICAgICAgICAgIGZvciAodmFyIGpvYl9pbnB1dF9pZCBpbiBqb2JfaW5wdXRzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0X3ZhbHVlID0gam9iX2lucHV0c1tqb2JfaW5wdXRfaWRdO1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dF9pZCA9IGZvcm0uZGF0YS5tYXRjaChqb2JfaW5wdXRfaWQpO1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dF9maWVsZCA9IGZvcm0uZmllbGRfbGlzdFtpbnB1dF9pZF07XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0X2RlZiA9IGZvcm0uaW5wdXRfbGlzdFtpbnB1dF9pZF07XG4gICAgICAgICAgICAgICAgaWYgKCFpbnB1dF9kZWYuc3RlcF9saW5rZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzRGF0YVN0ZXAoc3RlcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9IGlucHV0X3ZhbHVlICYmIGlucHV0X3ZhbHVlLnZhbHVlcyAmJiBpbnB1dF92YWx1ZS52YWx1ZXMubGVuZ3RoID4gMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRlZCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRfZGVmLm9wdGlvbmFsIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGlucHV0X2RlZi5pc193b3JrZmxvdyAmJiBpbnB1dF92YWx1ZSAhPT0gXCJcIikgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIWlucHV0X2RlZi5pc193b3JrZmxvdyAmJiBpbnB1dF92YWx1ZSAhPT0gbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uaGlnaGxpZ2h0KGlucHV0X2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGpvYl9kZWYucGFyYW1ldGVyc1tzdGVwX2luZGV4XSA9IGpvYl9kZWYucGFyYW1ldGVyc1tzdGVwX2luZGV4XSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgam9iX2RlZi5wYXJhbWV0ZXJzW3N0ZXBfaW5kZXhdW2pvYl9pbnB1dF9pZF0gPSBqb2JfaW5wdXRzW2pvYl9pbnB1dF9pZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZWQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbGlkYXRlZCkge1xuICAgICAgICAgICAgc2VsZi5fZW5hYmxlZCh0cnVlKTtcbiAgICAgICAgICAgIEdhbGF4eS5lbWl0LmRlYnVnKFwidG9vbC1mb3JtLWNvbXBvc2l0ZTo6c3VibWl0KClcIiwgXCJWYWxpZGF0aW9uIGZhaWxlZC5cIiwgam9iX2RlZik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInRvb2wtZm9ybS1jb21wb3NpdGU6OnN1Ym1pdCgpXCIsIFwiVmFsaWRhdGlvbiBjb21wbGV0ZS5cIiwgam9iX2RlZik7XG4gICAgICAgICAgICBVdGlscy5yZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWFwaS93b3JrZmxvd3MvJHt0aGlzLm1vZGVsLmlkfS9pbnZvY2F0aW9uc2AsXG4gICAgICAgICAgICAgICAgZGF0YTogam9iX2RlZixcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBHYWxheHkuZW1pdC5kZWJ1ZyhcInRvb2wtZm9ybS1jb21wb3NpdGU6OnN1Ym1pdFwiLCBcIlN1Ym1pc3Npb24gc3VjY2Vzc2Z1bC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRlbC5jaGlsZHJlbigpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kZWwuYXBwZW5kKHNlbGYuX3RlbXBsYXRlU3VjY2VzcyhyZXNwb25zZSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFNob3cgV2ViaG9vayBpZiBqb2IgaXMgcnVubmluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0FycmF5KHJlc3BvbnNlKSAmJiByZXNwb25zZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLiRlbC5hcHBlbmQoJChcIjxkaXYvPlwiLCB7IGlkOiBcIndlYmhvb2stdmlld1wiIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBXZWJob29rQXBwID0gbmV3IFdlYmhvb2tzLldlYmhvb2tWaWV3KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIndvcmtmbG93XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbElkOiBqb2JfZGVmLnRvb2xfaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbFZlcnNpb246IGpvYl9kZWYudG9vbF92ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hIaXN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgR2FsYXh5LmVtaXQuZGVidWcoXCJ0b29sLWZvcm0tY29tcG9zaXRlOjpzdWJtaXRcIiwgXCJTdWJtaXNzaW9uIGZhaWxlZC5cIiwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5wdXRfZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmVycl9kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHNlbGYuZm9ybXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IHNlbGYuZm9ybXNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBfcmVsYXRlZF9lcnJvcnMgPSByZXNwb25zZS5lcnJfZGF0YVtmb3JtLm1vZGVsLmdldChcInN0ZXBfaW5kZXhcIildO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwX3JlbGF0ZWRfZXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvcl9tZXNzYWdlcyA9IGZvcm0uZGF0YS5tYXRjaFJlc3BvbnNlKHN0ZXBfcmVsYXRlZF9lcnJvcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbnB1dF9pZCBpbiBlcnJvcl9tZXNzYWdlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5oaWdobGlnaHQoaW5wdXRfaWQsIGVycm9yX21lc3NhZ2VzW2lucHV0X2lkXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF9mb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlucHV0X2ZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGFsLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIldvcmtmbG93IHN1Ym1pc3Npb24gZmFpbGVkXCIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHNlbGYuX3RlbXBsYXRlRXJyb3Ioam9iX2RlZiwgcmVzcG9uc2UgJiYgcmVzcG9uc2UuZXJyX21zZyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZGFsLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2VuYWJsZWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIEFwcGVuZCBuZXcgZG9tIHRvIGJvZHkgKi9cbiAgICBfYXBwZW5kOiBmdW5jdGlvbigkY29udGFpbmVyLCAkZWwpIHtcbiAgICAgICAgJGNvbnRhaW5lci5hcHBlbmQoXCI8cC8+XCIpLmFwcGVuZCgkZWwpO1xuICAgIH0sXG5cbiAgICAvKiogU2V0IGVuYWJsZWQvZGlzYWJsZWQgc3RhdGUgKi9cbiAgICBfZW5hYmxlZDogZnVuY3Rpb24oZW5hYmxlZCkge1xuICAgICAgICB0aGlzLmV4ZWN1dGVfYnRuLm1vZGVsLnNldCh7XG4gICAgICAgICAgICB3YWl0OiAhZW5hYmxlZCxcbiAgICAgICAgICAgIHdhaXRfdGV4dDogXCJTZW5kaW5nLi4uXCIsXG4gICAgICAgICAgICBwZXJjZW50YWdlOiAtMVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy53cF9mb3JtICYmIHRoaXMud3BfZm9ybS5wb3J0bGV0W2VuYWJsZWQgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuaGlzdG9yeV9mb3JtICYmIHRoaXMuaGlzdG9yeV9mb3JtLnBvcnRsZXRbZW5hYmxlZCA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgXy5lYWNoKHRoaXMuZm9ybXMsIGZvcm0gPT4ge1xuICAgICAgICAgICAgZm9ybSAmJiBmb3JtLnBvcnRsZXRbZW5hYmxlZCA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBJcyBkYXRhIGlucHV0IG1vZHVsZS9zdGVwICovXG4gICAgX2lzRGF0YVN0ZXA6IGZ1bmN0aW9uKHN0ZXBzKSB7XG4gICAgICAgIHZhciBsc3QgPSAkLmlzQXJyYXkoc3RlcHMpID8gc3RlcHMgOiBbc3RlcHNdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHN0ZXAgPSBsc3RbaV07XG4gICAgICAgICAgICBpZiAoIXN0ZXAgfHwgIXN0ZXAuc3RlcF90eXBlIHx8ICFzdGVwLnN0ZXBfdHlwZS5zdGFydHNXaXRoKFwiZGF0YVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlcyAqL1xuICAgIF90ZW1wbGF0ZVN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICgkLmlzQXJyYXkocmVzcG9uc2UpICYmIHJlc3BvbnNlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiAkKFwiPGRpdi8+XCIpXG4gICAgICAgICAgICAgICAgLmFkZENsYXNzKFwiZG9uZW1lc3NhZ2VsYXJnZVwiKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICQoXCI8cC8+XCIpLmh0bWwoXG4gICAgICAgICAgICAgICAgICAgICAgICBgU3VjY2Vzc2Z1bGx5IGludm9rZWQgd29ya2Zsb3cgPGI+JHtVdGlscy5zYW5pdGl6ZSh0aGlzLm1vZGVsLmdldChcIm5hbWVcIikpfTwvYj4ke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmxlbmd0aCA+IDEgPyBgIDxiPiR7cmVzcG9uc2UubGVuZ3RofSB0aW1lczwvYj5gIDogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfS5gXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgJChcIjxwLz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCI8Yi8+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIllvdSBjYW4gY2hlY2sgdGhlIHN0YXR1cyBvZiBxdWV1ZWQgam9icyBhbmQgdmlldyB0aGUgcmVzdWx0aW5nIGRhdGEgYnkgcmVmcmVzaGluZyB0aGUgSGlzdG9yeSBwYW5lLiBXaGVuIHRoZSBqb2IgaGFzIGJlZW4gcnVuIHRoZSBzdGF0dXMgd2lsbCBjaGFuZ2UgZnJvbSAncnVubmluZycgdG8gJ2ZpbmlzaGVkJyBpZiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IG9yICdlcnJvcicgaWYgcHJvYmxlbXMgd2VyZSBlbmNvdW50ZXJlZC5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGVtcGxhdGVFcnJvcihyZXNwb25zZSwgXCJJbnZhbGlkIHN1Y2Nlc3MgcmVzcG9uc2UuIE5vIGludm9jYXRpb25zIGZvdW5kLlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfdGVtcGxhdGVFcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UsIGVycl9tc2cpIHtcbiAgICAgICAgcmV0dXJuICQoXCI8ZGl2Lz5cIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcImVycm9ybWVzc2FnZWxhcmdlXCIpXG4gICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICQoXCI8cC8+XCIpLnRleHQoXG4gICAgICAgICAgICAgICAgICAgIGBUaGUgc2VydmVyIGNvdWxkIG5vdCBjb21wbGV0ZSB0aGUgcmVxdWVzdC4gUGxlYXNlIGNvbnRhY3QgdGhlIEdhbGF4eSBUZWFtIGlmIHRoaXMgZXJyb3IgcGVyc2lzdHMuICR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfbXNnXG4gICAgICAgICAgICAgICAgICAgICkgfHwgXCJcIn1gXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFwcGVuZCgkKFwiPHByZS8+XCIpLnRleHQoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UsIG51bGwsIDQpKSk7XG4gICAgfVxufSk7XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVmlldzogVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdG9vbC90b29sLWZvcm0tY29tcG9zaXRlLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUtBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBSEE7QUFYQTtBQUpBO0FBOEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBSEE7QUFKQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFjQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFYQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFIQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwREE7QUFzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBM3JCQTtBQVZBO0FBdXNCQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///137\n");

/***/ }),
/* 138 */,
/* 139 */,
/* 140 */,
/* 141 */,
/* 142 */,
/* 143 */,
/* 144 */,
/* 145 */,
/* 146 */,
/* 147 */,
/* 148 */,
/* 149 */,
/* 150 */,
/* 151 */,
/* 152 */,
/* 153 */,
/* 154 */,
/* 155 */,
/* 156 */,
/* 157 */,
/* 158 */,
/* 159 */,
/* 160 */,
/* 161 */,
/* 162 */,
/* 163 */,
/* 164 */,
/* 165 */,
/* 166 */,
/* 167 */,
/* 168 */,
/* 169 */,
/* 170 */,
/* 171 */,
/* 172 */,
/* 173 */,
/* 174 */,
/* 175 */,
/* 176 */,
/* 177 */,
/* 178 */,
/* 179 */,
/* 180 */,
/* 181 */,
/* 182 */,
/* 183 */,
/* 184 */,
/* 185 */,
/* 186 */,
/* 187 */,
/* 188 */,
/* 189 */,
/* 190 */,
/* 191 */,
/* 192 */,
/* 193 */,
/* 194 */,
/* 195 */,
/* 196 */,
/* 197 */,
/* 198 */,
/* 199 */,
/* 200 */,
/* 201 */,
/* 202 */,
/* 203 */,
/* 204 */,
/* 205 */,
/* 206 */,
/* 207 */,
/* 208 */,
/* 209 */,
/* 210 */,
/* 211 */,
/* 212 */,
/* 213 */,
/* 214 */,
/* 215 */,
/* 216 */,
/* 217 */,
/* 218 */,
/* 219 */,
/* 220 */,
/* 221 */,
/* 222 */,
/* 223 */,
/* 224 */,
/* 225 */,
/* 226 */,
/* 227 */,
/* 228 */,
/* 229 */,
/* 230 */,
/* 231 */,
/* 232 */,
/* 233 */,
/* 234 */,
/* 235 */,
/* 236 */,
/* 237 */,
/* 238 */,
/* 239 */,
/* 240 */,
/* 241 */,
/* 242 */,
/* 243 */,
/* 244 */,
/* 245 */,
/* 246 */,
/* 247 */,
/* 248 */,
/* 249 */,
/* 250 */,
/* 251 */
/*!*****************************************!*\
  !*** ./galaxy/scripts/apps/analysis.js ***!
  \*****************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_) {\n\nvar _jquery = __webpack_require__(/*! jquery */ 0);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _galaxy = __webpack_require__(/*! galaxy */ 65);\n\nvar _galaxy2 = _interopRequireDefault(_galaxy);\n\nvar _router = __webpack_require__(/*! layout/router */ 91);\n\nvar _router2 = _interopRequireDefault(_router);\n\nvar _toolPanel = __webpack_require__(/*! ./panels/tool-panel */ 252);\n\nvar _toolPanel2 = _interopRequireDefault(_toolPanel);\n\nvar _historyPanel = __webpack_require__(/*! ./panels/history-panel */ 262);\n\nvar _historyPanel2 = _interopRequireDefault(_historyPanel);\n\nvar _page = __webpack_require__(/*! layout/page */ 44);\n\nvar _page2 = _interopRequireDefault(_page);\n\nvar _toolForm = __webpack_require__(/*! mvc/tool/tool-form */ 117);\n\nvar _toolForm2 = _interopRequireDefault(_toolForm);\n\nvar _formWrapper = __webpack_require__(/*! mvc/form/form-wrapper */ 101);\n\nvar _formWrapper2 = _interopRequireDefault(_formWrapper);\n\nvar _userPreferences = __webpack_require__(/*! mvc/user/user-preferences */ 265);\n\nvar _userPreferences2 = _interopRequireDefault(_userPreferences);\n\nvar _userCustomBuilds = __webpack_require__(/*! mvc/user/user-custom-builds */ 266);\n\nvar _userCustomBuilds2 = _interopRequireDefault(_userCustomBuilds);\n\nvar _tours = __webpack_require__(/*! mvc/tours */ 114);\n\nvar _tours2 = _interopRequireDefault(_tours);\n\nvar _gridView = __webpack_require__(/*! mvc/grid/grid-view */ 26);\n\nvar _gridView2 = _interopRequireDefault(_gridView);\n\nvar _gridShared = __webpack_require__(/*! mvc/grid/grid-shared */ 268);\n\nvar _gridShared2 = _interopRequireDefault(_gridShared);\n\nvar _workflow = __webpack_require__(/*! mvc/workflow/workflow */ 269);\n\nvar _workflow2 = _interopRequireDefault(_workflow);\n\nvar _HistoryImport = __webpack_require__(/*! components/HistoryImport.vue */ 271);\n\nvar _HistoryImport2 = _interopRequireDefault(_HistoryImport);\n\nvar _historyList = __webpack_require__(/*! mvc/history/history-list */ 276);\n\nvar _historyList2 = _interopRequireDefault(_historyList);\n\nvar _toolFormComposite = __webpack_require__(/*! mvc/tool/tool-form-composite */ 137);\n\nvar _toolFormComposite2 = _interopRequireDefault(_toolFormComposite);\n\nvar _queryStringParsing = __webpack_require__(/*! utils/query-string-parsing */ 27);\n\nvar _queryStringParsing2 = _interopRequireDefault(_queryStringParsing);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _datasetError = __webpack_require__(/*! mvc/dataset/dataset-error */ 277);\n\nvar _datasetError2 = _interopRequireDefault(_datasetError);\n\nvar _datasetEditAttributes = __webpack_require__(/*! mvc/dataset/dataset-edit-attributes */ 278);\n\nvar _datasetEditAttributes2 = _interopRequireDefault(_datasetEditAttributes);\n\nvar _Citations = __webpack_require__(/*! components/Citations.vue */ 123);\n\nvar _Citations2 = _interopRequireDefault(_Citations);\n\nvar _vue = __webpack_require__(/*! vue */ 64);\n\nvar _vue2 = _interopRequireDefault(_vue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar $ = _jquery2.default;\n\n\n/** define the 'Analyze Data'/analysis/main/home page for Galaxy\n *  * has a masthead\n *  * a left tool menu to allow the user to load tools in the center panel\n *  * a right history menu that shows the user's current data\n *  * a center panel\n *  Both panels (generally) persist while the center panel shows any\n *  UI needed for the current step of an analysis, like:\n *      * tool forms to set tool parameters,\n *      * tables showing the contents of datasets\n *      * etc.\n */\nwindow.app = function app(options, bootstrapped) {\n    window.Galaxy = new _galaxy2.default.GalaxyApp(options, bootstrapped);\n    Galaxy.debug(\"analysis app\");\n\n    /** Routes */\n    var AnalysisRouter = _router2.default.extend({\n        routes: {\n            \"(/)\": \"home\",\n            \"(/)root*\": \"home\",\n            \"(/)tours(/)(:tour_id)\": \"show_tours\",\n            \"(/)user(/)\": \"show_user\",\n            \"(/)user(/)(:form_id)\": \"show_user_form\",\n            \"(/)openids(/)list\": \"show_openids\",\n            \"(/)pages(/)create(/)\": \"show_pages_create\",\n            \"(/)pages(/)edit(/)\": \"show_pages_edit\",\n            \"(/)pages(/)(:action_id)\": \"show_pages\",\n            \"(/)visualizations(/)edit(/)\": \"show_visualizations_edit\",\n            \"(/)visualizations/(:action_id)\": \"show_visualizations\",\n            \"(/)workflows/import_workflow\": \"show_import_workflow\",\n            \"(/)workflows/run(/)\": \"show_run\",\n            \"(/)workflows(/)list\": \"show_workflows\",\n            \"(/)workflows/list_published(/)\": \"show_workflows_published\",\n            \"(/)workflows/create(/)\": \"show_workflows_create\",\n            \"(/)histories(/)citations(/)\": \"show_history_citations\",\n            \"(/)histories(/)rename(/)\": \"show_histories_rename\",\n            \"(/)histories(/)import(/)\": \"show_histories_import\",\n            \"(/)histories(/)permissions(/)\": \"show_histories_permissions\",\n            \"(/)histories(/)(:action_id)\": \"show_histories\",\n            \"(/)datasets(/)list(/)\": \"show_datasets\",\n            \"(/)custom_builds\": \"show_custom_builds\",\n            \"(/)datasets/edit\": \"show_dataset_edit_attributes\",\n            \"(/)datasets/error\": \"show_dataset_error\"\n        },\n\n        require_login: [\"show_user\", \"show_user_form\", \"show_workflows\"],\n\n        authenticate: function authenticate(args, name) {\n            return Galaxy.user && Galaxy.user.id || this.require_login.indexOf(name) == -1;\n        },\n\n        show_tours: function show_tours(tour_id) {\n            if (tour_id) {\n                _tours2.default.giveTourById(tour_id);\n            } else {\n                this.page.display(new _tours2.default.ToursView());\n            }\n        },\n\n        show_user: function show_user() {\n            this.page.display(new _userPreferences2.default.View());\n        },\n\n        show_user_form: function show_user_form(form_id) {\n            var model = new _userPreferences2.default.Model({\n                user_id: Galaxy.params.id\n            });\n            this.page.display(new _formWrapper2.default.View(model.get(form_id)));\n        },\n\n        show_visualizations: function show_visualizations(action_id) {\n            this.page.display(new _gridShared2.default.View({\n                action_id: action_id,\n                plural: \"Visualizations\",\n                item: \"visualization\"\n            }));\n        },\n\n        show_visualizations_edit: function show_visualizations_edit() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"visualization/edit?id=\" + _queryStringParsing2.default.get(\"id\"),\n                redirect: \"visualizations/list\"\n            }));\n        },\n\n        show_workflows_published: function show_workflows_published() {\n            this.page.display(new _gridView2.default({\n                url_base: Galaxy.root + \"workflow/list_published\"\n            }));\n        },\n\n        show_histories: function show_histories(action_id) {\n            this.page.display(new _historyList2.default.View({ action_id: action_id }));\n        },\n\n        show_history_citations: function show_history_citations() {\n            var citationInstance = _vue2.default.extend(_Citations2.default);\n            var vm = document.createElement(\"div\");\n            this.page.display(vm);\n            new citationInstance({ propsData: { id: _queryStringParsing2.default.get(\"id\"), source: \"histories\" } }).$mount(vm);\n        },\n\n        show_histories_rename: function show_histories_rename() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"history/rename?id=\" + _queryStringParsing2.default.get(\"id\"),\n                redirect: \"histories/list\"\n            }));\n        },\n\n        show_histories_import: function show_histories_import() {\n            var historyImportInstance = _vue2.default.extend(_HistoryImport2.default);\n            var vm = document.createElement(\"div\");\n            this.page.display(vm);\n            new historyImportInstance().$mount(vm);\n        },\n\n        show_histories_permissions: function show_histories_permissions() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"history/permissions?id=\" + _queryStringParsing2.default.get(\"id\"),\n                redirect: \"histories/list\"\n            }));\n        },\n\n        show_openids: function show_openids() {\n            this.page.display(new _gridView2.default({\n                url_base: Galaxy.root + \"user/openids_list\"\n            }));\n        },\n\n        show_datasets: function show_datasets() {\n            this.page.display(new _gridView2.default({\n                url_base: Galaxy.root + \"dataset/list\"\n            }));\n        },\n\n        show_pages: function show_pages(action_id) {\n            this.page.display(new _gridShared2.default.View({\n                action_id: action_id,\n                plural: \"Pages\",\n                item: \"page\"\n            }));\n        },\n\n        show_pages_create: function show_pages_create() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"page/create\",\n                redirect: \"pages/list\"\n            }));\n        },\n\n        show_pages_edit: function show_pages_edit() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"page/edit?id=\" + _queryStringParsing2.default.get(\"id\"),\n                redirect: \"pages/list\"\n            }));\n        },\n\n        show_workflows: function show_workflows() {\n            this.page.display(new _workflow2.default.View());\n        },\n\n        show_workflows_create: function show_workflows_create() {\n            this.page.display(new _formWrapper2.default.View({\n                url: \"workflow/create\",\n                redirect: \"workflow/editor\"\n            }));\n        },\n\n        show_run: function show_run() {\n            this._loadWorkflow();\n        },\n\n        show_import_workflow: function show_import_workflow() {\n            this.page.display(new _workflow2.default.ImportWorkflowView());\n        },\n\n        show_custom_builds: function show_custom_builds() {\n            var _this = this;\n\n            var historyPanel = this.page.historyPanel.historyView;\n            if (!historyPanel || !historyPanel.model || !historyPanel.model.id) {\n                window.setTimeout(function () {\n                    _this.show_custom_builds();\n                }, 500);\n                return;\n            }\n            this.page.display(new _userCustomBuilds2.default.View());\n        },\n\n        show_dataset_edit_attributes: function show_dataset_edit_attributes() {\n            this.page.display(new _datasetEditAttributes2.default.View());\n        },\n\n        show_dataset_error: function show_dataset_error() {\n            this.page.display(new _datasetError2.default.View());\n        },\n\n        /**  */\n        home: function home(params) {\n            // TODO: to router, remove Globals\n            // load a tool by id (tool_id) or rerun a previous tool execution (job_id)\n            if (params.tool_id || params.job_id) {\n                if (params.tool_id === \"upload1\") {\n                    this.page.toolPanel.upload.show();\n                    this._loadCenterIframe(\"welcome\");\n                } else {\n                    this._loadToolForm(params);\n                }\n            } else {\n                // show the workflow run form\n                if (params.workflow_id) {\n                    this._loadWorkflow();\n                    // load the center iframe with controller.action: galaxy.org/?m_c=history&m_a=list -> history/list\n                } else if (params.m_c) {\n                    this._loadCenterIframe(params.m_c + \"/\" + params.m_a);\n                    // show the workflow run form\n                } else {\n                    this._loadCenterIframe(\"welcome\");\n                }\n            }\n        },\n\n        /** load the center panel with a tool form described by the given params obj */\n        _loadToolForm: function _loadToolForm(params) {\n            //TODO: load tool form code async\n            params.id = decodeURIComponent(params.tool_id);\n            this.page.display(new _toolForm2.default.View(params));\n        },\n\n        /** load the center panel iframe using the given url */\n        _loadCenterIframe: function _loadCenterIframe(url, root) {\n            root = root || Galaxy.root;\n            url = root + url;\n            this.page.$(\"#galaxy_main\").prop(\"src\", url);\n        },\n\n        /** load workflow by its url in run mode */\n        _loadWorkflow: function _loadWorkflow() {\n            var _this2 = this;\n\n            _utils2.default.get({\n                url: Galaxy.root + \"api/workflows/\" + _utils2.default.getQueryString(\"id\") + \"/download?style=run\",\n                success: function success(response) {\n                    _this2.page.display(new _toolFormComposite2.default.View(response));\n                },\n                error: function error(response) {\n                    var error_msg = response.err_msg || \"Error occurred while loading the resource.\";\n                    var options = {\n                        message: error_msg,\n                        status: \"danger\",\n                        persistent: true\n                    };\n                    _this2.page.display(new _uiMisc2.default.Message(options));\n                }\n            });\n        }\n    });\n\n    // render and start the router\n    $(function () {\n        Galaxy.page = new _page2.default.View(_.extend(options, {\n            Left: _toolPanel2.default,\n            Right: _historyPanel2.default,\n            Router: AnalysisRouter\n        }));\n    });\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL2FwcHMvYW5hbHlzaXMuanM/OTc3ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgalF1ZXJ5IGZyb20gXCJqcXVlcnlcIjtcbnZhciAkID0galF1ZXJ5O1xuaW1wb3J0IEdhbGF4eUFwcCBmcm9tIFwiZ2FsYXh5XCI7XG5pbXBvcnQgUm91dGVyIGZyb20gXCJsYXlvdXQvcm91dGVyXCI7XG5pbXBvcnQgVG9vbFBhbmVsIGZyb20gXCIuL3BhbmVscy90b29sLXBhbmVsXCI7XG5pbXBvcnQgSGlzdG9yeVBhbmVsIGZyb20gXCIuL3BhbmVscy9oaXN0b3J5LXBhbmVsXCI7XG5pbXBvcnQgUGFnZSBmcm9tIFwibGF5b3V0L3BhZ2VcIjtcbmltcG9ydCBUb29sRm9ybSBmcm9tIFwibXZjL3Rvb2wvdG9vbC1mb3JtXCI7XG5pbXBvcnQgRm9ybVdyYXBwZXIgZnJvbSBcIm12Yy9mb3JtL2Zvcm0td3JhcHBlclwiO1xuaW1wb3J0IFVzZXJQcmVmZXJlbmNlcyBmcm9tIFwibXZjL3VzZXIvdXNlci1wcmVmZXJlbmNlc1wiO1xuaW1wb3J0IEN1c3RvbUJ1aWxkcyBmcm9tIFwibXZjL3VzZXIvdXNlci1jdXN0b20tYnVpbGRzXCI7XG5pbXBvcnQgVG91cnMgZnJvbSBcIm12Yy90b3Vyc1wiO1xuaW1wb3J0IEdyaWRWaWV3IGZyb20gXCJtdmMvZ3JpZC9ncmlkLXZpZXdcIjtcbmltcG9ydCBHcmlkU2hhcmVkIGZyb20gXCJtdmMvZ3JpZC9ncmlkLXNoYXJlZFwiO1xuaW1wb3J0IFdvcmtmbG93cyBmcm9tIFwibXZjL3dvcmtmbG93L3dvcmtmbG93XCI7XG5pbXBvcnQgSGlzdG9yeUltcG9ydCBmcm9tIFwiY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZVwiO1xuaW1wb3J0IEhpc3RvcnlMaXN0IGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LWxpc3RcIjtcbmltcG9ydCBUb29sRm9ybUNvbXBvc2l0ZSBmcm9tIFwibXZjL3Rvb2wvdG9vbC1mb3JtLWNvbXBvc2l0ZVwiO1xuaW1wb3J0IFF1ZXJ5U3RyaW5nUGFyc2luZyBmcm9tIFwidXRpbHMvcXVlcnktc3RyaW5nLXBhcnNpbmdcIjtcbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBVaSBmcm9tIFwibXZjL3VpL3VpLW1pc2NcIjtcbmltcG9ydCBEYXRhc2V0RXJyb3IgZnJvbSBcIm12Yy9kYXRhc2V0L2RhdGFzZXQtZXJyb3JcIjtcbmltcG9ydCBEYXRhc2V0RWRpdEF0dHJpYnV0ZXMgZnJvbSBcIm12Yy9kYXRhc2V0L2RhdGFzZXQtZWRpdC1hdHRyaWJ1dGVzXCI7XG5pbXBvcnQgQ2l0YXRpb25zIGZyb20gXCJjb21wb25lbnRzL0NpdGF0aW9ucy52dWVcIjtcbmltcG9ydCBWdWUgZnJvbSBcInZ1ZVwiO1xuXG4vKiogZGVmaW5lIHRoZSAnQW5hbHl6ZSBEYXRhJy9hbmFseXNpcy9tYWluL2hvbWUgcGFnZSBmb3IgR2FsYXh5XG4gKiAgKiBoYXMgYSBtYXN0aGVhZFxuICogICogYSBsZWZ0IHRvb2wgbWVudSB0byBhbGxvdyB0aGUgdXNlciB0byBsb2FkIHRvb2xzIGluIHRoZSBjZW50ZXIgcGFuZWxcbiAqICAqIGEgcmlnaHQgaGlzdG9yeSBtZW51IHRoYXQgc2hvd3MgdGhlIHVzZXIncyBjdXJyZW50IGRhdGFcbiAqICAqIGEgY2VudGVyIHBhbmVsXG4gKiAgQm90aCBwYW5lbHMgKGdlbmVyYWxseSkgcGVyc2lzdCB3aGlsZSB0aGUgY2VudGVyIHBhbmVsIHNob3dzIGFueVxuICogIFVJIG5lZWRlZCBmb3IgdGhlIGN1cnJlbnQgc3RlcCBvZiBhbiBhbmFseXNpcywgbGlrZTpcbiAqICAgICAgKiB0b29sIGZvcm1zIHRvIHNldCB0b29sIHBhcmFtZXRlcnMsXG4gKiAgICAgICogdGFibGVzIHNob3dpbmcgdGhlIGNvbnRlbnRzIG9mIGRhdGFzZXRzXG4gKiAgICAgICogZXRjLlxuICovXG53aW5kb3cuYXBwID0gZnVuY3Rpb24gYXBwKG9wdGlvbnMsIGJvb3RzdHJhcHBlZCkge1xuICAgIHdpbmRvdy5HYWxheHkgPSBuZXcgR2FsYXh5QXBwLkdhbGF4eUFwcChvcHRpb25zLCBib290c3RyYXBwZWQpO1xuICAgIEdhbGF4eS5kZWJ1ZyhcImFuYWx5c2lzIGFwcFwiKTtcblxuICAgIC8qKiBSb3V0ZXMgKi9cbiAgICB2YXIgQW5hbHlzaXNSb3V0ZXIgPSBSb3V0ZXIuZXh0ZW5kKHtcbiAgICAgICAgcm91dGVzOiB7XG4gICAgICAgICAgICBcIigvKVwiOiBcImhvbWVcIixcbiAgICAgICAgICAgIFwiKC8pcm9vdCpcIjogXCJob21lXCIsXG4gICAgICAgICAgICBcIigvKXRvdXJzKC8pKDp0b3VyX2lkKVwiOiBcInNob3dfdG91cnNcIixcbiAgICAgICAgICAgIFwiKC8pdXNlcigvKVwiOiBcInNob3dfdXNlclwiLFxuICAgICAgICAgICAgXCIoLyl1c2VyKC8pKDpmb3JtX2lkKVwiOiBcInNob3dfdXNlcl9mb3JtXCIsXG4gICAgICAgICAgICBcIigvKW9wZW5pZHMoLylsaXN0XCI6IFwic2hvd19vcGVuaWRzXCIsXG4gICAgICAgICAgICBcIigvKXBhZ2VzKC8pY3JlYXRlKC8pXCI6IFwic2hvd19wYWdlc19jcmVhdGVcIixcbiAgICAgICAgICAgIFwiKC8pcGFnZXMoLyllZGl0KC8pXCI6IFwic2hvd19wYWdlc19lZGl0XCIsXG4gICAgICAgICAgICBcIigvKXBhZ2VzKC8pKDphY3Rpb25faWQpXCI6IFwic2hvd19wYWdlc1wiLFxuICAgICAgICAgICAgXCIoLyl2aXN1YWxpemF0aW9ucygvKWVkaXQoLylcIjogXCJzaG93X3Zpc3VhbGl6YXRpb25zX2VkaXRcIixcbiAgICAgICAgICAgIFwiKC8pdmlzdWFsaXphdGlvbnMvKDphY3Rpb25faWQpXCI6IFwic2hvd192aXN1YWxpemF0aW9uc1wiLFxuICAgICAgICAgICAgXCIoLyl3b3JrZmxvd3MvaW1wb3J0X3dvcmtmbG93XCI6IFwic2hvd19pbXBvcnRfd29ya2Zsb3dcIixcbiAgICAgICAgICAgIFwiKC8pd29ya2Zsb3dzL3J1bigvKVwiOiBcInNob3dfcnVuXCIsXG4gICAgICAgICAgICBcIigvKXdvcmtmbG93cygvKWxpc3RcIjogXCJzaG93X3dvcmtmbG93c1wiLFxuICAgICAgICAgICAgXCIoLyl3b3JrZmxvd3MvbGlzdF9wdWJsaXNoZWQoLylcIjogXCJzaG93X3dvcmtmbG93c19wdWJsaXNoZWRcIixcbiAgICAgICAgICAgIFwiKC8pd29ya2Zsb3dzL2NyZWF0ZSgvKVwiOiBcInNob3dfd29ya2Zsb3dzX2NyZWF0ZVwiLFxuICAgICAgICAgICAgXCIoLyloaXN0b3JpZXMoLyljaXRhdGlvbnMoLylcIjogXCJzaG93X2hpc3RvcnlfY2l0YXRpb25zXCIsXG4gICAgICAgICAgICBcIigvKWhpc3RvcmllcygvKXJlbmFtZSgvKVwiOiBcInNob3dfaGlzdG9yaWVzX3JlbmFtZVwiLFxuICAgICAgICAgICAgXCIoLyloaXN0b3JpZXMoLylpbXBvcnQoLylcIjogXCJzaG93X2hpc3Rvcmllc19pbXBvcnRcIixcbiAgICAgICAgICAgIFwiKC8paGlzdG9yaWVzKC8pcGVybWlzc2lvbnMoLylcIjogXCJzaG93X2hpc3Rvcmllc19wZXJtaXNzaW9uc1wiLFxuICAgICAgICAgICAgXCIoLyloaXN0b3JpZXMoLykoOmFjdGlvbl9pZClcIjogXCJzaG93X2hpc3Rvcmllc1wiLFxuICAgICAgICAgICAgXCIoLylkYXRhc2V0cygvKWxpc3QoLylcIjogXCJzaG93X2RhdGFzZXRzXCIsXG4gICAgICAgICAgICBcIigvKWN1c3RvbV9idWlsZHNcIjogXCJzaG93X2N1c3RvbV9idWlsZHNcIixcbiAgICAgICAgICAgIFwiKC8pZGF0YXNldHMvZWRpdFwiOiBcInNob3dfZGF0YXNldF9lZGl0X2F0dHJpYnV0ZXNcIixcbiAgICAgICAgICAgIFwiKC8pZGF0YXNldHMvZXJyb3JcIjogXCJzaG93X2RhdGFzZXRfZXJyb3JcIlxuICAgICAgICB9LFxuXG4gICAgICAgIHJlcXVpcmVfbG9naW46IFtcInNob3dfdXNlclwiLCBcInNob3dfdXNlcl9mb3JtXCIsIFwic2hvd193b3JrZmxvd3NcIl0sXG5cbiAgICAgICAgYXV0aGVudGljYXRlOiBmdW5jdGlvbihhcmdzLCBuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gKEdhbGF4eS51c2VyICYmIEdhbGF4eS51c2VyLmlkKSB8fCB0aGlzLnJlcXVpcmVfbG9naW4uaW5kZXhPZihuYW1lKSA9PSAtMTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X3RvdXJzOiBmdW5jdGlvbih0b3VyX2lkKSB7XG4gICAgICAgICAgICBpZiAodG91cl9pZCkge1xuICAgICAgICAgICAgICAgIFRvdXJzLmdpdmVUb3VyQnlJZCh0b3VyX2lkKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IFRvdXJzLlRvdXJzVmlldygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X3VzZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IFVzZXJQcmVmZXJlbmNlcy5WaWV3KCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfdXNlcl9mb3JtOiBmdW5jdGlvbihmb3JtX2lkKSB7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSBuZXcgVXNlclByZWZlcmVuY2VzLk1vZGVsKHtcbiAgICAgICAgICAgICAgICB1c2VyX2lkOiBHYWxheHkucGFyYW1zLmlkXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucGFnZS5kaXNwbGF5KG5ldyBGb3JtV3JhcHBlci5WaWV3KG1vZGVsLmdldChmb3JtX2lkKSkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfdmlzdWFsaXphdGlvbnM6IGZ1bmN0aW9uKGFjdGlvbl9pZCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkoXG4gICAgICAgICAgICAgICAgbmV3IEdyaWRTaGFyZWQuVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbl9pZDogYWN0aW9uX2lkLFxuICAgICAgICAgICAgICAgICAgICBwbHVyYWw6IFwiVmlzdWFsaXphdGlvbnNcIixcbiAgICAgICAgICAgICAgICAgICAgaXRlbTogXCJ2aXN1YWxpemF0aW9uXCJcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X3Zpc3VhbGl6YXRpb25zX2VkaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkoXG4gICAgICAgICAgICAgICAgbmV3IEZvcm1XcmFwcGVyLlZpZXcoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGB2aXN1YWxpemF0aW9uL2VkaXQ/aWQ9JHtRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwiaWRcIil9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IFwidmlzdWFsaXphdGlvbnMvbGlzdFwiXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd193b3JrZmxvd3NfcHVibGlzaGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZS5kaXNwbGF5KFxuICAgICAgICAgICAgICAgIG5ldyBHcmlkVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIHVybF9iYXNlOiBgJHtHYWxheHkucm9vdH13b3JrZmxvdy9saXN0X3B1Ymxpc2hlZGBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X2hpc3RvcmllczogZnVuY3Rpb24oYWN0aW9uX2lkKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShuZXcgSGlzdG9yeUxpc3QuVmlldyh7IGFjdGlvbl9pZDogYWN0aW9uX2lkIH0pKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X2hpc3RvcnlfY2l0YXRpb25zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjaXRhdGlvbkluc3RhbmNlID0gVnVlLmV4dGVuZChDaXRhdGlvbnMpO1xuICAgICAgICAgICAgdmFyIHZtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIHRoaXMucGFnZS5kaXNwbGF5KHZtKTtcbiAgICAgICAgICAgIG5ldyBjaXRhdGlvbkluc3RhbmNlKHsgcHJvcHNEYXRhOiB7IGlkOiBRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwiaWRcIiksIHNvdXJjZTogXCJoaXN0b3JpZXNcIiB9IH0pLiRtb3VudCh2bSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd19oaXN0b3JpZXNfcmVuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZS5kaXNwbGF5KFxuICAgICAgICAgICAgICAgIG5ldyBGb3JtV3JhcHBlci5WaWV3KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBgaGlzdG9yeS9yZW5hbWU/aWQ9JHtRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwiaWRcIil9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IFwiaGlzdG9yaWVzL2xpc3RcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfaGlzdG9yaWVzX2ltcG9ydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaGlzdG9yeUltcG9ydEluc3RhbmNlID0gVnVlLmV4dGVuZChIaXN0b3J5SW1wb3J0KTtcbiAgICAgICAgICAgIHZhciB2bSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheSh2bSk7XG4gICAgICAgICAgICBuZXcgaGlzdG9yeUltcG9ydEluc3RhbmNlKCkuJG1vdW50KHZtKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X2hpc3Rvcmllc19wZXJtaXNzaW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShcbiAgICAgICAgICAgICAgICBuZXcgRm9ybVdyYXBwZXIuVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogYGhpc3RvcnkvcGVybWlzc2lvbnM/aWQ9JHtRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwiaWRcIil9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IFwiaGlzdG9yaWVzL2xpc3RcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfb3BlbmlkczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShcbiAgICAgICAgICAgICAgICBuZXcgR3JpZFZpZXcoe1xuICAgICAgICAgICAgICAgICAgICB1cmxfYmFzZTogYCR7R2FsYXh5LnJvb3R9dXNlci9vcGVuaWRzX2xpc3RgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd19kYXRhc2V0czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShcbiAgICAgICAgICAgICAgICBuZXcgR3JpZFZpZXcoe1xuICAgICAgICAgICAgICAgICAgICB1cmxfYmFzZTogYCR7R2FsYXh5LnJvb3R9ZGF0YXNldC9saXN0YFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfcGFnZXM6IGZ1bmN0aW9uKGFjdGlvbl9pZCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkoXG4gICAgICAgICAgICAgICAgbmV3IEdyaWRTaGFyZWQuVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbl9pZDogYWN0aW9uX2lkLFxuICAgICAgICAgICAgICAgICAgICBwbHVyYWw6IFwiUGFnZXNcIixcbiAgICAgICAgICAgICAgICAgICAgaXRlbTogXCJwYWdlXCJcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X3BhZ2VzX2NyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShcbiAgICAgICAgICAgICAgICBuZXcgRm9ybVdyYXBwZXIuVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogXCJwYWdlL2NyZWF0ZVwiLFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogXCJwYWdlcy9saXN0XCJcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzaG93X3BhZ2VzX2VkaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkoXG4gICAgICAgICAgICAgICAgbmV3IEZvcm1XcmFwcGVyLlZpZXcoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGBwYWdlL2VkaXQ/aWQ9JHtRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwiaWRcIil9YCxcbiAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6IFwicGFnZXMvbGlzdFwiXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd193b3JrZmxvd3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IFdvcmtmbG93cy5WaWV3KCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfd29ya2Zsb3dzX2NyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShcbiAgICAgICAgICAgICAgICBuZXcgRm9ybVdyYXBwZXIuVmlldyh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogYHdvcmtmbG93L2NyZWF0ZWAsXG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiBcIndvcmtmbG93L2VkaXRvclwiXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd19ydW46IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZFdvcmtmbG93KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd19pbXBvcnRfd29ya2Zsb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IFdvcmtmbG93cy5JbXBvcnRXb3JrZmxvd1ZpZXcoKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvd19jdXN0b21fYnVpbGRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBoaXN0b3J5UGFuZWwgPSB0aGlzLnBhZ2UuaGlzdG9yeVBhbmVsLmhpc3RvcnlWaWV3O1xuICAgICAgICAgICAgaWYgKCFoaXN0b3J5UGFuZWwgfHwgIWhpc3RvcnlQYW5lbC5tb2RlbCB8fCAhaGlzdG9yeVBhbmVsLm1vZGVsLmlkKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dfY3VzdG9tX2J1aWxkcygpO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IEN1c3RvbUJ1aWxkcy5WaWV3KCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfZGF0YXNldF9lZGl0X2F0dHJpYnV0ZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IERhdGFzZXRFZGl0QXR0cmlidXRlcy5WaWV3KCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3dfZGF0YXNldF9lcnJvcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShuZXcgRGF0YXNldEVycm9yLlZpZXcoKSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqICAqL1xuICAgICAgICBob21lOiBmdW5jdGlvbihwYXJhbXMpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IHRvIHJvdXRlciwgcmVtb3ZlIEdsb2JhbHNcbiAgICAgICAgICAgIC8vIGxvYWQgYSB0b29sIGJ5IGlkICh0b29sX2lkKSBvciByZXJ1biBhIHByZXZpb3VzIHRvb2wgZXhlY3V0aW9uIChqb2JfaWQpXG4gICAgICAgICAgICBpZiAocGFyYW1zLnRvb2xfaWQgfHwgcGFyYW1zLmpvYl9pZCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbXMudG9vbF9pZCA9PT0gXCJ1cGxvYWQxXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlLnRvb2xQYW5lbC51cGxvYWQuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkQ2VudGVySWZyYW1lKFwid2VsY29tZVwiKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkVG9vbEZvcm0ocGFyYW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIHdvcmtmbG93IHJ1biBmb3JtXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtcy53b3JrZmxvd19pZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkV29ya2Zsb3coKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gbG9hZCB0aGUgY2VudGVyIGlmcmFtZSB3aXRoIGNvbnRyb2xsZXIuYWN0aW9uOiBnYWxheHkub3JnLz9tX2M9aGlzdG9yeSZtX2E9bGlzdCAtPiBoaXN0b3J5L2xpc3RcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtcy5tX2MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZENlbnRlcklmcmFtZShgJHtwYXJhbXMubV9jfS8ke3BhcmFtcy5tX2F9YCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIHdvcmtmbG93IHJ1biBmb3JtXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZENlbnRlcklmcmFtZShcIndlbGNvbWVcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBsb2FkIHRoZSBjZW50ZXIgcGFuZWwgd2l0aCBhIHRvb2wgZm9ybSBkZXNjcmliZWQgYnkgdGhlIGdpdmVuIHBhcmFtcyBvYmogKi9cbiAgICAgICAgX2xvYWRUb29sRm9ybTogZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICAgICAgICAvL1RPRE86IGxvYWQgdG9vbCBmb3JtIGNvZGUgYXN5bmNcbiAgICAgICAgICAgIHBhcmFtcy5pZCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXJhbXMudG9vbF9pZCk7XG4gICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShuZXcgVG9vbEZvcm0uVmlldyhwYXJhbXMpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogbG9hZCB0aGUgY2VudGVyIHBhbmVsIGlmcmFtZSB1c2luZyB0aGUgZ2l2ZW4gdXJsICovXG4gICAgICAgIF9sb2FkQ2VudGVySWZyYW1lOiBmdW5jdGlvbih1cmwsIHJvb3QpIHtcbiAgICAgICAgICAgIHJvb3QgPSByb290IHx8IEdhbGF4eS5yb290O1xuICAgICAgICAgICAgdXJsID0gcm9vdCArIHVybDtcbiAgICAgICAgICAgIHRoaXMucGFnZS4kKFwiI2dhbGF4eV9tYWluXCIpLnByb3AoXCJzcmNcIiwgdXJsKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogbG9hZCB3b3JrZmxvdyBieSBpdHMgdXJsIGluIHJ1biBtb2RlICovXG4gICAgICAgIF9sb2FkV29ya2Zsb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgVXRpbHMuZ2V0KHtcbiAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWFwaS93b3JrZmxvd3MvJHtVdGlscy5nZXRRdWVyeVN0cmluZyhcImlkXCIpfS9kb3dubG9hZD9zdHlsZT1ydW5gLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYWdlLmRpc3BsYXkobmV3IFRvb2xGb3JtQ29tcG9zaXRlLlZpZXcocmVzcG9uc2UpKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiByZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvcl9tc2cgPSByZXNwb25zZS5lcnJfbXNnIHx8IFwiRXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyB0aGUgcmVzb3VyY2UuXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JfbXNnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBcImRhbmdlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVudDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2UuZGlzcGxheShuZXcgVWkuTWVzc2FnZShvcHRpb25zKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHJlbmRlciBhbmQgc3RhcnQgdGhlIHJvdXRlclxuICAgICQoKCkgPT4ge1xuICAgICAgICBHYWxheHkucGFnZSA9IG5ldyBQYWdlLlZpZXcoXG4gICAgICAgICAgICBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgTGVmdDogVG9vbFBhbmVsLFxuICAgICAgICAgICAgICAgIFJpZ2h0OiBIaXN0b3J5UGFuZWwsXG4gICAgICAgICAgICAgICAgUm91dGVyOiBBbmFseXNpc1JvdXRlclxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9KTtcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvYXBwcy9hbmFseXNpcy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQXhCQTtBQUNBO0FBQ0E7QUF1QkE7Ozs7Ozs7Ozs7O0FBV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXpCQTtBQUNBO0FBMkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFiQTtBQWVBO0FBalFBO0FBQ0E7QUFtUUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///251\n");

/***/ }),
/* 252 */
/*!**************************************************!*\
  !*** ./galaxy/scripts/apps/panels/tool-panel.js ***!
  \**************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _tools = __webpack_require__(/*! mvc/tool/tools */ 81);\n\nvar _tools2 = _interopRequireDefault(_tools);\n\nvar _uploadView = __webpack_require__(/*! mvc/upload/upload-view */ 253);\n\nvar _uploadView2 = _interopRequireDefault(_uploadView);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _toolFormComposite = __webpack_require__(/*! mvc/tool/tool-form-composite */ 137);\n\nvar _toolFormComposite2 = _interopRequireDefault(_toolFormComposite);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ToolPanel = Backbone.View.extend({\n    initialize: function initialize(page, options) {\n        // access configuration options\n        var config = options.config;\n        this.root = options.root;\n\n        /** @type {Object[]} descriptions of user's workflows to be shown in the tool menu */\n        this.stored_workflow_menu_entries = config.stored_workflow_menu_entries || [];\n\n        // create tool search, tool panel, and tool panel view.\n        var tool_search = new _tools2.default.ToolSearch({\n            hidden: false\n        });\n        var tools = new _tools2.default.ToolCollection(config.toolbox);\n        this.tool_panel = new _tools2.default.ToolPanel({\n            tool_search: tool_search,\n            tools: tools,\n            layout: config.toolbox_in_panel\n        });\n        this.tool_panel_view = new _tools2.default.ToolPanelView({\n            model: this.tool_panel\n        });\n\n        // add upload modal\n        this.upload_button = new _uploadView2.default({\n            nginx_upload_path: config.nginx_upload_path,\n            ftp_upload_site: config.ftp_upload_site,\n            default_genome: config.default_genome,\n            default_extension: config.default_extension\n        });\n\n        // add uploader button to Galaxy object\n        Galaxy.upload = this.upload_button;\n\n        // components for panel definition\n        this.model = new Backbone.Model({\n            title: (0, _localization2.default)(\"Tools\"),\n            buttons: [this.upload_button]\n        });\n\n        // build body template\n        this.setElement(this._template());\n    },\n\n    render: function render() {\n        // if there are tools, render panel and display everything\n        var self = this;\n        if (this.tool_panel.get(\"layout\").size() > 0) {\n            this.$el.prepend(this.tool_panel_view.$el);\n            this.tool_panel_view.render();\n        }\n        // build the dom for the workflow portion of the tool menu\n        // add internal workflow list\n        self.$(\"#internal-workflows\").append(self._templateAllWorkflow({\n            title: (0, _localization2.default)(\"All workflows\"),\n            href: \"workflows/list\"\n        }));\n        _.each(this.stored_workflow_menu_entries, function (menu_entry) {\n            self.$(\"#internal-workflows\").append(self._templateWorkflowLink({\n                title: menu_entry.stored_workflow.name,\n                href: \"workflows/run?id=\" + menu_entry.encoded_stored_workflow_id\n            }));\n        });\n    },\n\n    /** build a link to one tool */\n    _templateTool: function _templateTool(tool) {\n        return ['<div class=\"toolTitle\">', '<a href=\"', this.root, tool.href, '\" target=\"galaxy_main\">', tool.title, \"</a>\", \"</div>\"].join(\"\");\n    },\n\n    /** build a link to 'All Workflows' */\n    _templateAllWorkflow: function _templateAllWorkflow(tool) {\n        return ['<div class=\"toolTitle\">',\n        // global\n        '<a href=\"', Galaxy.root, tool.href, '\">', tool.title, \"</a>\", \"</div>\"].join(\"\");\n    },\n\n    /** build links to workflows in toolpanel */\n    _templateWorkflowLink: function _templateWorkflowLink(wf) {\n        return ['<div class=\"toolTitle\">', \"<a class=\\\"\" + wf.cls + \" \\\" href=\\\"\", Galaxy.root, wf.href, '\">', wf.title, \"</a>\", \"</div>\"].join(\"\");\n    },\n\n    /** override to include inital menu dom and workflow section */\n    _template: function _template() {\n        return ['<div class=\"toolMenuContainer\">', '<div class=\"toolMenu\" style=\"display: none\">', '<div id=\"search-no-results\" style=\"display: none; padding-top: 5px\">', \"<em><strong>\", (0, _localization2.default)(\"Search did not match any tools.\"), \"</strong></em>\", \"</div>\", \"</div>\", '<div class=\"toolSectionPad\"/>', '<div class=\"toolSectionPad\"/>', '<div class=\"toolSectionTitle\" id=\"title_XXinternalXXworkflow\">', \"<span>\", (0, _localization2.default)(\"Workflows\"), \"</span>\", \"</div>\", '<div id=\"internal-workflows\" class=\"toolSectionBody\">', '<div class=\"toolSectionBg\"/>', \"</div>\", \"</div>\"].join(\"\");\n    },\n\n    toString: function toString() {\n        return \"toolPanel\";\n    }\n});\n\nexports.default = ToolPanel;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL2FwcHMvcGFuZWxzL3Rvb2wtcGFuZWwuanM/NjQ0NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVG9vbHMgZnJvbSBcIm12Yy90b29sL3Rvb2xzXCI7XG5pbXBvcnQgVXBsb2FkIGZyb20gXCJtdmMvdXBsb2FkL3VwbG9hZC12aWV3XCI7XG5pbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuaW1wb3J0IFRvb2xGb3JtIGZyb20gXCJtdmMvdG9vbC90b29sLWZvcm0tY29tcG9zaXRlXCI7XG5cbnZhciBUb29sUGFuZWwgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocGFnZSwgb3B0aW9ucykge1xuICAgICAgICAvLyBhY2Nlc3MgY29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAgICAgIHZhciBjb25maWcgPSBvcHRpb25zLmNvbmZpZztcbiAgICAgICAgdGhpcy5yb290ID0gb3B0aW9ucy5yb290O1xuXG4gICAgICAgIC8qKiBAdHlwZSB7T2JqZWN0W119IGRlc2NyaXB0aW9ucyBvZiB1c2VyJ3Mgd29ya2Zsb3dzIHRvIGJlIHNob3duIGluIHRoZSB0b29sIG1lbnUgKi9cbiAgICAgICAgdGhpcy5zdG9yZWRfd29ya2Zsb3dfbWVudV9lbnRyaWVzID0gY29uZmlnLnN0b3JlZF93b3JrZmxvd19tZW51X2VudHJpZXMgfHwgW107XG5cbiAgICAgICAgLy8gY3JlYXRlIHRvb2wgc2VhcmNoLCB0b29sIHBhbmVsLCBhbmQgdG9vbCBwYW5lbCB2aWV3LlxuICAgICAgICB2YXIgdG9vbF9zZWFyY2ggPSBuZXcgVG9vbHMuVG9vbFNlYXJjaCh7XG4gICAgICAgICAgICBoaWRkZW46IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgdG9vbHMgPSBuZXcgVG9vbHMuVG9vbENvbGxlY3Rpb24oY29uZmlnLnRvb2xib3gpO1xuICAgICAgICB0aGlzLnRvb2xfcGFuZWwgPSBuZXcgVG9vbHMuVG9vbFBhbmVsKHtcbiAgICAgICAgICAgIHRvb2xfc2VhcmNoOiB0b29sX3NlYXJjaCxcbiAgICAgICAgICAgIHRvb2xzOiB0b29scyxcbiAgICAgICAgICAgIGxheW91dDogY29uZmlnLnRvb2xib3hfaW5fcGFuZWxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudG9vbF9wYW5lbF92aWV3ID0gbmV3IFRvb2xzLlRvb2xQYW5lbFZpZXcoe1xuICAgICAgICAgICAgbW9kZWw6IHRoaXMudG9vbF9wYW5lbFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBhZGQgdXBsb2FkIG1vZGFsXG4gICAgICAgIHRoaXMudXBsb2FkX2J1dHRvbiA9IG5ldyBVcGxvYWQoe1xuICAgICAgICAgICAgbmdpbnhfdXBsb2FkX3BhdGg6IGNvbmZpZy5uZ2lueF91cGxvYWRfcGF0aCxcbiAgICAgICAgICAgIGZ0cF91cGxvYWRfc2l0ZTogY29uZmlnLmZ0cF91cGxvYWRfc2l0ZSxcbiAgICAgICAgICAgIGRlZmF1bHRfZ2Vub21lOiBjb25maWcuZGVmYXVsdF9nZW5vbWUsXG4gICAgICAgICAgICBkZWZhdWx0X2V4dGVuc2lvbjogY29uZmlnLmRlZmF1bHRfZXh0ZW5zaW9uXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkZCB1cGxvYWRlciBidXR0b24gdG8gR2FsYXh5IG9iamVjdFxuICAgICAgICBHYWxheHkudXBsb2FkID0gdGhpcy51cGxvYWRfYnV0dG9uO1xuXG4gICAgICAgIC8vIGNvbXBvbmVudHMgZm9yIHBhbmVsIGRlZmluaXRpb25cbiAgICAgICAgdGhpcy5tb2RlbCA9IG5ldyBCYWNrYm9uZS5Nb2RlbCh7XG4gICAgICAgICAgICB0aXRsZTogX2woXCJUb29sc1wiKSxcbiAgICAgICAgICAgIGJ1dHRvbnM6IFt0aGlzLnVwbG9hZF9idXR0b25dXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGJ1aWxkIGJvZHkgdGVtcGxhdGVcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMuX3RlbXBsYXRlKCkpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBpZiB0aGVyZSBhcmUgdG9vbHMsIHJlbmRlciBwYW5lbCBhbmQgZGlzcGxheSBldmVyeXRoaW5nXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMudG9vbF9wYW5lbC5nZXQoXCJsYXlvdXRcIikuc2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgdGhpcy4kZWwucHJlcGVuZCh0aGlzLnRvb2xfcGFuZWxfdmlldy4kZWwpO1xuICAgICAgICAgICAgdGhpcy50b29sX3BhbmVsX3ZpZXcucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gYnVpbGQgdGhlIGRvbSBmb3IgdGhlIHdvcmtmbG93IHBvcnRpb24gb2YgdGhlIHRvb2wgbWVudVxuICAgICAgICAvLyBhZGQgaW50ZXJuYWwgd29ya2Zsb3cgbGlzdFxuICAgICAgICBzZWxmLiQoXCIjaW50ZXJuYWwtd29ya2Zsb3dzXCIpLmFwcGVuZChcbiAgICAgICAgICAgIHNlbGYuX3RlbXBsYXRlQWxsV29ya2Zsb3coe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkFsbCB3b3JrZmxvd3NcIiksXG4gICAgICAgICAgICAgICAgaHJlZjogXCJ3b3JrZmxvd3MvbGlzdFwiXG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBfLmVhY2godGhpcy5zdG9yZWRfd29ya2Zsb3dfbWVudV9lbnRyaWVzLCBtZW51X2VudHJ5ID0+IHtcbiAgICAgICAgICAgIHNlbGYuJChcIiNpbnRlcm5hbC13b3JrZmxvd3NcIikuYXBwZW5kKFxuICAgICAgICAgICAgICAgIHNlbGYuX3RlbXBsYXRlV29ya2Zsb3dMaW5rKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG1lbnVfZW50cnkuc3RvcmVkX3dvcmtmbG93Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGhyZWY6IGB3b3JrZmxvd3MvcnVuP2lkPSR7bWVudV9lbnRyeS5lbmNvZGVkX3N0b3JlZF93b3JrZmxvd19pZH1gXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogYnVpbGQgYSBsaW5rIHRvIG9uZSB0b29sICovXG4gICAgX3RlbXBsYXRlVG9vbDogZnVuY3Rpb24odG9vbCkge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0b29sVGl0bGVcIj4nLFxuICAgICAgICAgICAgJzxhIGhyZWY9XCInLFxuICAgICAgICAgICAgdGhpcy5yb290LFxuICAgICAgICAgICAgdG9vbC5ocmVmLFxuICAgICAgICAgICAgJ1wiIHRhcmdldD1cImdhbGF4eV9tYWluXCI+JyxcbiAgICAgICAgICAgIHRvb2wudGl0bGUsXG4gICAgICAgICAgICBcIjwvYT5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgXS5qb2luKFwiXCIpO1xuICAgIH0sXG5cbiAgICAvKiogYnVpbGQgYSBsaW5rIHRvICdBbGwgV29ya2Zsb3dzJyAqL1xuICAgIF90ZW1wbGF0ZUFsbFdvcmtmbG93OiBmdW5jdGlvbih0b29sKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRvb2xUaXRsZVwiPicsXG4gICAgICAgICAgICAvLyBnbG9iYWxcbiAgICAgICAgICAgICc8YSBocmVmPVwiJyxcbiAgICAgICAgICAgIEdhbGF4eS5yb290LFxuICAgICAgICAgICAgdG9vbC5ocmVmLFxuICAgICAgICAgICAgJ1wiPicsXG4gICAgICAgICAgICB0b29sLnRpdGxlLFxuICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0uam9pbihcIlwiKTtcbiAgICB9LFxuXG4gICAgLyoqIGJ1aWxkIGxpbmtzIHRvIHdvcmtmbG93cyBpbiB0b29scGFuZWwgKi9cbiAgICBfdGVtcGxhdGVXb3JrZmxvd0xpbms6IGZ1bmN0aW9uKHdmKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRvb2xUaXRsZVwiPicsXG4gICAgICAgICAgICBgPGEgY2xhc3M9XCIke3dmLmNsc30gXCIgaHJlZj1cImAsXG4gICAgICAgICAgICBHYWxheHkucm9vdCxcbiAgICAgICAgICAgIHdmLmhyZWYsXG4gICAgICAgICAgICAnXCI+JyxcbiAgICAgICAgICAgIHdmLnRpdGxlLFxuICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0uam9pbihcIlwiKTtcbiAgICB9LFxuXG4gICAgLyoqIG92ZXJyaWRlIHRvIGluY2x1ZGUgaW5pdGFsIG1lbnUgZG9tIGFuZCB3b3JrZmxvdyBzZWN0aW9uICovXG4gICAgX3RlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidG9vbE1lbnVDb250YWluZXJcIj4nLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ0b29sTWVudVwiIHN0eWxlPVwiZGlzcGxheTogbm9uZVwiPicsXG4gICAgICAgICAgICAnPGRpdiBpZD1cInNlYXJjaC1uby1yZXN1bHRzXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lOyBwYWRkaW5nLXRvcDogNXB4XCI+JyxcbiAgICAgICAgICAgIFwiPGVtPjxzdHJvbmc+XCIsXG4gICAgICAgICAgICBfbChcIlNlYXJjaCBkaWQgbm90IG1hdGNoIGFueSB0b29scy5cIiksXG4gICAgICAgICAgICBcIjwvc3Ryb25nPjwvZW0+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgXCI8L2Rpdj5cIixcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidG9vbFNlY3Rpb25QYWRcIi8+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidG9vbFNlY3Rpb25QYWRcIi8+JyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidG9vbFNlY3Rpb25UaXRsZVwiIGlkPVwidGl0bGVfWFhpbnRlcm5hbFhYd29ya2Zsb3dcIj4nLFxuICAgICAgICAgICAgXCI8c3Bhbj5cIixcbiAgICAgICAgICAgIF9sKFwiV29ya2Zsb3dzXCIpLFxuICAgICAgICAgICAgXCI8L3NwYW4+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiLFxuICAgICAgICAgICAgJzxkaXYgaWQ9XCJpbnRlcm5hbC13b3JrZmxvd3NcIiBjbGFzcz1cInRvb2xTZWN0aW9uQm9keVwiPicsXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInRvb2xTZWN0aW9uQmdcIi8+JyxcbiAgICAgICAgICAgIFwiPC9kaXY+XCIsXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgIF0uam9pbihcIlwiKTtcbiAgICB9LFxuXG4gICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXCJ0b29sUGFuZWxcIjtcbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgVG9vbFBhbmVsO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL2FwcHMvcGFuZWxzL3Rvb2wtcGFuZWwuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTNJQTtBQUNBO0FBNklBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///252\n");

/***/ }),
/* 253 */
/*!**************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-view.js ***!
  \**************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiModal = __webpack_require__(/*! mvc/ui/ui-modal */ 9);\n\nvar _uiModal2 = _interopRequireDefault(_uiModal);\n\nvar _uiTabs = __webpack_require__(/*! mvc/ui/ui-tabs */ 80);\n\nvar _uiTabs2 = _interopRequireDefault(_uiTabs);\n\nvar _uploadButton = __webpack_require__(/*! mvc/upload/upload-button */ 254);\n\nvar _uploadButton2 = _interopRequireDefault(_uploadButton);\n\nvar _defaultView = __webpack_require__(/*! mvc/upload/default/default-view */ 255);\n\nvar _defaultView2 = _interopRequireDefault(_defaultView);\n\nvar _compositeView = __webpack_require__(/*! mvc/upload/composite/composite-view */ 258);\n\nvar _compositeView2 = _interopRequireDefault(_compositeView);\n\nvar _collectionView = __webpack_require__(/*! mvc/upload/collection/collection-view */ 260);\n\nvar _collectionView2 = _interopRequireDefault(_collectionView);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    options: {\n        nginx_upload_path: \"\",\n        ftp_upload_site: \"n/a\",\n        default_genome: \"?\",\n        default_extension: \"auto\",\n        height: 500,\n        width: 900,\n        auto: {\n            id: \"auto\",\n            text: \"Auto-detect\",\n            description: \"This system will try to detect the file type automatically. If your file is not detected properly as one of the known formats, it most likely means that it has some format problems (e.g., different number of columns on different rows). You can still coerce the system to set your data to the format you think it should be.  You can also upload compressed files, which will automatically be decompressed.\"\n        }\n    },\n\n    // contains all available dataset extensions/types\n    list_extensions: [],\n\n    // contains all available genomes\n    list_genomes: [],\n\n    initialize: function initialize(options) {\n        var self = this;\n        this.options = _utils2.default.merge(options, this.options);\n\n        // create view for upload/progress button\n        this.ui_button = new _uploadButton2.default.View({\n            onclick: function onclick(e) {\n                e.preventDefault();\n                self.show();\n            },\n            onunload: function onunload() {\n                var percentage = self.ui_button.model.get(\"percentage\", 0);\n                if (percentage > 0 && percentage < 100) {\n                    return \"Several uploads are queued.\";\n                }\n            }\n        });\n\n        // set element to button view\n        this.setElement(this.ui_button.$el);\n\n        // load extensions\n        var self = this;\n        _utils2.default.get({\n            url: Galaxy.root + \"api/datatypes?extension_only=False\",\n            success: function success(datatypes) {\n                for (var key in datatypes) {\n                    self.list_extensions.push({\n                        id: datatypes[key].extension,\n                        text: datatypes[key].extension,\n                        description: datatypes[key].description,\n                        description_url: datatypes[key].description_url,\n                        composite_files: datatypes[key].composite_files\n                    });\n                }\n                self.list_extensions.sort(function (a, b) {\n                    var a_text = a.text && a.text.toLowerCase();\n                    var b_text = b.text && b.text.toLowerCase();\n                    return a_text > b_text ? 1 : a_text < b_text ? -1 : 0;\n                });\n                if (!self.options.datatypes_disable_auto) {\n                    self.list_extensions.unshift(self.options.auto);\n                }\n            }\n        });\n\n        // load genomes\n        _utils2.default.get({\n            url: Galaxy.root + \"api/genomes\",\n            success: function success(genomes) {\n                for (var key in genomes) {\n                    self.list_genomes.push({\n                        id: genomes[key][1],\n                        text: genomes[key][0]\n                    });\n                }\n                self.list_genomes.sort(function (a, b) {\n                    if (a.id == self.options.default_genome) {\n                        return -1;\n                    }\n                    if (b.id == self.options.default_genome) {\n                        return 1;\n                    }\n                    return a.text > b.text ? 1 : a.text < b.text ? -1 : 0;\n                });\n            }\n        });\n    },\n\n    /** Show/hide upload dialog */\n    show: function show() {\n        var self = this;\n        if (!Galaxy.currHistoryPanel || !Galaxy.currHistoryPanel.model) {\n            window.setTimeout(function () {\n                self.show();\n            }, 500);\n            return;\n        }\n        this.current_user = Galaxy.user.id;\n        if (!this.modal) {\n            this.tabs = new _uiTabs2.default.View();\n            this.default_view = new _defaultView2.default(this);\n            this.tabs.add({\n                id: \"regular\",\n                title: (0, _localization2.default)(\"Regular\"),\n                $el: this.default_view.$el\n            });\n            this.composite_view = new _compositeView2.default(this);\n            this.tabs.add({\n                id: \"composite\",\n                title: (0, _localization2.default)(\"Composite\"),\n                $el: this.composite_view.$el\n            });\n            this.collection_view = new _collectionView2.default(this);\n            this.tabs.add({\n                id: \"collection\",\n                title: (0, _localization2.default)(\"Collection\"),\n                $el: this.collection_view.$el\n            });\n            this.modal = new _uiModal2.default.View({\n                title: (0, _localization2.default)(\"Download from web or upload from disk\"),\n                body: this.tabs.$el,\n                height: this.options.height,\n                width: this.options.width,\n                closing_events: true,\n                title_separator: false\n            });\n        }\n        this.modal.show();\n    },\n\n    /** Refresh user and current history */\n    currentHistory: function currentHistory() {\n        return this.current_user && Galaxy.currHistoryPanel.model.get(\"id\");\n    },\n\n    /** Get ftp configuration */\n    currentFtp: function currentFtp() {\n        return this.current_user && this.options.ftp_upload_site;\n    },\n\n    /**\n     * Package API data from array of models\n     * @param{Array} items - Upload items/rows filtered from a collection\n     */\n    toData: function toData(items, history_id) {\n        // create dictionary for data submission\n        var data = {\n            payload: {\n                tool_id: \"upload1\",\n                history_id: history_id || this.currentHistory(),\n                inputs: {}\n            },\n            files: [],\n            error_message: null\n        };\n        // add upload tools input data\n        if (items && items.length > 0) {\n            var inputs = {\n                file_count: items.length,\n                dbkey: items[0].get(\"genome\", \"?\"),\n                file_type: items[0].get(\"extension\", \"auto\")\n            };\n            for (var index in items) {\n                var it = items[index];\n                it.set(\"status\", \"running\");\n                if (it.get(\"file_size\") > 0) {\n                    var prefix = \"files_\" + index + \"|\";\n                    inputs[prefix + \"type\"] = \"upload_dataset\";\n                    inputs[prefix + \"space_to_tab\"] = it.get(\"space_to_tab\") && \"Yes\" || null;\n                    inputs[prefix + \"to_posix_lines\"] = it.get(\"to_posix_lines\") && \"Yes\" || null;\n                    inputs[prefix + \"dbkey\"] = it.get(\"genome\", null);\n                    inputs[prefix + \"file_type\"] = it.get(\"extension\", null);\n                    switch (it.get(\"file_mode\")) {\n                        case \"new\":\n                            inputs[prefix + \"url_paste\"] = it.get(\"url_paste\");\n                            break;\n                        case \"ftp\":\n                            inputs[prefix + \"ftp_files\"] = it.get(\"file_path\");\n                            break;\n                        case \"local\":\n                            data.files.push({\n                                name: prefix + \"file_data\",\n                                file: it.get(\"file_data\")\n                            });\n                    }\n                } else {\n                    data.error_message = \"Upload content incomplete.\";\n                    it.set(\"status\", \"error\");\n                    it.set(\"info\", data.error_message);\n                    break;\n                }\n            }\n            data.payload.inputs = JSON.stringify(inputs);\n        }\n        return data;\n    }\n});\n/** Upload app contains the upload progress button and upload modal, compiles model data for API request **/\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvdXBsb2FkLXZpZXcuanM/ZTc3NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFVwbG9hZCBhcHAgY29udGFpbnMgdGhlIHVwbG9hZCBwcm9ncmVzcyBidXR0b24gYW5kIHVwbG9hZCBtb2RhbCwgY29tcGlsZXMgbW9kZWwgZGF0YSBmb3IgQVBJIHJlcXVlc3QgKiovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5pbXBvcnQgTW9kYWwgZnJvbSBcIm12Yy91aS91aS1tb2RhbFwiO1xuaW1wb3J0IFRhYnMgZnJvbSBcIm12Yy91aS91aS10YWJzXCI7XG5pbXBvcnQgVXBsb2FkQnV0dG9uIGZyb20gXCJtdmMvdXBsb2FkL3VwbG9hZC1idXR0b25cIjtcbmltcG9ydCBVcGxvYWRWaWV3RGVmYXVsdCBmcm9tIFwibXZjL3VwbG9hZC9kZWZhdWx0L2RlZmF1bHQtdmlld1wiO1xuaW1wb3J0IFVwbG9hZFZpZXdDb21wb3NpdGUgZnJvbSBcIm12Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS12aWV3XCI7XG5pbXBvcnQgVXBsb2FkVmlld0NvbGxlY3Rpb24gZnJvbSBcIm12Yy91cGxvYWQvY29sbGVjdGlvbi9jb2xsZWN0aW9uLXZpZXdcIjtcbmV4cG9ydCBkZWZhdWx0IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBvcHRpb25zOiB7XG4gICAgICAgIG5naW54X3VwbG9hZF9wYXRoOiBcIlwiLFxuICAgICAgICBmdHBfdXBsb2FkX3NpdGU6IFwibi9hXCIsXG4gICAgICAgIGRlZmF1bHRfZ2Vub21lOiBcIj9cIixcbiAgICAgICAgZGVmYXVsdF9leHRlbnNpb246IFwiYXV0b1wiLFxuICAgICAgICBoZWlnaHQ6IDUwMCxcbiAgICAgICAgd2lkdGg6IDkwMCxcbiAgICAgICAgYXV0bzoge1xuICAgICAgICAgICAgaWQ6IFwiYXV0b1wiLFxuICAgICAgICAgICAgdGV4dDogXCJBdXRvLWRldGVjdFwiLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICAgICAgXCJUaGlzIHN5c3RlbSB3aWxsIHRyeSB0byBkZXRlY3QgdGhlIGZpbGUgdHlwZSBhdXRvbWF0aWNhbGx5LiBJZiB5b3VyIGZpbGUgaXMgbm90IGRldGVjdGVkIHByb3Blcmx5IGFzIG9uZSBvZiB0aGUga25vd24gZm9ybWF0cywgaXQgbW9zdCBsaWtlbHkgbWVhbnMgdGhhdCBpdCBoYXMgc29tZSBmb3JtYXQgcHJvYmxlbXMgKGUuZy4sIGRpZmZlcmVudCBudW1iZXIgb2YgY29sdW1ucyBvbiBkaWZmZXJlbnQgcm93cykuIFlvdSBjYW4gc3RpbGwgY29lcmNlIHRoZSBzeXN0ZW0gdG8gc2V0IHlvdXIgZGF0YSB0byB0aGUgZm9ybWF0IHlvdSB0aGluayBpdCBzaG91bGQgYmUuICBZb3UgY2FuIGFsc28gdXBsb2FkIGNvbXByZXNzZWQgZmlsZXMsIHdoaWNoIHdpbGwgYXV0b21hdGljYWxseSBiZSBkZWNvbXByZXNzZWQuXCJcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBjb250YWlucyBhbGwgYXZhaWxhYmxlIGRhdGFzZXQgZXh0ZW5zaW9ucy90eXBlc1xuICAgIGxpc3RfZXh0ZW5zaW9uczogW10sXG5cbiAgICAvLyBjb250YWlucyBhbGwgYXZhaWxhYmxlIGdlbm9tZXNcbiAgICBsaXN0X2dlbm9tZXM6IFtdLFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IFV0aWxzLm1lcmdlKG9wdGlvbnMsIHRoaXMub3B0aW9ucyk7XG5cbiAgICAgICAgLy8gY3JlYXRlIHZpZXcgZm9yIHVwbG9hZC9wcm9ncmVzcyBidXR0b25cbiAgICAgICAgdGhpcy51aV9idXR0b24gPSBuZXcgVXBsb2FkQnV0dG9uLlZpZXcoe1xuICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBzZWxmLnNob3coKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbnVubG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBzZWxmLnVpX2J1dHRvbi5tb2RlbC5nZXQoXCJwZXJjZW50YWdlXCIsIDApO1xuICAgICAgICAgICAgICAgIGlmIChwZXJjZW50YWdlID4gMCAmJiBwZXJjZW50YWdlIDwgMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlNldmVyYWwgdXBsb2FkcyBhcmUgcXVldWVkLlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc2V0IGVsZW1lbnQgdG8gYnV0dG9uIHZpZXdcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMudWlfYnV0dG9uLiRlbCk7XG5cbiAgICAgICAgLy8gbG9hZCBleHRlbnNpb25zXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgVXRpbHMuZ2V0KHtcbiAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3R9YXBpL2RhdGF0eXBlcz9leHRlbnNpb25fb25seT1GYWxzZWAsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhdHlwZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YXR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdF9leHRlbnNpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGRhdGF0eXBlc1trZXldLmV4dGVuc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGRhdGF0eXBlc1trZXldLmV4dGVuc2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhdHlwZXNba2V5XS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uX3VybDogZGF0YXR5cGVzW2tleV0uZGVzY3JpcHRpb25fdXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlX2ZpbGVzOiBkYXRhdHlwZXNba2V5XS5jb21wb3NpdGVfZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYubGlzdF9leHRlbnNpb25zLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFfdGV4dCA9IGEudGV4dCAmJiBhLnRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJfdGV4dCA9IGIudGV4dCAmJiBiLnRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFfdGV4dCA+IGJfdGV4dCA/IDEgOiBhX3RleHQgPCBiX3RleHQgPyAtMSA6IDA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZWxmLm9wdGlvbnMuZGF0YXR5cGVzX2Rpc2FibGVfYXV0bykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RfZXh0ZW5zaW9ucy51bnNoaWZ0KHNlbGYub3B0aW9ucy5hdXRvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGxvYWQgZ2Vub21lc1xuICAgICAgICBVdGlscy5nZXQoe1xuICAgICAgICAgICAgdXJsOiBgJHtHYWxheHkucm9vdH1hcGkvZ2Vub21lc2AsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihnZW5vbWVzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGdlbm9tZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0X2dlbm9tZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogZ2Vub21lc1trZXldWzFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZ2Vub21lc1trZXldWzBdXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLmxpc3RfZ2Vub21lcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmlkID09IHNlbGYub3B0aW9ucy5kZWZhdWx0X2dlbm9tZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChiLmlkID09IHNlbGYub3B0aW9ucy5kZWZhdWx0X2dlbm9tZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEudGV4dCA+IGIudGV4dCA/IDEgOiBhLnRleHQgPCBiLnRleHQgPyAtMSA6IDA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogU2hvdy9oaWRlIHVwbG9hZCBkaWFsb2cgKi9cbiAgICBzaG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBpZiAoIUdhbGF4eS5jdXJySGlzdG9yeVBhbmVsIHx8ICFHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5tb2RlbCkge1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN1cnJlbnRfdXNlciA9IEdhbGF4eS51c2VyLmlkO1xuICAgICAgICBpZiAoIXRoaXMubW9kYWwpIHtcbiAgICAgICAgICAgIHRoaXMudGFicyA9IG5ldyBUYWJzLlZpZXcoKTtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdF92aWV3ID0gbmV3IFVwbG9hZFZpZXdEZWZhdWx0KHRoaXMpO1xuICAgICAgICAgICAgdGhpcy50YWJzLmFkZCh7XG4gICAgICAgICAgICAgICAgaWQ6IFwicmVndWxhclwiLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlJlZ3VsYXJcIiksXG4gICAgICAgICAgICAgICAgJGVsOiB0aGlzLmRlZmF1bHRfdmlldy4kZWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jb21wb3NpdGVfdmlldyA9IG5ldyBVcGxvYWRWaWV3Q29tcG9zaXRlKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy50YWJzLmFkZCh7XG4gICAgICAgICAgICAgICAgaWQ6IFwiY29tcG9zaXRlXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ29tcG9zaXRlXCIpLFxuICAgICAgICAgICAgICAgICRlbDogdGhpcy5jb21wb3NpdGVfdmlldy4kZWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uX3ZpZXcgPSBuZXcgVXBsb2FkVmlld0NvbGxlY3Rpb24odGhpcyk7XG4gICAgICAgICAgICB0aGlzLnRhYnMuYWRkKHtcbiAgICAgICAgICAgICAgICBpZDogXCJjb2xsZWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ29sbGVjdGlvblwiKSxcbiAgICAgICAgICAgICAgICAkZWw6IHRoaXMuY29sbGVjdGlvbl92aWV3LiRlbFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm1vZGFsID0gbmV3IE1vZGFsLlZpZXcoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkRvd25sb2FkIGZyb20gd2ViIG9yIHVwbG9hZCBmcm9tIGRpc2tcIiksXG4gICAgICAgICAgICAgICAgYm9keTogdGhpcy50YWJzLiRlbCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMub3B0aW9ucy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMub3B0aW9ucy53aWR0aCxcbiAgICAgICAgICAgICAgICBjbG9zaW5nX2V2ZW50czogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0aXRsZV9zZXBhcmF0b3I6IGZhbHNlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vZGFsLnNob3coKTtcbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggdXNlciBhbmQgY3VycmVudCBoaXN0b3J5ICovXG4gICAgY3VycmVudEhpc3Rvcnk6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50X3VzZXIgJiYgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubW9kZWwuZ2V0KFwiaWRcIik7XG4gICAgfSxcblxuICAgIC8qKiBHZXQgZnRwIGNvbmZpZ3VyYXRpb24gKi9cbiAgICBjdXJyZW50RnRwOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudF91c2VyICYmIHRoaXMub3B0aW9ucy5mdHBfdXBsb2FkX3NpdGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFBhY2thZ2UgQVBJIGRhdGEgZnJvbSBhcnJheSBvZiBtb2RlbHNcbiAgICAgKiBAcGFyYW17QXJyYXl9IGl0ZW1zIC0gVXBsb2FkIGl0ZW1zL3Jvd3MgZmlsdGVyZWQgZnJvbSBhIGNvbGxlY3Rpb25cbiAgICAgKi9cbiAgICB0b0RhdGE6IGZ1bmN0aW9uKGl0ZW1zLCBoaXN0b3J5X2lkKSB7XG4gICAgICAgIC8vIGNyZWF0ZSBkaWN0aW9uYXJ5IGZvciBkYXRhIHN1Ym1pc3Npb25cbiAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgICAgICAgdG9vbF9pZDogXCJ1cGxvYWQxXCIsXG4gICAgICAgICAgICAgICAgaGlzdG9yeV9pZDogaGlzdG9yeV9pZCB8fCB0aGlzLmN1cnJlbnRIaXN0b3J5KCksXG4gICAgICAgICAgICAgICAgaW5wdXRzOiB7fVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZpbGVzOiBbXSxcbiAgICAgICAgICAgIGVycm9yX21lc3NhZ2U6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgLy8gYWRkIHVwbG9hZCB0b29scyBpbnB1dCBkYXRhXG4gICAgICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRzID0ge1xuICAgICAgICAgICAgICAgIGZpbGVfY291bnQ6IGl0ZW1zLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBkYmtleTogaXRlbXNbMF0uZ2V0KFwiZ2Vub21lXCIsIFwiP1wiKSxcbiAgICAgICAgICAgICAgICBmaWxlX3R5cGU6IGl0ZW1zWzBdLmdldChcImV4dGVuc2lvblwiLCBcImF1dG9cIilcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCBpbiBpdGVtcykge1xuICAgICAgICAgICAgICAgIHZhciBpdCA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgICAgICAgICBpdC5zZXQoXCJzdGF0dXNcIiwgXCJydW5uaW5nXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpdC5nZXQoXCJmaWxlX3NpemVcIikgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVmaXggPSBgZmlsZXNfJHtpbmRleH18YDtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRzW2Ake3ByZWZpeH10eXBlYF0gPSBcInVwbG9hZF9kYXRhc2V0XCI7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0c1tgJHtwcmVmaXh9c3BhY2VfdG9fdGFiYF0gPSAoaXQuZ2V0KFwic3BhY2VfdG9fdGFiXCIpICYmIFwiWWVzXCIpIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0c1tgJHtwcmVmaXh9dG9fcG9zaXhfbGluZXNgXSA9IChpdC5nZXQoXCJ0b19wb3NpeF9saW5lc1wiKSAmJiBcIlllc1wiKSB8fCBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dHNbYCR7cHJlZml4fWRia2V5YF0gPSBpdC5nZXQoXCJnZW5vbWVcIiwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0c1tgJHtwcmVmaXh9ZmlsZV90eXBlYF0gPSBpdC5nZXQoXCJleHRlbnNpb25cIiwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaXQuZ2V0KFwiZmlsZV9tb2RlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibmV3XCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzW2Ake3ByZWZpeH11cmxfcGFzdGVgXSA9IGl0LmdldChcInVybF9wYXN0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJmdHBcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHNbYCR7cHJlZml4fWZ0cF9maWxlc2BdID0gaXQuZ2V0KFwiZmlsZV9wYXRoXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxvY2FsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5maWxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYCR7cHJlZml4fWZpbGVfZGF0YWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGU6IGl0LmdldChcImZpbGVfZGF0YVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5lcnJvcl9tZXNzYWdlID0gXCJVcGxvYWQgY29udGVudCBpbmNvbXBsZXRlLlwiO1xuICAgICAgICAgICAgICAgICAgICBpdC5zZXQoXCJzdGF0dXNcIiwgXCJlcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgaXQuc2V0KFwiaW5mb1wiLCBkYXRhLmVycm9yX21lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLnBheWxvYWQuaW5wdXRzID0gSlNPTi5zdHJpbmdpZnkoaW5wdXRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdXBsb2FkL3VwbG9hZC12aWV3LmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBUEE7QUFDQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFwQkE7QUFDQTtBQXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEJBO0FBb0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFSQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0TUE7QUFSQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///253\n");

/***/ }),
/* 254 */
/*!****************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/upload-button.js ***!
  \****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** View for upload/progress bar button */\n\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        this.model = options && options.model || new Backbone.Model({\n            icon: \"fa-upload\",\n            tooltip: (0, _localization2.default)(\"Download from URL or upload files from disk\"),\n            label: \"Load Data\",\n            percentage: 0,\n            status: \"\",\n            onunload: function onunload() {},\n            onclick: function onclick() {}\n        }).set(options);\n        this.setElement(this._template());\n        this.$progress = this.$(\".progress-bar\");\n        this.listenTo(this.model, \"change\", this.render, this);\n        this.render();\n        $(window).on(\"beforeunload\", function () {\n            return self.model.get(\"onunload\")();\n        });\n    },\n\n    render: function render() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el.off(\"click\").on(\"click\", function (e) {\n            options.onclick(e);\n        }).tooltip({\n            title: this.model.get(\"tooltip\"),\n            placement: \"bottom\"\n        });\n        this.$progress.removeClass().addClass(\"progress-bar\").addClass(\"progress-bar-notransition\").addClass(options.status != \"\" && \"progress-bar-\" + options.status).css({ width: options.percentage + \"%\" });\n    },\n\n    /** Template */\n    _template: function _template() {\n        return '<div class=\"upload-button\">' + '<div class=\"progress\">' + '<div class=\"progress-bar\"/>' + '<a class=\"panel-header-button\" href=\"javascript:void(0)\" id=\"tool-panel-upload-button\">' + '<span class=\"fa fa-upload\"/>' + \"</a>\" + \"</div>\" + \"</div>\";\n    }\n});\nexports.default = { View: View };\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvdXBsb2FkLWJ1dHRvbi5qcz9hNDdmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG4vKiogVmlldyBmb3IgdXBsb2FkL3Byb2dyZXNzIGJhciBidXR0b24gKi9cblxudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMubW9kZWwgPVxuICAgICAgICAgICAgKG9wdGlvbnMgJiYgb3B0aW9ucy5tb2RlbCkgfHxcbiAgICAgICAgICAgIG5ldyBCYWNrYm9uZS5Nb2RlbCh7XG4gICAgICAgICAgICAgICAgaWNvbjogXCJmYS11cGxvYWRcIixcbiAgICAgICAgICAgICAgICB0b29sdGlwOiBfbChcIkRvd25sb2FkIGZyb20gVVJMIG9yIHVwbG9hZCBmaWxlcyBmcm9tIGRpc2tcIiksXG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiTG9hZCBEYXRhXCIsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMCxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IFwiXCIsXG4gICAgICAgICAgICAgICAgb251bmxvYWQ6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7fVxuICAgICAgICAgICAgfSkuc2V0KG9wdGlvbnMpO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUoKSk7XG4gICAgICAgIHRoaXMuJHByb2dyZXNzID0gdGhpcy4kKFwiLnByb2dyZXNzLWJhclwiKTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZVwiLCB0aGlzLnJlbmRlciwgdGhpcyk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICQod2luZG93KS5vbihcImJlZm9yZXVubG9hZFwiLCAoKSA9PiBzZWxmLm1vZGVsLmdldChcIm9udW5sb2FkXCIpKCkpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5tb2RlbC5hdHRyaWJ1dGVzO1xuICAgICAgICB0aGlzLiRlbFxuICAgICAgICAgICAgLm9mZihcImNsaWNrXCIpXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLm9uY2xpY2soZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRvb2x0aXAoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLm1vZGVsLmdldChcInRvb2x0aXBcIiksXG4gICAgICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4kcHJvZ3Jlc3NcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoXCJwcm9ncmVzcy1iYXJcIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcInByb2dyZXNzLWJhci1ub3RyYW5zaXRpb25cIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyhvcHRpb25zLnN0YXR1cyAhPSBcIlwiICYmIGBwcm9ncmVzcy1iYXItJHtvcHRpb25zLnN0YXR1c31gKVxuICAgICAgICAgICAgLmNzcyh7IHdpZHRoOiBgJHtvcHRpb25zLnBlcmNlbnRhZ2V9JWAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBUZW1wbGF0ZSAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1idXR0b25cIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3NcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicHJvZ3Jlc3MtYmFyXCIvPicgK1xuICAgICAgICAgICAgJzxhIGNsYXNzPVwicGFuZWwtaGVhZGVyLWJ1dHRvblwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIiBpZD1cInRvb2wtcGFuZWwtdXBsb2FkLWJ1dHRvblwiPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwiZmEgZmEtdXBsb2FkXCIvPicgK1xuICAgICAgICAgICAgXCI8L2E+XCIgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5leHBvcnQgZGVmYXVsdCB7IFZpZXc6IFZpZXcgfTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdXBsb2FkL3VwbG9hZC1idXR0b24uanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUlBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVVBO0FBckRBO0FBdURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///254\n");

/***/ }),
/* 255 */
/*!***********************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/default/default-view.js ***!
  \***********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadModel = __webpack_require__(/*! mvc/upload/upload-model */ 49);\n\nvar _uploadModel2 = _interopRequireDefault(_uploadModel);\n\nvar _defaultRow = __webpack_require__(/*! mvc/upload/default/default-row */ 256);\n\nvar _defaultRow2 = _interopRequireDefault(_defaultRow);\n\nvar _uploadFtp2 = __webpack_require__(/*! mvc/upload/upload-ftp */ 93);\n\nvar _uploadFtp3 = _interopRequireDefault(_uploadFtp2);\n\nvar _uploadExtension = __webpack_require__(/*! mvc/upload/upload-extension */ 94);\n\nvar _uploadExtension2 = _interopRequireDefault(_uploadExtension);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _lazyLimited = __webpack_require__(/*! mvc/lazy/lazy-limited */ 257);\n\nvar _lazyLimited2 = _interopRequireDefault(_lazyLimited);\n\n__webpack_require__(/*! utils/uploadbox */ 95);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Renders contents of the default uploader */\nexports.default = Backbone.View.extend({\n    // current upload size in bytes\n    upload_size: 0,\n\n    // contains upload row models\n    collection: new _uploadModel2.default.Collection(),\n\n    // keeps track of the current uploader state\n    counter: {\n        announce: 0,\n        success: 0,\n        error: 0,\n        running: 0,\n        reset: function reset() {\n            this.announce = this.success = this.error = this.running = 0;\n        }\n    },\n\n    initialize: function initialize(app) {\n        var self = this;\n        this.app = app;\n        this.options = app.options;\n        this.list_extensions = app.list_extensions;\n        this.list_genomes = app.list_genomes;\n        this.ui_button = app.ui_button;\n        this.ftp_upload_site = app.currentFtp();\n\n        // build template\n        this.setElement(this._template());\n        this.$uploadbox = this.$(\".upload-box\");\n        this.$uploadtable = this.$(\".upload-table\");\n\n        // append buttons to dom\n        this.btnLocal = new _uiMisc2.default.Button({\n            id: \"btn-local\",\n            title: (0, _localization2.default)(\"Choose local file\"),\n            onclick: function onclick() {\n                self.uploadbox.select();\n            },\n            icon: \"fa fa-laptop\"\n        });\n        this.btnFtp = new _uiMisc2.default.Button({\n            id: \"btn-ftp\",\n            title: (0, _localization2.default)(\"Choose FTP file\"),\n            onclick: function onclick() {\n                self._eventFtp();\n            },\n            icon: \"fa fa-folder-open-o\"\n        });\n        this.btnCreate = new _uiMisc2.default.Button({\n            id: \"btn-new\",\n            title: \"Paste/Fetch data\",\n            onclick: function onclick() {\n                self._eventCreate();\n            },\n            icon: \"fa fa-edit\"\n        });\n        this.btnStart = new _uiMisc2.default.Button({\n            id: \"btn-start\",\n            title: (0, _localization2.default)(\"Start\"),\n            onclick: function onclick() {\n                self._eventStart();\n            }\n        });\n        this.btnStop = new _uiMisc2.default.Button({\n            id: \"btn-stop\",\n            title: (0, _localization2.default)(\"Pause\"),\n            onclick: function onclick() {\n                self._eventStop();\n            }\n        });\n        this.btnReset = new _uiMisc2.default.Button({\n            id: \"btn-reset\",\n            title: (0, _localization2.default)(\"Reset\"),\n            onclick: function onclick() {\n                self._eventReset();\n            }\n        });\n        this.btnClose = new _uiMisc2.default.Button({\n            id: \"btn-close\",\n            title: (0, _localization2.default)(\"Close\"),\n            onclick: function onclick() {\n                self.app.modal.hide();\n            }\n        });\n        _.each([this.btnLocal, this.btnFtp, this.btnCreate, this.btnStop, this.btnReset, this.btnStart, this.btnClose], function (button) {\n            self.$(\".upload-buttons\").prepend(button.$el);\n        });\n\n        // file upload\n        this.uploadbox = this.$uploadbox.uploadbox({\n            url: this.app.options.nginx_upload_path,\n            announce: function announce(index, file) {\n                self._eventAnnounce(index, file);\n            },\n            initialize: function initialize(index) {\n                return self.app.toData([self.collection.get(index)], self.history_id);\n            },\n            progress: function progress(index, percentage) {\n                self._eventProgress(index, percentage);\n            },\n            success: function success(index, message) {\n                self._eventSuccess(index, message);\n            },\n            error: function error(index, message) {\n                self._eventError(index, message);\n            },\n            complete: function complete() {\n                self._eventComplete();\n            },\n            ondragover: function ondragover() {\n                self.$uploadbox.addClass(\"highlight\");\n            },\n            ondragleave: function ondragleave() {\n                self.$uploadbox.removeClass(\"highlight\");\n            }\n        });\n\n        // add ftp file viewer\n        this.ftp = new _uiPopover2.default.View({\n            title: (0, _localization2.default)(\"FTP files\"),\n            container: this.btnFtp.$el\n        });\n\n        // select extension\n        this.select_extension = new _uiSelect2.default.View({\n            css: \"upload-footer-selection\",\n            container: this.$(\".upload-footer-extension\"),\n            data: _.filter(this.list_extensions, function (ext) {\n                return !ext.composite_files;\n            }),\n            value: this.options.default_extension,\n            onchange: function onchange(extension) {\n                self._changeExtension(extension);\n            }\n        });\n\n        // handle extension info popover\n        this.$(\".upload-footer-extension-info\").on(\"click\", function (e) {\n            new _uploadExtension2.default({\n                $el: $(e.target),\n                title: self.select_extension.text(),\n                extension: self.select_extension.value(),\n                list: self.list_extensions,\n                placement: \"top\"\n            });\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // genome extension\n        this.select_genome = new _uiSelect2.default.View({\n            css: \"upload-footer-selection\",\n            container: this.$(\".upload-footer-genome\"),\n            data: this.list_genomes,\n            value: this.options.default_genome,\n            onchange: function onchange(genome) {\n                self._changeGenome(genome);\n            }\n        });\n\n        // Lazy load helper\n        this.loader = new _lazyLimited2.default({\n            $container: this.$uploadbox,\n            collection: this.collection,\n            new_content: function new_content(model) {\n                var upload_row = new _defaultRow2.default(self, { model: model });\n                self.$uploadtable.find(\"> tbody:first\").append(upload_row.$el);\n                upload_row.render();\n                return upload_row;\n            }\n        });\n\n        // events\n        this.collection.on(\"remove\", function (model) {\n            self._eventRemove(model);\n        });\n        this.render();\n    },\n\n    render: function render() {\n        var message = \"\";\n        if (this.counter.announce == 0) {\n            if (this.uploadbox.compatible()) {\n                message = \"&nbsp;\";\n            } else {\n                message = \"Browser does not support Drag & Drop. Try Firefox 4+, Chrome 7+, IE 10+, Opera 12+ or Safari 6+.\";\n            }\n        } else {\n            if (this.counter.running == 0) {\n                message = \"You added \" + this.counter.announce + \" file(s) to the queue. Add more files or click 'Start' to proceed.\";\n            } else {\n                message = \"Please wait...\" + this.counter.announce + \" out of \" + this.counter.running + \" remaining.\";\n            }\n        }\n        this.$(\".upload-top-info\").html(message);\n        var enable_reset = this.counter.running == 0 && this.counter.announce + this.counter.success + this.counter.error > 0;\n        var enable_start = this.counter.running == 0 && this.counter.announce > 0;\n        var enable_sources = this.counter.running == 0;\n        var show_table = this.counter.announce + this.counter.success + this.counter.error > 0;\n        this.btnReset[enable_reset ? \"enable\" : \"disable\"]();\n        this.btnStart[enable_start ? \"enable\" : \"disable\"]();\n        this.btnStart.$el[enable_start ? \"addClass\" : \"removeClass\"](\"btn-primary\");\n        this.btnStop[this.counter.running > 0 ? \"enable\" : \"disable\"]();\n        this.btnLocal[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnFtp[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnCreate[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnFtp.$el[this.ftp_upload_site ? \"show\" : \"hide\"]();\n        this.$(\".upload-table\")[show_table ? \"show\" : \"hide\"]();\n        this.$(\".upload-helper\")[show_table ? \"hide\" : \"show\"]();\n    },\n\n    /** A new file has been dropped/selected through the uploadbox plugin */\n    _eventAnnounce: function _eventAnnounce(index, file) {\n        this.counter.announce++;\n        var new_model = new _uploadModel2.default.Model({\n            id: index,\n            file_name: file.name,\n            file_size: file.size,\n            file_mode: file.mode || \"local\",\n            file_path: file.path,\n            file_data: file\n        });\n        this.render();\n        this.collection.add(new_model);\n    },\n\n    /** Progress */\n    _eventProgress: function _eventProgress(index, percentage) {\n        var it = this.collection.get(index);\n        it.set(\"percentage\", percentage);\n        this.ui_button.model.set(\"percentage\", this._uploadPercentage(percentage, it.get(\"file_size\")));\n    },\n\n    /** Success */\n    _eventSuccess: function _eventSuccess(index, message) {\n        var it = this.collection.get(index);\n        it.set({ percentage: 100, status: \"success\" });\n        this.ui_button.model.set(\"percentage\", this._uploadPercentage(100, it.get(\"file_size\")));\n        this.upload_completed += it.get(\"file_size\") * 100;\n        this.counter.announce--;\n        this.counter.success++;\n        this.render();\n        Galaxy.currHistoryPanel.refreshContents();\n    },\n\n    /** Error */\n    _eventError: function _eventError(index, message) {\n        var it = this.collection.get(index);\n        it.set({ percentage: 100, status: \"error\", info: message });\n        this.ui_button.model.set({\n            percentage: this._uploadPercentage(100, it.get(\"file_size\")),\n            status: \"danger\"\n        });\n        this.upload_completed += it.get(\"file_size\") * 100;\n        this.counter.announce--;\n        this.counter.error++;\n        this.render();\n    },\n\n    /** Queue is done */\n    _eventComplete: function _eventComplete() {\n        this.collection.each(function (model) {\n            model.get(\"status\") == \"queued\" && model.set(\"status\", \"init\");\n        });\n        this.counter.running = 0;\n        this.render();\n    },\n\n    /** Remove model from upload list */\n    _eventRemove: function _eventRemove(model) {\n        var status = model.get(\"status\");\n        if (status == \"success\") {\n            this.counter.success--;\n        } else if (status == \"error\") {\n            this.counter.error--;\n        } else {\n            this.counter.announce--;\n        }\n        this.uploadbox.remove(model.id);\n        this.render();\n    },\n\n    //\n    // events triggered by this view\n    //\n\n    /** Show/hide ftp popup */\n    _eventFtp: function _eventFtp() {\n        if (!this.ftp.visible) {\n            this.ftp.empty();\n            var self = this;\n            this.ftp.append(new _uploadFtp3.default({\n                collection: this.collection,\n                ftp_upload_site: this.ftp_upload_site,\n                onadd: function onadd(ftp_file) {\n                    return self.uploadbox.add([{\n                        mode: \"ftp\",\n                        name: ftp_file.path,\n                        size: ftp_file.size,\n                        path: ftp_file.path\n                    }]);\n                },\n                onremove: function onremove(model_index) {\n                    self.collection.remove(model_index);\n                }\n            }).$el);\n            this.ftp.show();\n        } else {\n            this.ftp.hide();\n        }\n    },\n\n    /** Create a new file */\n    _eventCreate: function _eventCreate() {\n        this.uploadbox.add([{ name: \"New File\", size: 0, mode: \"new\" }]);\n    },\n\n    /** Start upload process */\n    _eventStart: function _eventStart() {\n        if (this.counter.announce != 0 && this.counter.running == 0) {\n            // prepare upload process\n            var self = this;\n            this.upload_size = 0;\n            this.upload_completed = 0;\n            this.collection.each(function (model) {\n                if (model.get(\"status\") == \"init\") {\n                    model.set(\"status\", \"queued\");\n                    self.upload_size += model.get(\"file_size\");\n                }\n            });\n            this.ui_button.model.set({\n                percentage: 0,\n                status: \"success\"\n            });\n            this.counter.running = this.counter.announce;\n            this.history_id = this.app.currentHistory();\n\n            // package ftp files separately, and remove them from queue\n            this._uploadFtp();\n\n            // queue remaining files\n            this.uploadbox.start();\n            this.render();\n        }\n    },\n\n    /** Pause upload process */\n    _eventStop: function _eventStop() {\n        if (this.counter.running > 0) {\n            this.ui_button.model.set(\"status\", \"info\");\n            $(\".upload-top-info\").html(\"Queue will pause after completing the current file...\");\n            this.uploadbox.stop();\n        }\n    },\n\n    /** Remove all */\n    _eventReset: function _eventReset() {\n        if (this.counter.running == 0) {\n            var self = this;\n            this.collection.reset();\n            this.counter.reset();\n            this.uploadbox.reset();\n            this.select_extension.value(this.options.default_extension);\n            this.select_genome.value(this.options.default_genome);\n            this.ui_button.model.set(\"percentage\", 0);\n            this.render();\n        }\n    },\n\n    /** Update extension for all models */\n    _changeExtension: function _changeExtension(extension, defaults_only) {\n        var self = this;\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"init\" && (model.get(\"extension\") == self.options.default_extension || !defaults_only)) {\n                model.set(\"extension\", extension);\n            }\n        });\n    },\n\n    /** Update genome for all models */\n    _changeGenome: function _changeGenome(genome, defaults_only) {\n        var self = this;\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"init\" && (model.get(\"genome\") == self.options.default_genome || !defaults_only)) {\n                model.set(\"genome\", genome);\n            }\n        });\n    },\n\n    /** Package and upload ftp files in a single request */\n    _uploadFtp: function _uploadFtp() {\n        var self = this;\n        var list = [];\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"queued\" && model.get(\"file_mode\") == \"ftp\") {\n                self.uploadbox.remove(model.id);\n                list.push(model);\n            }\n        });\n        if (list.length > 0) {\n            $.uploadpost({\n                data: this.app.toData(list),\n                url: this.app.options.nginx_upload_path,\n                success: function success(message) {\n                    _.each(list, function (model) {\n                        self._eventSuccess(model.id);\n                    });\n                },\n                error: function error(message) {\n                    _.each(list, function (model) {\n                        self._eventError(model.id, message);\n                    });\n                }\n            });\n        }\n    },\n\n    /** Calculate percentage of all queued uploads */\n    _uploadPercentage: function _uploadPercentage(percentage, size) {\n        return (this.upload_completed + percentage * size) / this.upload_size;\n    },\n\n    /** Template */\n    _template: function _template() {\n        return '<div class=\"upload-view-default\">' + '<div class=\"upload-top\">' + '<h6 class=\"upload-top-info\"/>' + \"</div>\" + '<div class=\"upload-box\">' + '<div class=\"upload-helper\"><i class=\"fa fa-files-o\"/>Drop files here</div>' + '<table class=\"upload-table ui-table-striped\" style=\"display: none;\">' + \"<thead>\" + \"<tr>\" + \"<th>Name</th>\" + \"<th>Size</th>\" + \"<th>Type</th>\" + \"<th>Genome</th>\" + \"<th>Settings</th>\" + \"<th>Status</th>\" + \"<th/>\" + \"</tr>\" + \"</thead>\" + \"<tbody/>\" + \"</table>\" + \"</div>\" + '<div class=\"upload-footer\">' + '<span class=\"upload-footer-title\">Type (set all):</span>' + '<span class=\"upload-footer-extension\"/>' + '<span class=\"upload-footer-extension-info upload-icon-button fa fa-search\"/> ' + '<span class=\"upload-footer-title\">Genome (set all):</span>' + '<span class=\"upload-footer-genome\"/>' + \"</div>\" + '<div class=\"upload-buttons\"/>' + \"</div>\";\n    }\n});\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvZGVmYXVsdC9kZWZhdWx0LXZpZXcuanM/OWY2ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFJlbmRlcnMgY29udGVudHMgb2YgdGhlIGRlZmF1bHQgdXBsb2FkZXIgKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBVcGxvYWRNb2RlbCBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtbW9kZWxcIjtcbmltcG9ydCBVcGxvYWRSb3cgZnJvbSBcIm12Yy91cGxvYWQvZGVmYXVsdC9kZWZhdWx0LXJvd1wiO1xuaW1wb3J0IFVwbG9hZEZ0cCBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtZnRwXCI7XG5pbXBvcnQgVXBsb2FkRXh0ZW5zaW9uIGZyb20gXCJtdmMvdXBsb2FkL3VwbG9hZC1leHRlbnNpb25cIjtcbmltcG9ydCBQb3BvdmVyIGZyb20gXCJtdmMvdWkvdWktcG9wb3ZlclwiO1xuaW1wb3J0IFNlbGVjdCBmcm9tIFwibXZjL3VpL3VpLXNlbGVjdFwiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xuaW1wb3J0IExhenlMaW1pdGVkIGZyb20gXCJtdmMvbGF6eS9sYXp5LWxpbWl0ZWRcIjtcbmltcG9ydCBcInV0aWxzL3VwbG9hZGJveFwiO1xuZXhwb3J0IGRlZmF1bHQgQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIC8vIGN1cnJlbnQgdXBsb2FkIHNpemUgaW4gYnl0ZXNcbiAgICB1cGxvYWRfc2l6ZTogMCxcblxuICAgIC8vIGNvbnRhaW5zIHVwbG9hZCByb3cgbW9kZWxzXG4gICAgY29sbGVjdGlvbjogbmV3IFVwbG9hZE1vZGVsLkNvbGxlY3Rpb24oKSxcblxuICAgIC8vIGtlZXBzIHRyYWNrIG9mIHRoZSBjdXJyZW50IHVwbG9hZGVyIHN0YXRlXG4gICAgY291bnRlcjoge1xuICAgICAgICBhbm5vdW5jZTogMCxcbiAgICAgICAgc3VjY2VzczogMCxcbiAgICAgICAgZXJyb3I6IDAsXG4gICAgICAgIHJ1bm5pbmc6IDAsXG4gICAgICAgIHJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuYW5ub3VuY2UgPSB0aGlzLnN1Y2Nlc3MgPSB0aGlzLmVycm9yID0gdGhpcy5ydW5uaW5nID0gMDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhcHApIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gYXBwLm9wdGlvbnM7XG4gICAgICAgIHRoaXMubGlzdF9leHRlbnNpb25zID0gYXBwLmxpc3RfZXh0ZW5zaW9ucztcbiAgICAgICAgdGhpcy5saXN0X2dlbm9tZXMgPSBhcHAubGlzdF9nZW5vbWVzO1xuICAgICAgICB0aGlzLnVpX2J1dHRvbiA9IGFwcC51aV9idXR0b247XG4gICAgICAgIHRoaXMuZnRwX3VwbG9hZF9zaXRlID0gYXBwLmN1cnJlbnRGdHAoKTtcblxuICAgICAgICAvLyBidWlsZCB0ZW1wbGF0ZVxuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUoKSk7XG4gICAgICAgIHRoaXMuJHVwbG9hZGJveCA9IHRoaXMuJChcIi51cGxvYWQtYm94XCIpO1xuICAgICAgICB0aGlzLiR1cGxvYWR0YWJsZSA9IHRoaXMuJChcIi51cGxvYWQtdGFibGVcIik7XG5cbiAgICAgICAgLy8gYXBwZW5kIGJ1dHRvbnMgdG8gZG9tXG4gICAgICAgIHRoaXMuYnRuTG9jYWwgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1sb2NhbFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hvb3NlIGxvY2FsIGZpbGVcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnVwbG9hZGJveC5zZWxlY3QoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLWxhcHRvcFwiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ0bkZ0cCA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgaWQ6IFwiYnRuLWZ0cFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hvb3NlIEZUUCBmaWxlXCIpLFxuICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRGdHAoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLWZvbGRlci1vcGVuLW9cIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idG5DcmVhdGUgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1uZXdcIixcbiAgICAgICAgICAgIHRpdGxlOiBcIlBhc3RlL0ZldGNoIGRhdGFcIixcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50Q3JlYXRlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaWNvbjogXCJmYSBmYS1lZGl0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnRuU3RhcnQgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1zdGFydFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiU3RhcnRcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudFN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ0blN0b3AgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1zdG9wXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJQYXVzZVwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50U3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idG5SZXNldCA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgaWQ6IFwiYnRuLXJlc2V0XCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJSZXNldFwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50UmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnRuQ2xvc2UgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1jbG9zZVwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2xvc2VcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmFwcC5tb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBfLmVhY2goXG4gICAgICAgICAgICBbdGhpcy5idG5Mb2NhbCwgdGhpcy5idG5GdHAsIHRoaXMuYnRuQ3JlYXRlLCB0aGlzLmJ0blN0b3AsIHRoaXMuYnRuUmVzZXQsIHRoaXMuYnRuU3RhcnQsIHRoaXMuYnRuQ2xvc2VdLFxuICAgICAgICAgICAgYnV0dG9uID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLiQoXCIudXBsb2FkLWJ1dHRvbnNcIikucHJlcGVuZChidXR0b24uJGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICAvLyBmaWxlIHVwbG9hZFxuICAgICAgICB0aGlzLnVwbG9hZGJveCA9IHRoaXMuJHVwbG9hZGJveC51cGxvYWRib3goe1xuICAgICAgICAgICAgdXJsOiB0aGlzLmFwcC5vcHRpb25zLm5naW54X3VwbG9hZF9wYXRoLFxuICAgICAgICAgICAgYW5ub3VuY2U6IGZ1bmN0aW9uKGluZGV4LCBmaWxlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRBbm5vdW5jZShpbmRleCwgZmlsZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5hcHAudG9EYXRhKFtzZWxmLmNvbGxlY3Rpb24uZ2V0KGluZGV4KV0sIHNlbGYuaGlzdG9yeV9pZCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uKGluZGV4LCBwZXJjZW50YWdlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRQcm9ncmVzcyhpbmRleCwgcGVyY2VudGFnZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oaW5kZXgsIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudFN1Y2Nlc3MoaW5kZXgsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihpbmRleCwgbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50RXJyb3IoaW5kZXgsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudENvbXBsZXRlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25kcmFnb3ZlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi4kdXBsb2FkYm94LmFkZENsYXNzKFwiaGlnaGxpZ2h0XCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uZHJhZ2xlYXZlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLiR1cGxvYWRib3gucmVtb3ZlQ2xhc3MoXCJoaWdobGlnaHRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkZCBmdHAgZmlsZSB2aWV3ZXJcbiAgICAgICAgdGhpcy5mdHAgPSBuZXcgUG9wb3Zlci5WaWV3KHtcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIkZUUCBmaWxlc1wiKSxcbiAgICAgICAgICAgIGNvbnRhaW5lcjogdGhpcy5idG5GdHAuJGVsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHNlbGVjdCBleHRlbnNpb25cbiAgICAgICAgdGhpcy5zZWxlY3RfZXh0ZW5zaW9uID0gbmV3IFNlbGVjdC5WaWV3KHtcbiAgICAgICAgICAgIGNzczogXCJ1cGxvYWQtZm9vdGVyLXNlbGVjdGlvblwiLFxuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLiQoXCIudXBsb2FkLWZvb3Rlci1leHRlbnNpb25cIiksXG4gICAgICAgICAgICBkYXRhOiBfLmZpbHRlcih0aGlzLmxpc3RfZXh0ZW5zaW9ucywgZXh0ID0+ICFleHQuY29tcG9zaXRlX2ZpbGVzKSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm9wdGlvbnMuZGVmYXVsdF9leHRlbnNpb24sXG4gICAgICAgICAgICBvbmNoYW5nZTogZnVuY3Rpb24oZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fY2hhbmdlRXh0ZW5zaW9uKGV4dGVuc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBleHRlbnNpb24gaW5mbyBwb3BvdmVyXG4gICAgICAgIHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWV4dGVuc2lvbi1pbmZvXCIpXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgVXBsb2FkRXh0ZW5zaW9uKHtcbiAgICAgICAgICAgICAgICAgICAgJGVsOiAkKGUudGFyZ2V0KSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNlbGYuc2VsZWN0X2V4dGVuc2lvbi50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbjogc2VsZi5zZWxlY3RfZXh0ZW5zaW9uLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6IHNlbGYubGlzdF9leHRlbnNpb25zLFxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IFwidG9wXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gZ2Vub21lIGV4dGVuc2lvblxuICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUgPSBuZXcgU2VsZWN0LlZpZXcoe1xuICAgICAgICAgICAgY3NzOiBcInVwbG9hZC1mb290ZXItc2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWdlbm9tZVwiKSxcbiAgICAgICAgICAgIGRhdGE6IHRoaXMubGlzdF9nZW5vbWVzLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMub3B0aW9ucy5kZWZhdWx0X2dlbm9tZSxcbiAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbihnZW5vbWUpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9jaGFuZ2VHZW5vbWUoZ2Vub21lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTGF6eSBsb2FkIGhlbHBlclxuICAgICAgICB0aGlzLmxvYWRlciA9IG5ldyBMYXp5TGltaXRlZCh7XG4gICAgICAgICAgICAkY29udGFpbmVyOiB0aGlzLiR1cGxvYWRib3gsXG4gICAgICAgICAgICBjb2xsZWN0aW9uOiB0aGlzLmNvbGxlY3Rpb24sXG4gICAgICAgICAgICBuZXdfY29udGVudDogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2YXIgdXBsb2FkX3JvdyA9IG5ldyBVcGxvYWRSb3coc2VsZiwgeyBtb2RlbDogbW9kZWwgfSk7XG4gICAgICAgICAgICAgICAgc2VsZi4kdXBsb2FkdGFibGUuZmluZChcIj4gdGJvZHk6Zmlyc3RcIikuYXBwZW5kKHVwbG9hZF9yb3cuJGVsKTtcbiAgICAgICAgICAgICAgICB1cGxvYWRfcm93LnJlbmRlcigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cGxvYWRfcm93O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBldmVudHNcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLm9uKFwicmVtb3ZlXCIsIG1vZGVsID0+IHtcbiAgICAgICAgICAgIHNlbGYuX2V2ZW50UmVtb3ZlKG1vZGVsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcbiAgICAgICAgaWYgKHRoaXMuY291bnRlci5hbm5vdW5jZSA9PSAwKSB7XG4gICAgICAgICAgICBpZiAodGhpcy51cGxvYWRib3guY29tcGF0aWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiJm5ic3A7XCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPVxuICAgICAgICAgICAgICAgICAgICBcIkJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBEcmFnICYgRHJvcC4gVHJ5IEZpcmVmb3ggNCssIENocm9tZSA3KywgSUUgMTArLCBPcGVyYSAxMisgb3IgU2FmYXJpIDYrLlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMuY291bnRlci5ydW5uaW5nID09IDApIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYFlvdSBhZGRlZCAke1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZXIuYW5ub3VuY2VcbiAgICAgICAgICAgICAgICB9IGZpbGUocykgdG8gdGhlIHF1ZXVlLiBBZGQgbW9yZSBmaWxlcyBvciBjbGljayAnU3RhcnQnIHRvIHByb2NlZWQuYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGBQbGVhc2Ugd2FpdC4uLiR7dGhpcy5jb3VudGVyLmFubm91bmNlfSBvdXQgb2YgJHt0aGlzLmNvdW50ZXIucnVubmluZ30gcmVtYWluaW5nLmA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC10b3AtaW5mb1wiKS5odG1sKG1lc3NhZ2UpO1xuICAgICAgICB2YXIgZW5hYmxlX3Jlc2V0ID1cbiAgICAgICAgICAgIHRoaXMuY291bnRlci5ydW5uaW5nID09IDAgJiYgdGhpcy5jb3VudGVyLmFubm91bmNlICsgdGhpcy5jb3VudGVyLnN1Y2Nlc3MgKyB0aGlzLmNvdW50ZXIuZXJyb3IgPiAwO1xuICAgICAgICB2YXIgZW5hYmxlX3N0YXJ0ID0gdGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCAmJiB0aGlzLmNvdW50ZXIuYW5ub3VuY2UgPiAwO1xuICAgICAgICB2YXIgZW5hYmxlX3NvdXJjZXMgPSB0aGlzLmNvdW50ZXIucnVubmluZyA9PSAwO1xuICAgICAgICB2YXIgc2hvd190YWJsZSA9IHRoaXMuY291bnRlci5hbm5vdW5jZSArIHRoaXMuY291bnRlci5zdWNjZXNzICsgdGhpcy5jb3VudGVyLmVycm9yID4gMDtcbiAgICAgICAgdGhpcy5idG5SZXNldFtlbmFibGVfcmVzZXQgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuU3RhcnRbZW5hYmxlX3N0YXJ0ID8gXCJlbmFibGVcIiA6IFwiZGlzYWJsZVwiXSgpO1xuICAgICAgICB0aGlzLmJ0blN0YXJ0LiRlbFtlbmFibGVfc3RhcnQgPyBcImFkZENsYXNzXCIgOiBcInJlbW92ZUNsYXNzXCJdKFwiYnRuLXByaW1hcnlcIik7XG4gICAgICAgIHRoaXMuYnRuU3RvcFt0aGlzLmNvdW50ZXIucnVubmluZyA+IDAgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuTG9jYWxbZW5hYmxlX3NvdXJjZXMgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuRnRwW2VuYWJsZV9zb3VyY2VzID8gXCJlbmFibGVcIiA6IFwiZGlzYWJsZVwiXSgpO1xuICAgICAgICB0aGlzLmJ0bkNyZWF0ZVtlbmFibGVfc291cmNlcyA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgdGhpcy5idG5GdHAuJGVsW3RoaXMuZnRwX3VwbG9hZF9zaXRlID8gXCJzaG93XCIgOiBcImhpZGVcIl0oKTtcbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC10YWJsZVwiKVtzaG93X3RhYmxlID8gXCJzaG93XCIgOiBcImhpZGVcIl0oKTtcbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC1oZWxwZXJcIilbc2hvd190YWJsZSA/IFwiaGlkZVwiIDogXCJzaG93XCJdKCk7XG4gICAgfSxcblxuICAgIC8qKiBBIG5ldyBmaWxlIGhhcyBiZWVuIGRyb3BwZWQvc2VsZWN0ZWQgdGhyb3VnaCB0aGUgdXBsb2FkYm94IHBsdWdpbiAqL1xuICAgIF9ldmVudEFubm91bmNlOiBmdW5jdGlvbihpbmRleCwgZmlsZSkge1xuICAgICAgICB0aGlzLmNvdW50ZXIuYW5ub3VuY2UrKztcbiAgICAgICAgdmFyIG5ld19tb2RlbCA9IG5ldyBVcGxvYWRNb2RlbC5Nb2RlbCh7XG4gICAgICAgICAgICBpZDogaW5kZXgsXG4gICAgICAgICAgICBmaWxlX25hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgIGZpbGVfc2l6ZTogZmlsZS5zaXplLFxuICAgICAgICAgICAgZmlsZV9tb2RlOiBmaWxlLm1vZGUgfHwgXCJsb2NhbFwiLFxuICAgICAgICAgICAgZmlsZV9wYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBmaWxlX2RhdGE6IGZpbGVcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5hZGQobmV3X21vZGVsKTtcbiAgICB9LFxuXG4gICAgLyoqIFByb2dyZXNzICovXG4gICAgX2V2ZW50UHJvZ3Jlc3M6IGZ1bmN0aW9uKGluZGV4LCBwZXJjZW50YWdlKSB7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuY29sbGVjdGlvbi5nZXQoaW5kZXgpO1xuICAgICAgICBpdC5zZXQoXCJwZXJjZW50YWdlXCIsIHBlcmNlbnRhZ2UpO1xuICAgICAgICB0aGlzLnVpX2J1dHRvbi5tb2RlbC5zZXQoXCJwZXJjZW50YWdlXCIsIHRoaXMuX3VwbG9hZFBlcmNlbnRhZ2UocGVyY2VudGFnZSwgaXQuZ2V0KFwiZmlsZV9zaXplXCIpKSk7XG4gICAgfSxcblxuICAgIC8qKiBTdWNjZXNzICovXG4gICAgX2V2ZW50U3VjY2VzczogZnVuY3Rpb24oaW5kZXgsIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5jb2xsZWN0aW9uLmdldChpbmRleCk7XG4gICAgICAgIGl0LnNldCh7IHBlcmNlbnRhZ2U6IDEwMCwgc3RhdHVzOiBcInN1Y2Nlc3NcIiB9KTtcbiAgICAgICAgdGhpcy51aV9idXR0b24ubW9kZWwuc2V0KFwicGVyY2VudGFnZVwiLCB0aGlzLl91cGxvYWRQZXJjZW50YWdlKDEwMCwgaXQuZ2V0KFwiZmlsZV9zaXplXCIpKSk7XG4gICAgICAgIHRoaXMudXBsb2FkX2NvbXBsZXRlZCArPSBpdC5nZXQoXCJmaWxlX3NpemVcIikgKiAxMDA7XG4gICAgICAgIHRoaXMuY291bnRlci5hbm5vdW5jZS0tO1xuICAgICAgICB0aGlzLmNvdW50ZXIuc3VjY2VzcysrO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5yZWZyZXNoQ29udGVudHMoKTtcbiAgICB9LFxuXG4gICAgLyoqIEVycm9yICovXG4gICAgX2V2ZW50RXJyb3I6IGZ1bmN0aW9uKGluZGV4LCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuY29sbGVjdGlvbi5nZXQoaW5kZXgpO1xuICAgICAgICBpdC5zZXQoeyBwZXJjZW50YWdlOiAxMDAsIHN0YXR1czogXCJlcnJvclwiLCBpbmZvOiBtZXNzYWdlIH0pO1xuICAgICAgICB0aGlzLnVpX2J1dHRvbi5tb2RlbC5zZXQoe1xuICAgICAgICAgICAgcGVyY2VudGFnZTogdGhpcy5fdXBsb2FkUGVyY2VudGFnZSgxMDAsIGl0LmdldChcImZpbGVfc2l6ZVwiKSksXG4gICAgICAgICAgICBzdGF0dXM6IFwiZGFuZ2VyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBsb2FkX2NvbXBsZXRlZCArPSBpdC5nZXQoXCJmaWxlX3NpemVcIikgKiAxMDA7XG4gICAgICAgIHRoaXMuY291bnRlci5hbm5vdW5jZS0tO1xuICAgICAgICB0aGlzLmNvdW50ZXIuZXJyb3IrKztcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgLyoqIFF1ZXVlIGlzIGRvbmUgKi9cbiAgICBfZXZlbnRDb21wbGV0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5lYWNoKG1vZGVsID0+IHtcbiAgICAgICAgICAgIG1vZGVsLmdldChcInN0YXR1c1wiKSA9PSBcInF1ZXVlZFwiICYmIG1vZGVsLnNldChcInN0YXR1c1wiLCBcImluaXRcIik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvdW50ZXIucnVubmluZyA9IDA7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIC8qKiBSZW1vdmUgbW9kZWwgZnJvbSB1cGxvYWQgbGlzdCAqL1xuICAgIF9ldmVudFJlbW92ZTogZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgdmFyIHN0YXR1cyA9IG1vZGVsLmdldChcInN0YXR1c1wiKTtcbiAgICAgICAgaWYgKHN0YXR1cyA9PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgdGhpcy5jb3VudGVyLnN1Y2Nlc3MtLTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT0gXCJlcnJvclwiKSB7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXIuZXJyb3ItLTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY291bnRlci5hbm5vdW5jZS0tO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBsb2FkYm94LnJlbW92ZShtb2RlbC5pZCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIC8vXG4gICAgLy8gZXZlbnRzIHRyaWdnZXJlZCBieSB0aGlzIHZpZXdcbiAgICAvL1xuXG4gICAgLyoqIFNob3cvaGlkZSBmdHAgcG9wdXAgKi9cbiAgICBfZXZlbnRGdHA6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuZnRwLnZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuZnRwLmVtcHR5KCk7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmZ0cC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgbmV3IFVwbG9hZEZ0cCh7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb246IHRoaXMuY29sbGVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZnRwX3VwbG9hZF9zaXRlOiB0aGlzLmZ0cF91cGxvYWRfc2l0ZSxcbiAgICAgICAgICAgICAgICAgICAgb25hZGQ6IGZ1bmN0aW9uKGZ0cF9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi51cGxvYWRib3guYWRkKFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6IFwiZnRwXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGZ0cF9maWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IGZ0cF9maWxlLnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGZ0cF9maWxlLnBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgb25yZW1vdmU6IGZ1bmN0aW9uKG1vZGVsX2luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbGxlY3Rpb24ucmVtb3ZlKG1vZGVsX2luZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLiRlbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuZnRwLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZnRwLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogQ3JlYXRlIGEgbmV3IGZpbGUgKi9cbiAgICBfZXZlbnRDcmVhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnVwbG9hZGJveC5hZGQoW3sgbmFtZTogXCJOZXcgRmlsZVwiLCBzaXplOiAwLCBtb2RlOiBcIm5ld1wiIH1dKTtcbiAgICB9LFxuXG4gICAgLyoqIFN0YXJ0IHVwbG9hZCBwcm9jZXNzICovXG4gICAgX2V2ZW50U3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jb3VudGVyLmFubm91bmNlICE9IDAgJiYgdGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCkge1xuICAgICAgICAgICAgLy8gcHJlcGFyZSB1cGxvYWQgcHJvY2Vzc1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy51cGxvYWRfc2l6ZSA9IDA7XG4gICAgICAgICAgICB0aGlzLnVwbG9hZF9jb21wbGV0ZWQgPSAwO1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5nZXQoXCJzdGF0dXNcIikgPT0gXCJpbml0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuc2V0KFwic3RhdHVzXCIsIFwicXVldWVkXCIpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnVwbG9hZF9zaXplICs9IG1vZGVsLmdldChcImZpbGVfc2l6ZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudWlfYnV0dG9uLm1vZGVsLnNldCh7XG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMCxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IFwic3VjY2Vzc1wiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuY291bnRlci5ydW5uaW5nID0gdGhpcy5jb3VudGVyLmFubm91bmNlO1xuICAgICAgICAgICAgdGhpcy5oaXN0b3J5X2lkID0gdGhpcy5hcHAuY3VycmVudEhpc3RvcnkoKTtcblxuICAgICAgICAgICAgLy8gcGFja2FnZSBmdHAgZmlsZXMgc2VwYXJhdGVseSwgYW5kIHJlbW92ZSB0aGVtIGZyb20gcXVldWVcbiAgICAgICAgICAgIHRoaXMuX3VwbG9hZEZ0cCgpO1xuXG4gICAgICAgICAgICAvLyBxdWV1ZSByZW1haW5pbmcgZmlsZXNcbiAgICAgICAgICAgIHRoaXMudXBsb2FkYm94LnN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBQYXVzZSB1cGxvYWQgcHJvY2VzcyAqL1xuICAgIF9ldmVudFN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jb3VudGVyLnJ1bm5pbmcgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnVpX2J1dHRvbi5tb2RlbC5zZXQoXCJzdGF0dXNcIiwgXCJpbmZvXCIpO1xuICAgICAgICAgICAgJChcIi51cGxvYWQtdG9wLWluZm9cIikuaHRtbChcIlF1ZXVlIHdpbGwgcGF1c2UgYWZ0ZXIgY29tcGxldGluZyB0aGUgY3VycmVudCBmaWxlLi4uXCIpO1xuICAgICAgICAgICAgdGhpcy51cGxvYWRib3guc3RvcCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZW1vdmUgYWxsICovXG4gICAgX2V2ZW50UmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXIucmVzZXQoKTtcbiAgICAgICAgICAgIHRoaXMudXBsb2FkYm94LnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdF9leHRlbnNpb24udmFsdWUodGhpcy5vcHRpb25zLmRlZmF1bHRfZXh0ZW5zaW9uKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2dlbm9tZS52YWx1ZSh0aGlzLm9wdGlvbnMuZGVmYXVsdF9nZW5vbWUpO1xuICAgICAgICAgICAgdGhpcy51aV9idXR0b24ubW9kZWwuc2V0KFwicGVyY2VudGFnZVwiLCAwKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFVwZGF0ZSBleHRlbnNpb24gZm9yIGFsbCBtb2RlbHMgKi9cbiAgICBfY2hhbmdlRXh0ZW5zaW9uOiBmdW5jdGlvbihleHRlbnNpb24sIGRlZmF1bHRzX29ubHkpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgbW9kZWwuZ2V0KFwic3RhdHVzXCIpID09IFwiaW5pdFwiICYmXG4gICAgICAgICAgICAgICAgKG1vZGVsLmdldChcImV4dGVuc2lvblwiKSA9PSBzZWxmLm9wdGlvbnMuZGVmYXVsdF9leHRlbnNpb24gfHwgIWRlZmF1bHRzX29ubHkpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBtb2RlbC5zZXQoXCJleHRlbnNpb25cIiwgZXh0ZW5zaW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBVcGRhdGUgZ2Vub21lIGZvciBhbGwgbW9kZWxzICovXG4gICAgX2NoYW5nZUdlbm9tZTogZnVuY3Rpb24oZ2Vub21lLCBkZWZhdWx0c19vbmx5KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIG1vZGVsLmdldChcInN0YXR1c1wiKSA9PSBcImluaXRcIiAmJlxuICAgICAgICAgICAgICAgIChtb2RlbC5nZXQoXCJnZW5vbWVcIikgPT0gc2VsZi5vcHRpb25zLmRlZmF1bHRfZ2Vub21lIHx8ICFkZWZhdWx0c19vbmx5KVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwuc2V0KFwiZ2Vub21lXCIsIGdlbm9tZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogUGFja2FnZSBhbmQgdXBsb2FkIGZ0cCBmaWxlcyBpbiBhIHNpbmdsZSByZXF1ZXN0ICovXG4gICAgX3VwbG9hZEZ0cDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGxpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgaWYgKG1vZGVsLmdldChcInN0YXR1c1wiKSA9PSBcInF1ZXVlZFwiICYmIG1vZGVsLmdldChcImZpbGVfbW9kZVwiKSA9PSBcImZ0cFwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZi51cGxvYWRib3gucmVtb3ZlKG1vZGVsLmlkKTtcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2gobW9kZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgJC51cGxvYWRwb3N0KHtcbiAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLmFwcC50b0RhdGEobGlzdCksXG4gICAgICAgICAgICAgICAgdXJsOiB0aGlzLmFwcC5vcHRpb25zLm5naW54X3VwbG9hZF9wYXRoLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGxpc3QsIG1vZGVsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50U3VjY2Vzcyhtb2RlbC5pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGxpc3QsIG1vZGVsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50RXJyb3IobW9kZWwuaWQsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogQ2FsY3VsYXRlIHBlcmNlbnRhZ2Ugb2YgYWxsIHF1ZXVlZCB1cGxvYWRzICovXG4gICAgX3VwbG9hZFBlcmNlbnRhZ2U6IGZ1bmN0aW9uKHBlcmNlbnRhZ2UsIHNpemUpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnVwbG9hZF9jb21wbGV0ZWQgKyBwZXJjZW50YWdlICogc2l6ZSkgLyB0aGlzLnVwbG9hZF9zaXplO1xuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgKi9cbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtdmlldy1kZWZhdWx0XCI+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC10b3BcIj4nICtcbiAgICAgICAgICAgICc8aDYgY2xhc3M9XCJ1cGxvYWQtdG9wLWluZm9cIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWJveFwiPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtaGVscGVyXCI+PGkgY2xhc3M9XCJmYSBmYS1maWxlcy1vXCIvPkRyb3AgZmlsZXMgaGVyZTwvZGl2PicgK1xuICAgICAgICAgICAgJzx0YWJsZSBjbGFzcz1cInVwbG9hZC10YWJsZSB1aS10YWJsZS1zdHJpcGVkXCIgc3R5bGU9XCJkaXNwbGF5OiBub25lO1wiPicgK1xuICAgICAgICAgICAgXCI8dGhlYWQ+XCIgK1xuICAgICAgICAgICAgXCI8dHI+XCIgK1xuICAgICAgICAgICAgXCI8dGg+TmFtZTwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+U2l6ZTwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+VHlwZTwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+R2Vub21lPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5TZXR0aW5nczwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+U3RhdHVzPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aC8+XCIgK1xuICAgICAgICAgICAgXCI8L3RyPlwiICtcbiAgICAgICAgICAgIFwiPC90aGVhZD5cIiArXG4gICAgICAgICAgICBcIjx0Ym9keS8+XCIgK1xuICAgICAgICAgICAgXCI8L3RhYmxlPlwiICtcbiAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtZm9vdGVyXCI+JyArXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ1cGxvYWQtZm9vdGVyLXRpdGxlXCI+VHlwZSAoc2V0IGFsbCk6PC9zcGFuPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci1leHRlbnNpb25cIi8+JyArXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ1cGxvYWQtZm9vdGVyLWV4dGVuc2lvbi1pbmZvIHVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1zZWFyY2hcIi8+ICcgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci10aXRsZVwiPkdlbm9tZSAoc2V0IGFsbCk6PC9zcGFuPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci1nZW5vbWVcIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWJ1dHRvbnNcIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC9kZWZhdWx0L2RlZmF1bHQtdmlldy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBWEE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJBO0FBQ0E7QUEyQkE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBa0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQ0E7QUExZEE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///255\n");

/***/ }),
/* 256 */
/*!**********************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/default/default-row.js ***!
  \**********************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadModel = __webpack_require__(/*! mvc/upload/upload-model */ 49);\n\nvar _uploadModel2 = _interopRequireDefault(_uploadModel);\n\nvar _uploadSettings = __webpack_require__(/*! mvc/upload/upload-settings */ 92);\n\nvar _uploadSettings2 = _interopRequireDefault(_uploadSettings);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    /** Dictionary of upload states and associated icons */\n    status_classes: {\n        init: \"upload-icon-button fa fa-trash-o\",\n        queued: \"upload-icon fa fa-spinner fa-spin\",\n        running: \"upload-icon fa fa-spinner fa-spin\",\n        success: \"upload-icon-button fa fa-check\",\n        error: \"upload-icon-button fa fa-exclamation-triangle\"\n    },\n\n    initialize: function initialize(app, options) {\n        var self = this;\n        this.app = app;\n        this.model = options.model;\n        this.setElement(this._template(options.model));\n        this.$mode = this.$(\".upload-mode\");\n        this.$title = this.$(\".upload-title\");\n        this.$text = this.$(\".upload-text\");\n        this.$size = this.$(\".upload-size\");\n        this.$info_text = this.$(\".upload-info-text\");\n        this.$info_progress = this.$(\".upload-info-progress\");\n        this.$text_content = this.$(\".upload-text-content\");\n        this.$settings = this.$(\".upload-settings\");\n        this.$symbol = this.$(\".upload-symbol\");\n        this.$progress_bar = this.$(\".upload-progress-bar\");\n        this.$percentage = this.$(\".upload-percentage\");\n\n        // append popup to settings icon\n        this.settings = new _uiPopover2.default.View({\n            title: (0, _localization2.default)(\"Upload configuration\"),\n            container: this.$(\".upload-settings\"),\n            placement: \"bottom\"\n        });\n\n        // identify default genome and extension values\n        var default_genome = this.app.select_genome.value();\n        var default_extension = this.app.select_extension.value();\n\n        // create select genomes\n        this.select_genome = new _uiSelect2.default.View({\n            css: \"upload-genome\",\n            data: self.app.list_genomes,\n            container: this.$(\".upload-genome\"),\n            value: default_genome,\n            onchange: function onchange(genome) {\n                self.model.set(\"genome\", genome);\n            }\n        });\n\n        // create select extension\n        this.select_extension = new _uiSelect2.default.View({\n            css: \"upload-extension\",\n            data: self.app.list_extensions,\n            container: this.$(\".upload-extension\"),\n            value: default_extension,\n            onchange: function onchange(extension) {\n                self.model.set(\"extension\", extension);\n            }\n        });\n\n        // initialize genome and extension values\n        this.model.set({\n            genome: default_genome,\n            extension: default_extension\n        });\n\n        // handle click event\n        this.$symbol.on(\"click\", function () {\n            self._removeRow();\n        });\n\n        // handle extension info popover\n        this.$(\".upload-extension-info\").on(\"click\", function (e) {\n            self.app.showExtensionInfo({\n                $el: $(e.target),\n                title: self.select_extension.text(),\n                extension: self.select_extension.value()\n            });\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // handle settings popover\n        this.$settings.on(\"click\", function (e) {\n            self._showSettings();\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // handle text editing event\n        this.$text_content.on(\"change input\", function (e) {\n            self.model.set({\n                url_paste: $(e.target).val(),\n                file_size: $(e.target).val().length\n            });\n        });\n\n        // model events\n        this.listenTo(this.model, \"change:percentage\", function () {\n            self._refreshPercentage();\n        });\n        this.listenTo(this.model, \"change:status\", function () {\n            self._refreshStatus();\n        });\n        this.listenTo(this.model, \"change:info\", function () {\n            self._refreshInfo();\n        });\n        this.listenTo(this.model, \"change:genome\", function () {\n            self._refreshGenome();\n        });\n        this.listenTo(this.model, \"change:extension\", function () {\n            self._refreshExtension();\n        });\n        this.listenTo(this.model, \"change:file_size\", function () {\n            self._refreshFileSize();\n        });\n    },\n\n    render: function render() {\n        this._refreshType();\n        this._refreshPercentage();\n        this._refreshStatus();\n        this._refreshInfo();\n        this._refreshGenome();\n        this._refreshExtension();\n        this._refreshFileSize();\n    },\n\n    /** Remove view */\n    remove: function remove() {\n        this.select_genome.remove();\n        this.select_extension.remove();\n        Backbone.View.prototype.remove.apply(this);\n    },\n\n    /** Render type */\n    _refreshType: function _refreshType() {\n        var options = this.model.attributes;\n        this.$title.html(_.escape(options.file_name));\n        this.$size.html(_utils2.default.bytesToString(options.file_size));\n        this.$mode.removeClass().addClass(\"upload-mode\").addClass(\"text-primary\");\n        if (options.file_mode == \"new\") {\n            this.$text.css({\n                width: this.$el.width() - 16 + \"px\",\n                top: this.$el.height() - 8 + \"px\"\n            }).show();\n            this.$el.height(this.$el.height() - 8 + this.$text.height() + 16);\n            this.$mode.addClass(\"fa fa-edit\");\n        } else if (options.file_mode == \"local\") {\n            this.$mode.addClass(\"fa fa-laptop\");\n        } else if (options.file_mode == \"ftp\") {\n            this.$mode.addClass(\"fa fa-folder-open-o\");\n        }\n    },\n\n    /** Update extension */\n    _refreshExtension: function _refreshExtension() {\n        this.select_extension.value(this.model.get(\"extension\"));\n    },\n\n    /** Update genome */\n    _refreshGenome: function _refreshGenome() {\n        this.select_genome.value(this.model.get(\"genome\"));\n    },\n\n    /** Refresh info text */\n    _refreshInfo: function _refreshInfo() {\n        var info = this.model.get(\"info\");\n        if (info) {\n            this.$info_text.html(\"<strong>Failed: </strong>\" + info).show();\n        } else {\n            this.$info_text.hide();\n        }\n    },\n\n    /** Refresh percentage status */\n    _refreshPercentage: function _refreshPercentage() {\n        var percentage = parseInt(this.model.get(\"percentage\"));\n        this.$progress_bar.css({ width: percentage + \"%\" });\n        this.$percentage.html(percentage != 100 ? percentage + \"%\" : \"Adding to history...\");\n    },\n\n    /** Refresh status */\n    _refreshStatus: function _refreshStatus() {\n        var status = this.model.get(\"status\");\n        this.$symbol.removeClass().addClass(\"upload-symbol\").addClass(this.status_classes[status]);\n        this.model.set(\"enabled\", status == \"init\");\n        var enabled = this.model.get(\"enabled\");\n        this.$text_content.attr(\"disabled\", !enabled);\n        if (enabled) {\n            this.select_genome.enable();\n            this.select_extension.enable();\n        } else {\n            this.select_genome.disable();\n            this.select_extension.disable();\n        }\n        if (status == \"success\") {\n            this.$el.addClass(\"success\");\n            this.$percentage.html(\"100%\");\n        }\n        if (status == \"error\") {\n            this.$el.addClass(\"danger\");\n            this.$info_progress.hide();\n        }\n    },\n\n    /** Refresh file size */\n    _refreshFileSize: function _refreshFileSize() {\n        this.$size.html(_utils2.default.bytesToString(this.model.get(\"file_size\")));\n    },\n\n    /** Remove row */\n    _removeRow: function _removeRow() {\n        if ([\"init\", \"success\", \"error\"].indexOf(this.model.get(\"status\")) !== -1) {\n            this.app.collection.remove(this.model);\n        }\n    },\n\n    /** Attach file info popup */\n    _showSettings: function _showSettings() {\n        if (!this.settings.visible) {\n            this.settings.empty();\n            this.settings.append(new _uploadSettings2.default(this).$el);\n            this.settings.show();\n        } else {\n            this.settings.hide();\n        }\n    },\n\n    /** View template */\n    _template: function _template(options) {\n        return \"<tr id=\\\"upload-row-\" + options.id + \"\\\" class=\\\"upload-row\\\"><td><div class=\\\"upload-text-column\\\"><div class=\\\"upload-mode\\\"/><div class=\\\"upload-title\\\"/><div class=\\\"upload-text\\\"><div class=\\\"upload-text-info\\\">You can tell Galaxy to download data from web by entering URL in this box (one per line). You can also directly paste the contents of a file.</div><textarea class=\\\"upload-text-content form-control\\\"/></div></div></td><td><div class=\\\"upload-size\\\"/></td><td><div class=\\\"upload-extension\\\" style=\\\"float: left;\\\"/>&nbsp;&nbsp<div class=\\\"upload-extension-info upload-icon-button fa fa-search\\\"/></td><td><div class=\\\"upload-genome\\\"/></td><td><div class=\\\"upload-settings upload-icon-button fa fa-gear\\\"/></td><td><div class=\\\"upload-info\\\"><div class=\\\"upload-info-text\\\"/><div class=\\\"upload-info-progress progress\\\"><div class=\\\"upload-progress-bar progress-bar progress-bar-success\\\"/><div class=\\\"upload-percentage\\\">0%</div></div></div></td><td><div class=\\\"upload-symbol \" + this.status_classes.init + \"\\\"/></td></tr>\";\n    }\n});\n/** Renders the default uploader rows */\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvZGVmYXVsdC9kZWZhdWx0LXJvdy5qcz9hYzU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG4vKiogUmVuZGVycyB0aGUgZGVmYXVsdCB1cGxvYWRlciByb3dzICovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5pbXBvcnQgVXBsb2FkTW9kZWwgZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLW1vZGVsXCI7XG5pbXBvcnQgVXBsb2FkU2V0dGluZ3MgZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLXNldHRpbmdzXCI7XG5pbXBvcnQgUG9wb3ZlciBmcm9tIFwibXZjL3VpL3VpLXBvcG92ZXJcIjtcbmltcG9ydCBTZWxlY3QgZnJvbSBcIm12Yy91aS91aS1zZWxlY3RcIjtcbmV4cG9ydCBkZWZhdWx0IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICAvKiogRGljdGlvbmFyeSBvZiB1cGxvYWQgc3RhdGVzIGFuZCBhc3NvY2lhdGVkIGljb25zICovXG4gICAgc3RhdHVzX2NsYXNzZXM6IHtcbiAgICAgICAgaW5pdDogXCJ1cGxvYWQtaWNvbi1idXR0b24gZmEgZmEtdHJhc2gtb1wiLFxuICAgICAgICBxdWV1ZWQ6IFwidXBsb2FkLWljb24gZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIsXG4gICAgICAgIHJ1bm5pbmc6IFwidXBsb2FkLWljb24gZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIsXG4gICAgICAgIHN1Y2Nlc3M6IFwidXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLWNoZWNrXCIsXG4gICAgICAgIGVycm9yOiBcInVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiXG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGFwcCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLm1vZGVsID0gb3B0aW9ucy5tb2RlbDtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMuX3RlbXBsYXRlKG9wdGlvbnMubW9kZWwpKTtcbiAgICAgICAgdGhpcy4kbW9kZSA9IHRoaXMuJChcIi51cGxvYWQtbW9kZVwiKTtcbiAgICAgICAgdGhpcy4kdGl0bGUgPSB0aGlzLiQoXCIudXBsb2FkLXRpdGxlXCIpO1xuICAgICAgICB0aGlzLiR0ZXh0ID0gdGhpcy4kKFwiLnVwbG9hZC10ZXh0XCIpO1xuICAgICAgICB0aGlzLiRzaXplID0gdGhpcy4kKFwiLnVwbG9hZC1zaXplXCIpO1xuICAgICAgICB0aGlzLiRpbmZvX3RleHQgPSB0aGlzLiQoXCIudXBsb2FkLWluZm8tdGV4dFwiKTtcbiAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcyA9IHRoaXMuJChcIi51cGxvYWQtaW5mby1wcm9ncmVzc1wiKTtcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50ID0gdGhpcy4kKFwiLnVwbG9hZC10ZXh0LWNvbnRlbnRcIik7XG4gICAgICAgIHRoaXMuJHNldHRpbmdzID0gdGhpcy4kKFwiLnVwbG9hZC1zZXR0aW5nc1wiKTtcbiAgICAgICAgdGhpcy4kc3ltYm9sID0gdGhpcy4kKFwiLnVwbG9hZC1zeW1ib2xcIik7XG4gICAgICAgIHRoaXMuJHByb2dyZXNzX2JhciA9IHRoaXMuJChcIi51cGxvYWQtcHJvZ3Jlc3MtYmFyXCIpO1xuICAgICAgICB0aGlzLiRwZXJjZW50YWdlID0gdGhpcy4kKFwiLnVwbG9hZC1wZXJjZW50YWdlXCIpO1xuXG4gICAgICAgIC8vIGFwcGVuZCBwb3B1cCB0byBzZXR0aW5ncyBpY29uXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBuZXcgUG9wb3Zlci5WaWV3KHtcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIlVwbG9hZCBjb25maWd1cmF0aW9uXCIpLFxuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLiQoXCIudXBsb2FkLXNldHRpbmdzXCIpLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlkZW50aWZ5IGRlZmF1bHQgZ2Vub21lIGFuZCBleHRlbnNpb24gdmFsdWVzXG4gICAgICAgIHZhciBkZWZhdWx0X2dlbm9tZSA9IHRoaXMuYXBwLnNlbGVjdF9nZW5vbWUudmFsdWUoKTtcbiAgICAgICAgdmFyIGRlZmF1bHRfZXh0ZW5zaW9uID0gdGhpcy5hcHAuc2VsZWN0X2V4dGVuc2lvbi52YWx1ZSgpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBzZWxlY3QgZ2Vub21lc1xuICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUgPSBuZXcgU2VsZWN0LlZpZXcoe1xuICAgICAgICAgICAgY3NzOiBcInVwbG9hZC1nZW5vbWVcIixcbiAgICAgICAgICAgIGRhdGE6IHNlbGYuYXBwLmxpc3RfZ2Vub21lcyxcbiAgICAgICAgICAgIGNvbnRhaW5lcjogdGhpcy4kKFwiLnVwbG9hZC1nZW5vbWVcIiksXG4gICAgICAgICAgICB2YWx1ZTogZGVmYXVsdF9nZW5vbWUsXG4gICAgICAgICAgICBvbmNoYW5nZTogZnVuY3Rpb24oZ2Vub21lKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5zZXQoXCJnZW5vbWVcIiwgZ2Vub21lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gY3JlYXRlIHNlbGVjdCBleHRlbnNpb25cbiAgICAgICAgdGhpcy5zZWxlY3RfZXh0ZW5zaW9uID0gbmV3IFNlbGVjdC5WaWV3KHtcbiAgICAgICAgICAgIGNzczogXCJ1cGxvYWQtZXh0ZW5zaW9uXCIsXG4gICAgICAgICAgICBkYXRhOiBzZWxmLmFwcC5saXN0X2V4dGVuc2lvbnMsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZXh0ZW5zaW9uXCIpLFxuICAgICAgICAgICAgdmFsdWU6IGRlZmF1bHRfZXh0ZW5zaW9uLFxuICAgICAgICAgICAgb25jaGFuZ2U6IGZ1bmN0aW9uKGV4dGVuc2lvbikge1xuICAgICAgICAgICAgICAgIHNlbGYubW9kZWwuc2V0KFwiZXh0ZW5zaW9uXCIsIGV4dGVuc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGluaXRpYWxpemUgZ2Vub21lIGFuZCBleHRlbnNpb24gdmFsdWVzXG4gICAgICAgIHRoaXMubW9kZWwuc2V0KHtcbiAgICAgICAgICAgIGdlbm9tZTogZGVmYXVsdF9nZW5vbWUsXG4gICAgICAgICAgICBleHRlbnNpb246IGRlZmF1bHRfZXh0ZW5zaW9uXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBjbGljayBldmVudFxuICAgICAgICB0aGlzLiRzeW1ib2wub24oXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZW1vdmVSb3coKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gaGFuZGxlIGV4dGVuc2lvbiBpbmZvIHBvcG92ZXJcbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC1leHRlbnNpb24taW5mb1wiKVxuICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5hcHAuc2hvd0V4dGVuc2lvbkluZm8oe1xuICAgICAgICAgICAgICAgICAgICAkZWw6ICQoZS50YXJnZXQpLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogc2VsZi5zZWxlY3RfZXh0ZW5zaW9uLnRleHQoKSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiBzZWxmLnNlbGVjdF9leHRlbnNpb24udmFsdWUoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vbihcIm1vdXNlZG93blwiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBoYW5kbGUgc2V0dGluZ3MgcG9wb3ZlclxuICAgICAgICB0aGlzLiRzZXR0aW5nc1xuICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5fc2hvd1NldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKFwibW91c2Vkb3duXCIsIGUgPT4ge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSB0ZXh0IGVkaXRpbmcgZXZlbnRcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50Lm9uKFwiY2hhbmdlIGlucHV0XCIsIGUgPT4ge1xuICAgICAgICAgICAgc2VsZi5tb2RlbC5zZXQoe1xuICAgICAgICAgICAgICAgIHVybF9wYXN0ZTogJChlLnRhcmdldCkudmFsKCksXG4gICAgICAgICAgICAgICAgZmlsZV9zaXplOiAkKGUudGFyZ2V0KS52YWwoKS5sZW5ndGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBtb2RlbCBldmVudHNcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpwZXJjZW50YWdlXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hQZXJjZW50YWdlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOnN0YXR1c1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZWZyZXNoU3RhdHVzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOmluZm9cIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaEluZm8oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6Z2Vub21lXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hHZW5vbWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6ZXh0ZW5zaW9uXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hFeHRlbnNpb24oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6ZmlsZV9zaXplXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hGaWxlU2l6ZSgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5fcmVmcmVzaFR5cGUoKTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaFBlcmNlbnRhZ2UoKTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaFN0YXR1cygpO1xuICAgICAgICB0aGlzLl9yZWZyZXNoSW5mbygpO1xuICAgICAgICB0aGlzLl9yZWZyZXNoR2Vub21lKCk7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hFeHRlbnNpb24oKTtcbiAgICAgICAgdGhpcy5fcmVmcmVzaEZpbGVTaXplKCk7XG4gICAgfSxcblxuICAgIC8qKiBSZW1vdmUgdmlldyAqL1xuICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0X2dlbm9tZS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5zZWxlY3RfZXh0ZW5zaW9uLnJlbW92ZSgpO1xuICAgICAgICBCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcyk7XG4gICAgfSxcblxuICAgIC8qKiBSZW5kZXIgdHlwZSAqL1xuICAgIF9yZWZyZXNoVHlwZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5tb2RlbC5hdHRyaWJ1dGVzO1xuICAgICAgICB0aGlzLiR0aXRsZS5odG1sKF8uZXNjYXBlKG9wdGlvbnMuZmlsZV9uYW1lKSk7XG4gICAgICAgIHRoaXMuJHNpemUuaHRtbChVdGlscy5ieXRlc1RvU3RyaW5nKG9wdGlvbnMuZmlsZV9zaXplKSk7XG4gICAgICAgIHRoaXMuJG1vZGVcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1cGxvYWQtbW9kZVwiKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwidGV4dC1wcmltYXJ5XCIpO1xuICAgICAgICBpZiAob3B0aW9ucy5maWxlX21vZGUgPT0gXCJuZXdcIikge1xuICAgICAgICAgICAgdGhpcy4kdGV4dFxuICAgICAgICAgICAgICAgIC5jc3Moe1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogYCR7dGhpcy4kZWwud2lkdGgoKSAtIDE2fXB4YCxcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBgJHt0aGlzLiRlbC5oZWlnaHQoKSAtIDh9cHhgXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc2hvdygpO1xuICAgICAgICAgICAgdGhpcy4kZWwuaGVpZ2h0KHRoaXMuJGVsLmhlaWdodCgpIC0gOCArIHRoaXMuJHRleHQuaGVpZ2h0KCkgKyAxNik7XG4gICAgICAgICAgICB0aGlzLiRtb2RlLmFkZENsYXNzKFwiZmEgZmEtZWRpdFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmZpbGVfbW9kZSA9PSBcImxvY2FsXCIpIHtcbiAgICAgICAgICAgIHRoaXMuJG1vZGUuYWRkQ2xhc3MoXCJmYSBmYS1sYXB0b3BcIik7XG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5maWxlX21vZGUgPT0gXCJmdHBcIikge1xuICAgICAgICAgICAgdGhpcy4kbW9kZS5hZGRDbGFzcyhcImZhIGZhLWZvbGRlci1vcGVuLW9cIik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFVwZGF0ZSBleHRlbnNpb24gKi9cbiAgICBfcmVmcmVzaEV4dGVuc2lvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0X2V4dGVuc2lvbi52YWx1ZSh0aGlzLm1vZGVsLmdldChcImV4dGVuc2lvblwiKSk7XG4gICAgfSxcblxuICAgIC8qKiBVcGRhdGUgZ2Vub21lICovXG4gICAgX3JlZnJlc2hHZW5vbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUudmFsdWUodGhpcy5tb2RlbC5nZXQoXCJnZW5vbWVcIikpO1xuICAgIH0sXG5cbiAgICAvKiogUmVmcmVzaCBpbmZvIHRleHQgKi9cbiAgICBfcmVmcmVzaEluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHRoaXMubW9kZWwuZ2V0KFwiaW5mb1wiKTtcbiAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgIHRoaXMuJGluZm9fdGV4dC5odG1sKGA8c3Ryb25nPkZhaWxlZDogPC9zdHJvbmc+JHtpbmZvfWApLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJGluZm9fdGV4dC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggcGVyY2VudGFnZSBzdGF0dXMgKi9cbiAgICBfcmVmcmVzaFBlcmNlbnRhZ2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcGVyY2VudGFnZSA9IHBhcnNlSW50KHRoaXMubW9kZWwuZ2V0KFwicGVyY2VudGFnZVwiKSk7XG4gICAgICAgIHRoaXMuJHByb2dyZXNzX2Jhci5jc3MoeyB3aWR0aDogYCR7cGVyY2VudGFnZX0lYCB9KTtcbiAgICAgICAgdGhpcy4kcGVyY2VudGFnZS5odG1sKHBlcmNlbnRhZ2UgIT0gMTAwID8gYCR7cGVyY2VudGFnZX0lYCA6IFwiQWRkaW5nIHRvIGhpc3RvcnkuLi5cIik7XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIHN0YXR1cyAqL1xuICAgIF9yZWZyZXNoU3RhdHVzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXR1cyA9IHRoaXMubW9kZWwuZ2V0KFwic3RhdHVzXCIpO1xuICAgICAgICB0aGlzLiRzeW1ib2xcbiAgICAgICAgICAgIC5yZW1vdmVDbGFzcygpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1cGxvYWQtc3ltYm9sXCIpXG4gICAgICAgICAgICAuYWRkQ2xhc3ModGhpcy5zdGF0dXNfY2xhc3Nlc1tzdGF0dXNdKTtcbiAgICAgICAgdGhpcy5tb2RlbC5zZXQoXCJlbmFibGVkXCIsIHN0YXR1cyA9PSBcImluaXRcIik7XG4gICAgICAgIHZhciBlbmFibGVkID0gdGhpcy5tb2RlbC5nZXQoXCJlbmFibGVkXCIpO1xuICAgICAgICB0aGlzLiR0ZXh0X2NvbnRlbnQuYXR0cihcImRpc2FibGVkXCIsICFlbmFibGVkKTtcbiAgICAgICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2dlbm9tZS5lbmFibGUoKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2V4dGVuc2lvbi5lbmFibGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2dlbm9tZS5kaXNhYmxlKCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdF9leHRlbnNpb24uZGlzYWJsZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKFwic3VjY2Vzc1wiKTtcbiAgICAgICAgICAgIHRoaXMuJHBlcmNlbnRhZ2UuaHRtbChcIjEwMCVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXR1cyA9PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpO1xuICAgICAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggZmlsZSBzaXplICovXG4gICAgX3JlZnJlc2hGaWxlU2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJHNpemUuaHRtbChVdGlscy5ieXRlc1RvU3RyaW5nKHRoaXMubW9kZWwuZ2V0KFwiZmlsZV9zaXplXCIpKSk7XG4gICAgfSxcblxuICAgIC8qKiBSZW1vdmUgcm93ICovXG4gICAgX3JlbW92ZVJvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChbXCJpbml0XCIsIFwic3VjY2Vzc1wiLCBcImVycm9yXCJdLmluZGV4T2YodGhpcy5tb2RlbC5nZXQoXCJzdGF0dXNcIikpICE9PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5hcHAuY29sbGVjdGlvbi5yZW1vdmUodGhpcy5tb2RlbCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIEF0dGFjaCBmaWxlIGluZm8gcG9wdXAgKi9cbiAgICBfc2hvd1NldHRpbmdzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZW1wdHkoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYXBwZW5kKG5ldyBVcGxvYWRTZXR0aW5ncyh0aGlzKS4kZWwpO1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogVmlldyB0ZW1wbGF0ZSAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gYDx0ciBpZD1cInVwbG9hZC1yb3ctJHtcbiAgICAgICAgICAgIG9wdGlvbnMuaWRcbiAgICAgICAgfVwiIGNsYXNzPVwidXBsb2FkLXJvd1wiPjx0ZD48ZGl2IGNsYXNzPVwidXBsb2FkLXRleHQtY29sdW1uXCI+PGRpdiBjbGFzcz1cInVwbG9hZC1tb2RlXCIvPjxkaXYgY2xhc3M9XCJ1cGxvYWQtdGl0bGVcIi8+PGRpdiBjbGFzcz1cInVwbG9hZC10ZXh0XCI+PGRpdiBjbGFzcz1cInVwbG9hZC10ZXh0LWluZm9cIj5Zb3UgY2FuIHRlbGwgR2FsYXh5IHRvIGRvd25sb2FkIGRhdGEgZnJvbSB3ZWIgYnkgZW50ZXJpbmcgVVJMIGluIHRoaXMgYm94IChvbmUgcGVyIGxpbmUpLiBZb3UgY2FuIGFsc28gZGlyZWN0bHkgcGFzdGUgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS48L2Rpdj48dGV4dGFyZWEgY2xhc3M9XCJ1cGxvYWQtdGV4dC1jb250ZW50IGZvcm0tY29udHJvbFwiLz48L2Rpdj48L2Rpdj48L3RkPjx0ZD48ZGl2IGNsYXNzPVwidXBsb2FkLXNpemVcIi8+PC90ZD48dGQ+PGRpdiBjbGFzcz1cInVwbG9hZC1leHRlbnNpb25cIiBzdHlsZT1cImZsb2F0OiBsZWZ0O1wiLz4mbmJzcDsmbmJzcDxkaXYgY2xhc3M9XCJ1cGxvYWQtZXh0ZW5zaW9uLWluZm8gdXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLXNlYXJjaFwiLz48L3RkPjx0ZD48ZGl2IGNsYXNzPVwidXBsb2FkLWdlbm9tZVwiLz48L3RkPjx0ZD48ZGl2IGNsYXNzPVwidXBsb2FkLXNldHRpbmdzIHVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1nZWFyXCIvPjwvdGQ+PHRkPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mb1wiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mby10ZXh0XCIvPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mby1wcm9ncmVzcyBwcm9ncmVzc1wiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtcHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItc3VjY2Vzc1wiLz48ZGl2IGNsYXNzPVwidXBsb2FkLXBlcmNlbnRhZ2VcIj4wJTwvZGl2PjwvZGl2PjwvZGl2PjwvdGQ+PHRkPjxkaXYgY2xhc3M9XCJ1cGxvYWQtc3ltYm9sICR7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c19jbGFzc2VzLmluaXRcbiAgICAgICAgfVwiLz48L3RkPjwvdHI+YDtcbiAgICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdXBsb2FkL2RlZmF1bHQvZGVmYXVsdC1yb3cuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQXhQQTtBQU5BO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///256\n");

/***/ }),
/* 257 */
/*!*************************************************!*\
  !*** ./galaxy/scripts/mvc/lazy/lazy-limited.js ***!
  \*************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/** Contains helpers to limit/lazy load views for backbone views */\n\nexports.default = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        this.$container = options.$container;\n        this.collection = options.collection;\n        this.new_content = options.new_content;\n        this.max = options.max || 50;\n        this.content_list = {};\n        this.$message = $(\"<div/>\").addClass(\"ui-limitloader\").append(\"...only the first \" + this.max + \" entries are visible.\");\n        this.$container.append(this.$message);\n        this.listenTo(this.collection, \"reset\", this._reset, this);\n        this.listenTo(this.collection, \"add\", this._refresh, this);\n        this.listenTo(this.collection, \"remove\", this._remove, this);\n    },\n\n    /** Checks if the limit has been reached */\n    _done: function _done() {\n        var done = _.size(this.content_list) > this.max;\n        this.$message[done ? \"show\" : \"hide\"]();\n        return done;\n    },\n\n    /** Remove all content */\n    _reset: function _reset() {\n        _.each(this.content_list, function (content) {\n            content.remove();\n        });\n        this.content_list = {};\n        this.$message.hide();\n    },\n\n    /** Remove content */\n    _remove: function _remove(model) {\n        var model_id = model.id;\n        var content = this.content_list[model_id];\n        if (content) {\n            content.remove();\n            delete this.content_list[model_id];\n        }\n        this._refresh();\n    },\n\n    /** Refreshes container content by adding new views if visible */\n    _refresh: function _refresh() {\n        if (!this._done()) {\n            for (var i in this.collection.models) {\n                var model = this.collection.models[i];\n                var view = this.content_list[model.id];\n                if (!this.content_list[model.id]) {\n                    var content = this.new_content(model);\n                    this.content_list[model.id] = content;\n                    if (this._done()) {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n});\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9sYXp5L2xhenktbGltaXRlZC5qcz8yN2VjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBDb250YWlucyBoZWxwZXJzIHRvIGxpbWl0L2xhenkgbG9hZCB2aWV3cyBmb3IgYmFja2JvbmUgdmlld3MgKi9cblxuZXhwb3J0IGRlZmF1bHQgQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLiRjb250YWluZXIgPSBvcHRpb25zLiRjb250YWluZXI7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbiA9IG9wdGlvbnMuY29sbGVjdGlvbjtcbiAgICAgICAgdGhpcy5uZXdfY29udGVudCA9IG9wdGlvbnMubmV3X2NvbnRlbnQ7XG4gICAgICAgIHRoaXMubWF4ID0gb3B0aW9ucy5tYXggfHwgNTA7XG4gICAgICAgIHRoaXMuY29udGVudF9saXN0ID0ge307XG4gICAgICAgIHRoaXMuJG1lc3NhZ2UgPSAkKFwiPGRpdi8+XCIpXG4gICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1saW1pdGxvYWRlclwiKVxuICAgICAgICAgICAgLmFwcGVuZChgLi4ub25seSB0aGUgZmlyc3QgJHt0aGlzLm1heH0gZW50cmllcyBhcmUgdmlzaWJsZS5gKTtcbiAgICAgICAgdGhpcy4kY29udGFpbmVyLmFwcGVuZCh0aGlzLiRtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIFwicmVzZXRcIiwgdGhpcy5fcmVzZXQsIHRoaXMpO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJhZGRcIiwgdGhpcy5fcmVmcmVzaCwgdGhpcyk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInJlbW92ZVwiLCB0aGlzLl9yZW1vdmUsIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKiogQ2hlY2tzIGlmIHRoZSBsaW1pdCBoYXMgYmVlbiByZWFjaGVkICovXG4gICAgX2RvbmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZG9uZSA9IF8uc2l6ZSh0aGlzLmNvbnRlbnRfbGlzdCkgPiB0aGlzLm1heDtcbiAgICAgICAgdGhpcy4kbWVzc2FnZVtkb25lID8gXCJzaG93XCIgOiBcImhpZGVcIl0oKTtcbiAgICAgICAgcmV0dXJuIGRvbmU7XG4gICAgfSxcblxuICAgIC8qKiBSZW1vdmUgYWxsIGNvbnRlbnQgKi9cbiAgICBfcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBfLmVhY2godGhpcy5jb250ZW50X2xpc3QsIGNvbnRlbnQgPT4ge1xuICAgICAgICAgICAgY29udGVudC5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGVudF9saXN0ID0ge307XG4gICAgICAgIHRoaXMuJG1lc3NhZ2UuaGlkZSgpO1xuICAgIH0sXG5cbiAgICAvKiogUmVtb3ZlIGNvbnRlbnQgKi9cbiAgICBfcmVtb3ZlOiBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICB2YXIgbW9kZWxfaWQgPSBtb2RlbC5pZDtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnRfbGlzdFttb2RlbF9pZF07XG4gICAgICAgIGlmIChjb250ZW50KSB7XG4gICAgICAgICAgICBjb250ZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuY29udGVudF9saXN0W21vZGVsX2lkXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoZXMgY29udGFpbmVyIGNvbnRlbnQgYnkgYWRkaW5nIG5ldyB2aWV3cyBpZiB2aXNpYmxlICovXG4gICAgX3JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2RvbmUoKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmNvbGxlY3Rpb24ubW9kZWxzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gdGhpcy5jb2xsZWN0aW9uLm1vZGVsc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMuY29udGVudF9saXN0W21vZGVsLmlkXTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY29udGVudF9saXN0W21vZGVsLmlkXSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudCA9IHRoaXMubmV3X2NvbnRlbnQobW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRfbGlzdFttb2RlbC5pZF0gPSBjb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZG9uZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy9sYXp5L2xhenktbGltaXRlZC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///257\n");

/***/ }),
/* 258 */
/*!***************************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/composite/composite-view.js ***!
  \***************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadModel = __webpack_require__(/*! mvc/upload/upload-model */ 49);\n\nvar _uploadModel2 = _interopRequireDefault(_uploadModel);\n\nvar _compositeRow = __webpack_require__(/*! mvc/upload/composite/composite-row */ 259);\n\nvar _compositeRow2 = _interopRequireDefault(_compositeRow);\n\nvar _uploadExtension = __webpack_require__(/*! mvc/upload/upload-extension */ 94);\n\nvar _uploadExtension2 = _interopRequireDefault(_uploadExtension);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    collection: new _uploadModel2.default.Collection(),\n    initialize: function initialize(app) {\n        var self = this;\n        this.app = app;\n        this.options = app.options;\n        this.list_extensions = app.list_extensions;\n        this.list_genomes = app.list_genomes;\n        this.ftp_upload_site = app.currentFtp();\n        this.setElement(this._template());\n\n        // create button section\n        this.btnStart = new _uiMisc2.default.Button({\n            title: (0, _localization2.default)(\"Start\"),\n            onclick: function onclick() {\n                self._eventStart();\n            }\n        });\n        this.btnClose = new _uiMisc2.default.Button({\n            title: (0, _localization2.default)(\"Close\"),\n            onclick: function onclick() {\n                self.app.modal.hide();\n            }\n        });\n\n        // append buttons to dom\n        _.each([this.btnStart, this.btnClose], function (button) {\n            self.$(\".upload-buttons\").prepend(button.$el);\n        });\n\n        // select extension\n        this.select_extension = new _uiSelect2.default.View({\n            css: \"upload-footer-selection\",\n            container: this.$(\".upload-footer-extension\"),\n            data: _.filter(this.list_extensions, function (ext) {\n                return ext.composite_files;\n            }),\n            onchange: function onchange(extension) {\n                self.collection.reset();\n                var details = _.findWhere(self.list_extensions, {\n                    id: extension\n                });\n                if (details && details.composite_files) {\n                    _.each(details.composite_files, function (item) {\n                        self.collection.add({\n                            id: self.collection.size(),\n                            file_desc: item.description || item.name\n                        });\n                    });\n                }\n            }\n        });\n\n        // handle extension info popover\n        this.$(\".upload-footer-extension-info\").on(\"click\", function (e) {\n            new _uploadExtension2.default({\n                $el: $(e.target),\n                title: self.select_extension.text(),\n                extension: self.select_extension.value(),\n                list: self.list_extensions,\n                placement: \"top\"\n            });\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // genome extension\n        this.select_genome = new _uiSelect2.default.View({\n            css: \"upload-footer-selection\",\n            container: this.$(\".upload-footer-genome\"),\n            data: this.list_genomes,\n            value: this.options.default_genome\n        });\n\n        // listener for collection triggers on change in composite datatype and extension selection\n        this.listenTo(this.collection, \"add\", function (model) {\n            self._eventAnnounce(model);\n        });\n        this.listenTo(this.collection, \"change add\", function () {\n            self.render();\n        });\n        this.select_extension.options.onchange(this.select_extension.value());\n        this.render();\n    },\n\n    render: function render() {\n        var model = this.collection.first();\n        if (model && model.get(\"status\") == \"running\") {\n            this.select_genome.disable();\n            this.select_extension.disable();\n        } else {\n            this.select_genome.enable();\n            this.select_extension.enable();\n        }\n        if (this.collection.where({ status: \"ready\" }).length == this.collection.length && this.collection.length > 0) {\n            this.btnStart.enable();\n            this.btnStart.$el.addClass(\"btn-primary\");\n        } else {\n            this.btnStart.disable();\n            this.btnStart.$el.removeClass(\"btn-primary\");\n        }\n        this.$(\".upload-table\")[this.collection.length > 0 ? \"show\" : \"hide\"]();\n    },\n\n    //\n    // upload events / process pipeline\n    //\n\n    /** Builds the basic ui with placeholder rows for each composite data type file */\n    _eventAnnounce: function _eventAnnounce(model) {\n        var upload_row = new _compositeRow2.default(this, { model: model });\n        this.$(\".upload-table > tbody:first\").append(upload_row.$el);\n        this.$(\".upload-table\")[this.collection.length > 0 ? \"show\" : \"hide\"]();\n        upload_row.render();\n    },\n\n    /** Start upload process */\n    _eventStart: function _eventStart() {\n        var self = this;\n        this.collection.each(function (model) {\n            model.set({\n                genome: self.select_genome.value(),\n                extension: self.select_extension.value()\n            });\n        });\n        $.uploadpost({\n            url: this.app.options.nginx_upload_path,\n            data: this.app.toData(this.collection.filter()),\n            success: function success(message) {\n                self._eventSuccess(message);\n            },\n            error: function error(message) {\n                self._eventError(message);\n            },\n            progress: function progress(percentage) {\n                self._eventProgress(percentage);\n            }\n        });\n    },\n\n    /** Refresh progress state */\n    _eventProgress: function _eventProgress(percentage) {\n        this.collection.each(function (it) {\n            it.set(\"percentage\", percentage);\n        });\n    },\n\n    /** Refresh success state */\n    _eventSuccess: function _eventSuccess(message) {\n        this.collection.each(function (it) {\n            it.set(\"status\", \"success\");\n        });\n        Galaxy.currHistoryPanel.refreshContents();\n    },\n\n    /** Refresh error state */\n    _eventError: function _eventError(message) {\n        this.collection.each(function (it) {\n            it.set({ status: \"error\", info: message });\n        });\n    },\n\n    /** Load html template */\n    _template: function _template() {\n        return '<div class=\"upload-view-composite\">' + '<div class=\"upload-top\">' + '<h6 class=\"upload-top-info\"/>' + \"</div>\" + '<div class=\"upload-box\">' + '<table class=\"upload-table ui-table-striped\" style=\"display: none;\">' + \"<thead>\" + \"<tr>\" + \"<th/>\" + \"<th/>\" + \"<th>Description</th>\" + \"<th>Name</th>\" + \"<th>Size</th>\" + \"<th>Settings</th>\" + \"<th>Status</th>\" + \"</tr>\" + \"</thead>\" + \"<tbody/>\" + \"</table>\" + \"</div>\" + '<div class=\"upload-footer\">' + '<span class=\"upload-footer-title\">Composite Type:</span>' + '<span class=\"upload-footer-extension\"/>' + '<span class=\"upload-footer-extension-info upload-icon-button fa fa-search\"/> ' + '<span class=\"upload-footer-title\">Genome/Build:</span>' + '<span class=\"upload-footer-genome\"/>' + \"</div>\" + '<div class=\"upload-buttons\"/>' + \"</div>\";\n    }\n});\n/** Renders contents of the composite uploader */\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS12aWV3LmpzPzI1ZDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbi8qKiBSZW5kZXJzIGNvbnRlbnRzIG9mIHRoZSBjb21wb3NpdGUgdXBsb2FkZXIgKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBVcGxvYWRNb2RlbCBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtbW9kZWxcIjtcbmltcG9ydCBVcGxvYWRSb3cgZnJvbSBcIm12Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS1yb3dcIjtcbmltcG9ydCBVcGxvYWRFeHRlbnNpb24gZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLWV4dGVuc2lvblwiO1xuaW1wb3J0IFBvcG92ZXIgZnJvbSBcIm12Yy91aS91aS1wb3BvdmVyXCI7XG5pbXBvcnQgU2VsZWN0IGZyb20gXCJtdmMvdWkvdWktc2VsZWN0XCI7XG5pbXBvcnQgVWkgZnJvbSBcIm12Yy91aS91aS1taXNjXCI7XG5leHBvcnQgZGVmYXVsdCBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgY29sbGVjdGlvbjogbmV3IFVwbG9hZE1vZGVsLkNvbGxlY3Rpb24oKSxcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhcHApIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gYXBwLm9wdGlvbnM7XG4gICAgICAgIHRoaXMubGlzdF9leHRlbnNpb25zID0gYXBwLmxpc3RfZXh0ZW5zaW9ucztcbiAgICAgICAgdGhpcy5saXN0X2dlbm9tZXMgPSBhcHAubGlzdF9nZW5vbWVzO1xuICAgICAgICB0aGlzLmZ0cF91cGxvYWRfc2l0ZSA9IGFwcC5jdXJyZW50RnRwKCk7XG4gICAgICAgIHRoaXMuc2V0RWxlbWVudCh0aGlzLl90ZW1wbGF0ZSgpKTtcblxuICAgICAgICAvLyBjcmVhdGUgYnV0dG9uIHNlY3Rpb25cbiAgICAgICAgdGhpcy5idG5TdGFydCA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiU3RhcnRcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudFN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ0bkNsb3NlID0gbmV3IFVpLkJ1dHRvbih7XG4gICAgICAgICAgICB0aXRsZTogX2woXCJDbG9zZVwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuYXBwLm1vZGFsLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gYXBwZW5kIGJ1dHRvbnMgdG8gZG9tXG4gICAgICAgIF8uZWFjaChbdGhpcy5idG5TdGFydCwgdGhpcy5idG5DbG9zZV0sIGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICBzZWxmLiQoXCIudXBsb2FkLWJ1dHRvbnNcIikucHJlcGVuZChidXR0b24uJGVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc2VsZWN0IGV4dGVuc2lvblxuICAgICAgICB0aGlzLnNlbGVjdF9leHRlbnNpb24gPSBuZXcgU2VsZWN0LlZpZXcoe1xuICAgICAgICAgICAgY3NzOiBcInVwbG9hZC1mb290ZXItc2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWV4dGVuc2lvblwiKSxcbiAgICAgICAgICAgIGRhdGE6IF8uZmlsdGVyKHRoaXMubGlzdF9leHRlbnNpb25zLCBleHQgPT4gZXh0LmNvbXBvc2l0ZV9maWxlcyksXG4gICAgICAgICAgICBvbmNoYW5nZTogZnVuY3Rpb24oZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jb2xsZWN0aW9uLnJlc2V0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGRldGFpbHMgPSBfLmZpbmRXaGVyZShzZWxmLmxpc3RfZXh0ZW5zaW9ucywge1xuICAgICAgICAgICAgICAgICAgICBpZDogZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGRldGFpbHMgJiYgZGV0YWlscy5jb21wb3NpdGVfZmlsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5lYWNoKGRldGFpbHMuY29tcG9zaXRlX2ZpbGVzLCBpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29sbGVjdGlvbi5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzZWxmLmNvbGxlY3Rpb24uc2l6ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfZGVzYzogaXRlbS5kZXNjcmlwdGlvbiB8fCBpdGVtLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBleHRlbnNpb24gaW5mbyBwb3BvdmVyXG4gICAgICAgIHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWV4dGVuc2lvbi1pbmZvXCIpXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgVXBsb2FkRXh0ZW5zaW9uKHtcbiAgICAgICAgICAgICAgICAgICAgJGVsOiAkKGUudGFyZ2V0KSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNlbGYuc2VsZWN0X2V4dGVuc2lvbi50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbjogc2VsZi5zZWxlY3RfZXh0ZW5zaW9uLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6IHNlbGYubGlzdF9leHRlbnNpb25zLFxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IFwidG9wXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gZ2Vub21lIGV4dGVuc2lvblxuICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUgPSBuZXcgU2VsZWN0LlZpZXcoe1xuICAgICAgICAgICAgY3NzOiBcInVwbG9hZC1mb290ZXItc2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWdlbm9tZVwiKSxcbiAgICAgICAgICAgIGRhdGE6IHRoaXMubGlzdF9nZW5vbWVzLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMub3B0aW9ucy5kZWZhdWx0X2dlbm9tZVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBsaXN0ZW5lciBmb3IgY29sbGVjdGlvbiB0cmlnZ2VycyBvbiBjaGFuZ2UgaW4gY29tcG9zaXRlIGRhdGF0eXBlIGFuZCBleHRlbnNpb24gc2VsZWN0aW9uXG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcImFkZFwiLCBtb2RlbCA9PiB7XG4gICAgICAgICAgICBzZWxmLl9ldmVudEFubm91bmNlKG1vZGVsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcImNoYW5nZSBhZGRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5yZW5kZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2VsZWN0X2V4dGVuc2lvbi5vcHRpb25zLm9uY2hhbmdlKHRoaXMuc2VsZWN0X2V4dGVuc2lvbi52YWx1ZSgpKTtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1vZGVsID0gdGhpcy5jb2xsZWN0aW9uLmZpcnN0KCk7XG4gICAgICAgIGlmIChtb2RlbCAmJiBtb2RlbC5nZXQoXCJzdGF0dXNcIikgPT0gXCJydW5uaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0X2dlbm9tZS5kaXNhYmxlKCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdF9leHRlbnNpb24uZGlzYWJsZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RfZ2Vub21lLmVuYWJsZSgpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RfZXh0ZW5zaW9uLmVuYWJsZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb24ud2hlcmUoeyBzdGF0dXM6IFwicmVhZHlcIiB9KS5sZW5ndGggPT0gdGhpcy5jb2xsZWN0aW9uLmxlbmd0aCAmJiB0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5idG5TdGFydC5lbmFibGUoKTtcbiAgICAgICAgICAgIHRoaXMuYnRuU3RhcnQuJGVsLmFkZENsYXNzKFwiYnRuLXByaW1hcnlcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ0blN0YXJ0LmRpc2FibGUoKTtcbiAgICAgICAgICAgIHRoaXMuYnRuU3RhcnQuJGVsLnJlbW92ZUNsYXNzKFwiYnRuLXByaW1hcnlcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC10YWJsZVwiKVt0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoID4gMCA/IFwic2hvd1wiIDogXCJoaWRlXCJdKCk7XG4gICAgfSxcblxuICAgIC8vXG4gICAgLy8gdXBsb2FkIGV2ZW50cyAvIHByb2Nlc3MgcGlwZWxpbmVcbiAgICAvL1xuXG4gICAgLyoqIEJ1aWxkcyB0aGUgYmFzaWMgdWkgd2l0aCBwbGFjZWhvbGRlciByb3dzIGZvciBlYWNoIGNvbXBvc2l0ZSBkYXRhIHR5cGUgZmlsZSAqL1xuICAgIF9ldmVudEFubm91bmNlOiBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICB2YXIgdXBsb2FkX3JvdyA9IG5ldyBVcGxvYWRSb3codGhpcywgeyBtb2RlbDogbW9kZWwgfSk7XG4gICAgICAgIHRoaXMuJChcIi51cGxvYWQtdGFibGUgPiB0Ym9keTpmaXJzdFwiKS5hcHBlbmQodXBsb2FkX3Jvdy4kZWwpO1xuICAgICAgICB0aGlzLiQoXCIudXBsb2FkLXRhYmxlXCIpW3RoaXMuY29sbGVjdGlvbi5sZW5ndGggPiAwID8gXCJzaG93XCIgOiBcImhpZGVcIl0oKTtcbiAgICAgICAgdXBsb2FkX3Jvdy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgLyoqIFN0YXJ0IHVwbG9hZCBwcm9jZXNzICovXG4gICAgX2V2ZW50U3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5lYWNoKG1vZGVsID0+IHtcbiAgICAgICAgICAgIG1vZGVsLnNldCh7XG4gICAgICAgICAgICAgICAgZ2Vub21lOiBzZWxmLnNlbGVjdF9nZW5vbWUudmFsdWUoKSxcbiAgICAgICAgICAgICAgICBleHRlbnNpb246IHNlbGYuc2VsZWN0X2V4dGVuc2lvbi52YWx1ZSgpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgICQudXBsb2FkcG9zdCh7XG4gICAgICAgICAgICB1cmw6IHRoaXMuYXBwLm9wdGlvbnMubmdpbnhfdXBsb2FkX3BhdGgsXG4gICAgICAgICAgICBkYXRhOiB0aGlzLmFwcC50b0RhdGEodGhpcy5jb2xsZWN0aW9uLmZpbHRlcigpKSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudFN1Y2Nlc3MobWVzc2FnZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudEVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHByb2dyZXNzOiBmdW5jdGlvbihwZXJjZW50YWdlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRQcm9ncmVzcyhwZXJjZW50YWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIHByb2dyZXNzIHN0YXRlICovXG4gICAgX2V2ZW50UHJvZ3Jlc3M6IGZ1bmN0aW9uKHBlcmNlbnRhZ2UpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2goaXQgPT4ge1xuICAgICAgICAgICAgaXQuc2V0KFwicGVyY2VudGFnZVwiLCBwZXJjZW50YWdlKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIHN1Y2Nlc3Mgc3RhdGUgKi9cbiAgICBfZXZlbnRTdWNjZXNzOiBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5lYWNoKGl0ID0+IHtcbiAgICAgICAgICAgIGl0LnNldChcInN0YXR1c1wiLCBcInN1Y2Nlc3NcIik7XG4gICAgICAgIH0pO1xuICAgICAgICBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5yZWZyZXNoQ29udGVudHMoKTtcbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggZXJyb3Igc3RhdGUgKi9cbiAgICBfZXZlbnRFcnJvcjogZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChpdCA9PiB7XG4gICAgICAgICAgICBpdC5zZXQoeyBzdGF0dXM6IFwiZXJyb3JcIiwgaW5mbzogbWVzc2FnZSB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBMb2FkIGh0bWwgdGVtcGxhdGUgKi9cbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtdmlldy1jb21wb3NpdGVcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLXRvcFwiPicgK1xuICAgICAgICAgICAgJzxoNiBjbGFzcz1cInVwbG9hZC10b3AtaW5mb1wiLz4nICtcbiAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtYm94XCI+JyArXG4gICAgICAgICAgICAnPHRhYmxlIGNsYXNzPVwidXBsb2FkLXRhYmxlIHVpLXRhYmxlLXN0cmlwZWRcIiBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+JyArXG4gICAgICAgICAgICBcIjx0aGVhZD5cIiArXG4gICAgICAgICAgICBcIjx0cj5cIiArXG4gICAgICAgICAgICBcIjx0aC8+XCIgK1xuICAgICAgICAgICAgXCI8dGgvPlwiICtcbiAgICAgICAgICAgIFwiPHRoPkRlc2NyaXB0aW9uPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5OYW1lPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5TaXplPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5TZXR0aW5nczwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+U3RhdHVzPC90aD5cIiArXG4gICAgICAgICAgICBcIjwvdHI+XCIgK1xuICAgICAgICAgICAgXCI8L3RoZWFkPlwiICtcbiAgICAgICAgICAgIFwiPHRib2R5Lz5cIiArXG4gICAgICAgICAgICBcIjwvdGFibGU+XCIgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1mb290ZXJcIj4nICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItdGl0bGVcIj5Db21wb3NpdGUgVHlwZTo8L3NwYW4+JyArXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ1cGxvYWQtZm9vdGVyLWV4dGVuc2lvblwiLz4nICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItZXh0ZW5zaW9uLWluZm8gdXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLXNlYXJjaFwiLz4gJyArXG4gICAgICAgICAgICAnPHNwYW4gY2xhc3M9XCJ1cGxvYWQtZm9vdGVyLXRpdGxlXCI+R2Vub21lL0J1aWxkOjwvc3Bhbj4nICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItZ2Vub21lXCIvPicgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1idXR0b25zXCIvPicgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIlxuICAgICAgICApO1xuICAgIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS12aWV3LmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQWpCQTtBQUNBO0FBbUJBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBK0JBO0FBbk1BO0FBUkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///258\n");

/***/ }),
/* 259 */
/*!**************************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/composite/composite-row.js ***!
  \**************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadSettings = __webpack_require__(/*! mvc/upload/upload-settings */ 92);\n\nvar _uploadSettings2 = _interopRequireDefault(_uploadSettings);\n\nvar _uploadFtp = __webpack_require__(/*! mvc/upload/upload-ftp */ 93);\n\nvar _uploadFtp2 = _interopRequireDefault(_uploadFtp);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\n__webpack_require__(/*! utils/uploadbox */ 95);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    /** Dictionary of upload states and associated icons */\n    status_classes: {\n        init: \"upload-mode fa fa-exclamation text-primary\",\n        ready: \"upload-mode fa fa-check text-success\",\n        running: \"upload-mode fa fa-spinner fa-spin\",\n        success: \"upload-mode fa fa-check\",\n        error: \"upload-mode fa fa-exclamation-triangle\"\n    },\n\n    initialize: function initialize(app, options) {\n        var self = this;\n        this.app = app;\n        this.model = options.model;\n        this.setElement(this._template());\n        this.$source = this.$(\".upload-source\");\n        this.$settings = this.$(\".upload-settings\");\n        this.$status = this.$(\".upload-status\");\n        this.$text = this.$(\".upload-text\");\n        this.$text_content = this.$(\".upload-text-content\");\n        this.$info_text = this.$(\".upload-info-text\");\n        this.$info_progress = this.$(\".upload-info-progress\");\n        this.$file_name = this.$(\".upload-file-name\");\n        this.$file_desc = this.$(\".upload-file-desc\");\n        this.$file_size = this.$(\".upload-file-size\");\n        this.$progress_bar = this.$(\".upload-progress-bar\");\n        this.$percentage = this.$(\".upload-percentage\");\n\n        // build upload functions\n        this.uploadinput = this.$el.uploadinput({\n            ondragover: function ondragover() {\n                self.model.get(\"enabled\") && self.$el.addClass(\"warning\");\n            },\n            ondragleave: function ondragleave() {\n                self.$el.removeClass(\"warning\");\n            },\n            onchange: function onchange(files) {\n                if (self.model.get(\"status\") != \"running\" && files && files.length > 0) {\n                    self.model.reset({\n                        file_data: files[0],\n                        file_name: files[0].name,\n                        file_size: files[0].size,\n                        file_mode: files[0].mode || \"local\"\n                    });\n                    self._refreshReady();\n                }\n            }\n        });\n\n        // source selection popup\n        this.button_menu = new _uiMisc2.default.ButtonMenu({\n            icon: \"fa-caret-down\",\n            title: (0, _localization2.default)(\"Select\"),\n            pull: \"left\"\n        });\n        this.$source.append(this.button_menu.$el);\n        this.button_menu.addMenu({\n            icon: \"fa-laptop\",\n            title: (0, _localization2.default)(\"Choose local file\"),\n            onclick: function onclick() {\n                self.uploadinput.dialog();\n            }\n        });\n        if (this.app.ftp_upload_site) {\n            this.button_menu.addMenu({\n                icon: \"fa-folder-open-o\",\n                title: (0, _localization2.default)(\"Choose FTP file\"),\n                onclick: function onclick() {\n                    self._showFtp();\n                }\n            });\n        }\n        this.button_menu.addMenu({\n            icon: \"fa-edit\",\n            title: \"Paste/Fetch data\",\n            onclick: function onclick() {\n                self.model.reset({\n                    file_mode: \"new\",\n                    file_name: \"New File\"\n                });\n            }\n        });\n\n        // add ftp file viewer\n        this.ftp = new _uiPopover2.default.View({\n            title: \"Choose FTP file:\",\n            container: this.$source.find(\".ui-button-menu\"),\n            placement: \"right\"\n        });\n\n        // append popup to settings icon\n        this.settings = new _uiPopover2.default.View({\n            title: (0, _localization2.default)(\"Upload configuration\"),\n            container: this.$settings,\n            placement: \"bottom\"\n        });\n\n        // handle text editing event\n        this.$text_content.on(\"change input\", function (e) {\n            self.model.set({\n                url_paste: $(e.target).val(),\n                file_size: $(e.target).val().length\n            });\n            self._refreshReady();\n        });\n\n        // handle settings popover\n        this.$settings.on(\"click\", function (e) {\n            self._showSettings();\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // model events\n        this.listenTo(this.model, \"change:percentage\", function () {\n            self._refreshPercentage();\n        });\n        this.listenTo(this.model, \"change:status\", function () {\n            self._refreshStatus();\n        });\n        this.listenTo(this.model, \"change:info\", function () {\n            self._refreshInfo();\n        });\n        this.listenTo(this.model, \"change:file_name\", function () {\n            self._refreshFileName();\n        });\n        this.listenTo(this.model, \"change:file_mode\", function () {\n            self._refreshMode();\n        });\n        this.listenTo(this.model, \"change:file_size\", function () {\n            self._refreshFileSize();\n        });\n        this.listenTo(this.model, \"remove\", function () {\n            self.remove();\n        });\n        this.app.collection.on(\"reset\", function () {\n            self.remove();\n        });\n    },\n\n    render: function render() {\n        this.$el.attr(\"id\", \"upload-row-\" + this.model.id);\n        this.$file_name.html(_.escape(this.model.get(\"file_name\") || \"-\"));\n        this.$file_desc.html(this.model.get(\"file_desc\") || \"Unavailable\");\n        this.$file_size.html(_utils2.default.bytesToString(this.model.get(\"file_size\")));\n        this.$status.removeClass().addClass(this.status_classes.init);\n    },\n\n    /** Remove view */\n    remove: function remove() {\n        // call the base class remove method\n        Backbone.View.prototype.remove.apply(this);\n    },\n\n    //\n    // handle model events\n    //\n\n    /** Refresh ready or not states */\n    _refreshReady: function _refreshReady() {\n        this.app.collection.each(function (model) {\n            model.set(\"status\", model.get(\"file_size\") > 0 && \"ready\" || \"init\");\n        });\n    },\n\n    /** Refresh mode and e.g. show/hide textarea field */\n    _refreshMode: function _refreshMode() {\n        var file_mode = this.model.get(\"file_mode\");\n        if (file_mode == \"new\") {\n            this.height = this.$el.height();\n            this.$text.css({\n                width: this.$el.width() - 16 + \"px\",\n                top: this.$el.height() - 8 + \"px\"\n            }).show();\n            this.$el.height(this.$el.height() - 8 + this.$text.height() + 16);\n            this.$text_content.val(\"\").trigger(\"keyup\");\n        } else {\n            this.$el.height(this.height);\n            this.$text.hide();\n        }\n    },\n\n    /** Refresh information */\n    _refreshInfo: function _refreshInfo() {\n        var info = this.model.get(\"info\");\n        if (info) {\n            this.$info_text.html(\"<strong>Failed: </strong>\" + info).show();\n        } else {\n            this.$info_text.hide();\n        }\n    },\n\n    /** Refresh percentage */\n    _refreshPercentage: function _refreshPercentage() {\n        var percentage = parseInt(this.model.get(\"percentage\"));\n        if (percentage != 0) {\n            this.$progress_bar.css({ width: percentage + \"%\" });\n        } else {\n            this.$progress_bar.addClass(\"no-transition\");\n            this.$progress_bar.css({ width: \"0%\" });\n            this.$progress_bar[0].offsetHeight;\n            this.$progress_bar.removeClass(\"no-transition\");\n        }\n        this.$percentage.html(percentage != 100 ? percentage + \"%\" : \"Adding to history...\");\n    },\n\n    /** Refresh status */\n    _refreshStatus: function _refreshStatus() {\n        var status = this.model.get(\"status\");\n        this.$status.removeClass().addClass(this.status_classes[status]);\n        this.model.set(\"enabled\", status != \"running\");\n        this.$text_content.attr(\"disabled\", !this.model.get(\"enabled\"));\n        this.$el.removeClass(\"success danger warning\");\n        if (status == \"running\" || status == \"ready\") {\n            this.model.set(\"percentage\", 0);\n        }\n        this.$source.find(\".button\")[status == \"running\" ? \"addClass\" : \"removeClass\"](\"disabled\");\n        if (status == \"success\") {\n            this.$el.addClass(\"success\");\n            this.model.set(\"percentage\", 100);\n            this.$percentage.html(\"100%\");\n        }\n        if (status == \"error\") {\n            this.$el.addClass(\"danger\");\n            this.model.set(\"percentage\", 0);\n            this.$info_progress.hide();\n            this.$info_text.show();\n        } else {\n            this.$info_progress.show();\n            this.$info_text.hide();\n        }\n    },\n\n    /** File name */\n    _refreshFileName: function _refreshFileName() {\n        this.$file_name.html(this.model.get(\"file_name\") || \"-\");\n    },\n\n    /** File size */\n    _refreshFileSize: function _refreshFileSize() {\n        this.$file_size.html(_utils2.default.bytesToString(this.model.get(\"file_size\")));\n    },\n\n    /** Show/hide ftp popup */\n    _showFtp: function _showFtp() {\n        if (!this.ftp.visible) {\n            var self = this;\n            this.ftp.empty();\n            this.ftp.append(new _uploadFtp2.default({\n                ftp_upload_site: this.app.ftp_upload_site,\n                onchange: function onchange(ftp_file) {\n                    self.ftp.hide();\n                    if (self.model.get(\"status\") != \"running\" && ftp_file) {\n                        self.model.reset({\n                            file_mode: \"ftp\",\n                            file_name: ftp_file.path,\n                            file_size: ftp_file.size,\n                            file_path: ftp_file.path\n                        });\n                        self._refreshReady();\n                    }\n                }\n            }).$el);\n            this.ftp.show();\n        } else {\n            this.ftp.hide();\n        }\n    },\n\n    /** Show/hide settings popup */\n    _showSettings: function _showSettings() {\n        if (!this.settings.visible) {\n            this.settings.empty();\n            this.settings.append(new _uploadSettings2.default(this).$el);\n            this.settings.show();\n        } else {\n            this.settings.hide();\n        }\n    },\n\n    /** Template */\n    _template: function _template() {\n        return '<tr class=\"upload-row\">' + \"<td>\" + '<div class=\"upload-source\"/>' + '<div class=\"upload-text-column\">' + '<div class=\"upload-text\">' + '<div class=\"upload-text-info\">You can tell Galaxy to download data from web by entering URL in this box (one per line). You can also directly paste the contents of a file.</div>' + '<textarea class=\"upload-text-content form-control\"/>' + \"</div>\" + \"</div>\" + \"</td>\" + \"<td>\" + '<div class=\"upload-status\"/>' + \"</td>\" + \"<td>\" + '<div class=\"upload-file-desc upload-title\"/>' + \"</td>\" + \"<td>\" + '<div class=\"upload-file-name upload-title\"/>' + \"</td>\" + \"<td>\" + '<div class=\"upload-file-size upload-size\"/>' + \"</td>\" + '<td><div class=\"upload-settings upload-icon-button fa fa-gear\"/></td>' + \"<td>\" + '<div class=\"upload-info\">' + '<div class=\"upload-info-text\"/>' + '<div class=\"upload-info-progress progress\">' + '<div class=\"upload-progress-bar progress-bar progress-bar-success\"/>' + '<div class=\"upload-percentage\">0%</div>' + \"</div>\" + \"</div>\" + \"</td>\" + \"</tr>\";\n    }\n});\n/** Renders the composite upload row view */\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjU5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS1yb3cuanM/MmFlMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFJlbmRlcnMgdGhlIGNvbXBvc2l0ZSB1cGxvYWQgcm93IHZpZXcgKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBVcGxvYWRTZXR0aW5ncyBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtc2V0dGluZ3NcIjtcbmltcG9ydCBVcGxvYWRGdHAgZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLWZ0cFwiO1xuaW1wb3J0IFBvcG92ZXIgZnJvbSBcIm12Yy91aS91aS1wb3BvdmVyXCI7XG5pbXBvcnQgVWkgZnJvbSBcIm12Yy91aS91aS1taXNjXCI7XG5pbXBvcnQgU2VsZWN0IGZyb20gXCJtdmMvdWkvdWktc2VsZWN0XCI7XG5pbXBvcnQgXCJ1dGlscy91cGxvYWRib3hcIjtcbmV4cG9ydCBkZWZhdWx0IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICAvKiogRGljdGlvbmFyeSBvZiB1cGxvYWQgc3RhdGVzIGFuZCBhc3NvY2lhdGVkIGljb25zICovXG4gICAgc3RhdHVzX2NsYXNzZXM6IHtcbiAgICAgICAgaW5pdDogXCJ1cGxvYWQtbW9kZSBmYSBmYS1leGNsYW1hdGlvbiB0ZXh0LXByaW1hcnlcIixcbiAgICAgICAgcmVhZHk6IFwidXBsb2FkLW1vZGUgZmEgZmEtY2hlY2sgdGV4dC1zdWNjZXNzXCIsXG4gICAgICAgIHJ1bm5pbmc6IFwidXBsb2FkLW1vZGUgZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIsXG4gICAgICAgIHN1Y2Nlc3M6IFwidXBsb2FkLW1vZGUgZmEgZmEtY2hlY2tcIixcbiAgICAgICAgZXJyb3I6IFwidXBsb2FkLW1vZGUgZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIlxuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhcHAsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG9wdGlvbnMubW9kZWw7XG4gICAgICAgIHRoaXMuc2V0RWxlbWVudCh0aGlzLl90ZW1wbGF0ZSgpKTtcbiAgICAgICAgdGhpcy4kc291cmNlID0gdGhpcy4kKFwiLnVwbG9hZC1zb3VyY2VcIik7XG4gICAgICAgIHRoaXMuJHNldHRpbmdzID0gdGhpcy4kKFwiLnVwbG9hZC1zZXR0aW5nc1wiKTtcbiAgICAgICAgdGhpcy4kc3RhdHVzID0gdGhpcy4kKFwiLnVwbG9hZC1zdGF0dXNcIik7XG4gICAgICAgIHRoaXMuJHRleHQgPSB0aGlzLiQoXCIudXBsb2FkLXRleHRcIik7XG4gICAgICAgIHRoaXMuJHRleHRfY29udGVudCA9IHRoaXMuJChcIi51cGxvYWQtdGV4dC1jb250ZW50XCIpO1xuICAgICAgICB0aGlzLiRpbmZvX3RleHQgPSB0aGlzLiQoXCIudXBsb2FkLWluZm8tdGV4dFwiKTtcbiAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcyA9IHRoaXMuJChcIi51cGxvYWQtaW5mby1wcm9ncmVzc1wiKTtcbiAgICAgICAgdGhpcy4kZmlsZV9uYW1lID0gdGhpcy4kKFwiLnVwbG9hZC1maWxlLW5hbWVcIik7XG4gICAgICAgIHRoaXMuJGZpbGVfZGVzYyA9IHRoaXMuJChcIi51cGxvYWQtZmlsZS1kZXNjXCIpO1xuICAgICAgICB0aGlzLiRmaWxlX3NpemUgPSB0aGlzLiQoXCIudXBsb2FkLWZpbGUtc2l6ZVwiKTtcbiAgICAgICAgdGhpcy4kcHJvZ3Jlc3NfYmFyID0gdGhpcy4kKFwiLnVwbG9hZC1wcm9ncmVzcy1iYXJcIik7XG4gICAgICAgIHRoaXMuJHBlcmNlbnRhZ2UgPSB0aGlzLiQoXCIudXBsb2FkLXBlcmNlbnRhZ2VcIik7XG5cbiAgICAgICAgLy8gYnVpbGQgdXBsb2FkIGZ1bmN0aW9uc1xuICAgICAgICB0aGlzLnVwbG9hZGlucHV0ID0gdGhpcy4kZWwudXBsb2FkaW5wdXQoe1xuICAgICAgICAgICAgb25kcmFnb3ZlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5nZXQoXCJlbmFibGVkXCIpICYmIHNlbGYuJGVsLmFkZENsYXNzKFwid2FybmluZ1wiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbmRyYWdsZWF2ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi4kZWwucmVtb3ZlQ2xhc3MoXCJ3YXJuaW5nXCIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbihmaWxlcykge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLm1vZGVsLmdldChcInN0YXR1c1wiKSAhPSBcInJ1bm5pbmdcIiAmJiBmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubW9kZWwucmVzZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9kYXRhOiBmaWxlc1swXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfbmFtZTogZmlsZXNbMF0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfc2l6ZTogZmlsZXNbMF0uc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfbW9kZTogZmlsZXNbMF0ubW9kZSB8fCBcImxvY2FsXCJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hSZWFkeSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc291cmNlIHNlbGVjdGlvbiBwb3B1cFxuICAgICAgICB0aGlzLmJ1dHRvbl9tZW51ID0gbmV3IFVpLkJ1dHRvbk1lbnUoe1xuICAgICAgICAgICAgaWNvbjogXCJmYS1jYXJldC1kb3duXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJTZWxlY3RcIiksXG4gICAgICAgICAgICBwdWxsOiBcImxlZnRcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4kc291cmNlLmFwcGVuZCh0aGlzLmJ1dHRvbl9tZW51LiRlbCk7XG4gICAgICAgIHRoaXMuYnV0dG9uX21lbnUuYWRkTWVudSh7XG4gICAgICAgICAgICBpY29uOiBcImZhLWxhcHRvcFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hvb3NlIGxvY2FsIGZpbGVcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnVwbG9hZGlucHV0LmRpYWxvZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuYXBwLmZ0cF91cGxvYWRfc2l0ZSkge1xuICAgICAgICAgICAgdGhpcy5idXR0b25fbWVudS5hZGRNZW51KHtcbiAgICAgICAgICAgICAgICBpY29uOiBcImZhLWZvbGRlci1vcGVuLW9cIixcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJDaG9vc2UgRlRQIGZpbGVcIiksXG4gICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3Nob3dGdHAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmJ1dHRvbl9tZW51LmFkZE1lbnUoe1xuICAgICAgICAgICAgaWNvbjogXCJmYS1lZGl0XCIsXG4gICAgICAgICAgICB0aXRsZTogXCJQYXN0ZS9GZXRjaCBkYXRhXCIsXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vZGVsLnJlc2V0KHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZV9tb2RlOiBcIm5ld1wiLFxuICAgICAgICAgICAgICAgICAgICBmaWxlX25hbWU6IFwiTmV3IEZpbGVcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBhZGQgZnRwIGZpbGUgdmlld2VyXG4gICAgICAgIHRoaXMuZnRwID0gbmV3IFBvcG92ZXIuVmlldyh7XG4gICAgICAgICAgICB0aXRsZTogXCJDaG9vc2UgRlRQIGZpbGU6XCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJHNvdXJjZS5maW5kKFwiLnVpLWJ1dHRvbi1tZW51XCIpLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcInJpZ2h0XCJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gYXBwZW5kIHBvcHVwIHRvIHNldHRpbmdzIGljb25cbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IG5ldyBQb3BvdmVyLlZpZXcoe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiVXBsb2FkIGNvbmZpZ3VyYXRpb25cIiksXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJHNldHRpbmdzLFxuICAgICAgICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSB0ZXh0IGVkaXRpbmcgZXZlbnRcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50Lm9uKFwiY2hhbmdlIGlucHV0XCIsIGUgPT4ge1xuICAgICAgICAgICAgc2VsZi5tb2RlbC5zZXQoe1xuICAgICAgICAgICAgICAgIHVybF9wYXN0ZTogJChlLnRhcmdldCkudmFsKCksXG4gICAgICAgICAgICAgICAgZmlsZV9zaXplOiAkKGUudGFyZ2V0KS52YWwoKS5sZW5ndGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaFJlYWR5KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBzZXR0aW5ncyBwb3BvdmVyXG4gICAgICAgIHRoaXMuJHNldHRpbmdzXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBzZWxmLl9zaG93U2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gbW9kZWwgZXZlbnRzXG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6cGVyY2VudGFnZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZWZyZXNoUGVyY2VudGFnZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpzdGF0dXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaFN0YXR1cygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTppbmZvXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hJbmZvKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOmZpbGVfbmFtZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZWZyZXNoRmlsZU5hbWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6ZmlsZV9tb2RlXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hNb2RlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOmZpbGVfc2l6ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZWZyZXNoRmlsZVNpemUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJyZW1vdmVcIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYXBwLmNvbGxlY3Rpb24ub24oXCJyZXNldFwiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLnJlbW92ZSgpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuYXR0cihcImlkXCIsIGB1cGxvYWQtcm93LSR7dGhpcy5tb2RlbC5pZH1gKTtcbiAgICAgICAgdGhpcy4kZmlsZV9uYW1lLmh0bWwoXy5lc2NhcGUodGhpcy5tb2RlbC5nZXQoXCJmaWxlX25hbWVcIikgfHwgXCItXCIpKTtcbiAgICAgICAgdGhpcy4kZmlsZV9kZXNjLmh0bWwodGhpcy5tb2RlbC5nZXQoXCJmaWxlX2Rlc2NcIikgfHwgXCJVbmF2YWlsYWJsZVwiKTtcbiAgICAgICAgdGhpcy4kZmlsZV9zaXplLmh0bWwoVXRpbHMuYnl0ZXNUb1N0cmluZyh0aGlzLm1vZGVsLmdldChcImZpbGVfc2l6ZVwiKSkpO1xuICAgICAgICB0aGlzLiRzdGF0dXMucmVtb3ZlQ2xhc3MoKS5hZGRDbGFzcyh0aGlzLnN0YXR1c19jbGFzc2VzLmluaXQpO1xuICAgIH0sXG5cbiAgICAvKiogUmVtb3ZlIHZpZXcgKi9cbiAgICByZW1vdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBjYWxsIHRoZSBiYXNlIGNsYXNzIHJlbW92ZSBtZXRob2RcbiAgICAgICAgQmFja2JvbmUuVmlldy5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMpO1xuICAgIH0sXG5cbiAgICAvL1xuICAgIC8vIGhhbmRsZSBtb2RlbCBldmVudHNcbiAgICAvL1xuXG4gICAgLyoqIFJlZnJlc2ggcmVhZHkgb3Igbm90IHN0YXRlcyAqL1xuICAgIF9yZWZyZXNoUmVhZHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmFwcC5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgbW9kZWwuc2V0KFwic3RhdHVzXCIsIChtb2RlbC5nZXQoXCJmaWxlX3NpemVcIikgPiAwICYmIFwicmVhZHlcIikgfHwgXCJpbml0XCIpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggbW9kZSBhbmQgZS5nLiBzaG93L2hpZGUgdGV4dGFyZWEgZmllbGQgKi9cbiAgICBfcmVmcmVzaE1vZGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZmlsZV9tb2RlID0gdGhpcy5tb2RlbC5nZXQoXCJmaWxlX21vZGVcIik7XG4gICAgICAgIGlmIChmaWxlX21vZGUgPT0gXCJuZXdcIikge1xuICAgICAgICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLiRlbC5oZWlnaHQoKTtcbiAgICAgICAgICAgIHRoaXMuJHRleHRcbiAgICAgICAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGAke3RoaXMuJGVsLndpZHRoKCkgLSAxNn1weGAsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogYCR7dGhpcy4kZWwuaGVpZ2h0KCkgLSA4fXB4YFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuJGVsLmhlaWdodCh0aGlzLiRlbC5oZWlnaHQoKSAtIDggKyB0aGlzLiR0ZXh0LmhlaWdodCgpICsgMTYpO1xuICAgICAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50LnZhbChcIlwiKS50cmlnZ2VyKFwia2V5dXBcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiRlbC5oZWlnaHQodGhpcy5oZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy4kdGV4dC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggaW5mb3JtYXRpb24gKi9cbiAgICBfcmVmcmVzaEluZm86IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5mbyA9IHRoaXMubW9kZWwuZ2V0KFwiaW5mb1wiKTtcbiAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgIHRoaXMuJGluZm9fdGV4dC5odG1sKGA8c3Ryb25nPkZhaWxlZDogPC9zdHJvbmc+JHtpbmZvfWApLnNob3coKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJGluZm9fdGV4dC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggcGVyY2VudGFnZSAqL1xuICAgIF9yZWZyZXNoUGVyY2VudGFnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwZXJjZW50YWdlID0gcGFyc2VJbnQodGhpcy5tb2RlbC5nZXQoXCJwZXJjZW50YWdlXCIpKTtcbiAgICAgICAgaWYgKHBlcmNlbnRhZ2UgIT0gMCkge1xuICAgICAgICAgICAgdGhpcy4kcHJvZ3Jlc3NfYmFyLmNzcyh7IHdpZHRoOiBgJHtwZXJjZW50YWdlfSVgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kcHJvZ3Jlc3NfYmFyLmFkZENsYXNzKFwibm8tdHJhbnNpdGlvblwiKTtcbiAgICAgICAgICAgIHRoaXMuJHByb2dyZXNzX2Jhci5jc3MoeyB3aWR0aDogXCIwJVwiIH0pO1xuICAgICAgICAgICAgdGhpcy4kcHJvZ3Jlc3NfYmFyWzBdLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIHRoaXMuJHByb2dyZXNzX2Jhci5yZW1vdmVDbGFzcyhcIm5vLXRyYW5zaXRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kcGVyY2VudGFnZS5odG1sKHBlcmNlbnRhZ2UgIT0gMTAwID8gYCR7cGVyY2VudGFnZX0lYCA6IFwiQWRkaW5nIHRvIGhpc3RvcnkuLi5cIik7XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIHN0YXR1cyAqL1xuICAgIF9yZWZyZXNoU3RhdHVzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXR1cyA9IHRoaXMubW9kZWwuZ2V0KFwic3RhdHVzXCIpO1xuICAgICAgICB0aGlzLiRzdGF0dXMucmVtb3ZlQ2xhc3MoKS5hZGRDbGFzcyh0aGlzLnN0YXR1c19jbGFzc2VzW3N0YXR1c10pO1xuICAgICAgICB0aGlzLm1vZGVsLnNldChcImVuYWJsZWRcIiwgc3RhdHVzICE9IFwicnVubmluZ1wiKTtcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50LmF0dHIoXCJkaXNhYmxlZFwiLCAhdGhpcy5tb2RlbC5nZXQoXCJlbmFibGVkXCIpKTtcbiAgICAgICAgdGhpcy4kZWwucmVtb3ZlQ2xhc3MoXCJzdWNjZXNzIGRhbmdlciB3YXJuaW5nXCIpO1xuICAgICAgICBpZiAoc3RhdHVzID09IFwicnVubmluZ1wiIHx8IHN0YXR1cyA9PSBcInJlYWR5XCIpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuc2V0KFwicGVyY2VudGFnZVwiLCAwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRzb3VyY2UuZmluZChcIi5idXR0b25cIilbc3RhdHVzID09IFwicnVubmluZ1wiID8gXCJhZGRDbGFzc1wiIDogXCJyZW1vdmVDbGFzc1wiXShcImRpc2FibGVkXCIpO1xuICAgICAgICBpZiAoc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLnNldChcInBlcmNlbnRhZ2VcIiwgMTAwKTtcbiAgICAgICAgICAgIHRoaXMuJHBlcmNlbnRhZ2UuaHRtbChcIjEwMCVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXR1cyA9PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIHRoaXMuJGVsLmFkZENsYXNzKFwiZGFuZ2VyXCIpO1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5zZXQoXCJwZXJjZW50YWdlXCIsIDApO1xuICAgICAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcy5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLiRpbmZvX3RleHQuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcy5zaG93KCk7XG4gICAgICAgICAgICB0aGlzLiRpbmZvX3RleHQuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBGaWxlIG5hbWUgKi9cbiAgICBfcmVmcmVzaEZpbGVOYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZmlsZV9uYW1lLmh0bWwodGhpcy5tb2RlbC5nZXQoXCJmaWxlX25hbWVcIikgfHwgXCItXCIpO1xuICAgIH0sXG5cbiAgICAvKiogRmlsZSBzaXplICovXG4gICAgX3JlZnJlc2hGaWxlU2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGZpbGVfc2l6ZS5odG1sKFV0aWxzLmJ5dGVzVG9TdHJpbmcodGhpcy5tb2RlbC5nZXQoXCJmaWxlX3NpemVcIikpKTtcbiAgICB9LFxuXG4gICAgLyoqIFNob3cvaGlkZSBmdHAgcG9wdXAgKi9cbiAgICBfc2hvd0Z0cDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5mdHAudmlzaWJsZSkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5mdHAuZW1wdHkoKTtcbiAgICAgICAgICAgIHRoaXMuZnRwLmFwcGVuZChcbiAgICAgICAgICAgICAgICBuZXcgVXBsb2FkRnRwKHtcbiAgICAgICAgICAgICAgICAgICAgZnRwX3VwbG9hZF9zaXRlOiB0aGlzLmFwcC5mdHBfdXBsb2FkX3NpdGUsXG4gICAgICAgICAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbihmdHBfZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mdHAuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubW9kZWwuZ2V0KFwic3RhdHVzXCIpICE9IFwicnVubmluZ1wiICYmIGZ0cF9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5yZXNldCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfbW9kZTogXCJmdHBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZV9uYW1lOiBmdHBfZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlX3NpemU6IGZ0cF9maWxlLnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfcGF0aDogZnRwX2ZpbGUucGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hSZWFkeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuJGVsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5mdHAuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mdHAuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBTaG93L2hpZGUgc2V0dGluZ3MgcG9wdXAgKi9cbiAgICBfc2hvd1NldHRpbmdzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnZpc2libGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZW1wdHkoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYXBwZW5kKG5ldyBVcGxvYWRTZXR0aW5ncyh0aGlzKS4kZWwpO1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zaG93KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgKi9cbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJzx0ciBjbGFzcz1cInVwbG9hZC1yb3dcIj4nICtcbiAgICAgICAgICAgIFwiPHRkPlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLXNvdXJjZVwiLz4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLXRleHQtY29sdW1uXCI+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC10ZXh0XCI+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC10ZXh0LWluZm9cIj5Zb3UgY2FuIHRlbGwgR2FsYXh5IHRvIGRvd25sb2FkIGRhdGEgZnJvbSB3ZWIgYnkgZW50ZXJpbmcgVVJMIGluIHRoaXMgYm94IChvbmUgcGVyIGxpbmUpLiBZb3UgY2FuIGFsc28gZGlyZWN0bHkgcGFzdGUgdGhlIGNvbnRlbnRzIG9mIGEgZmlsZS48L2Rpdj4nICtcbiAgICAgICAgICAgICc8dGV4dGFyZWEgY2xhc3M9XCJ1cGxvYWQtdGV4dC1jb250ZW50IGZvcm0tY29udHJvbFwiLz4nICtcbiAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICBcIjwvdGQ+XCIgK1xuICAgICAgICAgICAgXCI8dGQ+XCIgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtc3RhdHVzXCIvPicgK1xuICAgICAgICAgICAgXCI8L3RkPlwiICtcbiAgICAgICAgICAgIFwiPHRkPlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWZpbGUtZGVzYyB1cGxvYWQtdGl0bGVcIi8+JyArXG4gICAgICAgICAgICBcIjwvdGQ+XCIgK1xuICAgICAgICAgICAgXCI8dGQ+XCIgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtZmlsZS1uYW1lIHVwbG9hZC10aXRsZVwiLz4nICtcbiAgICAgICAgICAgIFwiPC90ZD5cIiArXG4gICAgICAgICAgICBcIjx0ZD5cIiArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1maWxlLXNpemUgdXBsb2FkLXNpemVcIi8+JyArXG4gICAgICAgICAgICBcIjwvdGQ+XCIgK1xuICAgICAgICAgICAgJzx0ZD48ZGl2IGNsYXNzPVwidXBsb2FkLXNldHRpbmdzIHVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1nZWFyXCIvPjwvdGQ+JyArXG4gICAgICAgICAgICBcIjx0ZD5cIiArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1pbmZvXCI+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1pbmZvLXRleHRcIi8+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1pbmZvLXByb2dyZXNzIHByb2dyZXNzXCI+JyArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1wcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1zdWNjZXNzXCIvPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtcGVyY2VudGFnZVwiPjAlPC9kaXY+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgIFwiPC9kaXY+XCIgK1xuICAgICAgICAgICAgXCI8L3RkPlwiICtcbiAgICAgICAgICAgIFwiPC90cj5cIlxuICAgICAgICApO1xuICAgIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29tcG9zaXRlL2NvbXBvc2l0ZS1yb3cuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUNBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFqQkE7QUFDQTtBQW1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBUkE7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFiQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbUNBO0FBblVBO0FBUkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///259\n");

/***/ }),
/* 260 */
/*!*****************************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/collection/collection-view.js ***!
  \*****************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadModel = __webpack_require__(/*! mvc/upload/upload-model */ 49);\n\nvar _uploadModel2 = _interopRequireDefault(_uploadModel);\n\nvar _collectionRow = __webpack_require__(/*! mvc/upload/collection/collection-row */ 261);\n\nvar _collectionRow2 = _interopRequireDefault(_collectionRow);\n\nvar _uploadFtp = __webpack_require__(/*! mvc/upload/upload-ftp */ 93);\n\nvar _uploadFtp2 = _interopRequireDefault(_uploadFtp);\n\nvar _uploadExtension = __webpack_require__(/*! mvc/upload/upload-extension */ 94);\n\nvar _uploadExtension2 = _interopRequireDefault(_uploadExtension);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _listCollectionCreator = __webpack_require__(/*! mvc/collection/list-collection-creator */ 29);\n\nvar _listCollectionCreator2 = _interopRequireDefault(_listCollectionCreator);\n\n__webpack_require__(/*! utils/uploadbox */ 95);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Renders contents of the collection uploader */\nexports.default = Backbone.View.extend({\n    // current upload size in bytes\n    upload_size: 0,\n\n    // contains upload row models\n    collection: new _uploadModel2.default.Collection(),\n\n    // keeps track of the current uploader state\n    counter: {\n        announce: 0,\n        success: 0,\n        error: 0,\n        running: 0,\n        reset: function reset() {\n            this.announce = this.success = this.error = this.running = 0;\n        }\n    },\n\n    initialize: function initialize(app) {\n        var self = this;\n        this.app = app;\n        this.options = app.options;\n        this.list_extensions = app.list_extensions;\n        this.list_genomes = app.list_genomes;\n        this.ui_button = app.ui_button;\n        this.ftp_upload_site = app.currentFtp();\n        this.setElement(this._template());\n\n        // append buttons to dom\n        this.btnLocal = new _uiMisc2.default.Button({\n            id: \"btn-local\",\n            title: (0, _localization2.default)(\"Choose local files\"),\n            onclick: function onclick() {\n                self.uploadbox.select();\n            },\n            icon: \"fa fa-laptop\"\n        });\n        this.btnFtp = new _uiMisc2.default.Button({\n            id: \"btn-ftp\",\n            title: (0, _localization2.default)(\"Choose FTP files\"),\n            onclick: function onclick() {\n                self._eventFtp();\n            },\n            icon: \"fa fa-folder-open-o\"\n        });\n        this.btnCreate = new _uiMisc2.default.Button({\n            id: \"btn-new\",\n            title: \"Paste/Fetch data\",\n            onclick: function onclick() {\n                self._eventCreate();\n            },\n            icon: \"fa fa-edit\"\n        });\n        this.btnStart = new _uiMisc2.default.Button({\n            id: \"btn-start\",\n            title: (0, _localization2.default)(\"Start\"),\n            onclick: function onclick() {\n                self._eventStart();\n            }\n        });\n        this.btnBuild = new _uiMisc2.default.Button({\n            id: \"btn-build\",\n            title: (0, _localization2.default)(\"Build\"),\n            onclick: function onclick() {\n                self._eventBuild();\n            }\n        });\n        this.btnStop = new _uiMisc2.default.Button({\n            id: \"btn-stop\",\n            title: (0, _localization2.default)(\"Pause\"),\n            onclick: function onclick() {\n                self._eventStop();\n            }\n        });\n        this.btnReset = new _uiMisc2.default.Button({\n            id: \"btn-reset\",\n            title: (0, _localization2.default)(\"Reset\"),\n            onclick: function onclick() {\n                self._eventReset();\n            }\n        });\n        this.btnClose = new _uiMisc2.default.Button({\n            id: \"btn-close\",\n            title: (0, _localization2.default)(\"Close\"),\n            onclick: function onclick() {\n                self.app.modal.hide();\n            }\n        });\n        _.each([this.btnLocal, this.btnFtp, this.btnCreate, this.btnStop, this.btnReset, this.btnStart, this.btnBuild, this.btnClose], function (button) {\n            self.$(\".upload-buttons\").prepend(button.$el);\n        });\n\n        // file upload\n        this.uploadbox = this.$(\".upload-box\").uploadbox({\n            url: this.app.options.nginx_upload_path,\n            announce: function announce(index, file) {\n                self._eventAnnounce(index, file);\n            },\n            initialize: function initialize(index) {\n                return self.app.toData([self.collection.get(index)], self.history_id);\n            },\n            progress: function progress(index, percentage) {\n                self._eventProgress(index, percentage);\n            },\n            success: function success(index, message) {\n                self._eventSuccess(index, message);\n            },\n            error: function error(index, message) {\n                self._eventError(index, message);\n            },\n            complete: function complete() {\n                self._eventComplete();\n            },\n            ondragover: function ondragover() {\n                self.$(\".upload-box\").addClass(\"highlight\");\n            },\n            ondragleave: function ondragleave() {\n                self.$(\".upload-box\").removeClass(\"highlight\");\n            }\n        });\n\n        // add ftp file viewer\n        this.ftp = new _uiPopover2.default.View({\n            title: (0, _localization2.default)(\"FTP files\"),\n            container: this.btnFtp.$el\n        });\n\n        // select extension\n        this.select_extension = new _uiSelect2.default.View({\n            css: \"upload-footer-selection-compressed\",\n            container: this.$(\".upload-footer-extension\"),\n            data: _.filter(this.list_extensions, function (ext) {\n                return !ext.composite_files;\n            }),\n            value: this.options.default_extension,\n            onchange: function onchange(extension) {\n                self.updateExtension(extension);\n            }\n        });\n\n        this.collectionType = \"list\";\n        this.select_collection = new _uiSelect2.default.View({\n            css: \"upload-footer-selection-compressed\",\n            container: this.$(\".upload-footer-collection-type\"),\n            data: [{ id: \"list\", text: \"List\" }, { id: \"paired\", text: \"Paired\" }, { id: \"list:paired\", text: \"List of Pairs\" }],\n            value: \"list\",\n            onchange: function onchange(collectionType) {\n                self.updateCollectionType(collectionType);\n            }\n        });\n\n        // handle extension info popover\n        this.$(\".upload-footer-extension-info\").on(\"click\", function (e) {\n            new _uploadExtension2.default({\n                $el: $(e.target),\n                title: self.select_extension.text(),\n                extension: self.select_extension.value(),\n                list: self.list_extensions,\n                placement: \"top\"\n            });\n        }).on(\"mousedown\", function (e) {\n            e.preventDefault();\n        });\n\n        // genome extension\n        this.select_genome = new _uiSelect2.default.View({\n            css: \"upload-footer-selection\",\n            container: this.$(\".upload-footer-genome\"),\n            data: this.list_genomes,\n            value: this.options.default_genome,\n            onchange: function onchange(genome) {\n                self.updateGenome(genome);\n            }\n        });\n\n        // events\n        this.collection.on(\"remove\", function (model) {\n            self._eventRemove(model);\n        });\n        this._updateScreen();\n    },\n\n    /** A new file has been dropped/selected through the uploadbox plugin */\n    _eventAnnounce: function _eventAnnounce(index, file) {\n        this.counter.announce++;\n        var new_model = new _uploadModel2.default.Model({\n            id: index,\n            file_name: file.name,\n            file_size: file.size,\n            file_mode: file.mode || \"local\",\n            file_path: file.path,\n            file_data: file,\n            extension: this.select_extension.value(),\n            genome: this.select_genome.value()\n        });\n        this.collection.add(new_model);\n        var upload_row = new _collectionRow2.default(this, { model: new_model });\n        this.$(\".upload-table > tbody:first\").append(upload_row.$el);\n        this._updateScreen();\n        upload_row.render();\n    },\n\n    /** Progress */\n    _eventProgress: function _eventProgress(index, percentage) {\n        var it = this.collection.get(index);\n        it.set(\"percentage\", percentage);\n        this.ui_button.model.set(\"percentage\", this._uploadPercentage(percentage, it.get(\"file_size\")));\n    },\n\n    /** Success */\n    _eventSuccess: function _eventSuccess(index, message) {\n        // var hdaId = message[\"outputs\"][0][\"id\"];\n        var hids = _.pluck(message[\"outputs\"], \"hid\");\n        var it = this.collection.get(index);\n        it.set({ percentage: 100, status: \"success\", hids: hids });\n        this.ui_button.model.set(\"percentage\", this._uploadPercentage(100, it.get(\"file_size\")));\n        this.upload_completed += it.get(\"file_size\") * 100;\n        this.counter.announce--;\n        this.counter.success++;\n        this._updateScreen();\n        Galaxy.currHistoryPanel.refreshContents();\n    },\n\n    /** Error */\n    _eventError: function _eventError(index, message) {\n        var it = this.collection.get(index);\n        it.set({ percentage: 100, status: \"error\", info: message });\n        this.ui_button.model.set({\n            percentage: this._uploadPercentage(100, it.get(\"file_size\")),\n            status: \"danger\"\n        });\n        this.upload_completed += it.get(\"file_size\") * 100;\n        this.counter.announce--;\n        this.counter.error++;\n        this._updateScreen();\n    },\n\n    /** Queue is done */\n    _eventComplete: function _eventComplete() {\n        this.collection.each(function (model) {\n            model.get(\"status\") == \"queued\" && model.set(\"status\", \"init\");\n        });\n        this.counter.running = 0;\n        this._updateScreen();\n    },\n\n    _eventBuild: function _eventBuild() {\n        var allHids = [];\n        _.forEach(this.collection.models, function (upload) {\n            allHids.push.apply(allHids, upload.get(\"hids\"));\n        });\n        var models = _.map(allHids, function (hid) {\n            return Galaxy.currHistoryPanel.collection.getByHid(hid);\n        });\n        var selection = new Galaxy.currHistoryPanel.collection.constructor(models);\n        // I'm building the selection wrong because I need to set this historyId directly.\n        selection.historyId = Galaxy.currHistoryPanel.collection.historyId;\n        Galaxy.currHistoryPanel.buildCollection(this.collectionType, selection, true);\n        this.counter.running = 0;\n        this._updateScreen();\n        this._eventReset();\n        this.app.modal.hide();\n    },\n\n    /** Remove model from upload list */\n    _eventRemove: function _eventRemove(model) {\n        var status = model.get(\"status\");\n        if (status == \"success\") {\n            this.counter.success--;\n        } else if (status == \"error\") {\n            this.counter.error--;\n        } else {\n            this.counter.announce--;\n        }\n        this.uploadbox.remove(model.id);\n        this._updateScreen();\n    },\n\n    //\n    // events triggered by this view\n    //\n\n    /** Show/hide ftp popup */\n    _eventFtp: function _eventFtp() {\n        if (!this.ftp.visible) {\n            this.ftp.empty();\n            var self = this;\n            this.ftp.append(new _uploadFtp2.default({\n                collection: this.collection,\n                ftp_upload_site: this.ftp_upload_site,\n                onadd: function onadd(ftp_file) {\n                    return self.uploadbox.add([{\n                        mode: \"ftp\",\n                        name: ftp_file.path,\n                        size: ftp_file.size,\n                        path: ftp_file.path\n                    }]);\n                },\n                onremove: function onremove(model_index) {\n                    self.collection.remove(model_index);\n                }\n            }).$el);\n            this.ftp.show();\n        } else {\n            this.ftp.hide();\n        }\n    },\n\n    /** Create a new file */\n    _eventCreate: function _eventCreate() {\n        this.uploadbox.add([{ name: \"New File\", size: 0, mode: \"new\" }]);\n    },\n\n    /** Start upload process */\n    _eventStart: function _eventStart() {\n        if (this.counter.announce == 0 || this.counter.running > 0) {\n            return;\n        }\n        var self = this;\n        this.upload_size = 0;\n        this.upload_completed = 0;\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"init\") {\n                model.set(\"status\", \"queued\");\n                self.upload_size += model.get(\"file_size\");\n            }\n        });\n        this.ui_button.model.set({ percentage: 0, status: \"success\" });\n        this.counter.running = this.counter.announce;\n        this.history_id = this.app.currentHistory();\n        this.uploadbox.start();\n        this._updateScreen();\n    },\n\n    /** Pause upload process */\n    _eventStop: function _eventStop() {\n        if (this.counter.running > 0) {\n            this.ui_button.model.set(\"status\", \"info\");\n            $(\".upload-top-info\").html(\"Queue will pause after completing the current file...\");\n            this.uploadbox.stop();\n        }\n    },\n\n    /** Remove all */\n    _eventReset: function _eventReset() {\n        if (this.counter.running == 0) {\n            this.collection.reset();\n            this.counter.reset();\n            this.uploadbox.reset();\n            this.select_extension.value(this.options.default_extension);\n            this.select_genome.value(this.options.default_genome);\n            this.ui_button.model.set(\"percentage\", 0);\n            this._updateScreen();\n        }\n    },\n\n    /** Update extension for all models */\n    updateExtension: function updateExtension(extension, defaults_only) {\n        var self = this;\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"init\" && (model.get(\"extension\") == self.options.default_extension || !defaults_only)) {\n                model.set(\"extension\", extension);\n            }\n        });\n    },\n\n    /** Update collection type */\n    updateCollectionType: function updateCollectionType(collectionType) {\n        var self = this;\n        this.collectionType = collectionType;\n    },\n\n    /** Update genome for all models */\n    updateGenome: function updateGenome(genome, defaults_only) {\n        var self = this;\n        this.collection.each(function (model) {\n            if (model.get(\"status\") == \"init\" && (model.get(\"genome\") == self.options.default_genome || !defaults_only)) {\n                model.set(\"genome\", genome);\n            }\n        });\n    },\n\n    /** Set screen */\n    _updateScreen: function _updateScreen() {\n        var message = \"\";\n        if (this.counter.announce == 0) {\n            if (this.uploadbox.compatible()) {\n                message = \"&nbsp;\";\n            } else {\n                message = \"Browser does not support Drag & Drop. Try Firefox 4+, Chrome 7+, IE 10+, Opera 12+ or Safari 6+.\";\n            }\n        } else {\n            if (this.counter.running == 0) {\n                message = \"You added \" + this.counter.announce + \" file(s) to the queue. Add more files or click 'Start' to proceed.\";\n            } else {\n                message = \"Please wait...\" + this.counter.announce + \" out of \" + this.counter.running + \" remaining.\";\n            }\n        }\n        this.$(\".upload-top-info\").html(message);\n        var enable_reset = this.counter.running == 0 && this.counter.announce + this.counter.success + this.counter.error > 0;\n        var enable_start = this.counter.running == 0 && this.counter.announce > 0;\n        var enable_build = this.counter.running == 0 && this.counter.announce == 0 && this.counter.success > 0 && this.counter.error == 0;\n        var enable_sources = this.counter.running == 0;\n        var show_table = this.counter.announce + this.counter.success + this.counter.error > 0;\n        this.btnReset[enable_reset ? \"enable\" : \"disable\"]();\n        this.btnStart[enable_start ? \"enable\" : \"disable\"]();\n        this.btnStart.$el[enable_start ? \"addClass\" : \"removeClass\"](\"btn-primary\");\n        this.btnBuild[enable_build ? \"enable\" : \"disable\"]();\n        this.btnBuild.$el[enable_build ? \"addClass\" : \"removeClass\"](\"btn-primary\");\n        this.btnStop[this.counter.running > 0 ? \"enable\" : \"disable\"]();\n        this.btnLocal[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnFtp[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnCreate[enable_sources ? \"enable\" : \"disable\"]();\n        this.btnFtp.$el[this.ftp_upload_site ? \"show\" : \"hide\"]();\n        this.$(\".upload-table\")[show_table ? \"show\" : \"hide\"]();\n        this.$(\".upload-helper\")[show_table ? \"hide\" : \"show\"]();\n    },\n\n    /** Calculate percentage of all queued uploads */\n    _uploadPercentage: function _uploadPercentage(percentage, size) {\n        return (this.upload_completed + percentage * size) / this.upload_size;\n    },\n\n    /** Template */\n    _template: function _template() {\n        return '<div class=\"upload-view-default\">' + '<div class=\"upload-top\">' + '<h6 class=\"upload-top-info\"/>' + \"</div>\" + '<div class=\"upload-box\">' + '<div class=\"upload-helper\"><i class=\"fa fa-files-o\"/>Drop files here</div>' + '<table class=\"upload-table ui-table-striped\" style=\"display: none;\">' + \"<thead>\" + \"<tr>\" + \"<th>Name</th>\" + \"<th>Size</th>\" + \"<th>Status</th>\" + \"<th/>\" + \"</tr>\" + \"</thead>\" + \"<tbody/>\" + \"</table>\" + \"</div>\" + '<div class=\"upload-footer\">' + '<span class=\"upload-footer-title-compressed\">Collection Type:</span>' + '<span class=\"upload-footer-collection-type\"/>' + '<span class=\"upload-footer-title-compressed\">File Type:</span>' + '<span class=\"upload-footer-extension\"/>' + '<span class=\"upload-footer-extension-info upload-icon-button fa fa-search\"/> ' + '<span class=\"upload-footer-title-compressed\">Genome (set all):</span>' + '<span class=\"upload-footer-genome\"/>' + \"</div>\" + '<div class=\"upload-buttons\"/>' + \"</div>\";\n    }\n});\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29sbGVjdGlvbi9jb2xsZWN0aW9uLXZpZXcuanM/ZThjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFJlbmRlcnMgY29udGVudHMgb2YgdGhlIGNvbGxlY3Rpb24gdXBsb2FkZXIgKi9cbmltcG9ydCBVdGlscyBmcm9tIFwidXRpbHMvdXRpbHNcIjtcbmltcG9ydCBVcGxvYWRNb2RlbCBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtbW9kZWxcIjtcbmltcG9ydCBVcGxvYWRSb3cgZnJvbSBcIm12Yy91cGxvYWQvY29sbGVjdGlvbi9jb2xsZWN0aW9uLXJvd1wiO1xuaW1wb3J0IFVwbG9hZEZ0cCBmcm9tIFwibXZjL3VwbG9hZC91cGxvYWQtZnRwXCI7XG5pbXBvcnQgVXBsb2FkRXh0ZW5zaW9uIGZyb20gXCJtdmMvdXBsb2FkL3VwbG9hZC1leHRlbnNpb25cIjtcbmltcG9ydCBQb3BvdmVyIGZyb20gXCJtdmMvdWkvdWktcG9wb3ZlclwiO1xuaW1wb3J0IFNlbGVjdCBmcm9tIFwibXZjL3VpL3VpLXNlbGVjdFwiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xuaW1wb3J0IExJU1RfQ09MTEVDVElPTl9DUkVBVE9SIGZyb20gXCJtdmMvY29sbGVjdGlvbi9saXN0LWNvbGxlY3Rpb24tY3JlYXRvclwiO1xuaW1wb3J0IFwidXRpbHMvdXBsb2FkYm94XCI7XG5leHBvcnQgZGVmYXVsdCBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgLy8gY3VycmVudCB1cGxvYWQgc2l6ZSBpbiBieXRlc1xuICAgIHVwbG9hZF9zaXplOiAwLFxuXG4gICAgLy8gY29udGFpbnMgdXBsb2FkIHJvdyBtb2RlbHNcbiAgICBjb2xsZWN0aW9uOiBuZXcgVXBsb2FkTW9kZWwuQ29sbGVjdGlvbigpLFxuXG4gICAgLy8ga2VlcHMgdHJhY2sgb2YgdGhlIGN1cnJlbnQgdXBsb2FkZXIgc3RhdGVcbiAgICBjb3VudGVyOiB7XG4gICAgICAgIGFubm91bmNlOiAwLFxuICAgICAgICBzdWNjZXNzOiAwLFxuICAgICAgICBlcnJvcjogMCxcbiAgICAgICAgcnVubmluZzogMCxcbiAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5hbm5vdW5jZSA9IHRoaXMuc3VjY2VzcyA9IHRoaXMuZXJyb3IgPSB0aGlzLnJ1bm5pbmcgPSAwO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGFwcCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBhcHAub3B0aW9ucztcbiAgICAgICAgdGhpcy5saXN0X2V4dGVuc2lvbnMgPSBhcHAubGlzdF9leHRlbnNpb25zO1xuICAgICAgICB0aGlzLmxpc3RfZ2Vub21lcyA9IGFwcC5saXN0X2dlbm9tZXM7XG4gICAgICAgIHRoaXMudWlfYnV0dG9uID0gYXBwLnVpX2J1dHRvbjtcbiAgICAgICAgdGhpcy5mdHBfdXBsb2FkX3NpdGUgPSBhcHAuY3VycmVudEZ0cCgpO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUoKSk7XG5cbiAgICAgICAgLy8gYXBwZW5kIGJ1dHRvbnMgdG8gZG9tXG4gICAgICAgIHRoaXMuYnRuTG9jYWwgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1sb2NhbFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hvb3NlIGxvY2FsIGZpbGVzXCIpLFxuICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi51cGxvYWRib3guc2VsZWN0KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaWNvbjogXCJmYSBmYS1sYXB0b3BcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idG5GdHAgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1mdHBcIixcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIkNob29zZSBGVFAgZmlsZXNcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudEZ0cCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGljb246IFwiZmEgZmEtZm9sZGVyLW9wZW4tb1wiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ0bkNyZWF0ZSA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgaWQ6IFwiYnRuLW5ld1wiLFxuICAgICAgICAgICAgdGl0bGU6IFwiUGFzdGUvRmV0Y2ggZGF0YVwiLFxuICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRDcmVhdGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLWVkaXRcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idG5TdGFydCA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgaWQ6IFwiYnRuLXN0YXJ0XCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJTdGFydFwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50U3RhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnRuQnVpbGQgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1idWlsZFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQnVpbGRcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudEJ1aWxkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ0blN0b3AgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1zdG9wXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJQYXVzZVwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50U3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idG5SZXNldCA9IG5ldyBVaS5CdXR0b24oe1xuICAgICAgICAgICAgaWQ6IFwiYnRuLXJlc2V0XCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJSZXNldFwiKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50UmVzZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnRuQ2xvc2UgPSBuZXcgVWkuQnV0dG9uKHtcbiAgICAgICAgICAgIGlkOiBcImJ0bi1jbG9zZVwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2xvc2VcIiksXG4gICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmFwcC5tb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBfLmVhY2goXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgdGhpcy5idG5Mb2NhbCxcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkZ0cCxcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkNyZWF0ZSxcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blN0b3AsXG4gICAgICAgICAgICAgICAgdGhpcy5idG5SZXNldCxcbiAgICAgICAgICAgICAgICB0aGlzLmJ0blN0YXJ0LFxuICAgICAgICAgICAgICAgIHRoaXMuYnRuQnVpbGQsXG4gICAgICAgICAgICAgICAgdGhpcy5idG5DbG9zZVxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi4kKFwiLnVwbG9hZC1idXR0b25zXCIpLnByZXBlbmQoYnV0dG9uLiRlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gZmlsZSB1cGxvYWRcbiAgICAgICAgdGhpcy51cGxvYWRib3ggPSB0aGlzLiQoXCIudXBsb2FkLWJveFwiKS51cGxvYWRib3goe1xuICAgICAgICAgICAgdXJsOiB0aGlzLmFwcC5vcHRpb25zLm5naW54X3VwbG9hZF9wYXRoLFxuICAgICAgICAgICAgYW5ub3VuY2U6IGZ1bmN0aW9uKGluZGV4LCBmaWxlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRBbm5vdW5jZShpbmRleCwgZmlsZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5hcHAudG9EYXRhKFtzZWxmLmNvbGxlY3Rpb24uZ2V0KGluZGV4KV0sIHNlbGYuaGlzdG9yeV9pZCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uKGluZGV4LCBwZXJjZW50YWdlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fZXZlbnRQcm9ncmVzcyhpbmRleCwgcGVyY2VudGFnZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oaW5kZXgsIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudFN1Y2Nlc3MoaW5kZXgsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihpbmRleCwgbWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2V2ZW50RXJyb3IoaW5kZXgsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9ldmVudENvbXBsZXRlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25kcmFnb3ZlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgc2VsZi4kKFwiLnVwbG9hZC1ib3hcIikuYWRkQ2xhc3MoXCJoaWdobGlnaHRcIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25kcmFnbGVhdmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuJChcIi51cGxvYWQtYm94XCIpLnJlbW92ZUNsYXNzKFwiaGlnaGxpZ2h0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBhZGQgZnRwIGZpbGUgdmlld2VyXG4gICAgICAgIHRoaXMuZnRwID0gbmV3IFBvcG92ZXIuVmlldyh7XG4gICAgICAgICAgICB0aXRsZTogX2woXCJGVFAgZmlsZXNcIiksXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuYnRuRnRwLiRlbFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzZWxlY3QgZXh0ZW5zaW9uXG4gICAgICAgIHRoaXMuc2VsZWN0X2V4dGVuc2lvbiA9IG5ldyBTZWxlY3QuVmlldyh7XG4gICAgICAgICAgICBjc3M6IFwidXBsb2FkLWZvb3Rlci1zZWxlY3Rpb24tY29tcHJlc3NlZFwiLFxuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLiQoXCIudXBsb2FkLWZvb3Rlci1leHRlbnNpb25cIiksXG4gICAgICAgICAgICBkYXRhOiBfLmZpbHRlcih0aGlzLmxpc3RfZXh0ZW5zaW9ucywgZXh0ID0+ICFleHQuY29tcG9zaXRlX2ZpbGVzKSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm9wdGlvbnMuZGVmYXVsdF9leHRlbnNpb24sXG4gICAgICAgICAgICBvbmNoYW5nZTogZnVuY3Rpb24oZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGVFeHRlbnNpb24oZXh0ZW5zaW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uVHlwZSA9IFwibGlzdFwiO1xuICAgICAgICB0aGlzLnNlbGVjdF9jb2xsZWN0aW9uID0gbmV3IFNlbGVjdC5WaWV3KHtcbiAgICAgICAgICAgIGNzczogXCJ1cGxvYWQtZm9vdGVyLXNlbGVjdGlvbi1jb21wcmVzc2VkXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWNvbGxlY3Rpb24tdHlwZVwiKSxcbiAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgICB7IGlkOiBcImxpc3RcIiwgdGV4dDogXCJMaXN0XCIgfSxcbiAgICAgICAgICAgICAgICB7IGlkOiBcInBhaXJlZFwiLCB0ZXh0OiBcIlBhaXJlZFwiIH0sXG4gICAgICAgICAgICAgICAgeyBpZDogXCJsaXN0OnBhaXJlZFwiLCB0ZXh0OiBcIkxpc3Qgb2YgUGFpcnNcIiB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgdmFsdWU6IFwibGlzdFwiLFxuICAgICAgICAgICAgb25jaGFuZ2U6IGZ1bmN0aW9uKGNvbGxlY3Rpb25UeXBlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi51cGRhdGVDb2xsZWN0aW9uVHlwZShjb2xsZWN0aW9uVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBleHRlbnNpb24gaW5mbyBwb3BvdmVyXG4gICAgICAgIHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWV4dGVuc2lvbi1pbmZvXCIpXG4gICAgICAgICAgICAub24oXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgVXBsb2FkRXh0ZW5zaW9uKHtcbiAgICAgICAgICAgICAgICAgICAgJGVsOiAkKGUudGFyZ2V0KSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHNlbGYuc2VsZWN0X2V4dGVuc2lvbi50ZXh0KCksXG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbjogc2VsZi5zZWxlY3RfZXh0ZW5zaW9uLnZhbHVlKCksXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6IHNlbGYubGlzdF9leHRlbnNpb25zLFxuICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6IFwidG9wXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oXCJtb3VzZWRvd25cIiwgZSA9PiB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gZ2Vub21lIGV4dGVuc2lvblxuICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUgPSBuZXcgU2VsZWN0LlZpZXcoe1xuICAgICAgICAgICAgY3NzOiBcInVwbG9hZC1mb290ZXItc2VsZWN0aW9uXCIsXG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMuJChcIi51cGxvYWQtZm9vdGVyLWdlbm9tZVwiKSxcbiAgICAgICAgICAgIGRhdGE6IHRoaXMubGlzdF9nZW5vbWVzLFxuICAgICAgICAgICAgdmFsdWU6IHRoaXMub3B0aW9ucy5kZWZhdWx0X2dlbm9tZSxcbiAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbihnZW5vbWUpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZUdlbm9tZShnZW5vbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBldmVudHNcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLm9uKFwicmVtb3ZlXCIsIG1vZGVsID0+IHtcbiAgICAgICAgICAgIHNlbGYuX2V2ZW50UmVtb3ZlKG1vZGVsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVNjcmVlbigpO1xuICAgIH0sXG5cbiAgICAvKiogQSBuZXcgZmlsZSBoYXMgYmVlbiBkcm9wcGVkL3NlbGVjdGVkIHRocm91Z2ggdGhlIHVwbG9hZGJveCBwbHVnaW4gKi9cbiAgICBfZXZlbnRBbm5vdW5jZTogZnVuY3Rpb24oaW5kZXgsIGZpbGUpIHtcbiAgICAgICAgdGhpcy5jb3VudGVyLmFubm91bmNlKys7XG4gICAgICAgIHZhciBuZXdfbW9kZWwgPSBuZXcgVXBsb2FkTW9kZWwuTW9kZWwoe1xuICAgICAgICAgICAgaWQ6IGluZGV4LFxuICAgICAgICAgICAgZmlsZV9uYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgICBmaWxlX3NpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgIGZpbGVfbW9kZTogZmlsZS5tb2RlIHx8IFwibG9jYWxcIixcbiAgICAgICAgICAgIGZpbGVfcGF0aDogZmlsZS5wYXRoLFxuICAgICAgICAgICAgZmlsZV9kYXRhOiBmaWxlLFxuICAgICAgICAgICAgZXh0ZW5zaW9uOiB0aGlzLnNlbGVjdF9leHRlbnNpb24udmFsdWUoKSxcbiAgICAgICAgICAgIGdlbm9tZTogdGhpcy5zZWxlY3RfZ2Vub21lLnZhbHVlKClcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5hZGQobmV3X21vZGVsKTtcbiAgICAgICAgdmFyIHVwbG9hZF9yb3cgPSBuZXcgVXBsb2FkUm93KHRoaXMsIHsgbW9kZWw6IG5ld19tb2RlbCB9KTtcbiAgICAgICAgdGhpcy4kKFwiLnVwbG9hZC10YWJsZSA+IHRib2R5OmZpcnN0XCIpLmFwcGVuZCh1cGxvYWRfcm93LiRlbCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVNjcmVlbigpO1xuICAgICAgICB1cGxvYWRfcm93LnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICAvKiogUHJvZ3Jlc3MgKi9cbiAgICBfZXZlbnRQcm9ncmVzczogZnVuY3Rpb24oaW5kZXgsIHBlcmNlbnRhZ2UpIHtcbiAgICAgICAgdmFyIGl0ID0gdGhpcy5jb2xsZWN0aW9uLmdldChpbmRleCk7XG4gICAgICAgIGl0LnNldChcInBlcmNlbnRhZ2VcIiwgcGVyY2VudGFnZSk7XG4gICAgICAgIHRoaXMudWlfYnV0dG9uLm1vZGVsLnNldChcInBlcmNlbnRhZ2VcIiwgdGhpcy5fdXBsb2FkUGVyY2VudGFnZShwZXJjZW50YWdlLCBpdC5nZXQoXCJmaWxlX3NpemVcIikpKTtcbiAgICB9LFxuXG4gICAgLyoqIFN1Y2Nlc3MgKi9cbiAgICBfZXZlbnRTdWNjZXNzOiBmdW5jdGlvbihpbmRleCwgbWVzc2FnZSkge1xuICAgICAgICAvLyB2YXIgaGRhSWQgPSBtZXNzYWdlW1wib3V0cHV0c1wiXVswXVtcImlkXCJdO1xuICAgICAgICB2YXIgaGlkcyA9IF8ucGx1Y2sobWVzc2FnZVtcIm91dHB1dHNcIl0sIFwiaGlkXCIpO1xuICAgICAgICB2YXIgaXQgPSB0aGlzLmNvbGxlY3Rpb24uZ2V0KGluZGV4KTtcbiAgICAgICAgaXQuc2V0KHsgcGVyY2VudGFnZTogMTAwLCBzdGF0dXM6IFwic3VjY2Vzc1wiLCBoaWRzOiBoaWRzIH0pO1xuICAgICAgICB0aGlzLnVpX2J1dHRvbi5tb2RlbC5zZXQoXCJwZXJjZW50YWdlXCIsIHRoaXMuX3VwbG9hZFBlcmNlbnRhZ2UoMTAwLCBpdC5nZXQoXCJmaWxlX3NpemVcIikpKTtcbiAgICAgICAgdGhpcy51cGxvYWRfY29tcGxldGVkICs9IGl0LmdldChcImZpbGVfc2l6ZVwiKSAqIDEwMDtcbiAgICAgICAgdGhpcy5jb3VudGVyLmFubm91bmNlLS07XG4gICAgICAgIHRoaXMuY291bnRlci5zdWNjZXNzKys7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVNjcmVlbigpO1xuICAgICAgICBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5yZWZyZXNoQ29udGVudHMoKTtcbiAgICB9LFxuXG4gICAgLyoqIEVycm9yICovXG4gICAgX2V2ZW50RXJyb3I6IGZ1bmN0aW9uKGluZGV4LCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBpdCA9IHRoaXMuY29sbGVjdGlvbi5nZXQoaW5kZXgpO1xuICAgICAgICBpdC5zZXQoeyBwZXJjZW50YWdlOiAxMDAsIHN0YXR1czogXCJlcnJvclwiLCBpbmZvOiBtZXNzYWdlIH0pO1xuICAgICAgICB0aGlzLnVpX2J1dHRvbi5tb2RlbC5zZXQoe1xuICAgICAgICAgICAgcGVyY2VudGFnZTogdGhpcy5fdXBsb2FkUGVyY2VudGFnZSgxMDAsIGl0LmdldChcImZpbGVfc2l6ZVwiKSksXG4gICAgICAgICAgICBzdGF0dXM6IFwiZGFuZ2VyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudXBsb2FkX2NvbXBsZXRlZCArPSBpdC5nZXQoXCJmaWxlX3NpemVcIikgKiAxMDA7XG4gICAgICAgIHRoaXMuY291bnRlci5hbm5vdW5jZS0tO1xuICAgICAgICB0aGlzLmNvdW50ZXIuZXJyb3IrKztcbiAgICAgICAgdGhpcy5fdXBkYXRlU2NyZWVuKCk7XG4gICAgfSxcblxuICAgIC8qKiBRdWV1ZSBpcyBkb25lICovXG4gICAgX2V2ZW50Q29tcGxldGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICBtb2RlbC5nZXQoXCJzdGF0dXNcIikgPT0gXCJxdWV1ZWRcIiAmJiBtb2RlbC5zZXQoXCJzdGF0dXNcIiwgXCJpbml0XCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jb3VudGVyLnJ1bm5pbmcgPSAwO1xuICAgICAgICB0aGlzLl91cGRhdGVTY3JlZW4oKTtcbiAgICB9LFxuXG4gICAgX2V2ZW50QnVpbGQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYWxsSGlkcyA9IFtdO1xuICAgICAgICBfLmZvckVhY2godGhpcy5jb2xsZWN0aW9uLm1vZGVscywgdXBsb2FkID0+IHtcbiAgICAgICAgICAgIGFsbEhpZHMucHVzaC5hcHBseShhbGxIaWRzLCB1cGxvYWQuZ2V0KFwiaGlkc1wiKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbW9kZWxzID0gXy5tYXAoYWxsSGlkcywgaGlkID0+IEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLmNvbGxlY3Rpb24uZ2V0QnlIaWQoaGlkKSk7XG4gICAgICAgIHZhciBzZWxlY3Rpb24gPSBuZXcgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwuY29sbGVjdGlvbi5jb25zdHJ1Y3Rvcihtb2RlbHMpO1xuICAgICAgICAvLyBJJ20gYnVpbGRpbmcgdGhlIHNlbGVjdGlvbiB3cm9uZyBiZWNhdXNlIEkgbmVlZCB0byBzZXQgdGhpcyBoaXN0b3J5SWQgZGlyZWN0bHkuXG4gICAgICAgIHNlbGVjdGlvbi5oaXN0b3J5SWQgPSBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5jb2xsZWN0aW9uLmhpc3RvcnlJZDtcbiAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwuYnVpbGRDb2xsZWN0aW9uKHRoaXMuY29sbGVjdGlvblR5cGUsIHNlbGVjdGlvbiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuY291bnRlci5ydW5uaW5nID0gMDtcbiAgICAgICAgdGhpcy5fdXBkYXRlU2NyZWVuKCk7XG4gICAgICAgIHRoaXMuX2V2ZW50UmVzZXQoKTtcbiAgICAgICAgdGhpcy5hcHAubW9kYWwuaGlkZSgpO1xuICAgIH0sXG5cbiAgICAvKiogUmVtb3ZlIG1vZGVsIGZyb20gdXBsb2FkIGxpc3QgKi9cbiAgICBfZXZlbnRSZW1vdmU6IGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgIHZhciBzdGF0dXMgPSBtb2RlbC5nZXQoXCJzdGF0dXNcIik7XG4gICAgICAgIGlmIChzdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY291bnRlci5zdWNjZXNzLS07XG4gICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09IFwiZXJyb3JcIikge1xuICAgICAgICAgICAgdGhpcy5jb3VudGVyLmVycm9yLS07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXIuYW5ub3VuY2UtLTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwbG9hZGJveC5yZW1vdmUobW9kZWwuaWQpO1xuICAgICAgICB0aGlzLl91cGRhdGVTY3JlZW4oKTtcbiAgICB9LFxuXG4gICAgLy9cbiAgICAvLyBldmVudHMgdHJpZ2dlcmVkIGJ5IHRoaXMgdmlld1xuICAgIC8vXG5cbiAgICAvKiogU2hvdy9oaWRlIGZ0cCBwb3B1cCAqL1xuICAgIF9ldmVudEZ0cDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5mdHAudmlzaWJsZSkge1xuICAgICAgICAgICAgdGhpcy5mdHAuZW1wdHkoKTtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuZnRwLmFwcGVuZChcbiAgICAgICAgICAgICAgICBuZXcgVXBsb2FkRnRwKHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbjogdGhpcy5jb2xsZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBmdHBfdXBsb2FkX3NpdGU6IHRoaXMuZnRwX3VwbG9hZF9zaXRlLFxuICAgICAgICAgICAgICAgICAgICBvbmFkZDogZnVuY3Rpb24oZnRwX2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnVwbG9hZGJveC5hZGQoW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogXCJmdHBcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZnRwX2ZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogZnRwX2ZpbGUuc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogZnRwX2ZpbGUucGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvbnJlbW92ZTogZnVuY3Rpb24obW9kZWxfaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29sbGVjdGlvbi5yZW1vdmUobW9kZWxfaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuJGVsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5mdHAuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mdHAuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBDcmVhdGUgYSBuZXcgZmlsZSAqL1xuICAgIF9ldmVudENyZWF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudXBsb2FkYm94LmFkZChbeyBuYW1lOiBcIk5ldyBGaWxlXCIsIHNpemU6IDAsIG1vZGU6IFwibmV3XCIgfV0pO1xuICAgIH0sXG5cbiAgICAvKiogU3RhcnQgdXBsb2FkIHByb2Nlc3MgKi9cbiAgICBfZXZlbnRTdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmNvdW50ZXIuYW5ub3VuY2UgPT0gMCB8fCB0aGlzLmNvdW50ZXIucnVubmluZyA+IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMudXBsb2FkX3NpemUgPSAwO1xuICAgICAgICB0aGlzLnVwbG9hZF9jb21wbGV0ZWQgPSAwO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICBpZiAobW9kZWwuZ2V0KFwic3RhdHVzXCIpID09IFwiaW5pdFwiKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwuc2V0KFwic3RhdHVzXCIsIFwicXVldWVkXCIpO1xuICAgICAgICAgICAgICAgIHNlbGYudXBsb2FkX3NpemUgKz0gbW9kZWwuZ2V0KFwiZmlsZV9zaXplXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy51aV9idXR0b24ubW9kZWwuc2V0KHsgcGVyY2VudGFnZTogMCwgc3RhdHVzOiBcInN1Y2Nlc3NcIiB9KTtcbiAgICAgICAgdGhpcy5jb3VudGVyLnJ1bm5pbmcgPSB0aGlzLmNvdW50ZXIuYW5ub3VuY2U7XG4gICAgICAgIHRoaXMuaGlzdG9yeV9pZCA9IHRoaXMuYXBwLmN1cnJlbnRIaXN0b3J5KCk7XG4gICAgICAgIHRoaXMudXBsb2FkYm94LnN0YXJ0KCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVNjcmVlbigpO1xuICAgIH0sXG5cbiAgICAvKiogUGF1c2UgdXBsb2FkIHByb2Nlc3MgKi9cbiAgICBfZXZlbnRTdG9wOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuY291bnRlci5ydW5uaW5nID4gMCkge1xuICAgICAgICAgICAgdGhpcy51aV9idXR0b24ubW9kZWwuc2V0KFwic3RhdHVzXCIsIFwiaW5mb1wiKTtcbiAgICAgICAgICAgICQoXCIudXBsb2FkLXRvcC1pbmZvXCIpLmh0bWwoXCJRdWV1ZSB3aWxsIHBhdXNlIGFmdGVyIGNvbXBsZXRpbmcgdGhlIGN1cnJlbnQgZmlsZS4uLlwiKTtcbiAgICAgICAgICAgIHRoaXMudXBsb2FkYm94LnN0b3AoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogUmVtb3ZlIGFsbCAqL1xuICAgIF9ldmVudFJlc2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuY291bnRlci5ydW5uaW5nID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbi5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5jb3VudGVyLnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLnVwbG9hZGJveC5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RfZXh0ZW5zaW9uLnZhbHVlKHRoaXMub3B0aW9ucy5kZWZhdWx0X2V4dGVuc2lvbik7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdF9nZW5vbWUudmFsdWUodGhpcy5vcHRpb25zLmRlZmF1bHRfZ2Vub21lKTtcbiAgICAgICAgICAgIHRoaXMudWlfYnV0dG9uLm1vZGVsLnNldChcInBlcmNlbnRhZ2VcIiwgMCk7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTY3JlZW4oKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogVXBkYXRlIGV4dGVuc2lvbiBmb3IgYWxsIG1vZGVscyAqL1xuICAgIHVwZGF0ZUV4dGVuc2lvbjogZnVuY3Rpb24oZXh0ZW5zaW9uLCBkZWZhdWx0c19vbmx5KSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVhY2gobW9kZWwgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIG1vZGVsLmdldChcInN0YXR1c1wiKSA9PSBcImluaXRcIiAmJlxuICAgICAgICAgICAgICAgIChtb2RlbC5nZXQoXCJleHRlbnNpb25cIikgPT0gc2VsZi5vcHRpb25zLmRlZmF1bHRfZXh0ZW5zaW9uIHx8ICFkZWZhdWx0c19vbmx5KVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwuc2V0KFwiZXh0ZW5zaW9uXCIsIGV4dGVuc2lvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogVXBkYXRlIGNvbGxlY3Rpb24gdHlwZSAqL1xuICAgIHVwZGF0ZUNvbGxlY3Rpb25UeXBlOiBmdW5jdGlvbihjb2xsZWN0aW9uVHlwZSkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvblR5cGUgPSBjb2xsZWN0aW9uVHlwZTtcbiAgICB9LFxuXG4gICAgLyoqIFVwZGF0ZSBnZW5vbWUgZm9yIGFsbCBtb2RlbHMgKi9cbiAgICB1cGRhdGVHZW5vbWU6IGZ1bmN0aW9uKGdlbm9tZSwgZGVmYXVsdHNfb25seSkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5lYWNoKG1vZGVsID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBtb2RlbC5nZXQoXCJzdGF0dXNcIikgPT0gXCJpbml0XCIgJiZcbiAgICAgICAgICAgICAgICAobW9kZWwuZ2V0KFwiZ2Vub21lXCIpID09IHNlbGYub3B0aW9ucy5kZWZhdWx0X2dlbm9tZSB8fCAhZGVmYXVsdHNfb25seSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIG1vZGVsLnNldChcImdlbm9tZVwiLCBnZW5vbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFNldCBzY3JlZW4gKi9cbiAgICBfdXBkYXRlU2NyZWVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICBpZiAodGhpcy5jb3VudGVyLmFubm91bmNlID09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnVwbG9hZGJveC5jb21wYXRpYmxlKCkpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCImbmJzcDtcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9XG4gICAgICAgICAgICAgICAgICAgIFwiQnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IERyYWcgJiBEcm9wLiBUcnkgRmlyZWZveCA0KywgQ2hyb21lIDcrLCBJRSAxMCssIE9wZXJhIDEyKyBvciBTYWZhcmkgNisuXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCkge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBgWW91IGFkZGVkICR7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY291bnRlci5hbm5vdW5jZVxuICAgICAgICAgICAgICAgIH0gZmlsZShzKSB0byB0aGUgcXVldWUuIEFkZCBtb3JlIGZpbGVzIG9yIGNsaWNrICdTdGFydCcgdG8gcHJvY2VlZC5gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gYFBsZWFzZSB3YWl0Li4uJHt0aGlzLmNvdW50ZXIuYW5ub3VuY2V9IG91dCBvZiAke3RoaXMuY291bnRlci5ydW5uaW5nfSByZW1haW5pbmcuYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLiQoXCIudXBsb2FkLXRvcC1pbmZvXCIpLmh0bWwobWVzc2FnZSk7XG4gICAgICAgIHZhciBlbmFibGVfcmVzZXQgPVxuICAgICAgICAgICAgdGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCAmJiB0aGlzLmNvdW50ZXIuYW5ub3VuY2UgKyB0aGlzLmNvdW50ZXIuc3VjY2VzcyArIHRoaXMuY291bnRlci5lcnJvciA+IDA7XG4gICAgICAgIHZhciBlbmFibGVfc3RhcnQgPSB0aGlzLmNvdW50ZXIucnVubmluZyA9PSAwICYmIHRoaXMuY291bnRlci5hbm5vdW5jZSA+IDA7XG4gICAgICAgIHZhciBlbmFibGVfYnVpbGQgPVxuICAgICAgICAgICAgdGhpcy5jb3VudGVyLnJ1bm5pbmcgPT0gMCAmJlxuICAgICAgICAgICAgdGhpcy5jb3VudGVyLmFubm91bmNlID09IDAgJiZcbiAgICAgICAgICAgIHRoaXMuY291bnRlci5zdWNjZXNzID4gMCAmJlxuICAgICAgICAgICAgdGhpcy5jb3VudGVyLmVycm9yID09IDA7XG4gICAgICAgIHZhciBlbmFibGVfc291cmNlcyA9IHRoaXMuY291bnRlci5ydW5uaW5nID09IDA7XG4gICAgICAgIHZhciBzaG93X3RhYmxlID0gdGhpcy5jb3VudGVyLmFubm91bmNlICsgdGhpcy5jb3VudGVyLnN1Y2Nlc3MgKyB0aGlzLmNvdW50ZXIuZXJyb3IgPiAwO1xuICAgICAgICB0aGlzLmJ0blJlc2V0W2VuYWJsZV9yZXNldCA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgdGhpcy5idG5TdGFydFtlbmFibGVfc3RhcnQgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuU3RhcnQuJGVsW2VuYWJsZV9zdGFydCA/IFwiYWRkQ2xhc3NcIiA6IFwicmVtb3ZlQ2xhc3NcIl0oXCJidG4tcHJpbWFyeVwiKTtcbiAgICAgICAgdGhpcy5idG5CdWlsZFtlbmFibGVfYnVpbGQgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuQnVpbGQuJGVsW2VuYWJsZV9idWlsZCA/IFwiYWRkQ2xhc3NcIiA6IFwicmVtb3ZlQ2xhc3NcIl0oXCJidG4tcHJpbWFyeVwiKTtcbiAgICAgICAgdGhpcy5idG5TdG9wW3RoaXMuY291bnRlci5ydW5uaW5nID4gMCA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgdGhpcy5idG5Mb2NhbFtlbmFibGVfc291cmNlcyA/IFwiZW5hYmxlXCIgOiBcImRpc2FibGVcIl0oKTtcbiAgICAgICAgdGhpcy5idG5GdHBbZW5hYmxlX3NvdXJjZXMgPyBcImVuYWJsZVwiIDogXCJkaXNhYmxlXCJdKCk7XG4gICAgICAgIHRoaXMuYnRuQ3JlYXRlW2VuYWJsZV9zb3VyY2VzID8gXCJlbmFibGVcIiA6IFwiZGlzYWJsZVwiXSgpO1xuICAgICAgICB0aGlzLmJ0bkZ0cC4kZWxbdGhpcy5mdHBfdXBsb2FkX3NpdGUgPyBcInNob3dcIiA6IFwiaGlkZVwiXSgpO1xuICAgICAgICB0aGlzLiQoXCIudXBsb2FkLXRhYmxlXCIpW3Nob3dfdGFibGUgPyBcInNob3dcIiA6IFwiaGlkZVwiXSgpO1xuICAgICAgICB0aGlzLiQoXCIudXBsb2FkLWhlbHBlclwiKVtzaG93X3RhYmxlID8gXCJoaWRlXCIgOiBcInNob3dcIl0oKTtcbiAgICB9LFxuXG4gICAgLyoqIENhbGN1bGF0ZSBwZXJjZW50YWdlIG9mIGFsbCBxdWV1ZWQgdXBsb2FkcyAqL1xuICAgIF91cGxvYWRQZXJjZW50YWdlOiBmdW5jdGlvbihwZXJjZW50YWdlLCBzaXplKSB7XG4gICAgICAgIHJldHVybiAodGhpcy51cGxvYWRfY29tcGxldGVkICsgcGVyY2VudGFnZSAqIHNpemUpIC8gdGhpcy51cGxvYWRfc2l6ZTtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlICovXG4gICAgX3RlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLXZpZXctZGVmYXVsdFwiPicgK1xuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJ1cGxvYWQtdG9wXCI+JyArXG4gICAgICAgICAgICAnPGg2IGNsYXNzPVwidXBsb2FkLXRvcC1pbmZvXCIvPicgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInVwbG9hZC1ib3hcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWhlbHBlclwiPjxpIGNsYXNzPVwiZmEgZmEtZmlsZXMtb1wiLz5Ecm9wIGZpbGVzIGhlcmU8L2Rpdj4nICtcbiAgICAgICAgICAgICc8dGFibGUgY2xhc3M9XCJ1cGxvYWQtdGFibGUgdWktdGFibGUtc3RyaXBlZFwiIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj4nICtcbiAgICAgICAgICAgIFwiPHRoZWFkPlwiICtcbiAgICAgICAgICAgIFwiPHRyPlwiICtcbiAgICAgICAgICAgIFwiPHRoPk5hbWU8L3RoPlwiICtcbiAgICAgICAgICAgIFwiPHRoPlNpemU8L3RoPlwiICtcbiAgICAgICAgICAgIFwiPHRoPlN0YXR1czwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGgvPlwiICtcbiAgICAgICAgICAgIFwiPC90cj5cIiArXG4gICAgICAgICAgICBcIjwvdGhlYWQ+XCIgK1xuICAgICAgICAgICAgXCI8dGJvZHkvPlwiICtcbiAgICAgICAgICAgIFwiPC90YWJsZT5cIiArXG4gICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWZvb3RlclwiPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci10aXRsZS1jb21wcmVzc2VkXCI+Q29sbGVjdGlvbiBUeXBlOjwvc3Bhbj4nICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItY29sbGVjdGlvbi10eXBlXCIvPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci10aXRsZS1jb21wcmVzc2VkXCI+RmlsZSBUeXBlOjwvc3Bhbj4nICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItZXh0ZW5zaW9uXCIvPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci1leHRlbnNpb24taW5mbyB1cGxvYWQtaWNvbi1idXR0b24gZmEgZmEtc2VhcmNoXCIvPiAnICtcbiAgICAgICAgICAgICc8c3BhbiBjbGFzcz1cInVwbG9hZC1mb290ZXItdGl0bGUtY29tcHJlc3NlZFwiPkdlbm9tZSAoc2V0IGFsbCk6PC9zcGFuPicgK1xuICAgICAgICAgICAgJzxzcGFuIGNsYXNzPVwidXBsb2FkLWZvb3Rlci1nZW5vbWVcIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXBsb2FkLWJ1dHRvbnNcIi8+JyArXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VwbG9hZC9jb2xsZWN0aW9uL2NvbGxlY3Rpb24tdmlldy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBWEE7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBWUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBekJBO0FBQ0E7QUEyQkE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNBO0FBYUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUErQkE7QUF4ZUE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///260\n");

/***/ }),
/* 261 */
/*!****************************************************************!*\
  !*** ./galaxy/scripts/mvc/upload/collection/collection-row.js ***!
  \****************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uploadModel = __webpack_require__(/*! mvc/upload/upload-model */ 49);\n\nvar _uploadModel2 = _interopRequireDefault(_uploadModel);\n\nvar _uploadSettings = __webpack_require__(/*! mvc/upload/upload-settings */ 92);\n\nvar _uploadSettings2 = _interopRequireDefault(_uploadSettings);\n\nvar _uiPopover = __webpack_require__(/*! mvc/ui/ui-popover */ 28);\n\nvar _uiPopover2 = _interopRequireDefault(_uiPopover);\n\nvar _uiSelect = __webpack_require__(/*! mvc/ui/ui-select */ 12);\n\nvar _uiSelect2 = _interopRequireDefault(_uiSelect);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = Backbone.View.extend({\n    /** Dictionary of upload states and associated icons */\n    status_classes: {\n        init: \"upload-icon-button fa fa-trash-o\",\n        queued: \"upload-icon fa fa-spinner fa-spin\",\n        running: \"upload-icon fa fa-spinner fa-spin\",\n        success: \"upload-icon-button fa fa-check\",\n        error: \"upload-icon-button fa fa-exclamation-triangle\"\n    },\n\n    initialize: function initialize(app, options) {\n        var self = this;\n        this.app = app;\n        this.model = options.model;\n        this.setElement(this._template(options.model));\n        this.$mode = this.$(\".upload-mode\");\n        this.$title = this.$(\".upload-title-extended\");\n        this.$text = this.$(\".upload-text\");\n        this.$size = this.$(\".upload-size\");\n        this.$info_text = this.$(\".upload-info-text\");\n        this.$info_progress = this.$(\".upload-info-progress\");\n        this.$text_content = this.$(\".upload-text-content\");\n        this.$symbol = this.$(\".upload-symbol\");\n        this.$progress_bar = this.$(\".upload-progress-bar\");\n        this.$percentage = this.$(\".upload-percentage\");\n\n        // append popup to settings icon\n        this.settings = new _uiPopover2.default.View({\n            title: (0, _localization2.default)(\"Upload configuration\"),\n            container: this.$(\".upload-settings\"),\n            placement: \"bottom\"\n        });\n\n        // identify default genome and extension values\n        var default_genome = this.app.select_genome.value();\n        var default_extension = this.app.select_extension.value();\n\n        // handle click event\n        this.$symbol.on(\"click\", function () {\n            self._removeRow();\n        });\n\n        // handle text editing event\n        this.$text_content.on(\"change input\", function (e) {\n            self.model.set({\n                url_paste: $(e.target).val(),\n                file_size: $(e.target).val().length\n            });\n        });\n\n        // model events\n        this.listenTo(this.model, \"change:percentage\", function () {\n            self._refreshPercentage();\n        });\n        this.listenTo(this.model, \"change:status\", function () {\n            self._refreshStatus();\n        });\n        this.listenTo(this.model, \"change:info\", function () {\n            self._refreshInfo();\n        });\n        this.listenTo(this.model, \"change:file_size\", function () {\n            self._refreshFileSize();\n        });\n        this.listenTo(this.model, \"remove\", function () {\n            self.remove();\n        });\n        this.app.collection.on(\"reset\", function () {\n            self.remove();\n        });\n    },\n\n    render: function render() {\n        var options = this.model.attributes;\n        this.$title.html(_.escape(options.file_name));\n        this.$size.html(_utils2.default.bytesToString(options.file_size));\n        this.$mode.removeClass().addClass(\"upload-mode\").addClass(\"text-primary\");\n        if (options.file_mode == \"new\") {\n            this.$text.css({\n                width: this.$el.width() - 16 + \"px\",\n                top: this.$el.height() - 8 + \"px\"\n            }).show();\n            this.$el.height(this.$el.height() - 8 + this.$text.height() + 16);\n            this.$mode.addClass(\"fa fa-edit\");\n        } else if (options.file_mode == \"local\") {\n            this.$mode.addClass(\"fa fa-laptop\");\n        } else if (options.file_mode == \"ftp\") {\n            this.$mode.addClass(\"fa fa-folder-open-o\");\n        }\n    },\n\n    /** Refresh info text */\n    _refreshInfo: function _refreshInfo() {\n        var info = this.model.get(\"info\");\n        if (info) {\n            this.$info_text.html(\"<strong>Failed: </strong>\" + info).show();\n        } else {\n            this.$info_text.hide();\n        }\n    },\n\n    /** Refresh percentage status */\n    _refreshPercentage: function _refreshPercentage() {\n        var percentage = parseInt(this.model.get(\"percentage\"));\n        this.$progress_bar.css({ width: percentage + \"%\" });\n        this.$percentage.html(percentage != 100 ? percentage + \"%\" : \"Adding to history...\");\n    },\n\n    /** Refresh status */\n    _refreshStatus: function _refreshStatus() {\n        var status = this.model.get(\"status\");\n        this.$symbol.removeClass().addClass(\"upload-symbol\").addClass(this.status_classes[status]);\n        this.model.set(\"enabled\", status == \"init\");\n        var enabled = this.model.get(\"enabled\");\n        this.$text_content.attr(\"disabled\", !enabled);\n        if (status == \"success\") {\n            this.$el.addClass(\"success\");\n            this.$percentage.html(\"100%\");\n        }\n        if (status == \"error\") {\n            this.$el.addClass(\"danger\");\n            this.$info_progress.hide();\n        }\n    },\n\n    /** Refresh file size */\n    _refreshFileSize: function _refreshFileSize() {\n        this.$size.html(_utils2.default.bytesToString(this.model.get(\"file_size\")));\n    },\n\n    /** Remove row */\n    _removeRow: function _removeRow() {\n        if ([\"init\", \"success\", \"error\"].indexOf(this.model.get(\"status\")) !== -1) {\n            this.app.collection.remove(this.model);\n        }\n    },\n\n    /** Attach file info popup */\n    _showSettings: function _showSettings() {\n        if (!this.settings.visible) {\n            this.settings.empty();\n            this.settings.append(new _uploadSettings2.default(this).$el);\n            this.settings.show();\n        } else {\n            this.settings.hide();\n        }\n    },\n\n    /** View template */\n    _template: function _template(options) {\n        return \"<tr id=\\\"upload-row-\" + options.id + \"\\\" class=\\\"upload-row\\\"><td><div class=\\\"upload-text-column\\\"><div class=\\\"upload-mode\\\"/><div class=\\\"upload-title-extended\\\"/><div class=\\\"upload-text\\\"><div class=\\\"upload-text-info\\\">You can tell Galaxy to download data from web by entering URL in this box (one per line). You can also directly paste the contents of a file.</div><textarea class=\\\"upload-text-content form-control\\\"/></div></div></td><td><div class=\\\"upload-size\\\"/></td><td><div class=\\\"upload-info\\\"><div class=\\\"upload-info-text\\\"/><div class=\\\"upload-info-progress progress\\\"><div class=\\\"upload-progress-bar progress-bar progress-bar-success\\\"/><div class=\\\"upload-percentage\\\">0%</div></div></div></td><td><div class=\\\"upload-symbol \" + this.status_classes.init + \"\\\"/></td></tr>\";\n    }\n});\n/** Renders the collection uploader rows */\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91cGxvYWQvY29sbGVjdGlvbi9jb2xsZWN0aW9uLXJvdy5qcz8wNTFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG4vKiogUmVuZGVycyB0aGUgY29sbGVjdGlvbiB1cGxvYWRlciByb3dzICovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5pbXBvcnQgVXBsb2FkTW9kZWwgZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLW1vZGVsXCI7XG5pbXBvcnQgVXBsb2FkU2V0dGluZ3MgZnJvbSBcIm12Yy91cGxvYWQvdXBsb2FkLXNldHRpbmdzXCI7XG5pbXBvcnQgUG9wb3ZlciBmcm9tIFwibXZjL3VpL3VpLXBvcG92ZXJcIjtcbmltcG9ydCBTZWxlY3QgZnJvbSBcIm12Yy91aS91aS1zZWxlY3RcIjtcbmV4cG9ydCBkZWZhdWx0IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICAvKiogRGljdGlvbmFyeSBvZiB1cGxvYWQgc3RhdGVzIGFuZCBhc3NvY2lhdGVkIGljb25zICovXG4gICAgc3RhdHVzX2NsYXNzZXM6IHtcbiAgICAgICAgaW5pdDogXCJ1cGxvYWQtaWNvbi1idXR0b24gZmEgZmEtdHJhc2gtb1wiLFxuICAgICAgICBxdWV1ZWQ6IFwidXBsb2FkLWljb24gZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIsXG4gICAgICAgIHJ1bm5pbmc6IFwidXBsb2FkLWljb24gZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIsXG4gICAgICAgIHN1Y2Nlc3M6IFwidXBsb2FkLWljb24tYnV0dG9uIGZhIGZhLWNoZWNrXCIsXG4gICAgICAgIGVycm9yOiBcInVwbG9hZC1pY29uLWJ1dHRvbiBmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiXG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGFwcCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLm1vZGVsID0gb3B0aW9ucy5tb2RlbDtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMuX3RlbXBsYXRlKG9wdGlvbnMubW9kZWwpKTtcbiAgICAgICAgdGhpcy4kbW9kZSA9IHRoaXMuJChcIi51cGxvYWQtbW9kZVwiKTtcbiAgICAgICAgdGhpcy4kdGl0bGUgPSB0aGlzLiQoXCIudXBsb2FkLXRpdGxlLWV4dGVuZGVkXCIpO1xuICAgICAgICB0aGlzLiR0ZXh0ID0gdGhpcy4kKFwiLnVwbG9hZC10ZXh0XCIpO1xuICAgICAgICB0aGlzLiRzaXplID0gdGhpcy4kKFwiLnVwbG9hZC1zaXplXCIpO1xuICAgICAgICB0aGlzLiRpbmZvX3RleHQgPSB0aGlzLiQoXCIudXBsb2FkLWluZm8tdGV4dFwiKTtcbiAgICAgICAgdGhpcy4kaW5mb19wcm9ncmVzcyA9IHRoaXMuJChcIi51cGxvYWQtaW5mby1wcm9ncmVzc1wiKTtcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50ID0gdGhpcy4kKFwiLnVwbG9hZC10ZXh0LWNvbnRlbnRcIik7XG4gICAgICAgIHRoaXMuJHN5bWJvbCA9IHRoaXMuJChcIi51cGxvYWQtc3ltYm9sXCIpO1xuICAgICAgICB0aGlzLiRwcm9ncmVzc19iYXIgPSB0aGlzLiQoXCIudXBsb2FkLXByb2dyZXNzLWJhclwiKTtcbiAgICAgICAgdGhpcy4kcGVyY2VudGFnZSA9IHRoaXMuJChcIi51cGxvYWQtcGVyY2VudGFnZVwiKTtcblxuICAgICAgICAvLyBhcHBlbmQgcG9wdXAgdG8gc2V0dGluZ3MgaWNvblxuICAgICAgICB0aGlzLnNldHRpbmdzID0gbmV3IFBvcG92ZXIuVmlldyh7XG4gICAgICAgICAgICB0aXRsZTogX2woXCJVcGxvYWQgY29uZmlndXJhdGlvblwiKSxcbiAgICAgICAgICAgIGNvbnRhaW5lcjogdGhpcy4kKFwiLnVwbG9hZC1zZXR0aW5nc1wiKSxcbiAgICAgICAgICAgIHBsYWNlbWVudDogXCJib3R0b21cIlxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpZGVudGlmeSBkZWZhdWx0IGdlbm9tZSBhbmQgZXh0ZW5zaW9uIHZhbHVlc1xuICAgICAgICB2YXIgZGVmYXVsdF9nZW5vbWUgPSB0aGlzLmFwcC5zZWxlY3RfZ2Vub21lLnZhbHVlKCk7XG4gICAgICAgIHZhciBkZWZhdWx0X2V4dGVuc2lvbiA9IHRoaXMuYXBwLnNlbGVjdF9leHRlbnNpb24udmFsdWUoKTtcblxuICAgICAgICAvLyBoYW5kbGUgY2xpY2sgZXZlbnRcbiAgICAgICAgdGhpcy4kc3ltYm9sLm9uKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5fcmVtb3ZlUm93KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSB0ZXh0IGVkaXRpbmcgZXZlbnRcbiAgICAgICAgdGhpcy4kdGV4dF9jb250ZW50Lm9uKFwiY2hhbmdlIGlucHV0XCIsIGUgPT4ge1xuICAgICAgICAgICAgc2VsZi5tb2RlbC5zZXQoe1xuICAgICAgICAgICAgICAgIHVybF9wYXN0ZTogJChlLnRhcmdldCkudmFsKCksXG4gICAgICAgICAgICAgICAgZmlsZV9zaXplOiAkKGUudGFyZ2V0KS52YWwoKS5sZW5ndGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBtb2RlbCBldmVudHNcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpwZXJjZW50YWdlXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hQZXJjZW50YWdlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOnN0YXR1c1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLl9yZWZyZXNoU3RhdHVzKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOmluZm9cIiwgKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5fcmVmcmVzaEluZm8oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2U6ZmlsZV9zaXplXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlZnJlc2hGaWxlU2l6ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInJlbW92ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLnJlbW92ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hcHAuY29sbGVjdGlvbi5vbihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMubW9kZWwuYXR0cmlidXRlcztcbiAgICAgICAgdGhpcy4kdGl0bGUuaHRtbChfLmVzY2FwZShvcHRpb25zLmZpbGVfbmFtZSkpO1xuICAgICAgICB0aGlzLiRzaXplLmh0bWwoVXRpbHMuYnl0ZXNUb1N0cmluZyhvcHRpb25zLmZpbGVfc2l6ZSkpO1xuICAgICAgICB0aGlzLiRtb2RlXG4gICAgICAgICAgICAucmVtb3ZlQ2xhc3MoKVxuICAgICAgICAgICAgLmFkZENsYXNzKFwidXBsb2FkLW1vZGVcIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcInRleHQtcHJpbWFyeVwiKTtcbiAgICAgICAgaWYgKG9wdGlvbnMuZmlsZV9tb2RlID09IFwibmV3XCIpIHtcbiAgICAgICAgICAgIHRoaXMuJHRleHRcbiAgICAgICAgICAgICAgICAuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGAke3RoaXMuJGVsLndpZHRoKCkgLSAxNn1weGAsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogYCR7dGhpcy4kZWwuaGVpZ2h0KCkgLSA4fXB4YFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuJGVsLmhlaWdodCh0aGlzLiRlbC5oZWlnaHQoKSAtIDggKyB0aGlzLiR0ZXh0LmhlaWdodCgpICsgMTYpO1xuICAgICAgICAgICAgdGhpcy4kbW9kZS5hZGRDbGFzcyhcImZhIGZhLWVkaXRcIik7XG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5maWxlX21vZGUgPT0gXCJsb2NhbFwiKSB7XG4gICAgICAgICAgICB0aGlzLiRtb2RlLmFkZENsYXNzKFwiZmEgZmEtbGFwdG9wXCIpO1xuICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZmlsZV9tb2RlID09IFwiZnRwXCIpIHtcbiAgICAgICAgICAgIHRoaXMuJG1vZGUuYWRkQ2xhc3MoXCJmYSBmYS1mb2xkZXItb3Blbi1vXCIpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIGluZm8gdGV4dCAqL1xuICAgIF9yZWZyZXNoSW5mbzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGhpcy5tb2RlbC5nZXQoXCJpbmZvXCIpO1xuICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgdGhpcy4kaW5mb190ZXh0Lmh0bWwoYDxzdHJvbmc+RmFpbGVkOiA8L3N0cm9uZz4ke2luZm99YCkuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kaW5mb190ZXh0LmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogUmVmcmVzaCBwZXJjZW50YWdlIHN0YXR1cyAqL1xuICAgIF9yZWZyZXNoUGVyY2VudGFnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwZXJjZW50YWdlID0gcGFyc2VJbnQodGhpcy5tb2RlbC5nZXQoXCJwZXJjZW50YWdlXCIpKTtcbiAgICAgICAgdGhpcy4kcHJvZ3Jlc3NfYmFyLmNzcyh7IHdpZHRoOiBgJHtwZXJjZW50YWdlfSVgIH0pO1xuICAgICAgICB0aGlzLiRwZXJjZW50YWdlLmh0bWwocGVyY2VudGFnZSAhPSAxMDAgPyBgJHtwZXJjZW50YWdlfSVgIDogXCJBZGRpbmcgdG8gaGlzdG9yeS4uLlwiKTtcbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggc3RhdHVzICovXG4gICAgX3JlZnJlc2hTdGF0dXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc3RhdHVzID0gdGhpcy5tb2RlbC5nZXQoXCJzdGF0dXNcIik7XG4gICAgICAgIHRoaXMuJHN5bWJvbFxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKClcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcInVwbG9hZC1zeW1ib2xcIilcbiAgICAgICAgICAgIC5hZGRDbGFzcyh0aGlzLnN0YXR1c19jbGFzc2VzW3N0YXR1c10pO1xuICAgICAgICB0aGlzLm1vZGVsLnNldChcImVuYWJsZWRcIiwgc3RhdHVzID09IFwiaW5pdFwiKTtcbiAgICAgICAgdmFyIGVuYWJsZWQgPSB0aGlzLm1vZGVsLmdldChcImVuYWJsZWRcIik7XG4gICAgICAgIHRoaXMuJHRleHRfY29udGVudC5hdHRyKFwiZGlzYWJsZWRcIiwgIWVuYWJsZWQpO1xuICAgICAgICBpZiAoc3RhdHVzID09IFwic3VjY2Vzc1wiKSB7XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhcInN1Y2Nlc3NcIik7XG4gICAgICAgICAgICB0aGlzLiRwZXJjZW50YWdlLmh0bWwoXCIxMDAlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0dXMgPT0gXCJlcnJvclwiKSB7XG4gICAgICAgICAgICB0aGlzLiRlbC5hZGRDbGFzcyhcImRhbmdlclwiKTtcbiAgICAgICAgICAgIHRoaXMuJGluZm9fcHJvZ3Jlc3MuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZWZyZXNoIGZpbGUgc2l6ZSAqL1xuICAgIF9yZWZyZXNoRmlsZVNpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRzaXplLmh0bWwoVXRpbHMuYnl0ZXNUb1N0cmluZyh0aGlzLm1vZGVsLmdldChcImZpbGVfc2l6ZVwiKSkpO1xuICAgIH0sXG5cbiAgICAvKiogUmVtb3ZlIHJvdyAqL1xuICAgIF9yZW1vdmVSb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoW1wiaW5pdFwiLCBcInN1Y2Nlc3NcIiwgXCJlcnJvclwiXS5pbmRleE9mKHRoaXMubW9kZWwuZ2V0KFwic3RhdHVzXCIpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLmNvbGxlY3Rpb24ucmVtb3ZlKHRoaXMubW9kZWwpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBBdHRhY2ggZmlsZSBpbmZvIHBvcHVwICovXG4gICAgX3Nob3dTZXR0aW5nczogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy52aXNpYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmVtcHR5KCk7XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmFwcGVuZChuZXcgVXBsb2FkU2V0dGluZ3ModGhpcykuJGVsKTtcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Muc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFZpZXcgdGVtcGxhdGUgKi9cbiAgICBfdGVtcGxhdGU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGA8dHIgaWQ9XCJ1cGxvYWQtcm93LSR7XG4gICAgICAgICAgICBvcHRpb25zLmlkXG4gICAgICAgIH1cIiBjbGFzcz1cInVwbG9hZC1yb3dcIj48dGQ+PGRpdiBjbGFzcz1cInVwbG9hZC10ZXh0LWNvbHVtblwiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtbW9kZVwiLz48ZGl2IGNsYXNzPVwidXBsb2FkLXRpdGxlLWV4dGVuZGVkXCIvPjxkaXYgY2xhc3M9XCJ1cGxvYWQtdGV4dFwiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtdGV4dC1pbmZvXCI+WW91IGNhbiB0ZWxsIEdhbGF4eSB0byBkb3dubG9hZCBkYXRhIGZyb20gd2ViIGJ5IGVudGVyaW5nIFVSTCBpbiB0aGlzIGJveCAob25lIHBlciBsaW5lKS4gWW91IGNhbiBhbHNvIGRpcmVjdGx5IHBhc3RlIHRoZSBjb250ZW50cyBvZiBhIGZpbGUuPC9kaXY+PHRleHRhcmVhIGNsYXNzPVwidXBsb2FkLXRleHQtY29udGVudCBmb3JtLWNvbnRyb2xcIi8+PC9kaXY+PC9kaXY+PC90ZD48dGQ+PGRpdiBjbGFzcz1cInVwbG9hZC1zaXplXCIvPjwvdGQ+PHRkPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mb1wiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mby10ZXh0XCIvPjxkaXYgY2xhc3M9XCJ1cGxvYWQtaW5mby1wcm9ncmVzcyBwcm9ncmVzc1wiPjxkaXYgY2xhc3M9XCJ1cGxvYWQtcHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItc3VjY2Vzc1wiLz48ZGl2IGNsYXNzPVwidXBsb2FkLXBlcmNlbnRhZ2VcIj4wJTwvZGl2PjwvZGl2PjwvZGl2PjwvdGQ+PHRkPjxkaXYgY2xhc3M9XCJ1cGxvYWQtc3ltYm9sICR7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c19jbGFzc2VzLmluaXRcbiAgICAgICAgfVwiLz48L3RkPjwvdHI+YDtcbiAgICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvdXBsb2FkL2NvbGxlY3Rpb24vY29sbGVjdGlvbi1yb3cuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFsS0E7QUFOQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///261\n");

/***/ }),
/* 262 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/apps/panels/history-panel.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _optionsMenu = __webpack_require__(/*! mvc/history/options-menu */ 263);\n\nvar _optionsMenu2 = _interopRequireDefault(_optionsMenu);\n\nvar _historyViewEditCurrent = __webpack_require__(/*! mvc/history/history-view-edit-current */ 264);\n\nvar _historyViewEditCurrent2 = _interopRequireDefault(_historyViewEditCurrent);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** the right hand panel in the analysis page that shows the current history */\nvar HistoryPanel = Backbone.View.extend({\n    initialize: function initialize(page, options) {\n        var self = this;\n        this.userIsAnonymous = Galaxy.user.isAnonymous();\n        this.allow_user_dataset_purge = options.config.allow_user_dataset_purge;\n        this.root = options.root;\n\n        // view of the current history\n        this.historyView = new _historyViewEditCurrent2.default.CurrentHistoryView({\n            className: _historyViewEditCurrent2.default.CurrentHistoryView.prototype.className + \" middle\",\n            purgeAllowed: this.allow_user_dataset_purge,\n            linkTarget: \"galaxy_main\"\n        });\n\n        // add history panel to Galaxy object\n        Galaxy.currHistoryPanel = this.historyView;\n        Galaxy.currHistoryPanel.listenToGalaxy(Galaxy);\n\n        // build buttons\n        this.buttonRefresh = new _uiMisc2.default.ButtonLink({\n            id: \"history-refresh-button\",\n            title: (0, _localization2.default)(\"Refresh history\"),\n            cls: \"panel-header-button\",\n            icon: \"fa fa-refresh\",\n            onclick: function onclick() {\n                self.historyView.loadCurrentHistory();\n            }\n        });\n        this.buttonOptions = new _uiMisc2.default.ButtonLink({\n            id: \"history-options-button\",\n            title: (0, _localization2.default)(\"History options\"),\n            cls: \"panel-header-button\",\n            target: \"galaxy_main\",\n            icon: \"fa fa-cog\",\n            href: this.root + \"root/history_options\"\n        });\n        this.buttonViewMulti = new _uiMisc2.default.ButtonLink({\n            id: \"history-view-multi-button\",\n            title: (0, _localization2.default)(\"View all histories\"),\n            cls: \"panel-header-button\",\n            icon: \"fa fa-columns\",\n            href: this.root + \"history/view_multiple\"\n        });\n\n        // define components\n        this.model = new Backbone.Model({\n            cls: \"history-right-panel\",\n            title: (0, _localization2.default)(\"History\"),\n            buttons: [this.buttonRefresh, this.buttonOptions, this.buttonViewMulti]\n        });\n\n        // build body template and connect history view\n        this.setElement(this._template());\n        this.historyView.setElement(this.$el);\n        this.historyView.connectToQuotaMeter(Galaxy.quotaMeter);\n        this.historyView.loadCurrentHistory();\n\n        // fetch to update the quota meter adding 'current' for any anon-user's id\n        Galaxy.listenTo(this.historyView, \"history-size-change\", function () {\n            Galaxy.user.fetch({\n                url: Galaxy.user.urlRoot() + \"/\" + (Galaxy.user.id || \"current\")\n            });\n        });\n    },\n\n    render: function render() {\n        this.optionsMenu = (0, _optionsMenu2.default)(this.buttonOptions.$el, {\n            anonymous: this.userIsAnonymous,\n            purgeAllowed: this.allow_user_dataset_purge,\n            root: this.root\n        });\n        this.buttonViewMulti.$el[!this.userIsAnonymous ? \"show\" : \"hide\"]();\n    },\n\n    /** add history view div */\n    _template: function _template(data) {\n        return ['<div id=\"current-history-panel\" class=\"history-panel middle\"/>'].join(\"\");\n    },\n\n    toString: function toString() {\n        return \"historyPanel\";\n    }\n});\n\nexports.default = HistoryPanel;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL2FwcHMvcGFuZWxzL2hpc3RvcnktcGFuZWwuanM/ZDY0ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVWkgZnJvbSBcIm12Yy91aS91aS1taXNjXCI7XG5pbXBvcnQgaGlzdG9yeU9wdGlvbnNNZW51IGZyb20gXCJtdmMvaGlzdG9yeS9vcHRpb25zLW1lbnVcIjtcbmltcG9ydCBDdXJyZW50SGlzdG9yeVZpZXcgZnJvbSBcIm12Yy9oaXN0b3J5L2hpc3Rvcnktdmlldy1lZGl0LWN1cnJlbnRcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8qKiB0aGUgcmlnaHQgaGFuZCBwYW5lbCBpbiB0aGUgYW5hbHlzaXMgcGFnZSB0aGF0IHNob3dzIHRoZSBjdXJyZW50IGhpc3RvcnkgKi9cbnZhciBIaXN0b3J5UGFuZWwgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ocGFnZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMudXNlcklzQW5vbnltb3VzID0gR2FsYXh5LnVzZXIuaXNBbm9ueW1vdXMoKTtcbiAgICAgICAgdGhpcy5hbGxvd191c2VyX2RhdGFzZXRfcHVyZ2UgPSBvcHRpb25zLmNvbmZpZy5hbGxvd191c2VyX2RhdGFzZXRfcHVyZ2U7XG4gICAgICAgIHRoaXMucm9vdCA9IG9wdGlvbnMucm9vdDtcblxuICAgICAgICAvLyB2aWV3IG9mIHRoZSBjdXJyZW50IGhpc3RvcnlcbiAgICAgICAgdGhpcy5oaXN0b3J5VmlldyA9IG5ldyBDdXJyZW50SGlzdG9yeVZpZXcuQ3VycmVudEhpc3RvcnlWaWV3KHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogYCR7Q3VycmVudEhpc3RvcnlWaWV3LkN1cnJlbnRIaXN0b3J5Vmlldy5wcm90b3R5cGUuY2xhc3NOYW1lfSBtaWRkbGVgLFxuICAgICAgICAgICAgcHVyZ2VBbGxvd2VkOiB0aGlzLmFsbG93X3VzZXJfZGF0YXNldF9wdXJnZSxcbiAgICAgICAgICAgIGxpbmtUYXJnZXQ6IFwiZ2FsYXh5X21haW5cIlxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBhZGQgaGlzdG9yeSBwYW5lbCB0byBHYWxheHkgb2JqZWN0XG4gICAgICAgIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsID0gdGhpcy5oaXN0b3J5VmlldztcbiAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubGlzdGVuVG9HYWxheHkoR2FsYXh5KTtcblxuICAgICAgICAvLyBidWlsZCBidXR0b25zXG4gICAgICAgIHRoaXMuYnV0dG9uUmVmcmVzaCA9IG5ldyBVaS5CdXR0b25MaW5rKHtcbiAgICAgICAgICAgIGlkOiBcImhpc3RvcnktcmVmcmVzaC1idXR0b25cIixcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIlJlZnJlc2ggaGlzdG9yeVwiKSxcbiAgICAgICAgICAgIGNsczogXCJwYW5lbC1oZWFkZXItYnV0dG9uXCIsXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLXJlZnJlc2hcIixcbiAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHNlbGYuaGlzdG9yeVZpZXcubG9hZEN1cnJlbnRIaXN0b3J5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJ1dHRvbk9wdGlvbnMgPSBuZXcgVWkuQnV0dG9uTGluayh7XG4gICAgICAgICAgICBpZDogXCJoaXN0b3J5LW9wdGlvbnMtYnV0dG9uXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJIaXN0b3J5IG9wdGlvbnNcIiksXG4gICAgICAgICAgICBjbHM6IFwicGFuZWwtaGVhZGVyLWJ1dHRvblwiLFxuICAgICAgICAgICAgdGFyZ2V0OiBcImdhbGF4eV9tYWluXCIsXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLWNvZ1wiLFxuICAgICAgICAgICAgaHJlZjogYCR7dGhpcy5yb290fXJvb3QvaGlzdG9yeV9vcHRpb25zYFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idXR0b25WaWV3TXVsdGkgPSBuZXcgVWkuQnV0dG9uTGluayh7XG4gICAgICAgICAgICBpZDogXCJoaXN0b3J5LXZpZXctbXVsdGktYnV0dG9uXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJWaWV3IGFsbCBoaXN0b3JpZXNcIiksXG4gICAgICAgICAgICBjbHM6IFwicGFuZWwtaGVhZGVyLWJ1dHRvblwiLFxuICAgICAgICAgICAgaWNvbjogXCJmYSBmYS1jb2x1bW5zXCIsXG4gICAgICAgICAgICBocmVmOiBgJHt0aGlzLnJvb3R9aGlzdG9yeS92aWV3X211bHRpcGxlYFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBkZWZpbmUgY29tcG9uZW50c1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEJhY2tib25lLk1vZGVsKHtcbiAgICAgICAgICAgIGNsczogXCJoaXN0b3J5LXJpZ2h0LXBhbmVsXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJIaXN0b3J5XCIpLFxuICAgICAgICAgICAgYnV0dG9uczogW3RoaXMuYnV0dG9uUmVmcmVzaCwgdGhpcy5idXR0b25PcHRpb25zLCB0aGlzLmJ1dHRvblZpZXdNdWx0aV1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gYnVpbGQgYm9keSB0ZW1wbGF0ZSBhbmQgY29ubmVjdCBoaXN0b3J5IHZpZXdcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KHRoaXMuX3RlbXBsYXRlKCkpO1xuICAgICAgICB0aGlzLmhpc3RvcnlWaWV3LnNldEVsZW1lbnQodGhpcy4kZWwpO1xuICAgICAgICB0aGlzLmhpc3RvcnlWaWV3LmNvbm5lY3RUb1F1b3RhTWV0ZXIoR2FsYXh5LnF1b3RhTWV0ZXIpO1xuICAgICAgICB0aGlzLmhpc3RvcnlWaWV3LmxvYWRDdXJyZW50SGlzdG9yeSgpO1xuXG4gICAgICAgIC8vIGZldGNoIHRvIHVwZGF0ZSB0aGUgcXVvdGEgbWV0ZXIgYWRkaW5nICdjdXJyZW50JyBmb3IgYW55IGFub24tdXNlcidzIGlkXG4gICAgICAgIEdhbGF4eS5saXN0ZW5Ubyh0aGlzLmhpc3RvcnlWaWV3LCBcImhpc3Rvcnktc2l6ZS1jaGFuZ2VcIiwgKCkgPT4ge1xuICAgICAgICAgICAgR2FsYXh5LnVzZXIuZmV0Y2goe1xuICAgICAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnVzZXIudXJsUm9vdCgpfS8ke0dhbGF4eS51c2VyLmlkIHx8IFwiY3VycmVudFwifWBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zTWVudSA9IGhpc3RvcnlPcHRpb25zTWVudSh0aGlzLmJ1dHRvbk9wdGlvbnMuJGVsLCB7XG4gICAgICAgICAgICBhbm9ueW1vdXM6IHRoaXMudXNlcklzQW5vbnltb3VzLFxuICAgICAgICAgICAgcHVyZ2VBbGxvd2VkOiB0aGlzLmFsbG93X3VzZXJfZGF0YXNldF9wdXJnZSxcbiAgICAgICAgICAgIHJvb3Q6IHRoaXMucm9vdFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idXR0b25WaWV3TXVsdGkuJGVsWyF0aGlzLnVzZXJJc0Fub255bW91cyA/IFwic2hvd1wiIDogXCJoaWRlXCJdKCk7XG4gICAgfSxcblxuICAgIC8qKiBhZGQgaGlzdG9yeSB2aWV3IGRpdiAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICByZXR1cm4gWyc8ZGl2IGlkPVwiY3VycmVudC1oaXN0b3J5LXBhbmVsXCIgY2xhc3M9XCJoaXN0b3J5LXBhbmVsIG1pZGRsZVwiLz4nXS5qb2luKFwiXCIpO1xuICAgIH0sXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBcImhpc3RvcnlQYW5lbFwiO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBIaXN0b3J5UGFuZWw7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvYXBwcy9wYW5lbHMvaGlzdG9yeS1wYW5lbC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakZBO0FBQ0E7QUFtRkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///262\n");

/***/ }),
/* 263 */
/*!****************************************************!*\
  !*** ./galaxy/scripts/mvc/history/options-menu.js ***!
  \****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _popupMenu = __webpack_require__(/*! mvc/ui/popup-menu */ 47);\n\nvar _popupMenu2 = _interopRequireDefault(_popupMenu);\n\nvar _copyDialog = __webpack_require__(/*! mvc/history/copy-dialog */ 55);\n\nvar _copyDialog2 = _interopRequireDefault(_copyDialog);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _webhooks = __webpack_require__(/*! mvc/webhooks */ 35);\n\nvar _webhooks2 = _interopRequireDefault(_webhooks);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// ============================================================================\nvar menu = [{\n    html: (0, _localization2.default)(\"History Lists\"),\n    header: true\n}, {\n    html: (0, _localization2.default)(\"Saved Histories\"),\n    href: \"histories/list\",\n    target: \"_top\"\n}, {\n    html: (0, _localization2.default)(\"Histories Shared with Me\"),\n    href: \"histories/list_shared\",\n    target: \"_top\"\n}, {\n    html: (0, _localization2.default)(\"Current History\"),\n    header: true,\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Create New\"),\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel) {\n            Galaxy.currHistoryPanel.createNewHistory();\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Copy History\"),\n    func: function func() {\n        (0, _copyDialog2.default)(Galaxy.currHistoryPanel.model).done(function () {\n            Galaxy.currHistoryPanel.loadCurrentHistory();\n        });\n    }\n}, {\n    html: (0, _localization2.default)(\"Share or Publish\"),\n    href: \"history/sharing\"\n}, {\n    html: (0, _localization2.default)(\"Show Structure\"),\n    href: \"history/display_structured\",\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Extract Workflow\"),\n    href: \"workflow/build_from_current_history\"\n}, {\n    html: (0, _localization2.default)(\"Delete\"),\n    anon: true,\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel && confirm((0, _localization2.default)(\"Really delete the current history?\"))) {\n            Galaxy.currHistoryPanel.model._delete().done(function () {\n                Galaxy.currHistoryPanel.loadCurrentHistory();\n            });\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Delete Permanently\"),\n    purge: true,\n    anon: true,\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel && confirm((0, _localization2.default)(\"Really delete the current history permanently? This cannot be undone.\"))) {\n            Galaxy.currHistoryPanel.model.purge().done(function () {\n                Galaxy.currHistoryPanel.loadCurrentHistory();\n            });\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Dataset Actions\"),\n    header: true,\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Copy Datasets\"),\n    href: \"dataset/copy_datasets\"\n}, {\n    html: (0, _localization2.default)(\"Dataset Security\"),\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel && Galaxy.router) {\n            Galaxy.router.push(\"/histories/permissions?id=\" + Galaxy.currHistoryPanel.model.id);\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Resume Paused Jobs\"),\n    href: \"history/resume_paused_jobs?current=True\",\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Collapse Expanded Datasets\"),\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel) {\n            Galaxy.currHistoryPanel.collapseAll();\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Unhide Hidden Datasets\"),\n    anon: true,\n    func: function func() {\n        // TODO: Deprecate this functionality and replace with group dataset selector and action combination\n        if (Galaxy && Galaxy.currHistoryPanel && confirm((0, _localization2.default)(\"Really unhide all hidden datasets?\"))) {\n            $.post(Galaxy.root + \"history/adjust_hidden\", { user_action: \"unhide\" }, function () {\n                Galaxy.currHistoryPanel.loadCurrentHistory();\n            });\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Delete Hidden Datasets\"),\n    anon: true,\n    func: function func() {\n        // TODO: Deprecate this functionality and replace with group dataset selector and action combination\n        if (Galaxy && Galaxy.currHistoryPanel && confirm((0, _localization2.default)(\"Really delete all hidden datasets?\"))) {\n            $.post(Galaxy.root + \"history/adjust_hidden\", { user_action: \"delete\" }, function () {\n                Galaxy.currHistoryPanel.loadCurrentHistory();\n            });\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Purge Deleted Datasets\"),\n    confirm: (0, _localization2.default)(\"Really delete all deleted datasets permanently? This cannot be undone.\"),\n    href: \"history/purge_deleted_datasets\",\n    purge: true,\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Downloads\"),\n    header: true\n}, {\n    html: (0, _localization2.default)(\"Export Tool Citations\"),\n    anon: true,\n    func: function func() {\n        if (Galaxy && Galaxy.currHistoryPanel && Galaxy.router) {\n            Galaxy.router.push(\"/histories/citations?id=\" + Galaxy.currHistoryPanel.model.id);\n        }\n    }\n}, {\n    html: (0, _localization2.default)(\"Export History to File\"),\n    href: \"history/export_archive?preview=True\",\n    anon: true\n}, {\n    html: (0, _localization2.default)(\"Other Actions\"),\n    header: true\n}, {\n    html: (0, _localization2.default)(\"Import from File\"),\n    href: \"histories/import\",\n    target: \"_top\"\n}];\n\n// Webhooks\n_webhooks2.default.load({\n    type: \"history-menu\",\n    async: false, // (hypothetically) slows down the performance\n    callback: function callback(webhooks) {\n        var webhooks_menu = [];\n\n        webhooks.each(function (model) {\n            var webhook = model.toJSON();\n            if (webhook.activate) {\n                webhooks_menu.push({\n                    html: (0, _localization2.default)(webhook.config.title),\n                    // func: function() {},\n                    anon: true\n                });\n            }\n        });\n\n        if (webhooks_menu.length > 0) {\n            webhooks_menu.unshift({\n                html: (0, _localization2.default)(\"Webhooks\"),\n                header: true\n            });\n            $.merge(menu, webhooks_menu);\n        }\n    }\n});\n\nfunction buildMenu(isAnon, purgeAllowed, urlRoot) {\n    return _.clone(menu).filter(function (menuOption) {\n        if (isAnon && !menuOption.anon) {\n            return false;\n        }\n        if (!purgeAllowed && menuOption.purge) {\n            return false;\n        }\n\n        //TODO:?? hard-coded galaxy_main\n        if (menuOption.href) {\n            menuOption.href = urlRoot + menuOption.href;\n            menuOption.target = menuOption.target || \"galaxy_main\";\n        }\n\n        if (menuOption.confirm) {\n            menuOption.func = function () {\n                if (confirm(menuOption.confirm)) {\n                    galaxy_main.location = menuOption.href;\n                }\n            };\n        }\n        return true;\n    });\n}\n\nvar create = function create($button, options) {\n    options = options || {};\n    var isAnon = options.anonymous === undefined ? true : options.anonymous;\n    var purgeAllowed = options.purgeAllowed || false;\n    var menu = buildMenu(isAnon, purgeAllowed, Galaxy.root);\n    //console.debug( 'menu:', menu );\n    return new _popupMenu2.default($button, menu);\n};\n\n// ============================================================================\nexports.default = create;\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L29wdGlvbnMtbWVudS5qcz9hZWM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQb3B1cE1lbnUgZnJvbSBcIm12Yy91aS9wb3B1cC1tZW51XCI7XG5pbXBvcnQgaGlzdG9yeUNvcHlEaWFsb2cgZnJvbSBcIm12Yy9oaXN0b3J5L2NvcHktZGlhbG9nXCI7XG5pbXBvcnQgQkFTRV9NVkMgZnJvbSBcIm12Yy9iYXNlLW12Y1wiO1xuaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbmltcG9ydCBXZWJob29rcyBmcm9tIFwibXZjL3dlYmhvb2tzXCI7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbnZhciBtZW51ID0gW1xuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJIaXN0b3J5IExpc3RzXCIpLFxuICAgICAgICBoZWFkZXI6IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJTYXZlZCBIaXN0b3JpZXNcIiksXG4gICAgICAgIGhyZWY6IFwiaGlzdG9yaWVzL2xpc3RcIixcbiAgICAgICAgdGFyZ2V0OiBcIl90b3BcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkhpc3RvcmllcyBTaGFyZWQgd2l0aCBNZVwiKSxcbiAgICAgICAgaHJlZjogXCJoaXN0b3JpZXMvbGlzdF9zaGFyZWRcIixcbiAgICAgICAgdGFyZ2V0OiBcIl90b3BcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkN1cnJlbnQgSGlzdG9yeVwiKSxcbiAgICAgICAgaGVhZGVyOiB0cnVlLFxuICAgICAgICBhbm9uOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiQ3JlYXRlIE5ld1wiKSxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoR2FsYXh5ICYmIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsKSB7XG4gICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwuY3JlYXRlTmV3SGlzdG9yeSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiQ29weSBIaXN0b3J5XCIpLFxuICAgICAgICBmdW5jOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGhpc3RvcnlDb3B5RGlhbG9nKEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLm1vZGVsKS5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5sb2FkQ3VycmVudEhpc3RvcnkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiU2hhcmUgb3IgUHVibGlzaFwiKSxcbiAgICAgICAgaHJlZjogXCJoaXN0b3J5L3NoYXJpbmdcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIlNob3cgU3RydWN0dXJlXCIpLFxuICAgICAgICBocmVmOiBcImhpc3RvcnkvZGlzcGxheV9zdHJ1Y3R1cmVkXCIsXG4gICAgICAgIGFub246IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJFeHRyYWN0IFdvcmtmbG93XCIpLFxuICAgICAgICBocmVmOiBcIndvcmtmbG93L2J1aWxkX2Zyb21fY3VycmVudF9oaXN0b3J5XCJcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJEZWxldGVcIiksXG4gICAgICAgIGFub246IHRydWUsXG4gICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKEdhbGF4eSAmJiBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbCAmJiBjb25maXJtKF9sKFwiUmVhbGx5IGRlbGV0ZSB0aGUgY3VycmVudCBoaXN0b3J5P1wiKSkpIHtcbiAgICAgICAgICAgICAgICBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbC5tb2RlbC5fZGVsZXRlKCkuZG9uZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLmxvYWRDdXJyZW50SGlzdG9yeSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiRGVsZXRlIFBlcm1hbmVudGx5XCIpLFxuICAgICAgICBwdXJnZTogdHJ1ZSxcbiAgICAgICAgYW5vbjogdHJ1ZSxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgR2FsYXh5ICYmXG4gICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwgJiZcbiAgICAgICAgICAgICAgICBjb25maXJtKF9sKFwiUmVhbGx5IGRlbGV0ZSB0aGUgY3VycmVudCBoaXN0b3J5IHBlcm1hbmVudGx5PyBUaGlzIGNhbm5vdCBiZSB1bmRvbmUuXCIpKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubW9kZWwucHVyZ2UoKS5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubG9hZEN1cnJlbnRIaXN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkRhdGFzZXQgQWN0aW9uc1wiKSxcbiAgICAgICAgaGVhZGVyOiB0cnVlLFxuICAgICAgICBhbm9uOiB0cnVlXG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiQ29weSBEYXRhc2V0c1wiKSxcbiAgICAgICAgaHJlZjogXCJkYXRhc2V0L2NvcHlfZGF0YXNldHNcIlxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkRhdGFzZXQgU2VjdXJpdHlcIiksXG4gICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKEdhbGF4eSAmJiBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbCAmJiBHYWxheHkucm91dGVyKSB7XG4gICAgICAgICAgICAgICAgR2FsYXh5LnJvdXRlci5wdXNoKGAvaGlzdG9yaWVzL3Blcm1pc3Npb25zP2lkPSR7R2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubW9kZWwuaWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJSZXN1bWUgUGF1c2VkIEpvYnNcIiksXG4gICAgICAgIGhyZWY6IFwiaGlzdG9yeS9yZXN1bWVfcGF1c2VkX2pvYnM/Y3VycmVudD1UcnVlXCIsXG4gICAgICAgIGFub246IHRydWVcbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJDb2xsYXBzZSBFeHBhbmRlZCBEYXRhc2V0c1wiKSxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoR2FsYXh5ICYmIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsKSB7XG4gICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwuY29sbGFwc2VBbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIlVuaGlkZSBIaWRkZW4gRGF0YXNldHNcIiksXG4gICAgICAgIGFub246IHRydWUsXG4gICAgICAgIGZ1bmM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gVE9ETzogRGVwcmVjYXRlIHRoaXMgZnVuY3Rpb25hbGl0eSBhbmQgcmVwbGFjZSB3aXRoIGdyb3VwIGRhdGFzZXQgc2VsZWN0b3IgYW5kIGFjdGlvbiBjb21iaW5hdGlvblxuICAgICAgICAgICAgaWYgKEdhbGF4eSAmJiBHYWxheHkuY3Vyckhpc3RvcnlQYW5lbCAmJiBjb25maXJtKF9sKFwiUmVhbGx5IHVuaGlkZSBhbGwgaGlkZGVuIGRhdGFzZXRzP1wiKSkpIHtcbiAgICAgICAgICAgICAgICAkLnBvc3QoYCR7R2FsYXh5LnJvb3R9aGlzdG9yeS9hZGp1c3RfaGlkZGVuYCwgeyB1c2VyX2FjdGlvbjogXCJ1bmhpZGVcIiB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLmxvYWRDdXJyZW50SGlzdG9yeSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICAgIGh0bWw6IF9sKFwiRGVsZXRlIEhpZGRlbiBEYXRhc2V0c1wiKSxcbiAgICAgICAgYW5vbjogdHJ1ZSxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBEZXByZWNhdGUgdGhpcyBmdW5jdGlvbmFsaXR5IGFuZCByZXBsYWNlIHdpdGggZ3JvdXAgZGF0YXNldCBzZWxlY3RvciBhbmQgYWN0aW9uIGNvbWJpbmF0aW9uXG4gICAgICAgICAgICBpZiAoR2FsYXh5ICYmIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsICYmIGNvbmZpcm0oX2woXCJSZWFsbHkgZGVsZXRlIGFsbCBoaWRkZW4gZGF0YXNldHM/XCIpKSkge1xuICAgICAgICAgICAgICAgICQucG9zdChgJHtHYWxheHkucm9vdH1oaXN0b3J5L2FkanVzdF9oaWRkZW5gLCB7IHVzZXJfYWN0aW9uOiBcImRlbGV0ZVwiIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubG9hZEN1cnJlbnRIaXN0b3J5KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJQdXJnZSBEZWxldGVkIERhdGFzZXRzXCIpLFxuICAgICAgICBjb25maXJtOiBfbChcIlJlYWxseSBkZWxldGUgYWxsIGRlbGV0ZWQgZGF0YXNldHMgcGVybWFuZW50bHk/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS5cIiksXG4gICAgICAgIGhyZWY6IFwiaGlzdG9yeS9wdXJnZV9kZWxldGVkX2RhdGFzZXRzXCIsXG4gICAgICAgIHB1cmdlOiB0cnVlLFxuICAgICAgICBhbm9uOiB0cnVlXG4gICAgfSxcblxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJEb3dubG9hZHNcIiksXG4gICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkV4cG9ydCBUb29sIENpdGF0aW9uc1wiKSxcbiAgICAgICAgYW5vbjogdHJ1ZSxcbiAgICAgICAgZnVuYzogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoR2FsYXh5ICYmIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsICYmIEdhbGF4eS5yb3V0ZXIpIHtcbiAgICAgICAgICAgICAgICBHYWxheHkucm91dGVyLnB1c2goYC9oaXN0b3JpZXMvY2l0YXRpb25zP2lkPSR7R2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubW9kZWwuaWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgaHRtbDogX2woXCJFeHBvcnQgSGlzdG9yeSB0byBGaWxlXCIpLFxuICAgICAgICBocmVmOiBcImhpc3RvcnkvZXhwb3J0X2FyY2hpdmU/cHJldmlldz1UcnVlXCIsXG4gICAgICAgIGFub246IHRydWVcbiAgICB9LFxuXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIk90aGVyIEFjdGlvbnNcIiksXG4gICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgIH0sXG4gICAge1xuICAgICAgICBodG1sOiBfbChcIkltcG9ydCBmcm9tIEZpbGVcIiksXG4gICAgICAgIGhyZWY6IFwiaGlzdG9yaWVzL2ltcG9ydFwiLFxuICAgICAgICB0YXJnZXQ6IFwiX3RvcFwiXG4gICAgfVxuXTtcblxuLy8gV2ViaG9va3NcbldlYmhvb2tzLmxvYWQoe1xuICAgIHR5cGU6IFwiaGlzdG9yeS1tZW51XCIsXG4gICAgYXN5bmM6IGZhbHNlLCAvLyAoaHlwb3RoZXRpY2FsbHkpIHNsb3dzIGRvd24gdGhlIHBlcmZvcm1hbmNlXG4gICAgY2FsbGJhY2s6IGZ1bmN0aW9uKHdlYmhvb2tzKSB7XG4gICAgICAgIHZhciB3ZWJob29rc19tZW51ID0gW107XG5cbiAgICAgICAgd2ViaG9va3MuZWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICB2YXIgd2ViaG9vayA9IG1vZGVsLnRvSlNPTigpO1xuICAgICAgICAgICAgaWYgKHdlYmhvb2suYWN0aXZhdGUpIHtcbiAgICAgICAgICAgICAgICB3ZWJob29rc19tZW51LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBodG1sOiBfbCh3ZWJob29rLmNvbmZpZy50aXRsZSksXG4gICAgICAgICAgICAgICAgICAgIC8vIGZ1bmM6IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICAgICAgICAgIGFub246IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHdlYmhvb2tzX21lbnUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgd2ViaG9va3NfbWVudS51bnNoaWZ0KHtcbiAgICAgICAgICAgICAgICBodG1sOiBfbChcIldlYmhvb2tzXCIpLFxuICAgICAgICAgICAgICAgIGhlYWRlcjogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkLm1lcmdlKG1lbnUsIHdlYmhvb2tzX21lbnUpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmZ1bmN0aW9uIGJ1aWxkTWVudShpc0Fub24sIHB1cmdlQWxsb3dlZCwgdXJsUm9vdCkge1xuICAgIHJldHVybiBfLmNsb25lKG1lbnUpLmZpbHRlcihtZW51T3B0aW9uID0+IHtcbiAgICAgICAgaWYgKGlzQW5vbiAmJiAhbWVudU9wdGlvbi5hbm9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwdXJnZUFsbG93ZWQgJiYgbWVudU9wdGlvbi5wdXJnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9UT0RPOj8/IGhhcmQtY29kZWQgZ2FsYXh5X21haW5cbiAgICAgICAgaWYgKG1lbnVPcHRpb24uaHJlZikge1xuICAgICAgICAgICAgbWVudU9wdGlvbi5ocmVmID0gdXJsUm9vdCArIG1lbnVPcHRpb24uaHJlZjtcbiAgICAgICAgICAgIG1lbnVPcHRpb24udGFyZ2V0ID0gbWVudU9wdGlvbi50YXJnZXQgfHwgXCJnYWxheHlfbWFpblwiO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lbnVPcHRpb24uY29uZmlybSkge1xuICAgICAgICAgICAgbWVudU9wdGlvbi5mdW5jID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjb25maXJtKG1lbnVPcHRpb24uY29uZmlybSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FsYXh5X21haW4ubG9jYXRpb24gPSBtZW51T3B0aW9uLmhyZWY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbn1cblxudmFyIGNyZWF0ZSA9ICgkYnV0dG9uLCBvcHRpb25zKSA9PiB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdmFyIGlzQW5vbiA9IG9wdGlvbnMuYW5vbnltb3VzID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0aW9ucy5hbm9ueW1vdXM7XG4gICAgdmFyIHB1cmdlQWxsb3dlZCA9IG9wdGlvbnMucHVyZ2VBbGxvd2VkIHx8IGZhbHNlO1xuICAgIHZhciBtZW51ID0gYnVpbGRNZW51KGlzQW5vbiwgcHVyZ2VBbGxvd2VkLCBHYWxheHkucm9vdCk7XG4gICAgLy9jb25zb2xlLmRlYnVnKCAnbWVudTonLCBtZW51ICk7XG4gICAgcmV0dXJuIG5ldyBQb3B1cE1lbnUoJGJ1dHRvbiwgbWVudSk7XG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5leHBvcnQgZGVmYXVsdCBjcmVhdGU7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2hpc3Rvcnkvb3B0aW9ucy1tZW51LmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBU0E7QUFDQTtBQUZBO0FBS0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZEE7QUFrQkE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVNBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFVQTtBQUNBO0FBQ0E7QUFIQTtBQU9BO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFDQTtBQUhBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBeEJBO0FBQ0E7QUEwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///263\n");

/***/ }),
/* 264 */
/*!*****************************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-view-edit-current.js ***!
  \*****************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(_, $, jQuery) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _historyModel = __webpack_require__(/*! mvc/history/history-model */ 31);\n\nvar _historyModel2 = _interopRequireDefault(_historyModel);\n\nvar _historyViewEdit = __webpack_require__(/*! mvc/history/history-view-edit */ 72);\n\nvar _historyViewEdit2 = _interopRequireDefault(_historyViewEdit);\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// ============================================================================\n/** session storage for history panel preferences (and to maintain state)\n */\nvar HistoryViewPrefs = _baseMvc2.default.SessionStorageModel.extend(\n/** @lends HistoryViewPrefs.prototype */{\n    defaults: {\n        /** should the tags editor be shown or hidden initially? */\n        tagsEditorShown: false,\n        /** should the annotation editor be shown or hidden initially? */\n        annotationEditorShown: false,\n        ///** what is the currently focused content (dataset or collection) in the current history?\n        // *      (the history panel will highlight and scroll to the focused content view)\n        // */\n        //focusedContentId : null\n        /** Current scroll position */\n        scrollPosition: 0\n    },\n    toString: function toString() {\n        return \"HistoryViewPrefs(\" + JSON.stringify(this.toJSON()) + \")\";\n    }\n});\n\n/** key string to store panel prefs (made accessible on class so you can access sessionStorage directly) */\nHistoryViewPrefs.storageKey = function storageKey() {\n    return \"history-panel\";\n};\n\n/* =============================================================================\nTODO:\n\n============================================================================= */\nvar _super = _historyViewEdit2.default.HistoryViewEdit;\n// used in root/index.mako\n/** @class View/Controller for the user's current history model as used in the history\n *      panel (current right hand panel) of the analysis page.\n *\n *  The only history panel that:\n *      will poll for updates.\n *      displays datasets in reverse hid order.\n */\nvar CurrentHistoryView = _super.extend(\n/** @lends CurrentHistoryView.prototype */{\n    className: _super.prototype.className + \" current-history-panel\",\n\n    /** override to use drilldown (and not foldout) for how collections are displayed */\n    HDCAViewClass: _super.prototype.HDCAViewClass.extend({\n        foldoutStyle: \"drilldown\"\n    }),\n\n    emptyMsg: [(0, _localization2.default)(\"This history is empty\"), \". \", (0, _localization2.default)(\"You can \"), '<a class=\"uploader-link\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"load your own data\"), \"</a>\", (0, _localization2.default)(\" or \"), '<a class=\"get-data-link\" href=\"javascript:void(0)\">', (0, _localization2.default)(\"get data from an external source\"), \"</a>\"].join(\"\"),\n\n    // ......................................................................... SET UP\n    /** Set up the view, set up storage, bind listeners to HistoryContents events */\n    initialize: function initialize(attributes) {\n        attributes = attributes || {};\n\n        // ---- persistent preferences\n        /** maintain state / preferences over page loads */\n        this.preferences = new HistoryViewPrefs(_.extend({\n            id: HistoryViewPrefs.storageKey()\n        }, _.pick(attributes, _.keys(HistoryViewPrefs.prototype.defaults))));\n\n        _super.prototype.initialize.call(this, attributes);\n\n        /** sub-views that will overlay this panel (collections) */\n        this.panelStack = [];\n\n        /** id of currently focused content */\n        this.currentContentId = attributes.currentContentId || null;\n        //NOTE: purposely not sent to localstorage since panel recreation roughly lines up with a reset of this value\n    },\n\n    /** Override to cache the current scroll position with a listener */\n    _setUpListeners: function _setUpListeners() {\n        _super.prototype._setUpListeners.call(this);\n\n        var panel = this;\n        // reset scroll position when there's a new history\n        this.on(\"new-model\", function () {\n            panel.preferences.set(\"scrollPosition\", 0);\n        });\n    },\n\n    // ------------------------------------------------------------------------ loading history/item models\n    // TODO: next three more appropriate moved to the app level\n    /** (re-)loads the user's current history & contents w/ details */\n    loadCurrentHistory: function loadCurrentHistory() {\n        return this.loadHistory(null, {\n            url: Galaxy.root + \"history/current_history_json\"\n        });\n    },\n\n    /** loads a history & contents w/ details and makes them the current history */\n    switchToHistory: function switchToHistory(historyId, attributes) {\n        if (Galaxy.user.isAnonymous()) {\n            this.trigger(\"error\", (0, _localization2.default)(\"You must be logged in to switch histories\"), (0, _localization2.default)(\"Anonymous user\"));\n            return $.when();\n        }\n        return this.loadHistory(historyId, {\n            url: Galaxy.root + \"history/set_as_current?id=\" + historyId\n        });\n    },\n\n    /** creates a new history on the server and sets it as the user's current history */\n    createNewHistory: function createNewHistory(attributes) {\n        if (Galaxy.user.isAnonymous()) {\n            this.trigger(\"error\", (0, _localization2.default)(\"You must be logged in to create histories\"), (0, _localization2.default)(\"Anonymous user\"));\n            return $.when();\n        }\n        return this.loadHistory(null, {\n            url: Galaxy.root + \"history/create_new_current\"\n        });\n    },\n\n    /** release/free/shutdown old models and set up panel for new models */\n    setModel: function setModel(model, attributes, render) {\n        _super.prototype.setModel.call(this, model, attributes, render);\n        if (this.model && this.model.id) {\n            this.log(\"checking for updates\");\n            this.model.checkForUpdates();\n        }\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ history/content event listening\n    /** listening for history events */\n    _setUpModelListeners: function _setUpModelListeners() {\n        _super.prototype._setUpModelListeners.call(this);\n        // re-broadcast any model change events so that listeners don't have to re-bind to each history\n        return this.listenTo(this.model, {\n            \"change:nice_size change:size\": function changeNice_sizeChangeSize() {\n                this.trigger(\"history-size-change\", this, this.model, arguments);\n            },\n            \"change:id\": function changeId() {\n                this.once(\"loading-done\", function () {\n                    this.model.checkForUpdates();\n                });\n            }\n        });\n    },\n\n    /** listening for collection events */\n    _setUpCollectionListeners: function _setUpCollectionListeners() {\n        _super.prototype._setUpCollectionListeners.call(this);\n        // if a hidden item is created (gen. by a workflow), moves thru the updater to the ready state,\n        //  then: remove it from the collection if the panel is set to NOT show hidden datasets\n        this.listenTo(this.collection, \"state:ready\", function (model, newState, oldState) {\n            if (!model.get(\"visible\") && !this.collection.storage.includeHidden()) {\n                this.removeItemView(model);\n            }\n        });\n    },\n\n    // ------------------------------------------------------------------------ panel rendering\n    /** override to add a handler to capture the scroll position when the parent scrolls */\n    _setUpBehaviors: function _setUpBehaviors($where) {\n        $where = $where || this.$el;\n        // console.log( '_setUpBehaviors', this.$scrollContainer( $where ).get(0), this.$list( $where ) );\n        // we need to call this in _setUpBehaviors which is called after render since the $el\n        // may not be attached to $el.parent and $scrollContainer() may not work\n        var panel = this;\n        _super.prototype._setUpBehaviors.call(panel, $where);\n\n        // cache the handler to remove and re-add so we don't pile up the handlers\n        if (!this._debouncedScrollCaptureHandler) {\n            this._debouncedScrollCaptureHandler = _.debounce(function scrollCapture() {\n                // cache the scroll position (only if visible)\n                if (panel.$el.is(\":visible\")) {\n                    panel.preferences.set(\"scrollPosition\", $(this).scrollTop());\n                }\n            }, 40);\n        }\n\n        panel.$scrollContainer($where).off(\"scroll\", this._debouncedScrollCaptureHandler).on(\"scroll\", this._debouncedScrollCaptureHandler);\n        return panel;\n    },\n\n    /** In this override, handle null models and move the search input to the top */\n    _buildNewRender: function _buildNewRender() {\n        if (!this.model) {\n            return $();\n        }\n        var $newRender = _super.prototype._buildNewRender.call(this);\n        $newRender.find(\".search\").prependTo($newRender.find(\"> .controls\"));\n        this._renderQuotaMessage($newRender);\n        return $newRender;\n    },\n\n    /** render the message displayed when a user is over quota and can't run jobs */\n    _renderQuotaMessage: function _renderQuotaMessage($whereTo) {\n        $whereTo = $whereTo || this.$el;\n        return $(this.templates.quotaMsg({}, this)).prependTo($whereTo.find(\".messages\"));\n    },\n\n    /** In this override, get and set current panel preferences when editor is used */\n    _renderTags: function _renderTags($where) {\n        var panel = this;\n        // render tags and show/hide based on preferences\n        _super.prototype._renderTags.call(panel, $where);\n        if (panel.preferences.get(\"tagsEditorShown\")) {\n            panel.tagsEditor.toggle(true);\n        }\n        // store preference when shown or hidden\n        panel.listenTo(panel.tagsEditor, \"hiddenUntilActivated:shown hiddenUntilActivated:hidden\", function (tagsEditor) {\n            panel.preferences.set(\"tagsEditorShown\", tagsEditor.hidden);\n        });\n    },\n\n    /** In this override, get and set current panel preferences when editor is used */\n    _renderAnnotation: function _renderAnnotation($where) {\n        var panel = this;\n        // render annotation and show/hide based on preferences\n        _super.prototype._renderAnnotation.call(panel, $where);\n        if (panel.preferences.get(\"annotationEditorShown\")) {\n            panel.annotationEditor.toggle(true);\n        }\n        // store preference when shown or hidden\n        panel.listenTo(panel.annotationEditor, \"hiddenUntilActivated:shown hiddenUntilActivated:hidden\", function (annotationEditor) {\n            panel.preferences.set(\"annotationEditorShown\", annotationEditor.hidden);\n        });\n    },\n\n    /** Override to scroll to cached position (in prefs) after swapping */\n    _swapNewRender: function _swapNewRender($newRender) {\n        _super.prototype._swapNewRender.call(this, $newRender);\n        var panel = this;\n        _.delay(function () {\n            var pos = panel.preferences.get(\"scrollPosition\");\n            if (pos) {\n                panel.scrollTo(pos, 0);\n            }\n        }, 10);\n        //TODO: is this enough of a delay on larger histories?\n\n        return this;\n    },\n\n    // ------------------------------------------------------------------------ sub-views\n    /** Override to add the current-content highlight class to currentContentId's view */\n    _attachItems: function _attachItems($whereTo) {\n        _super.prototype._attachItems.call(this, $whereTo);\n        var panel = this;\n        if (panel.currentContentId) {\n            panel._setCurrentContentById(panel.currentContentId);\n        }\n        return this;\n    },\n\n    /** Override to remove any drill down panels */\n    addItemView: function addItemView(model, collection, options) {\n        var view = _super.prototype.addItemView.call(this, model, collection, options);\n        if (!view) {\n            return view;\n        }\n        if (this.panelStack.length) {\n            return this._collapseDrilldownPanel();\n        }\n        return view;\n    },\n\n    // ------------------------------------------------------------------------ collection sub-views\n    /** In this override, add/remove expanded/collapsed model ids to/from web storage */\n    _setUpItemViewListeners: function _setUpItemViewListeners(view) {\n        var panel = this;\n        _super.prototype._setUpItemViewListeners.call(panel, view);\n        // use pub-sub to: handle drilldown expansion and collapse\n        return panel.listenTo(view, {\n            \"expanded:drilldown\": function expandedDrilldown(v, drilldown) {\n                this._expandDrilldownPanel(drilldown);\n            },\n            \"collapsed:drilldown\": function collapsedDrilldown(v, drilldown) {\n                this._collapseDrilldownPanel(drilldown);\n            }\n        });\n    },\n\n    /** display 'current content': add a visible highlight and store the id of a content item */\n    setCurrentContent: function setCurrentContent(view) {\n        this.$(\".history-content.current-content\").removeClass(\"current-content\");\n        if (view) {\n            view.$el.addClass(\"current-content\");\n            this.currentContentId = view.model.id;\n        } else {\n            this.currentContentId = null;\n        }\n    },\n\n    /** find the view with the id and then call setCurrentContent on it */\n    _setCurrentContentById: function _setCurrentContentById(id) {\n        var view = this.viewFromModelId(id) || null;\n        this.setCurrentContent(view);\n    },\n\n    /** Handle drill down by hiding this panels list and controls and showing the sub-panel */\n    _expandDrilldownPanel: function _expandDrilldownPanel(drilldown) {\n        this.panelStack.push(drilldown);\n        // hide this panel's controls and list, set the name for back navigation, and attach to the $el\n        this.$controls().add(this.$list()).hide();\n        drilldown.parentName = this.model.get(\"name\");\n        drilldown.delegateEvents().render().$el.appendTo(this.$el);\n    },\n\n    /** Handle drilldown close by freeing the panel and re-rendering this panel */\n    _collapseDrilldownPanel: function _collapseDrilldownPanel(drilldown) {\n        this.panelStack.pop();\n        //TODO: MEM: free the panel\n        this.$controls().add(this.$list()).show();\n    },\n\n    // ........................................................................ panel events\n    /** event map */\n    events: _.extend(_.clone(_super.prototype.events), {\n        // the two links in the empty message\n        \"click .uploader-link\": function clickUploaderLink(ev) {\n            Galaxy.upload.show(ev);\n        },\n        \"click .get-data-link\": function clickGetDataLink(ev) {\n            var $toolMenu = $(\".toolMenuContainer\");\n            $toolMenu.parent().scrollTop(0);\n            $toolMenu.find('span:contains(\"Get Data\")').click();\n        }\n    }),\n\n    // ........................................................................ external objects/MVC\n    listenToGalaxy: function listenToGalaxy(galaxy) {\n        this.listenTo(galaxy, {\n            // when the galaxy_main iframe is loaded with a new page,\n            // compare the url to the following list and if there's a match\n            // pull the id from url and indicate in the history view that\n            // the dataset with that id is the 'current'ly active dataset\n            \"center-frame:load\": function centerFrameLoad(data) {\n                var pathToMatch = data.fullpath;\n                var hdaId = null;\n                var useToURLRegexMap = {\n                    display: /datasets\\/([a-f0-9]+)\\/display/,\n                    edit: /datasets\\/([a-f0-9]+)\\/edit/,\n                    report_error: /dataset\\/errors\\?id=([a-f0-9]+)/,\n                    rerun: /tool_runner\\/rerun\\?id=([a-f0-9]+)/,\n                    show_params: /datasets\\/([a-f0-9]+)\\/show_params/\n                    // no great way to do this here? (leave it in the dataset event handlers above?)\n                    // 'visualization' : 'visualization',\n                };\n                _.find(useToURLRegexMap, function (regex, use) {\n                    // grab the more specific match result (1), save, and use it as the find flag\n                    hdaId = _.result(pathToMatch.match(regex), 1);\n                    return hdaId;\n                });\n                // need to type mangle to go from web route to history contents\n                this._setCurrentContentById(hdaId ? \"dataset-\" + hdaId : null);\n            },\n            // when the center panel is given a new view, clear the current indicator\n            \"center-panel:load\": function centerPanelLoad(view) {\n                this._setCurrentContentById();\n            }\n        });\n    },\n\n    //TODO: remove quota meter from panel and remove this\n    /** add listeners to an external quota meter (mvc/user/user-quotameter.js) */\n    connectToQuotaMeter: function connectToQuotaMeter(quotaMeter) {\n        if (!quotaMeter) {\n            return this;\n        }\n        // show/hide the 'over quota message' in the history when the meter tells it to\n        this.listenTo(quotaMeter, \"quota:over\", this.showQuotaMessage);\n        this.listenTo(quotaMeter, \"quota:under\", this.hideQuotaMessage);\n\n        // having to add this to handle re-render of hview while overquota (the above do not fire)\n        this.on(\"rendered rendered:initial\", function () {\n            if (quotaMeter && quotaMeter.isOverQuota()) {\n                this.showQuotaMessage();\n            }\n        });\n        return this;\n    },\n\n    /** Override to preserve the quota message */\n    clearMessages: function clearMessages(ev) {\n        var $target = !_.isUndefined(ev) ? $(ev.currentTarget) : this.$messages().children('[class$=\"message\"]');\n        $target = $target.not(\".quota-message\");\n        $target.fadeOut(this.fxSpeed, function () {\n            $(this).remove();\n        });\n        return this;\n    },\n\n    /** Show the over quota message (which happens to be in the history panel).\n     */\n    showQuotaMessage: function showQuotaMessage() {\n        var $msg = this.$(\".quota-message\");\n        if ($msg.is(\":hidden\")) {\n            $msg.slideDown(this.fxSpeed);\n        }\n    },\n\n    /** Hide the over quota message (which happens to be in the history panel).\n     */\n    hideQuotaMessage: function hideQuotaMessage() {\n        var $msg = this.$(\".quota-message\");\n        if (!$msg.is(\":hidden\")) {\n            $msg.slideUp(this.fxSpeed);\n        }\n    },\n\n    // ........................................................................ options menu\n    //TODO: remove to batch\n    /** unhide any hidden datasets */\n    unhideHidden: function unhideHidden() {\n        var self = this;\n        if (confirm((0, _localization2.default)(\"Really unhide all hidden datasets?\"))) {\n            // get all hidden, regardless of deleted/purged\n            return self.model.contents._filterAndUpdate({ visible: false, deleted: \"\", purged: \"\" }, { visible: true }).done(function () {\n                // TODO: would be better to render these as they're unhidden instead of all at once\n                if (!self.model.contents.includeHidden) {\n                    self.renderItems();\n                }\n            });\n        }\n        return jQuery.when();\n    },\n\n    /** delete any hidden datasets */\n    deleteHidden: function deleteHidden() {\n        var self = this;\n        if (confirm((0, _localization2.default)(\"Really delete all hidden datasets?\"))) {\n            return self.model.contents._filterAndUpdate(\n            // get all hidden, regardless of deleted/purged\n            { visible: false, deleted: \"\", purged: \"\" },\n            // both delete *and* unhide them\n            { deleted: true, visible: true });\n        }\n        return jQuery.when();\n    },\n\n    /** Return a string rep of the history */\n    toString: function toString() {\n        return \"CurrentHistoryView(\" + (this.model ? this.model.get(\"name\") : \"\") + \")\";\n    }\n});\n\n//------------------------------------------------------------------------------ TEMPLATES\nCurrentHistoryView.prototype.templates = function () {\n    var quotaMsgTemplate = _baseMvc2.default.wrapTemplate(['<div class=\"quota-message errormessage\">', (0, _localization2.default)(\"You are over your disk quota\"), \". \", (0, _localization2.default)(\"Tool execution is on hold until your disk usage drops below your allocated quota\"), \".\", \"</div>\"], \"history\");\n    return _.extend(_.clone(_super.prototype.templates), {\n        quotaMsg: quotaMsgTemplate\n    });\n}();\n\n//==============================================================================\nexports.default = {\n    CurrentHistoryView: CurrentHistoryView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L2hpc3Rvcnktdmlldy1lZGl0LWN1cnJlbnQuanM/Njg2NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSElTVE9SWV9NT0RFTCBmcm9tIFwibXZjL2hpc3RvcnkvaGlzdG9yeS1tb2RlbFwiO1xuaW1wb3J0IEhJU1RPUllfVklFV19FRElUIGZyb20gXCJtdmMvaGlzdG9yeS9oaXN0b3J5LXZpZXctZWRpdFwiO1xuaW1wb3J0IEJBU0VfTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8qKiBzZXNzaW9uIHN0b3JhZ2UgZm9yIGhpc3RvcnkgcGFuZWwgcHJlZmVyZW5jZXMgKGFuZCB0byBtYWludGFpbiBzdGF0ZSlcbiAqL1xudmFyIEhpc3RvcnlWaWV3UHJlZnMgPSBCQVNFX01WQy5TZXNzaW9uU3RvcmFnZU1vZGVsLmV4dGVuZChcbiAgICAvKiogQGxlbmRzIEhpc3RvcnlWaWV3UHJlZnMucHJvdG90eXBlICovIHtcbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIC8qKiBzaG91bGQgdGhlIHRhZ3MgZWRpdG9yIGJlIHNob3duIG9yIGhpZGRlbiBpbml0aWFsbHk/ICovXG4gICAgICAgICAgICB0YWdzRWRpdG9yU2hvd246IGZhbHNlLFxuICAgICAgICAgICAgLyoqIHNob3VsZCB0aGUgYW5ub3RhdGlvbiBlZGl0b3IgYmUgc2hvd24gb3IgaGlkZGVuIGluaXRpYWxseT8gKi9cbiAgICAgICAgICAgIGFubm90YXRpb25FZGl0b3JTaG93bjogZmFsc2UsXG4gICAgICAgICAgICAvLy8qKiB3aGF0IGlzIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjb250ZW50IChkYXRhc2V0IG9yIGNvbGxlY3Rpb24pIGluIHRoZSBjdXJyZW50IGhpc3Rvcnk/XG4gICAgICAgICAgICAvLyAqICAgICAgKHRoZSBoaXN0b3J5IHBhbmVsIHdpbGwgaGlnaGxpZ2h0IGFuZCBzY3JvbGwgdG8gdGhlIGZvY3VzZWQgY29udGVudCB2aWV3KVxuICAgICAgICAgICAgLy8gKi9cbiAgICAgICAgICAgIC8vZm9jdXNlZENvbnRlbnRJZCA6IG51bGxcbiAgICAgICAgICAgIC8qKiBDdXJyZW50IHNjcm9sbCBwb3NpdGlvbiAqL1xuICAgICAgICAgICAgc2Nyb2xsUG9zaXRpb246IDBcbiAgICAgICAgfSxcbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGBIaXN0b3J5Vmlld1ByZWZzKCR7SlNPTi5zdHJpbmdpZnkodGhpcy50b0pTT04oKSl9KWA7XG4gICAgICAgIH1cbiAgICB9XG4pO1xuXG4vKioga2V5IHN0cmluZyB0byBzdG9yZSBwYW5lbCBwcmVmcyAobWFkZSBhY2Nlc3NpYmxlIG9uIGNsYXNzIHNvIHlvdSBjYW4gYWNjZXNzIHNlc3Npb25TdG9yYWdlIGRpcmVjdGx5KSAqL1xuSGlzdG9yeVZpZXdQcmVmcy5zdG9yYWdlS2V5ID0gZnVuY3Rpb24gc3RvcmFnZUtleSgpIHtcbiAgICByZXR1cm4gXCJoaXN0b3J5LXBhbmVsXCI7XG59O1xuXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuVE9ETzpcblxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbnZhciBfc3VwZXIgPSBISVNUT1JZX1ZJRVdfRURJVC5IaXN0b3J5Vmlld0VkaXQ7XG4vLyB1c2VkIGluIHJvb3QvaW5kZXgubWFrb1xuLyoqIEBjbGFzcyBWaWV3L0NvbnRyb2xsZXIgZm9yIHRoZSB1c2VyJ3MgY3VycmVudCBoaXN0b3J5IG1vZGVsIGFzIHVzZWQgaW4gdGhlIGhpc3RvcnlcbiAqICAgICAgcGFuZWwgKGN1cnJlbnQgcmlnaHQgaGFuZCBwYW5lbCkgb2YgdGhlIGFuYWx5c2lzIHBhZ2UuXG4gKlxuICogIFRoZSBvbmx5IGhpc3RvcnkgcGFuZWwgdGhhdDpcbiAqICAgICAgd2lsbCBwb2xsIGZvciB1cGRhdGVzLlxuICogICAgICBkaXNwbGF5cyBkYXRhc2V0cyBpbiByZXZlcnNlIGhpZCBvcmRlci5cbiAqL1xudmFyIEN1cnJlbnRIaXN0b3J5VmlldyA9IF9zdXBlci5leHRlbmQoXG4gICAgLyoqIEBsZW5kcyBDdXJyZW50SGlzdG9yeVZpZXcucHJvdG90eXBlICovIHtcbiAgICAgICAgY2xhc3NOYW1lOiBgJHtfc3VwZXIucHJvdG90eXBlLmNsYXNzTmFtZX0gY3VycmVudC1oaXN0b3J5LXBhbmVsYCxcblxuICAgICAgICAvKiogb3ZlcnJpZGUgdG8gdXNlIGRyaWxsZG93biAoYW5kIG5vdCBmb2xkb3V0KSBmb3IgaG93IGNvbGxlY3Rpb25zIGFyZSBkaXNwbGF5ZWQgKi9cbiAgICAgICAgSERDQVZpZXdDbGFzczogX3N1cGVyLnByb3RvdHlwZS5IRENBVmlld0NsYXNzLmV4dGVuZCh7XG4gICAgICAgICAgICBmb2xkb3V0U3R5bGU6IFwiZHJpbGxkb3duXCJcbiAgICAgICAgfSksXG5cbiAgICAgICAgZW1wdHlNc2c6IFtcbiAgICAgICAgICAgIF9sKFwiVGhpcyBoaXN0b3J5IGlzIGVtcHR5XCIpLFxuICAgICAgICAgICAgXCIuIFwiLFxuICAgICAgICAgICAgX2woXCJZb3UgY2FuIFwiKSxcbiAgICAgICAgICAgICc8YSBjbGFzcz1cInVwbG9hZGVyLWxpbmtcIiBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+JyxcbiAgICAgICAgICAgIF9sKFwibG9hZCB5b3VyIG93biBkYXRhXCIpLFxuICAgICAgICAgICAgXCI8L2E+XCIsXG4gICAgICAgICAgICBfbChcIiBvciBcIiksXG4gICAgICAgICAgICAnPGEgY2xhc3M9XCJnZXQtZGF0YS1saW5rXCIgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiPicsXG4gICAgICAgICAgICBfbChcImdldCBkYXRhIGZyb20gYW4gZXh0ZXJuYWwgc291cmNlXCIpLFxuICAgICAgICAgICAgXCI8L2E+XCJcbiAgICAgICAgXS5qb2luKFwiXCIpLFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gU0VUIFVQXG4gICAgICAgIC8qKiBTZXQgdXAgdGhlIHZpZXcsIHNldCB1cCBzdG9yYWdlLCBiaW5kIGxpc3RlbmVycyB0byBIaXN0b3J5Q29udGVudHMgZXZlbnRzICovXG4gICAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzIHx8IHt9O1xuXG4gICAgICAgICAgICAvLyAtLS0tIHBlcnNpc3RlbnQgcHJlZmVyZW5jZXNcbiAgICAgICAgICAgIC8qKiBtYWludGFpbiBzdGF0ZSAvIHByZWZlcmVuY2VzIG92ZXIgcGFnZSBsb2FkcyAqL1xuICAgICAgICAgICAgdGhpcy5wcmVmZXJlbmNlcyA9IG5ldyBIaXN0b3J5Vmlld1ByZWZzKFxuICAgICAgICAgICAgICAgIF8uZXh0ZW5kKFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogSGlzdG9yeVZpZXdQcmVmcy5zdG9yYWdlS2V5KClcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXy5waWNrKGF0dHJpYnV0ZXMsIF8ua2V5cyhIaXN0b3J5Vmlld1ByZWZzLnByb3RvdHlwZS5kZWZhdWx0cykpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmNhbGwodGhpcywgYXR0cmlidXRlcyk7XG5cbiAgICAgICAgICAgIC8qKiBzdWItdmlld3MgdGhhdCB3aWxsIG92ZXJsYXkgdGhpcyBwYW5lbCAoY29sbGVjdGlvbnMpICovXG4gICAgICAgICAgICB0aGlzLnBhbmVsU3RhY2sgPSBbXTtcblxuICAgICAgICAgICAgLyoqIGlkIG9mIGN1cnJlbnRseSBmb2N1c2VkIGNvbnRlbnQgKi9cbiAgICAgICAgICAgIHRoaXMuY3VycmVudENvbnRlbnRJZCA9IGF0dHJpYnV0ZXMuY3VycmVudENvbnRlbnRJZCB8fCBudWxsO1xuICAgICAgICAgICAgLy9OT1RFOiBwdXJwb3NlbHkgbm90IHNlbnQgdG8gbG9jYWxzdG9yYWdlIHNpbmNlIHBhbmVsIHJlY3JlYXRpb24gcm91Z2hseSBsaW5lcyB1cCB3aXRoIGEgcmVzZXQgb2YgdGhpcyB2YWx1ZVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBPdmVycmlkZSB0byBjYWNoZSB0aGUgY3VycmVudCBzY3JvbGwgcG9zaXRpb24gd2l0aCBhIGxpc3RlbmVyICovXG4gICAgICAgIF9zZXRVcExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcExpc3RlbmVycy5jYWxsKHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgLy8gcmVzZXQgc2Nyb2xsIHBvc2l0aW9uIHdoZW4gdGhlcmUncyBhIG5ldyBoaXN0b3J5XG4gICAgICAgICAgICB0aGlzLm9uKFwibmV3LW1vZGVsXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBwYW5lbC5wcmVmZXJlbmNlcy5zZXQoXCJzY3JvbGxQb3NpdGlvblwiLCAwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBsb2FkaW5nIGhpc3RvcnkvaXRlbSBtb2RlbHNcbiAgICAgICAgLy8gVE9ETzogbmV4dCB0aHJlZSBtb3JlIGFwcHJvcHJpYXRlIG1vdmVkIHRvIHRoZSBhcHAgbGV2ZWxcbiAgICAgICAgLyoqIChyZS0pbG9hZHMgdGhlIHVzZXIncyBjdXJyZW50IGhpc3RvcnkgJiBjb250ZW50cyB3LyBkZXRhaWxzICovXG4gICAgICAgIGxvYWRDdXJyZW50SGlzdG9yeTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkSGlzdG9yeShudWxsLCB7XG4gICAgICAgICAgICAgICAgdXJsOiBgJHtHYWxheHkucm9vdH1oaXN0b3J5L2N1cnJlbnRfaGlzdG9yeV9qc29uYFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGxvYWRzIGEgaGlzdG9yeSAmIGNvbnRlbnRzIHcvIGRldGFpbHMgYW5kIG1ha2VzIHRoZW0gdGhlIGN1cnJlbnQgaGlzdG9yeSAqL1xuICAgICAgICBzd2l0Y2hUb0hpc3Rvcnk6IGZ1bmN0aW9uKGhpc3RvcnlJZCwgYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKEdhbGF4eS51c2VyLmlzQW5vbnltb3VzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJlcnJvclwiLCBfbChcIllvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byBzd2l0Y2ggaGlzdG9yaWVzXCIpLCBfbChcIkFub255bW91cyB1c2VyXCIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gJC53aGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkSGlzdG9yeShoaXN0b3J5SWQsIHtcbiAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWhpc3Rvcnkvc2V0X2FzX2N1cnJlbnQ/aWQ9JHtoaXN0b3J5SWR9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGNyZWF0ZXMgYSBuZXcgaGlzdG9yeSBvbiB0aGUgc2VydmVyIGFuZCBzZXRzIGl0IGFzIHRoZSB1c2VyJ3MgY3VycmVudCBoaXN0b3J5ICovXG4gICAgICAgIGNyZWF0ZU5ld0hpc3Rvcnk6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmIChHYWxheHkudXNlci5pc0Fub255bW91cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwiZXJyb3JcIiwgX2woXCJZb3UgbXVzdCBiZSBsb2dnZWQgaW4gdG8gY3JlYXRlIGhpc3Rvcmllc1wiKSwgX2woXCJBbm9ueW1vdXMgdXNlclwiKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICQud2hlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZEhpc3RvcnkobnVsbCwge1xuICAgICAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3R9aGlzdG9yeS9jcmVhdGVfbmV3X2N1cnJlbnRgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogcmVsZWFzZS9mcmVlL3NodXRkb3duIG9sZCBtb2RlbHMgYW5kIHNldCB1cCBwYW5lbCBmb3IgbmV3IG1vZGVscyAqL1xuICAgICAgICBzZXRNb2RlbDogZnVuY3Rpb24obW9kZWwsIGF0dHJpYnV0ZXMsIHJlbmRlcikge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRNb2RlbC5jYWxsKHRoaXMsIG1vZGVsLCBhdHRyaWJ1dGVzLCByZW5kZXIpO1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwgJiYgdGhpcy5tb2RlbC5pZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9nKFwiY2hlY2tpbmcgZm9yIHVwZGF0ZXNcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5jaGVja0ZvclVwZGF0ZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBoaXN0b3J5L2NvbnRlbnQgZXZlbnQgbGlzdGVuaW5nXG4gICAgICAgIC8qKiBsaXN0ZW5pbmcgZm9yIGhpc3RvcnkgZXZlbnRzICovXG4gICAgICAgIF9zZXRVcE1vZGVsTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3NldFVwTW9kZWxMaXN0ZW5lcnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIC8vIHJlLWJyb2FkY2FzdCBhbnkgbW9kZWwgY2hhbmdlIGV2ZW50cyBzbyB0aGF0IGxpc3RlbmVycyBkb24ndCBoYXZlIHRvIHJlLWJpbmQgdG8gZWFjaCBoaXN0b3J5XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCB7XG4gICAgICAgICAgICAgICAgXCJjaGFuZ2U6bmljZV9zaXplIGNoYW5nZTpzaXplXCI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoXCJoaXN0b3J5LXNpemUtY2hhbmdlXCIsIHRoaXMsIHRoaXMubW9kZWwsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImNoYW5nZTppZFwiOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwibG9hZGluZy1kb25lXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5jaGVja0ZvclVwZGF0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGxpc3RlbmluZyBmb3IgY29sbGVjdGlvbiBldmVudHMgKi9cbiAgICAgICAgX3NldFVwQ29sbGVjdGlvbkxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXRVcENvbGxlY3Rpb25MaXN0ZW5lcnMuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIC8vIGlmIGEgaGlkZGVuIGl0ZW0gaXMgY3JlYXRlZCAoZ2VuLiBieSBhIHdvcmtmbG93KSwgbW92ZXMgdGhydSB0aGUgdXBkYXRlciB0byB0aGUgcmVhZHkgc3RhdGUsXG4gICAgICAgICAgICAvLyAgdGhlbjogcmVtb3ZlIGl0IGZyb20gdGhlIGNvbGxlY3Rpb24gaWYgdGhlIHBhbmVsIGlzIHNldCB0byBOT1Qgc2hvdyBoaWRkZW4gZGF0YXNldHNcbiAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInN0YXRlOnJlYWR5XCIsIGZ1bmN0aW9uKG1vZGVsLCBuZXdTdGF0ZSwgb2xkU3RhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW1vZGVsLmdldChcInZpc2libGVcIikgJiYgIXRoaXMuY29sbGVjdGlvbi5zdG9yYWdlLmluY2x1ZGVIaWRkZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUl0ZW1WaWV3KG1vZGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gcGFuZWwgcmVuZGVyaW5nXG4gICAgICAgIC8qKiBvdmVycmlkZSB0byBhZGQgYSBoYW5kbGVyIHRvIGNhcHR1cmUgdGhlIHNjcm9sbCBwb3NpdGlvbiB3aGVuIHRoZSBwYXJlbnQgc2Nyb2xscyAqL1xuICAgICAgICBfc2V0VXBCZWhhdmlvcnM6IGZ1bmN0aW9uKCR3aGVyZSkge1xuICAgICAgICAgICAgJHdoZXJlID0gJHdoZXJlIHx8IHRoaXMuJGVsO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coICdfc2V0VXBCZWhhdmlvcnMnLCB0aGlzLiRzY3JvbGxDb250YWluZXIoICR3aGVyZSApLmdldCgwKSwgdGhpcy4kbGlzdCggJHdoZXJlICkgKTtcbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gY2FsbCB0aGlzIGluIF9zZXRVcEJlaGF2aW9ycyB3aGljaCBpcyBjYWxsZWQgYWZ0ZXIgcmVuZGVyIHNpbmNlIHRoZSAkZWxcbiAgICAgICAgICAgIC8vIG1heSBub3QgYmUgYXR0YWNoZWQgdG8gJGVsLnBhcmVudCBhbmQgJHNjcm9sbENvbnRhaW5lcigpIG1heSBub3Qgd29ya1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3NldFVwQmVoYXZpb3JzLmNhbGwocGFuZWwsICR3aGVyZSk7XG5cbiAgICAgICAgICAgIC8vIGNhY2hlIHRoZSBoYW5kbGVyIHRvIHJlbW92ZSBhbmQgcmUtYWRkIHNvIHdlIGRvbid0IHBpbGUgdXAgdGhlIGhhbmRsZXJzXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RlYm91bmNlZFNjcm9sbENhcHR1cmVIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVib3VuY2VkU2Nyb2xsQ2FwdHVyZUhhbmRsZXIgPSBfLmRlYm91bmNlKGZ1bmN0aW9uIHNjcm9sbENhcHR1cmUoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNhY2hlIHRoZSBzY3JvbGwgcG9zaXRpb24gKG9ubHkgaWYgdmlzaWJsZSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhbmVsLiRlbC5pcyhcIjp2aXNpYmxlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYW5lbC5wcmVmZXJlbmNlcy5zZXQoXCJzY3JvbGxQb3NpdGlvblwiLCAkKHRoaXMpLnNjcm9sbFRvcCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIDQwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGFuZWxcbiAgICAgICAgICAgICAgICAuJHNjcm9sbENvbnRhaW5lcigkd2hlcmUpXG4gICAgICAgICAgICAgICAgLm9mZihcInNjcm9sbFwiLCB0aGlzLl9kZWJvdW5jZWRTY3JvbGxDYXB0dXJlSGFuZGxlcilcbiAgICAgICAgICAgICAgICAub24oXCJzY3JvbGxcIiwgdGhpcy5fZGVib3VuY2VkU2Nyb2xsQ2FwdHVyZUhhbmRsZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHBhbmVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBoYW5kbGUgbnVsbCBtb2RlbHMgYW5kIG1vdmUgdGhlIHNlYXJjaCBpbnB1dCB0byB0aGUgdG9wICovXG4gICAgICAgIF9idWlsZE5ld1JlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyICRuZXdSZW5kZXIgPSBfc3VwZXIucHJvdG90eXBlLl9idWlsZE5ld1JlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgJG5ld1JlbmRlci5maW5kKFwiLnNlYXJjaFwiKS5wcmVwZW5kVG8oJG5ld1JlbmRlci5maW5kKFwiPiAuY29udHJvbHNcIikpO1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyUXVvdGFNZXNzYWdlKCRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgcmV0dXJuICRuZXdSZW5kZXI7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIHJlbmRlciB0aGUgbWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiBhIHVzZXIgaXMgb3ZlciBxdW90YSBhbmQgY2FuJ3QgcnVuIGpvYnMgKi9cbiAgICAgICAgX3JlbmRlclF1b3RhTWVzc2FnZTogZnVuY3Rpb24oJHdoZXJlVG8pIHtcbiAgICAgICAgICAgICR3aGVyZVRvID0gJHdoZXJlVG8gfHwgdGhpcy4kZWw7XG4gICAgICAgICAgICByZXR1cm4gJCh0aGlzLnRlbXBsYXRlcy5xdW90YU1zZyh7fSwgdGhpcykpLnByZXBlbmRUbygkd2hlcmVUby5maW5kKFwiLm1lc3NhZ2VzXCIpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSW4gdGhpcyBvdmVycmlkZSwgZ2V0IGFuZCBzZXQgY3VycmVudCBwYW5lbCBwcmVmZXJlbmNlcyB3aGVuIGVkaXRvciBpcyB1c2VkICovXG4gICAgICAgIF9yZW5kZXJUYWdzOiBmdW5jdGlvbigkd2hlcmUpIHtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICAvLyByZW5kZXIgdGFncyBhbmQgc2hvdy9oaWRlIGJhc2VkIG9uIHByZWZlcmVuY2VzXG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9yZW5kZXJUYWdzLmNhbGwocGFuZWwsICR3aGVyZSk7XG4gICAgICAgICAgICBpZiAocGFuZWwucHJlZmVyZW5jZXMuZ2V0KFwidGFnc0VkaXRvclNob3duXCIpKSB7XG4gICAgICAgICAgICAgICAgcGFuZWwudGFnc0VkaXRvci50b2dnbGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBzdG9yZSBwcmVmZXJlbmNlIHdoZW4gc2hvd24gb3IgaGlkZGVuXG4gICAgICAgICAgICBwYW5lbC5saXN0ZW5UbyhwYW5lbC50YWdzRWRpdG9yLCBcImhpZGRlblVudGlsQWN0aXZhdGVkOnNob3duIGhpZGRlblVudGlsQWN0aXZhdGVkOmhpZGRlblwiLCB0YWdzRWRpdG9yID0+IHtcbiAgICAgICAgICAgICAgICBwYW5lbC5wcmVmZXJlbmNlcy5zZXQoXCJ0YWdzRWRpdG9yU2hvd25cIiwgdGFnc0VkaXRvci5oaWRkZW4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIEluIHRoaXMgb3ZlcnJpZGUsIGdldCBhbmQgc2V0IGN1cnJlbnQgcGFuZWwgcHJlZmVyZW5jZXMgd2hlbiBlZGl0b3IgaXMgdXNlZCAqL1xuICAgICAgICBfcmVuZGVyQW5ub3RhdGlvbjogZnVuY3Rpb24oJHdoZXJlKSB7XG4gICAgICAgICAgICB2YXIgcGFuZWwgPSB0aGlzO1xuICAgICAgICAgICAgLy8gcmVuZGVyIGFubm90YXRpb24gYW5kIHNob3cvaGlkZSBiYXNlZCBvbiBwcmVmZXJlbmNlc1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcmVuZGVyQW5ub3RhdGlvbi5jYWxsKHBhbmVsLCAkd2hlcmUpO1xuICAgICAgICAgICAgaWYgKHBhbmVsLnByZWZlcmVuY2VzLmdldChcImFubm90YXRpb25FZGl0b3JTaG93blwiKSkge1xuICAgICAgICAgICAgICAgIHBhbmVsLmFubm90YXRpb25FZGl0b3IudG9nZ2xlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gc3RvcmUgcHJlZmVyZW5jZSB3aGVuIHNob3duIG9yIGhpZGRlblxuICAgICAgICAgICAgcGFuZWwubGlzdGVuVG8oXG4gICAgICAgICAgICAgICAgcGFuZWwuYW5ub3RhdGlvbkVkaXRvcixcbiAgICAgICAgICAgICAgICBcImhpZGRlblVudGlsQWN0aXZhdGVkOnNob3duIGhpZGRlblVudGlsQWN0aXZhdGVkOmhpZGRlblwiLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb25FZGl0b3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwYW5lbC5wcmVmZXJlbmNlcy5zZXQoXCJhbm5vdGF0aW9uRWRpdG9yU2hvd25cIiwgYW5ub3RhdGlvbkVkaXRvci5oaWRkZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIHNjcm9sbCB0byBjYWNoZWQgcG9zaXRpb24gKGluIHByZWZzKSBhZnRlciBzd2FwcGluZyAqL1xuICAgICAgICBfc3dhcE5ld1JlbmRlcjogZnVuY3Rpb24oJG5ld1JlbmRlcikge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc3dhcE5ld1JlbmRlci5jYWxsKHRoaXMsICRuZXdSZW5kZXIpO1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIF8uZGVsYXkoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBwb3MgPSBwYW5lbC5wcmVmZXJlbmNlcy5nZXQoXCJzY3JvbGxQb3NpdGlvblwiKTtcbiAgICAgICAgICAgICAgICBpZiAocG9zKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhbmVsLnNjcm9sbFRvKHBvcywgMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTApO1xuICAgICAgICAgICAgLy9UT0RPOiBpcyB0aGlzIGVub3VnaCBvZiBhIGRlbGF5IG9uIGxhcmdlciBoaXN0b3JpZXM/XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzdWItdmlld3NcbiAgICAgICAgLyoqIE92ZXJyaWRlIHRvIGFkZCB0aGUgY3VycmVudC1jb250ZW50IGhpZ2hsaWdodCBjbGFzcyB0byBjdXJyZW50Q29udGVudElkJ3MgdmlldyAqL1xuICAgICAgICBfYXR0YWNoSXRlbXM6IGZ1bmN0aW9uKCR3aGVyZVRvKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hdHRhY2hJdGVtcy5jYWxsKHRoaXMsICR3aGVyZVRvKTtcbiAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXM7XG4gICAgICAgICAgICBpZiAocGFuZWwuY3VycmVudENvbnRlbnRJZCkge1xuICAgICAgICAgICAgICAgIHBhbmVsLl9zZXRDdXJyZW50Q29udGVudEJ5SWQocGFuZWwuY3VycmVudENvbnRlbnRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogT3ZlcnJpZGUgdG8gcmVtb3ZlIGFueSBkcmlsbCBkb3duIHBhbmVscyAqL1xuICAgICAgICBhZGRJdGVtVmlldzogZnVuY3Rpb24obW9kZWwsIGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gX3N1cGVyLnByb3RvdHlwZS5hZGRJdGVtVmlldy5jYWxsKHRoaXMsIG1vZGVsLCBjb2xsZWN0aW9uLCBvcHRpb25zKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucGFuZWxTdGFjay5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29sbGFwc2VEcmlsbGRvd25QYW5lbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGNvbGxlY3Rpb24gc3ViLXZpZXdzXG4gICAgICAgIC8qKiBJbiB0aGlzIG92ZXJyaWRlLCBhZGQvcmVtb3ZlIGV4cGFuZGVkL2NvbGxhcHNlZCBtb2RlbCBpZHMgdG8vZnJvbSB3ZWIgc3RvcmFnZSAqL1xuICAgICAgICBfc2V0VXBJdGVtVmlld0xpc3RlbmVyczogZnVuY3Rpb24odmlldykge1xuICAgICAgICAgICAgdmFyIHBhbmVsID0gdGhpcztcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3NldFVwSXRlbVZpZXdMaXN0ZW5lcnMuY2FsbChwYW5lbCwgdmlldyk7XG4gICAgICAgICAgICAvLyB1c2UgcHViLXN1YiB0bzogaGFuZGxlIGRyaWxsZG93biBleHBhbnNpb24gYW5kIGNvbGxhcHNlXG4gICAgICAgICAgICByZXR1cm4gcGFuZWwubGlzdGVuVG8odmlldywge1xuICAgICAgICAgICAgICAgIFwiZXhwYW5kZWQ6ZHJpbGxkb3duXCI6IGZ1bmN0aW9uKHYsIGRyaWxsZG93bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmREcmlsbGRvd25QYW5lbChkcmlsbGRvd24pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJjb2xsYXBzZWQ6ZHJpbGxkb3duXCI6IGZ1bmN0aW9uKHYsIGRyaWxsZG93bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb2xsYXBzZURyaWxsZG93blBhbmVsKGRyaWxsZG93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIGRpc3BsYXkgJ2N1cnJlbnQgY29udGVudCc6IGFkZCBhIHZpc2libGUgaGlnaGxpZ2h0IGFuZCBzdG9yZSB0aGUgaWQgb2YgYSBjb250ZW50IGl0ZW0gKi9cbiAgICAgICAgc2V0Q3VycmVudENvbnRlbnQ6IGZ1bmN0aW9uKHZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuJChcIi5oaXN0b3J5LWNvbnRlbnQuY3VycmVudC1jb250ZW50XCIpLnJlbW92ZUNsYXNzKFwiY3VycmVudC1jb250ZW50XCIpO1xuICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2aWV3LiRlbC5hZGRDbGFzcyhcImN1cnJlbnQtY29udGVudFwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRDb250ZW50SWQgPSB2aWV3Lm1vZGVsLmlkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRDb250ZW50SWQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBmaW5kIHRoZSB2aWV3IHdpdGggdGhlIGlkIGFuZCB0aGVuIGNhbGwgc2V0Q3VycmVudENvbnRlbnQgb24gaXQgKi9cbiAgICAgICAgX3NldEN1cnJlbnRDb250ZW50QnlJZDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3RnJvbU1vZGVsSWQoaWQpIHx8IG51bGw7XG4gICAgICAgICAgICB0aGlzLnNldEN1cnJlbnRDb250ZW50KHZpZXcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBIYW5kbGUgZHJpbGwgZG93biBieSBoaWRpbmcgdGhpcyBwYW5lbHMgbGlzdCBhbmQgY29udHJvbHMgYW5kIHNob3dpbmcgdGhlIHN1Yi1wYW5lbCAqL1xuICAgICAgICBfZXhwYW5kRHJpbGxkb3duUGFuZWw6IGZ1bmN0aW9uKGRyaWxsZG93bikge1xuICAgICAgICAgICAgdGhpcy5wYW5lbFN0YWNrLnB1c2goZHJpbGxkb3duKTtcbiAgICAgICAgICAgIC8vIGhpZGUgdGhpcyBwYW5lbCdzIGNvbnRyb2xzIGFuZCBsaXN0LCBzZXQgdGhlIG5hbWUgZm9yIGJhY2sgbmF2aWdhdGlvbiwgYW5kIGF0dGFjaCB0byB0aGUgJGVsXG4gICAgICAgICAgICB0aGlzLiRjb250cm9scygpXG4gICAgICAgICAgICAgICAgLmFkZCh0aGlzLiRsaXN0KCkpXG4gICAgICAgICAgICAgICAgLmhpZGUoKTtcbiAgICAgICAgICAgIGRyaWxsZG93bi5wYXJlbnROYW1lID0gdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpO1xuICAgICAgICAgICAgZHJpbGxkb3duXG4gICAgICAgICAgICAgICAgLmRlbGVnYXRlRXZlbnRzKClcbiAgICAgICAgICAgICAgICAucmVuZGVyKClcbiAgICAgICAgICAgICAgICAuJGVsLmFwcGVuZFRvKHRoaXMuJGVsKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogSGFuZGxlIGRyaWxsZG93biBjbG9zZSBieSBmcmVlaW5nIHRoZSBwYW5lbCBhbmQgcmUtcmVuZGVyaW5nIHRoaXMgcGFuZWwgKi9cbiAgICAgICAgX2NvbGxhcHNlRHJpbGxkb3duUGFuZWw6IGZ1bmN0aW9uKGRyaWxsZG93bikge1xuICAgICAgICAgICAgdGhpcy5wYW5lbFN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgLy9UT0RPOiBNRU06IGZyZWUgdGhlIHBhbmVsXG4gICAgICAgICAgICB0aGlzLiRjb250cm9scygpXG4gICAgICAgICAgICAgICAgLmFkZCh0aGlzLiRsaXN0KCkpXG4gICAgICAgICAgICAgICAgLnNob3coKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gcGFuZWwgZXZlbnRzXG4gICAgICAgIC8qKiBldmVudCBtYXAgKi9cbiAgICAgICAgZXZlbnRzOiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUuZXZlbnRzKSwge1xuICAgICAgICAgICAgLy8gdGhlIHR3byBsaW5rcyBpbiB0aGUgZW1wdHkgbWVzc2FnZVxuICAgICAgICAgICAgXCJjbGljayAudXBsb2FkZXItbGlua1wiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIEdhbGF4eS51cGxvYWQuc2hvdyhldik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJjbGljayAuZ2V0LWRhdGEtbGlua1wiOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIHZhciAkdG9vbE1lbnUgPSAkKFwiLnRvb2xNZW51Q29udGFpbmVyXCIpO1xuICAgICAgICAgICAgICAgICR0b29sTWVudS5wYXJlbnQoKS5zY3JvbGxUb3AoMCk7XG4gICAgICAgICAgICAgICAgJHRvb2xNZW51LmZpbmQoJ3NwYW46Y29udGFpbnMoXCJHZXQgRGF0YVwiKScpLmNsaWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBleHRlcm5hbCBvYmplY3RzL01WQ1xuICAgICAgICBsaXN0ZW5Ub0dhbGF4eTogZnVuY3Rpb24oZ2FsYXh5KSB7XG4gICAgICAgICAgICB0aGlzLmxpc3RlblRvKGdhbGF4eSwge1xuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGdhbGF4eV9tYWluIGlmcmFtZSBpcyBsb2FkZWQgd2l0aCBhIG5ldyBwYWdlLFxuICAgICAgICAgICAgICAgIC8vIGNvbXBhcmUgdGhlIHVybCB0byB0aGUgZm9sbG93aW5nIGxpc3QgYW5kIGlmIHRoZXJlJ3MgYSBtYXRjaFxuICAgICAgICAgICAgICAgIC8vIHB1bGwgdGhlIGlkIGZyb20gdXJsIGFuZCBpbmRpY2F0ZSBpbiB0aGUgaGlzdG9yeSB2aWV3IHRoYXRcbiAgICAgICAgICAgICAgICAvLyB0aGUgZGF0YXNldCB3aXRoIHRoYXQgaWQgaXMgdGhlICdjdXJyZW50J2x5IGFjdGl2ZSBkYXRhc2V0XG4gICAgICAgICAgICAgICAgXCJjZW50ZXItZnJhbWU6bG9hZFwiOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9NYXRjaCA9IGRhdGEuZnVsbHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZGFJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VUb1VSTFJlZ2V4TWFwID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogL2RhdGFzZXRzXFwvKFthLWYwLTldKylcXC9kaXNwbGF5LyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQ6IC9kYXRhc2V0c1xcLyhbYS1mMC05XSspXFwvZWRpdC8sXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRfZXJyb3I6IC9kYXRhc2V0XFwvZXJyb3JzXFw/aWQ9KFthLWYwLTldKykvLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVydW46IC90b29sX3J1bm5lclxcL3JlcnVuXFw/aWQ9KFthLWYwLTldKykvLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hvd19wYXJhbXM6IC9kYXRhc2V0c1xcLyhbYS1mMC05XSspXFwvc2hvd19wYXJhbXMvXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBncmVhdCB3YXkgdG8gZG8gdGhpcyBoZXJlPyAobGVhdmUgaXQgaW4gdGhlIGRhdGFzZXQgZXZlbnQgaGFuZGxlcnMgYWJvdmU/KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ3Zpc3VhbGl6YXRpb24nIDogJ3Zpc3VhbGl6YXRpb24nLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBfLmZpbmQodXNlVG9VUkxSZWdleE1hcCwgKHJlZ2V4LCB1c2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdyYWIgdGhlIG1vcmUgc3BlY2lmaWMgbWF0Y2ggcmVzdWx0ICgxKSwgc2F2ZSwgYW5kIHVzZSBpdCBhcyB0aGUgZmluZCBmbGFnXG4gICAgICAgICAgICAgICAgICAgICAgICBoZGFJZCA9IF8ucmVzdWx0KHBhdGhUb01hdGNoLm1hdGNoKHJlZ2V4KSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGRhSWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBuZWVkIHRvIHR5cGUgbWFuZ2xlIHRvIGdvIGZyb20gd2ViIHJvdXRlIHRvIGhpc3RvcnkgY29udGVudHNcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0Q3VycmVudENvbnRlbnRCeUlkKGhkYUlkID8gYGRhdGFzZXQtJHtoZGFJZH1gIDogbnVsbCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyB3aGVuIHRoZSBjZW50ZXIgcGFuZWwgaXMgZ2l2ZW4gYSBuZXcgdmlldywgY2xlYXIgdGhlIGN1cnJlbnQgaW5kaWNhdG9yXG4gICAgICAgICAgICAgICAgXCJjZW50ZXItcGFuZWw6bG9hZFwiOiBmdW5jdGlvbih2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldEN1cnJlbnRDb250ZW50QnlJZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vVE9ETzogcmVtb3ZlIHF1b3RhIG1ldGVyIGZyb20gcGFuZWwgYW5kIHJlbW92ZSB0aGlzXG4gICAgICAgIC8qKiBhZGQgbGlzdGVuZXJzIHRvIGFuIGV4dGVybmFsIHF1b3RhIG1ldGVyIChtdmMvdXNlci91c2VyLXF1b3RhbWV0ZXIuanMpICovXG4gICAgICAgIGNvbm5lY3RUb1F1b3RhTWV0ZXI6IGZ1bmN0aW9uKHF1b3RhTWV0ZXIpIHtcbiAgICAgICAgICAgIGlmICghcXVvdGFNZXRlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gc2hvdy9oaWRlIHRoZSAnb3ZlciBxdW90YSBtZXNzYWdlJyBpbiB0aGUgaGlzdG9yeSB3aGVuIHRoZSBtZXRlciB0ZWxscyBpdCB0b1xuICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhxdW90YU1ldGVyLCBcInF1b3RhOm92ZXJcIiwgdGhpcy5zaG93UXVvdGFNZXNzYWdlKTtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuVG8ocXVvdGFNZXRlciwgXCJxdW90YTp1bmRlclwiLCB0aGlzLmhpZGVRdW90YU1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAvLyBoYXZpbmcgdG8gYWRkIHRoaXMgdG8gaGFuZGxlIHJlLXJlbmRlciBvZiBodmlldyB3aGlsZSBvdmVycXVvdGEgKHRoZSBhYm92ZSBkbyBub3QgZmlyZSlcbiAgICAgICAgICAgIHRoaXMub24oXCJyZW5kZXJlZCByZW5kZXJlZDppbml0aWFsXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChxdW90YU1ldGVyICYmIHF1b3RhTWV0ZXIuaXNPdmVyUXVvdGEoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dRdW90YU1lc3NhZ2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBPdmVycmlkZSB0byBwcmVzZXJ2ZSB0aGUgcXVvdGEgbWVzc2FnZSAqL1xuICAgICAgICBjbGVhck1lc3NhZ2VzOiBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgdmFyICR0YXJnZXQgPSAhXy5pc1VuZGVmaW5lZChldikgPyAkKGV2LmN1cnJlbnRUYXJnZXQpIDogdGhpcy4kbWVzc2FnZXMoKS5jaGlsZHJlbignW2NsYXNzJD1cIm1lc3NhZ2VcIl0nKTtcbiAgICAgICAgICAgICR0YXJnZXQgPSAkdGFyZ2V0Lm5vdChcIi5xdW90YS1tZXNzYWdlXCIpO1xuICAgICAgICAgICAgJHRhcmdldC5mYWRlT3V0KHRoaXMuZnhTcGVlZCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFNob3cgdGhlIG92ZXIgcXVvdGEgbWVzc2FnZSAod2hpY2ggaGFwcGVucyB0byBiZSBpbiB0aGUgaGlzdG9yeSBwYW5lbCkuXG4gICAgICAgICAqL1xuICAgICAgICBzaG93UXVvdGFNZXNzYWdlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciAkbXNnID0gdGhpcy4kKFwiLnF1b3RhLW1lc3NhZ2VcIik7XG4gICAgICAgICAgICBpZiAoJG1zZy5pcyhcIjpoaWRkZW5cIikpIHtcbiAgICAgICAgICAgICAgICAkbXNnLnNsaWRlRG93bih0aGlzLmZ4U3BlZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKiBIaWRlIHRoZSBvdmVyIHF1b3RhIG1lc3NhZ2UgKHdoaWNoIGhhcHBlbnMgdG8gYmUgaW4gdGhlIGhpc3RvcnkgcGFuZWwpLlxuICAgICAgICAgKi9cbiAgICAgICAgaGlkZVF1b3RhTWVzc2FnZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgJG1zZyA9IHRoaXMuJChcIi5xdW90YS1tZXNzYWdlXCIpO1xuICAgICAgICAgICAgaWYgKCEkbXNnLmlzKFwiOmhpZGRlblwiKSkge1xuICAgICAgICAgICAgICAgICRtc2cuc2xpZGVVcCh0aGlzLmZ4U3BlZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBvcHRpb25zIG1lbnVcbiAgICAgICAgLy9UT0RPOiByZW1vdmUgdG8gYmF0Y2hcbiAgICAgICAgLyoqIHVuaGlkZSBhbnkgaGlkZGVuIGRhdGFzZXRzICovXG4gICAgICAgIHVuaGlkZUhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoY29uZmlybShfbChcIlJlYWxseSB1bmhpZGUgYWxsIGhpZGRlbiBkYXRhc2V0cz9cIikpKSB7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBoaWRkZW4sIHJlZ2FyZGxlc3Mgb2YgZGVsZXRlZC9wdXJnZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5tb2RlbC5jb250ZW50c1xuICAgICAgICAgICAgICAgICAgICAuX2ZpbHRlckFuZFVwZGF0ZSh7IHZpc2libGU6IGZhbHNlLCBkZWxldGVkOiBcIlwiLCBwdXJnZWQ6IFwiXCIgfSwgeyB2aXNpYmxlOiB0cnVlIH0pXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IHdvdWxkIGJlIGJldHRlciB0byByZW5kZXIgdGhlc2UgYXMgdGhleSdyZSB1bmhpZGRlbiBpbnN0ZWFkIG9mIGFsbCBhdCBvbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYubW9kZWwuY29udGVudHMuaW5jbHVkZUhpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVuZGVySXRlbXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4galF1ZXJ5LndoZW4oKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKiogZGVsZXRlIGFueSBoaWRkZW4gZGF0YXNldHMgKi9cbiAgICAgICAgZGVsZXRlSGlkZGVuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIGlmIChjb25maXJtKF9sKFwiUmVhbGx5IGRlbGV0ZSBhbGwgaGlkZGVuIGRhdGFzZXRzP1wiKSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5tb2RlbC5jb250ZW50cy5fZmlsdGVyQW5kVXBkYXRlKFxuICAgICAgICAgICAgICAgICAgICAvLyBnZXQgYWxsIGhpZGRlbiwgcmVnYXJkbGVzcyBvZiBkZWxldGVkL3B1cmdlZFxuICAgICAgICAgICAgICAgICAgICB7IHZpc2libGU6IGZhbHNlLCBkZWxldGVkOiBcIlwiLCBwdXJnZWQ6IFwiXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgLy8gYm90aCBkZWxldGUgKmFuZCogdW5oaWRlIHRoZW1cbiAgICAgICAgICAgICAgICAgICAgeyBkZWxldGVkOiB0cnVlLCB2aXNpYmxlOiB0cnVlIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGpRdWVyeS53aGVuKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqIFJldHVybiBhIHN0cmluZyByZXAgb2YgdGhlIGhpc3RvcnkgKi9cbiAgICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGBDdXJyZW50SGlzdG9yeVZpZXcoJHt0aGlzLm1vZGVsID8gdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpIDogXCJcIn0pYDtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFRFTVBMQVRFU1xuQ3VycmVudEhpc3RvcnlWaWV3LnByb3RvdHlwZS50ZW1wbGF0ZXMgPSAoKCkgPT4ge1xuICAgIHZhciBxdW90YU1zZ1RlbXBsYXRlID0gQkFTRV9NVkMud3JhcFRlbXBsYXRlKFxuICAgICAgICBbXG4gICAgICAgICAgICAnPGRpdiBjbGFzcz1cInF1b3RhLW1lc3NhZ2UgZXJyb3JtZXNzYWdlXCI+JyxcbiAgICAgICAgICAgIF9sKFwiWW91IGFyZSBvdmVyIHlvdXIgZGlzayBxdW90YVwiKSxcbiAgICAgICAgICAgIFwiLiBcIixcbiAgICAgICAgICAgIF9sKFwiVG9vbCBleGVjdXRpb24gaXMgb24gaG9sZCB1bnRpbCB5b3VyIGRpc2sgdXNhZ2UgZHJvcHMgYmVsb3cgeW91ciBhbGxvY2F0ZWQgcXVvdGFcIiksXG4gICAgICAgICAgICBcIi5cIixcbiAgICAgICAgICAgIFwiPC9kaXY+XCJcbiAgICAgICAgXSxcbiAgICAgICAgXCJoaXN0b3J5XCJcbiAgICApO1xuICAgIHJldHVybiBfLmV4dGVuZChfLmNsb25lKF9zdXBlci5wcm90b3R5cGUudGVtcGxhdGVzKSwge1xuICAgICAgICBxdW90YU1zZzogcXVvdGFNc2dUZW1wbGF0ZVxuICAgIH0pO1xufSkoKTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBDdXJyZW50SGlzdG9yeVZpZXc6IEN1cnJlbnRIaXN0b3J5Vmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9oaXN0b3J5LXZpZXctZWRpdC1jdXJyZW50LmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQ0E7QUFDQTtBQWZBO0FBQ0E7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQURBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTVCQTtBQThCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTdhQTtBQUNBO0FBZ2JBO0FBQ0E7QUFDQTtBQVdBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///264\n");

/***/ }),
/* 265 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/mvc/user/user-preferences.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _queryStringParsing = __webpack_require__(/*! utils/query-string-parsing */ 27);\n\nvar _queryStringParsing2 = _interopRequireDefault(_queryStringParsing);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Contains descriptive dictionaries describing user forms */\nvar Model = Backbone.Model.extend({\n    initialize: function initialize(options) {\n        options = options || {};\n        options.user_id = options.user_id || Galaxy.user.id;\n        this.set({\n            user_id: options.user_id,\n            information: {\n                title: (0, _localization2.default)(\"Manage information\"),\n                description: \"Edit your email, addresses and custom parameters or change your username.\",\n                url: \"api/users/\" + options.user_id + \"/information/inputs\",\n                icon: \"fa-user\",\n                redirect: \"user\"\n            },\n            password: {\n                title: (0, _localization2.default)(\"Change password\"),\n                description: (0, _localization2.default)(\"Allows you to change your login credentials.\"),\n                icon: \"fa-unlock-alt\",\n                url: \"api/users/\" + options.user_id + \"/password/inputs\",\n                submit_title: \"Save password\",\n                redirect: \"user\"\n            },\n            communication: {\n                title: (0, _localization2.default)(\"Change communication settings\"),\n                description: (0, _localization2.default)(\"Enable or disable the communication feature to chat with other users.\"),\n                url: \"api/users/\" + options.user_id + \"/communication/inputs\",\n                icon: \"fa-comments-o\",\n                redirect: \"user\"\n            },\n            permissions: {\n                title: (0, _localization2.default)(\"Set dataset permissions for new histories\"),\n                description: \"Grant others default access to newly created histories. Changes made here will only affect histories created after these settings have been stored.\",\n                url: \"api/users/\" + options.user_id + \"/permissions/inputs\",\n                icon: \"fa-users\",\n                submit_title: \"Save permissions\",\n                redirect: \"user\"\n            },\n            api_key: {\n                title: (0, _localization2.default)(\"Manage API key\"),\n                description: (0, _localization2.default)(\"Access your current API key or create a new one.\"),\n                url: \"api/users/\" + options.user_id + \"/api_key/inputs\",\n                icon: \"fa-key\",\n                submit_title: \"Create a new key\",\n                submit_icon: \"fa-check\"\n            },\n            toolbox_filters: {\n                title: (0, _localization2.default)(\"Manage Toolbox filters\"),\n                description: (0, _localization2.default)(\"Customize your Toolbox by displaying or omitting sets of Tools.\"),\n                url: \"api/users/\" + options.user_id + \"/toolbox_filters/inputs\",\n                icon: \"fa-filter\",\n                submit_title: \"Save filters\",\n                redirect: \"user\"\n            },\n            openids: {\n                title: (0, _localization2.default)(\"Manage OpenIDs\"),\n                description: (0, _localization2.default)(\"Associate OpenIDs with your account.\"),\n                icon: \"fa-openid\",\n                onclick: function onclick() {\n                    window.location.href = Galaxy.root + \"openids/list\";\n                }\n            },\n            custom_builds: {\n                title: (0, _localization2.default)(\"Manage custom builds\"),\n                description: (0, _localization2.default)(\"Add or remove custom builds using history datasets.\"),\n                icon: \"fa-cubes\",\n                onclick: function onclick() {\n                    window.location.href = Galaxy.root + \"custom_builds\";\n                }\n            },\n            logout: {\n                title: (0, _localization2.default)(\"Sign out\"),\n                description: (0, _localization2.default)(\"Click here to sign out of all sessions.\"),\n                icon: \"fa-sign-out\",\n                onclick: function onclick() {\n                    Galaxy.modal.show({\n                        title: (0, _localization2.default)(\"Sign out\"),\n                        body: \"Do you want to continue and sign out of all active sessions?\",\n                        buttons: {\n                            Cancel: function Cancel() {\n                                Galaxy.modal.hide();\n                            },\n                            \"Sign out\": function SignOut() {\n                                window.location.href = Galaxy.root + \"user/logout?session_csrf_token=\" + Galaxy.session_csrf_token;\n                            }\n                        }\n                    });\n                }\n            }\n        });\n    }\n});\n\n/** View of the main user preference panel with links to individual user forms */\n\n/** User Preferences view */\nvar View = Backbone.View.extend({\n    title: (0, _localization2.default)(\"User Preferences\"),\n    initialize: function initialize() {\n        this.model = new Model();\n        this.setElement(\"<div/>\");\n        this.render();\n    },\n\n    render: function render() {\n        var self = this;\n        var config = Galaxy.config;\n        $.getJSON(Galaxy.root + \"api/users/\" + Galaxy.user.id, function (data) {\n            self.$preferences = $(\"<div/>\").addClass(\"ui-panel\").append($(\"<h2/>\").append(\"User preferences\")).append($(\"<p/>\").append(\"You are logged in as <strong>\" + _.escape(data.email) + \"</strong>.\")).append(self.$table = $(\"<table/>\").addClass(\"ui-panel-table\"));\n            var message = _queryStringParsing2.default.get(\"message\");\n            var status = _queryStringParsing2.default.get(\"status\");\n            if (message && status) {\n                self.$preferences.prepend(new _uiMisc2.default.Message({ message: message, status: status }).$el);\n            }\n            if (!config.use_remote_user) {\n                self._addLink(\"information\");\n                self._addLink(\"password\");\n            }\n            if (config.enable_communication_server) {\n                self._addLink(\"communication\");\n            }\n            self._addLink(\"custom_builds\");\n            self._addLink(\"permissions\");\n            self._addLink(\"api_key\");\n            if (config.has_user_tool_filters) {\n                self._addLink(\"toolbox_filters\");\n            }\n            if (config.enable_openid && !config.use_remote_user) {\n                self._addLink(\"openids\");\n            }\n            if (Galaxy.session_csrf_token) {\n                self._addLink(\"logout\");\n            }\n            self.$preferences.append(self._templateFooter(data));\n            self.$el.empty().append(self.$preferences);\n        });\n    },\n\n    _addLink: function _addLink(action) {\n        var options = this.model.get(action);\n        var $row = $(this._templateLink(options));\n        var $a = $row.find(\"a\");\n        if (options.onclick) {\n            $a.on(\"click\", function () {\n                options.onclick();\n            });\n        } else {\n            $a.attr(\"href\", Galaxy.root + \"user/\" + action);\n        }\n        this.$table.append($row);\n    },\n\n    _templateLink: function _templateLink(options) {\n        return \"<tr><td><div class=\\\"ui-panel-icon fa \" + options.icon + \"\\\"></td><td><a class=\\\"ui-panel-anchor\\\" href=\\\"javascript:void(0)\\\">\" + options.title + \"</a><div class=\\\"ui-form-info\\\">\" + options.description + \"</div></td></tr>\";\n    },\n\n    _templateFooter: function _templateFooter(options) {\n        return \"<p class=\\\"ui-panel-footer\\\">You are using <strong>\" + options.nice_total_disk_usage + \"</strong> of disk space in this Galaxy instance. \" + (Galaxy.config.enable_quotas ? \"Your disk quota is: <strong>\" + options.quota + \"</strong>. \" : \"\") + \"Is your usage more than expected? See the <a href=\\\"https://galaxyproject.org/learn/managing-datasets/\\\" target=\\\"_blank\\\">documentation</a> for tips on how to find all of the data in your account.</p>\";\n    }\n});\n\nexports.default = {\n    View: View,\n    Model: Model\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91c2VyL3VzZXItcHJlZmVyZW5jZXMuanM/ZDAwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuLyoqIFVzZXIgUHJlZmVyZW5jZXMgdmlldyAqL1xuaW1wb3J0IEZvcm0gZnJvbSBcIm12Yy9mb3JtL2Zvcm0tdmlld1wiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xuaW1wb3J0IFF1ZXJ5U3RyaW5nUGFyc2luZyBmcm9tIFwidXRpbHMvcXVlcnktc3RyaW5nLXBhcnNpbmdcIjtcbi8qKiBDb250YWlucyBkZXNjcmlwdGl2ZSBkaWN0aW9uYXJpZXMgZGVzY3JpYmluZyB1c2VyIGZvcm1zICovXG52YXIgTW9kZWwgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICAgIG9wdGlvbnMudXNlcl9pZCA9IG9wdGlvbnMudXNlcl9pZCB8fCBHYWxheHkudXNlci5pZDtcbiAgICAgICAgdGhpcy5zZXQoe1xuICAgICAgICAgICAgdXNlcl9pZDogb3B0aW9ucy51c2VyX2lkLFxuICAgICAgICAgICAgaW5mb3JtYXRpb246IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJNYW5hZ2UgaW5mb3JtYXRpb25cIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRWRpdCB5b3VyIGVtYWlsLCBhZGRyZXNzZXMgYW5kIGN1c3RvbSBwYXJhbWV0ZXJzIG9yIGNoYW5nZSB5b3VyIHVzZXJuYW1lLlwiLFxuICAgICAgICAgICAgICAgIHVybDogYGFwaS91c2Vycy8ke29wdGlvbnMudXNlcl9pZH0vaW5mb3JtYXRpb24vaW5wdXRzYCxcbiAgICAgICAgICAgICAgICBpY29uOiBcImZhLXVzZXJcIixcbiAgICAgICAgICAgICAgICByZWRpcmVjdDogXCJ1c2VyXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkNoYW5nZSBwYXNzd29yZFwiKSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogX2woXCJBbGxvd3MgeW91IHRvIGNoYW5nZSB5b3VyIGxvZ2luIGNyZWRlbnRpYWxzLlwiKSxcbiAgICAgICAgICAgICAgICBpY29uOiBcImZhLXVubG9jay1hbHRcIixcbiAgICAgICAgICAgICAgICB1cmw6IGBhcGkvdXNlcnMvJHtvcHRpb25zLnVzZXJfaWR9L3Bhc3N3b3JkL2lucHV0c2AsXG4gICAgICAgICAgICAgICAgc3VibWl0X3RpdGxlOiBcIlNhdmUgcGFzc3dvcmRcIixcbiAgICAgICAgICAgICAgICByZWRpcmVjdDogXCJ1c2VyXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21tdW5pY2F0aW9uOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hhbmdlIGNvbW11bmljYXRpb24gc2V0dGluZ3NcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF9sKFwiRW5hYmxlIG9yIGRpc2FibGUgdGhlIGNvbW11bmljYXRpb24gZmVhdHVyZSB0byBjaGF0IHdpdGggb3RoZXIgdXNlcnMuXCIpLFxuICAgICAgICAgICAgICAgIHVybDogYGFwaS91c2Vycy8ke29wdGlvbnMudXNlcl9pZH0vY29tbXVuaWNhdGlvbi9pbnB1dHNgLFxuICAgICAgICAgICAgICAgIGljb246IFwiZmEtY29tbWVudHMtb1wiLFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0OiBcInVzZXJcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBlcm1pc3Npb25zOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiU2V0IGRhdGFzZXQgcGVybWlzc2lvbnMgZm9yIG5ldyBoaXN0b3JpZXNcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICAgICAgICAgIFwiR3JhbnQgb3RoZXJzIGRlZmF1bHQgYWNjZXNzIHRvIG5ld2x5IGNyZWF0ZWQgaGlzdG9yaWVzLiBDaGFuZ2VzIG1hZGUgaGVyZSB3aWxsIG9ubHkgYWZmZWN0IGhpc3RvcmllcyBjcmVhdGVkIGFmdGVyIHRoZXNlIHNldHRpbmdzIGhhdmUgYmVlbiBzdG9yZWQuXCIsXG4gICAgICAgICAgICAgICAgdXJsOiBgYXBpL3VzZXJzLyR7b3B0aW9ucy51c2VyX2lkfS9wZXJtaXNzaW9ucy9pbnB1dHNgLFxuICAgICAgICAgICAgICAgIGljb246IFwiZmEtdXNlcnNcIixcbiAgICAgICAgICAgICAgICBzdWJtaXRfdGl0bGU6IFwiU2F2ZSBwZXJtaXNzaW9uc1wiLFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0OiBcInVzZXJcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFwaV9rZXk6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJNYW5hZ2UgQVBJIGtleVwiKSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogX2woXCJBY2Nlc3MgeW91ciBjdXJyZW50IEFQSSBrZXkgb3IgY3JlYXRlIGEgbmV3IG9uZS5cIiksXG4gICAgICAgICAgICAgICAgdXJsOiBgYXBpL3VzZXJzLyR7b3B0aW9ucy51c2VyX2lkfS9hcGlfa2V5L2lucHV0c2AsXG4gICAgICAgICAgICAgICAgaWNvbjogXCJmYS1rZXlcIixcbiAgICAgICAgICAgICAgICBzdWJtaXRfdGl0bGU6IFwiQ3JlYXRlIGEgbmV3IGtleVwiLFxuICAgICAgICAgICAgICAgIHN1Ym1pdF9pY29uOiBcImZhLWNoZWNrXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b29sYm94X2ZpbHRlcnM6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJNYW5hZ2UgVG9vbGJveCBmaWx0ZXJzXCIpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBfbChcIkN1c3RvbWl6ZSB5b3VyIFRvb2xib3ggYnkgZGlzcGxheWluZyBvciBvbWl0dGluZyBzZXRzIG9mIFRvb2xzLlwiKSxcbiAgICAgICAgICAgICAgICB1cmw6IGBhcGkvdXNlcnMvJHtvcHRpb25zLnVzZXJfaWR9L3Rvb2xib3hfZmlsdGVycy9pbnB1dHNgLFxuICAgICAgICAgICAgICAgIGljb246IFwiZmEtZmlsdGVyXCIsXG4gICAgICAgICAgICAgICAgc3VibWl0X3RpdGxlOiBcIlNhdmUgZmlsdGVyc1wiLFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0OiBcInVzZXJcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9wZW5pZHM6IHtcbiAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJNYW5hZ2UgT3BlbklEc1wiKSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogX2woXCJBc3NvY2lhdGUgT3BlbklEcyB3aXRoIHlvdXIgYWNjb3VudC5cIiksXG4gICAgICAgICAgICAgICAgaWNvbjogXCJmYS1vcGVuaWRcIixcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgJHtHYWxheHkucm9vdH1vcGVuaWRzL2xpc3RgO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjdXN0b21fYnVpbGRzOiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiTWFuYWdlIGN1c3RvbSBidWlsZHNcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF9sKFwiQWRkIG9yIHJlbW92ZSBjdXN0b20gYnVpbGRzIHVzaW5nIGhpc3RvcnkgZGF0YXNldHMuXCIpLFxuICAgICAgICAgICAgICAgIGljb246IFwiZmEtY3ViZXNcIixcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgJHtHYWxheHkucm9vdH1jdXN0b21fYnVpbGRzYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbG9nb3V0OiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiU2lnbiBvdXRcIiksXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IF9sKFwiQ2xpY2sgaGVyZSB0byBzaWduIG91dCBvZiBhbGwgc2Vzc2lvbnMuXCIpLFxuICAgICAgICAgICAgICAgIGljb246IFwiZmEtc2lnbi1vdXRcIixcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgR2FsYXh5Lm1vZGFsLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiU2lnbiBvdXRcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5OiBcIkRvIHlvdSB3YW50IHRvIGNvbnRpbnVlIGFuZCBzaWduIG91dCBvZiBhbGwgYWN0aXZlIHNlc3Npb25zP1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhbmNlbDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbGF4eS5tb2RhbC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlNpZ24gb3V0XCI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGAke0dhbGF4eS5yb290fXVzZXIvbG9nb3V0P3Nlc3Npb25fY3NyZl90b2tlbj0ke1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FsYXh5LnNlc3Npb25fY3NyZl90b2tlblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufSk7XG5cbi8qKiBWaWV3IG9mIHRoZSBtYWluIHVzZXIgcHJlZmVyZW5jZSBwYW5lbCB3aXRoIGxpbmtzIHRvIGluZGl2aWR1YWwgdXNlciBmb3JtcyAqL1xudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgdGl0bGU6IF9sKFwiVXNlciBQcmVmZXJlbmNlc1wiKSxcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG5ldyBNb2RlbCgpO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQoXCI8ZGl2Lz5cIik7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGNvbmZpZyA9IEdhbGF4eS5jb25maWc7XG4gICAgICAgICQuZ2V0SlNPTihgJHtHYWxheHkucm9vdH1hcGkvdXNlcnMvJHtHYWxheHkudXNlci5pZH1gLCBkYXRhID0+IHtcbiAgICAgICAgICAgIHNlbGYuJHByZWZlcmVuY2VzID0gJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhcInVpLXBhbmVsXCIpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgkKFwiPGgyLz5cIikuYXBwZW5kKFwiVXNlciBwcmVmZXJlbmNlc1wiKSlcbiAgICAgICAgICAgICAgICAuYXBwZW5kKCQoXCI8cC8+XCIpLmFwcGVuZChgWW91IGFyZSBsb2dnZWQgaW4gYXMgPHN0cm9uZz4ke18uZXNjYXBlKGRhdGEuZW1haWwpfTwvc3Ryb25nPi5gKSlcbiAgICAgICAgICAgICAgICAuYXBwZW5kKChzZWxmLiR0YWJsZSA9ICQoXCI8dGFibGUvPlwiKS5hZGRDbGFzcyhcInVpLXBhbmVsLXRhYmxlXCIpKSk7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IFF1ZXJ5U3RyaW5nUGFyc2luZy5nZXQoXCJtZXNzYWdlXCIpO1xuICAgICAgICAgICAgdmFyIHN0YXR1cyA9IFF1ZXJ5U3RyaW5nUGFyc2luZy5nZXQoXCJzdGF0dXNcIik7XG4gICAgICAgICAgICBpZiAobWVzc2FnZSAmJiBzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBzZWxmLiRwcmVmZXJlbmNlcy5wcmVwZW5kKG5ldyBVaS5NZXNzYWdlKHsgbWVzc2FnZTogbWVzc2FnZSwgc3RhdHVzOiBzdGF0dXMgfSkuJGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY29uZmlnLnVzZV9yZW1vdGVfdXNlcikge1xuICAgICAgICAgICAgICAgIHNlbGYuX2FkZExpbmsoXCJpbmZvcm1hdGlvblwiKTtcbiAgICAgICAgICAgICAgICBzZWxmLl9hZGRMaW5rKFwicGFzc3dvcmRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29uZmlnLmVuYWJsZV9jb21tdW5pY2F0aW9uX3NlcnZlcikge1xuICAgICAgICAgICAgICAgIHNlbGYuX2FkZExpbmsoXCJjb21tdW5pY2F0aW9uXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5fYWRkTGluayhcImN1c3RvbV9idWlsZHNcIik7XG4gICAgICAgICAgICBzZWxmLl9hZGRMaW5rKFwicGVybWlzc2lvbnNcIik7XG4gICAgICAgICAgICBzZWxmLl9hZGRMaW5rKFwiYXBpX2tleVwiKTtcbiAgICAgICAgICAgIGlmIChjb25maWcuaGFzX3VzZXJfdG9vbF9maWx0ZXJzKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fYWRkTGluayhcInRvb2xib3hfZmlsdGVyc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb25maWcuZW5hYmxlX29wZW5pZCAmJiAhY29uZmlnLnVzZV9yZW1vdGVfdXNlcikge1xuICAgICAgICAgICAgICAgIHNlbGYuX2FkZExpbmsoXCJvcGVuaWRzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKEdhbGF4eS5zZXNzaW9uX2NzcmZfdG9rZW4pIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9hZGRMaW5rKFwibG9nb3V0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi4kcHJlZmVyZW5jZXMuYXBwZW5kKHNlbGYuX3RlbXBsYXRlRm9vdGVyKGRhdGEpKTtcbiAgICAgICAgICAgIHNlbGYuJGVsLmVtcHR5KCkuYXBwZW5kKHNlbGYuJHByZWZlcmVuY2VzKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9hZGRMaW5rOiBmdW5jdGlvbihhY3Rpb24pIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm1vZGVsLmdldChhY3Rpb24pO1xuICAgICAgICB2YXIgJHJvdyA9ICQodGhpcy5fdGVtcGxhdGVMaW5rKG9wdGlvbnMpKTtcbiAgICAgICAgdmFyICRhID0gJHJvdy5maW5kKFwiYVwiKTtcbiAgICAgICAgaWYgKG9wdGlvbnMub25jbGljaykge1xuICAgICAgICAgICAgJGEub24oXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucy5vbmNsaWNrKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRhLmF0dHIoXCJocmVmXCIsIGAke0dhbGF4eS5yb290fXVzZXIvJHthY3Rpb259YCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4kdGFibGUuYXBwZW5kKCRyb3cpO1xuICAgIH0sXG5cbiAgICBfdGVtcGxhdGVMaW5rOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBgPHRyPjx0ZD48ZGl2IGNsYXNzPVwidWktcGFuZWwtaWNvbiBmYSAke1xuICAgICAgICAgICAgb3B0aW9ucy5pY29uXG4gICAgICAgIH1cIj48L3RkPjx0ZD48YSBjbGFzcz1cInVpLXBhbmVsLWFuY2hvclwiIGhyZWY9XCJqYXZhc2NyaXB0OnZvaWQoMClcIj4ke1xuICAgICAgICAgICAgb3B0aW9ucy50aXRsZVxuICAgICAgICB9PC9hPjxkaXYgY2xhc3M9XCJ1aS1mb3JtLWluZm9cIj4ke29wdGlvbnMuZGVzY3JpcHRpb259PC9kaXY+PC90ZD48L3RyPmA7XG4gICAgfSxcblxuICAgIF90ZW1wbGF0ZUZvb3RlcjogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gYDxwIGNsYXNzPVwidWktcGFuZWwtZm9vdGVyXCI+WW91IGFyZSB1c2luZyA8c3Ryb25nPiR7XG4gICAgICAgICAgICBvcHRpb25zLm5pY2VfdG90YWxfZGlza191c2FnZVxuICAgICAgICB9PC9zdHJvbmc+IG9mIGRpc2sgc3BhY2UgaW4gdGhpcyBHYWxheHkgaW5zdGFuY2UuICR7XG4gICAgICAgICAgICBHYWxheHkuY29uZmlnLmVuYWJsZV9xdW90YXMgPyBgWW91ciBkaXNrIHF1b3RhIGlzOiA8c3Ryb25nPiR7b3B0aW9ucy5xdW90YX08L3N0cm9uZz4uIGAgOiBcIlwiXG4gICAgICAgIH1JcyB5b3VyIHVzYWdlIG1vcmUgdGhhbiBleHBlY3RlZD8gU2VlIHRoZSA8YSBocmVmPVwiaHR0cHM6Ly9nYWxheHlwcm9qZWN0Lm9yZy9sZWFybi9tYW5hZ2luZy1kYXRhc2V0cy9cIiB0YXJnZXQ9XCJfYmxhbmtcIj5kb2N1bWVudGF0aW9uPC9hPiBmb3IgdGlwcyBvbiBob3cgdG8gZmluZCBhbGwgb2YgdGhlIGRhdGEgaW4geW91ciBhY2NvdW50LjwvcD5gO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVmlldzogVmlldyxcbiAgICBNb2RlbDogTW9kZWxcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3VzZXIvdXNlci1wcmVmZXJlbmNlcy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFSQTtBQUhBO0FBY0E7QUFuQkE7QUFqRUE7QUF1RkE7QUEzRkE7QUFDQTtBQTZGQTtBQUNBO0FBcEdBO0FBb0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQTFFQTtBQUNBO0FBNEVBO0FBQ0E7QUFDQTtBQUZBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///265\n");

/***/ }),
/* 266 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/user/user-custom-builds.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nvar _uiTable = __webpack_require__(/*! mvc/ui/ui-table */ 267);\n\nvar _uiTable2 = _interopRequireDefault(_uiTable);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** This class renders the chart configuration form. */\nvar Collection = Backbone.Collection.extend({\n    comparator: function comparator(a, b) {\n        a = a.get(\"name\");\n        b = b.get(\"name\");\n        return a > b ? 1 : a < b ? -1 : 0;\n    }\n});\n\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        var history_id = Galaxy.currHistoryPanel && Galaxy.currHistoryPanel.model.id;\n        this.model = new Backbone.Model();\n        this.model.url = Galaxy.root + \"api/histories/\" + history_id + \"/custom_builds_metadata\";\n        this.collection = new Collection();\n        this.collection.url = Galaxy.root + \"api/users/\" + Galaxy.user.id + \"/custom_builds\";\n        this.message = new _uiMisc2.default.Message({});\n        this.installed_builds = new _uiMisc2.default.Select.View({\n            optional: true,\n            onchange: function onchange() {\n                self.installed_builds.value(null);\n            },\n            empty_text: \"List of available builds:\",\n            error_text: \"No system installed builds available.\"\n        });\n        this.table = new _uiTable2.default.View({ cls: \"grid\", selectable: false });\n        this.table.addHeader(\"Name\");\n        this.table.addHeader(\"Key\");\n        this.table.addHeader(\"Number of chroms/contigs\");\n        this.table.addHeader(\"\");\n        this.table.appendHeader();\n        this.setElement($(\"<div/>\").append($(\"<h4/>\").text(\"Current Custom Builds\")).append(this.table.$el).append(this.$installed = $(\"<div/>\").append($(\"<h4/>\").text(\"System Installed Builds\").addClass(\"ui-margin-top\")).append(this.installed_builds.$el)).append($(\"<h4/>\").text(\"Add a Custom Build\").addClass(\"ui-margin-top\")).append($(\"<span/>\").addClass(\"ui-column\").append($(\"<div/>\").addClass(\"ui-column-left\").append(this.message.$el).append(this.$form = $(\"<div/>\").addClass(\"ui-margin-top\"))).append(this.$help = $(\"<div/>\").addClass(\"ui-column-right\"))));\n        this.listenTo(this.collection, \"add remove reset\", function () {\n            self._renderTable();\n        });\n        this.listenTo(this.model, \"change\", function () {\n            self._renderForm();\n        });\n        this.collection.fetch();\n        this.model.fetch();\n    },\n\n    render: function render() {\n        this._renderTable();\n        this._renderForm();\n    },\n\n    _renderTable: function _renderTable() {\n        var self = this;\n        this.table.delAll();\n        this.collection.sort();\n        this.collection.each(function (model) {\n            self.table.add(model.get(\"name\"));\n            self.table.add(model.id);\n            self.table.add(model.get(\"count\") !== undefined ? model.get(\"count\") : \"Processing...\");\n            self.table.add(new _uiMisc2.default.ButtonIcon({\n                icon: \"fa-trash-o\",\n                cls: \"ui-button-icon-plain\",\n                tooltip: (0, _localization2.default)(\"Delete custom build.\"),\n                onclick: function onclick() {\n                    model.destroy();\n                }\n            }).$el);\n            self.table.append(model.id);\n        });\n    },\n\n    _renderForm: function _renderForm() {\n        var self = this;\n        var initial_type = \"fasta\";\n        var form = new _formView2.default({\n            inputs: [{\n                type: \"text\",\n                name: \"name\",\n                label: \"Name\",\n                help: \"Specify a build name e.g. Hamster.\"\n            }, {\n                type: \"text\",\n                name: \"id\",\n                label: \"Key\",\n                help: \"Specify a build key e.g. hamster_v1.\"\n            }, {\n                name: \"len\",\n                type: \"conditional\",\n                test_param: {\n                    name: \"type\",\n                    label: \"Definition\",\n                    help: (0, _localization2.default)(\"Provide the data source.\"),\n                    type: \"select\",\n                    value: initial_type,\n                    data: [{\n                        value: \"fasta\",\n                        label: \"FASTA-file from history\"\n                    }, {\n                        value: \"file\",\n                        label: \"Len-file from disk\"\n                    }, {\n                        value: \"text\",\n                        label: \"Len-file by copy/paste\"\n                    }]\n                },\n                cases: [{\n                    value: \"fasta\",\n                    inputs: [{\n                        type: \"select\",\n                        name: \"value\",\n                        label: \"FASTA-file\",\n                        data: this.model.get(\"fasta_hdas\")\n                    }]\n                }, {\n                    value: \"file\",\n                    inputs: [{\n                        type: \"upload\",\n                        name: \"value\",\n                        label: \"Len-file\",\n                        data: this.model.get(\"len_hdas\")\n                    }]\n                }, {\n                    value: \"text\",\n                    inputs: [{\n                        type: \"text\",\n                        area: true,\n                        name: \"value\",\n                        label: \"Edit/Paste\"\n                    }]\n                }]\n            }],\n            buttons: {\n                save: new _uiMisc2.default.Button({\n                    icon: \"fa-save\",\n                    tooltip: (0, _localization2.default)(\"Create new Build\"),\n                    title: (0, _localization2.default)(\"Save\"),\n                    cls: \"btn btn-primary ui-clear-float\",\n                    onclick: function onclick() {\n                        var data = form.data.create();\n                        if (!data.id || !data.name) {\n                            self.message.update({\n                                message: \"All inputs are required.\",\n                                status: \"danger\"\n                            });\n                        } else {\n                            self.collection.create(data, {\n                                wait: true,\n                                success: function success(response) {\n                                    if (response.get(\"message\")) {\n                                        self.message.update({\n                                            message: response.get(\"message\"),\n                                            status: \"warning\"\n                                        });\n                                    } else {\n                                        self.message.update({\n                                            message: \"Successfully added a new custom build.\",\n                                            status: \"success\"\n                                        });\n                                    }\n                                },\n                                error: function error(response, err) {\n                                    var message = err && err.responseJSON && err.responseJSON.err_msg;\n                                    self.message.update({\n                                        message: message || \"Failed to create custom build.\",\n                                        status: \"danger\"\n                                    });\n                                }\n                            });\n                        }\n                    }\n                })\n            },\n            onchange: function onchange() {\n                var input_id = form.data.match(\"len|type\");\n                if (input_id) {\n                    var input_field = form.field_list[input_id];\n                    self._renderHelp(input_field.value());\n                }\n            }\n        });\n        this.$form.empty().append(form.$el);\n        var installed_builds = this.model.get(\"installed_builds\");\n        if (installed_builds && installed_builds.length) {\n            this.$installed.show();\n            this.installed_builds.update(this.model.get(\"installed_builds\"));\n        } else {\n            this.$installed.hide();\n        }\n        this._renderHelp(initial_type);\n    },\n\n    _renderHelp: function _renderHelp(len_type) {\n        this.$help.empty().addClass(\"alert alert-info\").html(len_type == \"fasta\" ? this._templateFasta() : this._templateLen());\n    },\n\n    _templateLen: function _templateLen() {\n        return \"<h4>Length Format</h4>\" + \"<p>\" + \"The length format is two-column, separated by whitespace, of the form:\" + \"<pre>chrom/contig   length of chrom/contig</pre>\" + \"</p>\" + \"<p>\" + \"For example, the first few entries of <em>mm9.len</em> are as follows:\" + \"<pre>\" + \"chr1    197195432\\n\" + \"chr2    181748087\\n\" + \"chr3    159599783\\n\" + \"chr4    155630120\\n\" + \"chr5    152537259\" + \"</pre>\" + \"</p>\" + \"<p>Trackster uses this information to populate the select box for chrom/contig, and\" + \"to set the maximum basepair of the track browser. You may either upload a .len file\" + \"of this format (Len File option), or directly enter the information into the box \" + \"(Len Entry option).</p>\";\n    },\n\n    _templateFasta: function _templateFasta() {\n        return \"<h4>FASTA format</h4>\" + \"<p>\" + \"This is a multi-fasta file from your current history that provides the genome\" + \"sequences for each chromosome/contig in your build.\" + \"</p>\" + \"<p>\" + \"Here is a snippet from an example multi-fasta file:\" + \"<pre>\" + \">chr1\\n\" + \"ATTATATATAAGACCACAGAGAGAATATTTTGCCCGG...\\n\\n\" + \">chr2\\n\" + \"GGCGGCCGCGGCGATATAGAACTACTCATTATATATA...\\n\\n\" + \"...\" + \"</pre>\" + \"</p>\";\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91c2VyL3VzZXItY3VzdG9tLWJ1aWxkcy5qcz9mMGU5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG4vKiogVGhpcyBjbGFzcyByZW5kZXJzIHRoZSBjaGFydCBjb25maWd1cmF0aW9uIGZvcm0uICovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5pbXBvcnQgVWkgZnJvbSBcIm12Yy91aS91aS1taXNjXCI7XG5pbXBvcnQgRm9ybSBmcm9tIFwibXZjL2Zvcm0vZm9ybS12aWV3XCI7XG5pbXBvcnQgVGFibGUgZnJvbSBcIm12Yy91aS91aS10YWJsZVwiO1xudmFyIENvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG4gICAgY29tcGFyYXRvcjogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICBhID0gYS5nZXQoXCJuYW1lXCIpO1xuICAgICAgICBiID0gYi5nZXQoXCJuYW1lXCIpO1xuICAgICAgICByZXR1cm4gYSA+IGIgPyAxIDogYSA8IGIgPyAtMSA6IDA7XG4gICAgfVxufSk7XG5cbnZhciBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaGlzdG9yeV9pZCA9IEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsICYmIEdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLm1vZGVsLmlkO1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEJhY2tib25lLk1vZGVsKCk7XG4gICAgICAgIHRoaXMubW9kZWwudXJsID0gYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllcy8ke2hpc3RvcnlfaWR9L2N1c3RvbV9idWlsZHNfbWV0YWRhdGFgO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBuZXcgQ29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24udXJsID0gYCR7R2FsYXh5LnJvb3R9YXBpL3VzZXJzLyR7R2FsYXh5LnVzZXIuaWR9L2N1c3RvbV9idWlsZHNgO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBuZXcgVWkuTWVzc2FnZSh7fSk7XG4gICAgICAgIHRoaXMuaW5zdGFsbGVkX2J1aWxkcyA9IG5ldyBVaS5TZWxlY3QuVmlldyh7XG4gICAgICAgICAgICBvcHRpb25hbDogdHJ1ZSxcbiAgICAgICAgICAgIG9uY2hhbmdlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmluc3RhbGxlZF9idWlsZHMudmFsdWUobnVsbCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW1wdHlfdGV4dDogXCJMaXN0IG9mIGF2YWlsYWJsZSBidWlsZHM6XCIsXG4gICAgICAgICAgICBlcnJvcl90ZXh0OiBcIk5vIHN5c3RlbSBpbnN0YWxsZWQgYnVpbGRzIGF2YWlsYWJsZS5cIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50YWJsZSA9IG5ldyBUYWJsZS5WaWV3KHsgY2xzOiBcImdyaWRcIiwgc2VsZWN0YWJsZTogZmFsc2UgfSk7XG4gICAgICAgIHRoaXMudGFibGUuYWRkSGVhZGVyKFwiTmFtZVwiKTtcbiAgICAgICAgdGhpcy50YWJsZS5hZGRIZWFkZXIoXCJLZXlcIik7XG4gICAgICAgIHRoaXMudGFibGUuYWRkSGVhZGVyKFwiTnVtYmVyIG9mIGNocm9tcy9jb250aWdzXCIpO1xuICAgICAgICB0aGlzLnRhYmxlLmFkZEhlYWRlcihcIlwiKTtcbiAgICAgICAgdGhpcy50YWJsZS5hcHBlbmRIZWFkZXIoKTtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KFxuICAgICAgICAgICAgJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJChcIjxoNC8+XCIpLnRleHQoXCJDdXJyZW50IEN1c3RvbSBCdWlsZHNcIikpXG4gICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLnRhYmxlLiRlbClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAodGhpcy4kaW5zdGFsbGVkID0gJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiPGg0Lz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoXCJTeXN0ZW0gSW5zdGFsbGVkIEJ1aWxkc1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1tYXJnaW4tdG9wXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMuaW5zdGFsbGVkX2J1aWxkcy4kZWwpKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAkKFwiPGg0Lz5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KFwiQWRkIGEgQ3VzdG9tIEJ1aWxkXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1tYXJnaW4tdG9wXCIpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICQoXCI8c3Bhbi8+XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1jb2x1bW5cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIjxkaXYvPlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJ1aS1jb2x1bW4tbGVmdFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMubWVzc2FnZS4kZWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoKHRoaXMuJGZvcm0gPSAkKFwiPGRpdi8+XCIpLmFkZENsYXNzKFwidWktbWFyZ2luLXRvcFwiKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCh0aGlzLiRoZWxwID0gJChcIjxkaXYvPlwiKS5hZGRDbGFzcyhcInVpLWNvbHVtbi1yaWdodFwiKSkpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJhZGQgcmVtb3ZlIHJlc2V0XCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlbmRlclRhYmxlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuX3JlbmRlckZvcm0oKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi5mZXRjaCgpO1xuICAgICAgICB0aGlzLm1vZGVsLmZldGNoKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3JlbmRlclRhYmxlKCk7XG4gICAgICAgIHRoaXMuX3JlbmRlckZvcm0oKTtcbiAgICB9LFxuXG4gICAgX3JlbmRlclRhYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLnRhYmxlLmRlbEFsbCgpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uc29ydCgpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZWFjaChtb2RlbCA9PiB7XG4gICAgICAgICAgICBzZWxmLnRhYmxlLmFkZChtb2RlbC5nZXQoXCJuYW1lXCIpKTtcbiAgICAgICAgICAgIHNlbGYudGFibGUuYWRkKG1vZGVsLmlkKTtcbiAgICAgICAgICAgIHNlbGYudGFibGUuYWRkKG1vZGVsLmdldChcImNvdW50XCIpICE9PSB1bmRlZmluZWQgPyBtb2RlbC5nZXQoXCJjb3VudFwiKSA6IFwiUHJvY2Vzc2luZy4uLlwiKTtcbiAgICAgICAgICAgIHNlbGYudGFibGUuYWRkKFxuICAgICAgICAgICAgICAgIG5ldyBVaS5CdXR0b25JY29uKHtcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJmYS10cmFzaC1vXCIsXG4gICAgICAgICAgICAgICAgICAgIGNsczogXCJ1aS1idXR0b24taWNvbi1wbGFpblwiLFxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiBfbChcIkRlbGV0ZSBjdXN0b20gYnVpbGQuXCIpLFxuICAgICAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLiRlbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNlbGYudGFibGUuYXBwZW5kKG1vZGVsLmlkKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIF9yZW5kZXJGb3JtOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgaW5pdGlhbF90eXBlID0gXCJmYXN0YVwiO1xuICAgICAgICB2YXIgZm9ybSA9IG5ldyBGb3JtKHtcbiAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwibmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJOYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgIGhlbHA6IFwiU3BlY2lmeSBhIGJ1aWxkIG5hbWUgZS5nLiBIYW1zdGVyLlwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIktleVwiLFxuICAgICAgICAgICAgICAgICAgICBoZWxwOiBcIlNwZWNpZnkgYSBidWlsZCBrZXkgZS5nLiBoYW1zdGVyX3YxLlwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwibGVuXCIsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiY29uZGl0aW9uYWxcIixcbiAgICAgICAgICAgICAgICAgICAgdGVzdF9wYXJhbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ0eXBlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJEZWZpbml0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwOiBfbChcIlByb3ZpZGUgdGhlIGRhdGEgc291cmNlLlwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogaW5pdGlhbF90eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiZmFzdGFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiRkFTVEEtZmlsZSBmcm9tIGhpc3RvcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJmaWxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkxlbi1maWxlIGZyb20gZGlza1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcInRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiTGVuLWZpbGUgYnkgY29weS9wYXN0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBjYXNlczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcImZhc3RhXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2VsZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInZhbHVlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJGQVNUQS1maWxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLm1vZGVsLmdldChcImZhc3RhX2hkYXNcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiZmlsZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInVwbG9hZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJ2YWx1ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiTGVuLWZpbGVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMubW9kZWwuZ2V0KFwibGVuX2hkYXNcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwidGV4dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZWE6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInZhbHVlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJFZGl0L1Bhc3RlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBidXR0b25zOiB7XG4gICAgICAgICAgICAgICAgc2F2ZTogbmV3IFVpLkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiZmEtc2F2ZVwiLFxuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiBfbChcIkNyZWF0ZSBuZXcgQnVpbGRcIiksXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlNhdmVcIiksXG4gICAgICAgICAgICAgICAgICAgIGNsczogXCJidG4gYnRuLXByaW1hcnkgdWktY2xlYXItZmxvYXRcIixcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGZvcm0uZGF0YS5jcmVhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YS5pZCB8fCAhZGF0YS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNzYWdlLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiQWxsIGlucHV0cyBhcmUgcmVxdWlyZWQuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJkYW5nZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbGxlY3Rpb24uY3JlYXRlKGRhdGEsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5nZXQoXCJtZXNzYWdlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNzYWdlLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLmdldChcIm1lc3NhZ2VcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJ3YXJuaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5tZXNzYWdlLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiU3VjY2Vzc2Z1bGx5IGFkZGVkIGEgbmV3IGN1c3RvbSBidWlsZC5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBcInN1Y2Nlc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24ocmVzcG9uc2UsIGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnIgJiYgZXJyLnJlc3BvbnNlSlNPTiAmJiBlcnIucmVzcG9uc2VKU09OLmVycl9tc2c7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1lc3NhZ2UudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlIHx8IFwiRmFpbGVkIHRvIGNyZWF0ZSBjdXN0b20gYnVpbGQuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBcImRhbmdlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbmNoYW5nZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0X2lkID0gZm9ybS5kYXRhLm1hdGNoKFwibGVufHR5cGVcIik7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0X2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dF9maWVsZCA9IGZvcm0uZmllbGRfbGlzdFtpbnB1dF9pZF07XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3JlbmRlckhlbHAoaW5wdXRfZmllbGQudmFsdWUoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy4kZm9ybS5lbXB0eSgpLmFwcGVuZChmb3JtLiRlbCk7XG4gICAgICAgIHZhciBpbnN0YWxsZWRfYnVpbGRzID0gdGhpcy5tb2RlbC5nZXQoXCJpbnN0YWxsZWRfYnVpbGRzXCIpO1xuICAgICAgICBpZiAoaW5zdGFsbGVkX2J1aWxkcyAmJiBpbnN0YWxsZWRfYnVpbGRzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy4kaW5zdGFsbGVkLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuaW5zdGFsbGVkX2J1aWxkcy51cGRhdGUodGhpcy5tb2RlbC5nZXQoXCJpbnN0YWxsZWRfYnVpbGRzXCIpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJGluc3RhbGxlZC5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVuZGVySGVscChpbml0aWFsX3R5cGUpO1xuICAgIH0sXG5cbiAgICBfcmVuZGVySGVscDogZnVuY3Rpb24obGVuX3R5cGUpIHtcbiAgICAgICAgdGhpcy4kaGVscFxuICAgICAgICAgICAgLmVtcHR5KClcbiAgICAgICAgICAgIC5hZGRDbGFzcyhcImFsZXJ0IGFsZXJ0LWluZm9cIilcbiAgICAgICAgICAgIC5odG1sKGxlbl90eXBlID09IFwiZmFzdGFcIiA/IHRoaXMuX3RlbXBsYXRlRmFzdGEoKSA6IHRoaXMuX3RlbXBsYXRlTGVuKCkpO1xuICAgIH0sXG5cbiAgICBfdGVtcGxhdGVMZW46IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgXCI8aDQ+TGVuZ3RoIEZvcm1hdDwvaDQ+XCIgK1xuICAgICAgICAgICAgXCI8cD5cIiArXG4gICAgICAgICAgICBcIlRoZSBsZW5ndGggZm9ybWF0IGlzIHR3by1jb2x1bW4sIHNlcGFyYXRlZCBieSB3aGl0ZXNwYWNlLCBvZiB0aGUgZm9ybTpcIiArXG4gICAgICAgICAgICBcIjxwcmU+Y2hyb20vY29udGlnICAgbGVuZ3RoIG9mIGNocm9tL2NvbnRpZzwvcHJlPlwiICtcbiAgICAgICAgICAgIFwiPC9wPlwiICtcbiAgICAgICAgICAgIFwiPHA+XCIgK1xuICAgICAgICAgICAgXCJGb3IgZXhhbXBsZSwgdGhlIGZpcnN0IGZldyBlbnRyaWVzIG9mIDxlbT5tbTkubGVuPC9lbT4gYXJlIGFzIGZvbGxvd3M6XCIgK1xuICAgICAgICAgICAgXCI8cHJlPlwiICtcbiAgICAgICAgICAgIFwiY2hyMSAgICAxOTcxOTU0MzJcXG5cIiArXG4gICAgICAgICAgICBcImNocjIgICAgMTgxNzQ4MDg3XFxuXCIgK1xuICAgICAgICAgICAgXCJjaHIzICAgIDE1OTU5OTc4M1xcblwiICtcbiAgICAgICAgICAgIFwiY2hyNCAgICAxNTU2MzAxMjBcXG5cIiArXG4gICAgICAgICAgICBcImNocjUgICAgMTUyNTM3MjU5XCIgK1xuICAgICAgICAgICAgXCI8L3ByZT5cIiArXG4gICAgICAgICAgICBcIjwvcD5cIiArXG4gICAgICAgICAgICBcIjxwPlRyYWNrc3RlciB1c2VzIHRoaXMgaW5mb3JtYXRpb24gdG8gcG9wdWxhdGUgdGhlIHNlbGVjdCBib3ggZm9yIGNocm9tL2NvbnRpZywgYW5kXCIgK1xuICAgICAgICAgICAgXCJ0byBzZXQgdGhlIG1heGltdW0gYmFzZXBhaXIgb2YgdGhlIHRyYWNrIGJyb3dzZXIuIFlvdSBtYXkgZWl0aGVyIHVwbG9hZCBhIC5sZW4gZmlsZVwiICtcbiAgICAgICAgICAgIFwib2YgdGhpcyBmb3JtYXQgKExlbiBGaWxlIG9wdGlvbiksIG9yIGRpcmVjdGx5IGVudGVyIHRoZSBpbmZvcm1hdGlvbiBpbnRvIHRoZSBib3ggXCIgK1xuICAgICAgICAgICAgXCIoTGVuIEVudHJ5IG9wdGlvbikuPC9wPlwiXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIF90ZW1wbGF0ZUZhc3RhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIFwiPGg0PkZBU1RBIGZvcm1hdDwvaDQ+XCIgK1xuICAgICAgICAgICAgXCI8cD5cIiArXG4gICAgICAgICAgICBcIlRoaXMgaXMgYSBtdWx0aS1mYXN0YSBmaWxlIGZyb20geW91ciBjdXJyZW50IGhpc3RvcnkgdGhhdCBwcm92aWRlcyB0aGUgZ2Vub21lXCIgK1xuICAgICAgICAgICAgXCJzZXF1ZW5jZXMgZm9yIGVhY2ggY2hyb21vc29tZS9jb250aWcgaW4geW91ciBidWlsZC5cIiArXG4gICAgICAgICAgICBcIjwvcD5cIiArXG4gICAgICAgICAgICBcIjxwPlwiICtcbiAgICAgICAgICAgIFwiSGVyZSBpcyBhIHNuaXBwZXQgZnJvbSBhbiBleGFtcGxlIG11bHRpLWZhc3RhIGZpbGU6XCIgK1xuICAgICAgICAgICAgXCI8cHJlPlwiICtcbiAgICAgICAgICAgIFwiPmNocjFcXG5cIiArXG4gICAgICAgICAgICBcIkFUVEFUQVRBVEFBR0FDQ0FDQUdBR0FHQUFUQVRUVFRHQ0NDR0cuLi5cXG5cXG5cIiArXG4gICAgICAgICAgICBcIj5jaHIyXFxuXCIgK1xuICAgICAgICAgICAgXCJHR0NHR0NDR0NHR0NHQVRBVEFHQUFDVEFDVENBVFRBVEFUQVRBLi4uXFxuXFxuXCIgK1xuICAgICAgICAgICAgXCIuLi5cIiArXG4gICAgICAgICAgICBcIjwvcHJlPlwiICtcbiAgICAgICAgICAgIFwiPC9wPlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91c2VyL3VzZXItY3VzdG9tLWJ1aWxkcy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFMQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUE4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQUtBO0FBQ0E7QUFGQTtBQWZBO0FBcUJBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFIQTtBQVlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBSEE7QUFZQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUhBO0FBL0NBO0FBNkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQXJCQTtBQXVCQTtBQUNBO0FBckNBO0FBREE7QUF5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExSEE7QUE0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQXFCQTtBQUNBO0FBQ0E7QUFDQTtBQWlCQTtBQXJSQTtBQUNBO0FBdVJBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///266\n");

/***/ }),
/* 267 */
/*!*******************************************!*\
  !*** ./galaxy/scripts/mvc/ui/ui-table.js ***!
  \*******************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        this.options = _utils2.default.merge(options, {\n            content: \"No content available.\",\n            onchange: null,\n            ondblclick: null,\n            onconfirm: null,\n            cls: \"ui-table\",\n            selectable: true,\n            cls_tr: \"\"\n        });\n        this.setElement(this._template());\n        this.$thead = this.$(\"thead\");\n        this.$tbody = this.$(\"tbody\");\n        this.$tmessage = this.$(\"tmessage\");\n        this.row = this._row();\n        this.row_count = 0;\n    },\n\n    events: {\n        click: \"_onclick\",\n        dblclick: \"_ondblclick\"\n    },\n\n    /** Add cell to header row */\n    addHeader: function addHeader($el) {\n        this.row.append($(\"<th/>\").append($el));\n    },\n\n    /** Append header row to table */\n    appendHeader: function appendHeader() {\n        this.$thead.append(this.row);\n        this.row = $(\"<tr/>\");\n    },\n\n    /** Add cell to row */\n    add: function add($el, width, align) {\n        var wrapper = $(\"<td/>\");\n        if (width) {\n            wrapper.css(\"width\", width);\n        }\n        if (align) {\n            wrapper.css(\"text-align\", align);\n        }\n        this.row.append(wrapper.append($el));\n    },\n\n    /** Append row to table */\n    append: function append(id, fade) {\n        this._commit(id, fade, false);\n    },\n\n    /** Prepend row to table */\n    prepend: function prepend(id, fade) {\n        this._commit(id, fade, true);\n    },\n\n    /** Helper to get row element */\n    get: function get(id) {\n        return this.$(\"#\" + id);\n    },\n\n    /** Delete row by id */\n    del: function del(id) {\n        var item = this.$tbody.find(\"#\" + id);\n        if (item.length > 0) {\n            item.remove();\n            this.row_count--;\n            this._refresh();\n        }\n    },\n\n    /** Delete all rows */\n    delAll: function delAll() {\n        this.$tbody.empty();\n        this.row_count = 0;\n        this._refresh();\n    },\n\n    /** Set a value i.e. selects/highlights a particular row by id */\n    value: function value(new_value) {\n        if (this.options.selectable) {\n            this.before = this.$tbody.find(\".current\").attr(\"id\");\n            if (new_value !== undefined) {\n                this.$tbody.find(\"tr\").removeClass(\"current\");\n                if (new_value) {\n                    this.$tbody.find(\"#\" + new_value).addClass(\"current\");\n                }\n            }\n            var after = this.$tbody.find(\".current\").attr(\"id\");\n            if (after === undefined) {\n                return null;\n            } else {\n                if (after != this.before && this.options.onchange) {\n                    this.options.onchange(new_value);\n                }\n                return after;\n            }\n        }\n    },\n\n    /** Return the number of rows */\n    size: function size() {\n        return this.$tbody.find(\"tr\").length;\n    },\n\n    /** Helper to append rows */\n    _commit: function _commit(id, fade, prepend) {\n        this.del(id);\n        this.row.attr(\"id\", id);\n        if (prepend) {\n            this.$tbody.prepend(this.row);\n        } else {\n            this.$tbody.append(this.row);\n        }\n        if (fade) {\n            this.row.hide();\n            this.row.fadeIn();\n        }\n        this.row = this._row();\n        this.row_count++;\n        this._refresh();\n    },\n\n    /** Helper to create new row */\n    _row: function _row() {\n        return $(\"<tr class=\\\"\" + this.options.cls_tr + \"\\\"></tr>\");\n    },\n\n    /** Handles onclick events */\n    _onclick: function _onclick(e) {\n        var old_value = this.value();\n        var new_value = $(e.target).closest(\"tr\").attr(\"id\");\n        if (new_value != \"\") {\n            if (new_value && old_value != new_value) {\n                if (this.options.onconfirm) {\n                    this.options.onconfirm(new_value);\n                } else {\n                    this.value(new_value);\n                }\n            }\n        }\n    },\n\n    /** Handles ondblclick events */\n    _ondblclick: function _ondblclick(e) {\n        var value = this.value();\n        if (value && this.options.ondblclick) {\n            this.options.ondblclick(value);\n        }\n    },\n\n    /** Refresh helper */\n    _refresh: function _refresh() {\n        if (this.row_count == 0) {\n            this.$tmessage.show();\n        } else {\n            this.$tmessage.hide();\n        }\n    },\n\n    /** Template */\n    _template: function _template() {\n        return \"<div><table class=\\\"\" + this.options.cls + \"\\\"><thead/><tbody/></table><tmessage>\" + this.options.content + \"</tmessage><div>\";\n    }\n}); /** This class creates a ui table element. */\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy91aS91aS10YWJsZS5qcz9lMjc2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBUaGlzIGNsYXNzIGNyZWF0ZXMgYSB1aSB0YWJsZSBlbGVtZW50LiAqL1xuaW1wb3J0IFV0aWxzIGZyb20gXCJ1dGlscy91dGlsc1wiO1xudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBVdGlscy5tZXJnZShvcHRpb25zLCB7XG4gICAgICAgICAgICBjb250ZW50OiBcIk5vIGNvbnRlbnQgYXZhaWxhYmxlLlwiLFxuICAgICAgICAgICAgb25jaGFuZ2U6IG51bGwsXG4gICAgICAgICAgICBvbmRibGNsaWNrOiBudWxsLFxuICAgICAgICAgICAgb25jb25maXJtOiBudWxsLFxuICAgICAgICAgICAgY2xzOiBcInVpLXRhYmxlXCIsXG4gICAgICAgICAgICBzZWxlY3RhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY2xzX3RyOiBcIlwiXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQodGhpcy5fdGVtcGxhdGUoKSk7XG4gICAgICAgIHRoaXMuJHRoZWFkID0gdGhpcy4kKFwidGhlYWRcIik7XG4gICAgICAgIHRoaXMuJHRib2R5ID0gdGhpcy4kKFwidGJvZHlcIik7XG4gICAgICAgIHRoaXMuJHRtZXNzYWdlID0gdGhpcy4kKFwidG1lc3NhZ2VcIik7XG4gICAgICAgIHRoaXMucm93ID0gdGhpcy5fcm93KCk7XG4gICAgICAgIHRoaXMucm93X2NvdW50ID0gMDtcbiAgICB9LFxuXG4gICAgZXZlbnRzOiB7XG4gICAgICAgIGNsaWNrOiBcIl9vbmNsaWNrXCIsXG4gICAgICAgIGRibGNsaWNrOiBcIl9vbmRibGNsaWNrXCJcbiAgICB9LFxuXG4gICAgLyoqIEFkZCBjZWxsIHRvIGhlYWRlciByb3cgKi9cbiAgICBhZGRIZWFkZXI6IGZ1bmN0aW9uKCRlbCkge1xuICAgICAgICB0aGlzLnJvdy5hcHBlbmQoJChcIjx0aC8+XCIpLmFwcGVuZCgkZWwpKTtcbiAgICB9LFxuXG4gICAgLyoqIEFwcGVuZCBoZWFkZXIgcm93IHRvIHRhYmxlICovXG4gICAgYXBwZW5kSGVhZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kdGhlYWQuYXBwZW5kKHRoaXMucm93KTtcbiAgICAgICAgdGhpcy5yb3cgPSAkKFwiPHRyLz5cIik7XG4gICAgfSxcblxuICAgIC8qKiBBZGQgY2VsbCB0byByb3cgKi9cbiAgICBhZGQ6IGZ1bmN0aW9uKCRlbCwgd2lkdGgsIGFsaWduKSB7XG4gICAgICAgIHZhciB3cmFwcGVyID0gJChcIjx0ZC8+XCIpO1xuICAgICAgICBpZiAod2lkdGgpIHtcbiAgICAgICAgICAgIHdyYXBwZXIuY3NzKFwid2lkdGhcIiwgd2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbGlnbikge1xuICAgICAgICAgICAgd3JhcHBlci5jc3MoXCJ0ZXh0LWFsaWduXCIsIGFsaWduKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvdy5hcHBlbmQod3JhcHBlci5hcHBlbmQoJGVsKSk7XG4gICAgfSxcblxuICAgIC8qKiBBcHBlbmQgcm93IHRvIHRhYmxlICovXG4gICAgYXBwZW5kOiBmdW5jdGlvbihpZCwgZmFkZSkge1xuICAgICAgICB0aGlzLl9jb21taXQoaWQsIGZhZGUsIGZhbHNlKTtcbiAgICB9LFxuXG4gICAgLyoqIFByZXBlbmQgcm93IHRvIHRhYmxlICovXG4gICAgcHJlcGVuZDogZnVuY3Rpb24oaWQsIGZhZGUpIHtcbiAgICAgICAgdGhpcy5fY29tbWl0KGlkLCBmYWRlLCB0cnVlKTtcbiAgICB9LFxuXG4gICAgLyoqIEhlbHBlciB0byBnZXQgcm93IGVsZW1lbnQgKi9cbiAgICBnZXQ6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiQoYCMke2lkfWApO1xuICAgIH0sXG5cbiAgICAvKiogRGVsZXRlIHJvdyBieSBpZCAqL1xuICAgIGRlbDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLiR0Ym9keS5maW5kKGAjJHtpZH1gKTtcbiAgICAgICAgaWYgKGl0ZW0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICAgIHRoaXMucm93X2NvdW50LS07XG4gICAgICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIERlbGV0ZSBhbGwgcm93cyAqL1xuICAgIGRlbEFsbDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJHRib2R5LmVtcHR5KCk7XG4gICAgICAgIHRoaXMucm93X2NvdW50ID0gMDtcbiAgICAgICAgdGhpcy5fcmVmcmVzaCgpO1xuICAgIH0sXG5cbiAgICAvKiogU2V0IGEgdmFsdWUgaS5lLiBzZWxlY3RzL2hpZ2hsaWdodHMgYSBwYXJ0aWN1bGFyIHJvdyBieSBpZCAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbihuZXdfdmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5zZWxlY3RhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZSA9IHRoaXMuJHRib2R5LmZpbmQoXCIuY3VycmVudFwiKS5hdHRyKFwiaWRcIik7XG4gICAgICAgICAgICBpZiAobmV3X3ZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiR0Ym9keS5maW5kKFwidHJcIikucmVtb3ZlQ2xhc3MoXCJjdXJyZW50XCIpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kdGJvZHkuZmluZChgIyR7bmV3X3ZhbHVlfWApLmFkZENsYXNzKFwiY3VycmVudFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYWZ0ZXIgPSB0aGlzLiR0Ym9keS5maW5kKFwiLmN1cnJlbnRcIikuYXR0cihcImlkXCIpO1xuICAgICAgICAgICAgaWYgKGFmdGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGFmdGVyICE9IHRoaXMuYmVmb3JlICYmIHRoaXMub3B0aW9ucy5vbmNoYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25jaGFuZ2UobmV3X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFmdGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBSZXR1cm4gdGhlIG51bWJlciBvZiByb3dzICovXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiR0Ym9keS5maW5kKFwidHJcIikubGVuZ3RoO1xuICAgIH0sXG5cbiAgICAvKiogSGVscGVyIHRvIGFwcGVuZCByb3dzICovXG4gICAgX2NvbW1pdDogZnVuY3Rpb24oaWQsIGZhZGUsIHByZXBlbmQpIHtcbiAgICAgICAgdGhpcy5kZWwoaWQpO1xuICAgICAgICB0aGlzLnJvdy5hdHRyKFwiaWRcIiwgaWQpO1xuICAgICAgICBpZiAocHJlcGVuZCkge1xuICAgICAgICAgICAgdGhpcy4kdGJvZHkucHJlcGVuZCh0aGlzLnJvdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiR0Ym9keS5hcHBlbmQodGhpcy5yb3cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmYWRlKSB7XG4gICAgICAgICAgICB0aGlzLnJvdy5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLnJvdy5mYWRlSW4oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJvdyA9IHRoaXMuX3JvdygpO1xuICAgICAgICB0aGlzLnJvd19jb3VudCsrO1xuICAgICAgICB0aGlzLl9yZWZyZXNoKCk7XG4gICAgfSxcblxuICAgIC8qKiBIZWxwZXIgdG8gY3JlYXRlIG5ldyByb3cgKi9cbiAgICBfcm93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICQoYDx0ciBjbGFzcz1cIiR7dGhpcy5vcHRpb25zLmNsc190cn1cIj48L3RyPmApO1xuICAgIH0sXG5cbiAgICAvKiogSGFuZGxlcyBvbmNsaWNrIGV2ZW50cyAqL1xuICAgIF9vbmNsaWNrOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBvbGRfdmFsdWUgPSB0aGlzLnZhbHVlKCk7XG4gICAgICAgIHZhciBuZXdfdmFsdWUgPSAkKGUudGFyZ2V0KVxuICAgICAgICAgICAgLmNsb3Nlc3QoXCJ0clwiKVxuICAgICAgICAgICAgLmF0dHIoXCJpZFwiKTtcbiAgICAgICAgaWYgKG5ld192YWx1ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAobmV3X3ZhbHVlICYmIG9sZF92YWx1ZSAhPSBuZXdfdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLm9uY29uZmlybSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25jb25maXJtKG5ld192YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZShuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogSGFuZGxlcyBvbmRibGNsaWNrIGV2ZW50cyAqL1xuICAgIF9vbmRibGNsaWNrOiBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKTtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMub3B0aW9ucy5vbmRibGNsaWNrKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25kYmxjbGljayh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqIFJlZnJlc2ggaGVscGVyICovXG4gICAgX3JlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5yb3dfY291bnQgPT0gMCkge1xuICAgICAgICAgICAgdGhpcy4kdG1lc3NhZ2Uuc2hvdygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kdG1lc3NhZ2UuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiBUZW1wbGF0ZSAqL1xuICAgIF90ZW1wbGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBgPGRpdj48dGFibGUgY2xhc3M9XCIke3RoaXMub3B0aW9ucy5jbHN9XCI+PHRoZWFkLz48dGJvZHkvPjwvdGFibGU+PHRtZXNzYWdlPiR7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMuY29udGVudFxuICAgICAgICB9PC90bWVzc2FnZT48ZGl2PmA7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy91aS91aS10YWJsZS5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFDQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUF4S0E7QUEyS0E7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///267\n");

/***/ }),
/* 268 */
/*!************************************************!*\
  !*** ./galaxy/scripts/mvc/grid/grid-shared.js ***!
  \************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _gridView = __webpack_require__(/*! mvc/grid/grid-view */ 26);\n\nvar _gridView2 = _interopRequireDefault(_gridView);\n\nvar _loadingIndicator = __webpack_require__(/*! ui/loading-indicator */ 36);\n\nvar _loadingIndicator2 = _interopRequireDefault(_loadingIndicator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** This class renders the grid list with shared section. */\nvar View = Backbone.View.extend({\n    initialize: function initialize(options) {\n        var self = this;\n        _loadingIndicator2.default.markViewAsLoading(this);\n        this.model = new Backbone.Model(options);\n        this.item = this.model.get(\"item\");\n        this.title = this.model.get(\"plural\");\n        $.ajax({\n            url: Galaxy.root + this.item + \"/\" + this.model.get(\"action_id\") + \"?\" + $.param(Galaxy.params),\n            success: function success(response) {\n                self.model.set(response);\n                self.render();\n            }\n        });\n    },\n\n    render: function render() {\n        var grid = new _gridView2.default(this.model.attributes);\n        this.$el.empty().append(grid.$el);\n        this.$el.append(this._templateShared());\n    },\n\n    _templateShared: function _templateShared() {\n        var self = this;\n        var $tmpl = $(\"<div><h2>\" + this.model.get(\"plural\") + \" shared with you by others</h2></div>\");\n        var options = this.model.attributes;\n        if (options.shared_by_others && options.shared_by_others.length > 0) {\n            var $table = $('<table class=\"colored\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">' + '<tr class=\"header\">' + \"<th>Title</th>\" + \"<th>Owner</th>\" + \"</tr>\" + \"</table>\");\n            _.each(options.shared_by_others, function (it, index) {\n                var display_url = Galaxy.root + self.item + \"/display_by_username_and_slug?username=\" + it.username + \"&slug=\" + it.slug;\n                $table.append(\"<tr><td><a href=\\\"\" + display_url + \"\\\">\" + _.escape(it.title) + \"</a></td><td>\" + _.escape(it.username) + \"</td></tr>\");\n            });\n            $tmpl.append($table);\n        } else {\n            $tmpl.append(\"No \" + this.model.get(\"plural\").toLowerCase() + \" have been shared with you.\");\n        }\n        return $tmpl;\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9ncmlkL2dyaWQtc2hhcmVkLmpzP2VlOTEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIFRoaXMgY2xhc3MgcmVuZGVycyB0aGUgZ3JpZCBsaXN0IHdpdGggc2hhcmVkIHNlY3Rpb24uICovXG5pbXBvcnQgR3JpZFZpZXcgZnJvbSBcIm12Yy9ncmlkL2dyaWQtdmlld1wiO1xuaW1wb3J0IExvYWRpbmdJbmRpY2F0b3IgZnJvbSBcInVpL2xvYWRpbmctaW5kaWNhdG9yXCI7XG5cbnZhciBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBMb2FkaW5nSW5kaWNhdG9yLm1hcmtWaWV3QXNMb2FkaW5nKHRoaXMpO1xuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEJhY2tib25lLk1vZGVsKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLml0ZW0gPSB0aGlzLm1vZGVsLmdldChcIml0ZW1cIik7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLm1vZGVsLmdldChcInBsdXJhbFwiKTtcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3QgKyB0aGlzLml0ZW19LyR7dGhpcy5tb2RlbC5nZXQoXCJhY3Rpb25faWRcIil9PyR7JC5wYXJhbShHYWxheHkucGFyYW1zKX1gLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm1vZGVsLnNldChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgc2VsZi5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBncmlkID0gbmV3IEdyaWRWaWV3KHRoaXMubW9kZWwuYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMuJGVsLmVtcHR5KCkuYXBwZW5kKGdyaWQuJGVsKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMuX3RlbXBsYXRlU2hhcmVkKCkpO1xuICAgIH0sXG5cbiAgICBfdGVtcGxhdGVTaGFyZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciAkdG1wbCA9ICQoYDxkaXY+PGgyPiR7dGhpcy5tb2RlbC5nZXQoXCJwbHVyYWxcIil9IHNoYXJlZCB3aXRoIHlvdSBieSBvdGhlcnM8L2gyPjwvZGl2PmApO1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHRoaXMubW9kZWwuYXR0cmlidXRlcztcbiAgICAgICAgaWYgKG9wdGlvbnMuc2hhcmVkX2J5X290aGVycyAmJiBvcHRpb25zLnNoYXJlZF9ieV9vdGhlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyICR0YWJsZSA9ICQoXG4gICAgICAgICAgICAgICAgJzx0YWJsZSBjbGFzcz1cImNvbG9yZWRcIiBib3JkZXI9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgY2VsbHBhZGRpbmc9XCIwXCIgd2lkdGg9XCIxMDAlXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICc8dHIgY2xhc3M9XCJoZWFkZXJcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgXCI8dGg+VGl0bGU8L3RoPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8dGg+T3duZXI8L3RoPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8L3RyPlwiICtcbiAgICAgICAgICAgICAgICAgICAgXCI8L3RhYmxlPlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXy5lYWNoKG9wdGlvbnMuc2hhcmVkX2J5X290aGVycywgKGl0LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBkaXNwbGF5X3VybCA9IGAke0dhbGF4eS5yb290ICsgc2VsZi5pdGVtfS9kaXNwbGF5X2J5X3VzZXJuYW1lX2FuZF9zbHVnP3VzZXJuYW1lPSR7XG4gICAgICAgICAgICAgICAgICAgIGl0LnVzZXJuYW1lXG4gICAgICAgICAgICAgICAgfSZzbHVnPSR7aXQuc2x1Z31gO1xuICAgICAgICAgICAgICAgICR0YWJsZS5hcHBlbmQoXG4gICAgICAgICAgICAgICAgICAgIGA8dHI+PHRkPjxhIGhyZWY9XCIke2Rpc3BsYXlfdXJsfVwiPiR7Xy5lc2NhcGUoaXQudGl0bGUpfTwvYT48L3RkPjx0ZD4ke18uZXNjYXBlKFxuICAgICAgICAgICAgICAgICAgICAgICAgaXQudXNlcm5hbWVcbiAgICAgICAgICAgICAgICAgICAgKX08L3RkPjwvdHI+YFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICR0bXBsLmFwcGVuZCgkdGFibGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHRtcGwuYXBwZW5kKGBObyAke3RoaXMubW9kZWwuZ2V0KFwicGx1cmFsXCIpLnRvTG93ZXJDYXNlKCl9IGhhdmUgYmVlbiBzaGFyZWQgd2l0aCB5b3UuYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICR0bXBsO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVmlldzogVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvZ3JpZC9ncmlkLXNoYXJlZC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFIQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUdBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFsREE7QUFDQTtBQW9EQTtBQUNBO0FBREE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///268\n");

/***/ }),
/* 269 */
/*!*************************************************!*\
  !*** ./galaxy/scripts/mvc/workflow/workflow.js ***!
  \*************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toastr = __webpack_require__(/*! libs/toastr */ 7);\n\nvar mod_toastr = _interopRequireWildcard(_toastr);\n\nvar _tag = __webpack_require__(/*! mvc/tag */ 23);\n\nvar _tag2 = _interopRequireDefault(_tag);\n\nvar _workflowModel = __webpack_require__(/*! mvc/workflow/workflow-model */ 270);\n\nvar _workflowModel2 = _interopRequireDefault(_workflowModel);\n\nvar _queryStringParsing = __webpack_require__(/*! utils/query-string-parsing */ 27);\n\nvar _queryStringParsing2 = _interopRequireDefault(_queryStringParsing);\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _loadingIndicator = __webpack_require__(/*! ui/loading-indicator */ 36);\n\nvar _loadingIndicator2 = _interopRequireDefault(_loadingIndicator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/** View of the individual workflows */\n/** Workflow view */\nvar WorkflowItemView = Backbone.View.extend({\n    tagName: \"tr\", // name of (orphan) root tag in this.el\n    initialize: function initialize() {\n        _.bindAll(this, \"render\", \"_rowTemplate\", \"renderTagEditor\", \"_templateActions\", \"removeWorkflow\", \"copyWorkflow\"); // every function that uses 'this' as the current object should be in here\n        mod_toastr.options.timeOut = 1500;\n    },\n\n    events: {\n        \"click #show-in-tool-panel\": \"showInToolPanel\",\n        \"click #delete-workflow\": \"removeWorkflow\",\n        \"click #rename-workflow\": \"renameWorkflow\",\n        \"click #copy-workflow\": \"copyWorkflow\"\n    },\n\n    render: function render() {\n        $(this.el).html(this._rowTemplate());\n        return this;\n    },\n\n    showInToolPanel: function showInToolPanel() {\n        // This reloads the whole page, so that the workflow appears in the tool panel.\n        // Ideally we would notify only the tool panel of a change\n        this.model.save({ show_in_tool_panel: !this.model.get(\"show_in_tool_panel\") }, {\n            success: function success() {\n                window.location = Galaxy.root + \"workflows/list\";\n            }\n        });\n    },\n\n    removeWorkflow: function removeWorkflow() {\n        var wfName = this.model.get(\"name\");\n        if (window.confirm(\"Are you sure you want to delete workflow '\" + wfName + \"'?\")) {\n            this.model.destroy({\n                success: function success() {\n                    mod_toastr.success(\"Successfully deleted workflow '\" + wfName + \"'\");\n                }\n            });\n            this.remove();\n        }\n    },\n\n    renameWorkflow: function renameWorkflow() {\n        var oldName = this.model.get(\"name\");\n        var newName = window.prompt(\"Enter a new Name for workflow '\" + oldName + \"'\", oldName);\n        if (newName) {\n            this.model.save({ name: newName }, {\n                success: function success() {\n                    mod_toastr.success(\"Successfully renamed workflow '\" + oldName + \"' to '\" + newName + \"'\");\n                }\n            });\n            this.render();\n        }\n    },\n\n    copyWorkflow: function copyWorkflow() {\n        var _this = this;\n\n        var oldName = this.model.get(\"name\");\n        $.getJSON(this.model.urlRoot + \"/\" + this.model.id + \"/download\", function (wfJson) {\n            var newName = \"Copy of \" + oldName;\n            var currentOwner = _this.model.get(\"owner\");\n            if (currentOwner != Galaxy.user.attributes.username) {\n                newName += \" shared by user \" + currentOwner;\n            }\n            wfJson.name = newName;\n            _this.collection.create(wfJson, {\n                at: 0,\n                wait: true,\n                success: function success() {\n                    mod_toastr.success(\"Successfully copied workflow '\" + oldName + \"' to '\" + newName + \"'\");\n                },\n                error: function error(model, resp, options) {\n                    // signature seems to have changed over the course of backbone dev\n                    // see https://github.com/jashkenas/backbone/issues/2606#issuecomment-19289483\n                    mod_toastr.error(options.errorThrown);\n                }\n            });\n        }).error(function (jqXHR, textStatus, errorThrown) {\n            mod_toastr.error(jqXHR.responseJSON.err_msg);\n        });\n    },\n\n    _rowTemplate: function _rowTemplate() {\n        var show = this.model.get(\"show_in_tool_panel\");\n        var wfId = this.model.id;\n        var checkboxHtml = \"<input id=\\\"show-in-tool-panel\\\" type=\\\"checkbox\\\" class=\\\"show-in-tool-panel\\\" \" + (show ? \"checked=\\\"\" + show + \"\\\"\" : \"\") + \" value=\\\"\" + wfId + \"\\\">\";\n        var trHtml = \"<td><div class=\\\"dropdown\\\"><button class=\\\"menubutton\\\" type=\\\"button\\\" data-toggle=\\\"dropdown\\\">\" + _.escape(this.model.get(\"name\")) + \"<span class=\\\"caret\\\"></span></button>\" + this._templateActions() + \"</div></td><td><span><div class=\\\"\" + wfId + \" tags-display\\\"></div></td><td>\" + (this.model.get(\"owner\") === Galaxy.user.attributes.username ? \"You\" : this.model.get(\"owner\")) + \"</span></td><td>\" + this.model.get(\"number_of_steps\") + \"</td><td>\" + (this.model.get(\"published\") ? \"Yes\" : \"No\") + \"</td><td>\" + checkboxHtml + \"</td>\";\n        return trHtml;\n    },\n\n    renderTagEditor: function renderTagEditor() {\n        var TagEditor = new _tag2.default.TagsEditor({\n            model: this.model,\n            el: $.find(\".\" + this.model.id + \".tags-display\"),\n            workflow_mode: true\n        });\n        TagEditor.toggle(true);\n        TagEditor.render();\n    },\n\n    /** Template for user actions for workflows */\n    _templateActions: function _templateActions() {\n        if (this.model.get(\"owner\") === Galaxy.user.attributes.username) {\n            return \"<ul class=\\\"dropdown-menu action-dpd\\\"><li><a href=\\\"\" + Galaxy.root + \"workflow/editor?id=\" + this.model.id + \"\\\">Edit</a></li><li><a href=\\\"\" + Galaxy.root + \"workflows/run?id=\" + this.model.id + \"\\\">Run</a></li><li><a href=\\\"\" + Galaxy.root + \"workflow/sharing?id=\" + this.model.id + \"\\\">Share</a></li><li><a href=\\\"\" + Galaxy.root + \"api/workflows/\" + this.model.id + \"/download?format=json-download\\\">Download</a></li><li><a id=\\\"copy-workflow\\\" style=\\\"cursor: pointer;\\\">Copy</a></li><li><a id=\\\"rename-workflow\\\" style=\\\"cursor: pointer;\\\">Rename</a></li><li><a href=\\\"\" + Galaxy.root + \"workflow/display_by_id?id=\" + this.model.id + \"\\\">View</a></li><li><a id=\\\"delete-workflow\\\" style=\\\"cursor: pointer;\\\">Delete</a></li></ul>\";\n        } else {\n            return \"<ul class=\\\"dropdown-menu action-dpd\\\"><li><a href=\\\"\" + Galaxy.root + \"workflow/display_by_username_and_slug?username=\" + this.model.get(\"owner\") + \"&slug=\" + this.model.get(\"slug\") + \"\\\">View</a></li><li><a href=\\\"\" + Galaxy.root + \"workflows/run?id=\" + this.model.id + \"\\\">Run</a></li><li><a id=\\\"copy-workflow\\\" style=\\\"cursor: pointer;\\\">Copy</a></li><li><a class=\\\"link-confirm-shared-\" + this.model.id + \"\\\" href=\\\"\" + Galaxy.root + \"workflow/sharing?unshare_me=True&id=\" + this.model.id + \"\\\">Remove</a></li></ul>\";\n        }\n    }\n});\n\n/** View of the main workflow list page */\nvar WorkflowListView = Backbone.View.extend({\n    title: (0, _localization2.default)(\"Workflows\"),\n    initialize: function initialize() {\n        _loadingIndicator2.default.markViewAsLoading(this);\n        _.bindAll(this, \"adjustActiondropdown\");\n        this.collection = new _workflowModel2.default.WorkflowCollection();\n        this.collection.fetch().done(this.render());\n        this.collection.bind(\"add\", this.appendItem);\n        this.collection.on(\"sync\", this.render, this);\n    },\n\n    events: {\n        dragleave: \"unhighlightDropZone\",\n        drop: \"drop\",\n        dragover: function dragover(ev) {\n            $(\".hidden_description_layer\").addClass(\"dragover\");\n            $(\".menubutton\").addClass(\"background-none\");\n            ev.preventDefault();\n        }\n    },\n\n    unhighlightDropZone: function unhighlightDropZone() {\n        $(\".hidden_description_layer\").removeClass(\"dragover\");\n        $(\".menubutton\").removeClass(\"background-none\");\n    },\n\n    drop: function drop(e) {\n        // TODO: check that file is valid galaxy workflow\n        this.unhighlightDropZone();\n        e.preventDefault();\n        var files = e.dataTransfer.files;\n        for (var i = 0, f; f = files[i]; i++) {\n            this.readWorkflowFiles(f);\n        }\n    },\n\n    readWorkflowFiles: function readWorkflowFiles(f) {\n        var _this2 = this;\n\n        var reader = new FileReader();\n        reader.onload = function (theFile) {\n            var wf_json = void 0;\n            try {\n                wf_json = JSON.parse(reader.result);\n            } catch (e) {\n                mod_toastr.error(\"Could not read file '\" + f.name + \"'. Verify it is a valid Galaxy workflow\");\n                wf_json = null;\n            }\n            if (wf_json) {\n                _this2.collection.create(wf_json, {\n                    at: 0,\n                    wait: true,\n                    success: function success() {\n                        mod_toastr.success(\"Successfully imported workflow '\" + wf_json.name + \"'\");\n                    },\n                    error: function error(model, resp, options) {\n                        mod_toastr.error(options.errorThrown);\n                    }\n                });\n            }\n        };\n        reader.readAsText(f, \"utf-8\");\n    },\n\n    _showArgErrors: _.once(function () {\n        // Parse args out of params, display if there's a message.\n        var msg_text = _queryStringParsing2.default.get(\"message\");\n        var msg_status = _queryStringParsing2.default.get(\"status\");\n        if (msg_status === \"error\") {\n            mod_toastr.error(_.escape(msg_text || \"Unknown Error, please report this to an administrator.\"));\n        } else if (msg_text) {\n            mod_toastr.info(_.escape(msg_text));\n        }\n    }),\n\n    render: function render() {\n        var _this3 = this;\n\n        // Add workflow header\n        var header = this._templateHeader();\n        // Add the actions buttons\n        var templateActions = this._templateActionButtons();\n        var tableTemplate = this._templateWorkflowTable();\n        this.$el.html(header + templateActions + tableTemplate);\n        _(this.collection.models).each(function (item) {\n            // in case collection is not empty\n            _this3.appendItem(item);\n            _this3.confirmDelete(item);\n        }, this);\n        var minQueryLength = 3;\n        this.searchWorkflow(this.$(\".search-wf\"), this.$(\".workflow-search tr\"), minQueryLength);\n        this.adjustActiondropdown();\n        this._showArgErrors();\n        return this;\n    },\n\n    appendItem: function appendItem(item) {\n        var workflowItemView = new WorkflowItemView({\n            model: item,\n            collection: this.collection\n        });\n        $(\".workflow-search\").append(workflowItemView.render().el);\n        workflowItemView.renderTagEditor();\n    },\n\n    /** Add confirm box before removing/unsharing workflow */\n    confirmDelete: function confirmDelete(workflow) {\n        var $el_shared_wf_link = this.$(\".link-confirm-shared-\" + workflow.id);\n        $el_shared_wf_link.click(function () {\n            return window.confirm(\"Are you sure you want to remove the shared workflow '\" + workflow.attributes.name + \"'?\");\n        });\n    },\n\n    /** Implement client side workflow search/filtering */\n    searchWorkflow: function searchWorkflow($el_searchinput, $el_tabletr, min_querylen) {\n        $el_searchinput.on(\"keyup\", function () {\n            var query = $(this).val();\n            // Filter when query is at least 3 characters\n            // otherwise show all rows\n            if (query.length >= min_querylen) {\n                // Ignore the query's case using 'i'\n                var regular_expression = new RegExp(query, \"i\");\n                $el_tabletr.hide();\n                $el_tabletr.filter(function () {\n                    // Apply regular expression on each row's text\n                    // and show when there is a match\n                    return regular_expression.test($(this).text());\n                }).show();\n            } else {\n                $el_tabletr.show();\n            }\n        });\n    },\n\n    /** Ajust the position of dropdown with respect to table */\n    adjustActiondropdown: function adjustActiondropdown() {\n        $(this.el).on(\"show.bs.dropdown\", function () {\n            $(this.el).css(\"overflow\", \"inherit\");\n        });\n        $(this.el).on(\"hide.bs.dropdown\", function () {\n            $(this.el).css(\"overflow\", \"auto\");\n        });\n    },\n\n    /** Template for no workflow */\n    _templateNoWorkflow: function _templateNoWorkflow() {\n        return '<div class=\"wf-nodata\"> You have no workflows. </div>';\n    },\n\n    /** Template for actions buttons */\n    _templateActionButtons: function _templateActionButtons() {\n        return \"<ul class=\\\"manage-table-actions\\\"><li><input class=\\\"search-wf form-control\\\" type=\\\"text\\\" autocomplete=\\\"off\\\" placeholder=\\\"search for workflow...\\\"></li><li><a class=\\\"action-button fa fa-plus wf-action\\\" id=\\\"new-workflow\\\" title=\\\"Create new workflow\\\" href=\\\"\" + Galaxy.root + \"workflows/create\\\"></a></li><li><a class=\\\"action-button fa fa-upload wf-action\\\" id=\\\"import-workflow\\\" title=\\\"Upload or import workflow\\\" href=\\\"\" + Galaxy.root + \"workflows/import_workflow\\\"></a></li></ul>\";\n    },\n\n    /** Template for workflow table */\n    _templateWorkflowTable: function _templateWorkflowTable() {\n        var tableHtml = '<table class=\"table colored\"><thead>' + '<tr class=\"header\">' + \"<th>Name</th>\" + \"<th>Tags</th>\" + \"<th>Owner</th>\" + \"<th># of Steps</th>\" + \"<th>Published</th>\" + \"<th>Show in tools panel</th>\" + \"</tr></thead>\";\n        return tableHtml + \"<tbody class=\\\"workflow-search \\\"><div class=\\\"hidden_description_layer\\\"><p>Drop workflow files here to import</p></tbody></table></div>\";\n    },\n\n    /** Main template */\n    _templateHeader: function _templateHeader() {\n        return '<div class=\"page-container\">' + '<div class=\"user-workflows wf\">' + '<div class=\"response-message\"></div>' + \"<h2>\" + (0, _localization2.default)(\"Your workflows\") + \"</h2>\" + \"</div>\" + \"</div>\";\n    }\n});\n\nvar ImportWorkflowView = Backbone.View.extend({\n    initialize: function initialize() {\n        this.setElement(\"<div/>\");\n        this.render();\n    },\n\n    /** Open page to import workflow */\n    render: function render() {\n        var _this4 = this;\n\n        $.getJSON(Galaxy.root + \"workflow/upload_import_workflow\", function (options) {\n            _this4.$el.empty().append(_this4._mainTemplate(options));\n        });\n    },\n\n    /** Template for the import workflow page */\n    _mainTemplate: function _mainTemplate(options) {\n        return \"<div class='toolForm'><div class='toolFormTitle'>Import Galaxy workflow</div><div class='toolFormBody'><form name='import_workflow' id='import_workflow' action='\" + Galaxy.root + \"workflow/upload_import_workflow' enctype='multipart/form-data' method='POST'><div class='form-row'><label>Galaxy workflow URL:</label><input type='text' name='url' class='input-url' value='\" + options.url + \"' size='40'><div class='toolParamHelp' style='clear: both;'>If the workflow is accessible via a URL, enter the URL above and click <b>Import</b>.</div><div style='clear: both'></div></div><div class='form-row'><label>Galaxy workflow file:</label><div class='form-row-input'><input type='file' name='file_data' class='input-file'/></div><div class='toolParamHelp' style='clear: both;'>If the workflow is in a file on your computer, choose it and then click <b>Import</b>.</div><div style='clear: both'></div></div><div class='form-row'><input type='submit' class='primary-button wf-import' name='import_button' value='Import'></div></form><hr/><div class='form-row'><label>Import a Galaxy workflow from myExperiment:</label><div class='form-row-input'><a href='\" + options.myexperiment_target_url + \"'> Visit myExperiment</a></div><div class='toolParamHelp' style='clear: both;'>Click the link above to visit myExperiment and browse for Galaxy workflows.</div><div style='clear: both'></div></div></div></div>\";\n    }\n});\n\nexports.default = {\n    View: WorkflowListView,\n    ImportWorkflowView: ImportWorkflowView\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjY5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy93b3JrZmxvdy93b3JrZmxvdy5qcz82ODE1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBXb3JrZmxvdyB2aWV3ICovXG5pbXBvcnQgKiBhcyBtb2RfdG9hc3RyIGZyb20gXCJsaWJzL3RvYXN0clwiO1xuaW1wb3J0IFRBR1MgZnJvbSBcIm12Yy90YWdcIjtcbmltcG9ydCBXT1JLRkxPV1MgZnJvbSBcIm12Yy93b3JrZmxvdy93b3JrZmxvdy1tb2RlbFwiO1xuaW1wb3J0IFF1ZXJ5U3RyaW5nUGFyc2luZyBmcm9tIFwidXRpbHMvcXVlcnktc3RyaW5nLXBhcnNpbmdcIjtcbmltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5pbXBvcnQgTG9hZGluZ0luZGljYXRvciBmcm9tIFwidWkvbG9hZGluZy1pbmRpY2F0b3JcIjtcblxuLyoqIFZpZXcgb2YgdGhlIGluZGl2aWR1YWwgd29ya2Zsb3dzICovXG5jb25zdCBXb3JrZmxvd0l0ZW1WaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIHRhZ05hbWU6IFwidHJcIiwgLy8gbmFtZSBvZiAob3JwaGFuKSByb290IHRhZyBpbiB0aGlzLmVsXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIF8uYmluZEFsbChcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBcInJlbmRlclwiLFxuICAgICAgICAgICAgXCJfcm93VGVtcGxhdGVcIixcbiAgICAgICAgICAgIFwicmVuZGVyVGFnRWRpdG9yXCIsXG4gICAgICAgICAgICBcIl90ZW1wbGF0ZUFjdGlvbnNcIixcbiAgICAgICAgICAgIFwicmVtb3ZlV29ya2Zsb3dcIixcbiAgICAgICAgICAgIFwiY29weVdvcmtmbG93XCJcbiAgICAgICAgKTsgLy8gZXZlcnkgZnVuY3Rpb24gdGhhdCB1c2VzICd0aGlzJyBhcyB0aGUgY3VycmVudCBvYmplY3Qgc2hvdWxkIGJlIGluIGhlcmVcbiAgICAgICAgbW9kX3RvYXN0ci5vcHRpb25zLnRpbWVPdXQgPSAxNTAwO1xuICAgIH0sXG5cbiAgICBldmVudHM6IHtcbiAgICAgICAgXCJjbGljayAjc2hvdy1pbi10b29sLXBhbmVsXCI6IFwic2hvd0luVG9vbFBhbmVsXCIsXG4gICAgICAgIFwiY2xpY2sgI2RlbGV0ZS13b3JrZmxvd1wiOiBcInJlbW92ZVdvcmtmbG93XCIsXG4gICAgICAgIFwiY2xpY2sgI3JlbmFtZS13b3JrZmxvd1wiOiBcInJlbmFtZVdvcmtmbG93XCIsXG4gICAgICAgIFwiY2xpY2sgI2NvcHktd29ya2Zsb3dcIjogXCJjb3B5V29ya2Zsb3dcIlxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICAkKHRoaXMuZWwpLmh0bWwodGhpcy5fcm93VGVtcGxhdGUoKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICBzaG93SW5Ub29sUGFuZWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUaGlzIHJlbG9hZHMgdGhlIHdob2xlIHBhZ2UsIHNvIHRoYXQgdGhlIHdvcmtmbG93IGFwcGVhcnMgaW4gdGhlIHRvb2wgcGFuZWwuXG4gICAgICAgIC8vIElkZWFsbHkgd2Ugd291bGQgbm90aWZ5IG9ubHkgdGhlIHRvb2wgcGFuZWwgb2YgYSBjaGFuZ2VcbiAgICAgICAgdGhpcy5tb2RlbC5zYXZlKFxuICAgICAgICAgICAgeyBzaG93X2luX3Rvb2xfcGFuZWw6ICF0aGlzLm1vZGVsLmdldChcInNob3dfaW5fdG9vbF9wYW5lbFwiKSB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBgJHtHYWxheHkucm9vdH13b3JrZmxvd3MvbGlzdGA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH0sXG5cbiAgICByZW1vdmVXb3JrZmxvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IHdmTmFtZSA9IHRoaXMubW9kZWwuZ2V0KFwibmFtZVwiKTtcbiAgICAgICAgaWYgKHdpbmRvdy5jb25maXJtKGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHdvcmtmbG93ICcke3dmTmFtZX0nP2ApKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmRlc3Ryb3koe1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RfdG9hc3RyLnN1Y2Nlc3MoYFN1Y2Nlc3NmdWxseSBkZWxldGVkIHdvcmtmbG93ICcke3dmTmFtZX0nYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbmFtZVdvcmtmbG93OiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3Qgb2xkTmFtZSA9IHRoaXMubW9kZWwuZ2V0KFwibmFtZVwiKTtcbiAgICAgICAgY29uc3QgbmV3TmFtZSA9IHdpbmRvdy5wcm9tcHQoYEVudGVyIGEgbmV3IE5hbWUgZm9yIHdvcmtmbG93ICcke29sZE5hbWV9J2AsIG9sZE5hbWUpO1xuICAgICAgICBpZiAobmV3TmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5zYXZlKFxuICAgICAgICAgICAgICAgIHsgbmFtZTogbmV3TmFtZSB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RfdG9hc3RyLnN1Y2Nlc3MoYFN1Y2Nlc3NmdWxseSByZW5hbWVkIHdvcmtmbG93ICcke29sZE5hbWV9JyB0byAnJHtuZXdOYW1lfSdgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNvcHlXb3JrZmxvdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IG9sZE5hbWUgPSB0aGlzLm1vZGVsLmdldChcIm5hbWVcIik7XG4gICAgICAgICQuZ2V0SlNPTihgJHt0aGlzLm1vZGVsLnVybFJvb3R9LyR7dGhpcy5tb2RlbC5pZH0vZG93bmxvYWRgLCB3Zkpzb24gPT4ge1xuICAgICAgICAgICAgbGV0IG5ld05hbWUgPSBgQ29weSBvZiAke29sZE5hbWV9YDtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRPd25lciA9IHRoaXMubW9kZWwuZ2V0KFwib3duZXJcIik7XG4gICAgICAgICAgICBpZiAoY3VycmVudE93bmVyICE9IEdhbGF4eS51c2VyLmF0dHJpYnV0ZXMudXNlcm5hbWUpIHtcbiAgICAgICAgICAgICAgICBuZXdOYW1lICs9IGAgc2hhcmVkIGJ5IHVzZXIgJHtjdXJyZW50T3duZXJ9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdmSnNvbi5uYW1lID0gbmV3TmFtZTtcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbi5jcmVhdGUod2ZKc29uLCB7XG4gICAgICAgICAgICAgICAgYXQ6IDAsXG4gICAgICAgICAgICAgICAgd2FpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kX3RvYXN0ci5zdWNjZXNzKGBTdWNjZXNzZnVsbHkgY29waWVkIHdvcmtmbG93ICcke29sZE5hbWV9JyB0byAnJHtuZXdOYW1lfSdgKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihtb2RlbCwgcmVzcCwgb3B0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICAvLyBzaWduYXR1cmUgc2VlbXMgdG8gaGF2ZSBjaGFuZ2VkIG92ZXIgdGhlIGNvdXJzZSBvZiBiYWNrYm9uZSBkZXZcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qYXNoa2VuYXMvYmFja2JvbmUvaXNzdWVzLzI2MDYjaXNzdWVjb21tZW50LTE5Mjg5NDgzXG4gICAgICAgICAgICAgICAgICAgIG1vZF90b2FzdHIuZXJyb3Iob3B0aW9ucy5lcnJvclRocm93bik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLmVycm9yKChqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pID0+IHtcbiAgICAgICAgICAgIG1vZF90b2FzdHIuZXJyb3IoanFYSFIucmVzcG9uc2VKU09OLmVycl9tc2cpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgX3Jvd1RlbXBsYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IHNob3cgPSB0aGlzLm1vZGVsLmdldChcInNob3dfaW5fdG9vbF9wYW5lbFwiKTtcbiAgICAgICAgbGV0IHdmSWQgPSB0aGlzLm1vZGVsLmlkO1xuICAgICAgICBjb25zdCBjaGVja2JveEh0bWwgPSBgPGlucHV0IGlkPVwic2hvdy1pbi10b29sLXBhbmVsXCIgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJzaG93LWluLXRvb2wtcGFuZWxcIiAke1xuICAgICAgICAgICAgc2hvdyA/IGBjaGVja2VkPVwiJHtzaG93fVwiYCA6IFwiXCJcbiAgICAgICAgfSB2YWx1ZT1cIiR7d2ZJZH1cIj5gO1xuICAgICAgICBjb25zdCB0ckh0bWwgPSBgPHRkPjxkaXYgY2xhc3M9XCJkcm9wZG93blwiPjxidXR0b24gY2xhc3M9XCJtZW51YnV0dG9uXCIgdHlwZT1cImJ1dHRvblwiIGRhdGEtdG9nZ2xlPVwiZHJvcGRvd25cIj4ke18uZXNjYXBlKFxuICAgICAgICAgICAgdGhpcy5tb2RlbC5nZXQoXCJuYW1lXCIpXG4gICAgICAgICl9PHNwYW4gY2xhc3M9XCJjYXJldFwiPjwvc3Bhbj48L2J1dHRvbj4ke3RoaXMuX3RlbXBsYXRlQWN0aW9ucygpfTwvZGl2PjwvdGQ+PHRkPjxzcGFuPjxkaXYgY2xhc3M9XCIke3dmSWR9IHRhZ3MtZGlzcGxheVwiPjwvZGl2PjwvdGQ+PHRkPiR7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmdldChcIm93bmVyXCIpID09PSBHYWxheHkudXNlci5hdHRyaWJ1dGVzLnVzZXJuYW1lID8gXCJZb3VcIiA6IHRoaXMubW9kZWwuZ2V0KFwib3duZXJcIilcbiAgICAgICAgfTwvc3Bhbj48L3RkPjx0ZD4ke3RoaXMubW9kZWwuZ2V0KFwibnVtYmVyX29mX3N0ZXBzXCIpfTwvdGQ+PHRkPiR7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmdldChcInB1Ymxpc2hlZFwiKSA/IFwiWWVzXCIgOiBcIk5vXCJcbiAgICAgICAgfTwvdGQ+PHRkPiR7Y2hlY2tib3hIdG1sfTwvdGQ+YDtcbiAgICAgICAgcmV0dXJuIHRySHRtbDtcbiAgICB9LFxuXG4gICAgcmVuZGVyVGFnRWRpdG9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3QgVGFnRWRpdG9yID0gbmV3IFRBR1MuVGFnc0VkaXRvcih7XG4gICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcbiAgICAgICAgICAgIGVsOiAkLmZpbmQoYC4ke3RoaXMubW9kZWwuaWR9LnRhZ3MtZGlzcGxheWApLFxuICAgICAgICAgICAgd29ya2Zsb3dfbW9kZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgVGFnRWRpdG9yLnRvZ2dsZSh0cnVlKTtcbiAgICAgICAgVGFnRWRpdG9yLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgZm9yIHVzZXIgYWN0aW9ucyBmb3Igd29ya2Zsb3dzICovXG4gICAgX3RlbXBsYXRlQWN0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLm1vZGVsLmdldChcIm93bmVyXCIpID09PSBHYWxheHkudXNlci5hdHRyaWJ1dGVzLnVzZXJuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gYDx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnUgYWN0aW9uLWRwZFwiPjxsaT48YSBocmVmPVwiJHtHYWxheHkucm9vdH13b3JrZmxvdy9lZGl0b3I/aWQ9JHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmlkXG4gICAgICAgICAgICB9XCI+RWRpdDwvYT48L2xpPjxsaT48YSBocmVmPVwiJHtHYWxheHkucm9vdH13b3JrZmxvd3MvcnVuP2lkPSR7dGhpcy5tb2RlbC5pZH1cIj5SdW48L2E+PC9saT48bGk+PGEgaHJlZj1cIiR7XG4gICAgICAgICAgICAgICAgR2FsYXh5LnJvb3RcbiAgICAgICAgICAgIH13b3JrZmxvdy9zaGFyaW5nP2lkPSR7dGhpcy5tb2RlbC5pZH1cIj5TaGFyZTwvYT48L2xpPjxsaT48YSBocmVmPVwiJHtHYWxheHkucm9vdH1hcGkvd29ya2Zsb3dzLyR7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5pZFxuICAgICAgICAgICAgfS9kb3dubG9hZD9mb3JtYXQ9anNvbi1kb3dubG9hZFwiPkRvd25sb2FkPC9hPjwvbGk+PGxpPjxhIGlkPVwiY29weS13b3JrZmxvd1wiIHN0eWxlPVwiY3Vyc29yOiBwb2ludGVyO1wiPkNvcHk8L2E+PC9saT48bGk+PGEgaWQ9XCJyZW5hbWUtd29ya2Zsb3dcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjtcIj5SZW5hbWU8L2E+PC9saT48bGk+PGEgaHJlZj1cIiR7XG4gICAgICAgICAgICAgICAgR2FsYXh5LnJvb3RcbiAgICAgICAgICAgIH13b3JrZmxvdy9kaXNwbGF5X2J5X2lkP2lkPSR7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5pZFxuICAgICAgICAgICAgfVwiPlZpZXc8L2E+PC9saT48bGk+PGEgaWQ9XCJkZWxldGUtd29ya2Zsb3dcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjtcIj5EZWxldGU8L2E+PC9saT48L3VsPmA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gYDx1bCBjbGFzcz1cImRyb3Bkb3duLW1lbnUgYWN0aW9uLWRwZFwiPjxsaT48YSBocmVmPVwiJHtcbiAgICAgICAgICAgICAgICBHYWxheHkucm9vdFxuICAgICAgICAgICAgfXdvcmtmbG93L2Rpc3BsYXlfYnlfdXNlcm5hbWVfYW5kX3NsdWc/dXNlcm5hbWU9JHt0aGlzLm1vZGVsLmdldChcIm93bmVyXCIpfSZzbHVnPSR7dGhpcy5tb2RlbC5nZXQoXG4gICAgICAgICAgICAgICAgXCJzbHVnXCJcbiAgICAgICAgICAgICl9XCI+VmlldzwvYT48L2xpPjxsaT48YSBocmVmPVwiJHtHYWxheHkucm9vdH13b3JrZmxvd3MvcnVuP2lkPSR7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5pZFxuICAgICAgICAgICAgfVwiPlJ1bjwvYT48L2xpPjxsaT48YSBpZD1cImNvcHktd29ya2Zsb3dcIiBzdHlsZT1cImN1cnNvcjogcG9pbnRlcjtcIj5Db3B5PC9hPjwvbGk+PGxpPjxhIGNsYXNzPVwibGluay1jb25maXJtLXNoYXJlZC0ke1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuaWRcbiAgICAgICAgICAgIH1cIiBocmVmPVwiJHtHYWxheHkucm9vdH13b3JrZmxvdy9zaGFyaW5nP3Vuc2hhcmVfbWU9VHJ1ZSZpZD0ke3RoaXMubW9kZWwuaWR9XCI+UmVtb3ZlPC9hPjwvbGk+PC91bD5gO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cbi8qKiBWaWV3IG9mIHRoZSBtYWluIHdvcmtmbG93IGxpc3QgcGFnZSAqL1xuY29uc3QgV29ya2Zsb3dMaXN0VmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICB0aXRsZTogX2woXCJXb3JrZmxvd3NcIiksXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIExvYWRpbmdJbmRpY2F0b3IubWFya1ZpZXdBc0xvYWRpbmcodGhpcyk7XG4gICAgICAgIF8uYmluZEFsbCh0aGlzLCBcImFkanVzdEFjdGlvbmRyb3Bkb3duXCIpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBuZXcgV09SS0ZMT1dTLldvcmtmbG93Q29sbGVjdGlvbigpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uZmV0Y2goKS5kb25lKHRoaXMucmVuZGVyKCkpO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24uYmluZChcImFkZFwiLCB0aGlzLmFwcGVuZEl0ZW0pO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24ub24oXCJzeW5jXCIsIHRoaXMucmVuZGVyLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgZXZlbnRzOiB7XG4gICAgICAgIGRyYWdsZWF2ZTogXCJ1bmhpZ2hsaWdodERyb3Bab25lXCIsXG4gICAgICAgIGRyb3A6IFwiZHJvcFwiLFxuICAgICAgICBkcmFnb3ZlcjogZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICQoXCIuaGlkZGVuX2Rlc2NyaXB0aW9uX2xheWVyXCIpLmFkZENsYXNzKFwiZHJhZ292ZXJcIik7XG4gICAgICAgICAgICAkKFwiLm1lbnVidXR0b25cIikuYWRkQ2xhc3MoXCJiYWNrZ3JvdW5kLW5vbmVcIik7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHVuaGlnaGxpZ2h0RHJvcFpvbmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAkKFwiLmhpZGRlbl9kZXNjcmlwdGlvbl9sYXllclwiKS5yZW1vdmVDbGFzcyhcImRyYWdvdmVyXCIpO1xuICAgICAgICAkKFwiLm1lbnVidXR0b25cIikucmVtb3ZlQ2xhc3MoXCJiYWNrZ3JvdW5kLW5vbmVcIik7XG4gICAgfSxcblxuICAgIGRyb3A6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgdGhhdCBmaWxlIGlzIHZhbGlkIGdhbGF4eSB3b3JrZmxvd1xuICAgICAgICB0aGlzLnVuaGlnaGxpZ2h0RHJvcFpvbmUoKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCBmaWxlcyA9IGUuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgZjsgKGYgPSBmaWxlc1tpXSk7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5yZWFkV29ya2Zsb3dGaWxlcyhmKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZWFkV29ya2Zsb3dGaWxlczogZnVuY3Rpb24oZikge1xuICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICByZWFkZXIub25sb2FkID0gdGhlRmlsZSA9PiB7XG4gICAgICAgICAgICBsZXQgd2ZfanNvbjtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgd2ZfanNvbiA9IEpTT04ucGFyc2UocmVhZGVyLnJlc3VsdCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgbW9kX3RvYXN0ci5lcnJvcihgQ291bGQgbm90IHJlYWQgZmlsZSAnJHtmLm5hbWV9Jy4gVmVyaWZ5IGl0IGlzIGEgdmFsaWQgR2FsYXh5IHdvcmtmbG93YCk7XG4gICAgICAgICAgICAgICAgd2ZfanNvbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAod2ZfanNvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbi5jcmVhdGUod2ZfanNvbiwge1xuICAgICAgICAgICAgICAgICAgICBhdDogMCxcbiAgICAgICAgICAgICAgICAgICAgd2FpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RfdG9hc3RyLnN1Y2Nlc3MoYFN1Y2Nlc3NmdWxseSBpbXBvcnRlZCB3b3JrZmxvdyAnJHt3Zl9qc29uLm5hbWV9J2ApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24obW9kZWwsIHJlc3AsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZF90b2FzdHIuZXJyb3Iob3B0aW9ucy5lcnJvclRocm93bik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZiwgXCJ1dGYtOFwiKTtcbiAgICB9LFxuXG4gICAgX3Nob3dBcmdFcnJvcnM6IF8ub25jZSgoKSA9PiB7XG4gICAgICAgIC8vIFBhcnNlIGFyZ3Mgb3V0IG9mIHBhcmFtcywgZGlzcGxheSBpZiB0aGVyZSdzIGEgbWVzc2FnZS5cbiAgICAgICAgY29uc3QgbXNnX3RleHQgPSBRdWVyeVN0cmluZ1BhcnNpbmcuZ2V0KFwibWVzc2FnZVwiKTtcbiAgICAgICAgY29uc3QgbXNnX3N0YXR1cyA9IFF1ZXJ5U3RyaW5nUGFyc2luZy5nZXQoXCJzdGF0dXNcIik7XG4gICAgICAgIGlmIChtc2dfc3RhdHVzID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgIG1vZF90b2FzdHIuZXJyb3IoXy5lc2NhcGUobXNnX3RleHQgfHwgXCJVbmtub3duIEVycm9yLCBwbGVhc2UgcmVwb3J0IHRoaXMgdG8gYW4gYWRtaW5pc3RyYXRvci5cIikpO1xuICAgICAgICB9IGVsc2UgaWYgKG1zZ190ZXh0KSB7XG4gICAgICAgICAgICBtb2RfdG9hc3RyLmluZm8oXy5lc2NhcGUobXNnX3RleHQpKTtcbiAgICAgICAgfVxuICAgIH0pLFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gQWRkIHdvcmtmbG93IGhlYWRlclxuICAgICAgICBjb25zdCBoZWFkZXIgPSB0aGlzLl90ZW1wbGF0ZUhlYWRlcigpO1xuICAgICAgICAvLyBBZGQgdGhlIGFjdGlvbnMgYnV0dG9uc1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZUFjdGlvbnMgPSB0aGlzLl90ZW1wbGF0ZUFjdGlvbkJ1dHRvbnMoKTtcbiAgICAgICAgY29uc3QgdGFibGVUZW1wbGF0ZSA9IHRoaXMuX3RlbXBsYXRlV29ya2Zsb3dUYWJsZSgpO1xuICAgICAgICB0aGlzLiRlbC5odG1sKGhlYWRlciArIHRlbXBsYXRlQWN0aW9ucyArIHRhYmxlVGVtcGxhdGUpO1xuICAgICAgICBfKHRoaXMuY29sbGVjdGlvbi5tb2RlbHMpLmVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICAvLyBpbiBjYXNlIGNvbGxlY3Rpb24gaXMgbm90IGVtcHR5XG4gICAgICAgICAgICB0aGlzLmFwcGVuZEl0ZW0oaXRlbSk7XG4gICAgICAgICAgICB0aGlzLmNvbmZpcm1EZWxldGUoaXRlbSk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgICAgICBjb25zdCBtaW5RdWVyeUxlbmd0aCA9IDM7XG4gICAgICAgIHRoaXMuc2VhcmNoV29ya2Zsb3codGhpcy4kKFwiLnNlYXJjaC13ZlwiKSwgdGhpcy4kKFwiLndvcmtmbG93LXNlYXJjaCB0clwiKSwgbWluUXVlcnlMZW5ndGgpO1xuICAgICAgICB0aGlzLmFkanVzdEFjdGlvbmRyb3Bkb3duKCk7XG4gICAgICAgIHRoaXMuX3Nob3dBcmdFcnJvcnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIGFwcGVuZEl0ZW06IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgY29uc3Qgd29ya2Zsb3dJdGVtVmlldyA9IG5ldyBXb3JrZmxvd0l0ZW1WaWV3KHtcbiAgICAgICAgICAgIG1vZGVsOiBpdGVtLFxuICAgICAgICAgICAgY29sbGVjdGlvbjogdGhpcy5jb2xsZWN0aW9uXG4gICAgICAgIH0pO1xuICAgICAgICAkKFwiLndvcmtmbG93LXNlYXJjaFwiKS5hcHBlbmQod29ya2Zsb3dJdGVtVmlldy5yZW5kZXIoKS5lbCk7XG4gICAgICAgIHdvcmtmbG93SXRlbVZpZXcucmVuZGVyVGFnRWRpdG9yKCk7XG4gICAgfSxcblxuICAgIC8qKiBBZGQgY29uZmlybSBib3ggYmVmb3JlIHJlbW92aW5nL3Vuc2hhcmluZyB3b3JrZmxvdyAqL1xuICAgIGNvbmZpcm1EZWxldGU6IGZ1bmN0aW9uKHdvcmtmbG93KSB7XG4gICAgICAgIGNvbnN0ICRlbF9zaGFyZWRfd2ZfbGluayA9IHRoaXMuJChgLmxpbmstY29uZmlybS1zaGFyZWQtJHt3b3JrZmxvdy5pZH1gKTtcbiAgICAgICAgJGVsX3NoYXJlZF93Zl9saW5rLmNsaWNrKCgpID0+XG4gICAgICAgICAgICB3aW5kb3cuY29uZmlybShgQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIHJlbW92ZSB0aGUgc2hhcmVkIHdvcmtmbG93ICcke3dvcmtmbG93LmF0dHJpYnV0ZXMubmFtZX0nP2ApXG4gICAgICAgICk7XG4gICAgfSxcblxuICAgIC8qKiBJbXBsZW1lbnQgY2xpZW50IHNpZGUgd29ya2Zsb3cgc2VhcmNoL2ZpbHRlcmluZyAqL1xuICAgIHNlYXJjaFdvcmtmbG93OiBmdW5jdGlvbigkZWxfc2VhcmNoaW5wdXQsICRlbF90YWJsZXRyLCBtaW5fcXVlcnlsZW4pIHtcbiAgICAgICAgJGVsX3NlYXJjaGlucHV0Lm9uKFwia2V5dXBcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBxdWVyeSA9ICQodGhpcykudmFsKCk7XG4gICAgICAgICAgICAvLyBGaWx0ZXIgd2hlbiBxdWVyeSBpcyBhdCBsZWFzdCAzIGNoYXJhY3RlcnNcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBzaG93IGFsbCByb3dzXG4gICAgICAgICAgICBpZiAocXVlcnkubGVuZ3RoID49IG1pbl9xdWVyeWxlbikge1xuICAgICAgICAgICAgICAgIC8vIElnbm9yZSB0aGUgcXVlcnkncyBjYXNlIHVzaW5nICdpJ1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlZ3VsYXJfZXhwcmVzc2lvbiA9IG5ldyBSZWdFeHAocXVlcnksIFwiaVwiKTtcbiAgICAgICAgICAgICAgICAkZWxfdGFibGV0ci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJGVsX3RhYmxldHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IHJlZ3VsYXIgZXhwcmVzc2lvbiBvbiBlYWNoIHJvdydzIHRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBzaG93IHdoZW4gdGhlcmUgaXMgYSBtYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ3VsYXJfZXhwcmVzc2lvbi50ZXN0KCQodGhpcykudGV4dCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnNob3coKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGVsX3RhYmxldHIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIEFqdXN0IHRoZSBwb3NpdGlvbiBvZiBkcm9wZG93biB3aXRoIHJlc3BlY3QgdG8gdGFibGUgKi9cbiAgICBhZGp1c3RBY3Rpb25kcm9wZG93bjogZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcy5lbCkub24oXCJzaG93LmJzLmRyb3Bkb3duXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJCh0aGlzLmVsKS5jc3MoXCJvdmVyZmxvd1wiLCBcImluaGVyaXRcIik7XG4gICAgICAgIH0pO1xuICAgICAgICAkKHRoaXMuZWwpLm9uKFwiaGlkZS5icy5kcm9wZG93blwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQodGhpcy5lbCkuY3NzKFwib3ZlcmZsb3dcIiwgXCJhdXRvXCIpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlIGZvciBubyB3b3JrZmxvdyAqL1xuICAgIF90ZW1wbGF0ZU5vV29ya2Zsb3c6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJzxkaXYgY2xhc3M9XCJ3Zi1ub2RhdGFcIj4gWW91IGhhdmUgbm8gd29ya2Zsb3dzLiA8L2Rpdj4nO1xuICAgIH0sXG5cbiAgICAvKiogVGVtcGxhdGUgZm9yIGFjdGlvbnMgYnV0dG9ucyAqL1xuICAgIF90ZW1wbGF0ZUFjdGlvbkJ1dHRvbnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gYDx1bCBjbGFzcz1cIm1hbmFnZS10YWJsZS1hY3Rpb25zXCI+PGxpPjxpbnB1dCBjbGFzcz1cInNlYXJjaC13ZiBmb3JtLWNvbnRyb2xcIiB0eXBlPVwidGV4dFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiIHBsYWNlaG9sZGVyPVwic2VhcmNoIGZvciB3b3JrZmxvdy4uLlwiPjwvbGk+PGxpPjxhIGNsYXNzPVwiYWN0aW9uLWJ1dHRvbiBmYSBmYS1wbHVzIHdmLWFjdGlvblwiIGlkPVwibmV3LXdvcmtmbG93XCIgdGl0bGU9XCJDcmVhdGUgbmV3IHdvcmtmbG93XCIgaHJlZj1cIiR7XG4gICAgICAgICAgICBHYWxheHkucm9vdFxuICAgICAgICB9d29ya2Zsb3dzL2NyZWF0ZVwiPjwvYT48L2xpPjxsaT48YSBjbGFzcz1cImFjdGlvbi1idXR0b24gZmEgZmEtdXBsb2FkIHdmLWFjdGlvblwiIGlkPVwiaW1wb3J0LXdvcmtmbG93XCIgdGl0bGU9XCJVcGxvYWQgb3IgaW1wb3J0IHdvcmtmbG93XCIgaHJlZj1cIiR7XG4gICAgICAgICAgICBHYWxheHkucm9vdFxuICAgICAgICB9d29ya2Zsb3dzL2ltcG9ydF93b3JrZmxvd1wiPjwvYT48L2xpPjwvdWw+YDtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlIGZvciB3b3JrZmxvdyB0YWJsZSAqL1xuICAgIF90ZW1wbGF0ZVdvcmtmbG93VGFibGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCB0YWJsZUh0bWwgPVxuICAgICAgICAgICAgJzx0YWJsZSBjbGFzcz1cInRhYmxlIGNvbG9yZWRcIj48dGhlYWQ+JyArXG4gICAgICAgICAgICAnPHRyIGNsYXNzPVwiaGVhZGVyXCI+JyArXG4gICAgICAgICAgICBcIjx0aD5OYW1lPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5UYWdzPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5Pd25lcjwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+IyBvZiBTdGVwczwvdGg+XCIgK1xuICAgICAgICAgICAgXCI8dGg+UHVibGlzaGVkPC90aD5cIiArXG4gICAgICAgICAgICBcIjx0aD5TaG93IGluIHRvb2xzIHBhbmVsPC90aD5cIiArXG4gICAgICAgICAgICBcIjwvdHI+PC90aGVhZD5cIjtcbiAgICAgICAgcmV0dXJuIGAke3RhYmxlSHRtbH08dGJvZHkgY2xhc3M9XCJ3b3JrZmxvdy1zZWFyY2ggXCI+PGRpdiBjbGFzcz1cImhpZGRlbl9kZXNjcmlwdGlvbl9sYXllclwiPjxwPkRyb3Agd29ya2Zsb3cgZmlsZXMgaGVyZSB0byBpbXBvcnQ8L3A+PC90Ym9keT48L3RhYmxlPjwvZGl2PmA7XG4gICAgfSxcblxuICAgIC8qKiBNYWluIHRlbXBsYXRlICovXG4gICAgX3RlbXBsYXRlSGVhZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicGFnZS1jb250YWluZXJcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwidXNlci13b3JrZmxvd3Mgd2ZcIj4nICtcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwicmVzcG9uc2UtbWVzc2FnZVwiPjwvZGl2PicgK1xuICAgICAgICAgICAgXCI8aDI+XCIgK1xuICAgICAgICAgICAgX2woXCJZb3VyIHdvcmtmbG93c1wiKSArXG4gICAgICAgICAgICBcIjwvaDI+XCIgK1xuICAgICAgICAgICAgXCI8L2Rpdj5cIiArXG4gICAgICAgICAgICBcIjwvZGl2PlwiXG4gICAgICAgICk7XG4gICAgfVxufSk7XG5cbmNvbnN0IEltcG9ydFdvcmtmbG93VmlldyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KFwiPGRpdi8+XCIpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICAvKiogT3BlbiBwYWdlIHRvIGltcG9ydCB3b3JrZmxvdyAqL1xuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICQuZ2V0SlNPTihgJHtHYWxheHkucm9vdH13b3JrZmxvdy91cGxvYWRfaW1wb3J0X3dvcmtmbG93YCwgb3B0aW9ucyA9PiB7XG4gICAgICAgICAgICB0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZCh0aGlzLl9tYWluVGVtcGxhdGUob3B0aW9ucykpO1xuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIFRlbXBsYXRlIGZvciB0aGUgaW1wb3J0IHdvcmtmbG93IHBhZ2UgKi9cbiAgICBfbWFpblRlbXBsYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBgPGRpdiBjbGFzcz0ndG9vbEZvcm0nPjxkaXYgY2xhc3M9J3Rvb2xGb3JtVGl0bGUnPkltcG9ydCBHYWxheHkgd29ya2Zsb3c8L2Rpdj48ZGl2IGNsYXNzPSd0b29sRm9ybUJvZHknPjxmb3JtIG5hbWU9J2ltcG9ydF93b3JrZmxvdycgaWQ9J2ltcG9ydF93b3JrZmxvdycgYWN0aW9uPScke1xuICAgICAgICAgICAgR2FsYXh5LnJvb3RcbiAgICAgICAgfXdvcmtmbG93L3VwbG9hZF9pbXBvcnRfd29ya2Zsb3cnIGVuY3R5cGU9J211bHRpcGFydC9mb3JtLWRhdGEnIG1ldGhvZD0nUE9TVCc+PGRpdiBjbGFzcz0nZm9ybS1yb3cnPjxsYWJlbD5HYWxheHkgd29ya2Zsb3cgVVJMOjwvbGFiZWw+PGlucHV0IHR5cGU9J3RleHQnIG5hbWU9J3VybCcgY2xhc3M9J2lucHV0LXVybCcgdmFsdWU9JyR7XG4gICAgICAgICAgICBvcHRpb25zLnVybFxuICAgICAgICB9JyBzaXplPSc0MCc+PGRpdiBjbGFzcz0ndG9vbFBhcmFtSGVscCcgc3R5bGU9J2NsZWFyOiBib3RoOyc+SWYgdGhlIHdvcmtmbG93IGlzIGFjY2Vzc2libGUgdmlhIGEgVVJMLCBlbnRlciB0aGUgVVJMIGFib3ZlIGFuZCBjbGljayA8Yj5JbXBvcnQ8L2I+LjwvZGl2PjxkaXYgc3R5bGU9J2NsZWFyOiBib3RoJz48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPSdmb3JtLXJvdyc+PGxhYmVsPkdhbGF4eSB3b3JrZmxvdyBmaWxlOjwvbGFiZWw+PGRpdiBjbGFzcz0nZm9ybS1yb3ctaW5wdXQnPjxpbnB1dCB0eXBlPSdmaWxlJyBuYW1lPSdmaWxlX2RhdGEnIGNsYXNzPSdpbnB1dC1maWxlJy8+PC9kaXY+PGRpdiBjbGFzcz0ndG9vbFBhcmFtSGVscCcgc3R5bGU9J2NsZWFyOiBib3RoOyc+SWYgdGhlIHdvcmtmbG93IGlzIGluIGEgZmlsZSBvbiB5b3VyIGNvbXB1dGVyLCBjaG9vc2UgaXQgYW5kIHRoZW4gY2xpY2sgPGI+SW1wb3J0PC9iPi48L2Rpdj48ZGl2IHN0eWxlPSdjbGVhcjogYm90aCc+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz0nZm9ybS1yb3cnPjxpbnB1dCB0eXBlPSdzdWJtaXQnIGNsYXNzPSdwcmltYXJ5LWJ1dHRvbiB3Zi1pbXBvcnQnIG5hbWU9J2ltcG9ydF9idXR0b24nIHZhbHVlPSdJbXBvcnQnPjwvZGl2PjwvZm9ybT48aHIvPjxkaXYgY2xhc3M9J2Zvcm0tcm93Jz48bGFiZWw+SW1wb3J0IGEgR2FsYXh5IHdvcmtmbG93IGZyb20gbXlFeHBlcmltZW50OjwvbGFiZWw+PGRpdiBjbGFzcz0nZm9ybS1yb3ctaW5wdXQnPjxhIGhyZWY9JyR7XG4gICAgICAgICAgICBvcHRpb25zLm15ZXhwZXJpbWVudF90YXJnZXRfdXJsXG4gICAgICAgIH0nPiBWaXNpdCBteUV4cGVyaW1lbnQ8L2E+PC9kaXY+PGRpdiBjbGFzcz0ndG9vbFBhcmFtSGVscCcgc3R5bGU9J2NsZWFyOiBib3RoOyc+Q2xpY2sgdGhlIGxpbmsgYWJvdmUgdG8gdmlzaXQgbXlFeHBlcmltZW50IGFuZCBicm93c2UgZm9yIEdhbGF4eSB3b3JrZmxvd3MuPC9kaXY+PGRpdiBzdHlsZT0nY2xlYXI6IGJvdGgnPjwvZGl2PjwvZGl2PjwvZGl2PjwvZGl2PmA7XG4gICAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBWaWV3OiBXb3JrZmxvd0xpc3RWaWV3LFxuICAgIEltcG9ydFdvcmtmbG93VmlldzogSW1wb3J0V29ya2Zsb3dWaWV3XG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGdhbGF4eS9zY3JpcHRzL212Yy93b3JrZmxvdy93b3JrZmxvdy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7Ozs7O0FBQ0E7QUFSQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBU0E7QUFDQTtBQWpKQTtBQUNBO0FBbUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUNBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFVQTtBQXZMQTtBQUNBO0FBeUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBdEJBO0FBQ0E7QUF3QkE7QUFDQTtBQUNBO0FBRkE7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///269\n");

/***/ }),
/* 270 */
/*!*******************************************************!*\
  !*** ./galaxy/scripts/mvc/workflow/workflow-model.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _baseMvc = __webpack_require__(/*! mvc/base-mvc */ 4);\n\nvar _baseMvc2 = _interopRequireDefault(_baseMvc);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* global Backbone */\n// workflow model\n\nvar logNamespace = \"workflow\";\n//==============================================================================\n/** @class model for a single workflow.\n *  @name WorkflowItem\n *  @augments Backbone.Model\n */\nvar WorkflowItem = Backbone.Model.extend(_baseMvc2.default.LoggableMixin).extend({\n    _logNamespace: logNamespace,\n\n    urlRoot: Galaxy.root + \"api/workflows\",\n\n    toJSON: function toJSON() {\n        // need to overwrite this as endpoint expects the 'workflow' key in payload\n        return { workflow: this.attributes };\n    }\n});\n\n//==============================================================================\n/** @class collection for workflows.\n *  @name WorkflowCollection\n *  @augments Backbone.Collection\n */\nvar WorkflowCollection = Backbone.Collection.extend({\n    model: WorkflowItem,\n    url: Galaxy.root + \"api/workflows\"\n});\n\n//==============================================================================\n\nexports.default = {\n    WorkflowItem: WorkflowItem,\n    WorkflowCollection: WorkflowCollection\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy93b3JrZmxvdy93b3JrZmxvdy1tb2RlbC5qcz80NTllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiYXNlTVZDIGZyb20gXCJtdmMvYmFzZS1tdmNcIjtcbi8qIGdsb2JhbCBCYWNrYm9uZSAqL1xuLy8gd29ya2Zsb3cgbW9kZWxcblxudmFyIGxvZ05hbWVzcGFjZSA9IFwid29ya2Zsb3dcIjtcbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vKiogQGNsYXNzIG1vZGVsIGZvciBhIHNpbmdsZSB3b3JrZmxvdy5cbiAqICBAbmFtZSBXb3JrZmxvd0l0ZW1cbiAqICBAYXVnbWVudHMgQmFja2JvbmUuTW9kZWxcbiAqL1xudmFyIFdvcmtmbG93SXRlbSA9IEJhY2tib25lLk1vZGVsLmV4dGVuZChiYXNlTVZDLkxvZ2dhYmxlTWl4aW4pLmV4dGVuZCh7XG4gICAgX2xvZ05hbWVzcGFjZTogbG9nTmFtZXNwYWNlLFxuXG4gICAgdXJsUm9vdDogYCR7R2FsYXh5LnJvb3R9YXBpL3dvcmtmbG93c2AsXG5cbiAgICB0b0pTT046IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBuZWVkIHRvIG92ZXJ3cml0ZSB0aGlzIGFzIGVuZHBvaW50IGV4cGVjdHMgdGhlICd3b3JrZmxvdycga2V5IGluIHBheWxvYWRcbiAgICAgICAgcmV0dXJuIHsgd29ya2Zsb3c6IHRoaXMuYXR0cmlidXRlcyB9O1xuICAgIH1cbn0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLyoqIEBjbGFzcyBjb2xsZWN0aW9uIGZvciB3b3JrZmxvd3MuXG4gKiAgQG5hbWUgV29ya2Zsb3dDb2xsZWN0aW9uXG4gKiAgQGF1Z21lbnRzIEJhY2tib25lLkNvbGxlY3Rpb25cbiAqL1xudmFyIFdvcmtmbG93Q29sbGVjdGlvbiA9IEJhY2tib25lLkNvbGxlY3Rpb24uZXh0ZW5kKHtcbiAgICBtb2RlbDogV29ya2Zsb3dJdGVtLFxuICAgIHVybDogYCR7R2FsYXh5LnJvb3R9YXBpL3dvcmtmbG93c2Bcbn0pO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgV29ya2Zsb3dJdGVtOiBXb3JrZmxvd0l0ZW0sXG4gICAgV29ya2Zsb3dDb2xsZWN0aW9uOiBXb3JrZmxvd0NvbGxlY3Rpb25cbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL3dvcmtmbG93L3dvcmtmbG93LW1vZGVsLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBQ0E7QUFVQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///270\n");

/***/ }),
/* 271 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/components/HistoryImport.vue ***!
  \*****************************************************/
/*! exports provided: default */
/*! all exports used */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_bustCache_HistoryImport_vue__ = __webpack_require__(/*! !babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0&bustCache!./HistoryImport.vue */ 274);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_bustCache_HistoryImport_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_bustCache_HistoryImport_vue__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_23742a28_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_bustCache_HistoryImport_vue__ = __webpack_require__(/*! !../../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-23742a28\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0&bustCache!./HistoryImport.vue */ 275);\nvar disposed = false\nfunction injectStyle (ssrContext) {\n  if (disposed) return\n  __webpack_require__(/*! !vue-style-loader!css-loader?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-23742a28\",\"scoped\":false,\"hasInlineConfig\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0&bustCache!./HistoryImport.vue */ 272)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../../node_modules/vue-loader/lib/component-normalizer */ 19)\n/* script */\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_bustCache_HistoryImport_vue___default.a,\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_23742a28_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_bustCache_HistoryImport_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"galaxy/scripts/components/HistoryImport.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {  return key !== \"default\" && key.substr(0, 2) !== \"__\"})) {  console.error(\"named exports are not supported in *.vue files.\")}\n\n/* hot reload */\nif (false) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-23742a28\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-23742a28\", Component.options)\n' + '  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZT81ZGU5Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBkaXNwb3NlZCA9IGZhbHNlXG5mdW5jdGlvbiBpbmplY3RTdHlsZSAoc3NyQ29udGV4dCkge1xuICBpZiAoZGlzcG9zZWQpIHJldHVyblxuICByZXF1aXJlKFwiISF2dWUtc3R5bGUtbG9hZGVyIWNzcy1sb2FkZXI/c291cmNlTWFwIS4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlci9pbmRleD97XFxcInZ1ZVxcXCI6dHJ1ZSxcXFwiaWRcXFwiOlxcXCJkYXRhLXYtMjM3NDJhMjhcXFwiLFxcXCJzY29wZWRcXFwiOmZhbHNlLFxcXCJoYXNJbmxpbmVDb25maWdcXFwiOmZhbHNlfSEuLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc2VsZWN0b3I/dHlwZT1zdHlsZXMmaW5kZXg9MCZidXN0Q2FjaGUhLi9IaXN0b3J5SW1wb3J0LnZ1ZVwiKVxufVxudmFyIG5vcm1hbGl6ZUNvbXBvbmVudCA9IHJlcXVpcmUoXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL2NvbXBvbmVudC1ub3JtYWxpemVyXCIpXG4vKiBzY3JpcHQgKi9cbmltcG9ydCBfX3Z1ZV9zY3JpcHRfXyBmcm9tIFwiISFiYWJlbC1sb2FkZXIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yP3R5cGU9c2NyaXB0JmluZGV4PTAmYnVzdENhY2hlIS4vSGlzdG9yeUltcG9ydC52dWVcIlxuLyogdGVtcGxhdGUgKi9cbmltcG9ydCBfX3Z1ZV90ZW1wbGF0ZV9fIGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi90ZW1wbGF0ZS1jb21waWxlci9pbmRleD97XFxcImlkXFxcIjpcXFwiZGF0YS12LTIzNzQyYTI4XFxcIixcXFwiaGFzU2NvcGVkXFxcIjpmYWxzZSxcXFwiYnVibGVcXFwiOntcXFwidHJhbnNmb3Jtc1xcXCI6e319fSEuLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc2VsZWN0b3I/dHlwZT10ZW1wbGF0ZSZpbmRleD0wJmJ1c3RDYWNoZSEuL0hpc3RvcnlJbXBvcnQudnVlXCJcbi8qIHRlbXBsYXRlIGZ1bmN0aW9uYWwgKi9cbnZhciBfX3Z1ZV90ZW1wbGF0ZV9mdW5jdGlvbmFsX18gPSBmYWxzZVxuLyogc3R5bGVzICovXG52YXIgX192dWVfc3R5bGVzX18gPSBpbmplY3RTdHlsZVxuLyogc2NvcGVJZCAqL1xudmFyIF9fdnVlX3Njb3BlSWRfXyA9IG51bGxcbi8qIG1vZHVsZUlkZW50aWZpZXIgKHNlcnZlciBvbmx5KSAqL1xudmFyIF9fdnVlX21vZHVsZV9pZGVudGlmaWVyX18gPSBudWxsXG52YXIgQ29tcG9uZW50ID0gbm9ybWFsaXplQ29tcG9uZW50KFxuICBfX3Z1ZV9zY3JpcHRfXyxcbiAgX192dWVfdGVtcGxhdGVfXyxcbiAgX192dWVfdGVtcGxhdGVfZnVuY3Rpb25hbF9fLFxuICBfX3Z1ZV9zdHlsZXNfXyxcbiAgX192dWVfc2NvcGVJZF9fLFxuICBfX3Z1ZV9tb2R1bGVfaWRlbnRpZmllcl9fXG4pXG5Db21wb25lbnQub3B0aW9ucy5fX2ZpbGUgPSBcImdhbGF4eS9zY3JpcHRzL2NvbXBvbmVudHMvSGlzdG9yeUltcG9ydC52dWVcIlxuaWYgKENvbXBvbmVudC5lc01vZHVsZSAmJiBPYmplY3Qua2V5cyhDb21wb25lbnQuZXNNb2R1bGUpLnNvbWUoZnVuY3Rpb24gKGtleSkgeyAgcmV0dXJuIGtleSAhPT0gXCJkZWZhdWx0XCIgJiYga2V5LnN1YnN0cigwLCAyKSAhPT0gXCJfX1wifSkpIHsgIGNvbnNvbGUuZXJyb3IoXCJuYW1lZCBleHBvcnRzIGFyZSBub3Qgc3VwcG9ydGVkIGluICoudnVlIGZpbGVzLlwiKX1cblxuLyogaG90IHJlbG9hZCAqL1xuaWYgKG1vZHVsZS5ob3QpIHsoZnVuY3Rpb24gKCkge1xuICB2YXIgaG90QVBJID0gcmVxdWlyZShcInZ1ZS1ob3QtcmVsb2FkLWFwaVwiKVxuICBob3RBUEkuaW5zdGFsbChyZXF1aXJlKFwidnVlXCIpLCBmYWxzZSlcbiAgaWYgKCFob3RBUEkuY29tcGF0aWJsZSkgcmV0dXJuXG4gIG1vZHVsZS5ob3QuYWNjZXB0KClcbiAgaWYgKCFtb2R1bGUuaG90LmRhdGEpIHtcbiAgICBob3RBUEkuY3JlYXRlUmVjb3JkKFwiZGF0YS12LTIzNzQyYTI4XCIsIENvbXBvbmVudC5vcHRpb25zKVxuICB9IGVsc2Uge1xuICAgIGhvdEFQSS5yZWxvYWQoXCJkYXRhLXYtMjM3NDJhMjhcIiwgQ29tcG9uZW50Lm9wdGlvbnMpXG4nICsgJyAgfVxuICBtb2R1bGUuaG90LmRpc3Bvc2UoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBkaXNwb3NlZCA9IHRydWVcbiAgfSlcbn0pKCl9XG5cbmV4cG9ydCBkZWZhdWx0IENvbXBvbmVudC5leHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2dhbGF4eS9zY3JpcHRzL2NvbXBvbmVudHMvSGlzdG9yeUltcG9ydC52dWVcbi8vIG1vZHVsZSBpZCA9IDI3MVxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///271\n");

/***/ }),
/* 272 */
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap!./node_modules/vue-loader/lib/style-compiler?{"vue":true,"id":"data-v-23742a28","scoped":false,"hasInlineConfig":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0&bustCache!./galaxy/scripts/components/HistoryImport.vue ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

eval("// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(/*! !../../../node_modules/css-loader?sourceMap!../../../node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-23742a28\",\"scoped\":false,\"hasInlineConfig\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0&bustCache!./HistoryImport.vue */ 273);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(/*! ../../../node_modules/vue-style-loader/lib/addStylesClient.js */ 85)(\"7cbbda9e\", content, false);\n// Hot Module Replacement\nif(false) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../node_modules/css-loader/index.js?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-23742a28\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0&bustCache!./HistoryImport.vue\", function() {\n     var newContent = require(\"!!../../../node_modules/css-loader/index.js?sourceMap!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-23742a28\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0&bustCache!./HistoryImport.vue\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcyLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZT85MjE1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXAhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3N0eWxlLWNvbXBpbGVyL2luZGV4LmpzP3tcXFwidnVlXFxcIjp0cnVlLFxcXCJpZFxcXCI6XFxcImRhdGEtdi0yMzc0MmEyOFxcXCIsXFxcInNjb3BlZFxcXCI6ZmFsc2UsXFxcImhhc0lubGluZUNvbmZpZ1xcXCI6ZmFsc2V9IS4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wJmJ1c3RDYWNoZSEuL0hpc3RvcnlJbXBvcnQudnVlXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXNDbGllbnQuanNcIikoXCI3Y2JiZGE5ZVwiLCBjb250ZW50LCBmYWxzZSk7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG4gLy8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3NcbiBpZighY29udGVudC5sb2NhbHMpIHtcbiAgIG1vZHVsZS5ob3QuYWNjZXB0KFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz9zb3VyY2VNYXAhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3N0eWxlLWNvbXBpbGVyL2luZGV4LmpzP3tcXFwidnVlXFxcIjp0cnVlLFxcXCJpZFxcXCI6XFxcImRhdGEtdi0yMzc0MmEyOFxcXCIsXFxcInNjb3BlZFxcXCI6ZmFsc2UsXFxcImhhc0lubGluZUNvbmZpZ1xcXCI6ZmFsc2V9IS4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wJmJ1c3RDYWNoZSEuL0hpc3RvcnlJbXBvcnQudnVlXCIsIGZ1bmN0aW9uKCkge1xuICAgICB2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcCEuLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc3R5bGUtY29tcGlsZXIvaW5kZXguanM/e1xcXCJ2dWVcXFwiOnRydWUsXFxcImlkXFxcIjpcXFwiZGF0YS12LTIzNzQyYTI4XFxcIixcXFwic2NvcGVkXFxcIjpmYWxzZSxcXFwiaGFzSW5saW5lQ29uZmlnXFxcIjpmYWxzZX0hLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yLmpzP3R5cGU9c3R5bGVzJmluZGV4PTAmYnVzdENhY2hlIS4vSGlzdG9yeUltcG9ydC52dWVcIik7XG4gICAgIGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuICAgICB1cGRhdGUobmV3Q29udGVudCk7XG4gICB9KTtcbiB9XG4gLy8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuIG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL3Z1ZS1zdHlsZS1sb2FkZXIhLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlcj9zb3VyY2VNYXAhLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc3R5bGUtY29tcGlsZXI/e1widnVlXCI6dHJ1ZSxcImlkXCI6XCJkYXRhLXYtMjM3NDJhMjhcIixcInNjb3BlZFwiOmZhbHNlLFwiaGFzSW5saW5lQ29uZmlnXCI6ZmFsc2V9IS4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yLmpzP3R5cGU9c3R5bGVzJmluZGV4PTAmYnVzdENhY2hlIS4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZVxuLy8gbW9kdWxlIGlkID0gMjcyXG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///272\n");

/***/ }),
/* 273 */
/*!*****************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader?sourceMap!./node_modules/vue-loader/lib/style-compiler?{"vue":true,"id":"data-v-23742a28","scoped":false,"hasInlineConfig":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0&bustCache!./galaxy/scripts/components/HistoryImport.vue ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

eval("exports = module.exports = __webpack_require__(/*! ../../../node_modules/css-loader/lib/css-base.js */ 84)(true);\n// imports\n\n\n// module\nexports.push([module.i, \"\\n.ui-message {\\n    display: block;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"/Users/sweaver/Programming/galaxy-dev/galaxy-dev/client/galaxy/scripts/components/galaxy/scripts/components/HistoryImport.vue?0bab9d06\"],\"names\":[],\"mappings\":\";AA2DA;IACA,eAAA;CACA\",\"file\":\"HistoryImport.vue\",\"sourcesContent\":[\"<template>\\n    <div class=\\\"ui-portlet-limited\\\">\\n        <div class=\\\"portlet-header\\\">\\n            <div class=\\\"portlet-title\\\">\\n                <i class=\\\"portlet-title-icon fa fa-upload\\\"></i>\\n                <span class=\\\"portlet-title-text\\\"><b>Import a History from an Archive</b></span>\\n            </div>\\n        </div>\\n        <div class=\\\"portlet-content\\\">\\n            <div v-if=\\\"errormessage\\\" class=\\\"ui-message alert alert-danger\\\">\\n                {{ errormessage }}\\n            </div>\\n            <div class=\\\"portlet-body\\\">\\n                <form ref=\\\"form\\\">\\n                    <div class=\\\"ui-form-element\\\">\\n                        <div class=\\\"ui-form-title\\\">Archived History URL</div>\\n                        <input class=\\\"ui-input\\\" type=\\\"text\\\" name=\\\"archive_source\\\"/>\\n                    </div>\\n                    <div class=\\\"ui-form-element\\\">\\n                        <div class=\\\"ui-form-title\\\">Archived History file</div>\\n                        <input type=\\\"file\\\" name=\\\"archive_file\\\"/>\\n                    </div>\\n                </form>\\n            </div>\\n            <div class=\\\"portlet-buttons\\\">\\n                <input class=\\\"btn btn-primary\\\" type=\\\"button\\\" value=\\\"Import History\\\" @click=\\\"submit\\\"/>\\n            </div>\\n        </div>\\n    </div>\\n</template>\\n<script>\\nexport default {\\n    data() {\\n        return {\\n            errormessage: null\\n        }\\n    },\\n    methods: {\\n        submit: function() {\\n            $.ajax({\\n                url: `${Galaxy.root}api/histories`,\\n                data: new FormData(this.$refs.form),\\n                cache: false,\\n                contentType: false,\\n                processData: false,\\n                method: \\\"POST\\\"\\n            })\\n            .done(response => {\\n                window.location = `${Galaxy.root}histories/list?message=${response.message}&status=success`\\n            })\\n            .fail(response => {\\n                let message = response.responseJSON && response.responseJSON.err_msg;\\n                this.errormessage = message || \\\"Import failed for unkown reason.\\\";\\n            });\\n        }\\n    }\\n};\\n</script>\\n<style>\\n.ui-message {\\n    display: block;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjczLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZT83NDdjIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikodHJ1ZSk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJcXG4udWktbWVzc2FnZSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG5cIiwgXCJcIiwge1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wiL1VzZXJzL3N3ZWF2ZXIvUHJvZ3JhbW1pbmcvZ2FsYXh5LWRldi9nYWxheHktZGV2L2NsaWVudC9nYWxheHkvc2NyaXB0cy9jb21wb25lbnRzL2dhbGF4eS9zY3JpcHRzL2NvbXBvbmVudHMvSGlzdG9yeUltcG9ydC52dWU/MGJhYjlkMDZcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIjtBQTJEQTtJQUNBLGVBQUE7Q0FDQVwiLFwiZmlsZVwiOlwiSGlzdG9yeUltcG9ydC52dWVcIixcInNvdXJjZXNDb250ZW50XCI6W1wiPHRlbXBsYXRlPlxcbiAgICA8ZGl2IGNsYXNzPVxcXCJ1aS1wb3J0bGV0LWxpbWl0ZWRcXFwiPlxcbiAgICAgICAgPGRpdiBjbGFzcz1cXFwicG9ydGxldC1oZWFkZXJcXFwiPlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInBvcnRsZXQtdGl0bGVcXFwiPlxcbiAgICAgICAgICAgICAgICA8aSBjbGFzcz1cXFwicG9ydGxldC10aXRsZS1pY29uIGZhIGZhLXVwbG9hZFxcXCI+PC9pPlxcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cXFwicG9ydGxldC10aXRsZS10ZXh0XFxcIj48Yj5JbXBvcnQgYSBIaXN0b3J5IGZyb20gYW4gQXJjaGl2ZTwvYj48L3NwYW4+XFxuICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDxkaXYgY2xhc3M9XFxcInBvcnRsZXQtY29udGVudFxcXCI+XFxuICAgICAgICAgICAgPGRpdiB2LWlmPVxcXCJlcnJvcm1lc3NhZ2VcXFwiIGNsYXNzPVxcXCJ1aS1tZXNzYWdlIGFsZXJ0IGFsZXJ0LWRhbmdlclxcXCI+XFxuICAgICAgICAgICAgICAgIHt7IGVycm9ybWVzc2FnZSB9fVxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInBvcnRsZXQtYm9keVxcXCI+XFxuICAgICAgICAgICAgICAgIDxmb3JtIHJlZj1cXFwiZm9ybVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ1aS1mb3JtLWVsZW1lbnRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInVpLWZvcm0tdGl0bGVcXFwiPkFyY2hpdmVkIEhpc3RvcnkgVVJMPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJ1aS1pbnB1dFxcXCIgdHlwZT1cXFwidGV4dFxcXCIgbmFtZT1cXFwiYXJjaGl2ZV9zb3VyY2VcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwidWktZm9ybS1lbGVtZW50XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJ1aS1mb3JtLXRpdGxlXFxcIj5BcmNoaXZlZCBIaXN0b3J5IGZpbGU8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cXFwiZmlsZVxcXCIgbmFtZT1cXFwiYXJjaGl2ZV9maWxlXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPC9mb3JtPlxcbiAgICAgICAgICAgIDwvZGl2PlxcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInBvcnRsZXQtYnV0dG9uc1xcXCI+XFxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwiYnRuIGJ0bi1wcmltYXJ5XFxcIiB0eXBlPVxcXCJidXR0b25cXFwiIHZhbHVlPVxcXCJJbXBvcnQgSGlzdG9yeVxcXCIgQGNsaWNrPVxcXCJzdWJtaXRcXFwiLz5cXG4gICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgIDwvZGl2PlxcbiAgICA8L2Rpdj5cXG48L3RlbXBsYXRlPlxcbjxzY3JpcHQ+XFxuZXhwb3J0IGRlZmF1bHQge1xcbiAgICBkYXRhKCkge1xcbiAgICAgICAgcmV0dXJuIHtcXG4gICAgICAgICAgICBlcnJvcm1lc3NhZ2U6IG51bGxcXG4gICAgICAgIH1cXG4gICAgfSxcXG4gICAgbWV0aG9kczoge1xcbiAgICAgICAgc3VibWl0OiBmdW5jdGlvbigpIHtcXG4gICAgICAgICAgICAkLmFqYXgoe1xcbiAgICAgICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWFwaS9oaXN0b3JpZXNgLFxcbiAgICAgICAgICAgICAgICBkYXRhOiBuZXcgRm9ybURhdGEodGhpcy4kcmVmcy5mb3JtKSxcXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsXFxuICAgICAgICAgICAgICAgIHByb2Nlc3NEYXRhOiBmYWxzZSxcXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcXFwiUE9TVFxcXCJcXG4gICAgICAgICAgICB9KVxcbiAgICAgICAgICAgIC5kb25lKHJlc3BvbnNlID0+IHtcXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gYCR7R2FsYXh5LnJvb3R9aGlzdG9yaWVzL2xpc3Q/bWVzc2FnZT0ke3Jlc3BvbnNlLm1lc3NhZ2V9JnN0YXR1cz1zdWNjZXNzYFxcbiAgICAgICAgICAgIH0pXFxuICAgICAgICAgICAgLmZhaWwocmVzcG9uc2UgPT4ge1xcbiAgICAgICAgICAgICAgICBsZXQgbWVzc2FnZSA9IHJlc3BvbnNlLnJlc3BvbnNlSlNPTiAmJiByZXNwb25zZS5yZXNwb25zZUpTT04uZXJyX21zZztcXG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvcm1lc3NhZ2UgPSBtZXNzYWdlIHx8IFxcXCJJbXBvcnQgZmFpbGVkIGZvciB1bmtvd24gcmVhc29uLlxcXCI7XFxuICAgICAgICAgICAgfSk7XFxuICAgICAgICB9XFxuICAgIH1cXG59O1xcbjwvc2NyaXB0PlxcbjxzdHlsZT5cXG4udWktbWVzc2FnZSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG48L3N0eWxlPlxcblwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuXG4vLyBleHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyP3NvdXJjZU1hcCEuL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlcj97XCJ2dWVcIjp0cnVlLFwiaWRcIjpcImRhdGEtdi0yMzc0MmEyOFwiLFwic2NvcGVkXCI6ZmFsc2UsXCJoYXNJbmxpbmVDb25maWdcIjpmYWxzZX0hLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc2VsZWN0b3IuanM/dHlwZT1zdHlsZXMmaW5kZXg9MCZidXN0Q2FjaGUhLi9nYWxheHkvc2NyaXB0cy9jb21wb25lbnRzL0hpc3RvcnlJbXBvcnQudnVlXG4vLyBtb2R1bGUgaWQgPSAyNzNcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///273\n");

/***/ }),
/* 274 */
/*!*************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0&bustCache!./galaxy/scripts/components/HistoryImport.vue ***!
  \*************************************************************************************************************************************************************/
/*! dynamic exports provided */
/*! exports used: default */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexports.default = {\n    data: function data() {\n        return {\n            errormessage: null\n        };\n    },\n\n    methods: {\n        submit: function submit() {\n            var _this = this;\n\n            $.ajax({\n                url: Galaxy.root + \"api/histories\",\n                data: new FormData(this.$refs.form),\n                cache: false,\n                contentType: false,\n                processData: false,\n                method: \"POST\"\n            }).done(function (response) {\n                window.location = Galaxy.root + \"histories/list?message=\" + response.message + \"&status=success\";\n            }).fail(function (response) {\n                var message = response.responseJSON && response.responseJSON.err_msg;\n                _this.errormessage = message || \"Import failed for unkown reason.\";\n            });\n        }\n    }\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL0hpc3RvcnlJbXBvcnQudnVlP2Q1NjIiXSwic291cmNlc0NvbnRlbnQiOlsiPHRlbXBsYXRlPlxuICAgIDxkaXYgY2xhc3M9XCJ1aS1wb3J0bGV0LWxpbWl0ZWRcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInBvcnRsZXQtaGVhZGVyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicG9ydGxldC10aXRsZVwiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwicG9ydGxldC10aXRsZS1pY29uIGZhIGZhLXVwbG9hZFwiPjwvaT5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cInBvcnRsZXQtdGl0bGUtdGV4dFwiPjxiPkltcG9ydCBhIEhpc3RvcnkgZnJvbSBhbiBBcmNoaXZlPC9iPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInBvcnRsZXQtY29udGVudFwiPlxuICAgICAgICAgICAgPGRpdiB2LWlmPVwiZXJyb3JtZXNzYWdlXCIgY2xhc3M9XCJ1aS1tZXNzYWdlIGFsZXJ0IGFsZXJ0LWRhbmdlclwiPlxuICAgICAgICAgICAgICAgIHt7IGVycm9ybWVzc2FnZSB9fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicG9ydGxldC1ib2R5XCI+XG4gICAgICAgICAgICAgICAgPGZvcm0gcmVmPVwiZm9ybVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidWktZm9ybS1lbGVtZW50XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidWktZm9ybS10aXRsZVwiPkFyY2hpdmVkIEhpc3RvcnkgVVJMPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XCJ1aS1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgbmFtZT1cImFyY2hpdmVfc291cmNlXCIvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInVpLWZvcm0tZWxlbWVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInVpLWZvcm0tdGl0bGVcIj5BcmNoaXZlZCBIaXN0b3J5IGZpbGU8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiZmlsZVwiIG5hbWU9XCJhcmNoaXZlX2ZpbGVcIi8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBvcnRsZXQtYnV0dG9uc1wiPlxuICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiIHR5cGU9XCJidXR0b25cIiB2YWx1ZT1cIkltcG9ydCBIaXN0b3J5XCIgQGNsaWNrPVwic3VibWl0XCIvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbjxzY3JpcHQ+XG5leHBvcnQgZGVmYXVsdCB7XG4gICAgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVycm9ybWVzc2FnZTogbnVsbFxuICAgICAgICB9XG4gICAgfSxcbiAgICBtZXRob2RzOiB7XG4gICAgICAgIHN1Ym1pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3R9YXBpL2hpc3Rvcmllc2AsXG4gICAgICAgICAgICAgICAgZGF0YTogbmV3IEZvcm1EYXRhKHRoaXMuJHJlZnMuZm9ybSksXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5kb25lKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBgJHtHYWxheHkucm9vdH1oaXN0b3JpZXMvbGlzdD9tZXNzYWdlPSR7cmVzcG9uc2UubWVzc2FnZX0mc3RhdHVzPXN1Y2Nlc3NgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZhaWwocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBtZXNzYWdlID0gcmVzcG9uc2UucmVzcG9uc2VKU09OICYmIHJlc3BvbnNlLnJlc3BvbnNlSlNPTi5lcnJfbXNnO1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JtZXNzYWdlID0gbWVzc2FnZSB8fCBcIkltcG9ydCBmYWlsZWQgZm9yIHVua293biByZWFzb24uXCI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn07XG48L3NjcmlwdD5cbjxzdHlsZT5cbi51aS1tZXNzYWdlIHtcbiAgICBkaXNwbGF5OiBibG9jaztcbn1cbjwvc3R5bGU+XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gSGlzdG9yeUltcG9ydC52dWU/MGJhYjlkMDYiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUErQkE7QUFDQTs7QUFDQTs7QUFFQTtBQURBO0FBR0E7QUFDQTs7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQWpCQTtBQU5BO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///274\n");

/***/ }),
/* 275 */
/*!****************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/template-compiler?{"id":"data-v-23742a28","hasScoped":false,"buble":{"transforms":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0&bustCache!./galaxy/scripts/components/HistoryImport.vue ***!
  \****************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"ui-portlet-limited\" }, [\n    _vm._m(0, false, false),\n    _vm._v(\" \"),\n    _c(\"div\", { staticClass: \"portlet-content\" }, [\n      _vm.errormessage\n        ? _c(\"div\", { staticClass: \"ui-message alert alert-danger\" }, [\n            _vm._v(\"\\n            \" + _vm._s(_vm.errormessage) + \"\\n        \")\n          ])\n        : _vm._e(),\n      _vm._v(\" \"),\n      _c(\"div\", { staticClass: \"portlet-body\" }, [\n        _c(\"form\", { ref: \"form\" }, [\n          _vm._m(1, false, false),\n          _vm._v(\" \"),\n          _vm._m(2, false, false)\n        ])\n      ]),\n      _vm._v(\" \"),\n      _c(\"div\", { staticClass: \"portlet-buttons\" }, [\n        _c(\"input\", {\n          staticClass: \"btn btn-primary\",\n          attrs: { type: \"button\", value: \"Import History\" },\n          on: { click: _vm.submit }\n        })\n      ])\n    ])\n  ])\n}\nvar staticRenderFns = [\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"div\", { staticClass: \"portlet-header\" }, [\n      _c(\"div\", { staticClass: \"portlet-title\" }, [\n        _c(\"i\", { staticClass: \"portlet-title-icon fa fa-upload\" }),\n        _vm._v(\" \"),\n        _c(\"span\", { staticClass: \"portlet-title-text\" }, [\n          _c(\"b\", [_vm._v(\"Import a History from an Archive\")])\n        ])\n      ])\n    ])\n  },\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"div\", { staticClass: \"ui-form-element\" }, [\n      _c(\"div\", { staticClass: \"ui-form-title\" }, [\n        _vm._v(\"Archived History URL\")\n      ]),\n      _vm._v(\" \"),\n      _c(\"input\", {\n        staticClass: \"ui-input\",\n        attrs: { type: \"text\", name: \"archive_source\" }\n      })\n    ])\n  },\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"div\", { staticClass: \"ui-form-element\" }, [\n      _c(\"div\", { staticClass: \"ui-form-title\" }, [\n        _vm._v(\"Archived History file\")\n      ]),\n      _vm._v(\" \"),\n      _c(\"input\", { attrs: { type: \"file\", name: \"archive_file\" } })\n    ])\n  }\n]\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\nif (false) {\n  module.hot.accept()\n  if (module.hot.data) {\n    require(\"vue-hot-reload-api\")      .rerender(\"data-v-23742a28\", esExports)\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZT9iOGRkIl0sInNvdXJjZXNDb250ZW50IjpbInZhciByZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgdmFyIF92bSA9IHRoaXNcbiAgdmFyIF9oID0gX3ZtLiRjcmVhdGVFbGVtZW50XG4gIHZhciBfYyA9IF92bS5fc2VsZi5fYyB8fCBfaFxuICByZXR1cm4gX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJ1aS1wb3J0bGV0LWxpbWl0ZWRcIiB9LCBbXG4gICAgX3ZtLl9tKDAsIGZhbHNlLCBmYWxzZSksXG4gICAgX3ZtLl92KFwiIFwiKSxcbiAgICBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcInBvcnRsZXQtY29udGVudFwiIH0sIFtcbiAgICAgIF92bS5lcnJvcm1lc3NhZ2VcbiAgICAgICAgPyBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcInVpLW1lc3NhZ2UgYWxlcnQgYWxlcnQtZGFuZ2VyXCIgfSwgW1xuICAgICAgICAgICAgX3ZtLl92KFwiXFxuICAgICAgICAgICAgXCIgKyBfdm0uX3MoX3ZtLmVycm9ybWVzc2FnZSkgKyBcIlxcbiAgICAgICAgXCIpXG4gICAgICAgICAgXSlcbiAgICAgICAgOiBfdm0uX2UoKSxcbiAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcInBvcnRsZXQtYm9keVwiIH0sIFtcbiAgICAgICAgX2MoXCJmb3JtXCIsIHsgcmVmOiBcImZvcm1cIiB9LCBbXG4gICAgICAgICAgX3ZtLl9tKDEsIGZhbHNlLCBmYWxzZSksXG4gICAgICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgICAgICBfdm0uX20oMiwgZmFsc2UsIGZhbHNlKVxuICAgICAgICBdKVxuICAgICAgXSksXG4gICAgICBfdm0uX3YoXCIgXCIpLFxuICAgICAgX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJwb3J0bGV0LWJ1dHRvbnNcIiB9LCBbXG4gICAgICAgIF9jKFwiaW5wdXRcIiwge1xuICAgICAgICAgIHN0YXRpY0NsYXNzOiBcImJ0biBidG4tcHJpbWFyeVwiLFxuICAgICAgICAgIGF0dHJzOiB7IHR5cGU6IFwiYnV0dG9uXCIsIHZhbHVlOiBcIkltcG9ydCBIaXN0b3J5XCIgfSxcbiAgICAgICAgICBvbjogeyBjbGljazogX3ZtLnN1Ym1pdCB9XG4gICAgICAgIH0pXG4gICAgICBdKVxuICAgIF0pXG4gIF0pXG59XG52YXIgc3RhdGljUmVuZGVyRm5zID0gW1xuICBmdW5jdGlvbigpIHtcbiAgICB2YXIgX3ZtID0gdGhpc1xuICAgIHZhciBfaCA9IF92bS4kY3JlYXRlRWxlbWVudFxuICAgIHZhciBfYyA9IF92bS5fc2VsZi5fYyB8fCBfaFxuICAgIHJldHVybiBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcInBvcnRsZXQtaGVhZGVyXCIgfSwgW1xuICAgICAgX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJwb3J0bGV0LXRpdGxlXCIgfSwgW1xuICAgICAgICBfYyhcImlcIiwgeyBzdGF0aWNDbGFzczogXCJwb3J0bGV0LXRpdGxlLWljb24gZmEgZmEtdXBsb2FkXCIgfSksXG4gICAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICAgIF9jKFwic3BhblwiLCB7IHN0YXRpY0NsYXNzOiBcInBvcnRsZXQtdGl0bGUtdGV4dFwiIH0sIFtcbiAgICAgICAgICBfYyhcImJcIiwgW192bS5fdihcIkltcG9ydCBhIEhpc3RvcnkgZnJvbSBhbiBBcmNoaXZlXCIpXSlcbiAgICAgICAgXSlcbiAgICAgIF0pXG4gICAgXSlcbiAgfSxcbiAgZnVuY3Rpb24oKSB7XG4gICAgdmFyIF92bSA9IHRoaXNcbiAgICB2YXIgX2ggPSBfdm0uJGNyZWF0ZUVsZW1lbnRcbiAgICB2YXIgX2MgPSBfdm0uX3NlbGYuX2MgfHwgX2hcbiAgICByZXR1cm4gX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJ1aS1mb3JtLWVsZW1lbnRcIiB9LCBbXG4gICAgICBfYyhcImRpdlwiLCB7IHN0YXRpY0NsYXNzOiBcInVpLWZvcm0tdGl0bGVcIiB9LCBbXG4gICAgICAgIF92bS5fdihcIkFyY2hpdmVkIEhpc3RvcnkgVVJMXCIpXG4gICAgICBdKSxcbiAgICAgIF92bS5fdihcIiBcIiksXG4gICAgICBfYyhcImlucHV0XCIsIHtcbiAgICAgICAgc3RhdGljQ2xhc3M6IFwidWktaW5wdXRcIixcbiAgICAgICAgYXR0cnM6IHsgdHlwZTogXCJ0ZXh0XCIsIG5hbWU6IFwiYXJjaGl2ZV9zb3VyY2VcIiB9XG4gICAgICB9KVxuICAgIF0pXG4gIH0sXG4gIGZ1bmN0aW9uKCkge1xuICAgIHZhciBfdm0gPSB0aGlzXG4gICAgdmFyIF9oID0gX3ZtLiRjcmVhdGVFbGVtZW50XG4gICAgdmFyIF9jID0gX3ZtLl9zZWxmLl9jIHx8IF9oXG4gICAgcmV0dXJuIF9jKFwiZGl2XCIsIHsgc3RhdGljQ2xhc3M6IFwidWktZm9ybS1lbGVtZW50XCIgfSwgW1xuICAgICAgX2MoXCJkaXZcIiwgeyBzdGF0aWNDbGFzczogXCJ1aS1mb3JtLXRpdGxlXCIgfSwgW1xuICAgICAgICBfdm0uX3YoXCJBcmNoaXZlZCBIaXN0b3J5IGZpbGVcIilcbiAgICAgIF0pLFxuICAgICAgX3ZtLl92KFwiIFwiKSxcbiAgICAgIF9jKFwiaW5wdXRcIiwgeyBhdHRyczogeyB0eXBlOiBcImZpbGVcIiwgbmFtZTogXCJhcmNoaXZlX2ZpbGVcIiB9IH0pXG4gICAgXSlcbiAgfVxuXVxucmVuZGVyLl93aXRoU3RyaXBwZWQgPSB0cnVlXG52YXIgZXNFeHBvcnRzID0geyByZW5kZXI6IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zOiBzdGF0aWNSZW5kZXJGbnMgfVxuZXhwb3J0IGRlZmF1bHQgZXNFeHBvcnRzXG5pZiAobW9kdWxlLmhvdCkge1xuICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gIGlmIChtb2R1bGUuaG90LmRhdGEpIHtcbiAgICByZXF1aXJlKFwidnVlLWhvdC1yZWxvYWQtYXBpXCIpICAgICAgLnJlcmVuZGVyKFwiZGF0YS12LTIzNzQyYTI4XCIsIGVzRXhwb3J0cylcbiAgfVxufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3RlbXBsYXRlLWNvbXBpbGVyP3tcImlkXCI6XCJkYXRhLXYtMjM3NDJhMjhcIixcImhhc1Njb3BlZFwiOmZhbHNlLFwiYnVibGVcIjp7XCJ0cmFuc2Zvcm1zXCI6e319fSEuL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXRlbXBsYXRlJmluZGV4PTAmYnVzdENhY2hlIS4vZ2FsYXh5L3NjcmlwdHMvY29tcG9uZW50cy9IaXN0b3J5SW1wb3J0LnZ1ZVxuLy8gbW9kdWxlIGlkID0gMjc1XG4vLyBtb2R1bGUgY2h1bmtzID0gMSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///275\n");

/***/ }),
/* 276 */
/*!****************************************************!*\
  !*** ./galaxy/scripts/mvc/history/history-list.js ***!
  \****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function($, jQuery, Backbone) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _ajaxQueue = __webpack_require__(/*! utils/ajax-queue */ 21);\n\nvar _ajaxQueue2 = _interopRequireDefault(_ajaxQueue);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _gridView = __webpack_require__(/*! mvc/grid/grid-view */ 26);\n\nvar _gridView2 = _interopRequireDefault(_gridView);\n\nvar _historyModel = __webpack_require__(/*! mvc/history/history-model */ 31);\n\nvar _historyModel2 = _interopRequireDefault(_historyModel);\n\nvar _copyDialog = __webpack_require__(/*! mvc/history/copy-dialog */ 55);\n\nvar _copyDialog2 = _interopRequireDefault(_copyDialog);\n\nvar _loadingIndicator = __webpack_require__(/*! ui/loading-indicator */ 36);\n\nvar _loadingIndicator2 = _interopRequireDefault(_loadingIndicator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** This class renders the grid list. */\nvar HistoryGridView = _gridView2.default.extend({\n    initialize: function initialize(grid_config) {\n        this.ajaxQueue = new _ajaxQueue2.default.AjaxQueue();\n        _gridView2.default.prototype.initialize.call(this, grid_config);\n    },\n\n    init_grid_elements: function init_grid_elements() {\n        var ajaxQueue = this.ajaxQueue;\n        ajaxQueue.stop();\n        _gridView2.default.prototype.init_grid_elements.call(this);\n        var fetchDetails = $.makeArray(this.$el.find(\".delayed-value-datasets_by_state\").map(function (i, el) {\n            return function () {\n                var historyId = $(el).data(\"history-id\");\n                var url = Galaxy.root + \"api/histories/\" + historyId + \"?keys=nice_size,contents_active,contents_states\";\n                var options = {};\n                options.url = url;\n                options.type = \"GET\";\n                options.success = function (req) {\n                    var contentsStates = req[\"contents_states\"];\n                    var stateHtml = \"\";\n                    var _arr = [\"ok\", \"running\", \"queued\", \"new\", \"error\"];\n                    for (var _i = 0; _i < _arr.length; _i++) {\n                        var state = _arr[_i];\n                        var stateCount = contentsStates[state];\n                        if (stateCount) {\n                            stateHtml += \"<div class=\\\"count-box state-color-\" + state + \"\\\" title=\\\"Datasets in \" + state + \" state\\\">\" + stateCount + \"</div> \";\n                        }\n                    }\n                    var contentsActive = req[\"contents_active\"];\n                    var deleted = contentsActive[\"deleted\"];\n                    if (deleted) {\n                        stateHtml += \"<div class=\\\"count-box state-color-deleted\\\" title=\\\"Deleted datasets\\\">\" + deleted + \"</div> \";\n                    }\n                    var hidden = contentsActive[\"hidden\"];\n                    if (hidden) {\n                        stateHtml += \"<div class=\\\"count-box state-color-hidden\\\" title=\\\"Hidden datasets\\\">\" + hidden + \"</div> \";\n                    }\n                    $(\".delayed-value-datasets_by_state[data-history-id='\" + historyId + \"']\").html(stateHtml);\n                    $(\".delayed-value-disk_size[data-history-id='\" + historyId + \"']\").html(req[\"nice_size\"]);\n                };\n                var xhr = jQuery.ajax(options);\n                return xhr;\n            };\n        }));\n        fetchDetails.forEach(function (fn) {\n            return ajaxQueue.add(fn);\n        });\n        ajaxQueue.start();\n    },\n    _showCopyDialog: function _showCopyDialog(id) {\n        var history = new _historyModel2.default.History({ id: id });\n        history.fetch().fail(function () {\n            alert(\"History could not be fetched. Please contact an administrator\");\n        }).done(function () {\n            (0, _copyDialog2.default)(history, {}).done(function () {\n                if (window.parent && window.parent.Galaxy && window.parent.Galaxy.currHistoryPanel) {\n                    window.parent.Galaxy.currHistoryPanel.loadCurrentHistory();\n                }\n                window.location.reload(true);\n            });\n        });\n    },\n    /** Add an operation to the items menu */\n    _add_operation: function _add_operation(popup, operation, item) {\n        var self = this;\n        var settings = item.operation_config[operation.label];\n        if (operation.label == \"Copy\") {\n            operation.onclick = function (id) {\n                self._showCopyDialog(id);\n            };\n        }\n        if (settings.allowed && operation.allow_popup) {\n            popup.addItem({\n                html: operation.label,\n                href: settings.url_args,\n                target: settings.target,\n                confirmation_text: operation.confirm,\n                func: function func(e) {\n                    e.preventDefault();\n                    var label = $(e.target).html();\n                    if (operation.onclick) {\n                        operation.onclick(item.encode_id);\n                    } else {\n                        self.execute(this.findItemByHtml(label));\n                    }\n                }\n            });\n        }\n    }\n});\n\nvar View = Backbone.View.extend({\n    title: (0, _localization2.default)(\"Histories\"),\n    initialize: function initialize(options) {\n        var self = this;\n        _loadingIndicator2.default.markViewAsLoading(this);\n\n        this.model = new Backbone.Model();\n        _utils2.default.get({\n            url: Galaxy.root + \"history/\" + options.action_id + \"?\" + $.param(Galaxy.params),\n            success: function success(response) {\n                self.model.set(response);\n                self.render();\n            }\n        });\n    },\n\n    render: function render() {\n        var grid = new HistoryGridView(this.model.attributes);\n        this.$el.empty().append(grid.$el);\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! libs/backbone */ 2)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9oaXN0b3J5L2hpc3RvcnktbGlzdC5qcz8xYWFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfbCBmcm9tIFwidXRpbHMvbG9jYWxpemF0aW9uXCI7XG5pbXBvcnQgQWpheFF1ZXVlIGZyb20gXCJ1dGlscy9hamF4LXF1ZXVlXCI7XG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG4vKiogVGhpcyBjbGFzcyByZW5kZXJzIHRoZSBncmlkIGxpc3QuICovXG5pbXBvcnQgR3JpZFZpZXcgZnJvbSBcIm12Yy9ncmlkL2dyaWQtdmlld1wiO1xuaW1wb3J0IEhpc3RvcnlNb2RlbCBmcm9tIFwibXZjL2hpc3RvcnkvaGlzdG9yeS1tb2RlbFwiO1xuaW1wb3J0IGhpc3RvcnlDb3B5RGlhbG9nIGZyb20gXCJtdmMvaGlzdG9yeS9jb3B5LWRpYWxvZ1wiO1xuaW1wb3J0IExvYWRpbmdJbmRpY2F0b3IgZnJvbSBcInVpL2xvYWRpbmctaW5kaWNhdG9yXCI7XG5cbnZhciBIaXN0b3J5R3JpZFZpZXcgPSBHcmlkVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGdyaWRfY29uZmlnKSB7XG4gICAgICAgIHRoaXMuYWpheFF1ZXVlID0gbmV3IEFqYXhRdWV1ZS5BamF4UXVldWUoKTtcbiAgICAgICAgR3JpZFZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzLCBncmlkX2NvbmZpZyk7XG4gICAgfSxcblxuICAgIGluaXRfZ3JpZF9lbGVtZW50czogZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGFqYXhRdWV1ZSA9IHRoaXMuYWpheFF1ZXVlO1xuICAgICAgICBhamF4UXVldWUuc3RvcCgpO1xuICAgICAgICBHcmlkVmlldy5wcm90b3R5cGUuaW5pdF9ncmlkX2VsZW1lbnRzLmNhbGwodGhpcyk7XG4gICAgICAgIGNvbnN0IGZldGNoRGV0YWlscyA9ICQubWFrZUFycmF5KFxuICAgICAgICAgICAgdGhpcy4kZWwuZmluZChcIi5kZWxheWVkLXZhbHVlLWRhdGFzZXRzX2J5X3N0YXRlXCIpLm1hcCgoaSwgZWwpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoaXN0b3J5SWQgPSAkKGVsKS5kYXRhKFwiaGlzdG9yeS1pZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7XG4gICAgICAgICAgICAgICAgICAgICAgICBHYWxheHkucm9vdFxuICAgICAgICAgICAgICAgICAgICB9YXBpL2hpc3Rvcmllcy8ke2hpc3RvcnlJZH0/a2V5cz1uaWNlX3NpemUsY29udGVudHNfYWN0aXZlLGNvbnRlbnRzX3N0YXRlc2A7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy51cmwgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMudHlwZSA9IFwiR0VUXCI7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuc3VjY2VzcyA9IHJlcSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50c1N0YXRlcyA9IHJlcVtcImNvbnRlbnRzX3N0YXRlc1wiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGF0ZUh0bWwgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc3RhdGUgb2YgW1wib2tcIiwgXCJydW5uaW5nXCIsIFwicXVldWVkXCIsIFwibmV3XCIsIFwiZXJyb3JcIl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZUNvdW50ID0gY29udGVudHNTdGF0ZXNbc3RhdGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZUNvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlSHRtbCArPSBgPGRpdiBjbGFzcz1cImNvdW50LWJveCBzdGF0ZS1jb2xvci0ke3N0YXRlfVwiIHRpdGxlPVwiRGF0YXNldHMgaW4gJHtzdGF0ZX0gc3RhdGVcIj4ke3N0YXRlQ291bnR9PC9kaXY+IGA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudHNBY3RpdmUgPSByZXFbXCJjb250ZW50c19hY3RpdmVcIl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVkID0gY29udGVudHNBY3RpdmVbXCJkZWxldGVkXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUh0bWwgKz0gYDxkaXYgY2xhc3M9XCJjb3VudC1ib3ggc3RhdGUtY29sb3ItZGVsZXRlZFwiIHRpdGxlPVwiRGVsZXRlZCBkYXRhc2V0c1wiPiR7ZGVsZXRlZH08L2Rpdj4gYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpZGRlbiA9IGNvbnRlbnRzQWN0aXZlW1wiaGlkZGVuXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlSHRtbCArPSBgPGRpdiBjbGFzcz1cImNvdW50LWJveCBzdGF0ZS1jb2xvci1oaWRkZW5cIiB0aXRsZT1cIkhpZGRlbiBkYXRhc2V0c1wiPiR7aGlkZGVufTwvZGl2PiBgO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgJChgLmRlbGF5ZWQtdmFsdWUtZGF0YXNldHNfYnlfc3RhdGVbZGF0YS1oaXN0b3J5LWlkPScke2hpc3RvcnlJZH0nXWApLmh0bWwoc3RhdGVIdG1sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYC5kZWxheWVkLXZhbHVlLWRpc2tfc2l6ZVtkYXRhLWhpc3RvcnktaWQ9JyR7aGlzdG9yeUlkfSddYCkuaHRtbChyZXFbXCJuaWNlX3NpemVcIl0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgeGhyID0galF1ZXJ5LmFqYXgob3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4aHI7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIGZldGNoRGV0YWlscy5mb3JFYWNoKGZuID0+IGFqYXhRdWV1ZS5hZGQoZm4pKTtcbiAgICAgICAgYWpheFF1ZXVlLnN0YXJ0KCk7XG4gICAgfSxcbiAgICBfc2hvd0NvcHlEaWFsb2c6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHZhciBoaXN0b3J5ID0gbmV3IEhpc3RvcnlNb2RlbC5IaXN0b3J5KHsgaWQ6IGlkIH0pO1xuICAgICAgICBoaXN0b3J5XG4gICAgICAgICAgICAuZmV0Y2goKVxuICAgICAgICAgICAgLmZhaWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFsZXJ0KFwiSGlzdG9yeSBjb3VsZCBub3QgYmUgZmV0Y2hlZC4gUGxlYXNlIGNvbnRhY3QgYW4gYWRtaW5pc3RyYXRvclwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZG9uZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeUNvcHlEaWFsb2coaGlzdG9yeSwge30pLmRvbmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnBhcmVudCAmJiB3aW5kb3cucGFyZW50LkdhbGF4eSAmJiB3aW5kb3cucGFyZW50LkdhbGF4eS5jdXJySGlzdG9yeVBhbmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGFyZW50LkdhbGF4eS5jdXJySGlzdG9yeVBhbmVsLmxvYWRDdXJyZW50SGlzdG9yeSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9LFxuICAgIC8qKiBBZGQgYW4gb3BlcmF0aW9uIHRvIHRoZSBpdGVtcyBtZW51ICovXG4gICAgX2FkZF9vcGVyYXRpb246IGZ1bmN0aW9uKHBvcHVwLCBvcGVyYXRpb24sIGl0ZW0pIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgc2V0dGluZ3MgPSBpdGVtLm9wZXJhdGlvbl9jb25maWdbb3BlcmF0aW9uLmxhYmVsXTtcbiAgICAgICAgaWYgKG9wZXJhdGlvbi5sYWJlbCA9PSBcIkNvcHlcIikge1xuICAgICAgICAgICAgb3BlcmF0aW9uLm9uY2xpY2sgPSBpZCA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5fc2hvd0NvcHlEaWFsb2coaWQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2V0dGluZ3MuYWxsb3dlZCAmJiBvcGVyYXRpb24uYWxsb3dfcG9wdXApIHtcbiAgICAgICAgICAgIHBvcHVwLmFkZEl0ZW0oe1xuICAgICAgICAgICAgICAgIGh0bWw6IG9wZXJhdGlvbi5sYWJlbCxcbiAgICAgICAgICAgICAgICBocmVmOiBzZXR0aW5ncy51cmxfYXJncyxcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHNldHRpbmdzLnRhcmdldCxcbiAgICAgICAgICAgICAgICBjb25maXJtYXRpb25fdGV4dDogb3BlcmF0aW9uLmNvbmZpcm0sXG4gICAgICAgICAgICAgICAgZnVuYzogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9ICQoZS50YXJnZXQpLmh0bWwoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wZXJhdGlvbi5vbmNsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb24ub25jbGljayhpdGVtLmVuY29kZV9pZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmV4ZWN1dGUodGhpcy5maW5kSXRlbUJ5SHRtbChsYWJlbCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxudmFyIFZpZXcgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG4gICAgdGl0bGU6IF9sKFwiSGlzdG9yaWVzXCIpLFxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBMb2FkaW5nSW5kaWNhdG9yLm1hcmtWaWV3QXNMb2FkaW5nKHRoaXMpO1xuXG4gICAgICAgIHRoaXMubW9kZWwgPSBuZXcgQmFja2JvbmUuTW9kZWwoKTtcbiAgICAgICAgVXRpbHMuZ2V0KHtcbiAgICAgICAgICAgIHVybDogYCR7R2FsYXh5LnJvb3R9aGlzdG9yeS8ke29wdGlvbnMuYWN0aW9uX2lkfT8keyQucGFyYW0oR2FsYXh5LnBhcmFtcyl9YCxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb2RlbC5zZXQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHNlbGYucmVuZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZ3JpZCA9IG5ldyBIaXN0b3J5R3JpZFZpZXcodGhpcy5tb2RlbC5hdHRyaWJ1dGVzKTtcbiAgICAgICAgdGhpcy4kZWwuZW1wdHkoKS5hcHBlbmQoZ3JpZC4kZWwpO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVmlldzogVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvaGlzdG9yeS9oaXN0b3J5LWxpc3QuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBTEE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFHQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBM0ZBO0FBQ0E7QUE2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CQTtBQUNBO0FBcUJBO0FBQ0E7QUFEQTtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///276\n");

/***/ }),
/* 277 */
/*!*****************************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/dataset-error.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, _, $) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Dataset edit attributes view */\nvar View = Backbone.View.extend({\n    initialize: function initialize() {\n        this.setElement(\"<div/>\");\n        this.model = new Backbone.Model({\n            dataset_id: Galaxy.params.dataset_id\n        });\n        this.render();\n    },\n\n    // Fetch data for the selected dataset and\n    render: function render() {\n        var _this = this;\n\n        var data_url = Galaxy.root + \"api/datasets/\" + this.model.get(\"dataset_id\");\n\n        _utils2.default.get({\n            url: data_url,\n            success: function success(dataset) {\n                var job_url = Galaxy.root + \"api/jobs/\" + dataset.creating_job + \"?full=True\";\n                _utils2.default.get({\n                    url: job_url,\n                    success: function success(job) {\n                        _this.render_error_page(dataset, job);\n                    },\n                    error: function error(response) {\n                        var error_response = {\n                            status: \"error\",\n                            message: \"Error occured while loading the job.\",\n                            persistent: true,\n                            cls: \"errormessage\"\n                        };\n                        _this.display_message(error_response, _this.$(\".response-message\"));\n                    }\n                });\n            },\n            error: function error(response) {\n                var error_response = {\n                    status: \"error\",\n                    message: \"Error occured while loading the dataset.\",\n                    persistent: true,\n                    cls: \"errormessage\"\n                };\n                _this.display_message(error_response, _this.$(\".response-message\"));\n            }\n        });\n    },\n\n    /** Render the view */\n    render_error_page: function render_error_page(dataset, job) {\n        this.$el.empty().append(\"\\n            \" + this._templateHeader() + \"\\n            <h2>Dataset Error</h2>\\n            <p>An error occured while running the tool <b>\" + job.tool_id + \"</b>.</p>\\n            <p>Tool execution generated the following messages:</p>\\n            <pre class=\\\"code\\\">\" + _.escape(job.stderr) + \"</pre>\\n            <h2>Report This Error</h2>\\n            <p>\\n                Usually the local Galaxy administrators regularly review errors that occur on the server\\n                However, if you would like to provide additional information (such as what you were trying\\n                to do when the error occurred) and a contact e-mail address, we will be better able to\\n                investigate your problem and get back to you.\\n            </p>\");\n        this.$el.append(this._getBugFormTemplate(dataset, job));\n    },\n\n    /** Display actions messages */\n    display_message: function display_message(response, $el, doNotClear, safe) {\n        if (!safe) {\n            if (doNotClear) {\n                $el.append(new _uiMisc2.default.Message(response).$el);\n            } else {\n                $el.empty().html(new _uiMisc2.default.Message(response).$el);\n            }\n        } else {\n            if (doNotClear) {\n                $el.append(new _uiMisc2.default.UnescapedMessage(response).$el);\n            } else {\n                $el.empty().html(new _uiMisc2.default.UnescapedMessage(response).$el);\n            }\n        }\n    },\n\n    /** Main template */\n    _templateHeader: function _templateHeader() {\n        return \"<div class=\\\"page-container edit-attr\\\"><div class=\\\"response-message\\\"></div></div>\";\n    },\n\n    /** Convert tab template */\n    _getBugFormTemplate: function _getBugFormTemplate(dataset, job) {\n        var _this2 = this;\n\n        var inputs = [{\n            help: (0, _localization2.default)(\"Your email address\"),\n            options: [],\n            type: \"text\",\n            name: \"email\",\n            label: \"Your email\",\n            value: Galaxy.user.get(\"email\")\n        }, {\n            help: (0, _localization2.default)(\"Any additional comments you can provide regarding what you were doing at the time of the bug.\"),\n            options: [],\n            type: \"text\",\n            area: true,\n            name: \"message\",\n            label: \"Message\"\n        }];\n\n        // TODO\n        /*\n        if (false && response.any_public) {\n            inputs.push({\n                name: \"public_consent\",\n                label: \"Public Disclosure Consent\",\n                help:\n                    \"This Galaxy is configured to report to one or more error reporting backends that public to the world. By selecting 'yes', you acknowledge that this bug report will be made public.\",\n                value: String(Boolean(false)),\n                options: [],\n                type: \"boolean\"\n            });\n        }\n        */\n\n        var form = new _formView2.default({\n            title: (0, _localization2.default)(\"Error Report\"),\n            inputs: inputs,\n            buttons: {\n                save: new _uiMisc2.default.Button({\n                    icon: \"fa-bug\",\n                    title: (0, _localization2.default)(\"Report\"),\n                    cls: \"ui-button btn btn-primary\",\n                    floating: \"clear\",\n                    onclick: function onclick() {\n                        var form_data = form.data.create();\n                        var url = Galaxy.root + \"api/jobs/\" + job.id + \"/error\";\n                        form_data.dataset_id = dataset.id;\n                        _this2.submit(form_data, url);\n                    }\n                })\n            }\n        });\n        return form.$el;\n    },\n\n    /** Make ajax request */\n    submit: function submit(form_data, url) {\n        var _this3 = this;\n\n        // Some required metadata\n        $.ajax({\n            type: \"POST\",\n            url: url,\n            data: form_data,\n            success: function success(response) {\n                // Clear out the div\n                _this3.$el.empty().append(_this3._templateHeader());\n                // And display the messages.\n                response.messages.forEach(function (message) {\n                    _this3.display_message({\n                        status: message[1],\n                        message: message[0],\n                        persistent: true\n                    }, _this3.$(\".response-message\"), true, true);\n                });\n            },\n            error: function error(response) {\n                var error_response = {\n                    status: \"error\",\n                    message: \"Error occured while saving. Please fill all the required fields and try again.\",\n                    persistent: true,\n                    cls: \"errormessage\"\n                };\n                _this3.display_message(error_response, _this3.$(\".response-message\"));\n            }\n        });\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! underscore */ 1), __webpack_require__(/*! jquery */ 0)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9kYXRhc2V0L2RhdGFzZXQtZXJyb3IuanM/YTNhNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgX2wgZnJvbSBcInV0aWxzL2xvY2FsaXphdGlvblwiO1xuaW1wb3J0IFV0aWxzIGZyb20gXCJ1dGlscy91dGlsc1wiO1xuaW1wb3J0IFVpIGZyb20gXCJtdmMvdWkvdWktbWlzY1wiO1xuaW1wb3J0IEZvcm0gZnJvbSBcIm12Yy9mb3JtL2Zvcm0tdmlld1wiO1xuLyoqIERhdGFzZXQgZWRpdCBhdHRyaWJ1dGVzIHZpZXcgKi9cbnZhciBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQoXCI8ZGl2Lz5cIik7XG4gICAgICAgIHRoaXMubW9kZWwgPSBuZXcgQmFja2JvbmUuTW9kZWwoe1xuICAgICAgICAgICAgZGF0YXNldF9pZDogR2FsYXh5LnBhcmFtcy5kYXRhc2V0X2lkXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICAvLyBGZXRjaCBkYXRhIGZvciB0aGUgc2VsZWN0ZWQgZGF0YXNldCBhbmRcbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZGF0YV91cmwgPSBgJHtHYWxheHkucm9vdH1hcGkvZGF0YXNldHMvJHt0aGlzLm1vZGVsLmdldChcImRhdGFzZXRfaWRcIil9YDtcblxuICAgICAgICBVdGlscy5nZXQoe1xuICAgICAgICAgICAgdXJsOiBkYXRhX3VybCxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGFzZXQgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBqb2JfdXJsID0gYCR7R2FsYXh5LnJvb3R9YXBpL2pvYnMvJHtkYXRhc2V0LmNyZWF0aW5nX2pvYn0/ZnVsbD1UcnVlYDtcbiAgICAgICAgICAgICAgICBVdGlscy5nZXQoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGpvYl91cmwsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGpvYiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcl9lcnJvcl9wYWdlKGRhdGFzZXQsIGpvYik7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiByZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3JfcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJFcnJvciBvY2N1cmVkIHdoaWxlIGxvYWRpbmcgdGhlIGpvYi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogXCJlcnJvcm1lc3NhZ2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheV9tZXNzYWdlKGVycm9yX3Jlc3BvbnNlLCB0aGlzLiQoXCIucmVzcG9uc2UtbWVzc2FnZVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBlcnJvcl9yZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRXJyb3Igb2NjdXJlZCB3aGlsZSBsb2FkaW5nIHRoZSBkYXRhc2V0LlwiLFxuICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjbHM6IFwiZXJyb3JtZXNzYWdlXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheV9tZXNzYWdlKGVycm9yX3Jlc3BvbnNlLCB0aGlzLiQoXCIucmVzcG9uc2UtbWVzc2FnZVwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKiogUmVuZGVyIHRoZSB2aWV3ICovXG4gICAgcmVuZGVyX2Vycm9yX3BhZ2U6IGZ1bmN0aW9uKGRhdGFzZXQsIGpvYikge1xuICAgICAgICB0aGlzLiRlbC5lbXB0eSgpLmFwcGVuZChgXG4gICAgICAgICAgICAke3RoaXMuX3RlbXBsYXRlSGVhZGVyKCl9XG4gICAgICAgICAgICA8aDI+RGF0YXNldCBFcnJvcjwvaDI+XG4gICAgICAgICAgICA8cD5BbiBlcnJvciBvY2N1cmVkIHdoaWxlIHJ1bm5pbmcgdGhlIHRvb2wgPGI+JHtqb2IudG9vbF9pZH08L2I+LjwvcD5cbiAgICAgICAgICAgIDxwPlRvb2wgZXhlY3V0aW9uIGdlbmVyYXRlZCB0aGUgZm9sbG93aW5nIG1lc3NhZ2VzOjwvcD5cbiAgICAgICAgICAgIDxwcmUgY2xhc3M9XCJjb2RlXCI+JHtfLmVzY2FwZShqb2Iuc3RkZXJyKX08L3ByZT5cbiAgICAgICAgICAgIDxoMj5SZXBvcnQgVGhpcyBFcnJvcjwvaDI+XG4gICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICBVc3VhbGx5IHRoZSBsb2NhbCBHYWxheHkgYWRtaW5pc3RyYXRvcnMgcmVndWxhcmx5IHJldmlldyBlcnJvcnMgdGhhdCBvY2N1ciBvbiB0aGUgc2VydmVyXG4gICAgICAgICAgICAgICAgSG93ZXZlciwgaWYgeW91IHdvdWxkIGxpa2UgdG8gcHJvdmlkZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIChzdWNoIGFzIHdoYXQgeW91IHdlcmUgdHJ5aW5nXG4gICAgICAgICAgICAgICAgdG8gZG8gd2hlbiB0aGUgZXJyb3Igb2NjdXJyZWQpIGFuZCBhIGNvbnRhY3QgZS1tYWlsIGFkZHJlc3MsIHdlIHdpbGwgYmUgYmV0dGVyIGFibGUgdG9cbiAgICAgICAgICAgICAgICBpbnZlc3RpZ2F0ZSB5b3VyIHByb2JsZW0gYW5kIGdldCBiYWNrIHRvIHlvdS5cbiAgICAgICAgICAgIDwvcD5gKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMuX2dldEJ1Z0Zvcm1UZW1wbGF0ZShkYXRhc2V0LCBqb2IpKTtcbiAgICB9LFxuXG4gICAgLyoqIERpc3BsYXkgYWN0aW9ucyBtZXNzYWdlcyAqL1xuICAgIGRpc3BsYXlfbWVzc2FnZTogZnVuY3Rpb24ocmVzcG9uc2UsICRlbCwgZG9Ob3RDbGVhciwgc2FmZSkge1xuICAgICAgICBpZiAoIXNhZmUpIHtcbiAgICAgICAgICAgIGlmIChkb05vdENsZWFyKSB7XG4gICAgICAgICAgICAgICAgJGVsLmFwcGVuZChuZXcgVWkuTWVzc2FnZShyZXNwb25zZSkuJGVsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGVsLmVtcHR5KCkuaHRtbChuZXcgVWkuTWVzc2FnZShyZXNwb25zZSkuJGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChkb05vdENsZWFyKSB7XG4gICAgICAgICAgICAgICAgJGVsLmFwcGVuZChuZXcgVWkuVW5lc2NhcGVkTWVzc2FnZShyZXNwb25zZSkuJGVsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGVsLmVtcHR5KCkuaHRtbChuZXcgVWkuVW5lc2NhcGVkTWVzc2FnZShyZXNwb25zZSkuJGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogTWFpbiB0ZW1wbGF0ZSAqL1xuICAgIF90ZW1wbGF0ZUhlYWRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInBhZ2UtY29udGFpbmVyIGVkaXQtYXR0clwiPjxkaXYgY2xhc3M9XCJyZXNwb25zZS1tZXNzYWdlXCI+PC9kaXY+PC9kaXY+YDtcbiAgICB9LFxuXG4gICAgLyoqIENvbnZlcnQgdGFiIHRlbXBsYXRlICovXG4gICAgX2dldEJ1Z0Zvcm1UZW1wbGF0ZTogZnVuY3Rpb24oZGF0YXNldCwgam9iKSB7XG4gICAgICAgIHZhciBpbnB1dHMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaGVscDogX2woXCJZb3VyIGVtYWlsIGFkZHJlc3NcIiksXG4gICAgICAgICAgICAgICAgb3B0aW9uczogW10sXG4gICAgICAgICAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICAgICAgbmFtZTogXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBcIllvdXIgZW1haWxcIixcbiAgICAgICAgICAgICAgICB2YWx1ZTogR2FsYXh5LnVzZXIuZ2V0KFwiZW1haWxcIilcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaGVscDogX2woXG4gICAgICAgICAgICAgICAgICAgIFwiQW55IGFkZGl0aW9uYWwgY29tbWVudHMgeW91IGNhbiBwcm92aWRlIHJlZ2FyZGluZyB3aGF0IHlvdSB3ZXJlIGRvaW5nIGF0IHRoZSB0aW1lIG9mIHRoZSBidWcuXCJcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuICAgICAgICAgICAgICAgIGFyZWE6IHRydWUsXG4gICAgICAgICAgICAgICAgbmFtZTogXCJtZXNzYWdlXCIsXG4gICAgICAgICAgICAgICAgbGFiZWw6IFwiTWVzc2FnZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgLy8gVE9ET1xuICAgICAgICAvKlxuICAgICAgICBpZiAoZmFsc2UgJiYgcmVzcG9uc2UuYW55X3B1YmxpYykge1xuICAgICAgICAgICAgaW5wdXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwicHVibGljX2NvbnNlbnRcIixcbiAgICAgICAgICAgICAgICBsYWJlbDogXCJQdWJsaWMgRGlzY2xvc3VyZSBDb25zZW50XCIsXG4gICAgICAgICAgICAgICAgaGVscDpcbiAgICAgICAgICAgICAgICAgICAgXCJUaGlzIEdhbGF4eSBpcyBjb25maWd1cmVkIHRvIHJlcG9ydCB0byBvbmUgb3IgbW9yZSBlcnJvciByZXBvcnRpbmcgYmFja2VuZHMgdGhhdCBwdWJsaWMgdG8gdGhlIHdvcmxkLiBCeSBzZWxlY3RpbmcgJ3llcycsIHlvdSBhY2tub3dsZWRnZSB0aGF0IHRoaXMgYnVnIHJlcG9ydCB3aWxsIGJlIG1hZGUgcHVibGljLlwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBTdHJpbmcoQm9vbGVhbihmYWxzZSkpLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IFtdLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuXG4gICAgICAgIHZhciBmb3JtID0gbmV3IEZvcm0oe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiRXJyb3IgUmVwb3J0XCIpLFxuICAgICAgICAgICAgaW5wdXRzOiBpbnB1dHMsXG4gICAgICAgICAgICBidXR0b25zOiB7XG4gICAgICAgICAgICAgICAgc2F2ZTogbmV3IFVpLkJ1dHRvbih7XG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiZmEtYnVnXCIsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIlJlcG9ydFwiKSxcbiAgICAgICAgICAgICAgICAgICAgY2xzOiBcInVpLWJ1dHRvbiBidG4gYnRuLXByaW1hcnlcIixcbiAgICAgICAgICAgICAgICAgICAgZmxvYXRpbmc6IFwiY2xlYXJcIixcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm1fZGF0YSA9IGZvcm0uZGF0YS5jcmVhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBgJHtHYWxheHkucm9vdH1hcGkvam9icy8ke2pvYi5pZH0vZXJyb3JgO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybV9kYXRhLmRhdGFzZXRfaWQgPSBkYXRhc2V0LmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXQoZm9ybV9kYXRhLCB1cmwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3JtLiRlbDtcbiAgICB9LFxuXG4gICAgLyoqIE1ha2UgYWpheCByZXF1ZXN0ICovXG4gICAgc3VibWl0OiBmdW5jdGlvbihmb3JtX2RhdGEsIHVybCkge1xuICAgICAgICAvLyBTb21lIHJlcXVpcmVkIG1ldGFkYXRhXG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiBcIlBPU1RcIixcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgZGF0YTogZm9ybV9kYXRhLFxuICAgICAgICAgICAgc3VjY2VzczogcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIC8vIENsZWFyIG91dCB0aGUgZGl2XG4gICAgICAgICAgICAgICAgdGhpcy4kZWwuZW1wdHkoKS5hcHBlbmQodGhpcy5fdGVtcGxhdGVIZWFkZXIoKSk7XG4gICAgICAgICAgICAgICAgLy8gQW5kIGRpc3BsYXkgdGhlIG1lc3NhZ2VzLlxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLm1lc3NhZ2VzLmZvckVhY2gobWVzc2FnZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheV9tZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogbWVzc2FnZVsxXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlWzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlbnQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiQoXCIucmVzcG9uc2UtbWVzc2FnZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3JfcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJlcnJvclwiLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkVycm9yIG9jY3VyZWQgd2hpbGUgc2F2aW5nLiBQbGVhc2UgZmlsbCBhbGwgdGhlIHJlcXVpcmVkIGZpZWxkcyBhbmQgdHJ5IGFnYWluLlwiLFxuICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBjbHM6IFwiZXJyb3JtZXNzYWdlXCJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheV9tZXNzYWdlKGVycm9yX3Jlc3BvbnNlLCB0aGlzLiQoXCIucmVzcG9uc2UtbWVzc2FnZVwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgVmlldzogVmlld1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBnYWxheHkvc2NyaXB0cy9tdmMvZGF0YXNldC9kYXRhc2V0LWVycm9yLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBYkE7QUFlQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQTVCQTtBQThCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFTQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQUNBO0FBV0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQURBO0FBSEE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBN0JBO0FBK0JBO0FBbExBO0FBQ0E7QUFvTEE7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///277\n");

/***/ }),
/* 278 */
/*!***************************************************************!*\
  !*** ./galaxy/scripts/mvc/dataset/dataset-edit-attributes.js ***!
  \***************************************************************/
/*! dynamic exports provided */
/*! all exports used */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("/* WEBPACK VAR INJECTION */(function(Backbone, $, _) {\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localization = __webpack_require__(/*! utils/localization */ 3);\n\nvar _localization2 = _interopRequireDefault(_localization);\n\nvar _utils = __webpack_require__(/*! utils/utils */ 5);\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _uiTabs = __webpack_require__(/*! mvc/ui/ui-tabs */ 80);\n\nvar _uiTabs2 = _interopRequireDefault(_uiTabs);\n\nvar _uiMisc = __webpack_require__(/*! mvc/ui/ui-misc */ 6);\n\nvar _uiMisc2 = _interopRequireDefault(_uiMisc);\n\nvar _formView = __webpack_require__(/*! mvc/form/form-view */ 13);\n\nvar _formView2 = _interopRequireDefault(_formView);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/** Dataset edit attributes view */\nvar View = Backbone.View.extend({\n    initialize: function initialize() {\n        this.setElement(\"<div/>\");\n        this.model = new Backbone.Model({\n            dataset_id: Galaxy.params.dataset_id\n        });\n        this.message = new _uiMisc2.default.Message({ persistent: true });\n        this.tabs = this._createTabs();\n        this.$el.append($(\"<h4/>\").append(\"Edit dataset attributes\")).append(this.message.$el).append(\"<p/>\").append(this.tabs.$el).hide();\n        this.render();\n    },\n\n    /** fetch data for the selected dataset and build forms */\n    render: function render() {\n        var self = this;\n        $.ajax({\n            url: Galaxy.root + \"dataset/get_edit?dataset_id=\" + self.model.get(\"dataset_id\"),\n            success: function success(response) {\n                !self.initial_message && self.message.update(response);\n                self.initial_message = true;\n                _.each(self.forms, function (form, key) {\n                    form.model.set(\"inputs\", response[key + \"_inputs\"]);\n                    form.model.set(\"hide_operations\", response[key + \"_disable\"]);\n                    form.render();\n                });\n                self.$el.show();\n            },\n            error: function error(response) {\n                var err_msg = response.responseJSON && response.responseJSON.err_msg;\n                self.message.update({\n                    status: \"danger\",\n                    message: err_msg || \"Error occured while loading the dataset.\"\n                });\n            }\n        });\n    },\n\n    /** submit data to backend to update attributes */\n    _submit: function _submit(operation, form) {\n        var self = this;\n        var data = form.data.create();\n        data.dataset_id = this.model.get(\"dataset_id\");\n        data.operation = operation;\n        $.ajax({\n            type: \"PUT\",\n            url: Galaxy.root + \"dataset/set_edit\",\n            data: data,\n            success: function success(response) {\n                self.message.update(response);\n                self.render();\n                self._reloadHistory();\n            },\n            error: function error(response) {\n                var err_msg = response.responseJSON && response.responseJSON.err_msg;\n                self.message.update({\n                    status: \"danger\",\n                    message: err_msg || \"Error occured while editing the dataset attributes.\"\n                });\n            }\n        });\n    },\n\n    /** create tabs for different dataset attribute categories*/\n    _createTabs: function _createTabs() {\n        this.forms = {\n            attribute: this._getAttribute(),\n            conversion: this._getConversion(),\n            datatype: this._getDatatype(),\n            permission: this._getPermission()\n        };\n        var tabs = new _uiTabs2.default.View();\n        tabs.add({\n            id: \"attribute\",\n            title: (0, _localization2.default)(\"Attributes\"),\n            icon: \"fa fa-bars\",\n            tooltip: (0, _localization2.default)(\"Edit dataset attributes\"),\n            $el: this.forms.attribute.$el\n        });\n        tabs.add({\n            id: \"convert\",\n            title: (0, _localization2.default)(\"Convert\"),\n            icon: \"fa-gear\",\n            tooltip: (0, _localization2.default)(\"Convert to new format\"),\n            $el: this.forms.conversion.$el\n        });\n        tabs.add({\n            id: \"datatype\",\n            title: (0, _localization2.default)(\"Datatypes\"),\n            icon: \"fa-database\",\n            tooltip: (0, _localization2.default)(\"Change data type\"),\n            $el: this.forms.datatype.$el\n        });\n        tabs.add({\n            id: \"permissions\",\n            title: (0, _localization2.default)(\"Permissions\"),\n            icon: \"fa-user\",\n            tooltip: (0, _localization2.default)(\"Permissions\"),\n            $el: this.forms.permission.$el\n        });\n        return tabs;\n    },\n\n    /** edit main attributes form */\n    _getAttribute: function _getAttribute() {\n        var self = this;\n        var form = new _formView2.default({\n            title: (0, _localization2.default)(\"Edit attributes\"),\n            operations: {\n                submit_attributes: new _uiMisc2.default.ButtonIcon({\n                    tooltip: (0, _localization2.default)(\"Save attributes of the dataset.\"),\n                    icon: \"fa-floppy-o\",\n                    title: (0, _localization2.default)(\"Save\"),\n                    onclick: function onclick() {\n                        self._submit(\"attributes\", form);\n                    }\n                }),\n                submit_autodetect: new _uiMisc2.default.ButtonIcon({\n                    tooltip: \"This will inspect the dataset and attempt to correct the values of fields if they are not accurate.\",\n                    icon: \"fa-undo\",\n                    title: \"Auto-detect\",\n                    onclick: function onclick() {\n                        self._submit(\"autodetect\", form);\n                    }\n                })\n            }\n        });\n        return form;\n    },\n\n    /** datatype conversion form */\n    _getConversion: function _getConversion() {\n        var self = this;\n        var form = new _formView2.default({\n            title: (0, _localization2.default)(\"Convert to new format\"),\n            operations: {\n                submit_conversion: new _uiMisc2.default.ButtonIcon({\n                    tooltip: (0, _localization2.default)(\"Convert the datatype to a new format.\"),\n                    title: (0, _localization2.default)(\"Convert datatype\"),\n                    icon: \"fa-exchange\",\n                    onclick: function onclick() {\n                        self._submit(\"conversion\", form);\n                    }\n                })\n            }\n        });\n        return form;\n    },\n\n    /** change datatype form */\n    _getDatatype: function _getDatatype() {\n        var self = this;\n        var form = new _formView2.default({\n            title: (0, _localization2.default)(\"Change datatype\"),\n            operations: {\n                submit_datatype: new _uiMisc2.default.ButtonIcon({\n                    tooltip: (0, _localization2.default)(\"Change the datatype to a new type.\"),\n                    title: (0, _localization2.default)(\"Change datatype\"),\n                    icon: \"fa-exchange\",\n                    onclick: function onclick() {\n                        self._submit(\"datatype\", form);\n                    }\n                })\n            }\n        });\n        return form;\n    },\n\n    /** dataset permissions form */\n    _getPermission: function _getPermission() {\n        var self = this;\n        var form = new _formView2.default({\n            title: (0, _localization2.default)(\"Manage dataset permissions\"),\n            operations: {\n                submit_permission: new _uiMisc2.default.ButtonIcon({\n                    tooltip: (0, _localization2.default)(\"Save permissions.\"),\n                    title: (0, _localization2.default)(\"Save permissions\"),\n                    icon: \"fa-floppy-o \",\n                    onclick: function onclick() {\n                        self._submit(\"permission\", form);\n                    }\n                })\n            }\n        });\n        return form;\n    },\n\n    /** reload Galaxy's history after updating dataset's attributes */\n    _reloadHistory: function _reloadHistory() {\n        if (window.Galaxy) {\n            window.Galaxy.currHistoryPanel.loadCurrentHistory();\n        }\n    }\n});\n\nexports.default = {\n    View: View\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! libs/backbone */ 2), __webpack_require__(/*! jquery */ 0), __webpack_require__(/*! underscore */ 1)))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2dhbGF4eS9zY3JpcHRzL212Yy9kYXRhc2V0L2RhdGFzZXQtZWRpdC1hdHRyaWJ1dGVzLmpzPzEyMzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9sIGZyb20gXCJ1dGlscy9sb2NhbGl6YXRpb25cIjtcbi8qKiBEYXRhc2V0IGVkaXQgYXR0cmlidXRlcyB2aWV3ICovXG5pbXBvcnQgVXRpbHMgZnJvbSBcInV0aWxzL3V0aWxzXCI7XG5pbXBvcnQgVGFicyBmcm9tIFwibXZjL3VpL3VpLXRhYnNcIjtcbmltcG9ydCBVaSBmcm9tIFwibXZjL3VpL3VpLW1pc2NcIjtcbmltcG9ydCBGb3JtIGZyb20gXCJtdmMvZm9ybS9mb3JtLXZpZXdcIjtcbnZhciBWaWV3ID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnNldEVsZW1lbnQoXCI8ZGl2Lz5cIik7XG4gICAgICAgIHRoaXMubW9kZWwgPSBuZXcgQmFja2JvbmUuTW9kZWwoe1xuICAgICAgICAgICAgZGF0YXNldF9pZDogR2FsYXh5LnBhcmFtcy5kYXRhc2V0X2lkXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBuZXcgVWkuTWVzc2FnZSh7IHBlcnNpc3RlbnQ6IHRydWUgfSk7XG4gICAgICAgIHRoaXMudGFicyA9IHRoaXMuX2NyZWF0ZVRhYnMoKTtcbiAgICAgICAgdGhpcy4kZWxcbiAgICAgICAgICAgIC5hcHBlbmQoJChcIjxoNC8+XCIpLmFwcGVuZChcIkVkaXQgZGF0YXNldCBhdHRyaWJ1dGVzXCIpKVxuICAgICAgICAgICAgLmFwcGVuZCh0aGlzLm1lc3NhZ2UuJGVsKVxuICAgICAgICAgICAgLmFwcGVuZChcIjxwLz5cIilcbiAgICAgICAgICAgIC5hcHBlbmQodGhpcy50YWJzLiRlbClcbiAgICAgICAgICAgIC5oaWRlKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIC8qKiBmZXRjaCBkYXRhIGZvciB0aGUgc2VsZWN0ZWQgZGF0YXNldCBhbmQgYnVpbGQgZm9ybXMgKi9cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB1cmw6IGAke0dhbGF4eS5yb290fWRhdGFzZXQvZ2V0X2VkaXQ/ZGF0YXNldF9pZD0ke3NlbGYubW9kZWwuZ2V0KFwiZGF0YXNldF9pZFwiKX1gLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAhc2VsZi5pbml0aWFsX21lc3NhZ2UgJiYgc2VsZi5tZXNzYWdlLnVwZGF0ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0aWFsX21lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF8uZWFjaChzZWxmLmZvcm1zLCAoZm9ybSwga2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm0ubW9kZWwuc2V0KFwiaW5wdXRzXCIsIHJlc3BvbnNlW2Ake2tleX1faW5wdXRzYF0pO1xuICAgICAgICAgICAgICAgICAgICBmb3JtLm1vZGVsLnNldChcImhpZGVfb3BlcmF0aW9uc1wiLCByZXNwb25zZVtgJHtrZXl9X2Rpc2FibGVgXSk7XG4gICAgICAgICAgICAgICAgICAgIGZvcm0ucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgc2VsZi4kZWwuc2hvdygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHZhciBlcnJfbXNnID0gcmVzcG9uc2UucmVzcG9uc2VKU09OICYmIHJlc3BvbnNlLnJlc3BvbnNlSlNPTi5lcnJfbXNnO1xuICAgICAgICAgICAgICAgIHNlbGYubWVzc2FnZS51cGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwiZGFuZ2VyXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycl9tc2cgfHwgXCJFcnJvciBvY2N1cmVkIHdoaWxlIGxvYWRpbmcgdGhlIGRhdGFzZXQuXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKiBzdWJtaXQgZGF0YSB0byBiYWNrZW5kIHRvIHVwZGF0ZSBhdHRyaWJ1dGVzICovXG4gICAgX3N1Ym1pdDogZnVuY3Rpb24ob3BlcmF0aW9uLCBmb3JtKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFyIGRhdGEgPSBmb3JtLmRhdGEuY3JlYXRlKCk7XG4gICAgICAgIGRhdGEuZGF0YXNldF9pZCA9IHRoaXMubW9kZWwuZ2V0KFwiZGF0YXNldF9pZFwiKTtcbiAgICAgICAgZGF0YS5vcGVyYXRpb24gPSBvcGVyYXRpb247XG4gICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICB0eXBlOiBcIlBVVFwiLFxuICAgICAgICAgICAgdXJsOiBgJHtHYWxheHkucm9vdH1kYXRhc2V0L3NldF9lZGl0YCxcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHNlbGYubWVzc2FnZS51cGRhdGUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHNlbGYucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgc2VsZi5fcmVsb2FkSGlzdG9yeSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHZhciBlcnJfbXNnID0gcmVzcG9uc2UucmVzcG9uc2VKU09OICYmIHJlc3BvbnNlLnJlc3BvbnNlSlNPTi5lcnJfbXNnO1xuICAgICAgICAgICAgICAgIHNlbGYubWVzc2FnZS51cGRhdGUoe1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFwiZGFuZ2VyXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycl9tc2cgfHwgXCJFcnJvciBvY2N1cmVkIHdoaWxlIGVkaXRpbmcgdGhlIGRhdGFzZXQgYXR0cmlidXRlcy5cIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuXG4gICAgLyoqIGNyZWF0ZSB0YWJzIGZvciBkaWZmZXJlbnQgZGF0YXNldCBhdHRyaWJ1dGUgY2F0ZWdvcmllcyovXG4gICAgX2NyZWF0ZVRhYnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmZvcm1zID0ge1xuICAgICAgICAgICAgYXR0cmlidXRlOiB0aGlzLl9nZXRBdHRyaWJ1dGUoKSxcbiAgICAgICAgICAgIGNvbnZlcnNpb246IHRoaXMuX2dldENvbnZlcnNpb24oKSxcbiAgICAgICAgICAgIGRhdGF0eXBlOiB0aGlzLl9nZXREYXRhdHlwZSgpLFxuICAgICAgICAgICAgcGVybWlzc2lvbjogdGhpcy5fZ2V0UGVybWlzc2lvbigpXG4gICAgICAgIH07XG4gICAgICAgIHZhciB0YWJzID0gbmV3IFRhYnMuVmlldygpO1xuICAgICAgICB0YWJzLmFkZCh7XG4gICAgICAgICAgICBpZDogXCJhdHRyaWJ1dGVcIixcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIkF0dHJpYnV0ZXNcIiksXG4gICAgICAgICAgICBpY29uOiBcImZhIGZhLWJhcnNcIixcbiAgICAgICAgICAgIHRvb2x0aXA6IF9sKFwiRWRpdCBkYXRhc2V0IGF0dHJpYnV0ZXNcIiksXG4gICAgICAgICAgICAkZWw6IHRoaXMuZm9ybXMuYXR0cmlidXRlLiRlbFxuICAgICAgICB9KTtcbiAgICAgICAgdGFicy5hZGQoe1xuICAgICAgICAgICAgaWQ6IFwiY29udmVydFwiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ29udmVydFwiKSxcbiAgICAgICAgICAgIGljb246IFwiZmEtZ2VhclwiLFxuICAgICAgICAgICAgdG9vbHRpcDogX2woXCJDb252ZXJ0IHRvIG5ldyBmb3JtYXRcIiksXG4gICAgICAgICAgICAkZWw6IHRoaXMuZm9ybXMuY29udmVyc2lvbi4kZWxcbiAgICAgICAgfSk7XG4gICAgICAgIHRhYnMuYWRkKHtcbiAgICAgICAgICAgIGlkOiBcImRhdGF0eXBlXCIsXG4gICAgICAgICAgICB0aXRsZTogX2woXCJEYXRhdHlwZXNcIiksXG4gICAgICAgICAgICBpY29uOiBcImZhLWRhdGFiYXNlXCIsXG4gICAgICAgICAgICB0b29sdGlwOiBfbChcIkNoYW5nZSBkYXRhIHR5cGVcIiksXG4gICAgICAgICAgICAkZWw6IHRoaXMuZm9ybXMuZGF0YXR5cGUuJGVsXG4gICAgICAgIH0pO1xuICAgICAgICB0YWJzLmFkZCh7XG4gICAgICAgICAgICBpZDogXCJwZXJtaXNzaW9uc1wiLFxuICAgICAgICAgICAgdGl0bGU6IF9sKFwiUGVybWlzc2lvbnNcIiksXG4gICAgICAgICAgICBpY29uOiBcImZhLXVzZXJcIixcbiAgICAgICAgICAgIHRvb2x0aXA6IF9sKFwiUGVybWlzc2lvbnNcIiksXG4gICAgICAgICAgICAkZWw6IHRoaXMuZm9ybXMucGVybWlzc2lvbi4kZWxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0YWJzO1xuICAgIH0sXG5cbiAgICAvKiogZWRpdCBtYWluIGF0dHJpYnV0ZXMgZm9ybSAqL1xuICAgIF9nZXRBdHRyaWJ1dGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IEZvcm0oe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiRWRpdCBhdHRyaWJ1dGVzXCIpLFxuICAgICAgICAgICAgb3BlcmF0aW9uczoge1xuICAgICAgICAgICAgICAgIHN1Ym1pdF9hdHRyaWJ1dGVzOiBuZXcgVWkuQnV0dG9uSWNvbih7XG4gICAgICAgICAgICAgICAgICAgIHRvb2x0aXA6IF9sKFwiU2F2ZSBhdHRyaWJ1dGVzIG9mIHRoZSBkYXRhc2V0LlwiKSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJmYS1mbG9wcHktb1wiLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogX2woXCJTYXZlXCIpLFxuICAgICAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3N1Ym1pdChcImF0dHJpYnV0ZXNcIiwgZm9ybSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBzdWJtaXRfYXV0b2RldGVjdDogbmV3IFVpLkJ1dHRvbkljb24oe1xuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOlxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUaGlzIHdpbGwgaW5zcGVjdCB0aGUgZGF0YXNldCBhbmQgYXR0ZW1wdCB0byBjb3JyZWN0IHRoZSB2YWx1ZXMgb2YgZmllbGRzIGlmIHRoZXkgYXJlIG5vdCBhY2N1cmF0ZS5cIixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJmYS11bmRvXCIsXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkF1dG8tZGV0ZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgIG9uY2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3VibWl0KFwiYXV0b2RldGVjdFwiLCBmb3JtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZm9ybTtcbiAgICB9LFxuXG4gICAgLyoqIGRhdGF0eXBlIGNvbnZlcnNpb24gZm9ybSAqL1xuICAgIF9nZXRDb252ZXJzaW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB2YXIgZm9ybSA9IG5ldyBGb3JtKHtcbiAgICAgICAgICAgIHRpdGxlOiBfbChcIkNvbnZlcnQgdG8gbmV3IGZvcm1hdFwiKSxcbiAgICAgICAgICAgIG9wZXJhdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBzdWJtaXRfY29udmVyc2lvbjogbmV3IFVpLkJ1dHRvbkljb24oe1xuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiBfbChcIkNvbnZlcnQgdGhlIGRhdGF0eXBlIHRvIGEgbmV3IGZvcm1hdC5cIiksXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkNvbnZlcnQgZGF0YXR5cGVcIiksXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiZmEtZXhjaGFuZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zdWJtaXQoXCJjb252ZXJzaW9uXCIsIGZvcm0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3JtO1xuICAgIH0sXG5cbiAgICAvKiogY2hhbmdlIGRhdGF0eXBlIGZvcm0gKi9cbiAgICBfZ2V0RGF0YXR5cGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IEZvcm0oe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiQ2hhbmdlIGRhdGF0eXBlXCIpLFxuICAgICAgICAgICAgb3BlcmF0aW9uczoge1xuICAgICAgICAgICAgICAgIHN1Ym1pdF9kYXRhdHlwZTogbmV3IFVpLkJ1dHRvbkljb24oe1xuICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiBfbChcIkNoYW5nZSB0aGUgZGF0YXR5cGUgdG8gYSBuZXcgdHlwZS5cIiksXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfbChcIkNoYW5nZSBkYXRhdHlwZVwiKSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJmYS1leGNoYW5nZVwiLFxuICAgICAgICAgICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3N1Ym1pdChcImRhdGF0eXBlXCIsIGZvcm0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3JtO1xuICAgIH0sXG5cbiAgICAvKiogZGF0YXNldCBwZXJtaXNzaW9ucyBmb3JtICovXG4gICAgX2dldFBlcm1pc3Npb246IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IEZvcm0oe1xuICAgICAgICAgICAgdGl0bGU6IF9sKFwiTWFuYWdlIGRhdGFzZXQgcGVybWlzc2lvbnNcIiksXG4gICAgICAgICAgICBvcGVyYXRpb25zOiB7XG4gICAgICAgICAgICAgICAgc3VibWl0X3Blcm1pc3Npb246IG5ldyBVaS5CdXR0b25JY29uKHtcbiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcDogX2woXCJTYXZlIHBlcm1pc3Npb25zLlwiKSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IF9sKFwiU2F2ZSBwZXJtaXNzaW9uc1wiKSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJmYS1mbG9wcHktbyBcIixcbiAgICAgICAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9zdWJtaXQoXCJwZXJtaXNzaW9uXCIsIGZvcm0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmb3JtO1xuICAgIH0sXG5cbiAgICAvKiogcmVsb2FkIEdhbGF4eSdzIGhpc3RvcnkgYWZ0ZXIgdXBkYXRpbmcgZGF0YXNldCdzIGF0dHJpYnV0ZXMgKi9cbiAgICBfcmVsb2FkSGlzdG9yeTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh3aW5kb3cuR2FsYXh5KSB7XG4gICAgICAgICAgICB3aW5kb3cuR2FsYXh5LmN1cnJIaXN0b3J5UGFuZWwubG9hZEN1cnJlbnRIaXN0b3J5KCk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIFZpZXc6IFZpZXdcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZ2FsYXh5L3NjcmlwdHMvbXZjL2RhdGFzZXQvZGF0YXNldC1lZGl0LWF0dHJpYnV0ZXMuanMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBTEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQWxCQTtBQW9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFmQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVRBO0FBRkE7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQURBO0FBRkE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBREE7QUFGQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFEQTtBQUZBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBck1BO0FBQ0E7QUF1TUE7QUFDQTtBQURBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///278\n");

/***/ })
],[251]);